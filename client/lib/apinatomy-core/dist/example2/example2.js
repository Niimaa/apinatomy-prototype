/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(17);
	var $ = __webpack_require__(14);
	var P = __webpack_require__(16);
	var circuitboard = __webpack_require__(1);
	__webpack_require__(2);
	__webpack_require__(3);
	__webpack_require__(4);
	__webpack_require__(5);
	__webpack_require__(6);
	__webpack_require__(7);
	__webpack_require__(8);
	__webpack_require__(9);
	__webpack_require__(10);
	__webpack_require__(11);
	__webpack_require__(12);
	__webpack_require__(13);
	circuitboard.plugin(['tile-skin', 'tile-click-to-open', 'tile-grow-when-open', 'tile-spacing', 'tile-active']);
	var modelPrototype = {
	  get id() {
	    return this.name;
	  },
	  getChildIds: function() {
	    return this.children || [];
	  },
	  getModels: function(ids) {
	    return getModelsByIds(ids);
	  }
	};
	function bgColor(color) {
	  return {normal: {css: {'&': {
	          backgroundColor: color,
	          borderColor: 'black'
	        }}}};
	}
	var models = {
	  root: {
	    name: 'root',
	    children: ['A', 'B', 'C', 'D', 'E']
	  },
	  A: {
	    name: 'A',
	    children: ['A1', 'A2', 'A3'],
	    tile: bgColor('lightblue')
	  },
	  B: {
	    name: 'B',
	    children: ['B1', 'B2', 'B3'],
	    tile: bgColor('lightgreen')
	  },
	  C: {
	    name: 'C',
	    children: ['C1', 'C2', 'C3']
	  },
	  D: {
	    name: 'D',
	    children: ['D1', 'D2', 'D3']
	  },
	  E: {
	    name: 'E',
	    children: ['E1', 'E2', 'E3']
	  },
	  A1: {
	    name: 'A1',
	    tile: bgColor('orange')
	  },
	  A2: {name: 'A2'},
	  A3: {name: 'A3'},
	  B1: {name: 'B1'},
	  B2: {name: 'B2'},
	  B3: {name: 'B3'},
	  C1: {name: 'C1'},
	  C2: {name: 'C2'},
	  C3: {name: 'C3'},
	  D1: {name: 'D1'},
	  D2: {name: 'D2'},
	  D3: {name: 'D3'},
	  E1: {name: 'E1'},
	  E2: {name: 'E2'},
	  E3: {name: 'E3'}
	};
	function getModelsByIds(ids) {
	  var result = [];
	  ids.forEach(function(id) {
	    var model = Object.create(modelPrototype);
	    Object.keys(models[id]).forEach(function(key) {
	      model[key] = models[id][key];
	    });
	    result.push(P.resolve(model));
	  });
	  return result;
	}
	$(document).ready(function() {
	  $('#circuitboard').circuitboard({
	    model: getModelsByIds(['root'])[0],
	    tileSpacing: 4,
	    tilemapMargin: 4
	  }).circuitboard('instance').then(function(circuitboard) {
	    console.info('circuitboard loaded');
	  });
	});


/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(16), __webpack_require__(19), __webpack_require__(20)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, P, newWidgetType, plugin) {
	  'use strict';
	  $.circuitboard = {plugin: plugin};
	  var CircuitboardP = newWidgetType('Circuitboard', {
	    cssClass: "circuitboard",
	    filter: (function() {
	      return P.resolve(true);
	    })
	  });
	  var TilemapP = newWidgetType('Tilemap', {cssClass: "tilemap"});
	  var TileP = newWidgetType('Tile', {cssClass: "tile"});
	  CircuitboardP.then((function(c) {
	    $.circuitboard.Circuitboard = c;
	  }));
	  TilemapP.then((function(c) {
	    $.circuitboard.Tilemap = c;
	  }));
	  TileP.then((function(c) {
	    $.circuitboard.Tile = c;
	  }));
	  return $.circuitboard;
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(16), __webpack_require__(21), __webpack_require__(22), __webpack_require__(23), __webpack_require__(24)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, P, U, defer) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'core',
	    if: true
	  });
	  plugin.modify('Circuitboard.prototype').add('_registerTile', function _registerTile(tile) {
	    U.getDef(this._p_circuitboardCore_tilesByModelId, tile.model.id, defer).resolve(tile);
	  }).add('allTiles', function() {
	    var $__0 = this;
	    var tiles = {};
	    Object.keys(this._p_circuitboardCore_tilesByModelId).forEach((function(id) {
	      tiles[id] = $__0._p_circuitboardCore_tilesByModelId[id].promise;
	    }));
	    return tiles;
	  }).add('tile', function(tileSelector) {
	    return U.getDef(this._p_circuitboardCore_tilesByModelId, tileSelector, defer).promise;
	  }).add('construct', function() {
	    this._p_circuitboardCore_tilesByModelId = {};
	    $('<div/>').appendTo(this.element).css('flex-grow', 1).tilemap({
	      model: this.options.model,
	      parent: this
	    }).tilemap('instance');
	  });
	  plugin.modify('Tilemap.prototype').add('refreshTiles', function() {
	    var $__0 = this;
	    U.assert(U.isDefined(this.model), "An ApiNATOMY tilemap should have a model.");
	    return P.resolve(this.model).call('getChildIds').map((function(id) {
	      return P.resolve($__0.circuitboard.options.filter(id, U.bind(P.resolve($__0.model).value(), 'getModels', id))).then((function(show) {
	        return {
	          id: id,
	          show: show
	        };
	      }));
	    })).filter(U.field('show')).map(U.field('id')).then((function(ids) {
	      return P.resolve($__0.model).value().getModels(ids);
	    })).then((function(childrenToDisplay) {
	      $__0.element.children().empty();
	      $__0.element.empty();
	      $__0._p_tilemapCore_tiles = [];
	      var rowCount = Math.floor(Math.sqrt(childrenToDisplay.length));
	      var colCount = Math.ceil(childrenToDisplay.length / rowCount);
	      while (rowCount--) {
	        var row = $('<div/>').addClass('tilerow').appendTo($__0.element);
	        for (var column = 0; column < colCount && childrenToDisplay.length > 0; column += 1) {
	          $('<div/>').tile({
	            model: childrenToDisplay.shift(),
	            parent: $__0
	          }).appendTo(row).amyNestedFlexGrow(1);
	        }
	      }
	    })).then((function() {
	      $__0.trigger('tiles-refreshed');
	    }));
	  }).add('construct', function() {
	    var $__0 = this;
	    this.newEvent('tiles-refreshed');
	    this._p_tilemapCore_tiles = null;
	    Object.defineProperty(this, 'tiles', {get: (function() {
	        return $__0._p_tilemapCore_tiles;
	      })});
	    this.refreshTiles();
	  });
	  plugin.modify('Tile.prototype').add('populateInnerTilemap', function populateInnerTilemap() {
	    if (!this._p_tileCore_tilemap) {
	      this._p_tileCore_tilemap = this.dom.tilemap({
	        model: this.options.model,
	        parent: this
	      }).tilemap('instance');
	    }
	  }).add('construct', function() {
	    var $__0 = this;
	    this._p_tileCore_tilemap = null;
	    ['mouseover', 'mouseout', 'mouseenter', 'mouseleave'].forEach((function(event) {
	      $__0.newEvent(event, {source: $__0.element.asKefirStream(event)});
	    }));
	    this.newEvent('click', {source: this.element.mouseClick({threshold: this.circuitboard.options.dragThreshold})});
	    this.dom = this.element;
	    this.element.attr('id', this.id);
	    this.circuitboard._registerTile(this);
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 3 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(36), __webpack_require__(21), __webpack_require__(26), __webpack_require__(27), __webpack_require__(28), __webpack_require__(29)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, color, U, Kefir, defaults) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-skin',
	    requires: ['tile-open', 'position-tracking']
	  }).modify('Tile.prototype');
	  var applyStyleDefaults = defaults({
	    '&': {
	      backgroundColor: " 'white'                                                                ",
	      borderColor: " color(`['&'].backgroundColor`).brighten(20).css()                      ",
	      color: " color(`['&'].backgroundColor`).luminance() > 0.5 && 'black' || 'white' "
	    },
	    '& > header': {borderColor: " `['&'].borderColor` "},
	    '& > icon-btn': {backgroundColor: " `['&'].backgroundColor` "}
	  }, {color: color});
	  plugin.insert('construct', function() {
	    var $__0 = this;
	    var origElement = this.dom;
	    origElement.addClass('skinned-tile');
	    this._p_tileSkin_headerElement = $("<header/>").appendTo(origElement);
	    this.dom = $("<section/>").appendTo(origElement);
	    this.model.get('name').then((function(name) {
	      $__0._p_tileSkin_headerElement.text(name);
	    }));
	    this.model.get('tile').get('normal').get('css').then((function(css) {
	      $__0.element.amyPutCssRules(applyStyleDefaults(css));
	    })).catch((function() {}));
	    this.on('size').filterBy(this.p('open').not()).onValue((function(size) {
	      $__0._p_tileSkin_headerElement.css('fontSize', Math.min(0.2 * Math.pow(size.height, 1.01), 0.13 * Math.pow(size.width, 1.01)));
	    }));
	    this.newProperty('headerSize', {
	      settable: false,
	      isEqual: U.Size.equals
	    }).plug(Kefir.merge([Kefir.once(), this.on('size').changes(), this.on('open').changes()]).map((function() {
	      return new U.Size($__0._p_tileSkin_headerElement.height(), $__0.size.width);
	    })));
	    this.newProperty('headerPosition', {settable: false}).plug(this.on('position'));
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 4 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15)], __WEBPACK_AMD_DEFINE_RESULT__ = function($) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-spacing',
	    requires: ['core']
	  }).modify('Tilemap.prototype');
	  plugin.add('refreshTileSpacing', function() {
	    this.element.css('margin', this.circuitboard.options.tilemapMargin);
	    this.element.children().css('margin-bottom', this.circuitboard.options.tileSpacing);
	    this.element.children().children().css('margin-right', this.circuitboard.options.tileSpacing);
	  });
	  plugin.after('refreshTiles', function() {
	    this.refreshTileSpacing();
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 5 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(31), __webpack_require__(26)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, $__1) {
	  'use strict';
	  var button = $__1.button;
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-click-to-open',
	    requires: ['tile-open']
	  }).modify('Tile.prototype');
	  plugin.insert('construct', function() {
	    var $__0 = this;
	    this.on('click').which(button.LEFT).skipPropagation('tile-left-click').onValue((function() {
	      $__0.open = !$__0.open;
	    }));
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 6 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15)], __WEBPACK_AMD_DEFINE_RESULT__ = function($) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-weight',
	    requires: ['core']
	  }).modify('Tile.prototype');
	  plugin.insert('construct', function() {});
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 7 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(21)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, U) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-active',
	    requires: ['core']
	  }).modify('Tile.prototype');
	  plugin.insert('construct', function() {
	    var $__0 = this;
	    if (!this.model) {
	      return;
	    }
	    this.newProperty('active', {initial: false});
	    var _activateProperTile = (function() {
	      var tiles = $__0.model._p_amyActiveTileQueue;
	      if (tiles[1]) {
	        tiles[1].active = false;
	      }
	      if (tiles[0]) {
	        tiles[0].active = true;
	      }
	    });
	    U.array(this.model, '_p_amyActiveTileQueue').push(this);
	    _activateProperTile();
	    this.on('destroy').take(1).onValue((function() {
	      var index = $__0.model._p_amyActiveTileQueue.indexOf($__0);
	      $__0.model._p_amyActiveTileQueue.splice(index, 1);
	      _activateProperTile();
	    }));
	    this.p('active').value(true).onValue((function() {
	      var index = $__0.model._p_amyActiveTileQueue.indexOf($__0);
	      if (index !== 0) {
	        $__0.model._p_amyActiveTileQueue.splice(index, 1);
	        $__0.model._p_amyActiveTileQueue.unshift($__0);
	        _activateProperTile();
	      }
	    }));
	    this.on('active').onValue((function(a) {
	      $__0.element.toggleClass('active', a);
	    }));
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 8 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15)], __WEBPACK_AMD_DEFINE_RESULT__ = function($) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-open',
	    requires: ['core']
	  }).modify('Tile.prototype');
	  plugin.insert('construct', function() {
	    var $__0 = this;
	    this.newProperty('open', {initial: false});
	    this.p('open').value(true).take(1).onValue((function() {
	      $__0.populateInnerTilemap();
	    }));
	    this.p('open').onValue((function(o) {
	      $__0.element.toggleClass('open', o);
	    }));
	    this.p('open').value(false).onValue((function() {
	      $__0.closestDescendantsByType('Tile').forEach((function(tile) {
	        tile.open = false;
	      }));
	    }));
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 9 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(16), __webpack_require__(26), __webpack_require__(35)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, P, Kefir) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-grow-when-open',
	    requires: ['tile-open']
	  }).modify('Tile.prototype');
	  plugin.add('weightWhenOpen', function() {
	    return this.circuitboard.options.weightWhenOpen || 2;
	  }).add('weightWhenClosed', (function() {
	    return 1;
	  }));
	  plugin.add('growWhenOpen', function(open) {
	    var $__0 = this;
	    var flexGrowFrom = parseFloat(this.element.data('amyFlexGrowTarget') || 1);
	    var flexGrowTo = open ? this.weightWhenOpen() : this.weightWhenClosed();
	    this.element.data('amyFlexGrowTarget', flexGrowTo);
	    var rowFlexGrowTo = 0;
	    this.element.parent().children().each(function() {
	      rowFlexGrowTo += parseFloat($(this).data('amyFlexGrowTarget') || 1);
	    });
	    var rowFlexGrowFrom = rowFlexGrowTo - flexGrowTo + flexGrowFrom;
	    return P.all([new P((function(resolve) {
	      $__0.element.velocity({flexGrow: [flexGrowTo, flexGrowFrom]}, {
	        complete: resolve,
	        duration: 300
	      });
	    })), new P((function(resolve) {
	      $__0.element.parent().velocity({flexGrow: [rowFlexGrowTo, rowFlexGrowFrom]}, {
	        complete: resolve,
	        duration: 300
	      });
	    }))]);
	  });
	  plugin.insert('construct', function() {
	    var $__0 = this;
	    this.p('open').changes().onValue((function(open) {
	      $__0.growWhenOpen(open).then((function() {
	        if (open) {
	          finishedOpeningBus.emit();
	        } else {
	          finishedClosingBus.emit();
	        }
	      }));
	    }));
	    var finishedOpeningBus = Kefir.bus();
	    var finishedClosingBus = Kefir.bus();
	    this.newProperty('fullyOpen', {
	      settable: false,
	      initial: this.open
	    }).plug(this.p('open').value(false)).plug(finishedOpeningBus.mapTo(true));
	    this.newProperty('fullyClosed', {
	      settable: false,
	      initial: !this.open
	    }).plug(this.p('open').not().value(false)).plug(finishedClosingBus.mapTo(true));
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 10 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(21)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, U) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-open-active',
	    resolves: ['tile-open', 'tile-active']
	  }).modify('Tile.prototype');
	  plugin.insert('construct', function() {
	    var $__0 = this;
	    if (U.isUndefined(this.active)) {
	      return;
	    }
	    this.on('open').value(true).onValue((function() {
	      $__0.active = true;
	    }));
	    this.on('active').value(false).onValue((function() {
	      $__0.open = false;
	    }));
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 11 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(16), __webpack_require__(32)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, P) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'tile-skin-grow-when-open',
	    resolves: ['tile-skin', 'tile-grow-when-open']
	  }).modify('Tile.prototype');
	  plugin.append('construct', function() {
	    var flexGrowFrom = 1;
	    var rowFlexGrowFrom = this.element.parent().children().length;
	    this.element.velocity({flexGrow: [flexGrowFrom, flexGrowFrom]}, {duration: 1});
	    this.element.parent().velocity({flexGrow: [rowFlexGrowFrom, rowFlexGrowFrom]}, {duration: 1});
	  });
	  plugin.replace('growWhenOpen', function(open) {
	    var $__0 = this;
	    var openCloseTransition = (function() {
	      var flexGrowFrom = parseFloat($__0.element.data('amyFlexGrowTarget') || 1);
	      var flexGrowTo = open ? $__0.weightWhenOpen() : $__0.weightWhenClosed();
	      $__0.element.data('amyFlexGrowTarget', flexGrowTo);
	      var rowFlexGrowTo = 0;
	      $__0.element.parent().children().each(function() {
	        rowFlexGrowTo += parseFloat($(this).data('amyFlexGrowTarget') || 1);
	      });
	      var rowFlexGrowFrom = rowFlexGrowTo - flexGrowTo + flexGrowFrom;
	      return P.all([new P((function(resolve) {
	        $__0.element.velocity({flexGrow: [flexGrowTo, flexGrowFrom]}, {
	          complete: resolve,
	          duration: 300
	        });
	      })), new P((function(resolve) {
	        $__0.element.parent().velocity({flexGrow: [rowFlexGrowTo, rowFlexGrowFrom]}, {
	          complete: resolve,
	          duration: 300
	        });
	      }))]);
	    });
	    var sectionElement = this.element.children('section');
	    if (open) {
	      sectionElement.css({
	        visibility: 'hidden',
	        opacity: 0
	      });
	      return openCloseTransition().then((function() {
	        return new P((function(resolve) {
	          sectionElement.css('visibility', 'visible');
	          sectionElement.velocity({opacity: [1, 0]}, {
	            complete: resolve,
	            duration: 200
	          });
	        }));
	      }));
	    } else {
	      sectionElement.css('visibility', 'visible');
	      return openCloseTransition().then((function() {
	        sectionElement.css('visibility', 'hidden');
	      }));
	    }
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 12 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(21), __webpack_require__(26)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, U, Kefir) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'position-tracking',
	    expects: ['core', 'tile-grow-when-open', 'tile-grow-when-maximized', 'tile-shrink-when-hidden']
	  });
	  plugin.add('Circuitboard.prototype._posTrackingWindow', function(window) {
	    window();
	  });
	  plugin.insert('Circuitboard.prototype.construct', function() {
	    this._posTrackingLimiter = Kefir.limiter(Kefir.merge([Kefir.once(), Kefir.interval(100)]), this._posTrackingWindow.bind(this));
	  });
	  plugin.insert('Tile.prototype.construct', function() {
	    this.newProperty('animationIdle', {
	      settable: false,
	      initial: true
	    }).plug(Kefir.and([this.p('fullyOpen').or(this.p('fullyClosed')), this.p('fullyHidden').or(this.p('fullyVisible')), this.p('fullyMaximized').or(this.p('fullyNotMaximized'))]));
	  });
	  plugin.insert('Circuitboard.prototype.construct', function() {
	    var $__0 = this;
	    this.newProperty('offset', {
	      settable: false,
	      isEqual: U.Position.equals,
	      initial: this.element.offset()
	    }).plug(Kefir.merge([Kefir.once(), Kefir.interval(1000)]).limitedBy(this._posTrackingLimiter).map((function() {
	      return $__0.element.offset();
	    })));
	  }).insert('Tilemap.prototype.construct', function() {
	    var $__0 = this;
	    this.newProperty('offset', {
	      settable: false,
	      isEqual: U.Position.equals,
	      initial: this.element.offset()
	    }).plug(Kefir.merge([Kefir.once(), this.parent.p('size').changes(), this.parent.p('offset').changes()]).limitedBy(this.circuitboard._posTrackingLimiter).map((function() {
	      return $__0.element.offset();
	    })));
	  }).insert('Tile.prototype.construct', function() {
	    var $__0 = this;
	    this.newProperty('offset', {
	      settable: false,
	      isEqual: U.Position.equals,
	      initial: this.element.offset()
	    }).plug(Kefir.merge([Kefir.once(), this.parent.p('size').changes(), this.parent.p('offset').changes(), this.parent.on('reorganize'), this.p('animationIdle').value(true), Kefir.interval(1000).filterBy(this.p('animationIdle'))]).filter((function() {
	      return !$__0._offsetUpdated;
	    })).limitedBy(this.circuitboard._posTrackingLimiter).map((function() {
	      $__0._offsetUpdated = true;
	      return $__0.element.offset();
	    })));
	    this._offsetUpdated = false;
	    Kefir.interval(100).onValue((function() {
	      $__0._offsetUpdated = false;
	    }));
	  });
	  plugin.insert('Circuitboard.prototype.construct', function() {
	    this.newProperty('position', {
	      settable: false,
	      initial: new U.Position(0, 0)
	    });
	  }).insert('Tilemap.prototype.construct', function() {
	    var $__0 = this;
	    this.newProperty('position', {
	      settable: false,
	      isEqual: U.Position.equals
	    }).plug(Kefir.merge([Kefir.once(), this.p('offset').changes(), this.circuitboard.p('offset').changes()]).map((function() {
	      return U.Position.subtract($__0.offset, $__0.circuitboard.offset);
	    })));
	  }).insert('Tile.prototype.construct', function() {
	    var $__0 = this;
	    this.newProperty('position', {
	      settable: false,
	      isEqual: U.Position.equals
	    }).plug(Kefir.merge([Kefir.once(), this.p('offset').changes(), this.circuitboard.p('offset').changes(), this.p('animationIdle').value(true), Kefir.interval(1000).filterBy(this.p('animationIdle'))]).filter((function() {
	      return !$__0._positionUpdated;
	    })).map((function() {
	      $__0._positionUpdated = true;
	      return U.Position.subtract($__0.offset, $__0.circuitboard.offset);
	    })));
	    this._positionUpdated = false;
	    Kefir.interval(100).onValue((function() {
	      $__0._positionUpdated = false;
	    }));
	  });
	  plugin.insert('Circuitboard.prototype.construct', function() {
	    var $__0 = this;
	    this.newProperty('size', {
	      settable: false,
	      isEqual: U.Size.equals
	    }).plug(Kefir.merge([Kefir.once(), this.options.resizeEvent || $(window).asKefirStream('resize')]).map((function() {
	      return new U.Size($__0.element.height(), $__0.element.width());
	    })));
	  }).insert('Tilemap.prototype.construct', function() {
	    var $__0 = this;
	    this.newProperty('size', {
	      settable: false,
	      isEqual: U.Size.equals
	    }).plug(Kefir.merge([Kefir.once(), this.parent.p('size').changes()]).map((function() {
	      return new U.Size($__0.element.height(), $__0.element.width());
	    })));
	  }).insert('Tile.prototype.construct', function() {
	    var $__0 = this;
	    this.newProperty('size', {
	      settable: false,
	      isEqual: U.Size.equals
	    }).plug(Kefir.merge([Kefir.once(), this.parent.p('size').changes(), this.parent.on('reorganize'), this.p('animationIdle').value(true), Kefir.interval(1000).filterBy(this.p('animationIdle'))]).filter((function() {
	      return !$__0._sizeUpdated;
	    })).map((function() {
	      $__0._sizeUpdated = true;
	      return new U.Size($__0.element.height(), $__0.element.width());
	    })));
	    this._sizeUpdated = false;
	    Kefir.interval(100).onValue((function() {
	      $__0._sizeUpdated = false;
	    }));
	  });
	  plugin.insert('Tilemap.prototype.construct', function() {
	    this.newEvent('reorganize');
	  }).insert('Tile.prototype.construct', function() {
	    var $__0 = this;
	    this.p('size').onValue((function() {
	      $__0.parent.trigger('reorganize');
	    }));
	  });
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 13 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(26), __webpack_require__(21)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, Kefir) {
	  'use strict';
	  var plugin = $.circuitboard.plugin({
	    name: 'transition-position-tracking',
	    resolves: ['position-tracking', 'tile-grow-when-open']
	  });
	  plugin.insert('Tile.prototype.construct', function() {});
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 14 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function(global) {module.exports = global["jQuery"] = __webpack_require__(15);
	/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))

/***/ },
/* 15 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(global, factory) {
	  if (typeof module === "object" && typeof module.exports === "object") {
	    module.exports = global.document ? factory(global, true) : function(w) {
	      if (!w.document) {
	        throw new Error("jQuery requires a window with a document");
	      }
	      return factory(w);
	    };
	  } else {
	    factory(global);
	  }
	}(typeof window !== "undefined" ? window : this, function(window, noGlobal) {
	  var arr = [];
	  var slice = arr.slice;
	  var concat = arr.concat;
	  var push = arr.push;
	  var indexOf = arr.indexOf;
	  var class2type = {};
	  var toString = class2type.toString;
	  var hasOwn = class2type.hasOwnProperty;
	  var support = {};
	  var document = window.document,
	      version = "2.1.3",
	      jQuery = function(selector, context) {
	        return new jQuery.fn.init(selector, context);
	      },
	      rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
	      rmsPrefix = /^-ms-/,
	      rdashAlpha = /-([\da-z])/gi,
	      fcamelCase = function(all, letter) {
	        return letter.toUpperCase();
	      };
	  jQuery.fn = jQuery.prototype = {
	    jquery: version,
	    constructor: jQuery,
	    selector: "",
	    length: 0,
	    toArray: function() {
	      return slice.call(this);
	    },
	    get: function(num) {
	      return num != null ? (num < 0 ? this[num + this.length] : this[num]) : slice.call(this);
	    },
	    pushStack: function(elems) {
	      var ret = jQuery.merge(this.constructor(), elems);
	      ret.prevObject = this;
	      ret.context = this.context;
	      return ret;
	    },
	    each: function(callback, args) {
	      return jQuery.each(this, callback, args);
	    },
	    map: function(callback) {
	      return this.pushStack(jQuery.map(this, function(elem, i) {
	        return callback.call(elem, i, elem);
	      }));
	    },
	    slice: function() {
	      return this.pushStack(slice.apply(this, arguments));
	    },
	    first: function() {
	      return this.eq(0);
	    },
	    last: function() {
	      return this.eq(-1);
	    },
	    eq: function(i) {
	      var len = this.length,
	          j = +i + (i < 0 ? len : 0);
	      return this.pushStack(j >= 0 && j < len ? [this[j]] : []);
	    },
	    end: function() {
	      return this.prevObject || this.constructor(null);
	    },
	    push: push,
	    sort: arr.sort,
	    splice: arr.splice
	  };
	  jQuery.extend = jQuery.fn.extend = function() {
	    var options,
	        name,
	        src,
	        copy,
	        copyIsArray,
	        clone,
	        target = arguments[0] || {},
	        i = 1,
	        length = arguments.length,
	        deep = false;
	    if (typeof target === "boolean") {
	      deep = target;
	      target = arguments[i] || {};
	      i++;
	    }
	    if (typeof target !== "object" && !jQuery.isFunction(target)) {
	      target = {};
	    }
	    if (i === length) {
	      target = this;
	      i--;
	    }
	    for (; i < length; i++) {
	      if ((options = arguments[i]) != null) {
	        for (name in options) {
	          src = target[name];
	          copy = options[name];
	          if (target === copy) {
	            continue;
	          }
	          if (deep && copy && (jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)))) {
	            if (copyIsArray) {
	              copyIsArray = false;
	              clone = src && jQuery.isArray(src) ? src : [];
	            } else {
	              clone = src && jQuery.isPlainObject(src) ? src : {};
	            }
	            target[name] = jQuery.extend(deep, clone, copy);
	          } else if (copy !== undefined) {
	            target[name] = copy;
	          }
	        }
	      }
	    }
	    return target;
	  };
	  jQuery.extend({
	    expando: "jQuery" + (version + Math.random()).replace(/\D/g, ""),
	    isReady: true,
	    error: function(msg) {
	      throw new Error(msg);
	    },
	    noop: function() {},
	    isFunction: function(obj) {
	      return jQuery.type(obj) === "function";
	    },
	    isArray: Array.isArray,
	    isWindow: function(obj) {
	      return obj != null && obj === obj.window;
	    },
	    isNumeric: function(obj) {
	      return !jQuery.isArray(obj) && (obj - parseFloat(obj) + 1) >= 0;
	    },
	    isPlainObject: function(obj) {
	      if (jQuery.type(obj) !== "object" || obj.nodeType || jQuery.isWindow(obj)) {
	        return false;
	      }
	      if (obj.constructor && !hasOwn.call(obj.constructor.prototype, "isPrototypeOf")) {
	        return false;
	      }
	      return true;
	    },
	    isEmptyObject: function(obj) {
	      var name;
	      for (name in obj) {
	        return false;
	      }
	      return true;
	    },
	    type: function(obj) {
	      if (obj == null) {
	        return obj + "";
	      }
	      return typeof obj === "object" || typeof obj === "function" ? class2type[toString.call(obj)] || "object" : typeof obj;
	    },
	    globalEval: function(code) {
	      var script,
	          indirect = eval;
	      code = jQuery.trim(code);
	      if (code) {
	        if (code.indexOf("use strict") === 1) {
	          script = document.createElement("script");
	          script.text = code;
	          document.head.appendChild(script).parentNode.removeChild(script);
	        } else {
	          indirect(code);
	        }
	      }
	    },
	    camelCase: function(string) {
	      return string.replace(rmsPrefix, "ms-").replace(rdashAlpha, fcamelCase);
	    },
	    nodeName: function(elem, name) {
	      return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();
	    },
	    each: function(obj, callback, args) {
	      var value,
	          i = 0,
	          length = obj.length,
	          isArray = isArraylike(obj);
	      if (args) {
	        if (isArray) {
	          for (; i < length; i++) {
	            value = callback.apply(obj[i], args);
	            if (value === false) {
	              break;
	            }
	          }
	        } else {
	          for (i in obj) {
	            value = callback.apply(obj[i], args);
	            if (value === false) {
	              break;
	            }
	          }
	        }
	      } else {
	        if (isArray) {
	          for (; i < length; i++) {
	            value = callback.call(obj[i], i, obj[i]);
	            if (value === false) {
	              break;
	            }
	          }
	        } else {
	          for (i in obj) {
	            value = callback.call(obj[i], i, obj[i]);
	            if (value === false) {
	              break;
	            }
	          }
	        }
	      }
	      return obj;
	    },
	    trim: function(text) {
	      return text == null ? "" : (text + "").replace(rtrim, "");
	    },
	    makeArray: function(arr, results) {
	      var ret = results || [];
	      if (arr != null) {
	        if (isArraylike(Object(arr))) {
	          jQuery.merge(ret, typeof arr === "string" ? [arr] : arr);
	        } else {
	          push.call(ret, arr);
	        }
	      }
	      return ret;
	    },
	    inArray: function(elem, arr, i) {
	      return arr == null ? -1 : indexOf.call(arr, elem, i);
	    },
	    merge: function(first, second) {
	      var len = +second.length,
	          j = 0,
	          i = first.length;
	      for (; j < len; j++) {
	        first[i++] = second[j];
	      }
	      first.length = i;
	      return first;
	    },
	    grep: function(elems, callback, invert) {
	      var callbackInverse,
	          matches = [],
	          i = 0,
	          length = elems.length,
	          callbackExpect = !invert;
	      for (; i < length; i++) {
	        callbackInverse = !callback(elems[i], i);
	        if (callbackInverse !== callbackExpect) {
	          matches.push(elems[i]);
	        }
	      }
	      return matches;
	    },
	    map: function(elems, callback, arg) {
	      var value,
	          i = 0,
	          length = elems.length,
	          isArray = isArraylike(elems),
	          ret = [];
	      if (isArray) {
	        for (; i < length; i++) {
	          value = callback(elems[i], i, arg);
	          if (value != null) {
	            ret.push(value);
	          }
	        }
	      } else {
	        for (i in elems) {
	          value = callback(elems[i], i, arg);
	          if (value != null) {
	            ret.push(value);
	          }
	        }
	      }
	      return concat.apply([], ret);
	    },
	    guid: 1,
	    proxy: function(fn, context) {
	      var tmp,
	          args,
	          proxy;
	      if (typeof context === "string") {
	        tmp = fn[context];
	        context = fn;
	        fn = tmp;
	      }
	      if (!jQuery.isFunction(fn)) {
	        return undefined;
	      }
	      args = slice.call(arguments, 2);
	      proxy = function() {
	        return fn.apply(context || this, args.concat(slice.call(arguments)));
	      };
	      proxy.guid = fn.guid = fn.guid || jQuery.guid++;
	      return proxy;
	    },
	    now: Date.now,
	    support: support
	  });
	  jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name) {
	    class2type["[object " + name + "]"] = name.toLowerCase();
	  });
	  function isArraylike(obj) {
	    var length = obj.length,
	        type = jQuery.type(obj);
	    if (type === "function" || jQuery.isWindow(obj)) {
	      return false;
	    }
	    if (obj.nodeType === 1 && length) {
	      return true;
	    }
	    return type === "array" || length === 0 || typeof length === "number" && length > 0 && (length - 1) in obj;
	  }
	  var Sizzle = (function(window) {
	    var i,
	        support,
	        Expr,
	        getText,
	        isXML,
	        tokenize,
	        compile,
	        select,
	        outermostContext,
	        sortInput,
	        hasDuplicate,
	        setDocument,
	        document,
	        docElem,
	        documentIsHTML,
	        rbuggyQSA,
	        rbuggyMatches,
	        matches,
	        contains,
	        expando = "sizzle" + 1 * new Date(),
	        preferredDoc = window.document,
	        dirruns = 0,
	        done = 0,
	        classCache = createCache(),
	        tokenCache = createCache(),
	        compilerCache = createCache(),
	        sortOrder = function(a, b) {
	          if (a === b) {
	            hasDuplicate = true;
	          }
	          return 0;
	        },
	        MAX_NEGATIVE = 1 << 31,
	        hasOwn = ({}).hasOwnProperty,
	        arr = [],
	        pop = arr.pop,
	        push_native = arr.push,
	        push = arr.push,
	        slice = arr.slice,
	        indexOf = function(list, elem) {
	          var i = 0,
	              len = list.length;
	          for (; i < len; i++) {
	            if (list[i] === elem) {
	              return i;
	            }
	          }
	          return -1;
	        },
	        booleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
	        whitespace = "[\\x20\\t\\r\\n\\f]",
	        characterEncoding = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
	        identifier = characterEncoding.replace("w", "w#"),
	        attributes = "\\[" + whitespace + "*(" + characterEncoding + ")(?:" + whitespace + "*([*^$|!~]?=)" + whitespace + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" + whitespace + "*\\]",
	        pseudos = ":(" + characterEncoding + ")(?:\\((" + "('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" + "((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" + ".*" + ")\\)|)",
	        rwhitespace = new RegExp(whitespace + "+", "g"),
	        rtrim = new RegExp("^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" + whitespace + "+$", "g"),
	        rcomma = new RegExp("^" + whitespace + "*," + whitespace + "*"),
	        rcombinators = new RegExp("^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*"),
	        rattributeQuotes = new RegExp("=" + whitespace + "*([^\\]'\"]*?)" + whitespace + "*\\]", "g"),
	        rpseudo = new RegExp(pseudos),
	        ridentifier = new RegExp("^" + identifier + "$"),
	        matchExpr = {
	          "ID": new RegExp("^#(" + characterEncoding + ")"),
	          "CLASS": new RegExp("^\\.(" + characterEncoding + ")"),
	          "TAG": new RegExp("^(" + characterEncoding.replace("w", "w*") + ")"),
	          "ATTR": new RegExp("^" + attributes),
	          "PSEUDO": new RegExp("^" + pseudos),
	          "CHILD": new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + whitespace + "*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace + "*(\\d+)|))" + whitespace + "*\\)|)", "i"),
	          "bool": new RegExp("^(?:" + booleans + ")$", "i"),
	          "needsContext": new RegExp("^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + whitespace + "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i")
	        },
	        rinputs = /^(?:input|select|textarea|button)$/i,
	        rheader = /^h\d$/i,
	        rnative = /^[^{]+\{\s*\[native \w/,
	        rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
	        rsibling = /[+~]/,
	        rescape = /'|\\/g,
	        runescape = new RegExp("\\\\([\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig"),
	        funescape = function(_, escaped, escapedWhitespace) {
	          var high = "0x" + escaped - 0x10000;
	          return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 0x10000) : String.fromCharCode(high >> 10 | 0xD800, high & 0x3FF | 0xDC00);
	        },
	        unloadHandler = function() {
	          setDocument();
	        };
	    try {
	      push.apply((arr = slice.call(preferredDoc.childNodes)), preferredDoc.childNodes);
	      arr[preferredDoc.childNodes.length].nodeType;
	    } catch (e) {
	      push = {apply: arr.length ? function(target, els) {
	          push_native.apply(target, slice.call(els));
	        } : function(target, els) {
	          var j = target.length,
	              i = 0;
	          while ((target[j++] = els[i++])) {}
	          target.length = j - 1;
	        }};
	    }
	    function Sizzle(selector, context, results, seed) {
	      var match,
	          elem,
	          m,
	          nodeType,
	          i,
	          groups,
	          old,
	          nid,
	          newContext,
	          newSelector;
	      if ((context ? context.ownerDocument || context : preferredDoc) !== document) {
	        setDocument(context);
	      }
	      context = context || document;
	      results = results || [];
	      nodeType = context.nodeType;
	      if (typeof selector !== "string" || !selector || nodeType !== 1 && nodeType !== 9 && nodeType !== 11) {
	        return results;
	      }
	      if (!seed && documentIsHTML) {
	        if (nodeType !== 11 && (match = rquickExpr.exec(selector))) {
	          if ((m = match[1])) {
	            if (nodeType === 9) {
	              elem = context.getElementById(m);
	              if (elem && elem.parentNode) {
	                if (elem.id === m) {
	                  results.push(elem);
	                  return results;
	                }
	              } else {
	                return results;
	              }
	            } else {
	              if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains(context, elem) && elem.id === m) {
	                results.push(elem);
	                return results;
	              }
	            }
	          } else if (match[2]) {
	            push.apply(results, context.getElementsByTagName(selector));
	            return results;
	          } else if ((m = match[3]) && support.getElementsByClassName) {
	            push.apply(results, context.getElementsByClassName(m));
	            return results;
	          }
	        }
	        if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {
	          nid = old = expando;
	          newContext = context;
	          newSelector = nodeType !== 1 && selector;
	          if (nodeType === 1 && context.nodeName.toLowerCase() !== "object") {
	            groups = tokenize(selector);
	            if ((old = context.getAttribute("id"))) {
	              nid = old.replace(rescape, "\\$&");
	            } else {
	              context.setAttribute("id", nid);
	            }
	            nid = "[id='" + nid + "'] ";
	            i = groups.length;
	            while (i--) {
	              groups[i] = nid + toSelector(groups[i]);
	            }
	            newContext = rsibling.test(selector) && testContext(context.parentNode) || context;
	            newSelector = groups.join(",");
	          }
	          if (newSelector) {
	            try {
	              push.apply(results, newContext.querySelectorAll(newSelector));
	              return results;
	            } catch (qsaError) {} finally {
	              if (!old) {
	                context.removeAttribute("id");
	              }
	            }
	          }
	        }
	      }
	      return select(selector.replace(rtrim, "$1"), context, results, seed);
	    }
	    function createCache() {
	      var keys = [];
	      function cache(key, value) {
	        if (keys.push(key + " ") > Expr.cacheLength) {
	          delete cache[keys.shift()];
	        }
	        return (cache[key + " "] = value);
	      }
	      return cache;
	    }
	    function markFunction(fn) {
	      fn[expando] = true;
	      return fn;
	    }
	    function assert(fn) {
	      var div = document.createElement("div");
	      try {
	        return !!fn(div);
	      } catch (e) {
	        return false;
	      } finally {
	        if (div.parentNode) {
	          div.parentNode.removeChild(div);
	        }
	        div = null;
	      }
	    }
	    function addHandle(attrs, handler) {
	      var arr = attrs.split("|"),
	          i = attrs.length;
	      while (i--) {
	        Expr.attrHandle[arr[i]] = handler;
	      }
	    }
	    function siblingCheck(a, b) {
	      var cur = b && a,
	          diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);
	      if (diff) {
	        return diff;
	      }
	      if (cur) {
	        while ((cur = cur.nextSibling)) {
	          if (cur === b) {
	            return -1;
	          }
	        }
	      }
	      return a ? 1 : -1;
	    }
	    function createInputPseudo(type) {
	      return function(elem) {
	        var name = elem.nodeName.toLowerCase();
	        return name === "input" && elem.type === type;
	      };
	    }
	    function createButtonPseudo(type) {
	      return function(elem) {
	        var name = elem.nodeName.toLowerCase();
	        return (name === "input" || name === "button") && elem.type === type;
	      };
	    }
	    function createPositionalPseudo(fn) {
	      return markFunction(function(argument) {
	        argument = +argument;
	        return markFunction(function(seed, matches) {
	          var j,
	              matchIndexes = fn([], seed.length, argument),
	              i = matchIndexes.length;
	          while (i--) {
	            if (seed[(j = matchIndexes[i])]) {
	              seed[j] = !(matches[j] = seed[j]);
	            }
	          }
	        });
	      });
	    }
	    function testContext(context) {
	      return context && typeof context.getElementsByTagName !== "undefined" && context;
	    }
	    support = Sizzle.support = {};
	    isXML = Sizzle.isXML = function(elem) {
	      var documentElement = elem && (elem.ownerDocument || elem).documentElement;
	      return documentElement ? documentElement.nodeName !== "HTML" : false;
	    };
	    setDocument = Sizzle.setDocument = function(node) {
	      var hasCompare,
	          parent,
	          doc = node ? node.ownerDocument || node : preferredDoc;
	      if (doc === document || doc.nodeType !== 9 || !doc.documentElement) {
	        return document;
	      }
	      document = doc;
	      docElem = doc.documentElement;
	      parent = doc.defaultView;
	      if (parent && parent !== parent.top) {
	        if (parent.addEventListener) {
	          parent.addEventListener("unload", unloadHandler, false);
	        } else if (parent.attachEvent) {
	          parent.attachEvent("onunload", unloadHandler);
	        }
	      }
	      documentIsHTML = !isXML(doc);
	      support.attributes = assert(function(div) {
	        div.className = "i";
	        return !div.getAttribute("className");
	      });
	      support.getElementsByTagName = assert(function(div) {
	        div.appendChild(doc.createComment(""));
	        return !div.getElementsByTagName("*").length;
	      });
	      support.getElementsByClassName = rnative.test(doc.getElementsByClassName);
	      support.getById = assert(function(div) {
	        docElem.appendChild(div).id = expando;
	        return !doc.getElementsByName || !doc.getElementsByName(expando).length;
	      });
	      if (support.getById) {
	        Expr.find["ID"] = function(id, context) {
	          if (typeof context.getElementById !== "undefined" && documentIsHTML) {
	            var m = context.getElementById(id);
	            return m && m.parentNode ? [m] : [];
	          }
	        };
	        Expr.filter["ID"] = function(id) {
	          var attrId = id.replace(runescape, funescape);
	          return function(elem) {
	            return elem.getAttribute("id") === attrId;
	          };
	        };
	      } else {
	        delete Expr.find["ID"];
	        Expr.filter["ID"] = function(id) {
	          var attrId = id.replace(runescape, funescape);
	          return function(elem) {
	            var node = typeof elem.getAttributeNode !== "undefined" && elem.getAttributeNode("id");
	            return node && node.value === attrId;
	          };
	        };
	      }
	      Expr.find["TAG"] = support.getElementsByTagName ? function(tag, context) {
	        if (typeof context.getElementsByTagName !== "undefined") {
	          return context.getElementsByTagName(tag);
	        } else if (support.qsa) {
	          return context.querySelectorAll(tag);
	        }
	      } : function(tag, context) {
	        var elem,
	            tmp = [],
	            i = 0,
	            results = context.getElementsByTagName(tag);
	        if (tag === "*") {
	          while ((elem = results[i++])) {
	            if (elem.nodeType === 1) {
	              tmp.push(elem);
	            }
	          }
	          return tmp;
	        }
	        return results;
	      };
	      Expr.find["CLASS"] = support.getElementsByClassName && function(className, context) {
	        if (documentIsHTML) {
	          return context.getElementsByClassName(className);
	        }
	      };
	      rbuggyMatches = [];
	      rbuggyQSA = [];
	      if ((support.qsa = rnative.test(doc.querySelectorAll))) {
	        assert(function(div) {
	          docElem.appendChild(div).innerHTML = "<a id='" + expando + "'></a>" + "<select id='" + expando + "-\f]' msallowcapture=''>" + "<option selected=''></option></select>";
	          if (div.querySelectorAll("[msallowcapture^='']").length) {
	            rbuggyQSA.push("[*^$]=" + whitespace + "*(?:''|\"\")");
	          }
	          if (!div.querySelectorAll("[selected]").length) {
	            rbuggyQSA.push("\\[" + whitespace + "*(?:value|" + booleans + ")");
	          }
	          if (!div.querySelectorAll("[id~=" + expando + "-]").length) {
	            rbuggyQSA.push("~=");
	          }
	          if (!div.querySelectorAll(":checked").length) {
	            rbuggyQSA.push(":checked");
	          }
	          if (!div.querySelectorAll("a#" + expando + "+*").length) {
	            rbuggyQSA.push(".#.+[+~]");
	          }
	        });
	        assert(function(div) {
	          var input = doc.createElement("input");
	          input.setAttribute("type", "hidden");
	          div.appendChild(input).setAttribute("name", "D");
	          if (div.querySelectorAll("[name=d]").length) {
	            rbuggyQSA.push("name" + whitespace + "*[*^$|!~]?=");
	          }
	          if (!div.querySelectorAll(":enabled").length) {
	            rbuggyQSA.push(":enabled", ":disabled");
	          }
	          div.querySelectorAll("*,:x");
	          rbuggyQSA.push(",.*:");
	        });
	      }
	      if ((support.matchesSelector = rnative.test((matches = docElem.matches || docElem.webkitMatchesSelector || docElem.mozMatchesSelector || docElem.oMatchesSelector || docElem.msMatchesSelector)))) {
	        assert(function(div) {
	          support.disconnectedMatch = matches.call(div, "div");
	          matches.call(div, "[s!='']:x");
	          rbuggyMatches.push("!=", pseudos);
	        });
	      }
	      rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join("|"));
	      rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join("|"));
	      hasCompare = rnative.test(docElem.compareDocumentPosition);
	      contains = hasCompare || rnative.test(docElem.contains) ? function(a, b) {
	        var adown = a.nodeType === 9 ? a.documentElement : a,
	            bup = b && b.parentNode;
	        return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));
	      } : function(a, b) {
	        if (b) {
	          while ((b = b.parentNode)) {
	            if (b === a) {
	              return true;
	            }
	          }
	        }
	        return false;
	      };
	      sortOrder = hasCompare ? function(a, b) {
	        if (a === b) {
	          hasDuplicate = true;
	          return 0;
	        }
	        var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;
	        if (compare) {
	          return compare;
	        }
	        compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;
	        if (compare & 1 || (!support.sortDetached && b.compareDocumentPosition(a) === compare)) {
	          if (a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a)) {
	            return -1;
	          }
	          if (b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b)) {
	            return 1;
	          }
	          return sortInput ? (indexOf(sortInput, a) - indexOf(sortInput, b)) : 0;
	        }
	        return compare & 4 ? -1 : 1;
	      } : function(a, b) {
	        if (a === b) {
	          hasDuplicate = true;
	          return 0;
	        }
	        var cur,
	            i = 0,
	            aup = a.parentNode,
	            bup = b.parentNode,
	            ap = [a],
	            bp = [b];
	        if (!aup || !bup) {
	          return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? (indexOf(sortInput, a) - indexOf(sortInput, b)) : 0;
	        } else if (aup === bup) {
	          return siblingCheck(a, b);
	        }
	        cur = a;
	        while ((cur = cur.parentNode)) {
	          ap.unshift(cur);
	        }
	        cur = b;
	        while ((cur = cur.parentNode)) {
	          bp.unshift(cur);
	        }
	        while (ap[i] === bp[i]) {
	          i++;
	        }
	        return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;
	      };
	      return doc;
	    };
	    Sizzle.matches = function(expr, elements) {
	      return Sizzle(expr, null, null, elements);
	    };
	    Sizzle.matchesSelector = function(elem, expr) {
	      if ((elem.ownerDocument || elem) !== document) {
	        setDocument(elem);
	      }
	      expr = expr.replace(rattributeQuotes, "='$1']");
	      if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {
	        try {
	          var ret = matches.call(elem, expr);
	          if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {
	            return ret;
	          }
	        } catch (e) {}
	      }
	      return Sizzle(expr, document, null, [elem]).length > 0;
	    };
	    Sizzle.contains = function(context, elem) {
	      if ((context.ownerDocument || context) !== document) {
	        setDocument(context);
	      }
	      return contains(context, elem);
	    };
	    Sizzle.attr = function(elem, name) {
	      if ((elem.ownerDocument || elem) !== document) {
	        setDocument(elem);
	      }
	      var fn = Expr.attrHandle[name.toLowerCase()],
	          val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;
	      return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;
	    };
	    Sizzle.error = function(msg) {
	      throw new Error("Syntax error, unrecognized expression: " + msg);
	    };
	    Sizzle.uniqueSort = function(results) {
	      var elem,
	          duplicates = [],
	          j = 0,
	          i = 0;
	      hasDuplicate = !support.detectDuplicates;
	      sortInput = !support.sortStable && results.slice(0);
	      results.sort(sortOrder);
	      if (hasDuplicate) {
	        while ((elem = results[i++])) {
	          if (elem === results[i]) {
	            j = duplicates.push(i);
	          }
	        }
	        while (j--) {
	          results.splice(duplicates[j], 1);
	        }
	      }
	      sortInput = null;
	      return results;
	    };
	    getText = Sizzle.getText = function(elem) {
	      var node,
	          ret = "",
	          i = 0,
	          nodeType = elem.nodeType;
	      if (!nodeType) {
	        while ((node = elem[i++])) {
	          ret += getText(node);
	        }
	      } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {
	        if (typeof elem.textContent === "string") {
	          return elem.textContent;
	        } else {
	          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {
	            ret += getText(elem);
	          }
	        }
	      } else if (nodeType === 3 || nodeType === 4) {
	        return elem.nodeValue;
	      }
	      return ret;
	    };
	    Expr = Sizzle.selectors = {
	      cacheLength: 50,
	      createPseudo: markFunction,
	      match: matchExpr,
	      attrHandle: {},
	      find: {},
	      relative: {
	        ">": {
	          dir: "parentNode",
	          first: true
	        },
	        " ": {dir: "parentNode"},
	        "+": {
	          dir: "previousSibling",
	          first: true
	        },
	        "~": {dir: "previousSibling"}
	      },
	      preFilter: {
	        "ATTR": function(match) {
	          match[1] = match[1].replace(runescape, funescape);
	          match[3] = (match[3] || match[4] || match[5] || "").replace(runescape, funescape);
	          if (match[2] === "~=") {
	            match[3] = " " + match[3] + " ";
	          }
	          return match.slice(0, 4);
	        },
	        "CHILD": function(match) {
	          match[1] = match[1].toLowerCase();
	          if (match[1].slice(0, 3) === "nth") {
	            if (!match[3]) {
	              Sizzle.error(match[0]);
	            }
	            match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === "even" || match[3] === "odd"));
	            match[5] = +((match[7] + match[8]) || match[3] === "odd");
	          } else if (match[3]) {
	            Sizzle.error(match[0]);
	          }
	          return match;
	        },
	        "PSEUDO": function(match) {
	          var excess,
	              unquoted = !match[6] && match[2];
	          if (matchExpr["CHILD"].test(match[0])) {
	            return null;
	          }
	          if (match[3]) {
	            match[2] = match[4] || match[5] || "";
	          } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(")", unquoted.length - excess) - unquoted.length)) {
	            match[0] = match[0].slice(0, excess);
	            match[2] = unquoted.slice(0, excess);
	          }
	          return match.slice(0, 3);
	        }
	      },
	      filter: {
	        "TAG": function(nodeNameSelector) {
	          var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();
	          return nodeNameSelector === "*" ? function() {
	            return true;
	          } : function(elem) {
	            return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;
	          };
	        },
	        "CLASS": function(className) {
	          var pattern = classCache[className + " "];
	          return pattern || (pattern = new RegExp("(^|" + whitespace + ")" + className + "(" + whitespace + "|$)")) && classCache(className, function(elem) {
	            return pattern.test(typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== "undefined" && elem.getAttribute("class") || "");
	          });
	        },
	        "ATTR": function(name, operator, check) {
	          return function(elem) {
	            var result = Sizzle.attr(elem, name);
	            if (result == null) {
	              return operator === "!=";
	            }
	            if (!operator) {
	              return true;
	            }
	            result += "";
	            return operator === "=" ? result === check : operator === "!=" ? result !== check : operator === "^=" ? check && result.indexOf(check) === 0 : operator === "*=" ? check && result.indexOf(check) > -1 : operator === "$=" ? check && result.slice(-check.length) === check : operator === "~=" ? (" " + result.replace(rwhitespace, " ") + " ").indexOf(check) > -1 : operator === "|=" ? result === check || result.slice(0, check.length + 1) === check + "-" : false;
	          };
	        },
	        "CHILD": function(type, what, argument, first, last) {
	          var simple = type.slice(0, 3) !== "nth",
	              forward = type.slice(-4) !== "last",
	              ofType = what === "of-type";
	          return first === 1 && last === 0 ? function(elem) {
	            return !!elem.parentNode;
	          } : function(elem, context, xml) {
	            var cache,
	                outerCache,
	                node,
	                diff,
	                nodeIndex,
	                start,
	                dir = simple !== forward ? "nextSibling" : "previousSibling",
	                parent = elem.parentNode,
	                name = ofType && elem.nodeName.toLowerCase(),
	                useCache = !xml && !ofType;
	            if (parent) {
	              if (simple) {
	                while (dir) {
	                  node = elem;
	                  while ((node = node[dir])) {
	                    if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {
	                      return false;
	                    }
	                  }
	                  start = dir = type === "only" && !start && "nextSibling";
	                }
	                return true;
	              }
	              start = [forward ? parent.firstChild : parent.lastChild];
	              if (forward && useCache) {
	                outerCache = parent[expando] || (parent[expando] = {});
	                cache = outerCache[type] || [];
	                nodeIndex = cache[0] === dirruns && cache[1];
	                diff = cache[0] === dirruns && cache[2];
	                node = nodeIndex && parent.childNodes[nodeIndex];
	                while ((node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop())) {
	                  if (node.nodeType === 1 && ++diff && node === elem) {
	                    outerCache[type] = [dirruns, nodeIndex, diff];
	                    break;
	                  }
	                }
	              } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {
	                diff = cache[1];
	              } else {
	                while ((node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop())) {
	                  if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {
	                    if (useCache) {
	                      (node[expando] || (node[expando] = {}))[type] = [dirruns, diff];
	                    }
	                    if (node === elem) {
	                      break;
	                    }
	                  }
	                }
	              }
	              diff -= last;
	              return diff === first || (diff % first === 0 && diff / first >= 0);
	            }
	          };
	        },
	        "PSEUDO": function(pseudo, argument) {
	          var args,
	              fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error("unsupported pseudo: " + pseudo);
	          if (fn[expando]) {
	            return fn(argument);
	          }
	          if (fn.length > 1) {
	            args = [pseudo, pseudo, "", argument];
	            return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function(seed, matches) {
	              var idx,
	                  matched = fn(seed, argument),
	                  i = matched.length;
	              while (i--) {
	                idx = indexOf(seed, matched[i]);
	                seed[idx] = !(matches[idx] = matched[i]);
	              }
	            }) : function(elem) {
	              return fn(elem, 0, args);
	            };
	          }
	          return fn;
	        }
	      },
	      pseudos: {
	        "not": markFunction(function(selector) {
	          var input = [],
	              results = [],
	              matcher = compile(selector.replace(rtrim, "$1"));
	          return matcher[expando] ? markFunction(function(seed, matches, context, xml) {
	            var elem,
	                unmatched = matcher(seed, null, xml, []),
	                i = seed.length;
	            while (i--) {
	              if ((elem = unmatched[i])) {
	                seed[i] = !(matches[i] = elem);
	              }
	            }
	          }) : function(elem, context, xml) {
	            input[0] = elem;
	            matcher(input, null, xml, results);
	            input[0] = null;
	            return !results.pop();
	          };
	        }),
	        "has": markFunction(function(selector) {
	          return function(elem) {
	            return Sizzle(selector, elem).length > 0;
	          };
	        }),
	        "contains": markFunction(function(text) {
	          text = text.replace(runescape, funescape);
	          return function(elem) {
	            return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;
	          };
	        }),
	        "lang": markFunction(function(lang) {
	          if (!ridentifier.test(lang || "")) {
	            Sizzle.error("unsupported lang: " + lang);
	          }
	          lang = lang.replace(runescape, funescape).toLowerCase();
	          return function(elem) {
	            var elemLang;
	            do {
	              if ((elemLang = documentIsHTML ? elem.lang : elem.getAttribute("xml:lang") || elem.getAttribute("lang"))) {
	                elemLang = elemLang.toLowerCase();
	                return elemLang === lang || elemLang.indexOf(lang + "-") === 0;
	              }
	            } while ((elem = elem.parentNode) && elem.nodeType === 1);
	            return false;
	          };
	        }),
	        "target": function(elem) {
	          var hash = window.location && window.location.hash;
	          return hash && hash.slice(1) === elem.id;
	        },
	        "root": function(elem) {
	          return elem === docElem;
	        },
	        "focus": function(elem) {
	          return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);
	        },
	        "enabled": function(elem) {
	          return elem.disabled === false;
	        },
	        "disabled": function(elem) {
	          return elem.disabled === true;
	        },
	        "checked": function(elem) {
	          var nodeName = elem.nodeName.toLowerCase();
	          return (nodeName === "input" && !!elem.checked) || (nodeName === "option" && !!elem.selected);
	        },
	        "selected": function(elem) {
	          if (elem.parentNode) {
	            elem.parentNode.selectedIndex;
	          }
	          return elem.selected === true;
	        },
	        "empty": function(elem) {
	          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {
	            if (elem.nodeType < 6) {
	              return false;
	            }
	          }
	          return true;
	        },
	        "parent": function(elem) {
	          return !Expr.pseudos["empty"](elem);
	        },
	        "header": function(elem) {
	          return rheader.test(elem.nodeName);
	        },
	        "input": function(elem) {
	          return rinputs.test(elem.nodeName);
	        },
	        "button": function(elem) {
	          var name = elem.nodeName.toLowerCase();
	          return name === "input" && elem.type === "button" || name === "button";
	        },
	        "text": function(elem) {
	          var attr;
	          return elem.nodeName.toLowerCase() === "input" && elem.type === "text" && ((attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text");
	        },
	        "first": createPositionalPseudo(function() {
	          return [0];
	        }),
	        "last": createPositionalPseudo(function(matchIndexes, length) {
	          return [length - 1];
	        }),
	        "eq": createPositionalPseudo(function(matchIndexes, length, argument) {
	          return [argument < 0 ? argument + length : argument];
	        }),
	        "even": createPositionalPseudo(function(matchIndexes, length) {
	          var i = 0;
	          for (; i < length; i += 2) {
	            matchIndexes.push(i);
	          }
	          return matchIndexes;
	        }),
	        "odd": createPositionalPseudo(function(matchIndexes, length) {
	          var i = 1;
	          for (; i < length; i += 2) {
	            matchIndexes.push(i);
	          }
	          return matchIndexes;
	        }),
	        "lt": createPositionalPseudo(function(matchIndexes, length, argument) {
	          var i = argument < 0 ? argument + length : argument;
	          for (; --i >= 0; ) {
	            matchIndexes.push(i);
	          }
	          return matchIndexes;
	        }),
	        "gt": createPositionalPseudo(function(matchIndexes, length, argument) {
	          var i = argument < 0 ? argument + length : argument;
	          for (; ++i < length; ) {
	            matchIndexes.push(i);
	          }
	          return matchIndexes;
	        })
	      }
	    };
	    Expr.pseudos["nth"] = Expr.pseudos["eq"];
	    for (i in {
	      radio: true,
	      checkbox: true,
	      file: true,
	      password: true,
	      image: true
	    }) {
	      Expr.pseudos[i] = createInputPseudo(i);
	    }
	    for (i in {
	      submit: true,
	      reset: true
	    }) {
	      Expr.pseudos[i] = createButtonPseudo(i);
	    }
	    function setFilters() {}
	    setFilters.prototype = Expr.filters = Expr.pseudos;
	    Expr.setFilters = new setFilters();
	    tokenize = Sizzle.tokenize = function(selector, parseOnly) {
	      var matched,
	          match,
	          tokens,
	          type,
	          soFar,
	          groups,
	          preFilters,
	          cached = tokenCache[selector + " "];
	      if (cached) {
	        return parseOnly ? 0 : cached.slice(0);
	      }
	      soFar = selector;
	      groups = [];
	      preFilters = Expr.preFilter;
	      while (soFar) {
	        if (!matched || (match = rcomma.exec(soFar))) {
	          if (match) {
	            soFar = soFar.slice(match[0].length) || soFar;
	          }
	          groups.push((tokens = []));
	        }
	        matched = false;
	        if ((match = rcombinators.exec(soFar))) {
	          matched = match.shift();
	          tokens.push({
	            value: matched,
	            type: match[0].replace(rtrim, " ")
	          });
	          soFar = soFar.slice(matched.length);
	        }
	        for (type in Expr.filter) {
	          if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {
	            matched = match.shift();
	            tokens.push({
	              value: matched,
	              type: type,
	              matches: match
	            });
	            soFar = soFar.slice(matched.length);
	          }
	        }
	        if (!matched) {
	          break;
	        }
	      }
	      return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);
	    };
	    function toSelector(tokens) {
	      var i = 0,
	          len = tokens.length,
	          selector = "";
	      for (; i < len; i++) {
	        selector += tokens[i].value;
	      }
	      return selector;
	    }
	    function addCombinator(matcher, combinator, base) {
	      var dir = combinator.dir,
	          checkNonElements = base && dir === "parentNode",
	          doneName = done++;
	      return combinator.first ? function(elem, context, xml) {
	        while ((elem = elem[dir])) {
	          if (elem.nodeType === 1 || checkNonElements) {
	            return matcher(elem, context, xml);
	          }
	        }
	      } : function(elem, context, xml) {
	        var oldCache,
	            outerCache,
	            newCache = [dirruns, doneName];
	        if (xml) {
	          while ((elem = elem[dir])) {
	            if (elem.nodeType === 1 || checkNonElements) {
	              if (matcher(elem, context, xml)) {
	                return true;
	              }
	            }
	          }
	        } else {
	          while ((elem = elem[dir])) {
	            if (elem.nodeType === 1 || checkNonElements) {
	              outerCache = elem[expando] || (elem[expando] = {});
	              if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {
	                return (newCache[2] = oldCache[2]);
	              } else {
	                outerCache[dir] = newCache;
	                if ((newCache[2] = matcher(elem, context, xml))) {
	                  return true;
	                }
	              }
	            }
	          }
	        }
	      };
	    }
	    function elementMatcher(matchers) {
	      return matchers.length > 1 ? function(elem, context, xml) {
	        var i = matchers.length;
	        while (i--) {
	          if (!matchers[i](elem, context, xml)) {
	            return false;
	          }
	        }
	        return true;
	      } : matchers[0];
	    }
	    function multipleContexts(selector, contexts, results) {
	      var i = 0,
	          len = contexts.length;
	      for (; i < len; i++) {
	        Sizzle(selector, contexts[i], results);
	      }
	      return results;
	    }
	    function condense(unmatched, map, filter, context, xml) {
	      var elem,
	          newUnmatched = [],
	          i = 0,
	          len = unmatched.length,
	          mapped = map != null;
	      for (; i < len; i++) {
	        if ((elem = unmatched[i])) {
	          if (!filter || filter(elem, context, xml)) {
	            newUnmatched.push(elem);
	            if (mapped) {
	              map.push(i);
	            }
	          }
	        }
	      }
	      return newUnmatched;
	    }
	    function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {
	      if (postFilter && !postFilter[expando]) {
	        postFilter = setMatcher(postFilter);
	      }
	      if (postFinder && !postFinder[expando]) {
	        postFinder = setMatcher(postFinder, postSelector);
	      }
	      return markFunction(function(seed, results, context, xml) {
	        var temp,
	            i,
	            elem,
	            preMap = [],
	            postMap = [],
	            preexisting = results.length,
	            elems = seed || multipleContexts(selector || "*", context.nodeType ? [context] : context, []),
	            matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems,
	            matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;
	        if (matcher) {
	          matcher(matcherIn, matcherOut, context, xml);
	        }
	        if (postFilter) {
	          temp = condense(matcherOut, postMap);
	          postFilter(temp, [], context, xml);
	          i = temp.length;
	          while (i--) {
	            if ((elem = temp[i])) {
	              matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);
	            }
	          }
	        }
	        if (seed) {
	          if (postFinder || preFilter) {
	            if (postFinder) {
	              temp = [];
	              i = matcherOut.length;
	              while (i--) {
	                if ((elem = matcherOut[i])) {
	                  temp.push((matcherIn[i] = elem));
	                }
	              }
	              postFinder(null, (matcherOut = []), temp, xml);
	            }
	            i = matcherOut.length;
	            while (i--) {
	              if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf(seed, elem) : preMap[i]) > -1) {
	                seed[temp] = !(results[temp] = elem);
	              }
	            }
	          }
	        } else {
	          matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);
	          if (postFinder) {
	            postFinder(null, results, matcherOut, xml);
	          } else {
	            push.apply(results, matcherOut);
	          }
	        }
	      });
	    }
	    function matcherFromTokens(tokens) {
	      var checkContext,
	          matcher,
	          j,
	          len = tokens.length,
	          leadingRelative = Expr.relative[tokens[0].type],
	          implicitRelative = leadingRelative || Expr.relative[" "],
	          i = leadingRelative ? 1 : 0,
	          matchContext = addCombinator(function(elem) {
	            return elem === checkContext;
	          }, implicitRelative, true),
	          matchAnyContext = addCombinator(function(elem) {
	            return indexOf(checkContext, elem) > -1;
	          }, implicitRelative, true),
	          matchers = [function(elem, context, xml) {
	            var ret = (!leadingRelative && (xml || context !== outermostContext)) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));
	            checkContext = null;
	            return ret;
	          }];
	      for (; i < len; i++) {
	        if ((matcher = Expr.relative[tokens[i].type])) {
	          matchers = [addCombinator(elementMatcher(matchers), matcher)];
	        } else {
	          matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);
	          if (matcher[expando]) {
	            j = ++i;
	            for (; j < len; j++) {
	              if (Expr.relative[tokens[j].type]) {
	                break;
	              }
	            }
	            return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({value: tokens[i - 2].type === " " ? "*" : ""})).replace(rtrim, "$1"), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens((tokens = tokens.slice(j))), j < len && toSelector(tokens));
	          }
	          matchers.push(matcher);
	        }
	      }
	      return elementMatcher(matchers);
	    }
	    function matcherFromGroupMatchers(elementMatchers, setMatchers) {
	      var bySet = setMatchers.length > 0,
	          byElement = elementMatchers.length > 0,
	          superMatcher = function(seed, context, xml, results, outermost) {
	            var elem,
	                j,
	                matcher,
	                matchedCount = 0,
	                i = "0",
	                unmatched = seed && [],
	                setMatched = [],
	                contextBackup = outermostContext,
	                elems = seed || byElement && Expr.find["TAG"]("*", outermost),
	                dirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),
	                len = elems.length;
	            if (outermost) {
	              outermostContext = context !== document && context;
	            }
	            for (; i !== len && (elem = elems[i]) != null; i++) {
	              if (byElement && elem) {
	                j = 0;
	                while ((matcher = elementMatchers[j++])) {
	                  if (matcher(elem, context, xml)) {
	                    results.push(elem);
	                    break;
	                  }
	                }
	                if (outermost) {
	                  dirruns = dirrunsUnique;
	                }
	              }
	              if (bySet) {
	                if ((elem = !matcher && elem)) {
	                  matchedCount--;
	                }
	                if (seed) {
	                  unmatched.push(elem);
	                }
	              }
	            }
	            matchedCount += i;
	            if (bySet && i !== matchedCount) {
	              j = 0;
	              while ((matcher = setMatchers[j++])) {
	                matcher(unmatched, setMatched, context, xml);
	              }
	              if (seed) {
	                if (matchedCount > 0) {
	                  while (i--) {
	                    if (!(unmatched[i] || setMatched[i])) {
	                      setMatched[i] = pop.call(results);
	                    }
	                  }
	                }
	                setMatched = condense(setMatched);
	              }
	              push.apply(results, setMatched);
	              if (outermost && !seed && setMatched.length > 0 && (matchedCount + setMatchers.length) > 1) {
	                Sizzle.uniqueSort(results);
	              }
	            }
	            if (outermost) {
	              dirruns = dirrunsUnique;
	              outermostContext = contextBackup;
	            }
	            return unmatched;
	          };
	      return bySet ? markFunction(superMatcher) : superMatcher;
	    }
	    compile = Sizzle.compile = function(selector, match) {
	      var i,
	          setMatchers = [],
	          elementMatchers = [],
	          cached = compilerCache[selector + " "];
	      if (!cached) {
	        if (!match) {
	          match = tokenize(selector);
	        }
	        i = match.length;
	        while (i--) {
	          cached = matcherFromTokens(match[i]);
	          if (cached[expando]) {
	            setMatchers.push(cached);
	          } else {
	            elementMatchers.push(cached);
	          }
	        }
	        cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));
	        cached.selector = selector;
	      }
	      return cached;
	    };
	    select = Sizzle.select = function(selector, context, results, seed) {
	      var i,
	          tokens,
	          token,
	          type,
	          find,
	          compiled = typeof selector === "function" && selector,
	          match = !seed && tokenize((selector = compiled.selector || selector));
	      results = results || [];
	      if (match.length === 1) {
	        tokens = match[0] = match[0].slice(0);
	        if (tokens.length > 2 && (token = tokens[0]).type === "ID" && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {
	          context = (Expr.find["ID"](token.matches[0].replace(runescape, funescape), context) || [])[0];
	          if (!context) {
	            return results;
	          } else if (compiled) {
	            context = context.parentNode;
	          }
	          selector = selector.slice(tokens.shift().value.length);
	        }
	        i = matchExpr["needsContext"].test(selector) ? 0 : tokens.length;
	        while (i--) {
	          token = tokens[i];
	          if (Expr.relative[(type = token.type)]) {
	            break;
	          }
	          if ((find = Expr.find[type])) {
	            if ((seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context))) {
	              tokens.splice(i, 1);
	              selector = seed.length && toSelector(tokens);
	              if (!selector) {
	                push.apply(results, seed);
	                return results;
	              }
	              break;
	            }
	          }
	        }
	      }
	      (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);
	      return results;
	    };
	    support.sortStable = expando.split("").sort(sortOrder).join("") === expando;
	    support.detectDuplicates = !!hasDuplicate;
	    setDocument();
	    support.sortDetached = assert(function(div1) {
	      return div1.compareDocumentPosition(document.createElement("div")) & 1;
	    });
	    if (!assert(function(div) {
	      div.innerHTML = "<a href='#'></a>";
	      return div.firstChild.getAttribute("href") === "#";
	    })) {
	      addHandle("type|href|height|width", function(elem, name, isXML) {
	        if (!isXML) {
	          return elem.getAttribute(name, name.toLowerCase() === "type" ? 1 : 2);
	        }
	      });
	    }
	    if (!support.attributes || !assert(function(div) {
	      div.innerHTML = "<input/>";
	      div.firstChild.setAttribute("value", "");
	      return div.firstChild.getAttribute("value") === "";
	    })) {
	      addHandle("value", function(elem, name, isXML) {
	        if (!isXML && elem.nodeName.toLowerCase() === "input") {
	          return elem.defaultValue;
	        }
	      });
	    }
	    if (!assert(function(div) {
	      return div.getAttribute("disabled") == null;
	    })) {
	      addHandle(booleans, function(elem, name, isXML) {
	        var val;
	        if (!isXML) {
	          return elem[name] === true ? name.toLowerCase() : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;
	        }
	      });
	    }
	    return Sizzle;
	  })(window);
	  jQuery.find = Sizzle;
	  jQuery.expr = Sizzle.selectors;
	  jQuery.expr[":"] = jQuery.expr.pseudos;
	  jQuery.unique = Sizzle.uniqueSort;
	  jQuery.text = Sizzle.getText;
	  jQuery.isXMLDoc = Sizzle.isXML;
	  jQuery.contains = Sizzle.contains;
	  var rneedsContext = jQuery.expr.match.needsContext;
	  var rsingleTag = (/^<(\w+)\s*\/?>(?:<\/\1>|)$/);
	  var risSimple = /^.[^:#\[\.,]*$/;
	  function winnow(elements, qualifier, not) {
	    if (jQuery.isFunction(qualifier)) {
	      return jQuery.grep(elements, function(elem, i) {
	        return !!qualifier.call(elem, i, elem) !== not;
	      });
	    }
	    if (qualifier.nodeType) {
	      return jQuery.grep(elements, function(elem) {
	        return (elem === qualifier) !== not;
	      });
	    }
	    if (typeof qualifier === "string") {
	      if (risSimple.test(qualifier)) {
	        return jQuery.filter(qualifier, elements, not);
	      }
	      qualifier = jQuery.filter(qualifier, elements);
	    }
	    return jQuery.grep(elements, function(elem) {
	      return (indexOf.call(qualifier, elem) >= 0) !== not;
	    });
	  }
	  jQuery.filter = function(expr, elems, not) {
	    var elem = elems[0];
	    if (not) {
	      expr = ":not(" + expr + ")";
	    }
	    return elems.length === 1 && elem.nodeType === 1 ? jQuery.find.matchesSelector(elem, expr) ? [elem] : [] : jQuery.find.matches(expr, jQuery.grep(elems, function(elem) {
	      return elem.nodeType === 1;
	    }));
	  };
	  jQuery.fn.extend({
	    find: function(selector) {
	      var i,
	          len = this.length,
	          ret = [],
	          self = this;
	      if (typeof selector !== "string") {
	        return this.pushStack(jQuery(selector).filter(function() {
	          for (i = 0; i < len; i++) {
	            if (jQuery.contains(self[i], this)) {
	              return true;
	            }
	          }
	        }));
	      }
	      for (i = 0; i < len; i++) {
	        jQuery.find(selector, self[i], ret);
	      }
	      ret = this.pushStack(len > 1 ? jQuery.unique(ret) : ret);
	      ret.selector = this.selector ? this.selector + " " + selector : selector;
	      return ret;
	    },
	    filter: function(selector) {
	      return this.pushStack(winnow(this, selector || [], false));
	    },
	    not: function(selector) {
	      return this.pushStack(winnow(this, selector || [], true));
	    },
	    is: function(selector) {
	      return !!winnow(this, typeof selector === "string" && rneedsContext.test(selector) ? jQuery(selector) : selector || [], false).length;
	    }
	  });
	  var rootjQuery,
	      rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
	      init = jQuery.fn.init = function(selector, context) {
	        var match,
	            elem;
	        if (!selector) {
	          return this;
	        }
	        if (typeof selector === "string") {
	          if (selector[0] === "<" && selector[selector.length - 1] === ">" && selector.length >= 3) {
	            match = [null, selector, null];
	          } else {
	            match = rquickExpr.exec(selector);
	          }
	          if (match && (match[1] || !context)) {
	            if (match[1]) {
	              context = context instanceof jQuery ? context[0] : context;
	              jQuery.merge(this, jQuery.parseHTML(match[1], context && context.nodeType ? context.ownerDocument || context : document, true));
	              if (rsingleTag.test(match[1]) && jQuery.isPlainObject(context)) {
	                for (match in context) {
	                  if (jQuery.isFunction(this[match])) {
	                    this[match](context[match]);
	                  } else {
	                    this.attr(match, context[match]);
	                  }
	                }
	              }
	              return this;
	            } else {
	              elem = document.getElementById(match[2]);
	              if (elem && elem.parentNode) {
	                this.length = 1;
	                this[0] = elem;
	              }
	              this.context = document;
	              this.selector = selector;
	              return this;
	            }
	          } else if (!context || context.jquery) {
	            return (context || rootjQuery).find(selector);
	          } else {
	            return this.constructor(context).find(selector);
	          }
	        } else if (selector.nodeType) {
	          this.context = this[0] = selector;
	          this.length = 1;
	          return this;
	        } else if (jQuery.isFunction(selector)) {
	          return typeof rootjQuery.ready !== "undefined" ? rootjQuery.ready(selector) : selector(jQuery);
	        }
	        if (selector.selector !== undefined) {
	          this.selector = selector.selector;
	          this.context = selector.context;
	        }
	        return jQuery.makeArray(selector, this);
	      };
	  init.prototype = jQuery.fn;
	  rootjQuery = jQuery(document);
	  var rparentsprev = /^(?:parents|prev(?:Until|All))/,
	      guaranteedUnique = {
	        children: true,
	        contents: true,
	        next: true,
	        prev: true
	      };
	  jQuery.extend({
	    dir: function(elem, dir, until) {
	      var matched = [],
	          truncate = until !== undefined;
	      while ((elem = elem[dir]) && elem.nodeType !== 9) {
	        if (elem.nodeType === 1) {
	          if (truncate && jQuery(elem).is(until)) {
	            break;
	          }
	          matched.push(elem);
	        }
	      }
	      return matched;
	    },
	    sibling: function(n, elem) {
	      var matched = [];
	      for (; n; n = n.nextSibling) {
	        if (n.nodeType === 1 && n !== elem) {
	          matched.push(n);
	        }
	      }
	      return matched;
	    }
	  });
	  jQuery.fn.extend({
	    has: function(target) {
	      var targets = jQuery(target, this),
	          l = targets.length;
	      return this.filter(function() {
	        var i = 0;
	        for (; i < l; i++) {
	          if (jQuery.contains(this, targets[i])) {
	            return true;
	          }
	        }
	      });
	    },
	    closest: function(selectors, context) {
	      var cur,
	          i = 0,
	          l = this.length,
	          matched = [],
	          pos = rneedsContext.test(selectors) || typeof selectors !== "string" ? jQuery(selectors, context || this.context) : 0;
	      for (; i < l; i++) {
	        for (cur = this[i]; cur && cur !== context; cur = cur.parentNode) {
	          if (cur.nodeType < 11 && (pos ? pos.index(cur) > -1 : cur.nodeType === 1 && jQuery.find.matchesSelector(cur, selectors))) {
	            matched.push(cur);
	            break;
	          }
	        }
	      }
	      return this.pushStack(matched.length > 1 ? jQuery.unique(matched) : matched);
	    },
	    index: function(elem) {
	      if (!elem) {
	        return (this[0] && this[0].parentNode) ? this.first().prevAll().length : -1;
	      }
	      if (typeof elem === "string") {
	        return indexOf.call(jQuery(elem), this[0]);
	      }
	      return indexOf.call(this, elem.jquery ? elem[0] : elem);
	    },
	    add: function(selector, context) {
	      return this.pushStack(jQuery.unique(jQuery.merge(this.get(), jQuery(selector, context))));
	    },
	    addBack: function(selector) {
	      return this.add(selector == null ? this.prevObject : this.prevObject.filter(selector));
	    }
	  });
	  function sibling(cur, dir) {
	    while ((cur = cur[dir]) && cur.nodeType !== 1) {}
	    return cur;
	  }
	  jQuery.each({
	    parent: function(elem) {
	      var parent = elem.parentNode;
	      return parent && parent.nodeType !== 11 ? parent : null;
	    },
	    parents: function(elem) {
	      return jQuery.dir(elem, "parentNode");
	    },
	    parentsUntil: function(elem, i, until) {
	      return jQuery.dir(elem, "parentNode", until);
	    },
	    next: function(elem) {
	      return sibling(elem, "nextSibling");
	    },
	    prev: function(elem) {
	      return sibling(elem, "previousSibling");
	    },
	    nextAll: function(elem) {
	      return jQuery.dir(elem, "nextSibling");
	    },
	    prevAll: function(elem) {
	      return jQuery.dir(elem, "previousSibling");
	    },
	    nextUntil: function(elem, i, until) {
	      return jQuery.dir(elem, "nextSibling", until);
	    },
	    prevUntil: function(elem, i, until) {
	      return jQuery.dir(elem, "previousSibling", until);
	    },
	    siblings: function(elem) {
	      return jQuery.sibling((elem.parentNode || {}).firstChild, elem);
	    },
	    children: function(elem) {
	      return jQuery.sibling(elem.firstChild);
	    },
	    contents: function(elem) {
	      return elem.contentDocument || jQuery.merge([], elem.childNodes);
	    }
	  }, function(name, fn) {
	    jQuery.fn[name] = function(until, selector) {
	      var matched = jQuery.map(this, fn, until);
	      if (name.slice(-5) !== "Until") {
	        selector = until;
	      }
	      if (selector && typeof selector === "string") {
	        matched = jQuery.filter(selector, matched);
	      }
	      if (this.length > 1) {
	        if (!guaranteedUnique[name]) {
	          jQuery.unique(matched);
	        }
	        if (rparentsprev.test(name)) {
	          matched.reverse();
	        }
	      }
	      return this.pushStack(matched);
	    };
	  });
	  var rnotwhite = (/\S+/g);
	  var optionsCache = {};
	  function createOptions(options) {
	    var object = optionsCache[options] = {};
	    jQuery.each(options.match(rnotwhite) || [], function(_, flag) {
	      object[flag] = true;
	    });
	    return object;
	  }
	  jQuery.Callbacks = function(options) {
	    options = typeof options === "string" ? (optionsCache[options] || createOptions(options)) : jQuery.extend({}, options);
	    var memory,
	        fired,
	        firing,
	        firingStart,
	        firingLength,
	        firingIndex,
	        list = [],
	        stack = !options.once && [],
	        fire = function(data) {
	          memory = options.memory && data;
	          fired = true;
	          firingIndex = firingStart || 0;
	          firingStart = 0;
	          firingLength = list.length;
	          firing = true;
	          for (; list && firingIndex < firingLength; firingIndex++) {
	            if (list[firingIndex].apply(data[0], data[1]) === false && options.stopOnFalse) {
	              memory = false;
	              break;
	            }
	          }
	          firing = false;
	          if (list) {
	            if (stack) {
	              if (stack.length) {
	                fire(stack.shift());
	              }
	            } else if (memory) {
	              list = [];
	            } else {
	              self.disable();
	            }
	          }
	        },
	        self = {
	          add: function() {
	            if (list) {
	              var start = list.length;
	              (function add(args) {
	                jQuery.each(args, function(_, arg) {
	                  var type = jQuery.type(arg);
	                  if (type === "function") {
	                    if (!options.unique || !self.has(arg)) {
	                      list.push(arg);
	                    }
	                  } else if (arg && arg.length && type !== "string") {
	                    add(arg);
	                  }
	                });
	              })(arguments);
	              if (firing) {
	                firingLength = list.length;
	              } else if (memory) {
	                firingStart = start;
	                fire(memory);
	              }
	            }
	            return this;
	          },
	          remove: function() {
	            if (list) {
	              jQuery.each(arguments, function(_, arg) {
	                var index;
	                while ((index = jQuery.inArray(arg, list, index)) > -1) {
	                  list.splice(index, 1);
	                  if (firing) {
	                    if (index <= firingLength) {
	                      firingLength--;
	                    }
	                    if (index <= firingIndex) {
	                      firingIndex--;
	                    }
	                  }
	                }
	              });
	            }
	            return this;
	          },
	          has: function(fn) {
	            return fn ? jQuery.inArray(fn, list) > -1 : !!(list && list.length);
	          },
	          empty: function() {
	            list = [];
	            firingLength = 0;
	            return this;
	          },
	          disable: function() {
	            list = stack = memory = undefined;
	            return this;
	          },
	          disabled: function() {
	            return !list;
	          },
	          lock: function() {
	            stack = undefined;
	            if (!memory) {
	              self.disable();
	            }
	            return this;
	          },
	          locked: function() {
	            return !stack;
	          },
	          fireWith: function(context, args) {
	            if (list && (!fired || stack)) {
	              args = args || [];
	              args = [context, args.slice ? args.slice() : args];
	              if (firing) {
	                stack.push(args);
	              } else {
	                fire(args);
	              }
	            }
	            return this;
	          },
	          fire: function() {
	            self.fireWith(this, arguments);
	            return this;
	          },
	          fired: function() {
	            return !!fired;
	          }
	        };
	    return self;
	  };
	  jQuery.extend({
	    Deferred: function(func) {
	      var tuples = [["resolve", "done", jQuery.Callbacks("once memory"), "resolved"], ["reject", "fail", jQuery.Callbacks("once memory"), "rejected"], ["notify", "progress", jQuery.Callbacks("memory")]],
	          state = "pending",
	          promise = {
	            state: function() {
	              return state;
	            },
	            always: function() {
	              deferred.done(arguments).fail(arguments);
	              return this;
	            },
	            then: function() {
	              var fns = arguments;
	              return jQuery.Deferred(function(newDefer) {
	                jQuery.each(tuples, function(i, tuple) {
	                  var fn = jQuery.isFunction(fns[i]) && fns[i];
	                  deferred[tuple[1]](function() {
	                    var returned = fn && fn.apply(this, arguments);
	                    if (returned && jQuery.isFunction(returned.promise)) {
	                      returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify);
	                    } else {
	                      newDefer[tuple[0] + "With"](this === promise ? newDefer.promise() : this, fn ? [returned] : arguments);
	                    }
	                  });
	                });
	                fns = null;
	              }).promise();
	            },
	            promise: function(obj) {
	              return obj != null ? jQuery.extend(obj, promise) : promise;
	            }
	          },
	          deferred = {};
	      promise.pipe = promise.then;
	      jQuery.each(tuples, function(i, tuple) {
	        var list = tuple[2],
	            stateString = tuple[3];
	        promise[tuple[1]] = list.add;
	        if (stateString) {
	          list.add(function() {
	            state = stateString;
	          }, tuples[i ^ 1][2].disable, tuples[2][2].lock);
	        }
	        deferred[tuple[0]] = function() {
	          deferred[tuple[0] + "With"](this === deferred ? promise : this, arguments);
	          return this;
	        };
	        deferred[tuple[0] + "With"] = list.fireWith;
	      });
	      promise.promise(deferred);
	      if (func) {
	        func.call(deferred, deferred);
	      }
	      return deferred;
	    },
	    when: function(subordinate) {
	      var i = 0,
	          resolveValues = slice.call(arguments),
	          length = resolveValues.length,
	          remaining = length !== 1 || (subordinate && jQuery.isFunction(subordinate.promise)) ? length : 0,
	          deferred = remaining === 1 ? subordinate : jQuery.Deferred(),
	          updateFunc = function(i, contexts, values) {
	            return function(value) {
	              contexts[i] = this;
	              values[i] = arguments.length > 1 ? slice.call(arguments) : value;
	              if (values === progressValues) {
	                deferred.notifyWith(contexts, values);
	              } else if (!(--remaining)) {
	                deferred.resolveWith(contexts, values);
	              }
	            };
	          },
	          progressValues,
	          progressContexts,
	          resolveContexts;
	      if (length > 1) {
	        progressValues = new Array(length);
	        progressContexts = new Array(length);
	        resolveContexts = new Array(length);
	        for (; i < length; i++) {
	          if (resolveValues[i] && jQuery.isFunction(resolveValues[i].promise)) {
	            resolveValues[i].promise().done(updateFunc(i, resolveContexts, resolveValues)).fail(deferred.reject).progress(updateFunc(i, progressContexts, progressValues));
	          } else {
	            --remaining;
	          }
	        }
	      }
	      if (!remaining) {
	        deferred.resolveWith(resolveContexts, resolveValues);
	      }
	      return deferred.promise();
	    }
	  });
	  var readyList;
	  jQuery.fn.ready = function(fn) {
	    jQuery.ready.promise().done(fn);
	    return this;
	  };
	  jQuery.extend({
	    isReady: false,
	    readyWait: 1,
	    holdReady: function(hold) {
	      if (hold) {
	        jQuery.readyWait++;
	      } else {
	        jQuery.ready(true);
	      }
	    },
	    ready: function(wait) {
	      if (wait === true ? --jQuery.readyWait : jQuery.isReady) {
	        return;
	      }
	      jQuery.isReady = true;
	      if (wait !== true && --jQuery.readyWait > 0) {
	        return;
	      }
	      readyList.resolveWith(document, [jQuery]);
	      if (jQuery.fn.triggerHandler) {
	        jQuery(document).triggerHandler("ready");
	        jQuery(document).off("ready");
	      }
	    }
	  });
	  function completed() {
	    document.removeEventListener("DOMContentLoaded", completed, false);
	    window.removeEventListener("load", completed, false);
	    jQuery.ready();
	  }
	  jQuery.ready.promise = function(obj) {
	    if (!readyList) {
	      readyList = jQuery.Deferred();
	      if (document.readyState === "complete") {
	        setTimeout(jQuery.ready);
	      } else {
	        document.addEventListener("DOMContentLoaded", completed, false);
	        window.addEventListener("load", completed, false);
	      }
	    }
	    return readyList.promise(obj);
	  };
	  jQuery.ready.promise();
	  var access = jQuery.access = function(elems, fn, key, value, chainable, emptyGet, raw) {
	    var i = 0,
	        len = elems.length,
	        bulk = key == null;
	    if (jQuery.type(key) === "object") {
	      chainable = true;
	      for (i in key) {
	        jQuery.access(elems, fn, i, key[i], true, emptyGet, raw);
	      }
	    } else if (value !== undefined) {
	      chainable = true;
	      if (!jQuery.isFunction(value)) {
	        raw = true;
	      }
	      if (bulk) {
	        if (raw) {
	          fn.call(elems, value);
	          fn = null;
	        } else {
	          bulk = fn;
	          fn = function(elem, key, value) {
	            return bulk.call(jQuery(elem), value);
	          };
	        }
	      }
	      if (fn) {
	        for (; i < len; i++) {
	          fn(elems[i], key, raw ? value : value.call(elems[i], i, fn(elems[i], key)));
	        }
	      }
	    }
	    return chainable ? elems : bulk ? fn.call(elems) : len ? fn(elems[0], key) : emptyGet;
	  };
	  jQuery.acceptData = function(owner) {
	    return owner.nodeType === 1 || owner.nodeType === 9 || !(+owner.nodeType);
	  };
	  function Data() {
	    Object.defineProperty(this.cache = {}, 0, {get: function() {
	        return {};
	      }});
	    this.expando = jQuery.expando + Data.uid++;
	  }
	  Data.uid = 1;
	  Data.accepts = jQuery.acceptData;
	  Data.prototype = {
	    key: function(owner) {
	      if (!Data.accepts(owner)) {
	        return 0;
	      }
	      var descriptor = {},
	          unlock = owner[this.expando];
	      if (!unlock) {
	        unlock = Data.uid++;
	        try {
	          descriptor[this.expando] = {value: unlock};
	          Object.defineProperties(owner, descriptor);
	        } catch (e) {
	          descriptor[this.expando] = unlock;
	          jQuery.extend(owner, descriptor);
	        }
	      }
	      if (!this.cache[unlock]) {
	        this.cache[unlock] = {};
	      }
	      return unlock;
	    },
	    set: function(owner, data, value) {
	      var prop,
	          unlock = this.key(owner),
	          cache = this.cache[unlock];
	      if (typeof data === "string") {
	        cache[data] = value;
	      } else {
	        if (jQuery.isEmptyObject(cache)) {
	          jQuery.extend(this.cache[unlock], data);
	        } else {
	          for (prop in data) {
	            cache[prop] = data[prop];
	          }
	        }
	      }
	      return cache;
	    },
	    get: function(owner, key) {
	      var cache = this.cache[this.key(owner)];
	      return key === undefined ? cache : cache[key];
	    },
	    access: function(owner, key, value) {
	      var stored;
	      if (key === undefined || ((key && typeof key === "string") && value === undefined)) {
	        stored = this.get(owner, key);
	        return stored !== undefined ? stored : this.get(owner, jQuery.camelCase(key));
	      }
	      this.set(owner, key, value);
	      return value !== undefined ? value : key;
	    },
	    remove: function(owner, key) {
	      var i,
	          name,
	          camel,
	          unlock = this.key(owner),
	          cache = this.cache[unlock];
	      if (key === undefined) {
	        this.cache[unlock] = {};
	      } else {
	        if (jQuery.isArray(key)) {
	          name = key.concat(key.map(jQuery.camelCase));
	        } else {
	          camel = jQuery.camelCase(key);
	          if (key in cache) {
	            name = [key, camel];
	          } else {
	            name = camel;
	            name = name in cache ? [name] : (name.match(rnotwhite) || []);
	          }
	        }
	        i = name.length;
	        while (i--) {
	          delete cache[name[i]];
	        }
	      }
	    },
	    hasData: function(owner) {
	      return !jQuery.isEmptyObject(this.cache[owner[this.expando]] || {});
	    },
	    discard: function(owner) {
	      if (owner[this.expando]) {
	        delete this.cache[owner[this.expando]];
	      }
	    }
	  };
	  var data_priv = new Data();
	  var data_user = new Data();
	  var rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
	      rmultiDash = /([A-Z])/g;
	  function dataAttr(elem, key, data) {
	    var name;
	    if (data === undefined && elem.nodeType === 1) {
	      name = "data-" + key.replace(rmultiDash, "-$1").toLowerCase();
	      data = elem.getAttribute(name);
	      if (typeof data === "string") {
	        try {
	          data = data === "true" ? true : data === "false" ? false : data === "null" ? null : +data + "" === data ? +data : rbrace.test(data) ? jQuery.parseJSON(data) : data;
	        } catch (e) {}
	        data_user.set(elem, key, data);
	      } else {
	        data = undefined;
	      }
	    }
	    return data;
	  }
	  jQuery.extend({
	    hasData: function(elem) {
	      return data_user.hasData(elem) || data_priv.hasData(elem);
	    },
	    data: function(elem, name, data) {
	      return data_user.access(elem, name, data);
	    },
	    removeData: function(elem, name) {
	      data_user.remove(elem, name);
	    },
	    _data: function(elem, name, data) {
	      return data_priv.access(elem, name, data);
	    },
	    _removeData: function(elem, name) {
	      data_priv.remove(elem, name);
	    }
	  });
	  jQuery.fn.extend({
	    data: function(key, value) {
	      var i,
	          name,
	          data,
	          elem = this[0],
	          attrs = elem && elem.attributes;
	      if (key === undefined) {
	        if (this.length) {
	          data = data_user.get(elem);
	          if (elem.nodeType === 1 && !data_priv.get(elem, "hasDataAttrs")) {
	            i = attrs.length;
	            while (i--) {
	              if (attrs[i]) {
	                name = attrs[i].name;
	                if (name.indexOf("data-") === 0) {
	                  name = jQuery.camelCase(name.slice(5));
	                  dataAttr(elem, name, data[name]);
	                }
	              }
	            }
	            data_priv.set(elem, "hasDataAttrs", true);
	          }
	        }
	        return data;
	      }
	      if (typeof key === "object") {
	        return this.each(function() {
	          data_user.set(this, key);
	        });
	      }
	      return access(this, function(value) {
	        var data,
	            camelKey = jQuery.camelCase(key);
	        if (elem && value === undefined) {
	          data = data_user.get(elem, key);
	          if (data !== undefined) {
	            return data;
	          }
	          data = data_user.get(elem, camelKey);
	          if (data !== undefined) {
	            return data;
	          }
	          data = dataAttr(elem, camelKey, undefined);
	          if (data !== undefined) {
	            return data;
	          }
	          return;
	        }
	        this.each(function() {
	          var data = data_user.get(this, camelKey);
	          data_user.set(this, camelKey, value);
	          if (key.indexOf("-") !== -1 && data !== undefined) {
	            data_user.set(this, key, value);
	          }
	        });
	      }, null, value, arguments.length > 1, null, true);
	    },
	    removeData: function(key) {
	      return this.each(function() {
	        data_user.remove(this, key);
	      });
	    }
	  });
	  jQuery.extend({
	    queue: function(elem, type, data) {
	      var queue;
	      if (elem) {
	        type = (type || "fx") + "queue";
	        queue = data_priv.get(elem, type);
	        if (data) {
	          if (!queue || jQuery.isArray(data)) {
	            queue = data_priv.access(elem, type, jQuery.makeArray(data));
	          } else {
	            queue.push(data);
	          }
	        }
	        return queue || [];
	      }
	    },
	    dequeue: function(elem, type) {
	      type = type || "fx";
	      var queue = jQuery.queue(elem, type),
	          startLength = queue.length,
	          fn = queue.shift(),
	          hooks = jQuery._queueHooks(elem, type),
	          next = function() {
	            jQuery.dequeue(elem, type);
	          };
	      if (fn === "inprogress") {
	        fn = queue.shift();
	        startLength--;
	      }
	      if (fn) {
	        if (type === "fx") {
	          queue.unshift("inprogress");
	        }
	        delete hooks.stop;
	        fn.call(elem, next, hooks);
	      }
	      if (!startLength && hooks) {
	        hooks.empty.fire();
	      }
	    },
	    _queueHooks: function(elem, type) {
	      var key = type + "queueHooks";
	      return data_priv.get(elem, key) || data_priv.access(elem, key, {empty: jQuery.Callbacks("once memory").add(function() {
	          data_priv.remove(elem, [type + "queue", key]);
	        })});
	    }
	  });
	  jQuery.fn.extend({
	    queue: function(type, data) {
	      var setter = 2;
	      if (typeof type !== "string") {
	        data = type;
	        type = "fx";
	        setter--;
	      }
	      if (arguments.length < setter) {
	        return jQuery.queue(this[0], type);
	      }
	      return data === undefined ? this : this.each(function() {
	        var queue = jQuery.queue(this, type, data);
	        jQuery._queueHooks(this, type);
	        if (type === "fx" && queue[0] !== "inprogress") {
	          jQuery.dequeue(this, type);
	        }
	      });
	    },
	    dequeue: function(type) {
	      return this.each(function() {
	        jQuery.dequeue(this, type);
	      });
	    },
	    clearQueue: function(type) {
	      return this.queue(type || "fx", []);
	    },
	    promise: function(type, obj) {
	      var tmp,
	          count = 1,
	          defer = jQuery.Deferred(),
	          elements = this,
	          i = this.length,
	          resolve = function() {
	            if (!(--count)) {
	              defer.resolveWith(elements, [elements]);
	            }
	          };
	      if (typeof type !== "string") {
	        obj = type;
	        type = undefined;
	      }
	      type = type || "fx";
	      while (i--) {
	        tmp = data_priv.get(elements[i], type + "queueHooks");
	        if (tmp && tmp.empty) {
	          count++;
	          tmp.empty.add(resolve);
	        }
	      }
	      resolve();
	      return defer.promise(obj);
	    }
	  });
	  var pnum = (/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;
	  var cssExpand = ["Top", "Right", "Bottom", "Left"];
	  var isHidden = function(elem, el) {
	    elem = el || elem;
	    return jQuery.css(elem, "display") === "none" || !jQuery.contains(elem.ownerDocument, elem);
	  };
	  var rcheckableType = (/^(?:checkbox|radio)$/i);
	  (function() {
	    var fragment = document.createDocumentFragment(),
	        div = fragment.appendChild(document.createElement("div")),
	        input = document.createElement("input");
	    input.setAttribute("type", "radio");
	    input.setAttribute("checked", "checked");
	    input.setAttribute("name", "t");
	    div.appendChild(input);
	    support.checkClone = div.cloneNode(true).cloneNode(true).lastChild.checked;
	    div.innerHTML = "<textarea>x</textarea>";
	    support.noCloneChecked = !!div.cloneNode(true).lastChild.defaultValue;
	  })();
	  var strundefined = typeof undefined;
	  support.focusinBubbles = "onfocusin" in window;
	  var rkeyEvent = /^key/,
	      rmouseEvent = /^(?:mouse|pointer|contextmenu)|click/,
	      rfocusMorph = /^(?:focusinfocus|focusoutblur)$/,
	      rtypenamespace = /^([^.]*)(?:\.(.+)|)$/;
	  function returnTrue() {
	    return true;
	  }
	  function returnFalse() {
	    return false;
	  }
	  function safeActiveElement() {
	    try {
	      return document.activeElement;
	    } catch (err) {}
	  }
	  jQuery.event = {
	    global: {},
	    add: function(elem, types, handler, data, selector) {
	      var handleObjIn,
	          eventHandle,
	          tmp,
	          events,
	          t,
	          handleObj,
	          special,
	          handlers,
	          type,
	          namespaces,
	          origType,
	          elemData = data_priv.get(elem);
	      if (!elemData) {
	        return;
	      }
	      if (handler.handler) {
	        handleObjIn = handler;
	        handler = handleObjIn.handler;
	        selector = handleObjIn.selector;
	      }
	      if (!handler.guid) {
	        handler.guid = jQuery.guid++;
	      }
	      if (!(events = elemData.events)) {
	        events = elemData.events = {};
	      }
	      if (!(eventHandle = elemData.handle)) {
	        eventHandle = elemData.handle = function(e) {
	          return typeof jQuery !== strundefined && jQuery.event.triggered !== e.type ? jQuery.event.dispatch.apply(elem, arguments) : undefined;
	        };
	      }
	      types = (types || "").match(rnotwhite) || [""];
	      t = types.length;
	      while (t--) {
	        tmp = rtypenamespace.exec(types[t]) || [];
	        type = origType = tmp[1];
	        namespaces = (tmp[2] || "").split(".").sort();
	        if (!type) {
	          continue;
	        }
	        special = jQuery.event.special[type] || {};
	        type = (selector ? special.delegateType : special.bindType) || type;
	        special = jQuery.event.special[type] || {};
	        handleObj = jQuery.extend({
	          type: type,
	          origType: origType,
	          data: data,
	          handler: handler,
	          guid: handler.guid,
	          selector: selector,
	          needsContext: selector && jQuery.expr.match.needsContext.test(selector),
	          namespace: namespaces.join(".")
	        }, handleObjIn);
	        if (!(handlers = events[type])) {
	          handlers = events[type] = [];
	          handlers.delegateCount = 0;
	          if (!special.setup || special.setup.call(elem, data, namespaces, eventHandle) === false) {
	            if (elem.addEventListener) {
	              elem.addEventListener(type, eventHandle, false);
	            }
	          }
	        }
	        if (special.add) {
	          special.add.call(elem, handleObj);
	          if (!handleObj.handler.guid) {
	            handleObj.handler.guid = handler.guid;
	          }
	        }
	        if (selector) {
	          handlers.splice(handlers.delegateCount++, 0, handleObj);
	        } else {
	          handlers.push(handleObj);
	        }
	        jQuery.event.global[type] = true;
	      }
	    },
	    remove: function(elem, types, handler, selector, mappedTypes) {
	      var j,
	          origCount,
	          tmp,
	          events,
	          t,
	          handleObj,
	          special,
	          handlers,
	          type,
	          namespaces,
	          origType,
	          elemData = data_priv.hasData(elem) && data_priv.get(elem);
	      if (!elemData || !(events = elemData.events)) {
	        return;
	      }
	      types = (types || "").match(rnotwhite) || [""];
	      t = types.length;
	      while (t--) {
	        tmp = rtypenamespace.exec(types[t]) || [];
	        type = origType = tmp[1];
	        namespaces = (tmp[2] || "").split(".").sort();
	        if (!type) {
	          for (type in events) {
	            jQuery.event.remove(elem, type + types[t], handler, selector, true);
	          }
	          continue;
	        }
	        special = jQuery.event.special[type] || {};
	        type = (selector ? special.delegateType : special.bindType) || type;
	        handlers = events[type] || [];
	        tmp = tmp[2] && new RegExp("(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)");
	        origCount = j = handlers.length;
	        while (j--) {
	          handleObj = handlers[j];
	          if ((mappedTypes || origType === handleObj.origType) && (!handler || handler.guid === handleObj.guid) && (!tmp || tmp.test(handleObj.namespace)) && (!selector || selector === handleObj.selector || selector === "**" && handleObj.selector)) {
	            handlers.splice(j, 1);
	            if (handleObj.selector) {
	              handlers.delegateCount--;
	            }
	            if (special.remove) {
	              special.remove.call(elem, handleObj);
	            }
	          }
	        }
	        if (origCount && !handlers.length) {
	          if (!special.teardown || special.teardown.call(elem, namespaces, elemData.handle) === false) {
	            jQuery.removeEvent(elem, type, elemData.handle);
	          }
	          delete events[type];
	        }
	      }
	      if (jQuery.isEmptyObject(events)) {
	        delete elemData.handle;
	        data_priv.remove(elem, "events");
	      }
	    },
	    trigger: function(event, data, elem, onlyHandlers) {
	      var i,
	          cur,
	          tmp,
	          bubbleType,
	          ontype,
	          handle,
	          special,
	          eventPath = [elem || document],
	          type = hasOwn.call(event, "type") ? event.type : event,
	          namespaces = hasOwn.call(event, "namespace") ? event.namespace.split(".") : [];
	      cur = tmp = elem = elem || document;
	      if (elem.nodeType === 3 || elem.nodeType === 8) {
	        return;
	      }
	      if (rfocusMorph.test(type + jQuery.event.triggered)) {
	        return;
	      }
	      if (type.indexOf(".") >= 0) {
	        namespaces = type.split(".");
	        type = namespaces.shift();
	        namespaces.sort();
	      }
	      ontype = type.indexOf(":") < 0 && "on" + type;
	      event = event[jQuery.expando] ? event : new jQuery.Event(type, typeof event === "object" && event);
	      event.isTrigger = onlyHandlers ? 2 : 3;
	      event.namespace = namespaces.join(".");
	      event.namespace_re = event.namespace ? new RegExp("(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)") : null;
	      event.result = undefined;
	      if (!event.target) {
	        event.target = elem;
	      }
	      data = data == null ? [event] : jQuery.makeArray(data, [event]);
	      special = jQuery.event.special[type] || {};
	      if (!onlyHandlers && special.trigger && special.trigger.apply(elem, data) === false) {
	        return;
	      }
	      if (!onlyHandlers && !special.noBubble && !jQuery.isWindow(elem)) {
	        bubbleType = special.delegateType || type;
	        if (!rfocusMorph.test(bubbleType + type)) {
	          cur = cur.parentNode;
	        }
	        for (; cur; cur = cur.parentNode) {
	          eventPath.push(cur);
	          tmp = cur;
	        }
	        if (tmp === (elem.ownerDocument || document)) {
	          eventPath.push(tmp.defaultView || tmp.parentWindow || window);
	        }
	      }
	      i = 0;
	      while ((cur = eventPath[i++]) && !event.isPropagationStopped()) {
	        event.type = i > 1 ? bubbleType : special.bindType || type;
	        handle = (data_priv.get(cur, "events") || {})[event.type] && data_priv.get(cur, "handle");
	        if (handle) {
	          handle.apply(cur, data);
	        }
	        handle = ontype && cur[ontype];
	        if (handle && handle.apply && jQuery.acceptData(cur)) {
	          event.result = handle.apply(cur, data);
	          if (event.result === false) {
	            event.preventDefault();
	          }
	        }
	      }
	      event.type = type;
	      if (!onlyHandlers && !event.isDefaultPrevented()) {
	        if ((!special._default || special._default.apply(eventPath.pop(), data) === false) && jQuery.acceptData(elem)) {
	          if (ontype && jQuery.isFunction(elem[type]) && !jQuery.isWindow(elem)) {
	            tmp = elem[ontype];
	            if (tmp) {
	              elem[ontype] = null;
	            }
	            jQuery.event.triggered = type;
	            elem[type]();
	            jQuery.event.triggered = undefined;
	            if (tmp) {
	              elem[ontype] = tmp;
	            }
	          }
	        }
	      }
	      return event.result;
	    },
	    dispatch: function(event) {
	      event = jQuery.event.fix(event);
	      var i,
	          j,
	          ret,
	          matched,
	          handleObj,
	          handlerQueue = [],
	          args = slice.call(arguments),
	          handlers = (data_priv.get(this, "events") || {})[event.type] || [],
	          special = jQuery.event.special[event.type] || {};
	      args[0] = event;
	      event.delegateTarget = this;
	      if (special.preDispatch && special.preDispatch.call(this, event) === false) {
	        return;
	      }
	      handlerQueue = jQuery.event.handlers.call(this, event, handlers);
	      i = 0;
	      while ((matched = handlerQueue[i++]) && !event.isPropagationStopped()) {
	        event.currentTarget = matched.elem;
	        j = 0;
	        while ((handleObj = matched.handlers[j++]) && !event.isImmediatePropagationStopped()) {
	          if (!event.namespace_re || event.namespace_re.test(handleObj.namespace)) {
	            event.handleObj = handleObj;
	            event.data = handleObj.data;
	            ret = ((jQuery.event.special[handleObj.origType] || {}).handle || handleObj.handler).apply(matched.elem, args);
	            if (ret !== undefined) {
	              if ((event.result = ret) === false) {
	                event.preventDefault();
	                event.stopPropagation();
	              }
	            }
	          }
	        }
	      }
	      if (special.postDispatch) {
	        special.postDispatch.call(this, event);
	      }
	      return event.result;
	    },
	    handlers: function(event, handlers) {
	      var i,
	          matches,
	          sel,
	          handleObj,
	          handlerQueue = [],
	          delegateCount = handlers.delegateCount,
	          cur = event.target;
	      if (delegateCount && cur.nodeType && (!event.button || event.type !== "click")) {
	        for (; cur !== this; cur = cur.parentNode || this) {
	          if (cur.disabled !== true || event.type !== "click") {
	            matches = [];
	            for (i = 0; i < delegateCount; i++) {
	              handleObj = handlers[i];
	              sel = handleObj.selector + " ";
	              if (matches[sel] === undefined) {
	                matches[sel] = handleObj.needsContext ? jQuery(sel, this).index(cur) >= 0 : jQuery.find(sel, this, null, [cur]).length;
	              }
	              if (matches[sel]) {
	                matches.push(handleObj);
	              }
	            }
	            if (matches.length) {
	              handlerQueue.push({
	                elem: cur,
	                handlers: matches
	              });
	            }
	          }
	        }
	      }
	      if (delegateCount < handlers.length) {
	        handlerQueue.push({
	          elem: this,
	          handlers: handlers.slice(delegateCount)
	        });
	      }
	      return handlerQueue;
	    },
	    props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
	    fixHooks: {},
	    keyHooks: {
	      props: "char charCode key keyCode".split(" "),
	      filter: function(event, original) {
	        if (event.which == null) {
	          event.which = original.charCode != null ? original.charCode : original.keyCode;
	        }
	        return event;
	      }
	    },
	    mouseHooks: {
	      props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
	      filter: function(event, original) {
	        var eventDoc,
	            doc,
	            body,
	            button = original.button;
	        if (event.pageX == null && original.clientX != null) {
	          eventDoc = event.target.ownerDocument || document;
	          doc = eventDoc.documentElement;
	          body = eventDoc.body;
	          event.pageX = original.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);
	          event.pageY = original.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);
	        }
	        if (!event.which && button !== undefined) {
	          event.which = (button & 1 ? 1 : (button & 2 ? 3 : (button & 4 ? 2 : 0)));
	        }
	        return event;
	      }
	    },
	    fix: function(event) {
	      if (event[jQuery.expando]) {
	        return event;
	      }
	      var i,
	          prop,
	          copy,
	          type = event.type,
	          originalEvent = event,
	          fixHook = this.fixHooks[type];
	      if (!fixHook) {
	        this.fixHooks[type] = fixHook = rmouseEvent.test(type) ? this.mouseHooks : rkeyEvent.test(type) ? this.keyHooks : {};
	      }
	      copy = fixHook.props ? this.props.concat(fixHook.props) : this.props;
	      event = new jQuery.Event(originalEvent);
	      i = copy.length;
	      while (i--) {
	        prop = copy[i];
	        event[prop] = originalEvent[prop];
	      }
	      if (!event.target) {
	        event.target = document;
	      }
	      if (event.target.nodeType === 3) {
	        event.target = event.target.parentNode;
	      }
	      return fixHook.filter ? fixHook.filter(event, originalEvent) : event;
	    },
	    special: {
	      load: {noBubble: true},
	      focus: {
	        trigger: function() {
	          if (this !== safeActiveElement() && this.focus) {
	            this.focus();
	            return false;
	          }
	        },
	        delegateType: "focusin"
	      },
	      blur: {
	        trigger: function() {
	          if (this === safeActiveElement() && this.blur) {
	            this.blur();
	            return false;
	          }
	        },
	        delegateType: "focusout"
	      },
	      click: {
	        trigger: function() {
	          if (this.type === "checkbox" && this.click && jQuery.nodeName(this, "input")) {
	            this.click();
	            return false;
	          }
	        },
	        _default: function(event) {
	          return jQuery.nodeName(event.target, "a");
	        }
	      },
	      beforeunload: {postDispatch: function(event) {
	          if (event.result !== undefined && event.originalEvent) {
	            event.originalEvent.returnValue = event.result;
	          }
	        }}
	    },
	    simulate: function(type, elem, event, bubble) {
	      var e = jQuery.extend(new jQuery.Event(), event, {
	        type: type,
	        isSimulated: true,
	        originalEvent: {}
	      });
	      if (bubble) {
	        jQuery.event.trigger(e, null, elem);
	      } else {
	        jQuery.event.dispatch.call(elem, e);
	      }
	      if (e.isDefaultPrevented()) {
	        event.preventDefault();
	      }
	    }
	  };
	  jQuery.removeEvent = function(elem, type, handle) {
	    if (elem.removeEventListener) {
	      elem.removeEventListener(type, handle, false);
	    }
	  };
	  jQuery.Event = function(src, props) {
	    if (!(this instanceof jQuery.Event)) {
	      return new jQuery.Event(src, props);
	    }
	    if (src && src.type) {
	      this.originalEvent = src;
	      this.type = src.type;
	      this.isDefaultPrevented = src.defaultPrevented || src.defaultPrevented === undefined && src.returnValue === false ? returnTrue : returnFalse;
	    } else {
	      this.type = src;
	    }
	    if (props) {
	      jQuery.extend(this, props);
	    }
	    this.timeStamp = src && src.timeStamp || jQuery.now();
	    this[jQuery.expando] = true;
	  };
	  jQuery.Event.prototype = {
	    isDefaultPrevented: returnFalse,
	    isPropagationStopped: returnFalse,
	    isImmediatePropagationStopped: returnFalse,
	    preventDefault: function() {
	      var e = this.originalEvent;
	      this.isDefaultPrevented = returnTrue;
	      if (e && e.preventDefault) {
	        e.preventDefault();
	      }
	    },
	    stopPropagation: function() {
	      var e = this.originalEvent;
	      this.isPropagationStopped = returnTrue;
	      if (e && e.stopPropagation) {
	        e.stopPropagation();
	      }
	    },
	    stopImmediatePropagation: function() {
	      var e = this.originalEvent;
	      this.isImmediatePropagationStopped = returnTrue;
	      if (e && e.stopImmediatePropagation) {
	        e.stopImmediatePropagation();
	      }
	      this.stopPropagation();
	    }
	  };
	  jQuery.each({
	    mouseenter: "mouseover",
	    mouseleave: "mouseout",
	    pointerenter: "pointerover",
	    pointerleave: "pointerout"
	  }, function(orig, fix) {
	    jQuery.event.special[orig] = {
	      delegateType: fix,
	      bindType: fix,
	      handle: function(event) {
	        var ret,
	            target = this,
	            related = event.relatedTarget,
	            handleObj = event.handleObj;
	        if (!related || (related !== target && !jQuery.contains(target, related))) {
	          event.type = handleObj.origType;
	          ret = handleObj.handler.apply(this, arguments);
	          event.type = fix;
	        }
	        return ret;
	      }
	    };
	  });
	  if (!support.focusinBubbles) {
	    jQuery.each({
	      focus: "focusin",
	      blur: "focusout"
	    }, function(orig, fix) {
	      var handler = function(event) {
	        jQuery.event.simulate(fix, event.target, jQuery.event.fix(event), true);
	      };
	      jQuery.event.special[fix] = {
	        setup: function() {
	          var doc = this.ownerDocument || this,
	              attaches = data_priv.access(doc, fix);
	          if (!attaches) {
	            doc.addEventListener(orig, handler, true);
	          }
	          data_priv.access(doc, fix, (attaches || 0) + 1);
	        },
	        teardown: function() {
	          var doc = this.ownerDocument || this,
	              attaches = data_priv.access(doc, fix) - 1;
	          if (!attaches) {
	            doc.removeEventListener(orig, handler, true);
	            data_priv.remove(doc, fix);
	          } else {
	            data_priv.access(doc, fix, attaches);
	          }
	        }
	      };
	    });
	  }
	  jQuery.fn.extend({
	    on: function(types, selector, data, fn, one) {
	      var origFn,
	          type;
	      if (typeof types === "object") {
	        if (typeof selector !== "string") {
	          data = data || selector;
	          selector = undefined;
	        }
	        for (type in types) {
	          this.on(type, selector, data, types[type], one);
	        }
	        return this;
	      }
	      if (data == null && fn == null) {
	        fn = selector;
	        data = selector = undefined;
	      } else if (fn == null) {
	        if (typeof selector === "string") {
	          fn = data;
	          data = undefined;
	        } else {
	          fn = data;
	          data = selector;
	          selector = undefined;
	        }
	      }
	      if (fn === false) {
	        fn = returnFalse;
	      } else if (!fn) {
	        return this;
	      }
	      if (one === 1) {
	        origFn = fn;
	        fn = function(event) {
	          jQuery().off(event);
	          return origFn.apply(this, arguments);
	        };
	        fn.guid = origFn.guid || (origFn.guid = jQuery.guid++);
	      }
	      return this.each(function() {
	        jQuery.event.add(this, types, fn, data, selector);
	      });
	    },
	    one: function(types, selector, data, fn) {
	      return this.on(types, selector, data, fn, 1);
	    },
	    off: function(types, selector, fn) {
	      var handleObj,
	          type;
	      if (types && types.preventDefault && types.handleObj) {
	        handleObj = types.handleObj;
	        jQuery(types.delegateTarget).off(handleObj.namespace ? handleObj.origType + "." + handleObj.namespace : handleObj.origType, handleObj.selector, handleObj.handler);
	        return this;
	      }
	      if (typeof types === "object") {
	        for (type in types) {
	          this.off(type, selector, types[type]);
	        }
	        return this;
	      }
	      if (selector === false || typeof selector === "function") {
	        fn = selector;
	        selector = undefined;
	      }
	      if (fn === false) {
	        fn = returnFalse;
	      }
	      return this.each(function() {
	        jQuery.event.remove(this, types, fn, selector);
	      });
	    },
	    trigger: function(type, data) {
	      return this.each(function() {
	        jQuery.event.trigger(type, data, this);
	      });
	    },
	    triggerHandler: function(type, data) {
	      var elem = this[0];
	      if (elem) {
	        return jQuery.event.trigger(type, data, elem, true);
	      }
	    }
	  });
	  var rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
	      rtagName = /<([\w:]+)/,
	      rhtml = /<|&#?\w+;/,
	      rnoInnerhtml = /<(?:script|style|link)/i,
	      rchecked = /checked\s*(?:[^=]|=\s*.checked.)/i,
	      rscriptType = /^$|\/(?:java|ecma)script/i,
	      rscriptTypeMasked = /^true\/(.*)/,
	      rcleanScript = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
	      wrapMap = {
	        option: [1, "<select multiple='multiple'>", "</select>"],
	        thead: [1, "<table>", "</table>"],
	        col: [2, "<table><colgroup>", "</colgroup></table>"],
	        tr: [2, "<table><tbody>", "</tbody></table>"],
	        td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
	        _default: [0, "", ""]
	      };
	  wrapMap.optgroup = wrapMap.option;
	  wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
	  wrapMap.th = wrapMap.td;
	  function manipulationTarget(elem, content) {
	    return jQuery.nodeName(elem, "table") && jQuery.nodeName(content.nodeType !== 11 ? content : content.firstChild, "tr") ? elem.getElementsByTagName("tbody")[0] || elem.appendChild(elem.ownerDocument.createElement("tbody")) : elem;
	  }
	  function disableScript(elem) {
	    elem.type = (elem.getAttribute("type") !== null) + "/" + elem.type;
	    return elem;
	  }
	  function restoreScript(elem) {
	    var match = rscriptTypeMasked.exec(elem.type);
	    if (match) {
	      elem.type = match[1];
	    } else {
	      elem.removeAttribute("type");
	    }
	    return elem;
	  }
	  function setGlobalEval(elems, refElements) {
	    var i = 0,
	        l = elems.length;
	    for (; i < l; i++) {
	      data_priv.set(elems[i], "globalEval", !refElements || data_priv.get(refElements[i], "globalEval"));
	    }
	  }
	  function cloneCopyEvent(src, dest) {
	    var i,
	        l,
	        type,
	        pdataOld,
	        pdataCur,
	        udataOld,
	        udataCur,
	        events;
	    if (dest.nodeType !== 1) {
	      return;
	    }
	    if (data_priv.hasData(src)) {
	      pdataOld = data_priv.access(src);
	      pdataCur = data_priv.set(dest, pdataOld);
	      events = pdataOld.events;
	      if (events) {
	        delete pdataCur.handle;
	        pdataCur.events = {};
	        for (type in events) {
	          for (i = 0, l = events[type].length; i < l; i++) {
	            jQuery.event.add(dest, type, events[type][i]);
	          }
	        }
	      }
	    }
	    if (data_user.hasData(src)) {
	      udataOld = data_user.access(src);
	      udataCur = jQuery.extend({}, udataOld);
	      data_user.set(dest, udataCur);
	    }
	  }
	  function getAll(context, tag) {
	    var ret = context.getElementsByTagName ? context.getElementsByTagName(tag || "*") : context.querySelectorAll ? context.querySelectorAll(tag || "*") : [];
	    return tag === undefined || tag && jQuery.nodeName(context, tag) ? jQuery.merge([context], ret) : ret;
	  }
	  function fixInput(src, dest) {
	    var nodeName = dest.nodeName.toLowerCase();
	    if (nodeName === "input" && rcheckableType.test(src.type)) {
	      dest.checked = src.checked;
	    } else if (nodeName === "input" || nodeName === "textarea") {
	      dest.defaultValue = src.defaultValue;
	    }
	  }
	  jQuery.extend({
	    clone: function(elem, dataAndEvents, deepDataAndEvents) {
	      var i,
	          l,
	          srcElements,
	          destElements,
	          clone = elem.cloneNode(true),
	          inPage = jQuery.contains(elem.ownerDocument, elem);
	      if (!support.noCloneChecked && (elem.nodeType === 1 || elem.nodeType === 11) && !jQuery.isXMLDoc(elem)) {
	        destElements = getAll(clone);
	        srcElements = getAll(elem);
	        for (i = 0, l = srcElements.length; i < l; i++) {
	          fixInput(srcElements[i], destElements[i]);
	        }
	      }
	      if (dataAndEvents) {
	        if (deepDataAndEvents) {
	          srcElements = srcElements || getAll(elem);
	          destElements = destElements || getAll(clone);
	          for (i = 0, l = srcElements.length; i < l; i++) {
	            cloneCopyEvent(srcElements[i], destElements[i]);
	          }
	        } else {
	          cloneCopyEvent(elem, clone);
	        }
	      }
	      destElements = getAll(clone, "script");
	      if (destElements.length > 0) {
	        setGlobalEval(destElements, !inPage && getAll(elem, "script"));
	      }
	      return clone;
	    },
	    buildFragment: function(elems, context, scripts, selection) {
	      var elem,
	          tmp,
	          tag,
	          wrap,
	          contains,
	          j,
	          fragment = context.createDocumentFragment(),
	          nodes = [],
	          i = 0,
	          l = elems.length;
	      for (; i < l; i++) {
	        elem = elems[i];
	        if (elem || elem === 0) {
	          if (jQuery.type(elem) === "object") {
	            jQuery.merge(nodes, elem.nodeType ? [elem] : elem);
	          } else if (!rhtml.test(elem)) {
	            nodes.push(context.createTextNode(elem));
	          } else {
	            tmp = tmp || fragment.appendChild(context.createElement("div"));
	            tag = (rtagName.exec(elem) || ["", ""])[1].toLowerCase();
	            wrap = wrapMap[tag] || wrapMap._default;
	            tmp.innerHTML = wrap[1] + elem.replace(rxhtmlTag, "<$1></$2>") + wrap[2];
	            j = wrap[0];
	            while (j--) {
	              tmp = tmp.lastChild;
	            }
	            jQuery.merge(nodes, tmp.childNodes);
	            tmp = fragment.firstChild;
	            tmp.textContent = "";
	          }
	        }
	      }
	      fragment.textContent = "";
	      i = 0;
	      while ((elem = nodes[i++])) {
	        if (selection && jQuery.inArray(elem, selection) !== -1) {
	          continue;
	        }
	        contains = jQuery.contains(elem.ownerDocument, elem);
	        tmp = getAll(fragment.appendChild(elem), "script");
	        if (contains) {
	          setGlobalEval(tmp);
	        }
	        if (scripts) {
	          j = 0;
	          while ((elem = tmp[j++])) {
	            if (rscriptType.test(elem.type || "")) {
	              scripts.push(elem);
	            }
	          }
	        }
	      }
	      return fragment;
	    },
	    cleanData: function(elems) {
	      var data,
	          elem,
	          type,
	          key,
	          special = jQuery.event.special,
	          i = 0;
	      for (; (elem = elems[i]) !== undefined; i++) {
	        if (jQuery.acceptData(elem)) {
	          key = elem[data_priv.expando];
	          if (key && (data = data_priv.cache[key])) {
	            if (data.events) {
	              for (type in data.events) {
	                if (special[type]) {
	                  jQuery.event.remove(elem, type);
	                } else {
	                  jQuery.removeEvent(elem, type, data.handle);
	                }
	              }
	            }
	            if (data_priv.cache[key]) {
	              delete data_priv.cache[key];
	            }
	          }
	        }
	        delete data_user.cache[elem[data_user.expando]];
	      }
	    }
	  });
	  jQuery.fn.extend({
	    text: function(value) {
	      return access(this, function(value) {
	        return value === undefined ? jQuery.text(this) : this.empty().each(function() {
	          if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
	            this.textContent = value;
	          }
	        });
	      }, null, value, arguments.length);
	    },
	    append: function() {
	      return this.domManip(arguments, function(elem) {
	        if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
	          var target = manipulationTarget(this, elem);
	          target.appendChild(elem);
	        }
	      });
	    },
	    prepend: function() {
	      return this.domManip(arguments, function(elem) {
	        if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
	          var target = manipulationTarget(this, elem);
	          target.insertBefore(elem, target.firstChild);
	        }
	      });
	    },
	    before: function() {
	      return this.domManip(arguments, function(elem) {
	        if (this.parentNode) {
	          this.parentNode.insertBefore(elem, this);
	        }
	      });
	    },
	    after: function() {
	      return this.domManip(arguments, function(elem) {
	        if (this.parentNode) {
	          this.parentNode.insertBefore(elem, this.nextSibling);
	        }
	      });
	    },
	    remove: function(selector, keepData) {
	      var elem,
	          elems = selector ? jQuery.filter(selector, this) : this,
	          i = 0;
	      for (; (elem = elems[i]) != null; i++) {
	        if (!keepData && elem.nodeType === 1) {
	          jQuery.cleanData(getAll(elem));
	        }
	        if (elem.parentNode) {
	          if (keepData && jQuery.contains(elem.ownerDocument, elem)) {
	            setGlobalEval(getAll(elem, "script"));
	          }
	          elem.parentNode.removeChild(elem);
	        }
	      }
	      return this;
	    },
	    empty: function() {
	      var elem,
	          i = 0;
	      for (; (elem = this[i]) != null; i++) {
	        if (elem.nodeType === 1) {
	          jQuery.cleanData(getAll(elem, false));
	          elem.textContent = "";
	        }
	      }
	      return this;
	    },
	    clone: function(dataAndEvents, deepDataAndEvents) {
	      dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
	      deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;
	      return this.map(function() {
	        return jQuery.clone(this, dataAndEvents, deepDataAndEvents);
	      });
	    },
	    html: function(value) {
	      return access(this, function(value) {
	        var elem = this[0] || {},
	            i = 0,
	            l = this.length;
	        if (value === undefined && elem.nodeType === 1) {
	          return elem.innerHTML;
	        }
	        if (typeof value === "string" && !rnoInnerhtml.test(value) && !wrapMap[(rtagName.exec(value) || ["", ""])[1].toLowerCase()]) {
	          value = value.replace(rxhtmlTag, "<$1></$2>");
	          try {
	            for (; i < l; i++) {
	              elem = this[i] || {};
	              if (elem.nodeType === 1) {
	                jQuery.cleanData(getAll(elem, false));
	                elem.innerHTML = value;
	              }
	            }
	            elem = 0;
	          } catch (e) {}
	        }
	        if (elem) {
	          this.empty().append(value);
	        }
	      }, null, value, arguments.length);
	    },
	    replaceWith: function() {
	      var arg = arguments[0];
	      this.domManip(arguments, function(elem) {
	        arg = this.parentNode;
	        jQuery.cleanData(getAll(this));
	        if (arg) {
	          arg.replaceChild(elem, this);
	        }
	      });
	      return arg && (arg.length || arg.nodeType) ? this : this.remove();
	    },
	    detach: function(selector) {
	      return this.remove(selector, true);
	    },
	    domManip: function(args, callback) {
	      args = concat.apply([], args);
	      var fragment,
	          first,
	          scripts,
	          hasScripts,
	          node,
	          doc,
	          i = 0,
	          l = this.length,
	          set = this,
	          iNoClone = l - 1,
	          value = args[0],
	          isFunction = jQuery.isFunction(value);
	      if (isFunction || (l > 1 && typeof value === "string" && !support.checkClone && rchecked.test(value))) {
	        return this.each(function(index) {
	          var self = set.eq(index);
	          if (isFunction) {
	            args[0] = value.call(this, index, self.html());
	          }
	          self.domManip(args, callback);
	        });
	      }
	      if (l) {
	        fragment = jQuery.buildFragment(args, this[0].ownerDocument, false, this);
	        first = fragment.firstChild;
	        if (fragment.childNodes.length === 1) {
	          fragment = first;
	        }
	        if (first) {
	          scripts = jQuery.map(getAll(fragment, "script"), disableScript);
	          hasScripts = scripts.length;
	          for (; i < l; i++) {
	            node = fragment;
	            if (i !== iNoClone) {
	              node = jQuery.clone(node, true, true);
	              if (hasScripts) {
	                jQuery.merge(scripts, getAll(node, "script"));
	              }
	            }
	            callback.call(this[i], node, i);
	          }
	          if (hasScripts) {
	            doc = scripts[scripts.length - 1].ownerDocument;
	            jQuery.map(scripts, restoreScript);
	            for (i = 0; i < hasScripts; i++) {
	              node = scripts[i];
	              if (rscriptType.test(node.type || "") && !data_priv.access(node, "globalEval") && jQuery.contains(doc, node)) {
	                if (node.src) {
	                  if (jQuery._evalUrl) {
	                    jQuery._evalUrl(node.src);
	                  }
	                } else {
	                  jQuery.globalEval(node.textContent.replace(rcleanScript, ""));
	                }
	              }
	            }
	          }
	        }
	      }
	      return this;
	    }
	  });
	  jQuery.each({
	    appendTo: "append",
	    prependTo: "prepend",
	    insertBefore: "before",
	    insertAfter: "after",
	    replaceAll: "replaceWith"
	  }, function(name, original) {
	    jQuery.fn[name] = function(selector) {
	      var elems,
	          ret = [],
	          insert = jQuery(selector),
	          last = insert.length - 1,
	          i = 0;
	      for (; i <= last; i++) {
	        elems = i === last ? this : this.clone(true);
	        jQuery(insert[i])[original](elems);
	        push.apply(ret, elems.get());
	      }
	      return this.pushStack(ret);
	    };
	  });
	  var iframe,
	      elemdisplay = {};
	  function actualDisplay(name, doc) {
	    var style,
	        elem = jQuery(doc.createElement(name)).appendTo(doc.body),
	        display = window.getDefaultComputedStyle && (style = window.getDefaultComputedStyle(elem[0])) ? style.display : jQuery.css(elem[0], "display");
	    elem.detach();
	    return display;
	  }
	  function defaultDisplay(nodeName) {
	    var doc = document,
	        display = elemdisplay[nodeName];
	    if (!display) {
	      display = actualDisplay(nodeName, doc);
	      if (display === "none" || !display) {
	        iframe = (iframe || jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);
	        doc = iframe[0].contentDocument;
	        doc.write();
	        doc.close();
	        display = actualDisplay(nodeName, doc);
	        iframe.detach();
	      }
	      elemdisplay[nodeName] = display;
	    }
	    return display;
	  }
	  var rmargin = (/^margin/);
	  var rnumnonpx = new RegExp("^(" + pnum + ")(?!px)[a-z%]+$", "i");
	  var getStyles = function(elem) {
	    if (elem.ownerDocument.defaultView.opener) {
	      return elem.ownerDocument.defaultView.getComputedStyle(elem, null);
	    }
	    return window.getComputedStyle(elem, null);
	  };
	  function curCSS(elem, name, computed) {
	    var width,
	        minWidth,
	        maxWidth,
	        ret,
	        style = elem.style;
	    computed = computed || getStyles(elem);
	    if (computed) {
	      ret = computed.getPropertyValue(name) || computed[name];
	    }
	    if (computed) {
	      if (ret === "" && !jQuery.contains(elem.ownerDocument, elem)) {
	        ret = jQuery.style(elem, name);
	      }
	      if (rnumnonpx.test(ret) && rmargin.test(name)) {
	        width = style.width;
	        minWidth = style.minWidth;
	        maxWidth = style.maxWidth;
	        style.minWidth = style.maxWidth = style.width = ret;
	        ret = computed.width;
	        style.width = width;
	        style.minWidth = minWidth;
	        style.maxWidth = maxWidth;
	      }
	    }
	    return ret !== undefined ? ret + "" : ret;
	  }
	  function addGetHookIf(conditionFn, hookFn) {
	    return {get: function() {
	        if (conditionFn()) {
	          delete this.get;
	          return;
	        }
	        return (this.get = hookFn).apply(this, arguments);
	      }};
	  }
	  (function() {
	    var pixelPositionVal,
	        boxSizingReliableVal,
	        docElem = document.documentElement,
	        container = document.createElement("div"),
	        div = document.createElement("div");
	    if (!div.style) {
	      return;
	    }
	    div.style.backgroundClip = "content-box";
	    div.cloneNode(true).style.backgroundClip = "";
	    support.clearCloneStyle = div.style.backgroundClip === "content-box";
	    container.style.cssText = "border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;" + "position:absolute";
	    container.appendChild(div);
	    function computePixelPositionAndBoxSizingReliable() {
	      div.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;" + "box-sizing:border-box;display:block;margin-top:1%;top:1%;" + "border:1px;padding:1px;width:4px;position:absolute";
	      div.innerHTML = "";
	      docElem.appendChild(container);
	      var divStyle = window.getComputedStyle(div, null);
	      pixelPositionVal = divStyle.top !== "1%";
	      boxSizingReliableVal = divStyle.width === "4px";
	      docElem.removeChild(container);
	    }
	    if (window.getComputedStyle) {
	      jQuery.extend(support, {
	        pixelPosition: function() {
	          computePixelPositionAndBoxSizingReliable();
	          return pixelPositionVal;
	        },
	        boxSizingReliable: function() {
	          if (boxSizingReliableVal == null) {
	            computePixelPositionAndBoxSizingReliable();
	          }
	          return boxSizingReliableVal;
	        },
	        reliableMarginRight: function() {
	          var ret,
	              marginDiv = div.appendChild(document.createElement("div"));
	          marginDiv.style.cssText = div.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;" + "box-sizing:content-box;display:block;margin:0;border:0;padding:0";
	          marginDiv.style.marginRight = marginDiv.style.width = "0";
	          div.style.width = "1px";
	          docElem.appendChild(container);
	          ret = !parseFloat(window.getComputedStyle(marginDiv, null).marginRight);
	          docElem.removeChild(container);
	          div.removeChild(marginDiv);
	          return ret;
	        }
	      });
	    }
	  })();
	  jQuery.swap = function(elem, options, callback, args) {
	    var ret,
	        name,
	        old = {};
	    for (name in options) {
	      old[name] = elem.style[name];
	      elem.style[name] = options[name];
	    }
	    ret = callback.apply(elem, args || []);
	    for (name in options) {
	      elem.style[name] = old[name];
	    }
	    return ret;
	  };
	  var rdisplayswap = /^(none|table(?!-c[ea]).+)/,
	      rnumsplit = new RegExp("^(" + pnum + ")(.*)$", "i"),
	      rrelNum = new RegExp("^([+-])=(" + pnum + ")", "i"),
	      cssShow = {
	        position: "absolute",
	        visibility: "hidden",
	        display: "block"
	      },
	      cssNormalTransform = {
	        letterSpacing: "0",
	        fontWeight: "400"
	      },
	      cssPrefixes = ["Webkit", "O", "Moz", "ms"];
	  function vendorPropName(style, name) {
	    if (name in style) {
	      return name;
	    }
	    var capName = name[0].toUpperCase() + name.slice(1),
	        origName = name,
	        i = cssPrefixes.length;
	    while (i--) {
	      name = cssPrefixes[i] + capName;
	      if (name in style) {
	        return name;
	      }
	    }
	    return origName;
	  }
	  function setPositiveNumber(elem, value, subtract) {
	    var matches = rnumsplit.exec(value);
	    return matches ? Math.max(0, matches[1] - (subtract || 0)) + (matches[2] || "px") : value;
	  }
	  function augmentWidthOrHeight(elem, name, extra, isBorderBox, styles) {
	    var i = extra === (isBorderBox ? "border" : "content") ? 4 : name === "width" ? 1 : 0,
	        val = 0;
	    for (; i < 4; i += 2) {
	      if (extra === "margin") {
	        val += jQuery.css(elem, extra + cssExpand[i], true, styles);
	      }
	      if (isBorderBox) {
	        if (extra === "content") {
	          val -= jQuery.css(elem, "padding" + cssExpand[i], true, styles);
	        }
	        if (extra !== "margin") {
	          val -= jQuery.css(elem, "border" + cssExpand[i] + "Width", true, styles);
	        }
	      } else {
	        val += jQuery.css(elem, "padding" + cssExpand[i], true, styles);
	        if (extra !== "padding") {
	          val += jQuery.css(elem, "border" + cssExpand[i] + "Width", true, styles);
	        }
	      }
	    }
	    return val;
	  }
	  function getWidthOrHeight(elem, name, extra) {
	    var valueIsBorderBox = true,
	        val = name === "width" ? elem.offsetWidth : elem.offsetHeight,
	        styles = getStyles(elem),
	        isBorderBox = jQuery.css(elem, "boxSizing", false, styles) === "border-box";
	    if (val <= 0 || val == null) {
	      val = curCSS(elem, name, styles);
	      if (val < 0 || val == null) {
	        val = elem.style[name];
	      }
	      if (rnumnonpx.test(val)) {
	        return val;
	      }
	      valueIsBorderBox = isBorderBox && (support.boxSizingReliable() || val === elem.style[name]);
	      val = parseFloat(val) || 0;
	    }
	    return (val + augmentWidthOrHeight(elem, name, extra || (isBorderBox ? "border" : "content"), valueIsBorderBox, styles)) + "px";
	  }
	  function showHide(elements, show) {
	    var display,
	        elem,
	        hidden,
	        values = [],
	        index = 0,
	        length = elements.length;
	    for (; index < length; index++) {
	      elem = elements[index];
	      if (!elem.style) {
	        continue;
	      }
	      values[index] = data_priv.get(elem, "olddisplay");
	      display = elem.style.display;
	      if (show) {
	        if (!values[index] && display === "none") {
	          elem.style.display = "";
	        }
	        if (elem.style.display === "" && isHidden(elem)) {
	          values[index] = data_priv.access(elem, "olddisplay", defaultDisplay(elem.nodeName));
	        }
	      } else {
	        hidden = isHidden(elem);
	        if (display !== "none" || !hidden) {
	          data_priv.set(elem, "olddisplay", hidden ? display : jQuery.css(elem, "display"));
	        }
	      }
	    }
	    for (index = 0; index < length; index++) {
	      elem = elements[index];
	      if (!elem.style) {
	        continue;
	      }
	      if (!show || elem.style.display === "none" || elem.style.display === "") {
	        elem.style.display = show ? values[index] || "" : "none";
	      }
	    }
	    return elements;
	  }
	  jQuery.extend({
	    cssHooks: {opacity: {get: function(elem, computed) {
	          if (computed) {
	            var ret = curCSS(elem, "opacity");
	            return ret === "" ? "1" : ret;
	          }
	        }}},
	    cssNumber: {
	      "columnCount": true,
	      "fillOpacity": true,
	      "flexGrow": true,
	      "flexShrink": true,
	      "fontWeight": true,
	      "lineHeight": true,
	      "opacity": true,
	      "order": true,
	      "orphans": true,
	      "widows": true,
	      "zIndex": true,
	      "zoom": true
	    },
	    cssProps: {"float": "cssFloat"},
	    style: function(elem, name, value, extra) {
	      if (!elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style) {
	        return;
	      }
	      var ret,
	          type,
	          hooks,
	          origName = jQuery.camelCase(name),
	          style = elem.style;
	      name = jQuery.cssProps[origName] || (jQuery.cssProps[origName] = vendorPropName(style, origName));
	      hooks = jQuery.cssHooks[name] || jQuery.cssHooks[origName];
	      if (value !== undefined) {
	        type = typeof value;
	        if (type === "string" && (ret = rrelNum.exec(value))) {
	          value = (ret[1] + 1) * ret[2] + parseFloat(jQuery.css(elem, name));
	          type = "number";
	        }
	        if (value == null || value !== value) {
	          return;
	        }
	        if (type === "number" && !jQuery.cssNumber[origName]) {
	          value += "px";
	        }
	        if (!support.clearCloneStyle && value === "" && name.indexOf("background") === 0) {
	          style[name] = "inherit";
	        }
	        if (!hooks || !("set" in hooks) || (value = hooks.set(elem, value, extra)) !== undefined) {
	          style[name] = value;
	        }
	      } else {
	        if (hooks && "get" in hooks && (ret = hooks.get(elem, false, extra)) !== undefined) {
	          return ret;
	        }
	        return style[name];
	      }
	    },
	    css: function(elem, name, extra, styles) {
	      var val,
	          num,
	          hooks,
	          origName = jQuery.camelCase(name);
	      name = jQuery.cssProps[origName] || (jQuery.cssProps[origName] = vendorPropName(elem.style, origName));
	      hooks = jQuery.cssHooks[name] || jQuery.cssHooks[origName];
	      if (hooks && "get" in hooks) {
	        val = hooks.get(elem, true, extra);
	      }
	      if (val === undefined) {
	        val = curCSS(elem, name, styles);
	      }
	      if (val === "normal" && name in cssNormalTransform) {
	        val = cssNormalTransform[name];
	      }
	      if (extra === "" || extra) {
	        num = parseFloat(val);
	        return extra === true || jQuery.isNumeric(num) ? num || 0 : val;
	      }
	      return val;
	    }
	  });
	  jQuery.each(["height", "width"], function(i, name) {
	    jQuery.cssHooks[name] = {
	      get: function(elem, computed, extra) {
	        if (computed) {
	          return rdisplayswap.test(jQuery.css(elem, "display")) && elem.offsetWidth === 0 ? jQuery.swap(elem, cssShow, function() {
	            return getWidthOrHeight(elem, name, extra);
	          }) : getWidthOrHeight(elem, name, extra);
	        }
	      },
	      set: function(elem, value, extra) {
	        var styles = extra && getStyles(elem);
	        return setPositiveNumber(elem, value, extra ? augmentWidthOrHeight(elem, name, extra, jQuery.css(elem, "boxSizing", false, styles) === "border-box", styles) : 0);
	      }
	    };
	  });
	  jQuery.cssHooks.marginRight = addGetHookIf(support.reliableMarginRight, function(elem, computed) {
	    if (computed) {
	      return jQuery.swap(elem, {"display": "inline-block"}, curCSS, [elem, "marginRight"]);
	    }
	  });
	  jQuery.each({
	    margin: "",
	    padding: "",
	    border: "Width"
	  }, function(prefix, suffix) {
	    jQuery.cssHooks[prefix + suffix] = {expand: function(value) {
	        var i = 0,
	            expanded = {},
	            parts = typeof value === "string" ? value.split(" ") : [value];
	        for (; i < 4; i++) {
	          expanded[prefix + cssExpand[i] + suffix] = parts[i] || parts[i - 2] || parts[0];
	        }
	        return expanded;
	      }};
	    if (!rmargin.test(prefix)) {
	      jQuery.cssHooks[prefix + suffix].set = setPositiveNumber;
	    }
	  });
	  jQuery.fn.extend({
	    css: function(name, value) {
	      return access(this, function(elem, name, value) {
	        var styles,
	            len,
	            map = {},
	            i = 0;
	        if (jQuery.isArray(name)) {
	          styles = getStyles(elem);
	          len = name.length;
	          for (; i < len; i++) {
	            map[name[i]] = jQuery.css(elem, name[i], false, styles);
	          }
	          return map;
	        }
	        return value !== undefined ? jQuery.style(elem, name, value) : jQuery.css(elem, name);
	      }, name, value, arguments.length > 1);
	    },
	    show: function() {
	      return showHide(this, true);
	    },
	    hide: function() {
	      return showHide(this);
	    },
	    toggle: function(state) {
	      if (typeof state === "boolean") {
	        return state ? this.show() : this.hide();
	      }
	      return this.each(function() {
	        if (isHidden(this)) {
	          jQuery(this).show();
	        } else {
	          jQuery(this).hide();
	        }
	      });
	    }
	  });
	  function Tween(elem, options, prop, end, easing) {
	    return new Tween.prototype.init(elem, options, prop, end, easing);
	  }
	  jQuery.Tween = Tween;
	  Tween.prototype = {
	    constructor: Tween,
	    init: function(elem, options, prop, end, easing, unit) {
	      this.elem = elem;
	      this.prop = prop;
	      this.easing = easing || "swing";
	      this.options = options;
	      this.start = this.now = this.cur();
	      this.end = end;
	      this.unit = unit || (jQuery.cssNumber[prop] ? "" : "px");
	    },
	    cur: function() {
	      var hooks = Tween.propHooks[this.prop];
	      return hooks && hooks.get ? hooks.get(this) : Tween.propHooks._default.get(this);
	    },
	    run: function(percent) {
	      var eased,
	          hooks = Tween.propHooks[this.prop];
	      if (this.options.duration) {
	        this.pos = eased = jQuery.easing[this.easing](percent, this.options.duration * percent, 0, 1, this.options.duration);
	      } else {
	        this.pos = eased = percent;
	      }
	      this.now = (this.end - this.start) * eased + this.start;
	      if (this.options.step) {
	        this.options.step.call(this.elem, this.now, this);
	      }
	      if (hooks && hooks.set) {
	        hooks.set(this);
	      } else {
	        Tween.propHooks._default.set(this);
	      }
	      return this;
	    }
	  };
	  Tween.prototype.init.prototype = Tween.prototype;
	  Tween.propHooks = {_default: {
	      get: function(tween) {
	        var result;
	        if (tween.elem[tween.prop] != null && (!tween.elem.style || tween.elem.style[tween.prop] == null)) {
	          return tween.elem[tween.prop];
	        }
	        result = jQuery.css(tween.elem, tween.prop, "");
	        return !result || result === "auto" ? 0 : result;
	      },
	      set: function(tween) {
	        if (jQuery.fx.step[tween.prop]) {
	          jQuery.fx.step[tween.prop](tween);
	        } else if (tween.elem.style && (tween.elem.style[jQuery.cssProps[tween.prop]] != null || jQuery.cssHooks[tween.prop])) {
	          jQuery.style(tween.elem, tween.prop, tween.now + tween.unit);
	        } else {
	          tween.elem[tween.prop] = tween.now;
	        }
	      }
	    }};
	  Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {set: function(tween) {
	      if (tween.elem.nodeType && tween.elem.parentNode) {
	        tween.elem[tween.prop] = tween.now;
	      }
	    }};
	  jQuery.easing = {
	    linear: function(p) {
	      return p;
	    },
	    swing: function(p) {
	      return 0.5 - Math.cos(p * Math.PI) / 2;
	    }
	  };
	  jQuery.fx = Tween.prototype.init;
	  jQuery.fx.step = {};
	  var fxNow,
	      timerId,
	      rfxtypes = /^(?:toggle|show|hide)$/,
	      rfxnum = new RegExp("^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i"),
	      rrun = /queueHooks$/,
	      animationPrefilters = [defaultPrefilter],
	      tweeners = {"*": [function(prop, value) {
	          var tween = this.createTween(prop, value),
	              target = tween.cur(),
	              parts = rfxnum.exec(value),
	              unit = parts && parts[3] || (jQuery.cssNumber[prop] ? "" : "px"),
	              start = (jQuery.cssNumber[prop] || unit !== "px" && +target) && rfxnum.exec(jQuery.css(tween.elem, prop)),
	              scale = 1,
	              maxIterations = 20;
	          if (start && start[3] !== unit) {
	            unit = unit || start[3];
	            parts = parts || [];
	            start = +target || 1;
	            do {
	              scale = scale || ".5";
	              start = start / scale;
	              jQuery.style(tween.elem, prop, start + unit);
	            } while (scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations);
	          }
	          if (parts) {
	            start = tween.start = +start || +target || 0;
	            tween.unit = unit;
	            tween.end = parts[1] ? start + (parts[1] + 1) * parts[2] : +parts[2];
	          }
	          return tween;
	        }]};
	  function createFxNow() {
	    setTimeout(function() {
	      fxNow = undefined;
	    });
	    return (fxNow = jQuery.now());
	  }
	  function genFx(type, includeWidth) {
	    var which,
	        i = 0,
	        attrs = {height: type};
	    includeWidth = includeWidth ? 1 : 0;
	    for (; i < 4; i += 2 - includeWidth) {
	      which = cssExpand[i];
	      attrs["margin" + which] = attrs["padding" + which] = type;
	    }
	    if (includeWidth) {
	      attrs.opacity = attrs.width = type;
	    }
	    return attrs;
	  }
	  function createTween(value, prop, animation) {
	    var tween,
	        collection = (tweeners[prop] || []).concat(tweeners["*"]),
	        index = 0,
	        length = collection.length;
	    for (; index < length; index++) {
	      if ((tween = collection[index].call(animation, prop, value))) {
	        return tween;
	      }
	    }
	  }
	  function defaultPrefilter(elem, props, opts) {
	    var prop,
	        value,
	        toggle,
	        tween,
	        hooks,
	        oldfire,
	        display,
	        checkDisplay,
	        anim = this,
	        orig = {},
	        style = elem.style,
	        hidden = elem.nodeType && isHidden(elem),
	        dataShow = data_priv.get(elem, "fxshow");
	    if (!opts.queue) {
	      hooks = jQuery._queueHooks(elem, "fx");
	      if (hooks.unqueued == null) {
	        hooks.unqueued = 0;
	        oldfire = hooks.empty.fire;
	        hooks.empty.fire = function() {
	          if (!hooks.unqueued) {
	            oldfire();
	          }
	        };
	      }
	      hooks.unqueued++;
	      anim.always(function() {
	        anim.always(function() {
	          hooks.unqueued--;
	          if (!jQuery.queue(elem, "fx").length) {
	            hooks.empty.fire();
	          }
	        });
	      });
	    }
	    if (elem.nodeType === 1 && ("height" in props || "width" in props)) {
	      opts.overflow = [style.overflow, style.overflowX, style.overflowY];
	      display = jQuery.css(elem, "display");
	      checkDisplay = display === "none" ? data_priv.get(elem, "olddisplay") || defaultDisplay(elem.nodeName) : display;
	      if (checkDisplay === "inline" && jQuery.css(elem, "float") === "none") {
	        style.display = "inline-block";
	      }
	    }
	    if (opts.overflow) {
	      style.overflow = "hidden";
	      anim.always(function() {
	        style.overflow = opts.overflow[0];
	        style.overflowX = opts.overflow[1];
	        style.overflowY = opts.overflow[2];
	      });
	    }
	    for (prop in props) {
	      value = props[prop];
	      if (rfxtypes.exec(value)) {
	        delete props[prop];
	        toggle = toggle || value === "toggle";
	        if (value === (hidden ? "hide" : "show")) {
	          if (value === "show" && dataShow && dataShow[prop] !== undefined) {
	            hidden = true;
	          } else {
	            continue;
	          }
	        }
	        orig[prop] = dataShow && dataShow[prop] || jQuery.style(elem, prop);
	      } else {
	        display = undefined;
	      }
	    }
	    if (!jQuery.isEmptyObject(orig)) {
	      if (dataShow) {
	        if ("hidden" in dataShow) {
	          hidden = dataShow.hidden;
	        }
	      } else {
	        dataShow = data_priv.access(elem, "fxshow", {});
	      }
	      if (toggle) {
	        dataShow.hidden = !hidden;
	      }
	      if (hidden) {
	        jQuery(elem).show();
	      } else {
	        anim.done(function() {
	          jQuery(elem).hide();
	        });
	      }
	      anim.done(function() {
	        var prop;
	        data_priv.remove(elem, "fxshow");
	        for (prop in orig) {
	          jQuery.style(elem, prop, orig[prop]);
	        }
	      });
	      for (prop in orig) {
	        tween = createTween(hidden ? dataShow[prop] : 0, prop, anim);
	        if (!(prop in dataShow)) {
	          dataShow[prop] = tween.start;
	          if (hidden) {
	            tween.end = tween.start;
	            tween.start = prop === "width" || prop === "height" ? 1 : 0;
	          }
	        }
	      }
	    } else if ((display === "none" ? defaultDisplay(elem.nodeName) : display) === "inline") {
	      style.display = display;
	    }
	  }
	  function propFilter(props, specialEasing) {
	    var index,
	        name,
	        easing,
	        value,
	        hooks;
	    for (index in props) {
	      name = jQuery.camelCase(index);
	      easing = specialEasing[name];
	      value = props[index];
	      if (jQuery.isArray(value)) {
	        easing = value[1];
	        value = props[index] = value[0];
	      }
	      if (index !== name) {
	        props[name] = value;
	        delete props[index];
	      }
	      hooks = jQuery.cssHooks[name];
	      if (hooks && "expand" in hooks) {
	        value = hooks.expand(value);
	        delete props[name];
	        for (index in value) {
	          if (!(index in props)) {
	            props[index] = value[index];
	            specialEasing[index] = easing;
	          }
	        }
	      } else {
	        specialEasing[name] = easing;
	      }
	    }
	  }
	  function Animation(elem, properties, options) {
	    var result,
	        stopped,
	        index = 0,
	        length = animationPrefilters.length,
	        deferred = jQuery.Deferred().always(function() {
	          delete tick.elem;
	        }),
	        tick = function() {
	          if (stopped) {
	            return false;
	          }
	          var currentTime = fxNow || createFxNow(),
	              remaining = Math.max(0, animation.startTime + animation.duration - currentTime),
	              temp = remaining / animation.duration || 0,
	              percent = 1 - temp,
	              index = 0,
	              length = animation.tweens.length;
	          for (; index < length; index++) {
	            animation.tweens[index].run(percent);
	          }
	          deferred.notifyWith(elem, [animation, percent, remaining]);
	          if (percent < 1 && length) {
	            return remaining;
	          } else {
	            deferred.resolveWith(elem, [animation]);
	            return false;
	          }
	        },
	        animation = deferred.promise({
	          elem: elem,
	          props: jQuery.extend({}, properties),
	          opts: jQuery.extend(true, {specialEasing: {}}, options),
	          originalProperties: properties,
	          originalOptions: options,
	          startTime: fxNow || createFxNow(),
	          duration: options.duration,
	          tweens: [],
	          createTween: function(prop, end) {
	            var tween = jQuery.Tween(elem, animation.opts, prop, end, animation.opts.specialEasing[prop] || animation.opts.easing);
	            animation.tweens.push(tween);
	            return tween;
	          },
	          stop: function(gotoEnd) {
	            var index = 0,
	                length = gotoEnd ? animation.tweens.length : 0;
	            if (stopped) {
	              return this;
	            }
	            stopped = true;
	            for (; index < length; index++) {
	              animation.tweens[index].run(1);
	            }
	            if (gotoEnd) {
	              deferred.resolveWith(elem, [animation, gotoEnd]);
	            } else {
	              deferred.rejectWith(elem, [animation, gotoEnd]);
	            }
	            return this;
	          }
	        }),
	        props = animation.props;
	    propFilter(props, animation.opts.specialEasing);
	    for (; index < length; index++) {
	      result = animationPrefilters[index].call(animation, elem, props, animation.opts);
	      if (result) {
	        return result;
	      }
	    }
	    jQuery.map(props, createTween, animation);
	    if (jQuery.isFunction(animation.opts.start)) {
	      animation.opts.start.call(elem, animation);
	    }
	    jQuery.fx.timer(jQuery.extend(tick, {
	      elem: elem,
	      anim: animation,
	      queue: animation.opts.queue
	    }));
	    return animation.progress(animation.opts.progress).done(animation.opts.done, animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);
	  }
	  jQuery.Animation = jQuery.extend(Animation, {
	    tweener: function(props, callback) {
	      if (jQuery.isFunction(props)) {
	        callback = props;
	        props = ["*"];
	      } else {
	        props = props.split(" ");
	      }
	      var prop,
	          index = 0,
	          length = props.length;
	      for (; index < length; index++) {
	        prop = props[index];
	        tweeners[prop] = tweeners[prop] || [];
	        tweeners[prop].unshift(callback);
	      }
	    },
	    prefilter: function(callback, prepend) {
	      if (prepend) {
	        animationPrefilters.unshift(callback);
	      } else {
	        animationPrefilters.push(callback);
	      }
	    }
	  });
	  jQuery.speed = function(speed, easing, fn) {
	    var opt = speed && typeof speed === "object" ? jQuery.extend({}, speed) : {
	      complete: fn || !fn && easing || jQuery.isFunction(speed) && speed,
	      duration: speed,
	      easing: fn && easing || easing && !jQuery.isFunction(easing) && easing
	    };
	    opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ? opt.duration : opt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[opt.duration] : jQuery.fx.speeds._default;
	    if (opt.queue == null || opt.queue === true) {
	      opt.queue = "fx";
	    }
	    opt.old = opt.complete;
	    opt.complete = function() {
	      if (jQuery.isFunction(opt.old)) {
	        opt.old.call(this);
	      }
	      if (opt.queue) {
	        jQuery.dequeue(this, opt.queue);
	      }
	    };
	    return opt;
	  };
	  jQuery.fn.extend({
	    fadeTo: function(speed, to, easing, callback) {
	      return this.filter(isHidden).css("opacity", 0).show().end().animate({opacity: to}, speed, easing, callback);
	    },
	    animate: function(prop, speed, easing, callback) {
	      var empty = jQuery.isEmptyObject(prop),
	          optall = jQuery.speed(speed, easing, callback),
	          doAnimation = function() {
	            var anim = Animation(this, jQuery.extend({}, prop), optall);
	            if (empty || data_priv.get(this, "finish")) {
	              anim.stop(true);
	            }
	          };
	      doAnimation.finish = doAnimation;
	      return empty || optall.queue === false ? this.each(doAnimation) : this.queue(optall.queue, doAnimation);
	    },
	    stop: function(type, clearQueue, gotoEnd) {
	      var stopQueue = function(hooks) {
	        var stop = hooks.stop;
	        delete hooks.stop;
	        stop(gotoEnd);
	      };
	      if (typeof type !== "string") {
	        gotoEnd = clearQueue;
	        clearQueue = type;
	        type = undefined;
	      }
	      if (clearQueue && type !== false) {
	        this.queue(type || "fx", []);
	      }
	      return this.each(function() {
	        var dequeue = true,
	            index = type != null && type + "queueHooks",
	            timers = jQuery.timers,
	            data = data_priv.get(this);
	        if (index) {
	          if (data[index] && data[index].stop) {
	            stopQueue(data[index]);
	          }
	        } else {
	          for (index in data) {
	            if (data[index] && data[index].stop && rrun.test(index)) {
	              stopQueue(data[index]);
	            }
	          }
	        }
	        for (index = timers.length; index--; ) {
	          if (timers[index].elem === this && (type == null || timers[index].queue === type)) {
	            timers[index].anim.stop(gotoEnd);
	            dequeue = false;
	            timers.splice(index, 1);
	          }
	        }
	        if (dequeue || !gotoEnd) {
	          jQuery.dequeue(this, type);
	        }
	      });
	    },
	    finish: function(type) {
	      if (type !== false) {
	        type = type || "fx";
	      }
	      return this.each(function() {
	        var index,
	            data = data_priv.get(this),
	            queue = data[type + "queue"],
	            hooks = data[type + "queueHooks"],
	            timers = jQuery.timers,
	            length = queue ? queue.length : 0;
	        data.finish = true;
	        jQuery.queue(this, type, []);
	        if (hooks && hooks.stop) {
	          hooks.stop.call(this, true);
	        }
	        for (index = timers.length; index--; ) {
	          if (timers[index].elem === this && timers[index].queue === type) {
	            timers[index].anim.stop(true);
	            timers.splice(index, 1);
	          }
	        }
	        for (index = 0; index < length; index++) {
	          if (queue[index] && queue[index].finish) {
	            queue[index].finish.call(this);
	          }
	        }
	        delete data.finish;
	      });
	    }
	  });
	  jQuery.each(["toggle", "show", "hide"], function(i, name) {
	    var cssFn = jQuery.fn[name];
	    jQuery.fn[name] = function(speed, easing, callback) {
	      return speed == null || typeof speed === "boolean" ? cssFn.apply(this, arguments) : this.animate(genFx(name, true), speed, easing, callback);
	    };
	  });
	  jQuery.each({
	    slideDown: genFx("show"),
	    slideUp: genFx("hide"),
	    slideToggle: genFx("toggle"),
	    fadeIn: {opacity: "show"},
	    fadeOut: {opacity: "hide"},
	    fadeToggle: {opacity: "toggle"}
	  }, function(name, props) {
	    jQuery.fn[name] = function(speed, easing, callback) {
	      return this.animate(props, speed, easing, callback);
	    };
	  });
	  jQuery.timers = [];
	  jQuery.fx.tick = function() {
	    var timer,
	        i = 0,
	        timers = jQuery.timers;
	    fxNow = jQuery.now();
	    for (; i < timers.length; i++) {
	      timer = timers[i];
	      if (!timer() && timers[i] === timer) {
	        timers.splice(i--, 1);
	      }
	    }
	    if (!timers.length) {
	      jQuery.fx.stop();
	    }
	    fxNow = undefined;
	  };
	  jQuery.fx.timer = function(timer) {
	    jQuery.timers.push(timer);
	    if (timer()) {
	      jQuery.fx.start();
	    } else {
	      jQuery.timers.pop();
	    }
	  };
	  jQuery.fx.interval = 13;
	  jQuery.fx.start = function() {
	    if (!timerId) {
	      timerId = setInterval(jQuery.fx.tick, jQuery.fx.interval);
	    }
	  };
	  jQuery.fx.stop = function() {
	    clearInterval(timerId);
	    timerId = null;
	  };
	  jQuery.fx.speeds = {
	    slow: 600,
	    fast: 200,
	    _default: 400
	  };
	  jQuery.fn.delay = function(time, type) {
	    time = jQuery.fx ? jQuery.fx.speeds[time] || time : time;
	    type = type || "fx";
	    return this.queue(type, function(next, hooks) {
	      var timeout = setTimeout(next, time);
	      hooks.stop = function() {
	        clearTimeout(timeout);
	      };
	    });
	  };
	  (function() {
	    var input = document.createElement("input"),
	        select = document.createElement("select"),
	        opt = select.appendChild(document.createElement("option"));
	    input.type = "checkbox";
	    support.checkOn = input.value !== "";
	    support.optSelected = opt.selected;
	    select.disabled = true;
	    support.optDisabled = !opt.disabled;
	    input = document.createElement("input");
	    input.value = "t";
	    input.type = "radio";
	    support.radioValue = input.value === "t";
	  })();
	  var nodeHook,
	      boolHook,
	      attrHandle = jQuery.expr.attrHandle;
	  jQuery.fn.extend({
	    attr: function(name, value) {
	      return access(this, jQuery.attr, name, value, arguments.length > 1);
	    },
	    removeAttr: function(name) {
	      return this.each(function() {
	        jQuery.removeAttr(this, name);
	      });
	    }
	  });
	  jQuery.extend({
	    attr: function(elem, name, value) {
	      var hooks,
	          ret,
	          nType = elem.nodeType;
	      if (!elem || nType === 3 || nType === 8 || nType === 2) {
	        return;
	      }
	      if (typeof elem.getAttribute === strundefined) {
	        return jQuery.prop(elem, name, value);
	      }
	      if (nType !== 1 || !jQuery.isXMLDoc(elem)) {
	        name = name.toLowerCase();
	        hooks = jQuery.attrHooks[name] || (jQuery.expr.match.bool.test(name) ? boolHook : nodeHook);
	      }
	      if (value !== undefined) {
	        if (value === null) {
	          jQuery.removeAttr(elem, name);
	        } else if (hooks && "set" in hooks && (ret = hooks.set(elem, value, name)) !== undefined) {
	          return ret;
	        } else {
	          elem.setAttribute(name, value + "");
	          return value;
	        }
	      } else if (hooks && "get" in hooks && (ret = hooks.get(elem, name)) !== null) {
	        return ret;
	      } else {
	        ret = jQuery.find.attr(elem, name);
	        return ret == null ? undefined : ret;
	      }
	    },
	    removeAttr: function(elem, value) {
	      var name,
	          propName,
	          i = 0,
	          attrNames = value && value.match(rnotwhite);
	      if (attrNames && elem.nodeType === 1) {
	        while ((name = attrNames[i++])) {
	          propName = jQuery.propFix[name] || name;
	          if (jQuery.expr.match.bool.test(name)) {
	            elem[propName] = false;
	          }
	          elem.removeAttribute(name);
	        }
	      }
	    },
	    attrHooks: {type: {set: function(elem, value) {
	          if (!support.radioValue && value === "radio" && jQuery.nodeName(elem, "input")) {
	            var val = elem.value;
	            elem.setAttribute("type", value);
	            if (val) {
	              elem.value = val;
	            }
	            return value;
	          }
	        }}}
	  });
	  boolHook = {set: function(elem, value, name) {
	      if (value === false) {
	        jQuery.removeAttr(elem, name);
	      } else {
	        elem.setAttribute(name, name);
	      }
	      return name;
	    }};
	  jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g), function(i, name) {
	    var getter = attrHandle[name] || jQuery.find.attr;
	    attrHandle[name] = function(elem, name, isXML) {
	      var ret,
	          handle;
	      if (!isXML) {
	        handle = attrHandle[name];
	        attrHandle[name] = ret;
	        ret = getter(elem, name, isXML) != null ? name.toLowerCase() : null;
	        attrHandle[name] = handle;
	      }
	      return ret;
	    };
	  });
	  var rfocusable = /^(?:input|select|textarea|button)$/i;
	  jQuery.fn.extend({
	    prop: function(name, value) {
	      return access(this, jQuery.prop, name, value, arguments.length > 1);
	    },
	    removeProp: function(name) {
	      return this.each(function() {
	        delete this[jQuery.propFix[name] || name];
	      });
	    }
	  });
	  jQuery.extend({
	    propFix: {
	      "for": "htmlFor",
	      "class": "className"
	    },
	    prop: function(elem, name, value) {
	      var ret,
	          hooks,
	          notxml,
	          nType = elem.nodeType;
	      if (!elem || nType === 3 || nType === 8 || nType === 2) {
	        return;
	      }
	      notxml = nType !== 1 || !jQuery.isXMLDoc(elem);
	      if (notxml) {
	        name = jQuery.propFix[name] || name;
	        hooks = jQuery.propHooks[name];
	      }
	      if (value !== undefined) {
	        return hooks && "set" in hooks && (ret = hooks.set(elem, value, name)) !== undefined ? ret : (elem[name] = value);
	      } else {
	        return hooks && "get" in hooks && (ret = hooks.get(elem, name)) !== null ? ret : elem[name];
	      }
	    },
	    propHooks: {tabIndex: {get: function(elem) {
	          return elem.hasAttribute("tabindex") || rfocusable.test(elem.nodeName) || elem.href ? elem.tabIndex : -1;
	        }}}
	  });
	  if (!support.optSelected) {
	    jQuery.propHooks.selected = {get: function(elem) {
	        var parent = elem.parentNode;
	        if (parent && parent.parentNode) {
	          parent.parentNode.selectedIndex;
	        }
	        return null;
	      }};
	  }
	  jQuery.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
	    jQuery.propFix[this.toLowerCase()] = this;
	  });
	  var rclass = /[\t\r\n\f]/g;
	  jQuery.fn.extend({
	    addClass: function(value) {
	      var classes,
	          elem,
	          cur,
	          clazz,
	          j,
	          finalValue,
	          proceed = typeof value === "string" && value,
	          i = 0,
	          len = this.length;
	      if (jQuery.isFunction(value)) {
	        return this.each(function(j) {
	          jQuery(this).addClass(value.call(this, j, this.className));
	        });
	      }
	      if (proceed) {
	        classes = (value || "").match(rnotwhite) || [];
	        for (; i < len; i++) {
	          elem = this[i];
	          cur = elem.nodeType === 1 && (elem.className ? (" " + elem.className + " ").replace(rclass, " ") : " ");
	          if (cur) {
	            j = 0;
	            while ((clazz = classes[j++])) {
	              if (cur.indexOf(" " + clazz + " ") < 0) {
	                cur += clazz + " ";
	              }
	            }
	            finalValue = jQuery.trim(cur);
	            if (elem.className !== finalValue) {
	              elem.className = finalValue;
	            }
	          }
	        }
	      }
	      return this;
	    },
	    removeClass: function(value) {
	      var classes,
	          elem,
	          cur,
	          clazz,
	          j,
	          finalValue,
	          proceed = arguments.length === 0 || typeof value === "string" && value,
	          i = 0,
	          len = this.length;
	      if (jQuery.isFunction(value)) {
	        return this.each(function(j) {
	          jQuery(this).removeClass(value.call(this, j, this.className));
	        });
	      }
	      if (proceed) {
	        classes = (value || "").match(rnotwhite) || [];
	        for (; i < len; i++) {
	          elem = this[i];
	          cur = elem.nodeType === 1 && (elem.className ? (" " + elem.className + " ").replace(rclass, " ") : "");
	          if (cur) {
	            j = 0;
	            while ((clazz = classes[j++])) {
	              while (cur.indexOf(" " + clazz + " ") >= 0) {
	                cur = cur.replace(" " + clazz + " ", " ");
	              }
	            }
	            finalValue = value ? jQuery.trim(cur) : "";
	            if (elem.className !== finalValue) {
	              elem.className = finalValue;
	            }
	          }
	        }
	      }
	      return this;
	    },
	    toggleClass: function(value, stateVal) {
	      var type = typeof value;
	      if (typeof stateVal === "boolean" && type === "string") {
	        return stateVal ? this.addClass(value) : this.removeClass(value);
	      }
	      if (jQuery.isFunction(value)) {
	        return this.each(function(i) {
	          jQuery(this).toggleClass(value.call(this, i, this.className, stateVal), stateVal);
	        });
	      }
	      return this.each(function() {
	        if (type === "string") {
	          var className,
	              i = 0,
	              self = jQuery(this),
	              classNames = value.match(rnotwhite) || [];
	          while ((className = classNames[i++])) {
	            if (self.hasClass(className)) {
	              self.removeClass(className);
	            } else {
	              self.addClass(className);
	            }
	          }
	        } else if (type === strundefined || type === "boolean") {
	          if (this.className) {
	            data_priv.set(this, "__className__", this.className);
	          }
	          this.className = this.className || value === false ? "" : data_priv.get(this, "__className__") || "";
	        }
	      });
	    },
	    hasClass: function(selector) {
	      var className = " " + selector + " ",
	          i = 0,
	          l = this.length;
	      for (; i < l; i++) {
	        if (this[i].nodeType === 1 && (" " + this[i].className + " ").replace(rclass, " ").indexOf(className) >= 0) {
	          return true;
	        }
	      }
	      return false;
	    }
	  });
	  var rreturn = /\r/g;
	  jQuery.fn.extend({val: function(value) {
	      var hooks,
	          ret,
	          isFunction,
	          elem = this[0];
	      if (!arguments.length) {
	        if (elem) {
	          hooks = jQuery.valHooks[elem.type] || jQuery.valHooks[elem.nodeName.toLowerCase()];
	          if (hooks && "get" in hooks && (ret = hooks.get(elem, "value")) !== undefined) {
	            return ret;
	          }
	          ret = elem.value;
	          return typeof ret === "string" ? ret.replace(rreturn, "") : ret == null ? "" : ret;
	        }
	        return;
	      }
	      isFunction = jQuery.isFunction(value);
	      return this.each(function(i) {
	        var val;
	        if (this.nodeType !== 1) {
	          return;
	        }
	        if (isFunction) {
	          val = value.call(this, i, jQuery(this).val());
	        } else {
	          val = value;
	        }
	        if (val == null) {
	          val = "";
	        } else if (typeof val === "number") {
	          val += "";
	        } else if (jQuery.isArray(val)) {
	          val = jQuery.map(val, function(value) {
	            return value == null ? "" : value + "";
	          });
	        }
	        hooks = jQuery.valHooks[this.type] || jQuery.valHooks[this.nodeName.toLowerCase()];
	        if (!hooks || !("set" in hooks) || hooks.set(this, val, "value") === undefined) {
	          this.value = val;
	        }
	      });
	    }});
	  jQuery.extend({valHooks: {
	      option: {get: function(elem) {
	          var val = jQuery.find.attr(elem, "value");
	          return val != null ? val : jQuery.trim(jQuery.text(elem));
	        }},
	      select: {
	        get: function(elem) {
	          var value,
	              option,
	              options = elem.options,
	              index = elem.selectedIndex,
	              one = elem.type === "select-one" || index < 0,
	              values = one ? null : [],
	              max = one ? index + 1 : options.length,
	              i = index < 0 ? max : one ? index : 0;
	          for (; i < max; i++) {
	            option = options[i];
	            if ((option.selected || i === index) && (support.optDisabled ? !option.disabled : option.getAttribute("disabled") === null) && (!option.parentNode.disabled || !jQuery.nodeName(option.parentNode, "optgroup"))) {
	              value = jQuery(option).val();
	              if (one) {
	                return value;
	              }
	              values.push(value);
	            }
	          }
	          return values;
	        },
	        set: function(elem, value) {
	          var optionSet,
	              option,
	              options = elem.options,
	              values = jQuery.makeArray(value),
	              i = options.length;
	          while (i--) {
	            option = options[i];
	            if ((option.selected = jQuery.inArray(option.value, values) >= 0)) {
	              optionSet = true;
	            }
	          }
	          if (!optionSet) {
	            elem.selectedIndex = -1;
	          }
	          return values;
	        }
	      }
	    }});
	  jQuery.each(["radio", "checkbox"], function() {
	    jQuery.valHooks[this] = {set: function(elem, value) {
	        if (jQuery.isArray(value)) {
	          return (elem.checked = jQuery.inArray(jQuery(elem).val(), value) >= 0);
	        }
	      }};
	    if (!support.checkOn) {
	      jQuery.valHooks[this].get = function(elem) {
	        return elem.getAttribute("value") === null ? "on" : elem.value;
	      };
	    }
	  });
	  jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick " + "mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " + "change select submit keydown keypress keyup error contextmenu").split(" "), function(i, name) {
	    jQuery.fn[name] = function(data, fn) {
	      return arguments.length > 0 ? this.on(name, null, data, fn) : this.trigger(name);
	    };
	  });
	  jQuery.fn.extend({
	    hover: function(fnOver, fnOut) {
	      return this.mouseenter(fnOver).mouseleave(fnOut || fnOver);
	    },
	    bind: function(types, data, fn) {
	      return this.on(types, null, data, fn);
	    },
	    unbind: function(types, fn) {
	      return this.off(types, null, fn);
	    },
	    delegate: function(selector, types, data, fn) {
	      return this.on(types, selector, data, fn);
	    },
	    undelegate: function(selector, types, fn) {
	      return arguments.length === 1 ? this.off(selector, "**") : this.off(types, selector || "**", fn);
	    }
	  });
	  var nonce = jQuery.now();
	  var rquery = (/\?/);
	  jQuery.parseJSON = function(data) {
	    return JSON.parse(data + "");
	  };
	  jQuery.parseXML = function(data) {
	    var xml,
	        tmp;
	    if (!data || typeof data !== "string") {
	      return null;
	    }
	    try {
	      tmp = new DOMParser();
	      xml = tmp.parseFromString(data, "text/xml");
	    } catch (e) {
	      xml = undefined;
	    }
	    if (!xml || xml.getElementsByTagName("parsererror").length) {
	      jQuery.error("Invalid XML: " + data);
	    }
	    return xml;
	  };
	  var rhash = /#.*$/,
	      rts = /([?&])_=[^&]*/,
	      rheaders = /^(.*?):[ \t]*([^\r\n]*)$/mg,
	      rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
	      rnoContent = /^(?:GET|HEAD)$/,
	      rprotocol = /^\/\//,
	      rurl = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,
	      prefilters = {},
	      transports = {},
	      allTypes = "*/".concat("*"),
	      ajaxLocation = window.location.href,
	      ajaxLocParts = rurl.exec(ajaxLocation.toLowerCase()) || [];
	  function addToPrefiltersOrTransports(structure) {
	    return function(dataTypeExpression, func) {
	      if (typeof dataTypeExpression !== "string") {
	        func = dataTypeExpression;
	        dataTypeExpression = "*";
	      }
	      var dataType,
	          i = 0,
	          dataTypes = dataTypeExpression.toLowerCase().match(rnotwhite) || [];
	      if (jQuery.isFunction(func)) {
	        while ((dataType = dataTypes[i++])) {
	          if (dataType[0] === "+") {
	            dataType = dataType.slice(1) || "*";
	            (structure[dataType] = structure[dataType] || []).unshift(func);
	          } else {
	            (structure[dataType] = structure[dataType] || []).push(func);
	          }
	        }
	      }
	    };
	  }
	  function inspectPrefiltersOrTransports(structure, options, originalOptions, jqXHR) {
	    var inspected = {},
	        seekingTransport = (structure === transports);
	    function inspect(dataType) {
	      var selected;
	      inspected[dataType] = true;
	      jQuery.each(structure[dataType] || [], function(_, prefilterOrFactory) {
	        var dataTypeOrTransport = prefilterOrFactory(options, originalOptions, jqXHR);
	        if (typeof dataTypeOrTransport === "string" && !seekingTransport && !inspected[dataTypeOrTransport]) {
	          options.dataTypes.unshift(dataTypeOrTransport);
	          inspect(dataTypeOrTransport);
	          return false;
	        } else if (seekingTransport) {
	          return !(selected = dataTypeOrTransport);
	        }
	      });
	      return selected;
	    }
	    return inspect(options.dataTypes[0]) || !inspected["*"] && inspect("*");
	  }
	  function ajaxExtend(target, src) {
	    var key,
	        deep,
	        flatOptions = jQuery.ajaxSettings.flatOptions || {};
	    for (key in src) {
	      if (src[key] !== undefined) {
	        (flatOptions[key] ? target : (deep || (deep = {})))[key] = src[key];
	      }
	    }
	    if (deep) {
	      jQuery.extend(true, target, deep);
	    }
	    return target;
	  }
	  function ajaxHandleResponses(s, jqXHR, responses) {
	    var ct,
	        type,
	        finalDataType,
	        firstDataType,
	        contents = s.contents,
	        dataTypes = s.dataTypes;
	    while (dataTypes[0] === "*") {
	      dataTypes.shift();
	      if (ct === undefined) {
	        ct = s.mimeType || jqXHR.getResponseHeader("Content-Type");
	      }
	    }
	    if (ct) {
	      for (type in contents) {
	        if (contents[type] && contents[type].test(ct)) {
	          dataTypes.unshift(type);
	          break;
	        }
	      }
	    }
	    if (dataTypes[0] in responses) {
	      finalDataType = dataTypes[0];
	    } else {
	      for (type in responses) {
	        if (!dataTypes[0] || s.converters[type + " " + dataTypes[0]]) {
	          finalDataType = type;
	          break;
	        }
	        if (!firstDataType) {
	          firstDataType = type;
	        }
	      }
	      finalDataType = finalDataType || firstDataType;
	    }
	    if (finalDataType) {
	      if (finalDataType !== dataTypes[0]) {
	        dataTypes.unshift(finalDataType);
	      }
	      return responses[finalDataType];
	    }
	  }
	  function ajaxConvert(s, response, jqXHR, isSuccess) {
	    var conv2,
	        current,
	        conv,
	        tmp,
	        prev,
	        converters = {},
	        dataTypes = s.dataTypes.slice();
	    if (dataTypes[1]) {
	      for (conv in s.converters) {
	        converters[conv.toLowerCase()] = s.converters[conv];
	      }
	    }
	    current = dataTypes.shift();
	    while (current) {
	      if (s.responseFields[current]) {
	        jqXHR[s.responseFields[current]] = response;
	      }
	      if (!prev && isSuccess && s.dataFilter) {
	        response = s.dataFilter(response, s.dataType);
	      }
	      prev = current;
	      current = dataTypes.shift();
	      if (current) {
	        if (current === "*") {
	          current = prev;
	        } else if (prev !== "*" && prev !== current) {
	          conv = converters[prev + " " + current] || converters["* " + current];
	          if (!conv) {
	            for (conv2 in converters) {
	              tmp = conv2.split(" ");
	              if (tmp[1] === current) {
	                conv = converters[prev + " " + tmp[0]] || converters["* " + tmp[0]];
	                if (conv) {
	                  if (conv === true) {
	                    conv = converters[conv2];
	                  } else if (converters[conv2] !== true) {
	                    current = tmp[0];
	                    dataTypes.unshift(tmp[1]);
	                  }
	                  break;
	                }
	              }
	            }
	          }
	          if (conv !== true) {
	            if (conv && s["throws"]) {
	              response = conv(response);
	            } else {
	              try {
	                response = conv(response);
	              } catch (e) {
	                return {
	                  state: "parsererror",
	                  error: conv ? e : "No conversion from " + prev + " to " + current
	                };
	              }
	            }
	          }
	        }
	      }
	    }
	    return {
	      state: "success",
	      data: response
	    };
	  }
	  jQuery.extend({
	    active: 0,
	    lastModified: {},
	    etag: {},
	    ajaxSettings: {
	      url: ajaxLocation,
	      type: "GET",
	      isLocal: rlocalProtocol.test(ajaxLocParts[1]),
	      global: true,
	      processData: true,
	      async: true,
	      contentType: "application/x-www-form-urlencoded; charset=UTF-8",
	      accepts: {
	        "*": allTypes,
	        text: "text/plain",
	        html: "text/html",
	        xml: "application/xml, text/xml",
	        json: "application/json, text/javascript"
	      },
	      contents: {
	        xml: /xml/,
	        html: /html/,
	        json: /json/
	      },
	      responseFields: {
	        xml: "responseXML",
	        text: "responseText",
	        json: "responseJSON"
	      },
	      converters: {
	        "* text": String,
	        "text html": true,
	        "text json": jQuery.parseJSON,
	        "text xml": jQuery.parseXML
	      },
	      flatOptions: {
	        url: true,
	        context: true
	      }
	    },
	    ajaxSetup: function(target, settings) {
	      return settings ? ajaxExtend(ajaxExtend(target, jQuery.ajaxSettings), settings) : ajaxExtend(jQuery.ajaxSettings, target);
	    },
	    ajaxPrefilter: addToPrefiltersOrTransports(prefilters),
	    ajaxTransport: addToPrefiltersOrTransports(transports),
	    ajax: function(url, options) {
	      if (typeof url === "object") {
	        options = url;
	        url = undefined;
	      }
	      options = options || {};
	      var transport,
	          cacheURL,
	          responseHeadersString,
	          responseHeaders,
	          timeoutTimer,
	          parts,
	          fireGlobals,
	          i,
	          s = jQuery.ajaxSetup({}, options),
	          callbackContext = s.context || s,
	          globalEventContext = s.context && (callbackContext.nodeType || callbackContext.jquery) ? jQuery(callbackContext) : jQuery.event,
	          deferred = jQuery.Deferred(),
	          completeDeferred = jQuery.Callbacks("once memory"),
	          statusCode = s.statusCode || {},
	          requestHeaders = {},
	          requestHeadersNames = {},
	          state = 0,
	          strAbort = "canceled",
	          jqXHR = {
	            readyState: 0,
	            getResponseHeader: function(key) {
	              var match;
	              if (state === 2) {
	                if (!responseHeaders) {
	                  responseHeaders = {};
	                  while ((match = rheaders.exec(responseHeadersString))) {
	                    responseHeaders[match[1].toLowerCase()] = match[2];
	                  }
	                }
	                match = responseHeaders[key.toLowerCase()];
	              }
	              return match == null ? null : match;
	            },
	            getAllResponseHeaders: function() {
	              return state === 2 ? responseHeadersString : null;
	            },
	            setRequestHeader: function(name, value) {
	              var lname = name.toLowerCase();
	              if (!state) {
	                name = requestHeadersNames[lname] = requestHeadersNames[lname] || name;
	                requestHeaders[name] = value;
	              }
	              return this;
	            },
	            overrideMimeType: function(type) {
	              if (!state) {
	                s.mimeType = type;
	              }
	              return this;
	            },
	            statusCode: function(map) {
	              var code;
	              if (map) {
	                if (state < 2) {
	                  for (code in map) {
	                    statusCode[code] = [statusCode[code], map[code]];
	                  }
	                } else {
	                  jqXHR.always(map[jqXHR.status]);
	                }
	              }
	              return this;
	            },
	            abort: function(statusText) {
	              var finalText = statusText || strAbort;
	              if (transport) {
	                transport.abort(finalText);
	              }
	              done(0, finalText);
	              return this;
	            }
	          };
	      deferred.promise(jqXHR).complete = completeDeferred.add;
	      jqXHR.success = jqXHR.done;
	      jqXHR.error = jqXHR.fail;
	      s.url = ((url || s.url || ajaxLocation) + "").replace(rhash, "").replace(rprotocol, ajaxLocParts[1] + "//");
	      s.type = options.method || options.type || s.method || s.type;
	      s.dataTypes = jQuery.trim(s.dataType || "*").toLowerCase().match(rnotwhite) || [""];
	      if (s.crossDomain == null) {
	        parts = rurl.exec(s.url.toLowerCase());
	        s.crossDomain = !!(parts && (parts[1] !== ajaxLocParts[1] || parts[2] !== ajaxLocParts[2] || (parts[3] || (parts[1] === "http:" ? "80" : "443")) !== (ajaxLocParts[3] || (ajaxLocParts[1] === "http:" ? "80" : "443"))));
	      }
	      if (s.data && s.processData && typeof s.data !== "string") {
	        s.data = jQuery.param(s.data, s.traditional);
	      }
	      inspectPrefiltersOrTransports(prefilters, s, options, jqXHR);
	      if (state === 2) {
	        return jqXHR;
	      }
	      fireGlobals = jQuery.event && s.global;
	      if (fireGlobals && jQuery.active++ === 0) {
	        jQuery.event.trigger("ajaxStart");
	      }
	      s.type = s.type.toUpperCase();
	      s.hasContent = !rnoContent.test(s.type);
	      cacheURL = s.url;
	      if (!s.hasContent) {
	        if (s.data) {
	          cacheURL = (s.url += (rquery.test(cacheURL) ? "&" : "?") + s.data);
	          delete s.data;
	        }
	        if (s.cache === false) {
	          s.url = rts.test(cacheURL) ? cacheURL.replace(rts, "$1_=" + nonce++) : cacheURL + (rquery.test(cacheURL) ? "&" : "?") + "_=" + nonce++;
	        }
	      }
	      if (s.ifModified) {
	        if (jQuery.lastModified[cacheURL]) {
	          jqXHR.setRequestHeader("If-Modified-Since", jQuery.lastModified[cacheURL]);
	        }
	        if (jQuery.etag[cacheURL]) {
	          jqXHR.setRequestHeader("If-None-Match", jQuery.etag[cacheURL]);
	        }
	      }
	      if (s.data && s.hasContent && s.contentType !== false || options.contentType) {
	        jqXHR.setRequestHeader("Content-Type", s.contentType);
	      }
	      jqXHR.setRequestHeader("Accept", s.dataTypes[0] && s.accepts[s.dataTypes[0]] ? s.accepts[s.dataTypes[0]] + (s.dataTypes[0] !== "*" ? ", " + allTypes + "; q=0.01" : "") : s.accepts["*"]);
	      for (i in s.headers) {
	        jqXHR.setRequestHeader(i, s.headers[i]);
	      }
	      if (s.beforeSend && (s.beforeSend.call(callbackContext, jqXHR, s) === false || state === 2)) {
	        return jqXHR.abort();
	      }
	      strAbort = "abort";
	      for (i in {
	        success: 1,
	        error: 1,
	        complete: 1
	      }) {
	        jqXHR[i](s[i]);
	      }
	      transport = inspectPrefiltersOrTransports(transports, s, options, jqXHR);
	      if (!transport) {
	        done(-1, "No Transport");
	      } else {
	        jqXHR.readyState = 1;
	        if (fireGlobals) {
	          globalEventContext.trigger("ajaxSend", [jqXHR, s]);
	        }
	        if (s.async && s.timeout > 0) {
	          timeoutTimer = setTimeout(function() {
	            jqXHR.abort("timeout");
	          }, s.timeout);
	        }
	        try {
	          state = 1;
	          transport.send(requestHeaders, done);
	        } catch (e) {
	          if (state < 2) {
	            done(-1, e);
	          } else {
	            throw e;
	          }
	        }
	      }
	      function done(status, nativeStatusText, responses, headers) {
	        var isSuccess,
	            success,
	            error,
	            response,
	            modified,
	            statusText = nativeStatusText;
	        if (state === 2) {
	          return;
	        }
	        state = 2;
	        if (timeoutTimer) {
	          clearTimeout(timeoutTimer);
	        }
	        transport = undefined;
	        responseHeadersString = headers || "";
	        jqXHR.readyState = status > 0 ? 4 : 0;
	        isSuccess = status >= 200 && status < 300 || status === 304;
	        if (responses) {
	          response = ajaxHandleResponses(s, jqXHR, responses);
	        }
	        response = ajaxConvert(s, response, jqXHR, isSuccess);
	        if (isSuccess) {
	          if (s.ifModified) {
	            modified = jqXHR.getResponseHeader("Last-Modified");
	            if (modified) {
	              jQuery.lastModified[cacheURL] = modified;
	            }
	            modified = jqXHR.getResponseHeader("etag");
	            if (modified) {
	              jQuery.etag[cacheURL] = modified;
	            }
	          }
	          if (status === 204 || s.type === "HEAD") {
	            statusText = "nocontent";
	          } else if (status === 304) {
	            statusText = "notmodified";
	          } else {
	            statusText = response.state;
	            success = response.data;
	            error = response.error;
	            isSuccess = !error;
	          }
	        } else {
	          error = statusText;
	          if (status || !statusText) {
	            statusText = "error";
	            if (status < 0) {
	              status = 0;
	            }
	          }
	        }
	        jqXHR.status = status;
	        jqXHR.statusText = (nativeStatusText || statusText) + "";
	        if (isSuccess) {
	          deferred.resolveWith(callbackContext, [success, statusText, jqXHR]);
	        } else {
	          deferred.rejectWith(callbackContext, [jqXHR, statusText, error]);
	        }
	        jqXHR.statusCode(statusCode);
	        statusCode = undefined;
	        if (fireGlobals) {
	          globalEventContext.trigger(isSuccess ? "ajaxSuccess" : "ajaxError", [jqXHR, s, isSuccess ? success : error]);
	        }
	        completeDeferred.fireWith(callbackContext, [jqXHR, statusText]);
	        if (fireGlobals) {
	          globalEventContext.trigger("ajaxComplete", [jqXHR, s]);
	          if (!(--jQuery.active)) {
	            jQuery.event.trigger("ajaxStop");
	          }
	        }
	      }
	      return jqXHR;
	    },
	    getJSON: function(url, data, callback) {
	      return jQuery.get(url, data, callback, "json");
	    },
	    getScript: function(url, callback) {
	      return jQuery.get(url, undefined, callback, "script");
	    }
	  });
	  jQuery.each(["get", "post"], function(i, method) {
	    jQuery[method] = function(url, data, callback, type) {
	      if (jQuery.isFunction(data)) {
	        type = type || callback;
	        callback = data;
	        data = undefined;
	      }
	      return jQuery.ajax({
	        url: url,
	        type: method,
	        dataType: type,
	        data: data,
	        success: callback
	      });
	    };
	  });
	  jQuery._evalUrl = function(url) {
	    return jQuery.ajax({
	      url: url,
	      type: "GET",
	      dataType: "script",
	      async: false,
	      global: false,
	      "throws": true
	    });
	  };
	  jQuery.fn.extend({
	    wrapAll: function(html) {
	      var wrap;
	      if (jQuery.isFunction(html)) {
	        return this.each(function(i) {
	          jQuery(this).wrapAll(html.call(this, i));
	        });
	      }
	      if (this[0]) {
	        wrap = jQuery(html, this[0].ownerDocument).eq(0).clone(true);
	        if (this[0].parentNode) {
	          wrap.insertBefore(this[0]);
	        }
	        wrap.map(function() {
	          var elem = this;
	          while (elem.firstElementChild) {
	            elem = elem.firstElementChild;
	          }
	          return elem;
	        }).append(this);
	      }
	      return this;
	    },
	    wrapInner: function(html) {
	      if (jQuery.isFunction(html)) {
	        return this.each(function(i) {
	          jQuery(this).wrapInner(html.call(this, i));
	        });
	      }
	      return this.each(function() {
	        var self = jQuery(this),
	            contents = self.contents();
	        if (contents.length) {
	          contents.wrapAll(html);
	        } else {
	          self.append(html);
	        }
	      });
	    },
	    wrap: function(html) {
	      var isFunction = jQuery.isFunction(html);
	      return this.each(function(i) {
	        jQuery(this).wrapAll(isFunction ? html.call(this, i) : html);
	      });
	    },
	    unwrap: function() {
	      return this.parent().each(function() {
	        if (!jQuery.nodeName(this, "body")) {
	          jQuery(this).replaceWith(this.childNodes);
	        }
	      }).end();
	    }
	  });
	  jQuery.expr.filters.hidden = function(elem) {
	    return elem.offsetWidth <= 0 && elem.offsetHeight <= 0;
	  };
	  jQuery.expr.filters.visible = function(elem) {
	    return !jQuery.expr.filters.hidden(elem);
	  };
	  var r20 = /%20/g,
	      rbracket = /\[\]$/,
	      rCRLF = /\r?\n/g,
	      rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,
	      rsubmittable = /^(?:input|select|textarea|keygen)/i;
	  function buildParams(prefix, obj, traditional, add) {
	    var name;
	    if (jQuery.isArray(obj)) {
	      jQuery.each(obj, function(i, v) {
	        if (traditional || rbracket.test(prefix)) {
	          add(prefix, v);
	        } else {
	          buildParams(prefix + "[" + (typeof v === "object" ? i : "") + "]", v, traditional, add);
	        }
	      });
	    } else if (!traditional && jQuery.type(obj) === "object") {
	      for (name in obj) {
	        buildParams(prefix + "[" + name + "]", obj[name], traditional, add);
	      }
	    } else {
	      add(prefix, obj);
	    }
	  }
	  jQuery.param = function(a, traditional) {
	    var prefix,
	        s = [],
	        add = function(key, value) {
	          value = jQuery.isFunction(value) ? value() : (value == null ? "" : value);
	          s[s.length] = encodeURIComponent(key) + "=" + encodeURIComponent(value);
	        };
	    if (traditional === undefined) {
	      traditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;
	    }
	    if (jQuery.isArray(a) || (a.jquery && !jQuery.isPlainObject(a))) {
	      jQuery.each(a, function() {
	        add(this.name, this.value);
	      });
	    } else {
	      for (prefix in a) {
	        buildParams(prefix, a[prefix], traditional, add);
	      }
	    }
	    return s.join("&").replace(r20, "+");
	  };
	  jQuery.fn.extend({
	    serialize: function() {
	      return jQuery.param(this.serializeArray());
	    },
	    serializeArray: function() {
	      return this.map(function() {
	        var elements = jQuery.prop(this, "elements");
	        return elements ? jQuery.makeArray(elements) : this;
	      }).filter(function() {
	        var type = this.type;
	        return this.name && !jQuery(this).is(":disabled") && rsubmittable.test(this.nodeName) && !rsubmitterTypes.test(type) && (this.checked || !rcheckableType.test(type));
	      }).map(function(i, elem) {
	        var val = jQuery(this).val();
	        return val == null ? null : jQuery.isArray(val) ? jQuery.map(val, function(val) {
	          return {
	            name: elem.name,
	            value: val.replace(rCRLF, "\r\n")
	          };
	        }) : {
	          name: elem.name,
	          value: val.replace(rCRLF, "\r\n")
	        };
	      }).get();
	    }
	  });
	  jQuery.ajaxSettings.xhr = function() {
	    try {
	      return new XMLHttpRequest();
	    } catch (e) {}
	  };
	  var xhrId = 0,
	      xhrCallbacks = {},
	      xhrSuccessStatus = {
	        0: 200,
	        1223: 204
	      },
	      xhrSupported = jQuery.ajaxSettings.xhr();
	  if (window.attachEvent) {
	    window.attachEvent("onunload", function() {
	      for (var key in xhrCallbacks) {
	        xhrCallbacks[key]();
	      }
	    });
	  }
	  support.cors = !!xhrSupported && ("withCredentials" in xhrSupported);
	  support.ajax = xhrSupported = !!xhrSupported;
	  jQuery.ajaxTransport(function(options) {
	    var callback;
	    if (support.cors || xhrSupported && !options.crossDomain) {
	      return {
	        send: function(headers, complete) {
	          var i,
	              xhr = options.xhr(),
	              id = ++xhrId;
	          xhr.open(options.type, options.url, options.async, options.username, options.password);
	          if (options.xhrFields) {
	            for (i in options.xhrFields) {
	              xhr[i] = options.xhrFields[i];
	            }
	          }
	          if (options.mimeType && xhr.overrideMimeType) {
	            xhr.overrideMimeType(options.mimeType);
	          }
	          if (!options.crossDomain && !headers["X-Requested-With"]) {
	            headers["X-Requested-With"] = "XMLHttpRequest";
	          }
	          for (i in headers) {
	            xhr.setRequestHeader(i, headers[i]);
	          }
	          callback = function(type) {
	            return function() {
	              if (callback) {
	                delete xhrCallbacks[id];
	                callback = xhr.onload = xhr.onerror = null;
	                if (type === "abort") {
	                  xhr.abort();
	                } else if (type === "error") {
	                  complete(xhr.status, xhr.statusText);
	                } else {
	                  complete(xhrSuccessStatus[xhr.status] || xhr.status, xhr.statusText, typeof xhr.responseText === "string" ? {text: xhr.responseText} : undefined, xhr.getAllResponseHeaders());
	                }
	              }
	            };
	          };
	          xhr.onload = callback();
	          xhr.onerror = callback("error");
	          callback = xhrCallbacks[id] = callback("abort");
	          try {
	            xhr.send(options.hasContent && options.data || null);
	          } catch (e) {
	            if (callback) {
	              throw e;
	            }
	          }
	        },
	        abort: function() {
	          if (callback) {
	            callback();
	          }
	        }
	      };
	    }
	  });
	  jQuery.ajaxSetup({
	    accepts: {script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
	    contents: {script: /(?:java|ecma)script/},
	    converters: {"text script": function(text) {
	        jQuery.globalEval(text);
	        return text;
	      }}
	  });
	  jQuery.ajaxPrefilter("script", function(s) {
	    if (s.cache === undefined) {
	      s.cache = false;
	    }
	    if (s.crossDomain) {
	      s.type = "GET";
	    }
	  });
	  jQuery.ajaxTransport("script", function(s) {
	    if (s.crossDomain) {
	      var script,
	          callback;
	      return {
	        send: function(_, complete) {
	          script = jQuery("<script>").prop({
	            async: true,
	            charset: s.scriptCharset,
	            src: s.url
	          }).on("load error", callback = function(evt) {
	            script.remove();
	            callback = null;
	            if (evt) {
	              complete(evt.type === "error" ? 404 : 200, evt.type);
	            }
	          });
	          document.head.appendChild(script[0]);
	        },
	        abort: function() {
	          if (callback) {
	            callback();
	          }
	        }
	      };
	    }
	  });
	  var oldCallbacks = [],
	      rjsonp = /(=)\?(?=&|$)|\?\?/;
	  jQuery.ajaxSetup({
	    jsonp: "callback",
	    jsonpCallback: function() {
	      var callback = oldCallbacks.pop() || (jQuery.expando + "_" + (nonce++));
	      this[callback] = true;
	      return callback;
	    }
	  });
	  jQuery.ajaxPrefilter("json jsonp", function(s, originalSettings, jqXHR) {
	    var callbackName,
	        overwritten,
	        responseContainer,
	        jsonProp = s.jsonp !== false && (rjsonp.test(s.url) ? "url" : typeof s.data === "string" && !(s.contentType || "").indexOf("application/x-www-form-urlencoded") && rjsonp.test(s.data) && "data");
	    if (jsonProp || s.dataTypes[0] === "jsonp") {
	      callbackName = s.jsonpCallback = jQuery.isFunction(s.jsonpCallback) ? s.jsonpCallback() : s.jsonpCallback;
	      if (jsonProp) {
	        s[jsonProp] = s[jsonProp].replace(rjsonp, "$1" + callbackName);
	      } else if (s.jsonp !== false) {
	        s.url += (rquery.test(s.url) ? "&" : "?") + s.jsonp + "=" + callbackName;
	      }
	      s.converters["script json"] = function() {
	        if (!responseContainer) {
	          jQuery.error(callbackName + " was not called");
	        }
	        return responseContainer[0];
	      };
	      s.dataTypes[0] = "json";
	      overwritten = window[callbackName];
	      window[callbackName] = function() {
	        responseContainer = arguments;
	      };
	      jqXHR.always(function() {
	        window[callbackName] = overwritten;
	        if (s[callbackName]) {
	          s.jsonpCallback = originalSettings.jsonpCallback;
	          oldCallbacks.push(callbackName);
	        }
	        if (responseContainer && jQuery.isFunction(overwritten)) {
	          overwritten(responseContainer[0]);
	        }
	        responseContainer = overwritten = undefined;
	      });
	      return "script";
	    }
	  });
	  jQuery.parseHTML = function(data, context, keepScripts) {
	    if (!data || typeof data !== "string") {
	      return null;
	    }
	    if (typeof context === "boolean") {
	      keepScripts = context;
	      context = false;
	    }
	    context = context || document;
	    var parsed = rsingleTag.exec(data),
	        scripts = !keepScripts && [];
	    if (parsed) {
	      return [context.createElement(parsed[1])];
	    }
	    parsed = jQuery.buildFragment([data], context, scripts);
	    if (scripts && scripts.length) {
	      jQuery(scripts).remove();
	    }
	    return jQuery.merge([], parsed.childNodes);
	  };
	  var _load = jQuery.fn.load;
	  jQuery.fn.load = function(url, params, callback) {
	    if (typeof url !== "string" && _load) {
	      return _load.apply(this, arguments);
	    }
	    var selector,
	        type,
	        response,
	        self = this,
	        off = url.indexOf(" ");
	    if (off >= 0) {
	      selector = jQuery.trim(url.slice(off));
	      url = url.slice(0, off);
	    }
	    if (jQuery.isFunction(params)) {
	      callback = params;
	      params = undefined;
	    } else if (params && typeof params === "object") {
	      type = "POST";
	    }
	    if (self.length > 0) {
	      jQuery.ajax({
	        url: url,
	        type: type,
	        dataType: "html",
	        data: params
	      }).done(function(responseText) {
	        response = arguments;
	        self.html(selector ? jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector) : responseText);
	      }).complete(callback && function(jqXHR, status) {
	        self.each(callback, response || [jqXHR.responseText, status, jqXHR]);
	      });
	    }
	    return this;
	  };
	  jQuery.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(i, type) {
	    jQuery.fn[type] = function(fn) {
	      return this.on(type, fn);
	    };
	  });
	  jQuery.expr.filters.animated = function(elem) {
	    return jQuery.grep(jQuery.timers, function(fn) {
	      return elem === fn.elem;
	    }).length;
	  };
	  var docElem = window.document.documentElement;
	  function getWindow(elem) {
	    return jQuery.isWindow(elem) ? elem : elem.nodeType === 9 && elem.defaultView;
	  }
	  jQuery.offset = {setOffset: function(elem, options, i) {
	      var curPosition,
	          curLeft,
	          curCSSTop,
	          curTop,
	          curOffset,
	          curCSSLeft,
	          calculatePosition,
	          position = jQuery.css(elem, "position"),
	          curElem = jQuery(elem),
	          props = {};
	      if (position === "static") {
	        elem.style.position = "relative";
	      }
	      curOffset = curElem.offset();
	      curCSSTop = jQuery.css(elem, "top");
	      curCSSLeft = jQuery.css(elem, "left");
	      calculatePosition = (position === "absolute" || position === "fixed") && (curCSSTop + curCSSLeft).indexOf("auto") > -1;
	      if (calculatePosition) {
	        curPosition = curElem.position();
	        curTop = curPosition.top;
	        curLeft = curPosition.left;
	      } else {
	        curTop = parseFloat(curCSSTop) || 0;
	        curLeft = parseFloat(curCSSLeft) || 0;
	      }
	      if (jQuery.isFunction(options)) {
	        options = options.call(elem, i, curOffset);
	      }
	      if (options.top != null) {
	        props.top = (options.top - curOffset.top) + curTop;
	      }
	      if (options.left != null) {
	        props.left = (options.left - curOffset.left) + curLeft;
	      }
	      if ("using" in options) {
	        options.using.call(elem, props);
	      } else {
	        curElem.css(props);
	      }
	    }};
	  jQuery.fn.extend({
	    offset: function(options) {
	      if (arguments.length) {
	        return options === undefined ? this : this.each(function(i) {
	          jQuery.offset.setOffset(this, options, i);
	        });
	      }
	      var docElem,
	          win,
	          elem = this[0],
	          box = {
	            top: 0,
	            left: 0
	          },
	          doc = elem && elem.ownerDocument;
	      if (!doc) {
	        return;
	      }
	      docElem = doc.documentElement;
	      if (!jQuery.contains(docElem, elem)) {
	        return box;
	      }
	      if (typeof elem.getBoundingClientRect !== strundefined) {
	        box = elem.getBoundingClientRect();
	      }
	      win = getWindow(doc);
	      return {
	        top: box.top + win.pageYOffset - docElem.clientTop,
	        left: box.left + win.pageXOffset - docElem.clientLeft
	      };
	    },
	    position: function() {
	      if (!this[0]) {
	        return;
	      }
	      var offsetParent,
	          offset,
	          elem = this[0],
	          parentOffset = {
	            top: 0,
	            left: 0
	          };
	      if (jQuery.css(elem, "position") === "fixed") {
	        offset = elem.getBoundingClientRect();
	      } else {
	        offsetParent = this.offsetParent();
	        offset = this.offset();
	        if (!jQuery.nodeName(offsetParent[0], "html")) {
	          parentOffset = offsetParent.offset();
	        }
	        parentOffset.top += jQuery.css(offsetParent[0], "borderTopWidth", true);
	        parentOffset.left += jQuery.css(offsetParent[0], "borderLeftWidth", true);
	      }
	      return {
	        top: offset.top - parentOffset.top - jQuery.css(elem, "marginTop", true),
	        left: offset.left - parentOffset.left - jQuery.css(elem, "marginLeft", true)
	      };
	    },
	    offsetParent: function() {
	      return this.map(function() {
	        var offsetParent = this.offsetParent || docElem;
	        while (offsetParent && (!jQuery.nodeName(offsetParent, "html") && jQuery.css(offsetParent, "position") === "static")) {
	          offsetParent = offsetParent.offsetParent;
	        }
	        return offsetParent || docElem;
	      });
	    }
	  });
	  jQuery.each({
	    scrollLeft: "pageXOffset",
	    scrollTop: "pageYOffset"
	  }, function(method, prop) {
	    var top = "pageYOffset" === prop;
	    jQuery.fn[method] = function(val) {
	      return access(this, function(elem, method, val) {
	        var win = getWindow(elem);
	        if (val === undefined) {
	          return win ? win[prop] : elem[method];
	        }
	        if (win) {
	          win.scrollTo(!top ? val : window.pageXOffset, top ? val : window.pageYOffset);
	        } else {
	          elem[method] = val;
	        }
	      }, method, val, arguments.length, null);
	    };
	  });
	  jQuery.each(["top", "left"], function(i, prop) {
	    jQuery.cssHooks[prop] = addGetHookIf(support.pixelPosition, function(elem, computed) {
	      if (computed) {
	        computed = curCSS(elem, prop);
	        return rnumnonpx.test(computed) ? jQuery(elem).position()[prop] + "px" : computed;
	      }
	    });
	  });
	  jQuery.each({
	    Height: "height",
	    Width: "width"
	  }, function(name, type) {
	    jQuery.each({
	      padding: "inner" + name,
	      content: type,
	      "": "outer" + name
	    }, function(defaultExtra, funcName) {
	      jQuery.fn[funcName] = function(margin, value) {
	        var chainable = arguments.length && (defaultExtra || typeof margin !== "boolean"),
	            extra = defaultExtra || (margin === true || value === true ? "margin" : "border");
	        return access(this, function(elem, type, value) {
	          var doc;
	          if (jQuery.isWindow(elem)) {
	            return elem.document.documentElement["client" + name];
	          }
	          if (elem.nodeType === 9) {
	            doc = elem.documentElement;
	            return Math.max(elem.body["scroll" + name], doc["scroll" + name], elem.body["offset" + name], doc["offset" + name], doc["client" + name]);
	          }
	          return value === undefined ? jQuery.css(elem, type, extra) : jQuery.style(elem, type, value, extra);
	        }, type, chainable ? margin : undefined, chainable, null);
	      };
	    });
	  });
	  jQuery.fn.size = function() {
	    return this.length;
	  };
	  jQuery.fn.andSelf = jQuery.fn.addBack;
	  if (true) {
	    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function() {
	      return jQuery;
	    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	  }
	  var _jQuery = window.jQuery,
	      _$ = window.$;
	  jQuery.noConflict = function(deep) {
	    if (window.$ === jQuery) {
	      window.$ = _$;
	    }
	    if (deep && window.jQuery === jQuery) {
	      window.jQuery = _jQuery;
	    }
	    return jQuery;
	  };
	  if (typeof noGlobal === strundefined) {
	    window.jQuery = window.$ = jQuery;
	  }
	  return jQuery;
	}));


/***/ },
/* 16 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function(process, global) {!function(e) {
	  if (true)
	    module.exports = e();
	  else if ("function" == typeof define && define.amd)
	    define([], e);
	  else {
	    var f;
	    "undefined" != typeof window ? f = window : "undefined" != typeof global ? f = global : "undefined" != typeof self && (f = self), f.Promise = e();
	  }
	}(function() {
	  var define,
	      module,
	      exports;
	  return (function e(t, n, r) {
	    function s(o, u) {
	      if (!n[o]) {
	        if (!t[o]) {
	          var a = typeof _dereq_ == "function" && _dereq_;
	          if (!u && a)
	            return a(o, !0);
	          if (i)
	            return i(o, !0);
	          var f = new Error("Cannot find module '" + o + "'");
	          throw f.code = "MODULE_NOT_FOUND", f;
	        }
	        var l = n[o] = {exports: {}};
	        t[o][0].call(l.exports, function(e) {
	          var n = t[o][1][e];
	          return s(n ? n : e);
	        }, l, l.exports, e, t, n, r);
	      }
	      return n[o].exports;
	    }
	    var i = typeof _dereq_ == "function" && _dereq_;
	    for (var o = 0; o < r.length; o++)
	      s(r[o]);
	    return s;
	  })({
	    1: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise) {
	        var SomePromiseArray = Promise._SomePromiseArray;
	        function any(promises) {
	          var ret = new SomePromiseArray(promises);
	          var promise = ret.promise();
	          ret.setHowMany(1);
	          ret.setUnwrap();
	          ret.init();
	          return promise;
	        }
	        Promise.any = function(promises) {
	          return any(promises);
	        };
	        Promise.prototype.any = function() {
	          return any(this);
	        };
	      };
	    }, {}],
	    2: [function(_dereq_, module, exports) {
	      "use strict";
	      var firstLineError;
	      try {
	        throw new Error();
	      } catch (e) {
	        firstLineError = e;
	      }
	      var schedule = _dereq_("./schedule.js");
	      var Queue = _dereq_("./queue.js");
	      var _process = typeof process !== "undefined" ? process : undefined;
	      function Async() {
	        this._isTickUsed = false;
	        this._lateQueue = new Queue(16);
	        this._normalQueue = new Queue(16);
	        var self = this;
	        this.drainQueues = function() {
	          self._drainQueues();
	        };
	        this._schedule = schedule.isStatic ? schedule(this.drainQueues) : schedule;
	      }
	      Async.prototype.haveItemsQueued = function() {
	        return this._normalQueue.length() > 0;
	      };
	      Async.prototype._withDomain = function(fn) {
	        if (_process !== undefined && _process.domain != null && !fn.domain) {
	          fn = _process.domain.bind(fn);
	        }
	        return fn;
	      };
	      Async.prototype.throwLater = function(fn, arg) {
	        if (arguments.length === 1) {
	          arg = fn;
	          fn = function() {
	            throw arg;
	          };
	        }
	        fn = this._withDomain(fn);
	        if (typeof setTimeout !== "undefined") {
	          setTimeout(function() {
	            fn(arg);
	          }, 0);
	        } else
	          try {
	            this._schedule(function() {
	              fn(arg);
	            });
	          } catch (e) {
	            throw new Error("No async scheduler available\u000a\u000a    See http://goo.gl/m3OTXk\u000a");
	          }
	      };
	      Async.prototype.invokeLater = function(fn, receiver, arg) {
	        fn = this._withDomain(fn);
	        this._lateQueue.push(fn, receiver, arg);
	        this._queueTick();
	      };
	      Async.prototype.invokeFirst = function(fn, receiver, arg) {
	        fn = this._withDomain(fn);
	        this._normalQueue.unshift(fn, receiver, arg);
	        this._queueTick();
	      };
	      Async.prototype.invoke = function(fn, receiver, arg) {
	        fn = this._withDomain(fn);
	        this._normalQueue.push(fn, receiver, arg);
	        this._queueTick();
	      };
	      Async.prototype.settlePromises = function(promise) {
	        this._normalQueue._pushOne(promise);
	        this._queueTick();
	      };
	      Async.prototype._drainQueue = function(queue) {
	        while (queue.length() > 0) {
	          var fn = queue.shift();
	          if (typeof fn !== "function") {
	            fn._settlePromises();
	            continue;
	          }
	          var receiver = queue.shift();
	          var arg = queue.shift();
	          fn.call(receiver, arg);
	        }
	      };
	      Async.prototype._drainQueues = function() {
	        this._drainQueue(this._normalQueue);
	        this._reset();
	        this._drainQueue(this._lateQueue);
	      };
	      Async.prototype._queueTick = function() {
	        if (!this._isTickUsed) {
	          this._isTickUsed = true;
	          this._schedule(this.drainQueues);
	        }
	      };
	      Async.prototype._reset = function() {
	        this._isTickUsed = false;
	      };
	      module.exports = new Async();
	      module.exports.firstLineError = firstLineError;
	    }, {
	      "./queue.js": 28,
	      "./schedule.js": 31
	    }],
	    3: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL, tryConvertToPromise) {
	        var rejectThis = function(_, e) {
	          this._reject(e);
	        };
	        var targetRejected = function(e, context) {
	          context.promiseRejectionQueued = true;
	          context.bindingPromise._then(rejectThis, rejectThis, null, this, e);
	        };
	        var bindingResolved = function(thisArg, context) {
	          this._setBoundTo(thisArg);
	          if (this._isPending()) {
	            this._resolveCallback(context.target);
	          }
	        };
	        var bindingRejected = function(e, context) {
	          if (!context.promiseRejectionQueued)
	            this._reject(e);
	        };
	        Promise.prototype.bind = function(thisArg) {
	          var maybePromise = tryConvertToPromise(thisArg);
	          var ret = new Promise(INTERNAL);
	          ret._propagateFrom(this, 1);
	          var target = this._target();
	          if (maybePromise instanceof Promise) {
	            var context = {
	              promiseRejectionQueued: false,
	              promise: ret,
	              target: target,
	              bindingPromise: maybePromise
	            };
	            target._then(INTERNAL, targetRejected, ret._progress, ret, context);
	            maybePromise._then(bindingResolved, bindingRejected, ret._progress, ret, context);
	          } else {
	            ret._setBoundTo(thisArg);
	            ret._resolveCallback(target);
	          }
	          return ret;
	        };
	        Promise.prototype._setBoundTo = function(obj) {
	          if (obj !== undefined) {
	            this._bitField = this._bitField | 131072;
	            this._boundTo = obj;
	          } else {
	            this._bitField = this._bitField & (~131072);
	          }
	        };
	        Promise.prototype._isBound = function() {
	          return (this._bitField & 131072) === 131072;
	        };
	        Promise.bind = function(thisArg, value) {
	          var maybePromise = tryConvertToPromise(thisArg);
	          var ret = new Promise(INTERNAL);
	          if (maybePromise instanceof Promise) {
	            maybePromise._then(function(thisArg) {
	              ret._setBoundTo(thisArg);
	              ret._resolveCallback(value);
	            }, ret._reject, ret._progress, ret, null);
	          } else {
	            ret._setBoundTo(thisArg);
	            ret._resolveCallback(value);
	          }
	          return ret;
	        };
	      };
	    }, {}],
	    4: [function(_dereq_, module, exports) {
	      "use strict";
	      var old;
	      if (typeof Promise !== "undefined")
	        old = Promise;
	      function noConflict() {
	        try {
	          if (Promise === bluebird)
	            Promise = old;
	        } catch (e) {}
	        return bluebird;
	      }
	      var bluebird = _dereq_("./promise.js")();
	      bluebird.noConflict = noConflict;
	      module.exports = bluebird;
	    }, {"./promise.js": 23}],
	    5: [function(_dereq_, module, exports) {
	      "use strict";
	      var cr = Object.create;
	      if (cr) {
	        var callerCache = cr(null);
	        var getterCache = cr(null);
	        callerCache[" size"] = getterCache[" size"] = 0;
	      }
	      module.exports = function(Promise) {
	        var util = _dereq_("./util.js");
	        var canEvaluate = util.canEvaluate;
	        var isIdentifier = util.isIdentifier;
	        var getMethodCaller;
	        var getGetter;
	        if (false) {
	          var makeMethodCaller = function(methodName) {
	            return new Function("ensureMethod", "                                    \n\
	        return function(obj) {                                               \n\
	            'use strict'                                                     \n\
	            var len = this.length;                                           \n\
	            ensureMethod(obj, 'methodName');                                 \n\
	            switch(len) {                                                    \n\
	                case 1: return obj.methodName(this[0]);                      \n\
	                case 2: return obj.methodName(this[0], this[1]);             \n\
	                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\
	                case 0: return obj.methodName();                             \n\
	                default:                                                     \n\
	                    return obj.methodName.apply(obj, this);                  \n\
	            }                                                                \n\
	        };                                                                   \n\
	        ".replace(/methodName/g, methodName))(ensureMethod);
	          };
	          var makeGetter = function(propertyName) {
	            return new Function("obj", "                                             \n\
	        'use strict';                                                        \n\
	        return obj.propertyName;                                             \n\
	        ".replace("propertyName", propertyName));
	          };
	          var getCompiled = function(name, compiler, cache) {
	            var ret = cache[name];
	            if (typeof ret !== "function") {
	              if (!isIdentifier(name)) {
	                return null;
	              }
	              ret = compiler(name);
	              cache[name] = ret;
	              cache[" size"]++;
	              if (cache[" size"] > 512) {
	                var keys = Object.keys(cache);
	                for (var i = 0; i < 256; ++i)
	                  delete cache[keys[i]];
	                cache[" size"] = keys.length - 256;
	              }
	            }
	            return ret;
	          };
	          getMethodCaller = function(name) {
	            return getCompiled(name, makeMethodCaller, callerCache);
	          };
	          getGetter = function(name) {
	            return getCompiled(name, makeGetter, getterCache);
	          };
	        }
	        function ensureMethod(obj, methodName) {
	          var fn;
	          if (obj != null)
	            fn = obj[methodName];
	          if (typeof fn !== "function") {
	            var message = "Object " + util.classString(obj) + " has no method '" + util.toString(methodName) + "'";
	            throw new Promise.TypeError(message);
	          }
	          return fn;
	        }
	        function caller(obj) {
	          var methodName = this.pop();
	          var fn = ensureMethod(obj, methodName);
	          return fn.apply(obj, this);
	        }
	        Promise.prototype.call = function(methodName) {
	          var $_len = arguments.length;
	          var args = new Array($_len - 1);
	          for (var $_i = 1; $_i < $_len; ++$_i) {
	            args[$_i - 1] = arguments[$_i];
	          }
	          if (false) {
	            if (canEvaluate) {
	              var maybeCaller = getMethodCaller(methodName);
	              if (maybeCaller !== null) {
	                return this._then(maybeCaller, undefined, undefined, args, undefined);
	              }
	            }
	          }
	          args.push(methodName);
	          return this._then(caller, undefined, undefined, args, undefined);
	        };
	        function namedGetter(obj) {
	          return obj[this];
	        }
	        function indexedGetter(obj) {
	          var index = +this;
	          if (index < 0)
	            index = Math.max(0, index + obj.length);
	          return obj[index];
	        }
	        Promise.prototype.get = function(propertyName) {
	          var isIndex = (typeof propertyName === "number");
	          var getter;
	          if (!isIndex) {
	            if (canEvaluate) {
	              var maybeGetter = getGetter(propertyName);
	              getter = maybeGetter !== null ? maybeGetter : namedGetter;
	            } else {
	              getter = namedGetter;
	            }
	          } else {
	            getter = indexedGetter;
	          }
	          return this._then(getter, undefined, undefined, propertyName, undefined);
	        };
	      };
	    }, {"./util.js": 38}],
	    6: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise) {
	        var errors = _dereq_("./errors.js");
	        var async = _dereq_("./async.js");
	        var CancellationError = errors.CancellationError;
	        Promise.prototype._cancel = function(reason) {
	          if (!this.isCancellable())
	            return this;
	          var parent;
	          var promiseToReject = this;
	          while ((parent = promiseToReject._cancellationParent) !== undefined && parent.isCancellable()) {
	            promiseToReject = parent;
	          }
	          this._unsetCancellable();
	          promiseToReject._target()._rejectCallback(reason, false, true);
	        };
	        Promise.prototype.cancel = function(reason) {
	          if (!this.isCancellable())
	            return this;
	          if (reason === undefined)
	            reason = new CancellationError();
	          async.invokeLater(this._cancel, this, reason);
	          return this;
	        };
	        Promise.prototype.cancellable = function() {
	          if (this._cancellable())
	            return this;
	          this._setCancellable();
	          this._cancellationParent = undefined;
	          return this;
	        };
	        Promise.prototype.uncancellable = function() {
	          var ret = this.then();
	          ret._unsetCancellable();
	          return ret;
	        };
	        Promise.prototype.fork = function(didFulfill, didReject, didProgress) {
	          var ret = this._then(didFulfill, didReject, didProgress, undefined, undefined);
	          ret._setCancellable();
	          ret._cancellationParent = undefined;
	          return ret;
	        };
	      };
	    }, {
	      "./async.js": 2,
	      "./errors.js": 13
	    }],
	    7: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function() {
	        var async = _dereq_("./async.js");
	        var util = _dereq_("./util.js");
	        var bluebirdFramePattern = /[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/;
	        var stackFramePattern = null;
	        var formatStack = null;
	        var indentStackFrames = false;
	        var warn;
	        function CapturedTrace(parent) {
	          this._parent = parent;
	          var length = this._length = 1 + (parent === undefined ? 0 : parent._length);
	          captureStackTrace(this, CapturedTrace);
	          if (length > 32)
	            this.uncycle();
	        }
	        util.inherits(CapturedTrace, Error);
	        CapturedTrace.prototype.uncycle = function() {
	          var length = this._length;
	          if (length < 2)
	            return;
	          var nodes = [];
	          var stackToIndex = {};
	          for (var i = 0,
	              node = this; node !== undefined; ++i) {
	            nodes.push(node);
	            node = node._parent;
	          }
	          length = this._length = i;
	          for (var i = length - 1; i >= 0; --i) {
	            var stack = nodes[i].stack;
	            if (stackToIndex[stack] === undefined) {
	              stackToIndex[stack] = i;
	            }
	          }
	          for (var i = 0; i < length; ++i) {
	            var currentStack = nodes[i].stack;
	            var index = stackToIndex[currentStack];
	            if (index !== undefined && index !== i) {
	              if (index > 0) {
	                nodes[index - 1]._parent = undefined;
	                nodes[index - 1]._length = 1;
	              }
	              nodes[i]._parent = undefined;
	              nodes[i]._length = 1;
	              var cycleEdgeNode = i > 0 ? nodes[i - 1] : this;
	              if (index < length - 1) {
	                cycleEdgeNode._parent = nodes[index + 1];
	                cycleEdgeNode._parent.uncycle();
	                cycleEdgeNode._length = cycleEdgeNode._parent._length + 1;
	              } else {
	                cycleEdgeNode._parent = undefined;
	                cycleEdgeNode._length = 1;
	              }
	              var currentChildLength = cycleEdgeNode._length + 1;
	              for (var j = i - 2; j >= 0; --j) {
	                nodes[j]._length = currentChildLength;
	                currentChildLength++;
	              }
	              return;
	            }
	          }
	        };
	        CapturedTrace.prototype.parent = function() {
	          return this._parent;
	        };
	        CapturedTrace.prototype.hasParent = function() {
	          return this._parent !== undefined;
	        };
	        CapturedTrace.prototype.attachExtraTrace = function(error) {
	          if (error.__stackCleaned__)
	            return;
	          this.uncycle();
	          var parsed = CapturedTrace.parseStackAndMessage(error);
	          var message = parsed.message;
	          var stacks = [parsed.stack];
	          var trace = this;
	          while (trace !== undefined) {
	            stacks.push(cleanStack(trace.stack.split("\n")));
	            trace = trace._parent;
	          }
	          removeCommonRoots(stacks);
	          removeDuplicateOrEmptyJumps(stacks);
	          error.stack = reconstructStack(message, stacks);
	          util.notEnumerableProp(error, "__stackCleaned__", true);
	        };
	        function reconstructStack(message, stacks) {
	          for (var i = 0; i < stacks.length - 1; ++i) {
	            stacks[i].push("From previous event:");
	            stacks[i] = stacks[i].join("\n");
	          }
	          if (i < stacks.length) {
	            stacks[i] = stacks[i].join("\n");
	          }
	          return message + "\n" + stacks.join("\n");
	        }
	        function removeDuplicateOrEmptyJumps(stacks) {
	          for (var i = 0; i < stacks.length; ++i) {
	            if (stacks[i].length === 0 || ((i + 1 < stacks.length) && stacks[i][0] === stacks[i + 1][0])) {
	              stacks.splice(i, 1);
	              i--;
	            }
	          }
	        }
	        function removeCommonRoots(stacks) {
	          var current = stacks[0];
	          for (var i = 1; i < stacks.length; ++i) {
	            var prev = stacks[i];
	            var currentLastIndex = current.length - 1;
	            var currentLastLine = current[currentLastIndex];
	            var commonRootMeetPoint = -1;
	            for (var j = prev.length - 1; j >= 0; --j) {
	              if (prev[j] === currentLastLine) {
	                commonRootMeetPoint = j;
	                break;
	              }
	            }
	            for (var j = commonRootMeetPoint; j >= 0; --j) {
	              var line = prev[j];
	              if (current[currentLastIndex] === line) {
	                current.pop();
	                currentLastIndex--;
	              } else {
	                break;
	              }
	            }
	            current = prev;
	          }
	        }
	        function cleanStack(stack) {
	          var ret = [];
	          for (var i = 0; i < stack.length; ++i) {
	            var line = stack[i];
	            var isTraceLine = stackFramePattern.test(line) || "    (No stack trace)" === line;
	            var isInternalFrame = isTraceLine && shouldIgnore(line);
	            if (isTraceLine && !isInternalFrame) {
	              if (indentStackFrames && line.charAt(0) !== " ") {
	                line = "    " + line;
	              }
	              ret.push(line);
	            }
	          }
	          return ret;
	        }
	        function stackFramesAsArray(error) {
	          var stack = error.stack.replace(/\s+$/g, "").split("\n");
	          for (var i = 0; i < stack.length; ++i) {
	            var line = stack[i];
	            if ("    (No stack trace)" === line || stackFramePattern.test(line)) {
	              break;
	            }
	          }
	          if (i > 0) {
	            stack = stack.slice(i);
	          }
	          return stack;
	        }
	        CapturedTrace.parseStackAndMessage = function(error) {
	          var stack = error.stack;
	          var message = error.toString();
	          stack = typeof stack === "string" && stack.length > 0 ? stackFramesAsArray(error) : ["    (No stack trace)"];
	          return {
	            message: message,
	            stack: cleanStack(stack)
	          };
	        };
	        CapturedTrace.formatAndLogError = function(error, title) {
	          if (typeof console !== "undefined") {
	            var message;
	            if (typeof error === "object" || typeof error === "function") {
	              var stack = error.stack;
	              message = title + formatStack(stack, error);
	            } else {
	              message = title + String(error);
	            }
	            if (typeof warn === "function") {
	              warn(message);
	            } else if (typeof console.log === "function" || typeof console.log === "object") {
	              console.log(message);
	            }
	          }
	        };
	        CapturedTrace.unhandledRejection = function(reason) {
	          CapturedTrace.formatAndLogError(reason, "^--- With additional stack trace: ");
	        };
	        CapturedTrace.isSupported = function() {
	          return typeof captureStackTrace === "function";
	        };
	        CapturedTrace.fireRejectionEvent = function(name, localHandler, reason, promise) {
	          var localEventFired = false;
	          try {
	            if (typeof localHandler === "function") {
	              localEventFired = true;
	              if (name === "rejectionHandled") {
	                localHandler(promise);
	              } else {
	                localHandler(reason, promise);
	              }
	            }
	          } catch (e) {
	            async.throwLater(e);
	          }
	          var globalEventFired = false;
	          try {
	            globalEventFired = fireGlobalEvent(name, reason, promise);
	          } catch (e) {
	            globalEventFired = true;
	            async.throwLater(e);
	          }
	          var domEventFired = false;
	          if (fireDomEvent) {
	            try {
	              domEventFired = fireDomEvent(name.toLowerCase(), {
	                reason: reason,
	                promise: promise
	              });
	            } catch (e) {
	              domEventFired = true;
	              async.throwLater(e);
	            }
	          }
	          if (!globalEventFired && !localEventFired && !domEventFired && name === "unhandledRejection") {
	            CapturedTrace.formatAndLogError(reason, "Unhandled rejection ");
	          }
	        };
	        function formatNonError(obj) {
	          var str;
	          if (typeof obj === "function") {
	            str = "[function " + (obj.name || "anonymous") + "]";
	          } else {
	            str = obj.toString();
	            var ruselessToString = /\[object [a-zA-Z0-9$_]+\]/;
	            if (ruselessToString.test(str)) {
	              try {
	                var newStr = JSON.stringify(obj);
	                str = newStr;
	              } catch (e) {}
	            }
	            if (str.length === 0) {
	              str = "(empty array)";
	            }
	          }
	          return ("(<" + snip(str) + ">, no stack trace)");
	        }
	        function snip(str) {
	          var maxChars = 41;
	          if (str.length < maxChars) {
	            return str;
	          }
	          return str.substr(0, maxChars - 3) + "...";
	        }
	        var shouldIgnore = function() {
	          return false;
	        };
	        var parseLineInfoRegex = /[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;
	        function parseLineInfo(line) {
	          var matches = line.match(parseLineInfoRegex);
	          if (matches) {
	            return {
	              fileName: matches[1],
	              line: parseInt(matches[2], 10)
	            };
	          }
	        }
	        CapturedTrace.setBounds = function(firstLineError, lastLineError) {
	          if (!CapturedTrace.isSupported())
	            return;
	          var firstStackLines = firstLineError.stack.split("\n");
	          var lastStackLines = lastLineError.stack.split("\n");
	          var firstIndex = -1;
	          var lastIndex = -1;
	          var firstFileName;
	          var lastFileName;
	          for (var i = 0; i < firstStackLines.length; ++i) {
	            var result = parseLineInfo(firstStackLines[i]);
	            if (result) {
	              firstFileName = result.fileName;
	              firstIndex = result.line;
	              break;
	            }
	          }
	          for (var i = 0; i < lastStackLines.length; ++i) {
	            var result = parseLineInfo(lastStackLines[i]);
	            if (result) {
	              lastFileName = result.fileName;
	              lastIndex = result.line;
	              break;
	            }
	          }
	          if (firstIndex < 0 || lastIndex < 0 || !firstFileName || !lastFileName || firstFileName !== lastFileName || firstIndex >= lastIndex) {
	            return;
	          }
	          shouldIgnore = function(line) {
	            if (bluebirdFramePattern.test(line))
	              return true;
	            var info = parseLineInfo(line);
	            if (info) {
	              if (info.fileName === firstFileName && (firstIndex <= info.line && info.line <= lastIndex)) {
	                return true;
	              }
	            }
	            return false;
	          };
	        };
	        var captureStackTrace = (function stackDetection() {
	          var v8stackFramePattern = /^\s*at\s*/;
	          var v8stackFormatter = function(stack, error) {
	            if (typeof stack === "string")
	              return stack;
	            if (error.name !== undefined && error.message !== undefined) {
	              return error.toString();
	            }
	            return formatNonError(error);
	          };
	          if (typeof Error.stackTraceLimit === "number" && typeof Error.captureStackTrace === "function") {
	            Error.stackTraceLimit = Error.stackTraceLimit + 6;
	            stackFramePattern = v8stackFramePattern;
	            formatStack = v8stackFormatter;
	            var captureStackTrace = Error.captureStackTrace;
	            shouldIgnore = function(line) {
	              return bluebirdFramePattern.test(line);
	            };
	            return function(receiver, ignoreUntil) {
	              Error.stackTraceLimit = Error.stackTraceLimit + 6;
	              captureStackTrace(receiver, ignoreUntil);
	              Error.stackTraceLimit = Error.stackTraceLimit - 6;
	            };
	          }
	          var err = new Error();
	          if (typeof err.stack === "string" && err.stack.split("\n")[0].indexOf("stackDetection@") >= 0) {
	            stackFramePattern = /@/;
	            formatStack = v8stackFormatter;
	            indentStackFrames = true;
	            return function captureStackTrace(o) {
	              o.stack = new Error().stack;
	            };
	          }
	          var hasStackAfterThrow;
	          try {
	            throw new Error();
	          } catch (e) {
	            hasStackAfterThrow = ("stack" in e);
	          }
	          if (!("stack" in err) && hasStackAfterThrow) {
	            stackFramePattern = v8stackFramePattern;
	            formatStack = v8stackFormatter;
	            return function captureStackTrace(o) {
	              Error.stackTraceLimit = Error.stackTraceLimit + 6;
	              try {
	                throw new Error();
	              } catch (e) {
	                o.stack = e.stack;
	              }
	              Error.stackTraceLimit = Error.stackTraceLimit - 6;
	            };
	          }
	          formatStack = function(stack, error) {
	            if (typeof stack === "string")
	              return stack;
	            if ((typeof error === "object" || typeof error === "function") && error.name !== undefined && error.message !== undefined) {
	              return error.toString();
	            }
	            return formatNonError(error);
	          };
	          return null;
	        })([]);
	        var fireDomEvent;
	        var fireGlobalEvent = (function() {
	          if (util.isNode) {
	            return function(name, reason, promise) {
	              if (name === "rejectionHandled") {
	                return process.emit(name, promise);
	              } else {
	                return process.emit(name, reason, promise);
	              }
	            };
	          } else {
	            var customEventWorks = false;
	            var anyEventWorks = true;
	            try {
	              var ev = new self.CustomEvent("test");
	              customEventWorks = ev instanceof CustomEvent;
	            } catch (e) {}
	            if (!customEventWorks) {
	              try {
	                var event = document.createEvent("CustomEvent");
	                event.initCustomEvent("testingtheevent", false, true, {});
	                self.dispatchEvent(event);
	              } catch (e) {
	                anyEventWorks = false;
	              }
	            }
	            if (anyEventWorks) {
	              fireDomEvent = function(type, detail) {
	                var event;
	                if (customEventWorks) {
	                  event = new self.CustomEvent(type, {
	                    detail: detail,
	                    bubbles: false,
	                    cancelable: true
	                  });
	                } else if (self.dispatchEvent) {
	                  event = document.createEvent("CustomEvent");
	                  event.initCustomEvent(type, false, true, detail);
	                }
	                return event ? !self.dispatchEvent(event) : false;
	              };
	            }
	            var toWindowMethodNameMap = {};
	            toWindowMethodNameMap["unhandledRejection"] = ("on" + "unhandledRejection").toLowerCase();
	            toWindowMethodNameMap["rejectionHandled"] = ("on" + "rejectionHandled").toLowerCase();
	            return function(name, reason, promise) {
	              var methodName = toWindowMethodNameMap[name];
	              var method = self[methodName];
	              if (!method)
	                return false;
	              if (name === "rejectionHandled") {
	                method.call(self, promise);
	              } else {
	                method.call(self, reason, promise);
	              }
	              return true;
	            };
	          }
	        })();
	        if (typeof console !== "undefined" && typeof console.warn !== "undefined") {
	          warn = function(message) {
	            console.warn(message);
	          };
	          if (util.isNode && process.stderr.isTTY) {
	            warn = function(message) {
	              process.stderr.write("\u001b[31m" + message + "\u001b[39m\n");
	            };
	          } else if (!util.isNode && typeof(new Error().stack) === "string") {
	            warn = function(message) {
	              console.warn("%c" + message, "color: red");
	            };
	          }
	        }
	        return CapturedTrace;
	      };
	    }, {
	      "./async.js": 2,
	      "./util.js": 38
	    }],
	    8: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(NEXT_FILTER) {
	        var util = _dereq_("./util.js");
	        var errors = _dereq_("./errors.js");
	        var tryCatch = util.tryCatch;
	        var errorObj = util.errorObj;
	        var keys = _dereq_("./es5.js").keys;
	        var TypeError = errors.TypeError;
	        function CatchFilter(instances, callback, promise) {
	          this._instances = instances;
	          this._callback = callback;
	          this._promise = promise;
	        }
	        function safePredicate(predicate, e) {
	          var safeObject = {};
	          var retfilter = tryCatch(predicate).call(safeObject, e);
	          if (retfilter === errorObj)
	            return retfilter;
	          var safeKeys = keys(safeObject);
	          if (safeKeys.length) {
	            errorObj.e = new TypeError("Catch filter must inherit from Error or be a simple predicate function\u000a\u000a    See http://goo.gl/o84o68\u000a");
	            return errorObj;
	          }
	          return retfilter;
	        }
	        CatchFilter.prototype.doFilter = function(e) {
	          var cb = this._callback;
	          var promise = this._promise;
	          var boundTo = promise._boundTo;
	          for (var i = 0,
	              len = this._instances.length; i < len; ++i) {
	            var item = this._instances[i];
	            var itemIsErrorType = item === Error || (item != null && item.prototype instanceof Error);
	            if (itemIsErrorType && e instanceof item) {
	              var ret = tryCatch(cb).call(boundTo, e);
	              if (ret === errorObj) {
	                NEXT_FILTER.e = ret.e;
	                return NEXT_FILTER;
	              }
	              return ret;
	            } else if (typeof item === "function" && !itemIsErrorType) {
	              var shouldHandle = safePredicate(item, e);
	              if (shouldHandle === errorObj) {
	                e = errorObj.e;
	                break;
	              } else if (shouldHandle) {
	                var ret = tryCatch(cb).call(boundTo, e);
	                if (ret === errorObj) {
	                  NEXT_FILTER.e = ret.e;
	                  return NEXT_FILTER;
	                }
	                return ret;
	              }
	            }
	          }
	          NEXT_FILTER.e = e;
	          return NEXT_FILTER;
	        };
	        return CatchFilter;
	      };
	    }, {
	      "./errors.js": 13,
	      "./es5.js": 14,
	      "./util.js": 38
	    }],
	    9: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, CapturedTrace, isDebugging) {
	        var contextStack = [];
	        function Context() {
	          this._trace = new CapturedTrace(peekContext());
	        }
	        Context.prototype._pushContext = function() {
	          if (!isDebugging())
	            return;
	          if (this._trace !== undefined) {
	            contextStack.push(this._trace);
	          }
	        };
	        Context.prototype._popContext = function() {
	          if (!isDebugging())
	            return;
	          if (this._trace !== undefined) {
	            contextStack.pop();
	          }
	        };
	        function createContext() {
	          if (isDebugging())
	            return new Context();
	        }
	        function peekContext() {
	          var lastIndex = contextStack.length - 1;
	          if (lastIndex >= 0) {
	            return contextStack[lastIndex];
	          }
	          return undefined;
	        }
	        Promise.prototype._peekContext = peekContext;
	        Promise.prototype._pushContext = Context.prototype._pushContext;
	        Promise.prototype._popContext = Context.prototype._popContext;
	        return createContext;
	      };
	    }, {}],
	    10: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, CapturedTrace) {
	        var async = _dereq_("./async.js");
	        var Warning = _dereq_("./errors.js").Warning;
	        var util = _dereq_("./util.js");
	        var canAttachTrace = util.canAttachTrace;
	        var unhandledRejectionHandled;
	        var possiblyUnhandledRejection;
	        var debugging = false || (util.isNode && (!!process.env["BLUEBIRD_DEBUG"] || process.env["NODE_ENV"] === "development"));
	        Promise.prototype._ensurePossibleRejectionHandled = function() {
	          this._setRejectionIsUnhandled();
	          async.invokeLater(this._notifyUnhandledRejection, this, undefined);
	        };
	        Promise.prototype._notifyUnhandledRejectionIsHandled = function() {
	          CapturedTrace.fireRejectionEvent("rejectionHandled", unhandledRejectionHandled, undefined, this);
	        };
	        Promise.prototype._notifyUnhandledRejection = function() {
	          if (this._isRejectionUnhandled()) {
	            var reason = this._getCarriedStackTrace() || this._settledValue;
	            this._setUnhandledRejectionIsNotified();
	            CapturedTrace.fireRejectionEvent("unhandledRejection", possiblyUnhandledRejection, reason, this);
	          }
	        };
	        Promise.prototype._setUnhandledRejectionIsNotified = function() {
	          this._bitField = this._bitField | 524288;
	        };
	        Promise.prototype._unsetUnhandledRejectionIsNotified = function() {
	          this._bitField = this._bitField & (~524288);
	        };
	        Promise.prototype._isUnhandledRejectionNotified = function() {
	          return (this._bitField & 524288) > 0;
	        };
	        Promise.prototype._setRejectionIsUnhandled = function() {
	          this._bitField = this._bitField | 2097152;
	        };
	        Promise.prototype._unsetRejectionIsUnhandled = function() {
	          this._bitField = this._bitField & (~2097152);
	          if (this._isUnhandledRejectionNotified()) {
	            this._unsetUnhandledRejectionIsNotified();
	            this._notifyUnhandledRejectionIsHandled();
	          }
	        };
	        Promise.prototype._isRejectionUnhandled = function() {
	          return (this._bitField & 2097152) > 0;
	        };
	        Promise.prototype._setCarriedStackTrace = function(capturedTrace) {
	          this._bitField = this._bitField | 1048576;
	          this._fulfillmentHandler0 = capturedTrace;
	        };
	        Promise.prototype._isCarryingStackTrace = function() {
	          return (this._bitField & 1048576) > 0;
	        };
	        Promise.prototype._getCarriedStackTrace = function() {
	          return this._isCarryingStackTrace() ? this._fulfillmentHandler0 : undefined;
	        };
	        Promise.prototype._captureStackTrace = function() {
	          if (debugging) {
	            this._trace = new CapturedTrace(this._peekContext());
	          }
	          return this;
	        };
	        Promise.prototype._attachExtraTrace = function(error, ignoreSelf) {
	          if (debugging && canAttachTrace(error)) {
	            var trace = this._trace;
	            if (trace !== undefined) {
	              if (ignoreSelf)
	                trace = trace._parent;
	            }
	            if (trace !== undefined) {
	              trace.attachExtraTrace(error);
	            } else if (!error.__stackCleaned__) {
	              var parsed = CapturedTrace.parseStackAndMessage(error);
	              error.stack = parsed.message + "\n" + parsed.stack.join("\n");
	              util.notEnumerableProp(error, "__stackCleaned__", true);
	            }
	          }
	        };
	        Promise.prototype._warn = function(message) {
	          var warning = new Warning(message);
	          var ctx = this._peekContext();
	          if (ctx) {
	            ctx.attachExtraTrace(warning);
	          } else {
	            var parsed = CapturedTrace.parseStackAndMessage(warning);
	            warning.stack = parsed.message + "\n" + parsed.stack.join("\n");
	          }
	          CapturedTrace.formatAndLogError(warning, "");
	        };
	        Promise.onPossiblyUnhandledRejection = function(fn) {
	          possiblyUnhandledRejection = typeof fn === "function" ? fn : undefined;
	        };
	        Promise.onUnhandledRejectionHandled = function(fn) {
	          unhandledRejectionHandled = typeof fn === "function" ? fn : undefined;
	        };
	        Promise.longStackTraces = function() {
	          if (async.haveItemsQueued() && debugging === false) {
	            throw new Error("cannot enable long stack traces after promises have been created\u000a\u000a    See http://goo.gl/DT1qyG\u000a");
	          }
	          debugging = CapturedTrace.isSupported();
	        };
	        Promise.hasLongStackTraces = function() {
	          return debugging && CapturedTrace.isSupported();
	        };
	        if (!CapturedTrace.isSupported()) {
	          Promise.longStackTraces = function() {};
	          debugging = false;
	        }
	        return function() {
	          return debugging;
	        };
	      };
	    }, {
	      "./async.js": 2,
	      "./errors.js": 13,
	      "./util.js": 38
	    }],
	    11: [function(_dereq_, module, exports) {
	      "use strict";
	      var util = _dereq_("./util.js");
	      var isPrimitive = util.isPrimitive;
	      var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;
	      module.exports = function(Promise) {
	        var returner = function() {
	          return this;
	        };
	        var thrower = function() {
	          throw this;
	        };
	        var wrapper = function(value, action) {
	          if (action === 1) {
	            return function() {
	              throw value;
	            };
	          } else if (action === 2) {
	            return function() {
	              return value;
	            };
	          }
	        };
	        Promise.prototype["return"] = Promise.prototype.thenReturn = function(value) {
	          if (wrapsPrimitiveReceiver && isPrimitive(value)) {
	            return this._then(wrapper(value, 2), undefined, undefined, undefined, undefined);
	          }
	          return this._then(returner, undefined, undefined, value, undefined);
	        };
	        Promise.prototype["throw"] = Promise.prototype.thenThrow = function(reason) {
	          if (wrapsPrimitiveReceiver && isPrimitive(reason)) {
	            return this._then(wrapper(reason, 1), undefined, undefined, undefined, undefined);
	          }
	          return this._then(thrower, undefined, undefined, reason, undefined);
	        };
	      };
	    }, {"./util.js": 38}],
	    12: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL) {
	        var PromiseReduce = Promise.reduce;
	        Promise.prototype.each = function(fn) {
	          return PromiseReduce(this, fn, null, INTERNAL);
	        };
	        Promise.each = function(promises, fn) {
	          return PromiseReduce(promises, fn, null, INTERNAL);
	        };
	      };
	    }, {}],
	    13: [function(_dereq_, module, exports) {
	      "use strict";
	      var es5 = _dereq_("./es5.js");
	      var Objectfreeze = es5.freeze;
	      var util = _dereq_("./util.js");
	      var inherits = util.inherits;
	      var notEnumerableProp = util.notEnumerableProp;
	      function subError(nameProperty, defaultMessage) {
	        function SubError(message) {
	          if (!(this instanceof SubError))
	            return new SubError(message);
	          notEnumerableProp(this, "message", typeof message === "string" ? message : defaultMessage);
	          notEnumerableProp(this, "name", nameProperty);
	          if (Error.captureStackTrace) {
	            Error.captureStackTrace(this, this.constructor);
	          } else {
	            Error.call(this);
	          }
	        }
	        inherits(SubError, Error);
	        return SubError;
	      }
	      var _TypeError,
	          _RangeError;
	      var Warning = subError("Warning", "warning");
	      var CancellationError = subError("CancellationError", "cancellation error");
	      var TimeoutError = subError("TimeoutError", "timeout error");
	      var AggregateError = subError("AggregateError", "aggregate error");
	      try {
	        _TypeError = TypeError;
	        _RangeError = RangeError;
	      } catch (e) {
	        _TypeError = subError("TypeError", "type error");
	        _RangeError = subError("RangeError", "range error");
	      }
	      var methods = ("join pop push shift unshift slice filter forEach some " + "every map indexOf lastIndexOf reduce reduceRight sort reverse").split(" ");
	      for (var i = 0; i < methods.length; ++i) {
	        if (typeof Array.prototype[methods[i]] === "function") {
	          AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];
	        }
	      }
	      es5.defineProperty(AggregateError.prototype, "length", {
	        value: 0,
	        configurable: false,
	        writable: true,
	        enumerable: true
	      });
	      AggregateError.prototype["isOperational"] = true;
	      var level = 0;
	      AggregateError.prototype.toString = function() {
	        var indent = Array(level * 4 + 1).join(" ");
	        var ret = "\n" + indent + "AggregateError of:" + "\n";
	        level++;
	        indent = Array(level * 4 + 1).join(" ");
	        for (var i = 0; i < this.length; ++i) {
	          var str = this[i] === this ? "[Circular AggregateError]" : this[i] + "";
	          var lines = str.split("\n");
	          for (var j = 0; j < lines.length; ++j) {
	            lines[j] = indent + lines[j];
	          }
	          str = lines.join("\n");
	          ret += str + "\n";
	        }
	        level--;
	        return ret;
	      };
	      function OperationalError(message) {
	        if (!(this instanceof OperationalError))
	          return new OperationalError(message);
	        notEnumerableProp(this, "name", "OperationalError");
	        notEnumerableProp(this, "message", message);
	        this.cause = message;
	        this["isOperational"] = true;
	        if (message instanceof Error) {
	          notEnumerableProp(this, "message", message.message);
	          notEnumerableProp(this, "stack", message.stack);
	        } else if (Error.captureStackTrace) {
	          Error.captureStackTrace(this, this.constructor);
	        }
	      }
	      inherits(OperationalError, Error);
	      var errorTypes = Error["__BluebirdErrorTypes__"];
	      if (!errorTypes) {
	        errorTypes = Objectfreeze({
	          CancellationError: CancellationError,
	          TimeoutError: TimeoutError,
	          OperationalError: OperationalError,
	          RejectionError: OperationalError,
	          AggregateError: AggregateError
	        });
	        notEnumerableProp(Error, "__BluebirdErrorTypes__", errorTypes);
	      }
	      module.exports = {
	        Error: Error,
	        TypeError: _TypeError,
	        RangeError: _RangeError,
	        CancellationError: errorTypes.CancellationError,
	        OperationalError: errorTypes.OperationalError,
	        TimeoutError: errorTypes.TimeoutError,
	        AggregateError: errorTypes.AggregateError,
	        Warning: Warning
	      };
	    }, {
	      "./es5.js": 14,
	      "./util.js": 38
	    }],
	    14: [function(_dereq_, module, exports) {
	      var isES5 = (function() {
	        "use strict";
	        return this === undefined;
	      })();
	      if (isES5) {
	        module.exports = {
	          freeze: Object.freeze,
	          defineProperty: Object.defineProperty,
	          getDescriptor: Object.getOwnPropertyDescriptor,
	          keys: Object.keys,
	          names: Object.getOwnPropertyNames,
	          getPrototypeOf: Object.getPrototypeOf,
	          isArray: Array.isArray,
	          isES5: isES5,
	          propertyIsWritable: function(obj, prop) {
	            var descriptor = Object.getOwnPropertyDescriptor(obj, prop);
	            return !!(!descriptor || descriptor.writable || descriptor.set);
	          }
	        };
	      } else {
	        var has = {}.hasOwnProperty;
	        var str = {}.toString;
	        var proto = {}.constructor.prototype;
	        var ObjectKeys = function(o) {
	          var ret = [];
	          for (var key in o) {
	            if (has.call(o, key)) {
	              ret.push(key);
	            }
	          }
	          return ret;
	        };
	        var ObjectGetDescriptor = function(o, key) {
	          return {value: o[key]};
	        };
	        var ObjectDefineProperty = function(o, key, desc) {
	          o[key] = desc.value;
	          return o;
	        };
	        var ObjectFreeze = function(obj) {
	          return obj;
	        };
	        var ObjectGetPrototypeOf = function(obj) {
	          try {
	            return Object(obj).constructor.prototype;
	          } catch (e) {
	            return proto;
	          }
	        };
	        var ArrayIsArray = function(obj) {
	          try {
	            return str.call(obj) === "[object Array]";
	          } catch (e) {
	            return false;
	          }
	        };
	        module.exports = {
	          isArray: ArrayIsArray,
	          keys: ObjectKeys,
	          names: ObjectKeys,
	          defineProperty: ObjectDefineProperty,
	          getDescriptor: ObjectGetDescriptor,
	          freeze: ObjectFreeze,
	          getPrototypeOf: ObjectGetPrototypeOf,
	          isES5: isES5,
	          propertyIsWritable: function() {
	            return true;
	          }
	        };
	      }
	    }, {}],
	    15: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL) {
	        var PromiseMap = Promise.map;
	        Promise.prototype.filter = function(fn, options) {
	          return PromiseMap(this, fn, options, INTERNAL);
	        };
	        Promise.filter = function(promises, fn, options) {
	          return PromiseMap(promises, fn, options, INTERNAL);
	        };
	      };
	    }, {}],
	    16: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, NEXT_FILTER, tryConvertToPromise) {
	        var util = _dereq_("./util.js");
	        var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;
	        var isPrimitive = util.isPrimitive;
	        var thrower = util.thrower;
	        function returnThis() {
	          return this;
	        }
	        function throwThis() {
	          throw this;
	        }
	        function return$(r) {
	          return function() {
	            return r;
	          };
	        }
	        function throw$(r) {
	          return function() {
	            throw r;
	          };
	        }
	        function promisedFinally(ret, reasonOrValue, isFulfilled) {
	          var then;
	          if (wrapsPrimitiveReceiver && isPrimitive(reasonOrValue)) {
	            then = isFulfilled ? return$(reasonOrValue) : throw$(reasonOrValue);
	          } else {
	            then = isFulfilled ? returnThis : throwThis;
	          }
	          return ret._then(then, thrower, undefined, reasonOrValue, undefined);
	        }
	        function finallyHandler(reasonOrValue) {
	          var promise = this.promise;
	          var handler = this.handler;
	          var ret = promise._isBound() ? handler.call(promise._boundTo) : handler();
	          if (ret !== undefined) {
	            var maybePromise = tryConvertToPromise(ret, promise);
	            if (maybePromise instanceof Promise) {
	              maybePromise = maybePromise._target();
	              return promisedFinally(maybePromise, reasonOrValue, promise.isFulfilled());
	            }
	          }
	          if (promise.isRejected()) {
	            NEXT_FILTER.e = reasonOrValue;
	            return NEXT_FILTER;
	          } else {
	            return reasonOrValue;
	          }
	        }
	        function tapHandler(value) {
	          var promise = this.promise;
	          var handler = this.handler;
	          var ret = promise._isBound() ? handler.call(promise._boundTo, value) : handler(value);
	          if (ret !== undefined) {
	            var maybePromise = tryConvertToPromise(ret, promise);
	            if (maybePromise instanceof Promise) {
	              maybePromise = maybePromise._target();
	              return promisedFinally(maybePromise, value, true);
	            }
	          }
	          return value;
	        }
	        Promise.prototype._passThroughHandler = function(handler, isFinally) {
	          if (typeof handler !== "function")
	            return this.then();
	          var promiseAndHandler = {
	            promise: this,
	            handler: handler
	          };
	          return this._then(isFinally ? finallyHandler : tapHandler, isFinally ? finallyHandler : undefined, undefined, promiseAndHandler, undefined);
	        };
	        Promise.prototype.lastly = Promise.prototype["finally"] = function(handler) {
	          return this._passThroughHandler(handler, true);
	        };
	        Promise.prototype.tap = function(handler) {
	          return this._passThroughHandler(handler, false);
	        };
	      };
	    }, {"./util.js": 38}],
	    17: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, apiRejection, INTERNAL, tryConvertToPromise) {
	        var errors = _dereq_("./errors.js");
	        var TypeError = errors.TypeError;
	        var util = _dereq_("./util.js");
	        var errorObj = util.errorObj;
	        var tryCatch = util.tryCatch;
	        var yieldHandlers = [];
	        function promiseFromYieldHandler(value, yieldHandlers, traceParent) {
	          for (var i = 0; i < yieldHandlers.length; ++i) {
	            traceParent._pushContext();
	            var result = tryCatch(yieldHandlers[i])(value);
	            traceParent._popContext();
	            if (result === errorObj) {
	              traceParent._pushContext();
	              var ret = Promise.reject(errorObj.e);
	              traceParent._popContext();
	              return ret;
	            }
	            var maybePromise = tryConvertToPromise(result, traceParent);
	            if (maybePromise instanceof Promise)
	              return maybePromise;
	          }
	          return null;
	        }
	        function PromiseSpawn(generatorFunction, receiver, yieldHandler, stack) {
	          var promise = this._promise = new Promise(INTERNAL);
	          promise._captureStackTrace();
	          this._stack = stack;
	          this._generatorFunction = generatorFunction;
	          this._receiver = receiver;
	          this._generator = undefined;
	          this._yieldHandlers = typeof yieldHandler === "function" ? [yieldHandler].concat(yieldHandlers) : yieldHandlers;
	        }
	        PromiseSpawn.prototype.promise = function() {
	          return this._promise;
	        };
	        PromiseSpawn.prototype._run = function() {
	          this._generator = this._generatorFunction.call(this._receiver);
	          this._receiver = this._generatorFunction = undefined;
	          this._next(undefined);
	        };
	        PromiseSpawn.prototype._continue = function(result) {
	          if (result === errorObj) {
	            return this._promise._rejectCallback(result.e, false, true);
	          }
	          var value = result.value;
	          if (result.done === true) {
	            this._promise._resolveCallback(value);
	          } else {
	            var maybePromise = tryConvertToPromise(value, this._promise);
	            if (!(maybePromise instanceof Promise)) {
	              maybePromise = promiseFromYieldHandler(maybePromise, this._yieldHandlers, this._promise);
	              if (maybePromise === null) {
	                this._throw(new TypeError("A value %s was yielded that could not be treated as a promise\u000a\u000a    See http://goo.gl/4Y4pDk\u000a\u000a".replace("%s", value) + "From coroutine:\u000a" + this._stack.split("\n").slice(1, -7).join("\n")));
	                return;
	              }
	            }
	            maybePromise._then(this._next, this._throw, undefined, this, null);
	          }
	        };
	        PromiseSpawn.prototype._throw = function(reason) {
	          this._promise._attachExtraTrace(reason);
	          this._promise._pushContext();
	          var result = tryCatch(this._generator["throw"]).call(this._generator, reason);
	          this._promise._popContext();
	          this._continue(result);
	        };
	        PromiseSpawn.prototype._next = function(value) {
	          this._promise._pushContext();
	          var result = tryCatch(this._generator.next).call(this._generator, value);
	          this._promise._popContext();
	          this._continue(result);
	        };
	        Promise.coroutine = function(generatorFunction, options) {
	          if (typeof generatorFunction !== "function") {
	            throw new TypeError("generatorFunction must be a function\u000a\u000a    See http://goo.gl/6Vqhm0\u000a");
	          }
	          var yieldHandler = Object(options).yieldHandler;
	          var PromiseSpawn$ = PromiseSpawn;
	          var stack = new Error().stack;
	          return function() {
	            var generator = generatorFunction.apply(this, arguments);
	            var spawn = new PromiseSpawn$(undefined, undefined, yieldHandler, stack);
	            spawn._generator = generator;
	            spawn._next(undefined);
	            return spawn.promise();
	          };
	        };
	        Promise.coroutine.addYieldHandler = function(fn) {
	          if (typeof fn !== "function")
	            throw new TypeError("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          yieldHandlers.push(fn);
	        };
	        Promise.spawn = function(generatorFunction) {
	          if (typeof generatorFunction !== "function") {
	            return apiRejection("generatorFunction must be a function\u000a\u000a    See http://goo.gl/6Vqhm0\u000a");
	          }
	          var spawn = new PromiseSpawn(generatorFunction, this);
	          var ret = spawn.promise();
	          spawn._run(Promise.spawn);
	          return ret;
	        };
	      };
	    }, {
	      "./errors.js": 13,
	      "./util.js": 38
	    }],
	    18: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, PromiseArray, tryConvertToPromise, INTERNAL) {
	        var util = _dereq_("./util.js");
	        var canEvaluate = util.canEvaluate;
	        var tryCatch = util.tryCatch;
	        var errorObj = util.errorObj;
	        var reject;
	        if (false) {
	          if (canEvaluate) {
	            var thenCallback = function(i) {
	              return new Function("value", "holder", "                             \n\
	            'use strict';                                                    \n\
	            holder.pIndex = value;                                           \n\
	            holder.checkFulfillment(this);                                   \n\
	            ".replace(/Index/g, i));
	            };
	            var caller = function(count) {
	              var values = [];
	              for (var i = 1; i <= count; ++i)
	                values.push("holder.p" + i);
	              return new Function("holder", "                                      \n\
	            'use strict';                                                    \n\
	            var callback = holder.fn;                                        \n\
	            return callback(values);                                         \n\
	            ".replace(/values/g, values.join(", ")));
	            };
	            var thenCallbacks = [];
	            var callers = [undefined];
	            for (var i = 1; i <= 5; ++i) {
	              thenCallbacks.push(thenCallback(i));
	              callers.push(caller(i));
	            }
	            var Holder = function(total, fn) {
	              this.p1 = this.p2 = this.p3 = this.p4 = this.p5 = null;
	              this.fn = fn;
	              this.total = total;
	              this.now = 0;
	            };
	            Holder.prototype.callers = callers;
	            Holder.prototype.checkFulfillment = function(promise) {
	              var now = this.now;
	              now++;
	              var total = this.total;
	              if (now >= total) {
	                var handler = this.callers[total];
	                promise._pushContext();
	                var ret = tryCatch(handler)(this);
	                promise._popContext();
	                if (ret === errorObj) {
	                  promise._rejectCallback(ret.e, false, true);
	                } else {
	                  promise._resolveCallback(ret);
	                }
	              } else {
	                this.now = now;
	              }
	            };
	            var reject = function(reason) {
	              this._reject(reason);
	            };
	          }
	        }
	        Promise.join = function() {
	          var last = arguments.length - 1;
	          var fn;
	          if (last > 0 && typeof arguments[last] === "function") {
	            fn = arguments[last];
	            if (false) {
	              if (last < 6 && canEvaluate) {
	                var ret = new Promise(INTERNAL);
	                ret._captureStackTrace();
	                var holder = new Holder(last, fn);
	                var callbacks = thenCallbacks;
	                for (var i = 0; i < last; ++i) {
	                  var maybePromise = tryConvertToPromise(arguments[i], ret);
	                  if (maybePromise instanceof Promise) {
	                    maybePromise = maybePromise._target();
	                    if (maybePromise._isPending()) {
	                      maybePromise._then(callbacks[i], reject, undefined, ret, holder);
	                    } else if (maybePromise._isFulfilled()) {
	                      callbacks[i].call(ret, maybePromise._value(), holder);
	                    } else {
	                      ret._reject(maybePromise._reason());
	                    }
	                  } else {
	                    callbacks[i].call(ret, maybePromise, holder);
	                  }
	                }
	                return ret;
	              }
	            }
	          }
	          var $_len = arguments.length;
	          var args = new Array($_len);
	          for (var $_i = 0; $_i < $_len; ++$_i) {
	            args[$_i] = arguments[$_i];
	          }
	          if (fn)
	            args.pop();
	          var ret = new PromiseArray(args).promise();
	          return fn !== undefined ? ret.spread(fn) : ret;
	        };
	      };
	    }, {"./util.js": 38}],
	    19: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL) {
	        var util = _dereq_("./util.js");
	        var tryCatch = util.tryCatch;
	        var errorObj = util.errorObj;
	        var PENDING = {};
	        var EMPTY_ARRAY = [];
	        function MappingPromiseArray(promises, fn, limit, _filter) {
	          this.constructor$(promises);
	          this._promise._captureStackTrace();
	          this._callback = fn;
	          this._preservedValues = _filter === INTERNAL ? new Array(this.length()) : null;
	          this._limit = limit;
	          this._inFlight = 0;
	          this._queue = limit >= 1 ? [] : EMPTY_ARRAY;
	          this._init$(undefined, -2);
	        }
	        util.inherits(MappingPromiseArray, PromiseArray);
	        MappingPromiseArray.prototype._init = function() {};
	        MappingPromiseArray.prototype._promiseFulfilled = function(value, index) {
	          var values = this._values;
	          var length = this.length();
	          var preservedValues = this._preservedValues;
	          var limit = this._limit;
	          if (values[index] === PENDING) {
	            values[index] = value;
	            if (limit >= 1) {
	              this._inFlight--;
	              this._drainQueue();
	              if (this._isResolved())
	                return;
	            }
	          } else {
	            if (limit >= 1 && this._inFlight >= limit) {
	              values[index] = value;
	              this._queue.push(index);
	              return;
	            }
	            if (preservedValues !== null)
	              preservedValues[index] = value;
	            var callback = this._callback;
	            var receiver = this._promise._boundTo;
	            this._promise._pushContext();
	            var ret = tryCatch(callback).call(receiver, value, index, length);
	            this._promise._popContext();
	            if (ret === errorObj)
	              return this._reject(ret.e);
	            var maybePromise = tryConvertToPromise(ret, this._promise);
	            if (maybePromise instanceof Promise) {
	              maybePromise = maybePromise._target();
	              if (maybePromise._isPending()) {
	                if (limit >= 1)
	                  this._inFlight++;
	                values[index] = PENDING;
	                return maybePromise._proxyPromiseArray(this, index);
	              } else if (maybePromise._isFulfilled()) {
	                ret = maybePromise._value();
	              } else {
	                return this._reject(maybePromise._reason());
	              }
	            }
	            values[index] = ret;
	          }
	          var totalResolved = ++this._totalResolved;
	          if (totalResolved >= length) {
	            if (preservedValues !== null) {
	              this._filter(values, preservedValues);
	            } else {
	              this._resolve(values);
	            }
	          }
	        };
	        MappingPromiseArray.prototype._drainQueue = function() {
	          var queue = this._queue;
	          var limit = this._limit;
	          var values = this._values;
	          while (queue.length > 0 && this._inFlight < limit) {
	            if (this._isResolved())
	              return;
	            var index = queue.pop();
	            this._promiseFulfilled(values[index], index);
	          }
	        };
	        MappingPromiseArray.prototype._filter = function(booleans, values) {
	          var len = values.length;
	          var ret = new Array(len);
	          var j = 0;
	          for (var i = 0; i < len; ++i) {
	            if (booleans[i])
	              ret[j++] = values[i];
	          }
	          ret.length = j;
	          this._resolve(ret);
	        };
	        MappingPromiseArray.prototype.preservedValues = function() {
	          return this._preservedValues;
	        };
	        function map(promises, fn, options, _filter) {
	          var limit = typeof options === "object" && options !== null ? options.concurrency : 0;
	          limit = typeof limit === "number" && isFinite(limit) && limit >= 1 ? limit : 0;
	          return new MappingPromiseArray(promises, fn, limit, _filter);
	        }
	        Promise.prototype.map = function(fn, options) {
	          if (typeof fn !== "function")
	            return apiRejection("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          return map(this, fn, options, null).promise();
	        };
	        Promise.map = function(promises, fn, options, _filter) {
	          if (typeof fn !== "function")
	            return apiRejection("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          return map(promises, fn, options, _filter).promise();
	        };
	      };
	    }, {"./util.js": 38}],
	    20: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL, tryConvertToPromise, apiRejection) {
	        var util = _dereq_("./util.js");
	        var tryCatch = util.tryCatch;
	        Promise.method = function(fn) {
	          if (typeof fn !== "function") {
	            throw new Promise.TypeError("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          }
	          return function() {
	            var ret = new Promise(INTERNAL);
	            ret._captureStackTrace();
	            ret._pushContext();
	            var value = tryCatch(fn).apply(this, arguments);
	            ret._popContext();
	            ret._resolveFromSyncValue(value);
	            return ret;
	          };
	        };
	        Promise.attempt = Promise["try"] = function(fn, args, ctx) {
	          if (typeof fn !== "function") {
	            return apiRejection("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          }
	          var ret = new Promise(INTERNAL);
	          ret._captureStackTrace();
	          ret._pushContext();
	          var value = util.isArray(args) ? tryCatch(fn).apply(ctx, args) : tryCatch(fn).call(ctx, args);
	          ret._popContext();
	          ret._resolveFromSyncValue(value);
	          return ret;
	        };
	        Promise.prototype._resolveFromSyncValue = function(value) {
	          if (value === util.errorObj) {
	            this._rejectCallback(value.e, false, true);
	          } else {
	            this._resolveCallback(value, true);
	          }
	        };
	      };
	    }, {"./util.js": 38}],
	    21: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise) {
	        var util = _dereq_("./util.js");
	        var async = _dereq_("./async.js");
	        var tryCatch = util.tryCatch;
	        var errorObj = util.errorObj;
	        function spreadAdapter(val, nodeback) {
	          var promise = this;
	          if (!util.isArray(val))
	            return successAdapter.call(promise, val, nodeback);
	          var ret = tryCatch(nodeback).apply(promise._boundTo, [null].concat(val));
	          if (ret === errorObj) {
	            async.throwLater(ret.e);
	          }
	        }
	        function successAdapter(val, nodeback) {
	          var promise = this;
	          var receiver = promise._boundTo;
	          var ret = val === undefined ? tryCatch(nodeback).call(receiver, null) : tryCatch(nodeback).call(receiver, null, val);
	          if (ret === errorObj) {
	            async.throwLater(ret.e);
	          }
	        }
	        function errorAdapter(reason, nodeback) {
	          var promise = this;
	          if (!reason) {
	            var target = promise._target();
	            var newReason = target._getCarriedStackTrace();
	            newReason.cause = reason;
	            reason = newReason;
	          }
	          var ret = tryCatch(nodeback).call(promise._boundTo, reason);
	          if (ret === errorObj) {
	            async.throwLater(ret.e);
	          }
	        }
	        Promise.prototype.nodeify = function(nodeback, options) {
	          if (typeof nodeback == "function") {
	            var adapter = successAdapter;
	            if (options !== undefined && Object(options).spread) {
	              adapter = spreadAdapter;
	            }
	            this._then(adapter, errorAdapter, undefined, this, nodeback);
	          }
	          return this;
	        };
	      };
	    }, {
	      "./async.js": 2,
	      "./util.js": 38
	    }],
	    22: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, PromiseArray) {
	        var util = _dereq_("./util.js");
	        var async = _dereq_("./async.js");
	        var tryCatch = util.tryCatch;
	        var errorObj = util.errorObj;
	        Promise.prototype.progressed = function(handler) {
	          return this._then(undefined, undefined, handler, undefined, undefined);
	        };
	        Promise.prototype._progress = function(progressValue) {
	          if (this._isFollowingOrFulfilledOrRejected())
	            return;
	          this._target()._progressUnchecked(progressValue);
	        };
	        Promise.prototype._progressHandlerAt = function(index) {
	          return index === 0 ? this._progressHandler0 : this[(index << 2) + index - 5 + 2];
	        };
	        Promise.prototype._doProgressWith = function(progression) {
	          var progressValue = progression.value;
	          var handler = progression.handler;
	          var promise = progression.promise;
	          var receiver = progression.receiver;
	          var ret = tryCatch(handler).call(receiver, progressValue);
	          if (ret === errorObj) {
	            if (ret.e != null && ret.e.name !== "StopProgressPropagation") {
	              var trace = util.canAttachTrace(ret.e) ? ret.e : new Error(util.toString(ret.e));
	              promise._attachExtraTrace(trace);
	              promise._progress(ret.e);
	            }
	          } else if (ret instanceof Promise) {
	            ret._then(promise._progress, null, null, promise, undefined);
	          } else {
	            promise._progress(ret);
	          }
	        };
	        Promise.prototype._progressUnchecked = function(progressValue) {
	          var len = this._length();
	          var progress = this._progress;
	          for (var i = 0; i < len; i++) {
	            var handler = this._progressHandlerAt(i);
	            var promise = this._promiseAt(i);
	            if (!(promise instanceof Promise)) {
	              var receiver = this._receiverAt(i);
	              if (typeof handler === "function") {
	                handler.call(receiver, progressValue, promise);
	              } else if (receiver instanceof PromiseArray && !receiver._isResolved()) {
	                receiver._promiseProgressed(progressValue, promise);
	              }
	              continue;
	            }
	            if (typeof handler === "function") {
	              async.invoke(this._doProgressWith, this, {
	                handler: handler,
	                promise: promise,
	                receiver: this._receiverAt(i),
	                value: progressValue
	              });
	            } else {
	              async.invoke(progress, promise, progressValue);
	            }
	          }
	        };
	      };
	    }, {
	      "./async.js": 2,
	      "./util.js": 38
	    }],
	    23: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function() {
	        var makeSelfResolutionError = function() {
	          return new TypeError("circular promise resolution chain\u000a\u000a    See http://goo.gl/LhFpo0\u000a");
	        };
	        var reflect = function() {
	          return new Promise.PromiseInspection(this._target());
	        };
	        var apiRejection = function(msg) {
	          return Promise.reject(new TypeError(msg));
	        };
	        var util = _dereq_("./util.js");
	        var async = _dereq_("./async.js");
	        var errors = _dereq_("./errors.js");
	        var TypeError = Promise.TypeError = errors.TypeError;
	        Promise.RangeError = errors.RangeError;
	        Promise.CancellationError = errors.CancellationError;
	        Promise.TimeoutError = errors.TimeoutError;
	        Promise.OperationalError = errors.OperationalError;
	        Promise.RejectionError = errors.OperationalError;
	        Promise.AggregateError = errors.AggregateError;
	        var INTERNAL = function() {};
	        var APPLY = {};
	        var NEXT_FILTER = {e: null};
	        var tryConvertToPromise = _dereq_("./thenables.js")(Promise, INTERNAL);
	        var PromiseArray = _dereq_("./promise_array.js")(Promise, INTERNAL, tryConvertToPromise, apiRejection);
	        var CapturedTrace = _dereq_("./captured_trace.js")();
	        var isDebugging = _dereq_("./debuggability.js")(Promise, CapturedTrace);
	        var createContext = _dereq_("./context.js")(Promise, CapturedTrace, isDebugging);
	        var CatchFilter = _dereq_("./catch_filter.js")(NEXT_FILTER);
	        var PromiseResolver = _dereq_("./promise_resolver.js");
	        var nodebackForPromise = PromiseResolver._nodebackForPromise;
	        var errorObj = util.errorObj;
	        var tryCatch = util.tryCatch;
	        function Promise(resolver) {
	          if (typeof resolver !== "function") {
	            throw new TypeError("the promise constructor requires a resolver function\u000a\u000a    See http://goo.gl/EC22Yn\u000a");
	          }
	          if (this.constructor !== Promise) {
	            throw new TypeError("the promise constructor cannot be invoked directly\u000a\u000a    See http://goo.gl/KsIlge\u000a");
	          }
	          this._bitField = 0;
	          this._fulfillmentHandler0 = undefined;
	          this._rejectionHandler0 = undefined;
	          this._progressHandler0 = undefined;
	          this._promise0 = undefined;
	          this._receiver0 = undefined;
	          this._settledValue = undefined;
	          if (resolver !== INTERNAL)
	            this._resolveFromResolver(resolver);
	        }
	        Promise.prototype.toString = function() {
	          return "[object Promise]";
	        };
	        Promise.prototype.caught = Promise.prototype["catch"] = function(fn) {
	          var len = arguments.length;
	          if (len > 1) {
	            var catchInstances = new Array(len - 1),
	                j = 0,
	                i;
	            for (i = 0; i < len - 1; ++i) {
	              var item = arguments[i];
	              if (typeof item === "function") {
	                catchInstances[j++] = item;
	              } else {
	                return Promise.reject(new TypeError("Catch filter must inherit from Error or be a simple predicate function\u000a\u000a    See http://goo.gl/o84o68\u000a"));
	              }
	            }
	            catchInstances.length = j;
	            fn = arguments[i];
	            var catchFilter = new CatchFilter(catchInstances, fn, this);
	            return this._then(undefined, catchFilter.doFilter, undefined, catchFilter, undefined);
	          }
	          return this._then(undefined, fn, undefined, undefined, undefined);
	        };
	        Promise.prototype.reflect = function() {
	          return this._then(reflect, reflect, undefined, this, undefined);
	        };
	        Promise.prototype.then = function(didFulfill, didReject, didProgress) {
	          if (isDebugging() && arguments.length > 0 && typeof didFulfill !== "function" && typeof didReject !== "function") {
	            var msg = ".then() only accepts functions but was passed: " + util.classString(didFulfill);
	            if (arguments.length > 1) {
	              msg += ", " + util.classString(didReject);
	            }
	            this._warn(msg);
	          }
	          return this._then(didFulfill, didReject, didProgress, undefined, undefined);
	        };
	        Promise.prototype.done = function(didFulfill, didReject, didProgress) {
	          var promise = this._then(didFulfill, didReject, didProgress, undefined, undefined);
	          promise._setIsFinal();
	        };
	        Promise.prototype.spread = function(didFulfill, didReject) {
	          return this.all()._then(didFulfill, didReject, undefined, APPLY, undefined);
	        };
	        Promise.prototype.isCancellable = function() {
	          return !this.isResolved() && this._cancellable();
	        };
	        Promise.prototype.toJSON = function() {
	          var ret = {
	            isFulfilled: false,
	            isRejected: false,
	            fulfillmentValue: undefined,
	            rejectionReason: undefined
	          };
	          if (this.isFulfilled()) {
	            ret.fulfillmentValue = this.value();
	            ret.isFulfilled = true;
	          } else if (this.isRejected()) {
	            ret.rejectionReason = this.reason();
	            ret.isRejected = true;
	          }
	          return ret;
	        };
	        Promise.prototype.all = function() {
	          return new PromiseArray(this).promise();
	        };
	        Promise.prototype.error = function(fn) {
	          return this.caught(util.originatesFromRejection, fn);
	        };
	        Promise.is = function(val) {
	          return val instanceof Promise;
	        };
	        Promise.fromNode = function(fn) {
	          var ret = new Promise(INTERNAL);
	          var result = tryCatch(fn)(nodebackForPromise(ret));
	          if (result === errorObj) {
	            ret._rejectCallback(result.e, true, true);
	          }
	          return ret;
	        };
	        Promise.all = function(promises) {
	          return new PromiseArray(promises).promise();
	        };
	        Promise.defer = Promise.pending = function() {
	          var promise = new Promise(INTERNAL);
	          return new PromiseResolver(promise);
	        };
	        Promise.cast = function(obj) {
	          var ret = tryConvertToPromise(obj);
	          if (!(ret instanceof Promise)) {
	            var val = ret;
	            ret = new Promise(INTERNAL);
	            ret._fulfillUnchecked(val);
	          }
	          return ret;
	        };
	        Promise.resolve = Promise.fulfilled = Promise.cast;
	        Promise.reject = Promise.rejected = function(reason) {
	          var ret = new Promise(INTERNAL);
	          ret._captureStackTrace();
	          ret._rejectCallback(reason, true);
	          return ret;
	        };
	        Promise.setScheduler = function(fn) {
	          if (typeof fn !== "function")
	            throw new TypeError("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          var prev = async._schedule;
	          async._schedule = fn;
	          return prev;
	        };
	        Promise.prototype._then = function(didFulfill, didReject, didProgress, receiver, internalData) {
	          var haveInternalData = internalData !== undefined;
	          var ret = haveInternalData ? internalData : new Promise(INTERNAL);
	          if (!haveInternalData) {
	            ret._propagateFrom(this, 4 | 1);
	            ret._captureStackTrace();
	          }
	          var target = this._target();
	          if (target !== this) {
	            if (receiver === undefined)
	              receiver = this._boundTo;
	            if (!haveInternalData)
	              ret._setIsMigrated();
	          }
	          var callbackIndex = target._addCallbacks(didFulfill, didReject, didProgress, ret, receiver);
	          if (target._isResolved() && !target._isSettlePromisesQueued()) {
	            async.invoke(target._settlePromiseAtPostResolution, target, callbackIndex);
	          }
	          return ret;
	        };
	        Promise.prototype._settlePromiseAtPostResolution = function(index) {
	          if (this._isRejectionUnhandled())
	            this._unsetRejectionIsUnhandled();
	          this._settlePromiseAt(index);
	        };
	        Promise.prototype._length = function() {
	          return this._bitField & 131071;
	        };
	        Promise.prototype._isFollowingOrFulfilledOrRejected = function() {
	          return (this._bitField & 939524096) > 0;
	        };
	        Promise.prototype._isFollowing = function() {
	          return (this._bitField & 536870912) === 536870912;
	        };
	        Promise.prototype._setLength = function(len) {
	          this._bitField = (this._bitField & -131072) | (len & 131071);
	        };
	        Promise.prototype._setFulfilled = function() {
	          this._bitField = this._bitField | 268435456;
	        };
	        Promise.prototype._setRejected = function() {
	          this._bitField = this._bitField | 134217728;
	        };
	        Promise.prototype._setFollowing = function() {
	          this._bitField = this._bitField | 536870912;
	        };
	        Promise.prototype._setIsFinal = function() {
	          this._bitField = this._bitField | 33554432;
	        };
	        Promise.prototype._isFinal = function() {
	          return (this._bitField & 33554432) > 0;
	        };
	        Promise.prototype._cancellable = function() {
	          return (this._bitField & 67108864) > 0;
	        };
	        Promise.prototype._setCancellable = function() {
	          this._bitField = this._bitField | 67108864;
	        };
	        Promise.prototype._unsetCancellable = function() {
	          this._bitField = this._bitField & (~67108864);
	        };
	        Promise.prototype._setIsMigrated = function() {
	          this._bitField = this._bitField | 4194304;
	        };
	        Promise.prototype._unsetIsMigrated = function() {
	          this._bitField = this._bitField & (~4194304);
	        };
	        Promise.prototype._isMigrated = function() {
	          return (this._bitField & 4194304) > 0;
	        };
	        Promise.prototype._receiverAt = function(index) {
	          var ret = index === 0 ? this._receiver0 : this[index * 5 - 5 + 4];
	          if (ret === undefined && this._isBound()) {
	            return this._boundTo;
	          }
	          return ret;
	        };
	        Promise.prototype._promiseAt = function(index) {
	          return index === 0 ? this._promise0 : this[index * 5 - 5 + 3];
	        };
	        Promise.prototype._fulfillmentHandlerAt = function(index) {
	          return index === 0 ? this._fulfillmentHandler0 : this[index * 5 - 5 + 0];
	        };
	        Promise.prototype._rejectionHandlerAt = function(index) {
	          return index === 0 ? this._rejectionHandler0 : this[index * 5 - 5 + 1];
	        };
	        Promise.prototype._migrateCallbacks = function(follower, index) {
	          var fulfill = follower._fulfillmentHandlerAt(index);
	          var reject = follower._rejectionHandlerAt(index);
	          var progress = follower._progressHandlerAt(index);
	          var promise = follower._promiseAt(index);
	          var receiver = follower._receiverAt(index);
	          if (promise instanceof Promise)
	            promise._setIsMigrated();
	          this._addCallbacks(fulfill, reject, progress, promise, receiver);
	        };
	        Promise.prototype._addCallbacks = function(fulfill, reject, progress, promise, receiver) {
	          var index = this._length();
	          if (index >= 131071 - 5) {
	            index = 0;
	            this._setLength(0);
	          }
	          if (index === 0) {
	            this._promise0 = promise;
	            if (receiver !== undefined)
	              this._receiver0 = receiver;
	            if (typeof fulfill === "function" && !this._isCarryingStackTrace())
	              this._fulfillmentHandler0 = fulfill;
	            if (typeof reject === "function")
	              this._rejectionHandler0 = reject;
	            if (typeof progress === "function")
	              this._progressHandler0 = progress;
	          } else {
	            var base = index * 5 - 5;
	            this[base + 3] = promise;
	            this[base + 4] = receiver;
	            if (typeof fulfill === "function")
	              this[base + 0] = fulfill;
	            if (typeof reject === "function")
	              this[base + 1] = reject;
	            if (typeof progress === "function")
	              this[base + 2] = progress;
	          }
	          this._setLength(index + 1);
	          return index;
	        };
	        Promise.prototype._setProxyHandlers = function(receiver, promiseSlotValue) {
	          var index = this._length();
	          if (index >= 131071 - 5) {
	            index = 0;
	            this._setLength(0);
	          }
	          if (index === 0) {
	            this._promise0 = promiseSlotValue;
	            this._receiver0 = receiver;
	          } else {
	            var base = index * 5 - 5;
	            this[base + 3] = promiseSlotValue;
	            this[base + 4] = receiver;
	          }
	          this._setLength(index + 1);
	        };
	        Promise.prototype._proxyPromiseArray = function(promiseArray, index) {
	          this._setProxyHandlers(promiseArray, index);
	        };
	        Promise.prototype._resolveCallback = function(value, shouldBind) {
	          if (this._isFollowingOrFulfilledOrRejected())
	            return;
	          if (value === this)
	            return this._rejectCallback(makeSelfResolutionError(), false, true);
	          var maybePromise = tryConvertToPromise(value, this);
	          if (!(maybePromise instanceof Promise))
	            return this._fulfill(value);
	          var propagationFlags = 1 | (shouldBind ? 4 : 0);
	          this._propagateFrom(maybePromise, propagationFlags);
	          var promise = maybePromise._target();
	          if (promise._isPending()) {
	            var len = this._length();
	            for (var i = 0; i < len; ++i) {
	              promise._migrateCallbacks(this, i);
	            }
	            this._setFollowing();
	            this._setLength(0);
	            this._setFollowee(promise);
	          } else if (promise._isFulfilled()) {
	            this._fulfillUnchecked(promise._value());
	          } else {
	            this._rejectUnchecked(promise._reason(), promise._getCarriedStackTrace());
	          }
	        };
	        Promise.prototype._rejectCallback = function(reason, synchronous, shouldNotMarkOriginatingFromRejection) {
	          if (!shouldNotMarkOriginatingFromRejection) {
	            util.markAsOriginatingFromRejection(reason);
	          }
	          var trace = util.ensureErrorObject(reason);
	          var hasStack = trace === reason;
	          this._attachExtraTrace(trace, synchronous ? hasStack : false);
	          this._reject(reason, hasStack ? undefined : trace);
	        };
	        Promise.prototype._resolveFromResolver = function(resolver) {
	          var promise = this;
	          this._captureStackTrace();
	          this._pushContext();
	          var synchronous = true;
	          var r = tryCatch(resolver)(function(value) {
	            if (promise === null)
	              return;
	            promise._resolveCallback(value);
	            promise = null;
	          }, function(reason) {
	            if (promise === null)
	              return;
	            promise._rejectCallback(reason, synchronous);
	            promise = null;
	          });
	          synchronous = false;
	          this._popContext();
	          if (r !== undefined && r === errorObj && promise !== null) {
	            promise._rejectCallback(r.e, true, true);
	            promise = null;
	          }
	        };
	        Promise.prototype._settlePromiseFromHandler = function(handler, receiver, value, promise) {
	          if (promise._isRejected())
	            return;
	          promise._pushContext();
	          var x;
	          if (receiver === APPLY && !this._isRejected()) {
	            x = tryCatch(handler).apply(this._boundTo, value);
	          } else {
	            x = tryCatch(handler).call(receiver, value);
	          }
	          promise._popContext();
	          if (x === errorObj || x === promise || x === NEXT_FILTER) {
	            var err = x === promise ? makeSelfResolutionError() : x.e;
	            promise._rejectCallback(err, false, true);
	          } else {
	            promise._resolveCallback(x);
	          }
	        };
	        Promise.prototype._target = function() {
	          var ret = this;
	          while (ret._isFollowing())
	            ret = ret._followee();
	          return ret;
	        };
	        Promise.prototype._followee = function() {
	          return this._rejectionHandler0;
	        };
	        Promise.prototype._setFollowee = function(promise) {
	          this._rejectionHandler0 = promise;
	        };
	        Promise.prototype._cleanValues = function() {
	          if (this._cancellable()) {
	            this._cancellationParent = undefined;
	          }
	        };
	        Promise.prototype._propagateFrom = function(parent, flags) {
	          if ((flags & 1) > 0 && parent._cancellable()) {
	            this._setCancellable();
	            this._cancellationParent = parent;
	          }
	          if ((flags & 4) > 0 && parent._isBound()) {
	            this._setBoundTo(parent._boundTo);
	          }
	        };
	        Promise.prototype._fulfill = function(value) {
	          if (this._isFollowingOrFulfilledOrRejected())
	            return;
	          this._fulfillUnchecked(value);
	        };
	        Promise.prototype._reject = function(reason, carriedStackTrace) {
	          if (this._isFollowingOrFulfilledOrRejected())
	            return;
	          this._rejectUnchecked(reason, carriedStackTrace);
	        };
	        Promise.prototype._settlePromiseAt = function(index) {
	          var promise = this._promiseAt(index);
	          var isPromise = promise instanceof Promise;
	          if (isPromise && promise._isMigrated()) {
	            promise._unsetIsMigrated();
	            return async.invoke(this._settlePromiseAt, this, index);
	          }
	          var handler = this._isFulfilled() ? this._fulfillmentHandlerAt(index) : this._rejectionHandlerAt(index);
	          var carriedStackTrace = this._isCarryingStackTrace() ? this._getCarriedStackTrace() : undefined;
	          var value = this._settledValue;
	          var receiver = this._receiverAt(index);
	          this._clearCallbackDataAtIndex(index);
	          if (typeof handler === "function") {
	            if (!isPromise) {
	              handler.call(receiver, value, promise);
	            } else {
	              this._settlePromiseFromHandler(handler, receiver, value, promise);
	            }
	          } else if (receiver instanceof PromiseArray) {
	            if (!receiver._isResolved()) {
	              if (this._isFulfilled()) {
	                receiver._promiseFulfilled(value, promise);
	              } else {
	                receiver._promiseRejected(value, promise);
	              }
	            }
	          } else if (isPromise) {
	            if (this._isFulfilled()) {
	              promise._fulfill(value);
	            } else {
	              promise._reject(value, carriedStackTrace);
	            }
	          }
	          if (index >= 4 && (index & 31) === 4)
	            async.invokeLater(this._setLength, this, 0);
	        };
	        Promise.prototype._clearCallbackDataAtIndex = function(index) {
	          if (index === 0) {
	            if (!this._isCarryingStackTrace()) {
	              this._fulfillmentHandler0 = undefined;
	            }
	            this._rejectionHandler0 = this._progressHandler0 = this._receiver0 = this._promise0 = undefined;
	          } else {
	            var base = index * 5 - 5;
	            this[base + 3] = this[base + 4] = this[base + 0] = this[base + 1] = this[base + 2] = undefined;
	          }
	        };
	        Promise.prototype._isSettlePromisesQueued = function() {
	          return (this._bitField & -1073741824) === -1073741824;
	        };
	        Promise.prototype._setSettlePromisesQueued = function() {
	          this._bitField = this._bitField | -1073741824;
	        };
	        Promise.prototype._unsetSettlePromisesQueued = function() {
	          this._bitField = this._bitField & (~-1073741824);
	        };
	        Promise.prototype._queueSettlePromises = function() {
	          async.settlePromises(this);
	          this._setSettlePromisesQueued();
	        };
	        Promise.prototype._fulfillUnchecked = function(value) {
	          if (value === this) {
	            var err = makeSelfResolutionError();
	            this._attachExtraTrace(err);
	            return this._rejectUnchecked(err, undefined);
	          }
	          this._setFulfilled();
	          this._settledValue = value;
	          this._cleanValues();
	          if (this._length() > 0) {
	            this._queueSettlePromises();
	          }
	        };
	        Promise.prototype._rejectUncheckedCheckError = function(reason) {
	          var trace = util.ensureErrorObject(reason);
	          this._rejectUnchecked(reason, trace === reason ? undefined : trace);
	        };
	        Promise.prototype._rejectUnchecked = function(reason, trace) {
	          if (reason === this) {
	            var err = makeSelfResolutionError();
	            this._attachExtraTrace(err);
	            return this._rejectUnchecked(err);
	          }
	          this._setRejected();
	          this._settledValue = reason;
	          this._cleanValues();
	          if (this._isFinal()) {
	            async.throwLater(function(e) {
	              if ("stack" in e) {
	                async.invokeFirst(CapturedTrace.unhandledRejection, undefined, e);
	              }
	              throw e;
	            }, trace === undefined ? reason : trace);
	            return;
	          }
	          if (trace !== undefined && trace !== reason) {
	            this._setCarriedStackTrace(trace);
	          }
	          if (this._length() > 0) {
	            this._queueSettlePromises();
	          } else {
	            this._ensurePossibleRejectionHandled();
	          }
	        };
	        Promise.prototype._settlePromises = function() {
	          this._unsetSettlePromisesQueued();
	          var len = this._length();
	          for (var i = 0; i < len; i++) {
	            this._settlePromiseAt(i);
	          }
	        };
	        Promise._makeSelfResolutionError = makeSelfResolutionError;
	        _dereq_("./method.js")(Promise, INTERNAL, tryConvertToPromise, apiRejection);
	        _dereq_("./bind.js")(Promise, INTERNAL, tryConvertToPromise);
	        _dereq_("./finally.js")(Promise, NEXT_FILTER, tryConvertToPromise);
	        _dereq_("./direct_resolve.js")(Promise);
	        _dereq_("./synchronous_inspection.js")(Promise);
	        _dereq_("./join.js")(Promise, PromiseArray, tryConvertToPromise, INTERNAL);
	        Promise.Promise = Promise;
	        _dereq_('./map.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL);
	        _dereq_('./using.js')(Promise, apiRejection, tryConvertToPromise, createContext);
	        _dereq_('./generators.js')(Promise, apiRejection, INTERNAL, tryConvertToPromise);
	        _dereq_('./nodeify.js')(Promise);
	        _dereq_('./cancel.js')(Promise);
	        _dereq_('./promisify.js')(Promise, INTERNAL);
	        _dereq_('./props.js')(Promise, PromiseArray, tryConvertToPromise, apiRejection);
	        _dereq_('./race.js')(Promise, INTERNAL, tryConvertToPromise, apiRejection);
	        _dereq_('./reduce.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL);
	        _dereq_('./settle.js')(Promise, PromiseArray);
	        _dereq_('./call_get.js')(Promise);
	        _dereq_('./some.js')(Promise, PromiseArray, apiRejection);
	        _dereq_('./progress.js')(Promise, PromiseArray);
	        _dereq_('./any.js')(Promise);
	        _dereq_('./each.js')(Promise, INTERNAL);
	        _dereq_('./timers.js')(Promise, INTERNAL);
	        _dereq_('./filter.js')(Promise, INTERNAL);
	        util.toFastProperties(Promise);
	        util.toFastProperties(Promise.prototype);
	        function fillTypes(value) {
	          var p = new Promise(INTERNAL);
	          p._fulfillmentHandler0 = value;
	          p._rejectionHandler0 = value;
	          p._progressHandler0 = value;
	          p._promise0 = value;
	          p._receiver0 = value;
	          p._settledValue = value;
	        }
	        fillTypes({a: 1});
	        fillTypes({b: 2});
	        fillTypes({c: 3});
	        fillTypes(1);
	        fillTypes(function() {});
	        fillTypes(undefined);
	        fillTypes(false);
	        fillTypes(new Promise(INTERNAL));
	        CapturedTrace.setBounds(async.firstLineError, util.lastLineError);
	        return Promise;
	      };
	    }, {
	      "./any.js": 1,
	      "./async.js": 2,
	      "./bind.js": 3,
	      "./call_get.js": 5,
	      "./cancel.js": 6,
	      "./captured_trace.js": 7,
	      "./catch_filter.js": 8,
	      "./context.js": 9,
	      "./debuggability.js": 10,
	      "./direct_resolve.js": 11,
	      "./each.js": 12,
	      "./errors.js": 13,
	      "./filter.js": 15,
	      "./finally.js": 16,
	      "./generators.js": 17,
	      "./join.js": 18,
	      "./map.js": 19,
	      "./method.js": 20,
	      "./nodeify.js": 21,
	      "./progress.js": 22,
	      "./promise_array.js": 24,
	      "./promise_resolver.js": 25,
	      "./promisify.js": 26,
	      "./props.js": 27,
	      "./race.js": 29,
	      "./reduce.js": 30,
	      "./settle.js": 32,
	      "./some.js": 33,
	      "./synchronous_inspection.js": 34,
	      "./thenables.js": 35,
	      "./timers.js": 36,
	      "./using.js": 37,
	      "./util.js": 38
	    }],
	    24: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL, tryConvertToPromise, apiRejection) {
	        var util = _dereq_("./util.js");
	        var isArray = util.isArray;
	        function toResolutionValue(val) {
	          switch (val) {
	            case -2:
	              return [];
	            case -3:
	              return {};
	          }
	        }
	        function PromiseArray(values) {
	          var promise = this._promise = new Promise(INTERNAL);
	          var parent;
	          if (values instanceof Promise) {
	            parent = values;
	            promise._propagateFrom(parent, 1 | 4);
	          }
	          this._values = values;
	          this._length = 0;
	          this._totalResolved = 0;
	          this._init(undefined, -2);
	        }
	        PromiseArray.prototype.length = function() {
	          return this._length;
	        };
	        PromiseArray.prototype.promise = function() {
	          return this._promise;
	        };
	        PromiseArray.prototype._init = function init(_, resolveValueIfEmpty) {
	          var values = tryConvertToPromise(this._values, this._promise);
	          if (values instanceof Promise) {
	            values = values._target();
	            this._values = values;
	            if (values._isFulfilled()) {
	              values = values._value();
	              if (!isArray(values)) {
	                var err = new Promise.TypeError("expecting an array, a promise or a thenable\u000a\u000a    See http://goo.gl/s8MMhc\u000a");
	                this.__hardReject__(err);
	                return;
	              }
	            } else if (values._isPending()) {
	              values._then(init, this._reject, undefined, this, resolveValueIfEmpty);
	              return;
	            } else {
	              this._reject(values._reason());
	              return;
	            }
	          } else if (!isArray(values)) {
	            this._promise._reject(apiRejection("expecting an array, a promise or a thenable\u000a\u000a    See http://goo.gl/s8MMhc\u000a")._reason());
	            return;
	          }
	          if (values.length === 0) {
	            if (resolveValueIfEmpty === -5) {
	              this._resolveEmptyArray();
	            } else {
	              this._resolve(toResolutionValue(resolveValueIfEmpty));
	            }
	            return;
	          }
	          var len = this.getActualLength(values.length);
	          this._length = len;
	          this._values = this.shouldCopyValues() ? new Array(len) : this._values;
	          var promise = this._promise;
	          for (var i = 0; i < len; ++i) {
	            var isResolved = this._isResolved();
	            var maybePromise = tryConvertToPromise(values[i], promise);
	            if (maybePromise instanceof Promise) {
	              maybePromise = maybePromise._target();
	              if (isResolved) {
	                maybePromise._unsetRejectionIsUnhandled();
	              } else if (maybePromise._isPending()) {
	                maybePromise._proxyPromiseArray(this, i);
	              } else if (maybePromise._isFulfilled()) {
	                this._promiseFulfilled(maybePromise._value(), i);
	              } else {
	                this._promiseRejected(maybePromise._reason(), i);
	              }
	            } else if (!isResolved) {
	              this._promiseFulfilled(maybePromise, i);
	            }
	          }
	        };
	        PromiseArray.prototype._isResolved = function() {
	          return this._values === null;
	        };
	        PromiseArray.prototype._resolve = function(value) {
	          this._values = null;
	          this._promise._fulfill(value);
	        };
	        PromiseArray.prototype.__hardReject__ = PromiseArray.prototype._reject = function(reason) {
	          this._values = null;
	          this._promise._rejectCallback(reason, false, true);
	        };
	        PromiseArray.prototype._promiseProgressed = function(progressValue, index) {
	          this._promise._progress({
	            index: index,
	            value: progressValue
	          });
	        };
	        PromiseArray.prototype._promiseFulfilled = function(value, index) {
	          this._values[index] = value;
	          var totalResolved = ++this._totalResolved;
	          if (totalResolved >= this._length) {
	            this._resolve(this._values);
	          }
	        };
	        PromiseArray.prototype._promiseRejected = function(reason, index) {
	          this._totalResolved++;
	          this._reject(reason);
	        };
	        PromiseArray.prototype.shouldCopyValues = function() {
	          return true;
	        };
	        PromiseArray.prototype.getActualLength = function(len) {
	          return len;
	        };
	        return PromiseArray;
	      };
	    }, {"./util.js": 38}],
	    25: [function(_dereq_, module, exports) {
	      "use strict";
	      var util = _dereq_("./util.js");
	      var maybeWrapAsError = util.maybeWrapAsError;
	      var errors = _dereq_("./errors.js");
	      var TimeoutError = errors.TimeoutError;
	      var OperationalError = errors.OperationalError;
	      var haveGetters = util.haveGetters;
	      var es5 = _dereq_("./es5.js");
	      function isUntypedError(obj) {
	        return obj instanceof Error && es5.getPrototypeOf(obj) === Error.prototype;
	      }
	      var rErrorKey = /^(?:name|message|stack|cause)$/;
	      function wrapAsOperationalError(obj) {
	        var ret;
	        if (isUntypedError(obj)) {
	          ret = new OperationalError(obj);
	          ret.name = obj.name;
	          ret.message = obj.message;
	          ret.stack = obj.stack;
	          var keys = es5.keys(obj);
	          for (var i = 0; i < keys.length; ++i) {
	            var key = keys[i];
	            if (!rErrorKey.test(key)) {
	              ret[key] = obj[key];
	            }
	          }
	          return ret;
	        }
	        util.markAsOriginatingFromRejection(obj);
	        return obj;
	      }
	      function nodebackForPromise(promise) {
	        return function(err, value) {
	          if (promise === null)
	            return;
	          if (err) {
	            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));
	            promise._attachExtraTrace(wrapped);
	            promise._reject(wrapped);
	          } else if (arguments.length > 2) {
	            var $_len = arguments.length;
	            var args = new Array($_len - 1);
	            for (var $_i = 1; $_i < $_len; ++$_i) {
	              args[$_i - 1] = arguments[$_i];
	            }
	            promise._fulfill(args);
	          } else {
	            promise._fulfill(value);
	          }
	          promise = null;
	        };
	      }
	      var PromiseResolver;
	      if (!haveGetters) {
	        PromiseResolver = function(promise) {
	          this.promise = promise;
	          this.asCallback = nodebackForPromise(promise);
	          this.callback = this.asCallback;
	        };
	      } else {
	        PromiseResolver = function(promise) {
	          this.promise = promise;
	        };
	      }
	      if (haveGetters) {
	        var prop = {get: function() {
	            return nodebackForPromise(this.promise);
	          }};
	        es5.defineProperty(PromiseResolver.prototype, "asCallback", prop);
	        es5.defineProperty(PromiseResolver.prototype, "callback", prop);
	      }
	      PromiseResolver._nodebackForPromise = nodebackForPromise;
	      PromiseResolver.prototype.toString = function() {
	        return "[object PromiseResolver]";
	      };
	      PromiseResolver.prototype.resolve = PromiseResolver.prototype.fulfill = function(value) {
	        if (!(this instanceof PromiseResolver)) {
	          throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\u000a\u000a    See http://goo.gl/sdkXL9\u000a");
	        }
	        this.promise._resolveCallback(value);
	      };
	      PromiseResolver.prototype.reject = function(reason) {
	        if (!(this instanceof PromiseResolver)) {
	          throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\u000a\u000a    See http://goo.gl/sdkXL9\u000a");
	        }
	        this.promise._rejectCallback(reason);
	      };
	      PromiseResolver.prototype.progress = function(value) {
	        if (!(this instanceof PromiseResolver)) {
	          throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\u000a\u000a    See http://goo.gl/sdkXL9\u000a");
	        }
	        this.promise._progress(value);
	      };
	      PromiseResolver.prototype.cancel = function(err) {
	        this.promise.cancel(err);
	      };
	      PromiseResolver.prototype.timeout = function() {
	        this.reject(new TimeoutError("timeout"));
	      };
	      PromiseResolver.prototype.isResolved = function() {
	        return this.promise.isResolved();
	      };
	      PromiseResolver.prototype.toJSON = function() {
	        return this.promise.toJSON();
	      };
	      module.exports = PromiseResolver;
	    }, {
	      "./errors.js": 13,
	      "./es5.js": 14,
	      "./util.js": 38
	    }],
	    26: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL) {
	        var THIS = {};
	        var util = _dereq_("./util.js");
	        var nodebackForPromise = _dereq_("./promise_resolver.js")._nodebackForPromise;
	        var withAppended = util.withAppended;
	        var maybeWrapAsError = util.maybeWrapAsError;
	        var canEvaluate = util.canEvaluate;
	        var TypeError = _dereq_("./errors").TypeError;
	        var defaultSuffix = "Async";
	        var defaultPromisified = {__isPromisified__: true};
	        var noCopyPropsPattern = /^(?:length|name|arguments|caller|prototype|__isPromisified__)$/;
	        var defaultFilter = function(name, func) {
	          return util.isIdentifier(name) && name.charAt(0) !== "_" && !util.isClass(func);
	        };
	        function propsFilter(key) {
	          return !noCopyPropsPattern.test(key);
	        }
	        function isPromisified(fn) {
	          try {
	            return fn.__isPromisified__ === true;
	          } catch (e) {
	            return false;
	          }
	        }
	        function hasPromisified(obj, key, suffix) {
	          var val = util.getDataPropertyOrDefault(obj, key + suffix, defaultPromisified);
	          return val ? isPromisified(val) : false;
	        }
	        function checkValid(ret, suffix, suffixRegexp) {
	          for (var i = 0; i < ret.length; i += 2) {
	            var key = ret[i];
	            if (suffixRegexp.test(key)) {
	              var keyWithoutAsyncSuffix = key.replace(suffixRegexp, "");
	              for (var j = 0; j < ret.length; j += 2) {
	                if (ret[j] === keyWithoutAsyncSuffix) {
	                  throw new TypeError("Cannot promisify an API that has normal methods with '%s'-suffix\u000a\u000a    See http://goo.gl/iWrZbw\u000a".replace("%s", suffix));
	                }
	              }
	            }
	          }
	        }
	        function promisifiableMethods(obj, suffix, suffixRegexp, filter) {
	          var keys = util.inheritedDataKeys(obj);
	          var ret = [];
	          for (var i = 0; i < keys.length; ++i) {
	            var key = keys[i];
	            var value = obj[key];
	            var passesDefaultFilter = filter === defaultFilter ? true : defaultFilter(key, value, obj);
	            if (typeof value === "function" && !isPromisified(value) && !hasPromisified(obj, key, suffix) && filter(key, value, obj, passesDefaultFilter)) {
	              ret.push(key, value);
	            }
	          }
	          checkValid(ret, suffix, suffixRegexp);
	          return ret;
	        }
	        var escapeIdentRegex = function(str) {
	          return str.replace(/([$])/, "\\$");
	        };
	        var makeNodePromisifiedEval;
	        if (false) {
	          var switchCaseArgumentOrder = function(likelyArgumentCount) {
	            var ret = [likelyArgumentCount];
	            var min = Math.max(0, likelyArgumentCount - 1 - 3);
	            for (var i = likelyArgumentCount - 1; i >= min; --i) {
	              ret.push(i);
	            }
	            for (var i = likelyArgumentCount + 1; i <= 3; ++i) {
	              ret.push(i);
	            }
	            return ret;
	          };
	          var argumentSequence = function(argumentCount) {
	            return util.filledRange(argumentCount, "_arg", "");
	          };
	          var parameterDeclaration = function(parameterCount) {
	            return util.filledRange(Math.max(parameterCount, 3), "_arg", "");
	          };
	          var parameterCount = function(fn) {
	            if (typeof fn.length === "number") {
	              return Math.max(Math.min(fn.length, 1023 + 1), 0);
	            }
	            return 0;
	          };
	          makeNodePromisifiedEval = function(callback, receiver, originalName, fn) {
	            var newParameterCount = Math.max(0, parameterCount(fn) - 1);
	            var argumentOrder = switchCaseArgumentOrder(newParameterCount);
	            var shouldProxyThis = typeof callback === "string" || receiver === THIS;
	            function generateCallForArgumentCount(count) {
	              var args = argumentSequence(count).join(", ");
	              var comma = count > 0 ? ", " : "";
	              var ret;
	              if (shouldProxyThis) {
	                ret = "ret = callback.call(this, {{args}}, nodeback); break;\n";
	              } else {
	                ret = receiver === undefined ? "ret = callback({{args}}, nodeback); break;\n" : "ret = callback.call(receiver, {{args}}, nodeback); break;\n";
	              }
	              return ret.replace("{{args}}", args).replace(", ", comma);
	            }
	            function generateArgumentSwitchCase() {
	              var ret = "";
	              for (var i = 0; i < argumentOrder.length; ++i) {
	                ret += "case " + argumentOrder[i] + ":" + generateCallForArgumentCount(argumentOrder[i]);
	              }
	              ret += "                                                             \n\
	        default:                                                             \n\
	            var args = new Array(len + 1);                                   \n\
	            var i = 0;                                                       \n\
	            for (var i = 0; i < len; ++i) {                                  \n\
	               args[i] = arguments[i];                                       \n\
	            }                                                                \n\
	            args[i] = nodeback;                                              \n\
	            [CodeForCall]                                                    \n\
	            break;                                                           \n\
	        ".replace("[CodeForCall]", (shouldProxyThis ? "ret = callback.apply(this, args);\n" : "ret = callback.apply(receiver, args);\n"));
	              return ret;
	            }
	            var getFunctionCode = typeof callback === "string" ? ("this != null ? this['" + callback + "'] : fn") : "fn";
	            return new Function("Promise", "fn", "receiver", "withAppended", "maybeWrapAsError", "nodebackForPromise", "tryCatch", "errorObj", "INTERNAL", "'use strict';                            \n\
	        var ret = function (Parameters) {                                    \n\
	            'use strict';                                                    \n\
	            var len = arguments.length;                                      \n\
	            var promise = new Promise(INTERNAL);                             \n\
	            promise._captureStackTrace();                                    \n\
	            var nodeback = nodebackForPromise(promise);                      \n\
	            var ret;                                                         \n\
	            var callback = tryCatch([GetFunctionCode]);                      \n\
	            switch(len) {                                                    \n\
	                [CodeForSwitchCase]                                          \n\
	            }                                                                \n\
	            if (ret === errorObj) {                                          \n\
	                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\
	            }                                                                \n\
	            return promise;                                                  \n\
	        };                                                                   \n\
	        ret.__isPromisified__ = true;                                        \n\
	        return ret;                                                          \n\
	        ".replace("Parameters", parameterDeclaration(newParameterCount)).replace("[CodeForSwitchCase]", generateArgumentSwitchCase()).replace("[GetFunctionCode]", getFunctionCode))(Promise, fn, receiver, withAppended, maybeWrapAsError, nodebackForPromise, util.tryCatch, util.errorObj, INTERNAL);
	          };
	        }
	        function makeNodePromisifiedClosure(callback, receiver, _, fn) {
	          var defaultThis = (function() {
	            return this;
	          })();
	          var method = callback;
	          if (typeof method === "string") {
	            callback = fn;
	          }
	          function promisified() {
	            var _receiver = receiver;
	            if (receiver === THIS)
	              _receiver = this;
	            var promise = new Promise(INTERNAL);
	            promise._captureStackTrace();
	            var cb = typeof method === "string" && this !== defaultThis ? this[method] : callback;
	            var fn = nodebackForPromise(promise);
	            try {
	              cb.apply(_receiver, withAppended(arguments, fn));
	            } catch (e) {
	              promise._rejectCallback(maybeWrapAsError(e), true, true);
	            }
	            return promise;
	          }
	          promisified.__isPromisified__ = true;
	          return promisified;
	        }
	        var makeNodePromisified = canEvaluate ? makeNodePromisifiedEval : makeNodePromisifiedClosure;
	        function promisifyAll(obj, suffix, filter, promisifier) {
	          var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + "$");
	          var methods = promisifiableMethods(obj, suffix, suffixRegexp, filter);
	          for (var i = 0,
	              len = methods.length; i < len; i += 2) {
	            var key = methods[i];
	            var fn = methods[i + 1];
	            var promisifiedKey = key + suffix;
	            obj[promisifiedKey] = promisifier === makeNodePromisified ? makeNodePromisified(key, THIS, key, fn, suffix) : promisifier(fn, function() {
	              return makeNodePromisified(key, THIS, key, fn, suffix);
	            });
	          }
	          util.toFastProperties(obj);
	          return obj;
	        }
	        function promisify(callback, receiver) {
	          return makeNodePromisified(callback, receiver, undefined, callback);
	        }
	        Promise.promisify = function(fn, receiver) {
	          if (typeof fn !== "function") {
	            throw new TypeError("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          }
	          if (isPromisified(fn)) {
	            return fn;
	          }
	          var ret = promisify(fn, arguments.length < 2 ? THIS : receiver);
	          util.copyDescriptors(fn, ret, propsFilter);
	          return ret;
	        };
	        Promise.promisifyAll = function(target, options) {
	          if (typeof target !== "function" && typeof target !== "object") {
	            throw new TypeError("the target of promisifyAll must be an object or a function\u000a\u000a    See http://goo.gl/9ITlV0\u000a");
	          }
	          options = Object(options);
	          var suffix = options.suffix;
	          if (typeof suffix !== "string")
	            suffix = defaultSuffix;
	          var filter = options.filter;
	          if (typeof filter !== "function")
	            filter = defaultFilter;
	          var promisifier = options.promisifier;
	          if (typeof promisifier !== "function")
	            promisifier = makeNodePromisified;
	          if (!util.isIdentifier(suffix)) {
	            throw new RangeError("suffix must be a valid identifier\u000a\u000a    See http://goo.gl/8FZo5V\u000a");
	          }
	          var keys = util.inheritedDataKeys(target);
	          for (var i = 0; i < keys.length; ++i) {
	            var value = target[keys[i]];
	            if (keys[i] !== "constructor" && util.isClass(value)) {
	              promisifyAll(value.prototype, suffix, filter, promisifier);
	              promisifyAll(value, suffix, filter, promisifier);
	            }
	          }
	          return promisifyAll(target, suffix, filter, promisifier);
	        };
	      };
	    }, {
	      "./errors": 13,
	      "./promise_resolver.js": 25,
	      "./util.js": 38
	    }],
	    27: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, PromiseArray, tryConvertToPromise, apiRejection) {
	        var util = _dereq_("./util.js");
	        var isObject = util.isObject;
	        var es5 = _dereq_("./es5.js");
	        function PropertiesPromiseArray(obj) {
	          var keys = es5.keys(obj);
	          var len = keys.length;
	          var values = new Array(len * 2);
	          for (var i = 0; i < len; ++i) {
	            var key = keys[i];
	            values[i] = obj[key];
	            values[i + len] = key;
	          }
	          this.constructor$(values);
	        }
	        util.inherits(PropertiesPromiseArray, PromiseArray);
	        PropertiesPromiseArray.prototype._init = function() {
	          this._init$(undefined, -3);
	        };
	        PropertiesPromiseArray.prototype._promiseFulfilled = function(value, index) {
	          this._values[index] = value;
	          var totalResolved = ++this._totalResolved;
	          if (totalResolved >= this._length) {
	            var val = {};
	            var keyOffset = this.length();
	            for (var i = 0,
	                len = this.length(); i < len; ++i) {
	              val[this._values[i + keyOffset]] = this._values[i];
	            }
	            this._resolve(val);
	          }
	        };
	        PropertiesPromiseArray.prototype._promiseProgressed = function(value, index) {
	          this._promise._progress({
	            key: this._values[index + this.length()],
	            value: value
	          });
	        };
	        PropertiesPromiseArray.prototype.shouldCopyValues = function() {
	          return false;
	        };
	        PropertiesPromiseArray.prototype.getActualLength = function(len) {
	          return len >> 1;
	        };
	        function props(promises) {
	          var ret;
	          var castValue = tryConvertToPromise(promises);
	          if (!isObject(castValue)) {
	            return apiRejection("cannot await properties of a non-object\u000a\u000a    See http://goo.gl/OsFKC8\u000a");
	          } else if (castValue instanceof Promise) {
	            ret = castValue._then(Promise.props, undefined, undefined, undefined, undefined);
	          } else {
	            ret = new PropertiesPromiseArray(castValue).promise();
	          }
	          if (castValue instanceof Promise) {
	            ret._propagateFrom(castValue, 4);
	          }
	          return ret;
	        }
	        Promise.prototype.props = function() {
	          return props(this);
	        };
	        Promise.props = function(promises) {
	          return props(promises);
	        };
	      };
	    }, {
	      "./es5.js": 14,
	      "./util.js": 38
	    }],
	    28: [function(_dereq_, module, exports) {
	      "use strict";
	      function arrayMove(src, srcIndex, dst, dstIndex, len) {
	        for (var j = 0; j < len; ++j) {
	          dst[j + dstIndex] = src[j + srcIndex];
	          src[j + srcIndex] = void 0;
	        }
	      }
	      function Queue(capacity) {
	        this._capacity = capacity;
	        this._length = 0;
	        this._front = 0;
	      }
	      Queue.prototype._willBeOverCapacity = function(size) {
	        return this._capacity < size;
	      };
	      Queue.prototype._pushOne = function(arg) {
	        var length = this.length();
	        this._checkCapacity(length + 1);
	        var i = (this._front + length) & (this._capacity - 1);
	        this[i] = arg;
	        this._length = length + 1;
	      };
	      Queue.prototype._unshiftOne = function(value) {
	        var capacity = this._capacity;
	        this._checkCapacity(this.length() + 1);
	        var front = this._front;
	        var i = ((((front - 1) & (capacity - 1)) ^ capacity) - capacity);
	        this[i] = value;
	        this._front = i;
	        this._length = this.length() + 1;
	      };
	      Queue.prototype.unshift = function(fn, receiver, arg) {
	        this._unshiftOne(arg);
	        this._unshiftOne(receiver);
	        this._unshiftOne(fn);
	      };
	      Queue.prototype.push = function(fn, receiver, arg) {
	        var length = this.length() + 3;
	        if (this._willBeOverCapacity(length)) {
	          this._pushOne(fn);
	          this._pushOne(receiver);
	          this._pushOne(arg);
	          return;
	        }
	        var j = this._front + length - 3;
	        this._checkCapacity(length);
	        var wrapMask = this._capacity - 1;
	        this[(j + 0) & wrapMask] = fn;
	        this[(j + 1) & wrapMask] = receiver;
	        this[(j + 2) & wrapMask] = arg;
	        this._length = length;
	      };
	      Queue.prototype.shift = function() {
	        var front = this._front,
	            ret = this[front];
	        this[front] = undefined;
	        this._front = (front + 1) & (this._capacity - 1);
	        this._length--;
	        return ret;
	      };
	      Queue.prototype.length = function() {
	        return this._length;
	      };
	      Queue.prototype._checkCapacity = function(size) {
	        if (this._capacity < size) {
	          this._resizeTo(this._capacity << 1);
	        }
	      };
	      Queue.prototype._resizeTo = function(capacity) {
	        var oldCapacity = this._capacity;
	        this._capacity = capacity;
	        var front = this._front;
	        var length = this._length;
	        var moveItemsCount = (front + length) & (oldCapacity - 1);
	        arrayMove(this, 0, this, oldCapacity, moveItemsCount);
	      };
	      module.exports = Queue;
	    }, {}],
	    29: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL, tryConvertToPromise, apiRejection) {
	        var isArray = _dereq_("./util.js").isArray;
	        var raceLater = function(promise) {
	          return promise.then(function(array) {
	            return race(array, promise);
	          });
	        };
	        function race(promises, parent) {
	          var maybePromise = tryConvertToPromise(promises);
	          if (maybePromise instanceof Promise) {
	            return raceLater(maybePromise);
	          } else if (!isArray(promises)) {
	            return apiRejection("expecting an array, a promise or a thenable\u000a\u000a    See http://goo.gl/s8MMhc\u000a");
	          }
	          var ret = new Promise(INTERNAL);
	          if (parent !== undefined) {
	            ret._propagateFrom(parent, 4 | 1);
	          }
	          var fulfill = ret._fulfill;
	          var reject = ret._reject;
	          for (var i = 0,
	              len = promises.length; i < len; ++i) {
	            var val = promises[i];
	            if (val === undefined && !(i in promises)) {
	              continue;
	            }
	            Promise.cast(val)._then(fulfill, reject, undefined, ret, null);
	          }
	          return ret;
	        }
	        Promise.race = function(promises) {
	          return race(promises, undefined);
	        };
	        Promise.prototype.race = function() {
	          return race(this, undefined);
	        };
	      };
	    }, {"./util.js": 38}],
	    30: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL) {
	        var util = _dereq_("./util.js");
	        var tryCatch = util.tryCatch;
	        var errorObj = util.errorObj;
	        function ReductionPromiseArray(promises, fn, accum, _each) {
	          this.constructor$(promises);
	          this._promise._captureStackTrace();
	          this._preservedValues = _each === INTERNAL ? [] : null;
	          this._zerothIsAccum = (accum === undefined);
	          this._gotAccum = false;
	          this._reducingIndex = (this._zerothIsAccum ? 1 : 0);
	          this._valuesPhase = undefined;
	          var maybePromise = tryConvertToPromise(accum, this._promise);
	          var rejected = false;
	          var isPromise = maybePromise instanceof Promise;
	          if (isPromise) {
	            maybePromise = maybePromise._target();
	            if (maybePromise._isPending()) {
	              maybePromise._proxyPromiseArray(this, -1);
	            } else if (maybePromise._isFulfilled()) {
	              accum = maybePromise._value();
	              this._gotAccum = true;
	            } else {
	              this._reject(maybePromise._reason());
	              rejected = true;
	            }
	          }
	          if (!(isPromise || this._zerothIsAccum))
	            this._gotAccum = true;
	          this._callback = fn;
	          this._accum = accum;
	          if (!rejected)
	            this._init$(undefined, -5);
	        }
	        util.inherits(ReductionPromiseArray, PromiseArray);
	        ReductionPromiseArray.prototype._init = function() {};
	        ReductionPromiseArray.prototype._resolveEmptyArray = function() {
	          if (this._gotAccum || this._zerothIsAccum) {
	            this._resolve(this._preservedValues !== null ? [] : this._accum);
	          }
	        };
	        ReductionPromiseArray.prototype._promiseFulfilled = function(value, index) {
	          var values = this._values;
	          values[index] = value;
	          var length = this.length();
	          var preservedValues = this._preservedValues;
	          var isEach = preservedValues !== null;
	          var gotAccum = this._gotAccum;
	          var valuesPhase = this._valuesPhase;
	          var valuesPhaseIndex;
	          if (!valuesPhase) {
	            valuesPhase = this._valuesPhase = new Array(length);
	            for (valuesPhaseIndex = 0; valuesPhaseIndex < length; ++valuesPhaseIndex) {
	              valuesPhase[valuesPhaseIndex] = 0;
	            }
	          }
	          valuesPhaseIndex = valuesPhase[index];
	          if (index === 0 && this._zerothIsAccum) {
	            this._accum = value;
	            this._gotAccum = gotAccum = true;
	            valuesPhase[index] = ((valuesPhaseIndex === 0) ? 1 : 2);
	          } else if (index === -1) {
	            this._accum = value;
	            this._gotAccum = gotAccum = true;
	          } else {
	            if (valuesPhaseIndex === 0) {
	              valuesPhase[index] = 1;
	            } else {
	              valuesPhase[index] = 2;
	              this._accum = value;
	            }
	          }
	          if (!gotAccum)
	            return;
	          var callback = this._callback;
	          var receiver = this._promise._boundTo;
	          var ret;
	          for (var i = this._reducingIndex; i < length; ++i) {
	            valuesPhaseIndex = valuesPhase[i];
	            if (valuesPhaseIndex === 2) {
	              this._reducingIndex = i + 1;
	              continue;
	            }
	            if (valuesPhaseIndex !== 1)
	              return;
	            value = values[i];
	            this._promise._pushContext();
	            if (isEach) {
	              preservedValues.push(value);
	              ret = tryCatch(callback).call(receiver, value, i, length);
	            } else {
	              ret = tryCatch(callback).call(receiver, this._accum, value, i, length);
	            }
	            this._promise._popContext();
	            if (ret === errorObj)
	              return this._reject(ret.e);
	            var maybePromise = tryConvertToPromise(ret, this._promise);
	            if (maybePromise instanceof Promise) {
	              maybePromise = maybePromise._target();
	              if (maybePromise._isPending()) {
	                valuesPhase[i] = 4;
	                return maybePromise._proxyPromiseArray(this, i);
	              } else if (maybePromise._isFulfilled()) {
	                ret = maybePromise._value();
	              } else {
	                return this._reject(maybePromise._reason());
	              }
	            }
	            this._reducingIndex = i + 1;
	            this._accum = ret;
	          }
	          this._resolve(isEach ? preservedValues : this._accum);
	        };
	        function reduce(promises, fn, initialValue, _each) {
	          if (typeof fn !== "function")
	            return apiRejection("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          var array = new ReductionPromiseArray(promises, fn, initialValue, _each);
	          return array.promise();
	        }
	        Promise.prototype.reduce = function(fn, initialValue) {
	          return reduce(this, fn, initialValue, null);
	        };
	        Promise.reduce = function(promises, fn, initialValue, _each) {
	          return reduce(promises, fn, initialValue, _each);
	        };
	      };
	    }, {"./util.js": 38}],
	    31: [function(_dereq_, module, exports) {
	      "use strict";
	      var schedule;
	      if (_dereq_("./util.js").isNode) {
	        var version = process.versions.node.split(".").map(Number);
	        schedule = (version[0] === 0 && version[1] > 10) || (version[0] > 0) ? global.setImmediate : process.nextTick;
	      } else if (typeof MutationObserver !== "undefined") {
	        schedule = function(fn) {
	          var div = document.createElement("div");
	          var observer = new MutationObserver(fn);
	          observer.observe(div, {attributes: true});
	          return function() {
	            div.classList.toggle("foo");
	          };
	        };
	        schedule.isStatic = true;
	      } else if (typeof setTimeout !== "undefined") {
	        schedule = function(fn) {
	          setTimeout(fn, 0);
	        };
	      } else {
	        schedule = function() {
	          throw new Error("No async scheduler available\u000a\u000a    See http://goo.gl/m3OTXk\u000a");
	        };
	      }
	      module.exports = schedule;
	    }, {"./util.js": 38}],
	    32: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, PromiseArray) {
	        var PromiseInspection = Promise.PromiseInspection;
	        var util = _dereq_("./util.js");
	        function SettledPromiseArray(values) {
	          this.constructor$(values);
	        }
	        util.inherits(SettledPromiseArray, PromiseArray);
	        SettledPromiseArray.prototype._promiseResolved = function(index, inspection) {
	          this._values[index] = inspection;
	          var totalResolved = ++this._totalResolved;
	          if (totalResolved >= this._length) {
	            this._resolve(this._values);
	          }
	        };
	        SettledPromiseArray.prototype._promiseFulfilled = function(value, index) {
	          var ret = new PromiseInspection();
	          ret._bitField = 268435456;
	          ret._settledValue = value;
	          this._promiseResolved(index, ret);
	        };
	        SettledPromiseArray.prototype._promiseRejected = function(reason, index) {
	          var ret = new PromiseInspection();
	          ret._bitField = 134217728;
	          ret._settledValue = reason;
	          this._promiseResolved(index, ret);
	        };
	        Promise.settle = function(promises) {
	          return new SettledPromiseArray(promises).promise();
	        };
	        Promise.prototype.settle = function() {
	          return new SettledPromiseArray(this).promise();
	        };
	      };
	    }, {"./util.js": 38}],
	    33: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, PromiseArray, apiRejection) {
	        var util = _dereq_("./util.js");
	        var RangeError = _dereq_("./errors.js").RangeError;
	        var AggregateError = _dereq_("./errors.js").AggregateError;
	        var isArray = util.isArray;
	        function SomePromiseArray(values) {
	          this.constructor$(values);
	          this._howMany = 0;
	          this._unwrap = false;
	          this._initialized = false;
	        }
	        util.inherits(SomePromiseArray, PromiseArray);
	        SomePromiseArray.prototype._init = function() {
	          if (!this._initialized) {
	            return;
	          }
	          if (this._howMany === 0) {
	            this._resolve([]);
	            return;
	          }
	          this._init$(undefined, -5);
	          var isArrayResolved = isArray(this._values);
	          if (!this._isResolved() && isArrayResolved && this._howMany > this._canPossiblyFulfill()) {
	            this._reject(this._getRangeError(this.length()));
	          }
	        };
	        SomePromiseArray.prototype.init = function() {
	          this._initialized = true;
	          this._init();
	        };
	        SomePromiseArray.prototype.setUnwrap = function() {
	          this._unwrap = true;
	        };
	        SomePromiseArray.prototype.howMany = function() {
	          return this._howMany;
	        };
	        SomePromiseArray.prototype.setHowMany = function(count) {
	          this._howMany = count;
	        };
	        SomePromiseArray.prototype._promiseFulfilled = function(value) {
	          this._addFulfilled(value);
	          if (this._fulfilled() === this.howMany()) {
	            this._values.length = this.howMany();
	            if (this.howMany() === 1 && this._unwrap) {
	              this._resolve(this._values[0]);
	            } else {
	              this._resolve(this._values);
	            }
	          }
	        };
	        SomePromiseArray.prototype._promiseRejected = function(reason) {
	          this._addRejected(reason);
	          if (this.howMany() > this._canPossiblyFulfill()) {
	            var e = new AggregateError();
	            for (var i = this.length(); i < this._values.length; ++i) {
	              e.push(this._values[i]);
	            }
	            this._reject(e);
	          }
	        };
	        SomePromiseArray.prototype._fulfilled = function() {
	          return this._totalResolved;
	        };
	        SomePromiseArray.prototype._rejected = function() {
	          return this._values.length - this.length();
	        };
	        SomePromiseArray.prototype._addRejected = function(reason) {
	          this._values.push(reason);
	        };
	        SomePromiseArray.prototype._addFulfilled = function(value) {
	          this._values[this._totalResolved++] = value;
	        };
	        SomePromiseArray.prototype._canPossiblyFulfill = function() {
	          return this.length() - this._rejected();
	        };
	        SomePromiseArray.prototype._getRangeError = function(count) {
	          var message = "Input array must contain at least " + this._howMany + " items but contains only " + count + " items";
	          return new RangeError(message);
	        };
	        SomePromiseArray.prototype._resolveEmptyArray = function() {
	          this._reject(this._getRangeError(0));
	        };
	        function some(promises, howMany) {
	          if ((howMany | 0) !== howMany || howMany < 0) {
	            return apiRejection("expecting a positive integer\u000a\u000a    See http://goo.gl/1wAmHx\u000a");
	          }
	          var ret = new SomePromiseArray(promises);
	          var promise = ret.promise();
	          ret.setHowMany(howMany);
	          ret.init();
	          return promise;
	        }
	        Promise.some = function(promises, howMany) {
	          return some(promises, howMany);
	        };
	        Promise.prototype.some = function(howMany) {
	          return some(this, howMany);
	        };
	        Promise._SomePromiseArray = SomePromiseArray;
	      };
	    }, {
	      "./errors.js": 13,
	      "./util.js": 38
	    }],
	    34: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise) {
	        function PromiseInspection(promise) {
	          if (promise !== undefined) {
	            promise = promise._target();
	            this._bitField = promise._bitField;
	            this._settledValue = promise._settledValue;
	          } else {
	            this._bitField = 0;
	            this._settledValue = undefined;
	          }
	        }
	        PromiseInspection.prototype.value = function() {
	          if (!this.isFulfilled()) {
	            throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\u000a\u000a    See http://goo.gl/hc1DLj\u000a");
	          }
	          return this._settledValue;
	        };
	        PromiseInspection.prototype.error = PromiseInspection.prototype.reason = function() {
	          if (!this.isRejected()) {
	            throw new TypeError("cannot get rejection reason of a non-rejected promise\u000a\u000a    See http://goo.gl/hPuiwB\u000a");
	          }
	          return this._settledValue;
	        };
	        PromiseInspection.prototype.isFulfilled = Promise.prototype._isFulfilled = function() {
	          return (this._bitField & 268435456) > 0;
	        };
	        PromiseInspection.prototype.isRejected = Promise.prototype._isRejected = function() {
	          return (this._bitField & 134217728) > 0;
	        };
	        PromiseInspection.prototype.isPending = Promise.prototype._isPending = function() {
	          return (this._bitField & 402653184) === 0;
	        };
	        PromiseInspection.prototype.isResolved = Promise.prototype._isResolved = function() {
	          return (this._bitField & 402653184) > 0;
	        };
	        Promise.prototype.isPending = function() {
	          return this._target()._isPending();
	        };
	        Promise.prototype.isRejected = function() {
	          return this._target()._isRejected();
	        };
	        Promise.prototype.isFulfilled = function() {
	          return this._target()._isFulfilled();
	        };
	        Promise.prototype.isResolved = function() {
	          return this._target()._isResolved();
	        };
	        Promise.prototype._value = function() {
	          return this._settledValue;
	        };
	        Promise.prototype._reason = function() {
	          this._unsetRejectionIsUnhandled();
	          return this._settledValue;
	        };
	        Promise.prototype.value = function() {
	          var target = this._target();
	          if (!target.isFulfilled()) {
	            throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\u000a\u000a    See http://goo.gl/hc1DLj\u000a");
	          }
	          return target._settledValue;
	        };
	        Promise.prototype.reason = function() {
	          var target = this._target();
	          if (!target.isRejected()) {
	            throw new TypeError("cannot get rejection reason of a non-rejected promise\u000a\u000a    See http://goo.gl/hPuiwB\u000a");
	          }
	          target._unsetRejectionIsUnhandled();
	          return target._settledValue;
	        };
	        Promise.PromiseInspection = PromiseInspection;
	      };
	    }, {}],
	    35: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL) {
	        var util = _dereq_("./util.js");
	        var errorObj = util.errorObj;
	        var isObject = util.isObject;
	        function tryConvertToPromise(obj, context) {
	          if (isObject(obj)) {
	            if (obj instanceof Promise) {
	              return obj;
	            } else if (isAnyBluebirdPromise(obj)) {
	              var ret = new Promise(INTERNAL);
	              obj._then(ret._fulfillUnchecked, ret._rejectUncheckedCheckError, ret._progressUnchecked, ret, null);
	              return ret;
	            }
	            var then = util.tryCatch(getThen)(obj);
	            if (then === errorObj) {
	              if (context)
	                context._pushContext();
	              var ret = Promise.reject(then.e);
	              if (context)
	                context._popContext();
	              return ret;
	            } else if (typeof then === "function") {
	              return doThenable(obj, then, context);
	            }
	          }
	          return obj;
	        }
	        function getThen(obj) {
	          return obj.then;
	        }
	        var hasProp = {}.hasOwnProperty;
	        function isAnyBluebirdPromise(obj) {
	          return hasProp.call(obj, "_promise0");
	        }
	        function doThenable(x, then, context) {
	          var promise = new Promise(INTERNAL);
	          var ret = promise;
	          if (context)
	            context._pushContext();
	          promise._captureStackTrace();
	          if (context)
	            context._popContext();
	          var synchronous = true;
	          var result = util.tryCatch(then).call(x, resolveFromThenable, rejectFromThenable, progressFromThenable);
	          synchronous = false;
	          if (promise && result === errorObj) {
	            promise._rejectCallback(result.e, true, true);
	            promise = null;
	          }
	          function resolveFromThenable(value) {
	            if (!promise)
	              return;
	            if (x === value) {
	              promise._rejectCallback(Promise._makeSelfResolutionError(), false, true);
	            } else {
	              promise._resolveCallback(value);
	            }
	            promise = null;
	          }
	          function rejectFromThenable(reason) {
	            if (!promise)
	              return;
	            promise._rejectCallback(reason, synchronous, true);
	            promise = null;
	          }
	          function progressFromThenable(value) {
	            if (!promise)
	              return;
	            if (typeof promise._progress === "function") {
	              promise._progress(value);
	            }
	          }
	          return ret;
	        }
	        return tryConvertToPromise;
	      };
	    }, {"./util.js": 38}],
	    36: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, INTERNAL) {
	        var util = _dereq_("./util.js");
	        var TimeoutError = Promise.TimeoutError;
	        var afterTimeout = function(promise, message) {
	          if (!promise.isPending())
	            return;
	          if (typeof message !== "string") {
	            message = "operation timed out";
	          }
	          var err = new TimeoutError(message);
	          util.markAsOriginatingFromRejection(err);
	          promise._attachExtraTrace(err);
	          promise._cancel(err);
	        };
	        var afterValue = function(value) {
	          return delay(+this).thenReturn(value);
	        };
	        var delay = Promise.delay = function(value, ms) {
	          if (ms === undefined) {
	            ms = value;
	            value = undefined;
	            var ret = new Promise(INTERNAL);
	            setTimeout(function() {
	              ret._fulfill();
	            }, ms);
	            return ret;
	          }
	          ms = +ms;
	          return Promise.resolve(value)._then(afterValue, null, null, ms, undefined);
	        };
	        Promise.prototype.delay = function(ms) {
	          return delay(this, ms);
	        };
	        function successClear(value) {
	          var handle = this;
	          if (handle instanceof Number)
	            handle = +handle;
	          clearTimeout(handle);
	          return value;
	        }
	        function failureClear(reason) {
	          var handle = this;
	          if (handle instanceof Number)
	            handle = +handle;
	          clearTimeout(handle);
	          throw reason;
	        }
	        Promise.prototype.timeout = function(ms, message) {
	          ms = +ms;
	          var ret = this.then().cancellable();
	          ret._cancellationParent = this;
	          var handle = setTimeout(function timeoutTimeout() {
	            afterTimeout(ret, message);
	          }, ms);
	          return ret._then(successClear, failureClear, undefined, handle, undefined);
	        };
	      };
	    }, {"./util.js": 38}],
	    37: [function(_dereq_, module, exports) {
	      "use strict";
	      module.exports = function(Promise, apiRejection, tryConvertToPromise, createContext) {
	        var TypeError = _dereq_("./errors.js").TypeError;
	        var inherits = _dereq_("./util.js").inherits;
	        var PromiseInspection = Promise.PromiseInspection;
	        function inspectionMapper(inspections) {
	          var len = inspections.length;
	          for (var i = 0; i < len; ++i) {
	            var inspection = inspections[i];
	            if (inspection.isRejected()) {
	              return Promise.reject(inspection.error());
	            }
	            inspections[i] = inspection._settledValue;
	          }
	          return inspections;
	        }
	        function thrower(e) {
	          setTimeout(function() {
	            throw e;
	          }, 0);
	        }
	        function castPreservingDisposable(thenable) {
	          var maybePromise = tryConvertToPromise(thenable);
	          if (maybePromise !== thenable && typeof thenable._isDisposable === "function" && typeof thenable._getDisposer === "function" && thenable._isDisposable()) {
	            maybePromise._setDisposable(thenable._getDisposer());
	          }
	          return maybePromise;
	        }
	        function dispose(resources, inspection) {
	          var i = 0;
	          var len = resources.length;
	          var ret = Promise.defer();
	          function iterator() {
	            if (i >= len)
	              return ret.resolve();
	            var maybePromise = castPreservingDisposable(resources[i++]);
	            if (maybePromise instanceof Promise && maybePromise._isDisposable()) {
	              try {
	                maybePromise = tryConvertToPromise(maybePromise._getDisposer().tryDispose(inspection), resources.promise);
	              } catch (e) {
	                return thrower(e);
	              }
	              if (maybePromise instanceof Promise) {
	                return maybePromise._then(iterator, thrower, null, null, null);
	              }
	            }
	            iterator();
	          }
	          iterator();
	          return ret.promise;
	        }
	        function disposerSuccess(value) {
	          var inspection = new PromiseInspection();
	          inspection._settledValue = value;
	          inspection._bitField = 268435456;
	          return dispose(this, inspection).thenReturn(value);
	        }
	        function disposerFail(reason) {
	          var inspection = new PromiseInspection();
	          inspection._settledValue = reason;
	          inspection._bitField = 134217728;
	          return dispose(this, inspection).thenThrow(reason);
	        }
	        function Disposer(data, promise, context) {
	          this._data = data;
	          this._promise = promise;
	          this._context = context;
	        }
	        Disposer.prototype.data = function() {
	          return this._data;
	        };
	        Disposer.prototype.promise = function() {
	          return this._promise;
	        };
	        Disposer.prototype.resource = function() {
	          if (this.promise().isFulfilled()) {
	            return this.promise().value();
	          }
	          return null;
	        };
	        Disposer.prototype.tryDispose = function(inspection) {
	          var resource = this.resource();
	          var context = this._context;
	          if (context !== undefined)
	            context._pushContext();
	          var ret = resource !== null ? this.doDispose(resource, inspection) : null;
	          if (context !== undefined)
	            context._popContext();
	          this._promise._unsetDisposable();
	          this._data = null;
	          return ret;
	        };
	        Disposer.isDisposer = function(d) {
	          return (d != null && typeof d.resource === "function" && typeof d.tryDispose === "function");
	        };
	        function FunctionDisposer(fn, promise, context) {
	          this.constructor$(fn, promise, context);
	        }
	        inherits(FunctionDisposer, Disposer);
	        FunctionDisposer.prototype.doDispose = function(resource, inspection) {
	          var fn = this.data();
	          return fn.call(resource, resource, inspection);
	        };
	        function maybeUnwrapDisposer(value) {
	          if (Disposer.isDisposer(value)) {
	            this.resources[this.index]._setDisposable(value);
	            return value.promise();
	          }
	          return value;
	        }
	        Promise.using = function() {
	          var len = arguments.length;
	          if (len < 2)
	            return apiRejection("you must pass at least 2 arguments to Promise.using");
	          var fn = arguments[len - 1];
	          if (typeof fn !== "function")
	            return apiRejection("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
	          len--;
	          var resources = new Array(len);
	          for (var i = 0; i < len; ++i) {
	            var resource = arguments[i];
	            if (Disposer.isDisposer(resource)) {
	              var disposer = resource;
	              resource = resource.promise();
	              resource._setDisposable(disposer);
	            } else {
	              var maybePromise = tryConvertToPromise(resource);
	              if (maybePromise instanceof Promise) {
	                resource = maybePromise._then(maybeUnwrapDisposer, null, null, {
	                  resources: resources,
	                  index: i
	                }, undefined);
	              }
	            }
	            resources[i] = resource;
	          }
	          var promise = Promise.settle(resources).then(inspectionMapper).then(function(vals) {
	            promise._pushContext();
	            var ret;
	            try {
	              ret = fn.apply(undefined, vals);
	            } finally {
	              promise._popContext();
	            }
	            return ret;
	          })._then(disposerSuccess, disposerFail, undefined, resources, undefined);
	          resources.promise = promise;
	          return promise;
	        };
	        Promise.prototype._setDisposable = function(disposer) {
	          this._bitField = this._bitField | 262144;
	          this._disposer = disposer;
	        };
	        Promise.prototype._isDisposable = function() {
	          return (this._bitField & 262144) > 0;
	        };
	        Promise.prototype._getDisposer = function() {
	          return this._disposer;
	        };
	        Promise.prototype._unsetDisposable = function() {
	          this._bitField = this._bitField & (~262144);
	          this._disposer = undefined;
	        };
	        Promise.prototype.disposer = function(fn) {
	          if (typeof fn === "function") {
	            return new FunctionDisposer(fn, this, createContext());
	          }
	          throw new TypeError();
	        };
	      };
	    }, {
	      "./errors.js": 13,
	      "./util.js": 38
	    }],
	    38: [function(_dereq_, module, exports) {
	      "use strict";
	      var es5 = _dereq_("./es5.js");
	      var canEvaluate = typeof navigator == "undefined";
	      var haveGetters = (function() {
	        try {
	          var o = {};
	          es5.defineProperty(o, "f", {get: function() {
	              return 3;
	            }});
	          return o.f === 3;
	        } catch (e) {
	          return false;
	        }
	      })();
	      var errorObj = {e: {}};
	      var tryCatchTarget;
	      function tryCatcher() {
	        try {
	          return tryCatchTarget.apply(this, arguments);
	        } catch (e) {
	          errorObj.e = e;
	          return errorObj;
	        }
	      }
	      function tryCatch(fn) {
	        tryCatchTarget = fn;
	        return tryCatcher;
	      }
	      var inherits = function(Child, Parent) {
	        var hasProp = {}.hasOwnProperty;
	        function T() {
	          this.constructor = Child;
	          this.constructor$ = Parent;
	          for (var propertyName in Parent.prototype) {
	            if (hasProp.call(Parent.prototype, propertyName) && propertyName.charAt(propertyName.length - 1) !== "$") {
	              this[propertyName + "$"] = Parent.prototype[propertyName];
	            }
	          }
	        }
	        T.prototype = Parent.prototype;
	        Child.prototype = new T();
	        return Child.prototype;
	      };
	      function isPrimitive(val) {
	        return val == null || val === true || val === false || typeof val === "string" || typeof val === "number";
	      }
	      function isObject(value) {
	        return !isPrimitive(value);
	      }
	      function maybeWrapAsError(maybeError) {
	        if (!isPrimitive(maybeError))
	          return maybeError;
	        return new Error(safeToString(maybeError));
	      }
	      function withAppended(target, appendee) {
	        var len = target.length;
	        var ret = new Array(len + 1);
	        var i;
	        for (i = 0; i < len; ++i) {
	          ret[i] = target[i];
	        }
	        ret[i] = appendee;
	        return ret;
	      }
	      function getDataPropertyOrDefault(obj, key, defaultValue) {
	        if (es5.isES5) {
	          var desc = Object.getOwnPropertyDescriptor(obj, key);
	          if (desc != null) {
	            return desc.get == null && desc.set == null ? desc.value : defaultValue;
	          }
	        } else {
	          return {}.hasOwnProperty.call(obj, key) ? obj[key] : undefined;
	        }
	      }
	      function notEnumerableProp(obj, name, value) {
	        if (isPrimitive(obj))
	          return obj;
	        var descriptor = {
	          value: value,
	          configurable: true,
	          enumerable: false,
	          writable: true
	        };
	        es5.defineProperty(obj, name, descriptor);
	        return obj;
	      }
	      var wrapsPrimitiveReceiver = (function() {
	        return this !== "string";
	      }).call("string");
	      function thrower(r) {
	        throw r;
	      }
	      var inheritedDataKeys = (function() {
	        if (es5.isES5) {
	          var oProto = Object.prototype;
	          var getKeys = Object.getOwnPropertyNames;
	          return function(obj) {
	            var ret = [];
	            var visitedKeys = Object.create(null);
	            while (obj != null && obj !== oProto) {
	              var keys;
	              try {
	                keys = getKeys(obj);
	              } catch (e) {
	                return ret;
	              }
	              for (var i = 0; i < keys.length; ++i) {
	                var key = keys[i];
	                if (visitedKeys[key])
	                  continue;
	                visitedKeys[key] = true;
	                var desc = Object.getOwnPropertyDescriptor(obj, key);
	                if (desc != null && desc.get == null && desc.set == null) {
	                  ret.push(key);
	                }
	              }
	              obj = es5.getPrototypeOf(obj);
	            }
	            return ret;
	          };
	        } else {
	          return function(obj) {
	            var ret = [];
	            for (var key in obj) {
	              ret.push(key);
	            }
	            return ret;
	          };
	        }
	      })();
	      function isClass(fn) {
	        try {
	          if (typeof fn === "function") {
	            var keys = es5.names(fn.prototype);
	            if (es5.isES5)
	              return keys.length > 1;
	            return keys.length > 0 && !(keys.length === 1 && keys[0] === "constructor");
	          }
	          return false;
	        } catch (e) {
	          return false;
	        }
	      }
	      function toFastProperties(obj) {
	        function f() {}
	        f.prototype = obj;
	        return f;
	        eval(obj);
	      }
	      var rident = /^[a-z$_][a-z$_0-9]*$/i;
	      function isIdentifier(str) {
	        return rident.test(str);
	      }
	      function filledRange(count, prefix, suffix) {
	        var ret = new Array(count);
	        for (var i = 0; i < count; ++i) {
	          ret[i] = prefix + i + suffix;
	        }
	        return ret;
	      }
	      function safeToString(obj) {
	        try {
	          return obj + "";
	        } catch (e) {
	          return "[no string representation]";
	        }
	      }
	      function markAsOriginatingFromRejection(e) {
	        try {
	          notEnumerableProp(e, "isOperational", true);
	        } catch (ignore) {}
	      }
	      function originatesFromRejection(e) {
	        if (e == null)
	          return false;
	        return ((e instanceof Error["__BluebirdErrorTypes__"].OperationalError) || e["isOperational"] === true);
	      }
	      function canAttachTrace(obj) {
	        return obj instanceof Error && es5.propertyIsWritable(obj, "stack");
	      }
	      var ensureErrorObject = (function() {
	        if (!("stack" in new Error())) {
	          return function(value) {
	            if (canAttachTrace(value))
	              return value;
	            try {
	              throw new Error(safeToString(value));
	            } catch (err) {
	              return err;
	            }
	          };
	        } else {
	          return function(value) {
	            if (canAttachTrace(value))
	              return value;
	            return new Error(safeToString(value));
	          };
	        }
	      })();
	      function classString(obj) {
	        return {}.toString.call(obj);
	      }
	      function copyDescriptors(from, to, filter) {
	        var keys = es5.names(from);
	        for (var i = 0; i < keys.length; ++i) {
	          var key = keys[i];
	          if (filter(key)) {
	            es5.defineProperty(to, key, es5.getDescriptor(from, key));
	          }
	        }
	      }
	      var ret = {
	        isClass: isClass,
	        isIdentifier: isIdentifier,
	        inheritedDataKeys: inheritedDataKeys,
	        getDataPropertyOrDefault: getDataPropertyOrDefault,
	        thrower: thrower,
	        isArray: es5.isArray,
	        haveGetters: haveGetters,
	        notEnumerableProp: notEnumerableProp,
	        isPrimitive: isPrimitive,
	        isObject: isObject,
	        canEvaluate: canEvaluate,
	        errorObj: errorObj,
	        tryCatch: tryCatch,
	        inherits: inherits,
	        withAppended: withAppended,
	        maybeWrapAsError: maybeWrapAsError,
	        wrapsPrimitiveReceiver: wrapsPrimitiveReceiver,
	        toFastProperties: toFastProperties,
	        filledRange: filledRange,
	        toString: safeToString,
	        canAttachTrace: canAttachTrace,
	        ensureErrorObject: ensureErrorObject,
	        originatesFromRejection: originatesFromRejection,
	        markAsOriginatingFromRejection: markAsOriginatingFromRejection,
	        classString: classString,
	        copyDescriptors: copyDescriptors,
	        isNode: typeof process !== "undefined" && classString(process).toLowerCase() === "[object process]"
	      };
	      try {
	        throw new Error();
	      } catch (e) {
	        ret.lastLineError = e;
	      }
	      module.exports = ret;
	    }, {"./es5.js": 14}]
	  }, {}, [4])(4);
	});
	;
	if (typeof window !== 'undefined' && window !== null) {
	  window.P = window.Promise;
	} else if (typeof self !== 'undefined' && self !== null) {
	  self.P = self.Promise;
	}
	
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(41), (function() { return this; }())))

/***/ },
/* 17 */
/***/ function(module, exports, __webpack_require__) {

	// style-loader: Adds some css to the DOM by adding a <style> tag
	
	// load the styles
	var content = __webpack_require__(18);
	if(typeof content === 'string') content = [[module.id, content, '']];
	// add the styles to the DOM
	var update = __webpack_require__(34)(content, {});
	// Hot Module Replacement
	if(false) {
		// When the styles change, update the <style> tags
		module.hot.accept("!!/home/mhelvens/Projects/apinatomy-core/node_modules/css-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/autoprefixer-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/sass-loader/index.js!/home/mhelvens/Projects/apinatomy-core/src/example2/example2.scss", function() {
			var newContent = require("!!/home/mhelvens/Projects/apinatomy-core/node_modules/css-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/autoprefixer-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/sass-loader/index.js!/home/mhelvens/Projects/apinatomy-core/src/example2/example2.scss");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
		// When the module is disposed, remove the <style> tags
		module.hot.dispose(function() { update(); });
	}

/***/ },
/* 18 */
/***/ function(module, exports, __webpack_require__) {

	exports = module.exports = __webpack_require__(37)();
	exports.push([module.id, "html,body{position:absolute;width:100%;height:100%;margin:0;padding:0;}body{position:absolute;overflow:hidden;}#circuitboard{position:absolute;top:20px;left:20px;right:20px;bottom:20px;z-index:1;}#three-d-canvas{position:absolute;top:0;left:0;right:0;bottom:0;margin:0;padding:0;z-index:0;}.tile{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;text-align:center;overflow:hidden;border:solid 1px;}.tile>header{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;font-weight:bold;border-width:1px;}.tile.open>header{height:26px;border-style:none none solid none;line-height:26px;font-size:20.8px;white-space:nowrap;overflow:hidden;}.tile:not(.open)>header{border-style:none;}.tile:not(.active){border-style:dotted !important;}.tile>section{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;}.tile:not(.open)>section{display:none;}", ""]);

/***/ },
/* 19 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(16), __webpack_require__(21), __webpack_require__(38), __webpack_require__(26)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, P, U, ArtefactP) {
	  'use strict';
	  function newWidgetType(typeName) {
	    var optionDefaults = arguments[1] !== (void 0) ? arguments[1] : {};
	    var WidgetP = ArtefactP.then((function(Artefact) {
	      return Artefact.newSubclass(typeName, function($__1) {
	        var cssClass = $__1.cssClass;
	        var $__0 = this;
	        if (U.isDefined(cssClass)) {
	          this.element.addClass(cssClass);
	        }
	        this.element.asKefirStream('remove').onValue((function() {
	          $__0.destroy();
	        }));
	      }, {
	        get model() {
	          return this.options.model;
	        },
	        get element() {
	          return this.options.element;
	        }
	      }, U.extend({beforeConstruction: P.resolve()}, optionDefaults));
	    }));
	    var lowercaseName = typeName[0].toLowerCase() + typeName.slice(1);
	    $.fn[lowercaseName] = function(options) {
	      var $__0 = this;
	      if (options === 'instance') {
	        return this.data(("-amy-" + lowercaseName));
	      }
	      this.data(("-amy-" + lowercaseName), WidgetP.then((function(Widget) {
	        return new Widget(U.extend(options, {element: $__0})).constructed;
	      })));
	      return this;
	    };
	    return WidgetP;
	  }
	  return newWidgetType;
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 20 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(16), __webpack_require__(21), __webpack_require__(39), __webpack_require__(22), __webpack_require__(40)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, P, U, SignalHandler, defer, dm) {
	  'use strict';
	  if (!window._amyPlugin) {
	    window._amyPlugin = function(pluginOrSelection) {
	      if ($.isPlainObject(pluginOrSelection)) {
	        return new dm.Delta(pluginOrSelection.name, pluginOrSelection);
	      } else {
	        U.assert(!_selectedDeferred.done, "ApiNATOMY plugins can only be selected once, after which they are fixed.");
	        _selectedDeferred.done = true;
	        dm.select.apply(dm, pluginOrSelection);
	        _selectedDeferred.resolve(this);
	        return window._amyPlugin.selected;
	      }
	    };
	    var _selectedDeferred = defer();
	    window._amyPlugin.selected = _selectedDeferred.promise;
	    window._amyPlugin.graph = (function() {
	      return dm.graph();
	    });
	    window._amyPlugin.dm = dm;
	  }
	  return window._amyPlugin;
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 21 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(16)], __WEBPACK_AMD_DEFINE_RESULT__ = function(P) {
	  'use strict';
	  var U = {
	    newClass: function(constructor) {
	      var prototype = arguments[1] !== (void 0) ? arguments[1] : {};
	      constructor.prototype = prototype;
	      constructor.prototype.constructor = constructor;
	      return constructor;
	    },
	    newSubclass: function(superClass, constructorMaker) {
	      var prototype = arguments[2] !== (void 0) ? arguments[2] : {};
	      var constructor = constructorMaker(superClass.prototype.constructor);
	      constructor.prototype = Object.create(superClass.prototype);
	      U.extend(constructor.prototype, prototype);
	      constructor.prototype.constructor = constructor;
	      return constructor;
	    },
	    extend: function(obj1) {
	      for (var rest = [],
	          $__1 = 1; $__1 < arguments.length; $__1++)
	        rest[$__1 - 1] = arguments[$__1];
	      rest.forEach((function(obj) {
	        for (var key in obj) {
	          if (obj.hasOwnProperty(key)) {
	            Object.defineProperty(obj1, key, Object.getOwnPropertyDescriptor(obj, key));
	          }
	        }
	      }));
	      return obj1;
	    },
	    field: function(name) {
	      return (function(obj) {
	        return obj[name];
	      });
	    },
	    call: function(fn) {
	      for (var args = [],
	          $__2 = 1; $__2 < arguments.length; $__2++)
	        args[$__2 - 1] = arguments[$__2];
	      return fn.apply(undefined, args);
	    },
	    id: function(v) {
	      return v;
	    },
	    getDef: function(obj, name, value) {
	      if (U.isUndefined(obj[name])) {
	        if (typeof value === 'function') {
	          value = value();
	        }
	        obj[name] = value;
	      }
	      return obj[name];
	    },
	    object: function(obj, name) {
	      return U.getDef(obj, name, {});
	    },
	    array: function(obj, name) {
	      return U.getDef(obj, name, []);
	    },
	    pull: function(arr, val) {
	      var i = arr.indexOf(val);
	      if (i !== -1) {
	        arr.splice(i);
	      }
	    },
	    makeEmpty: function(arr) {
	      while (arr.length > 0) {
	        arr.pop();
	      }
	    },
	    bindA: function(fn, ctx, args) {
	      return fn.bind.apply(fn, [ctx].concat(args));
	    },
	    bind: function(obj, m) {
	      for (var args = [],
	          $__3 = 2; $__3 < arguments.length; $__3++)
	        args[$__3 - 2] = arguments[$__3];
	      return U.bindA(obj[m], obj, args);
	    },
	    applyConstructor: function(ConstructorFn, args) {
	      var NewConstructorFn = ConstructorFn.bind.apply(ConstructorFn, [null].concat(args));
	      return new NewConstructorFn();
	    },
	    assert: function(condition, message) {
	      if (!condition) {
	        throw new Error(message || "Assertion failed");
	      }
	    },
	    isUndefined: function(val) {
	      return typeof val === 'undefined';
	    },
	    isDefined: function(val) {
	      return typeof val !== 'undefined';
	    },
	    isPlainObject: function(val) {
	      return typeof val === 'object' && val.constructor === Object;
	    },
	    isFunction: function(val) {
	      return typeof val === 'function';
	    },
	    objValues: function(obj) {
	      return Object.keys(obj).map((function(key) {
	        return obj[key];
	      }));
	    },
	    makePositioned: function(element) {
	      if (element.css('position') === 'static') {
	        element.css('position', 'relative');
	      }
	    },
	    defOr: function() {
	      for (var values = [],
	          $__4 = 0; $__4 < arguments.length; $__4++)
	        values[$__4] = arguments[$__4];
	      for (var i = 0; i < values.length; i += 1) {
	        if (U.isDefined(values[i])) {
	          return values[i];
	        }
	      }
	    },
	    debounce: function(func, wait, context) {
	      var timeout;
	      return function() {
	        for (var args = [],
	            $__5 = 0; $__5 < arguments.length; $__5++)
	          args[$__5] = arguments[$__5];
	        var $__0 = this;
	        var laterFn = (function() {
	          timeout = null;
	          func.apply(context || $__0, args);
	        });
	        clearTimeout(timeout);
	        timeout = setTimeout(laterFn, wait);
	      };
	    },
	    oncePerStack: function(func, context) {
	      var notRunYet = true;
	      var result = function() {
	        for (var args = [],
	            $__5 = 0; $__5 < arguments.length; $__5++)
	          args[$__5] = arguments[$__5];
	        if (notRunYet) {
	          notRunYet = false;
	          setTimeout((function() {
	            notRunYet = true;
	          }), 0);
	          func.apply(context || this, args);
	        }
	      };
	      result.allowAdditionalCall = (function() {
	        notRunYet = true;
	      });
	      return result;
	    },
	    cached: function($__6) {
	      var $__7 = $__6,
	          retrieve = $__7.retrieve,
	          isEqual = $__7.isEqual;
	      isEqual = isEqual || ((function(a, b) {
	        return (a === b);
	      }));
	      var cache;
	      function retrieveValue() {
	        var newValue = retrieve();
	        var oldValue = cache;
	        if (!isEqual(newValue, oldValue)) {
	          cache = newValue;
	          onChange.forEach((function(fn) {
	            return fn(newValue, oldValue);
	          }));
	        }
	      }
	      var oncePerStackSetValue = U.oncePerStack(retrieveValue);
	      var resultFn = (function() {
	        oncePerStackSetValue();
	        return cache;
	      });
	      var onChange = [];
	      resultFn.onChange = (function(cb) {
	        onChange.push(cb);
	        return resultFn;
	      });
	      resultFn.allowAdditionalCall = (function() {
	        oncePerStackSetValue.allowAdditionalCall();
	      });
	      oncePerStackSetValue();
	      return resultFn;
	    },
	    promisify: function(obj, method) {
	      return function() {
	        for (var args = [],
	            $__5 = 0; $__5 < arguments.length; $__5++)
	          args[$__5] = arguments[$__5];
	        return new P((function(resolve, reject) {
	          try {
	            obj[method].apply(obj, args.concat(resolve));
	          } catch (error) {
	            reject(error);
	          }
	        }));
	      };
	    },
	    findIndex: function(array, pred) {
	      for (var i = 0; i < array.length; ++i) {
	        if (pred(array[i], i, array)) {
	          return i;
	        }
	      }
	      return -1;
	    },
	    memoize: function(fn) {
	      var keys = [];
	      var cache = [];
	      return function() {
	        for (var args = [],
	            $__5 = 0; $__5 < arguments.length; $__5++)
	          args[$__5] = arguments[$__5];
	        var index = U.findIndex(keys, (function(key) {
	          return key.every((function(v, i) {
	            return v === args[i];
	          }));
	        }));
	        if (index >= 0) {
	          return cache[index];
	        }
	        var result = fn.apply(this, args);
	        keys.push(args);
	        cache.push(result);
	        return result;
	      };
	    }
	  };
	  var EPS = 0.000001;
	  var sortOfEqual = (function(a, b) {
	    return (b - EPS < a && a < b + EPS);
	  });
	  U.Position = U.newClass(function(top, left) {
	    this.top = top;
	    this.left = left;
	  });
	  U.Position.subtract = (function(a, b) {
	    return new U.Position(a.top - b.top, a.left - b.left);
	  });
	  U.Position.equals = (function(a, b) {
	    return U.isDefined(a) && U.isDefined(b) && sortOfEqual(a.top, b.top) && sortOfEqual(a.left, b.left);
	  });
	  U.Size = U.newClass(function(height, width) {
	    this.height = height;
	    this.width = width;
	  });
	  U.Size.equals = (function(a, b) {
	    return U.isDefined(a) && U.isDefined(b) && sortOfEqual(a.height, b.height) && sortOfEqual(a.width, b.width);
	  });
	  return U;
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 22 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(16)], __WEBPACK_AMD_DEFINE_RESULT__ = function(P) {
	  'use strict';
	  return function defer() {
	    var resolve,
	        reject;
	    var promise = new P(function() {
	      resolve = arguments[0];
	      reject = arguments[1];
	    });
	    return {
	      resolve: resolve,
	      reject: reject,
	      promise: promise
	    };
	  };
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 23 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(26)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, Kefir) {
	  'use strict';
	  function setDisplay(element, newGrow) {
	    var oldGrow = element.data('amyFlexGrowTarget');
	    element.data('amyFlexGrowTarget', newGrow);
	    if (oldGrow > 0 && newGrow === 0) {
	      element.data('amyFlexGrowPrevDisplay', element.css('display'));
	      element.css('flexGrow', 1e-5);
	      setTimeout((function() {
	        element.asKefirStream('transitionend webkitTransitionEnd').merge(Kefir.later(300)).take(1).filter((function() {
	          return element.data('amyFlexGrowTarget') === 0;
	        })).onValue((function() {
	          element.css('display', 'none');
	        }));
	      }));
	    } else if (oldGrow === 0 && newGrow > 0) {
	      element.css('display', element.data('amyFlexGrowPrevDisplay'));
	      element.data('amyFlexGrowCssScheduled', true);
	      setTimeout((function() {
	        element.removeData('amyFlexGrowCssScheduled');
	        element.css('flexGrow', element.data('amyFlexGrowTarget'));
	      }));
	    } else if (!element.data('amyFlexGrowCssScheduled')) {
	      element.css('flexGrow', newGrow);
	    }
	  }
	  $.fn.amyNestedFlexGrow = function(grow) {
	    setDisplay(this, grow);
	    var growSum = 0;
	    this.parent().children().each(function() {
	      growSum += parseFloat($(this).data('amyFlexGrowTarget'));
	    });
	    setDisplay(this.parent(), growSum);
	    return this;
	  };
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 24 */
/***/ function(module, exports, __webpack_require__) {

	// style-loader: Adds some css to the DOM by adding a <style> tag
	
	// load the styles
	var content = __webpack_require__(25);
	if(typeof content === 'string') content = [[module.id, content, '']];
	// add the styles to the DOM
	var update = __webpack_require__(34)(content, {});
	// Hot Module Replacement
	if(false) {
		// When the styles change, update the <style> tags
		module.hot.accept("!!/home/mhelvens/Projects/apinatomy-core/node_modules/css-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/autoprefixer-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/sass-loader/index.js!/home/mhelvens/Projects/apinatomy-core/src/p-core.scss", function() {
			var newContent = require("!!/home/mhelvens/Projects/apinatomy-core/node_modules/css-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/autoprefixer-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/sass-loader/index.js!/home/mhelvens/Projects/apinatomy-core/src/p-core.scss");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
		// When the module is disposed, remove the <style> tags
		module.hot.dispose(function() { update(); });
	}

/***/ },
/* 25 */
/***/ function(module, exports, __webpack_require__) {

	exports = module.exports = __webpack_require__(37)();
	exports.push([module.id, ".circuitboard{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:stretch;-webkit-align-items:stretch;-ms-flex-align:stretch;align-items:stretch;padding:0;}.circuitboard .tilemap{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}.circuitboard .tilemap>.tilerow{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:0;padding:0;height:0;}.circuitboard .tilemap>.tilerow>.tile{width:0;margin:0;padding:0;}.circuitboard .tilemap>.tilerow>.tile:last-child{margin-right:0 !important;}.circuitboard .tilemap>.tilerow:last-child{margin-bottom:0 !important;}", ""]);

/***/ },
/* 26 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;'use strict';
	!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(21), __webpack_require__(42), __webpack_require__(43)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, U, Kefir, TWEEN) {
	  __webpack_require__(44).init(Kefir, $);
	  Kefir.fromOnNull = U.memoize(function fromOnNull(obj, eventName) {
	    return Kefir.fromBinder((function(emitter) {
	      obj.on(eventName, emitter.emit);
	      return (function() {
	        obj.on(eventName, null);
	      });
	    }));
	  });
	  var requestAnimationFrameFn = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || ((function(f) {
	    window.setTimeout(f, 1000 / 60);
	  }));
	  Kefir.animationFrames = function animationFrames() {
	    return Kefir.fromBinder((function(emitter) {
	      var subscribed = true;
	      (function iterationFn() {
	        requestAnimationFrameFn((function() {
	          emitter.emit();
	          if (subscribed) {
	            iterationFn();
	          }
	        }));
	      })();
	      return (function() {
	        subscribed = false;
	      });
	    }));
	  };
	  Kefir.tween = function tween(objStart, objEnd, $__1) {
	    var $__2 = $__1,
	        duration = $__2.duration,
	        delay = $__2.delay,
	        easing = $__2.easing;
	    var tw = new TWEEN.Tween(objStart).to(objEnd, duration);
	    var bus = Kefir.bus();
	    var addStream = ((function() {
	      var chainedStreams = 0;
	      return (function(stream) {
	        chainedStreams += 1;
	        bus.plug(stream);
	        stream.onEnd((function() {
	          chainedStreams -= 1;
	          if (chainedStreams === 0) {
	            bus.end();
	          }
	        }));
	      });
	    }))();
	    addStream(Kefir.fromBinder((function(emitter) {
	      if (easing) {
	        tw.easing(easing);
	      }
	      if (delay) {
	        tw.delay(delay);
	      }
	      tw.onUpdate(function() {
	        emitter.emit(this);
	      });
	      tw.onComplete(emitter.end);
	    })));
	    bus.tween = tw;
	    bus.start = (function() {
	      tw.start();
	      return bus;
	    });
	    bus.chain = (function(other) {
	      addStream(other);
	      tw.chain(other.tween);
	      return bus;
	    });
	    return bus;
	  };
	  Kefir.keyPress = function keyPress(keyCode) {
	    return $(window).asKefirStream('keypress').filter((function(e) {
	      return e.keyCode === keyCode;
	    }));
	  };
	  Kefir.once = function once(value) {
	    return Kefir.fromBinder((function(emitter) {
	      emitter.emit(value);
	      emitter.end();
	    }));
	  };
	  Kefir.fromArray = function fromArray(array) {
	    return Kefir.fromBinder((function(emitter) {
	      array.forEach(emitter.emit);
	      emitter.end();
	    }));
	  };
	  Kefir.limiter = function limiter(pacing) {
	    var handler = arguments[1] !== (void 0) ? arguments[1] : U.call;
	    var wantedBus = Kefir.bus();
	    var open = Kefir.bus();
	    var close = Kefir.bus();
	    pacing.filterBy(wantedBus.toProperty(false)).onValue((function() {
	      handler((function() {
	        open.emit();
	        wantedBus.emit(false);
	        close.emit();
	      }));
	    }));
	    return function(stream) {
	      var buffer = (arguments[1] !== (void 0) ? arguments[1] : {}).buffer;
	      wantedBus.plug(stream.mapTo(true));
	      return Kefir.constant(true).take(1).concat(close).flatMapLatest((function() {
	        var accumulator = (function(arr, val) {
	          return (buffer ? arr.concat([val]) : [val]);
	        });
	        return stream.takeUntilBy(open).reduce(accumulator, []).flatMap(Kefir.fromArray);
	      }));
	    };
	  };
	  Kefir.Observable.prototype.limitedBy = function limitedBy(wrapper, options) {
	    return wrapper(this, options);
	  };
	  Kefir.Stream.prototype.holdUntil = function holdUntil(pacing) {
	    var $__0 = this;
	    return Kefir.fromBinder((function(emitter) {
	      var buffer = [];
	      var unsubscribeToThis = $__0.onValue((function(value) {
	        buffer.push(value);
	      }));
	      var unsubscribeToPacing = pacing.onValue((function() {
	        if (buffer.length > 0) {
	          var oldBuffer = buffer;
	          buffer = [];
	          oldBuffer.forEach(emitter.emit);
	        }
	      }));
	      return (function() {
	        unsubscribeToThis();
	        unsubscribeToPacing();
	        buffer = null;
	      });
	    }));
	  };
	  Kefir.Observable.prototype.value = function(value, comparator) {
	    comparator = comparator || ((function(e) {
	      return e === value;
	    }));
	    return this.skipDuplicates().filter(comparator);
	  };
	  Kefir.Observable.prototype.run = function() {
	    var $__0 = this;
	    var doNothing = (function() {});
	    this.onValue(doNothing);
	    return (function() {
	      $__0.offValue(doNothing);
	    });
	  };
	  Kefir.Stream.prototype.skipPropagation = function(label) {
	    return this.filter((function(event) {
	      return !U.array(event.originalEvent, '_onlyOnceFor')[label];
	    })).map((function(event) {
	      U.array(event.originalEvent, '_onlyOnceFor')[label] = true;
	    }));
	  };
	  Kefir.Stream.prototype.which = function(buttonId) {
	    var pred = (typeof buttonId === 'function') ? (buttonId) : ((function(b) {
	      return b === buttonId;
	    }));
	    return this.filter((function(e) {
	      return pred(e.which);
	    }));
	  };
	  $.fn.mouseDrag = function mouseDrag() {
	    var threshold = (arguments[0] !== (void 0) ? arguments[0] : {}).threshold;
	    return $(this).asKefirStream('mousedown').flatMap((function(mouseDownEvent) {
	      var stream = $(document).asKefirStream('mousemove');
	      if (threshold) {
	        var crossed = false;
	        stream = stream.filter((function(mouseMoveEvent) {
	          if (crossed) {
	            return true;
	          }
	          var dx = mouseDownEvent.pageX - mouseMoveEvent.pageX;
	          var dy = mouseDownEvent.pageY - mouseMoveEvent.pageY;
	          if (dx * dx + dy * dy > threshold * threshold) {
	            return crossed = true;
	          }
	          return false;
	        }));
	      }
	      return stream.takeUntilBy($(document).asKefirStream('mouseup')).map((function(mouseMoveEvent) {
	        return ({
	          mouseDownEvent: mouseDownEvent,
	          mouseMoveEvent: mouseMoveEvent
	        });
	      }));
	    }));
	  };
	  $.fn.mouseClick = function mouseClick() {
	    var threshold = (arguments[0] !== (void 0) ? arguments[0] : {}).threshold;
	    return $(this).asKefirStream('mousedown').flatMap((function(mouseDownEvent) {
	      var untilStream = $(document).asKefirStream('mousemove');
	      if (threshold) {
	        var crossed = false;
	        untilStream = untilStream.filter((function(mouseMoveEvent) {
	          if (crossed) {
	            return true;
	          }
	          var dx = mouseDownEvent.pageX - mouseMoveEvent.pageX;
	          var dy = mouseDownEvent.pageY - mouseMoveEvent.pageY;
	          if (dx * dx + dy * dy > threshold * threshold) {
	            return crossed = true;
	          }
	          return false;
	        }));
	      }
	      return $(document).asKefirStream('mouseup').take(1).takeUntilBy(untilStream);
	    }));
	  };
	  $.fn.mouseWheel = function mouseWheel() {
	    return $(this).asKefirStream('mousewheel DOMMouseScroll');
	  };
	  return Kefir;
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 27 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(21)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, U) {
	  'use strict';
	  function deepTransform(val, fn) {
	    if ($.isPlainObject(val) || $.isArray(val)) {
	      $.each(val, (function(key, subVal) {
	        var returned = fn(subVal);
	        if (U.isUndefined(returned)) {
	          deepTransform(subVal, fn);
	        } else {
	          val[key] = returned;
	        }
	      }));
	    }
	  }
	  var REF_PATTERN = /`([\[\.].+?)`/g;
	  return function defaults(spec, context) {
	    deepTransform(spec, (function(val) {
	      if (typeof val === 'string') {
	        var refs = (val.match(REF_PATTERN) || []).map((function(ref) {
	          var strippedRef = ref.substring(1, ref.length - 1);
	          return new Function('refs', ("return refs" + strippedRef));
	        }));
	        var expr = val.replace(REF_PATTERN, "(refs$1)");
	        var templateFn = (function(formalParams) {
	          var newFormalParams = formalParams.concat([("return " + expr)]);
	          return U.applyConstructor(Function, newFormalParams);
	        });
	        templateFn.refs = refs;
	        return templateFn;
	      }
	    }));
	    function withDefaultsAux(defSpec, obj, refs, params) {
	      var change = false;
	      Object.keys(defSpec).forEach((function(key) {
	        if (key in obj) {
	          if ($.isPlainObject(defSpec[key]) && $.isPlainObject(obj[key])) {
	            change = withDefaultsAux(defSpec[key], obj[key], refs, params) || change;
	          }
	        } else if ($.isPlainObject(defSpec[key])) {
	          obj[key] = {};
	          change = withDefaultsAux(defSpec[key], obj[key], refs, params) || change;
	        } else if ($.isFunction(defSpec[key])) {
	          if (defSpec[key].refs.every((function(ref) {
	            return !U.isUndefined(ref(refs));
	          }))) {
	            var allparams = $.extend({refs: refs}, context, params);
	            var formalParams = Object.keys(allparams);
	            var actualParams = formalParams.map((function(fpar) {
	              return allparams[fpar];
	            }));
	            var finalFn = defSpec[key](formalParams);
	            obj[key] = finalFn.apply(null, actualParams);
	          }
	        }
	      }));
	      return change;
	    }
	    return function withDefaults(obj, params) {
	      var result = (U.isUndefined(obj) ? {} : $.extend(true, {}, obj));
	      var change = true;
	      while (change) {
	        change = withDefaultsAux(spec, result, result, params || {});
	      }
	      return result;
	    };
	  };
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 28 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15)], __WEBPACK_AMD_DEFINE_RESULT__ = function($) {
	  'use strict';
	  $.fn.extend({amyPutCssRules: function(rules) {
	      var $__0 = this;
	      $.each(rules, (function(selector, css) {
	        var context;
	        if (selector.trim() === '&') {
	          context = $__0;
	        } else if (selector.trim().charAt(0) === '&') {
	          context = $__0.find(selector.trim().substr(1).trim());
	        } else {
	          context = $__0.find(selector);
	        }
	        context.css(css);
	      }));
	    }});
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 29 */
/***/ function(module, exports, __webpack_require__) {

	// style-loader: Adds some css to the DOM by adding a <style> tag
	
	// load the styles
	var content = __webpack_require__(30);
	if(typeof content === 'string') content = [[module.id, content, '']];
	// add the styles to the DOM
	var update = __webpack_require__(34)(content, {});
	// Hot Module Replacement
	if(false) {
		// When the styles change, update the <style> tags
		module.hot.accept("!!/home/mhelvens/Projects/apinatomy-core/node_modules/css-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/autoprefixer-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/sass-loader/index.js!/home/mhelvens/Projects/apinatomy-core/src/p-tile-skin.scss", function() {
			var newContent = require("!!/home/mhelvens/Projects/apinatomy-core/node_modules/css-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/autoprefixer-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/sass-loader/index.js!/home/mhelvens/Projects/apinatomy-core/src/p-tile-skin.scss");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
		// When the module is disposed, remove the <style> tags
		module.hot.dispose(function() { update(); });
	}

/***/ },
/* 30 */
/***/ function(module, exports, __webpack_require__) {

	exports = module.exports = __webpack_require__(37)();
	exports.push([module.id, ".skinned-tile{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.skinned-tile>header{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;font-weight:bold;border-width:1px;overflow:hidden;}.skinned-tile.open>header{height:26px;border-style:none none solid none;line-height:26px;font-size:19.5px !important;white-space:nowrap;}.skinned-tile:not(.open)>header{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;padding:0 5px;}.skinned-tile>section{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;}.skinned-tile.open>section{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;opacity:1;}.skinned-tile:not(.open)>section{opacity:0;}", ""]);

/***/ },
/* 31 */
/***/ function(module, exports, __webpack_require__) {

	!(module.exports = {
	  button: {
	    LEFT: 1,
	    MIDDLE: 2,
	    RIGHT: 3
	  },
	  key: {
	    BACKSPACE: 8,
	    TAB: 9,
	    ENTER: 13,
	    SHIFT: 16,
	    CTRL: 17,
	    ALT: 18,
	    PAUSE: 19,
	    CAPS_LOCK: 20,
	    ESCAPE: 27,
	    SPACE: 32,
	    PAGE_UP: 33,
	    PAGE_DOWN: 34,
	    END: 35,
	    HOME: 36,
	    LEFT_ARROW: 37,
	    UP_ARROW: 38,
	    RIGHT_ARROW: 39,
	    DOWN_ARROW: 40,
	    INSERT: 45,
	    DELETE: 46,
	    0: 48,
	    1: 49,
	    2: 50,
	    3: 51,
	    4: 52,
	    5: 53,
	    6: 54,
	    7: 55,
	    8: 56,
	    9: 57,
	    A: 65,
	    B: 66,
	    C: 67,
	    D: 68,
	    E: 69,
	    F: 70,
	    G: 71,
	    H: 72,
	    I: 73,
	    J: 74,
	    K: 75,
	    L: 76,
	    M: 77,
	    N: 78,
	    O: 79,
	    P: 80,
	    Q: 81,
	    R: 82,
	    S: 83,
	    T: 84,
	    U: 85,
	    V: 86,
	    W: 87,
	    X: 88,
	    Y: 89,
	    Z: 90,
	    LEFT_META: 91,
	    RIGHT_META: 92,
	    SELECT: 93,
	    NUMPAD_0: 96,
	    NUMPAD_1: 97,
	    NUMPAD_2: 98,
	    NUMPAD_3: 99,
	    NUMPAD_4: 100,
	    NUMPAD_5: 101,
	    NUMPAD_6: 102,
	    NUMPAD_7: 103,
	    NUMPAD_8: 104,
	    NUMPAD_9: 105,
	    MULTIPLY: 106,
	    ADD: 107,
	    SUBTRACT: 109,
	    DECIMAL: 110,
	    DIVIDE: 111,
	    F1: 112,
	    F2: 113,
	    F3: 114,
	    F4: 115,
	    F5: 116,
	    F6: 117,
	    F7: 118,
	    F8: 119,
	    F9: 120,
	    F10: 121,
	    F11: 122,
	    F12: 123,
	    NUM_LOCK: 144,
	    SCROLL_LOCK: 145,
	    SEMICOLON: 186,
	    EQUALS: 187,
	    COMMA: 188,
	    DASH: 189,
	    PERIOD: 190,
	    FORWARD_SLASH: 191,
	    GRAVE_ACCENT: 192,
	    OPEN_BRACKET: 219,
	    BACK_SLASH: 220,
	    CLOSE_BRACKET: 221,
	    SINGLE_QUOTE: 222
	  }
	});


/***/ },
/* 32 */
/***/ function(module, exports, __webpack_require__) {

	// style-loader: Adds some css to the DOM by adding a <style> tag
	
	// load the styles
	var content = __webpack_require__(33);
	if(typeof content === 'string') content = [[module.id, content, '']];
	// add the styles to the DOM
	var update = __webpack_require__(34)(content, {});
	// Hot Module Replacement
	if(false) {
		// When the styles change, update the <style> tags
		module.hot.accept("!!/home/mhelvens/Projects/apinatomy-core/node_modules/css-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/autoprefixer-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/sass-loader/index.js!/home/mhelvens/Projects/apinatomy-core/src/p-tile-skin-grow-when-open.scss", function() {
			var newContent = require("!!/home/mhelvens/Projects/apinatomy-core/node_modules/css-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/autoprefixer-loader/index.js!/home/mhelvens/Projects/apinatomy-core/node_modules/sass-loader/index.js!/home/mhelvens/Projects/apinatomy-core/src/p-tile-skin-grow-when-open.scss");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
		// When the module is disposed, remove the <style> tags
		module.hot.dispose(function() { update(); });
	}

/***/ },
/* 33 */
/***/ function(module, exports, __webpack_require__) {

	exports = module.exports = __webpack_require__(37)();
	exports.push([module.id, ".tilemap .tile>section{opacity:0;visibility:hidden;}", ""]);

/***/ },
/* 34 */
/***/ function(module, exports, __webpack_require__) {

	/*
		MIT License http://www.opensource.org/licenses/mit-license.php
		Author Tobias Koppers @sokra
	*/
	var stylesInDom = {},
		memoize = function(fn) {
			var memo;
			return function () {
				if (typeof memo === "undefined") memo = fn.apply(this, arguments);
				return memo;
			};
		},
		isIE9 = memoize(function() {
			return /msie 9\b/.test(window.navigator.userAgent.toLowerCase());
		}),
		getHeadElement = memoize(function () {
			return document.head || document.getElementsByTagName("head")[0];
		}),
		singletonElement = null,
		singletonCounter = 0;
	
	module.exports = function(list, options) {
		if(false) {
			if(typeof document !== "object") throw new Error("The style-loader cannot be used in a non-browser environment");
		}
	
		options = options || {};
		// Force single-tag solution on IE9, which has a hard limit on the # of <style>
		// tags it will allow on a page
		if (typeof options.singleton === "undefined") options.singleton = isIE9();
	
		var styles = listToStyles(list);
		addStylesToDom(styles, options);
	
		return function update(newList) {
			var mayRemove = [];
			for(var i = 0; i < styles.length; i++) {
				var item = styles[i];
				var domStyle = stylesInDom[item.id];
				domStyle.refs--;
				mayRemove.push(domStyle);
			}
			if(newList) {
				var newStyles = listToStyles(newList);
				addStylesToDom(newStyles, options);
			}
			for(var i = 0; i < mayRemove.length; i++) {
				var domStyle = mayRemove[i];
				if(domStyle.refs === 0) {
					for(var j = 0; j < domStyle.parts.length; j++)
						domStyle.parts[j]();
					delete stylesInDom[domStyle.id];
				}
			}
		};
	}
	
	function addStylesToDom(styles, options) {
		for(var i = 0; i < styles.length; i++) {
			var item = styles[i];
			var domStyle = stylesInDom[item.id];
			if(domStyle) {
				domStyle.refs++;
				for(var j = 0; j < domStyle.parts.length; j++) {
					domStyle.parts[j](item.parts[j]);
				}
				for(; j < item.parts.length; j++) {
					domStyle.parts.push(addStyle(item.parts[j], options));
				}
			} else {
				var parts = [];
				for(var j = 0; j < item.parts.length; j++) {
					parts.push(addStyle(item.parts[j], options));
				}
				stylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};
			}
		}
	}
	
	function listToStyles(list) {
		var styles = [];
		var newStyles = {};
		for(var i = 0; i < list.length; i++) {
			var item = list[i];
			var id = item[0];
			var css = item[1];
			var media = item[2];
			var sourceMap = item[3];
			var part = {css: css, media: media, sourceMap: sourceMap};
			if(!newStyles[id])
				styles.push(newStyles[id] = {id: id, parts: [part]});
			else
				newStyles[id].parts.push(part);
		}
		return styles;
	}
	
	function createStyleElement() {
		var styleElement = document.createElement("style");
		var head = getHeadElement();
		styleElement.type = "text/css";
		head.appendChild(styleElement);
		return styleElement;
	}
	
	function addStyle(obj, options) {
		var styleElement, update, remove;
	
		if (options.singleton) {
			var styleIndex = singletonCounter++;
			styleElement = singletonElement || (singletonElement = createStyleElement());
			update = applyToSingletonTag.bind(null, styleElement, styleIndex, false);
			remove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);
		} else {
			styleElement = createStyleElement();
			update = applyToTag.bind(null, styleElement);
			remove = function () {
				styleElement.parentNode.removeChild(styleElement);
			};
		}
	
		update(obj);
	
		return function updateStyle(newObj) {
			if(newObj) {
				if(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)
					return;
				update(obj = newObj);
			} else {
				remove();
			}
		};
	}
	
	function replaceText(source, id, replacement) {
		var boundaries = ["/** >>" + id + " **/", "/** " + id + "<< **/"];
		var start = source.lastIndexOf(boundaries[0]);
		var wrappedReplacement = replacement
			? (boundaries[0] + replacement + boundaries[1])
			: "";
		if (source.lastIndexOf(boundaries[0]) >= 0) {
			var end = source.lastIndexOf(boundaries[1]) + boundaries[1].length;
			return source.slice(0, start) + wrappedReplacement + source.slice(end);
		} else {
			return source + wrappedReplacement;
		}
	}
	
	function applyToSingletonTag(styleElement, index, remove, obj) {
		var css = remove ? "" : obj.css;
	
		if(styleElement.styleSheet) {
			styleElement.styleSheet.cssText = replaceText(styleElement.styleSheet.cssText, index, css);
		} else {
			var cssNode = document.createTextNode(css);
			var childNodes = styleElement.childNodes;
			if (childNodes[index]) styleElement.removeChild(childNodes[index]);
			if (childNodes.length) {
				styleElement.insertBefore(cssNode, childNodes[index]);
			} else {
				styleElement.appendChild(cssNode);
			}
		}
	}
	
	function applyToTag(styleElement, obj) {
		var css = obj.css;
		var media = obj.media;
		var sourceMap = obj.sourceMap;
	
		if(sourceMap && typeof btoa === "function") {
			try {
				css += "\n/*# sourceMappingURL=data:application/json;base64," + btoa(JSON.stringify(sourceMap)) + " */";
				css = "@import url(\"data:text/css;base64," + btoa(css) + "\")";
			} catch(e) {}
		}
	
		if(media) {
			styleElement.setAttribute("media", media)
		}
	
		if(styleElement.styleSheet) {
			styleElement.styleSheet.cssText = css;
		} else {
			while(styleElement.firstChild) {
				styleElement.removeChild(styleElement.firstChild);
			}
			styleElement.appendChild(document.createTextNode(css));
		}
	}


/***/ },
/* 35 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;!function(e) {
	  function t(e) {
	    var t = e.length,
	        r = $.type(e);
	    return "function" === r || $.isWindow(e) ? !1 : 1 === e.nodeType && t ? !0 : "array" === r || 0 === t || "number" == typeof t && t > 0 && t - 1 in e;
	  }
	  if (!e.jQuery) {
	    var $ = function(e, t) {
	      return new $.fn.init(e, t);
	    };
	    $.isWindow = function(e) {
	      return null != e && e == e.window;
	    }, $.type = function(e) {
	      return null == e ? e + "" : "object" == typeof e || "function" == typeof e ? a[o.call(e)] || "object" : typeof e;
	    }, $.isArray = Array.isArray || function(e) {
	      return "array" === $.type(e);
	    }, $.isPlainObject = function(e) {
	      var t;
	      if (!e || "object" !== $.type(e) || e.nodeType || $.isWindow(e))
	        return !1;
	      try {
	        if (e.constructor && !n.call(e, "constructor") && !n.call(e.constructor.prototype, "isPrototypeOf"))
	          return !1;
	      } catch (r) {
	        return !1;
	      }
	      for (t in e)
	        ;
	      return void 0 === t || n.call(e, t);
	    }, $.each = function(e, r, a) {
	      var n,
	          o = 0,
	          i = e.length,
	          s = t(e);
	      if (a) {
	        if (s)
	          for (; i > o && (n = r.apply(e[o], a), n !== !1); o++)
	            ;
	        else
	          for (o in e)
	            if (n = r.apply(e[o], a), n === !1)
	              break;
	      } else if (s)
	        for (; i > o && (n = r.call(e[o], o, e[o]), n !== !1); o++)
	          ;
	      else
	        for (o in e)
	          if (n = r.call(e[o], o, e[o]), n === !1)
	            break;
	      return e;
	    }, $.data = function(e, t, a) {
	      if (void 0 === a) {
	        var n = e[$.expando],
	            o = n && r[n];
	        if (void 0 === t)
	          return o;
	        if (o && t in o)
	          return o[t];
	      } else if (void 0 !== t) {
	        var n = e[$.expando] || (e[$.expando] = ++$.uuid);
	        return r[n] = r[n] || {}, r[n][t] = a, a;
	      }
	    }, $.removeData = function(e, t) {
	      var a = e[$.expando],
	          n = a && r[a];
	      n && $.each(t, function(e, t) {
	        delete n[t];
	      });
	    }, $.extend = function() {
	      var e,
	          t,
	          r,
	          a,
	          n,
	          o,
	          i = arguments[0] || {},
	          s = 1,
	          l = arguments.length,
	          u = !1;
	      for ("boolean" == typeof i && (u = i, i = arguments[s] || {}, s++), "object" != typeof i && "function" !== $.type(i) && (i = {}), s === l && (i = this, s--); l > s; s++)
	        if (null != (n = arguments[s]))
	          for (a in n)
	            e = i[a], r = n[a], i !== r && (u && r && ($.isPlainObject(r) || (t = $.isArray(r))) ? (t ? (t = !1, o = e && $.isArray(e) ? e : []) : o = e && $.isPlainObject(e) ? e : {}, i[a] = $.extend(u, o, r)) : void 0 !== r && (i[a] = r));
	      return i;
	    }, $.queue = function(e, r, a) {
	      function n(e, r) {
	        var a = r || [];
	        return null != e && (t(Object(e)) ? !function(e, t) {
	          for (var r = +t.length,
	              a = 0,
	              n = e.length; r > a; )
	            e[n++] = t[a++];
	          if (r !== r)
	            for (; void 0 !== t[a]; )
	              e[n++] = t[a++];
	          return e.length = n, e;
	        }(a, "string" == typeof e ? [e] : e) : [].push.call(a, e)), a;
	      }
	      if (e) {
	        r = (r || "fx") + "queue";
	        var o = $.data(e, r);
	        return a ? (!o || $.isArray(a) ? o = $.data(e, r, n(a)) : o.push(a), o) : o || [];
	      }
	    }, $.dequeue = function(e, t) {
	      $.each(e.nodeType ? [e] : e, function(e, r) {
	        t = t || "fx";
	        var a = $.queue(r, t),
	            n = a.shift();
	        "inprogress" === n && (n = a.shift()), n && ("fx" === t && a.unshift("inprogress"), n.call(r, function() {
	          $.dequeue(r, t);
	        }));
	      });
	    }, $.fn = $.prototype = {
	      init: function(e) {
	        if (e.nodeType)
	          return this[0] = e, this;
	        throw new Error("Not a DOM node.");
	      },
	      offset: function() {
	        var t = this[0].getBoundingClientRect ? this[0].getBoundingClientRect() : {
	          top: 0,
	          left: 0
	        };
	        return {
	          top: t.top + (e.pageYOffset || document.scrollTop || 0) - (document.clientTop || 0),
	          left: t.left + (e.pageXOffset || document.scrollLeft || 0) - (document.clientLeft || 0)
	        };
	      },
	      position: function() {
	        function e() {
	          for (var e = this.offsetParent || document; e && "html" === !e.nodeType.toLowerCase && "static" === e.style.position; )
	            e = e.offsetParent;
	          return e || document;
	        }
	        var t = this[0],
	            e = e.apply(t),
	            r = this.offset(),
	            a = /^(?:body|html)$/i.test(e.nodeName) ? {
	              top: 0,
	              left: 0
	            } : $(e).offset();
	        return r.top -= parseFloat(t.style.marginTop) || 0, r.left -= parseFloat(t.style.marginLeft) || 0, e.style && (a.top += parseFloat(e.style.borderTopWidth) || 0, a.left += parseFloat(e.style.borderLeftWidth) || 0), {
	          top: r.top - a.top,
	          left: r.left - a.left
	        };
	      }
	    };
	    var r = {};
	    $.expando = "velocity" + (new Date).getTime(), $.uuid = 0;
	    for (var a = {},
	        n = a.hasOwnProperty,
	        o = a.toString,
	        i = "Boolean Number String Function Array Date RegExp Object Error".split(" "),
	        s = 0; s < i.length; s++)
	      a["[object " + i[s] + "]"] = i[s].toLowerCase();
	    $.fn.init.prototype = $.fn, e.Velocity = {Utilities: $};
	  }
	}(window), function(e) {
	  "object" == typeof module && "object" == typeof module.exports ? module.exports = e() : true ? !(__WEBPACK_AMD_DEFINE_FACTORY__ = (e), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) : e();
	}(function() {
	  return function(e, t, r, a) {
	    function n(e) {
	      for (var t = -1,
	          r = e ? e.length : 0,
	          a = []; ++t < r; ) {
	        var n = e[t];
	        n && a.push(n);
	      }
	      return a;
	    }
	    function o(e) {
	      return g.isWrapped(e) ? e = [].slice.call(e) : g.isNode(e) && (e = [e]), e;
	    }
	    function i(e) {
	      var t = $.data(e, "velocity");
	      return null === t ? a : t;
	    }
	    function s(e) {
	      return function(t) {
	        return Math.round(t * e) * (1 / e);
	      };
	    }
	    function l(e, r, a, n) {
	      function o(e, t) {
	        return 1 - 3 * t + 3 * e;
	      }
	      function i(e, t) {
	        return 3 * t - 6 * e;
	      }
	      function s(e) {
	        return 3 * e;
	      }
	      function l(e, t, r) {
	        return ((o(t, r) * e + i(t, r)) * e + s(t)) * e;
	      }
	      function u(e, t, r) {
	        return 3 * o(t, r) * e * e + 2 * i(t, r) * e + s(t);
	      }
	      function c(t, r) {
	        for (var n = 0; m > n; ++n) {
	          var o = u(r, e, a);
	          if (0 === o)
	            return r;
	          var i = l(r, e, a) - t;
	          r -= i / o;
	        }
	        return r;
	      }
	      function p() {
	        for (var t = 0; b > t; ++t)
	          w[t] = l(t * x, e, a);
	      }
	      function f(t, r, n) {
	        var o,
	            i,
	            s = 0;
	        do
	          i = r + (n - r) / 2, o = l(i, e, a) - t, o > 0 ? n = i : r = i;
	 while (Math.abs(o) > h && ++s < v);
	        return i;
	      }
	      function d(t) {
	        for (var r = 0,
	            n = 1,
	            o = b - 1; n != o && w[n] <= t; ++n)
	          r += x;
	        --n;
	        var i = (t - w[n]) / (w[n + 1] - w[n]),
	            s = r + i * x,
	            l = u(s, e, a);
	        return l >= y ? c(t, s) : 0 == l ? s : f(t, r, r + x);
	      }
	      function g() {
	        V = !0, (e != r || a != n) && p();
	      }
	      var m = 4,
	          y = .001,
	          h = 1e-7,
	          v = 10,
	          b = 11,
	          x = 1 / (b - 1),
	          S = "Float32Array" in t;
	      if (4 !== arguments.length)
	        return !1;
	      for (var P = 0; 4 > P; ++P)
	        if ("number" != typeof arguments[P] || isNaN(arguments[P]) || !isFinite(arguments[P]))
	          return !1;
	      e = Math.min(e, 1), a = Math.min(a, 1), e = Math.max(e, 0), a = Math.max(a, 0);
	      var w = S ? new Float32Array(b) : new Array(b),
	          V = !1,
	          C = function(t) {
	            return V || g(), e === r && a === n ? t : 0 === t ? 0 : 1 === t ? 1 : l(d(t), r, n);
	          };
	      C.getControlPoints = function() {
	        return [{
	          x: e,
	          y: r
	        }, {
	          x: a,
	          y: n
	        }];
	      };
	      var T = "generateBezier(" + [e, r, a, n] + ")";
	      return C.toString = function() {
	        return T;
	      }, C;
	    }
	    function u(e, t) {
	      var r = e;
	      return g.isString(e) ? v.Easings[e] || (r = !1) : r = g.isArray(e) && 1 === e.length ? s.apply(null, e) : g.isArray(e) && 2 === e.length ? b.apply(null, e.concat([t])) : g.isArray(e) && 4 === e.length ? l.apply(null, e) : !1, r === !1 && (r = v.Easings[v.defaults.easing] ? v.defaults.easing : h), r;
	    }
	    function c(e) {
	      if (e) {
	        var t = (new Date).getTime(),
	            r = v.State.calls.length;
	        r > 1e4 && (v.State.calls = n(v.State.calls));
	        for (var o = 0; r > o; o++)
	          if (v.State.calls[o]) {
	            var s = v.State.calls[o],
	                l = s[0],
	                u = s[2],
	                f = s[3],
	                d = !!f,
	                m = null;
	            f || (f = v.State.calls[o][3] = t - 16);
	            for (var y = Math.min((t - f) / u.duration, 1),
	                h = 0,
	                b = l.length; b > h; h++) {
	              var S = l[h],
	                  w = S.element;
	              if (i(w)) {
	                var V = !1;
	                if (u.display !== a && null !== u.display && "none" !== u.display) {
	                  if ("flex" === u.display) {
	                    var C = ["-webkit-box", "-moz-box", "-ms-flexbox", "-webkit-flex"];
	                    $.each(C, function(e, t) {
	                      x.setPropertyValue(w, "display", t);
	                    });
	                  }
	                  x.setPropertyValue(w, "display", u.display);
	                }
	                u.visibility !== a && "hidden" !== u.visibility && x.setPropertyValue(w, "visibility", u.visibility);
	                for (var T in S)
	                  if ("element" !== T) {
	                    var k = S[T],
	                        A,
	                        F = g.isString(k.easing) ? v.Easings[k.easing] : k.easing;
	                    if (1 === y)
	                      A = k.endValue;
	                    else {
	                      var E = k.endValue - k.startValue;
	                      if (A = k.startValue + E * F(y, u, E), !d && A === k.currentValue)
	                        continue;
	                    }
	                    if (k.currentValue = A, "tween" === T)
	                      m = A;
	                    else {
	                      if (x.Hooks.registered[T]) {
	                        var j = x.Hooks.getRoot(T),
	                            H = i(w).rootPropertyValueCache[j];
	                        H && (k.rootPropertyValue = H);
	                      }
	                      var N = x.setPropertyValue(w, T, k.currentValue + (0 === parseFloat(A) ? "" : k.unitType), k.rootPropertyValue, k.scrollData);
	                      x.Hooks.registered[T] && (i(w).rootPropertyValueCache[j] = x.Normalizations.registered[j] ? x.Normalizations.registered[j]("extract", null, N[1]) : N[1]), "transform" === N[0] && (V = !0);
	                    }
	                  }
	                u.mobileHA && i(w).transformCache.translate3d === a && (i(w).transformCache.translate3d = "(0px, 0px, 0px)", V = !0), V && x.flushTransformCache(w);
	              }
	            }
	            u.display !== a && "none" !== u.display && (v.State.calls[o][2].display = !1), u.visibility !== a && "hidden" !== u.visibility && (v.State.calls[o][2].visibility = !1), u.progress && u.progress.call(s[1], s[1], y, Math.max(0, f + u.duration - t), f, m), 1 === y && p(o);
	          }
	      }
	      v.State.isTicking && P(c);
	    }
	    function p(e, t) {
	      if (!v.State.calls[e])
	        return !1;
	      var p,
	          f,
	          $__0 = function() {
	            p = r[u].element;
	            if (t || o.loop || ("none" === o.display && x.setPropertyValue(p, "display", o.display), "hidden" === o.visibility && x.setPropertyValue(p, "visibility", o.visibility)), o.loop !== !0 && ($.queue(p)[1] === a || !/\.velocityQueueEntryFlag/i.test($.queue(p)[1])) && i(p)) {
	              i(p).isAnimating = !1, i(p).rootPropertyValueCache = {};
	              f = !1;
	              $.each(x.Lists.transforms3D, function(e, t) {
	                var r = /^scale/.test(t) ? 1 : 0,
	                    n = i(p).transformCache[t];
	                i(p).transformCache[t] !== a && new RegExp("^\\(" + r + "[^.]").test(n) && (f = !0, delete i(p).transformCache[t]);
	              }), o.mobileHA && (f = !0, delete i(p).transformCache.translate3d), f && x.flushTransformCache(p), x.Values.removeClass(p, "velocity-animating");
	            }
	            if (!t && o.complete && !o.loop && u === c - 1)
	              try {
	                o.complete.call(n, n);
	              } catch (d) {
	                setTimeout(function() {
	                  throw d;
	                }, 1);
	              }
	            s && o.loop !== !0 && s(n), i(p) && o.loop === !0 && !t && ($.each(i(p).tweensContainer, function(e, t) {
	              /^rotate/.test(e) && 360 === parseFloat(t.endValue) && (t.endValue = 0, t.startValue = 360), /^backgroundPosition/.test(e) && 100 === parseFloat(t.endValue) && "%" === t.unitType && (t.endValue = 0, t.startValue = 100);
	            }), v(p, "reverse", {
	              loop: !0,
	              delay: o.delay
	            })), o.queue !== !1 && $.dequeue(p, o.queue);
	          };
	      for (var r = v.State.calls[e][0],
	          n = v.State.calls[e][1],
	          o = v.State.calls[e][2],
	          s = v.State.calls[e][4],
	          l = !1,
	          u = 0,
	          c = r.length; c > u; u++) {
	        $__0();
	      }
	      v.State.calls[e] = !1;
	      for (var g = 0,
	          m = v.State.calls.length; m > g; g++)
	        if (v.State.calls[g] !== !1) {
	          l = !0;
	          break;
	        }
	      l === !1 && (v.State.isTicking = !1, delete v.State.calls, v.State.calls = []);
	    }
	    var f = function() {
	      if (r.documentMode)
	        return r.documentMode;
	      for (var e = 7; e > 4; e--) {
	        var t = r.createElement("div");
	        if (t.innerHTML = "<!--[if IE " + e + "]><span></span><![endif]-->", t.getElementsByTagName("span").length)
	          return t = null, e;
	      }
	      return a;
	    }(),
	        d = function() {
	          var e = 0;
	          return t.webkitRequestAnimationFrame || t.mozRequestAnimationFrame || function(t) {
	            var r = (new Date).getTime(),
	                a;
	            return a = Math.max(0, 16 - (r - e)), e = r + a, setTimeout(function() {
	              t(r + a);
	            }, a);
	          };
	        }(),
	        g = {
	          isString: function(e) {
	            return "string" == typeof e;
	          },
	          isArray: Array.isArray || function(e) {
	            return "[object Array]" === Object.prototype.toString.call(e);
	          },
	          isFunction: function(e) {
	            return "[object Function]" === Object.prototype.toString.call(e);
	          },
	          isNode: function(e) {
	            return e && e.nodeType;
	          },
	          isNodeList: function(e) {
	            return "object" == typeof e && /^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e)) && e.length !== a && (0 === e.length || "object" == typeof e[0] && e[0].nodeType > 0);
	          },
	          isWrapped: function(e) {
	            return e && (e.jquery || t.Zepto && t.Zepto.zepto.isZ(e));
	          },
	          isSVG: function(e) {
	            return t.SVGElement && e instanceof t.SVGElement;
	          },
	          isEmptyObject: function(e) {
	            for (var t in e)
	              return !1;
	            return !0;
	          }
	        },
	        $,
	        m = !1;
	    if (e.fn && e.fn.jquery ? ($ = e, m = !0) : $ = t.Velocity.Utilities, 8 >= f && !m)
	      throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");
	    if (7 >= f)
	      return void(jQuery.fn.velocity = jQuery.fn.animate);
	    var y = 400,
	        h = "swing",
	        v = {
	          State: {
	            isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
	            isAndroid: /Android/i.test(navigator.userAgent),
	            isGingerbread: /Android 2\.3\.[3-7]/i.test(navigator.userAgent),
	            isChrome: t.chrome,
	            isFirefox: /Firefox/i.test(navigator.userAgent),
	            prefixElement: r.createElement("div"),
	            prefixMatches: {},
	            scrollAnchor: null,
	            scrollPropertyLeft: null,
	            scrollPropertyTop: null,
	            isTicking: !1,
	            calls: []
	          },
	          CSS: {},
	          Utilities: $,
	          Redirects: {},
	          Easings: {},
	          Promise: t.Promise,
	          defaults: {
	            queue: "",
	            duration: y,
	            easing: h,
	            begin: a,
	            complete: a,
	            progress: a,
	            display: a,
	            visibility: a,
	            loop: !1,
	            delay: !1,
	            mobileHA: !0,
	            _cacheValues: !0
	          },
	          init: function(e) {
	            $.data(e, "velocity", {
	              isSVG: g.isSVG(e),
	              isAnimating: !1,
	              computedStyle: null,
	              tweensContainer: null,
	              rootPropertyValueCache: {},
	              transformCache: {}
	            });
	          },
	          hook: null,
	          mock: !1,
	          version: {
	            major: 1,
	            minor: 2,
	            patch: 2
	          },
	          debug: !1
	        };
	    t.pageYOffset !== a ? (v.State.scrollAnchor = t, v.State.scrollPropertyLeft = "pageXOffset", v.State.scrollPropertyTop = "pageYOffset") : (v.State.scrollAnchor = r.documentElement || r.body.parentNode || r.body, v.State.scrollPropertyLeft = "scrollLeft", v.State.scrollPropertyTop = "scrollTop");
	    var b = function() {
	      function e(e) {
	        return -e.tension * e.x - e.friction * e.v;
	      }
	      function t(t, r, a) {
	        var n = {
	          x: t.x + a.dx * r,
	          v: t.v + a.dv * r,
	          tension: t.tension,
	          friction: t.friction
	        };
	        return {
	          dx: n.v,
	          dv: e(n)
	        };
	      }
	      function r(r, a) {
	        var n = {
	          dx: r.v,
	          dv: e(r)
	        },
	            o = t(r, .5 * a, n),
	            i = t(r, .5 * a, o),
	            s = t(r, a, i),
	            l = 1 / 6 * (n.dx + 2 * (o.dx + i.dx) + s.dx),
	            u = 1 / 6 * (n.dv + 2 * (o.dv + i.dv) + s.dv);
	        return r.x = r.x + l * a, r.v = r.v + u * a, r;
	      }
	      return function a(e, t, n) {
	        var o = {
	          x: -1,
	          v: 0,
	          tension: null,
	          friction: null
	        },
	            i = [0],
	            s = 0,
	            l = 1e-4,
	            u = .016,
	            c,
	            p,
	            f;
	        for (e = parseFloat(e) || 500, t = parseFloat(t) || 20, n = n || null, o.tension = e, o.friction = t, c = null !== n, c ? (s = a(e, t), p = s / n * u) : p = u; ; )
	          if (f = r(f || o, p), i.push(1 + f.x), s += 16, !(Math.abs(f.x) > l && Math.abs(f.v) > l))
	            break;
	        return c ? function(e) {
	          return i[e * (i.length - 1) | 0];
	        } : s;
	      };
	    }();
	    v.Easings = {
	      linear: function(e) {
	        return e;
	      },
	      swing: function(e) {
	        return .5 - Math.cos(e * Math.PI) / 2;
	      },
	      spring: function(e) {
	        return 1 - Math.cos(4.5 * e * Math.PI) * Math.exp(6 * -e);
	      }
	    }, $.each([["ease", [.25, .1, .25, 1]], ["ease-in", [.42, 0, 1, 1]], ["ease-out", [0, 0, .58, 1]], ["ease-in-out", [.42, 0, .58, 1]], ["easeInSine", [.47, 0, .745, .715]], ["easeOutSine", [.39, .575, .565, 1]], ["easeInOutSine", [.445, .05, .55, .95]], ["easeInQuad", [.55, .085, .68, .53]], ["easeOutQuad", [.25, .46, .45, .94]], ["easeInOutQuad", [.455, .03, .515, .955]], ["easeInCubic", [.55, .055, .675, .19]], ["easeOutCubic", [.215, .61, .355, 1]], ["easeInOutCubic", [.645, .045, .355, 1]], ["easeInQuart", [.895, .03, .685, .22]], ["easeOutQuart", [.165, .84, .44, 1]], ["easeInOutQuart", [.77, 0, .175, 1]], ["easeInQuint", [.755, .05, .855, .06]], ["easeOutQuint", [.23, 1, .32, 1]], ["easeInOutQuint", [.86, 0, .07, 1]], ["easeInExpo", [.95, .05, .795, .035]], ["easeOutExpo", [.19, 1, .22, 1]], ["easeInOutExpo", [1, 0, 0, 1]], ["easeInCirc", [.6, .04, .98, .335]], ["easeOutCirc", [.075, .82, .165, 1]], ["easeInOutCirc", [.785, .135, .15, .86]]], function(e, t) {
	      v.Easings[t[0]] = l.apply(null, t[1]);
	    });
	    var x = v.CSS = {
	      RegEx: {
	        isHex: /^#([A-f\d]{3}){1,2}$/i,
	        valueUnwrap: /^[A-z]+\((.*)\)$/i,
	        wrappedValueAlreadyExtracted: /[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,
	        valueSplit: /([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi
	      },
	      Lists: {
	        colors: ["fill", "stroke", "stopColor", "color", "backgroundColor", "borderColor", "borderTopColor", "borderRightColor", "borderBottomColor", "borderLeftColor", "outlineColor"],
	        transformsBase: ["translateX", "translateY", "scale", "scaleX", "scaleY", "skewX", "skewY", "rotateZ"],
	        transforms3D: ["transformPerspective", "translateZ", "scaleZ", "rotateX", "rotateY"]
	      },
	      Hooks: {
	        templates: {
	          textShadow: ["Color X Y Blur", "black 0px 0px 0px"],
	          boxShadow: ["Color X Y Blur Spread", "black 0px 0px 0px 0px"],
	          clip: ["Top Right Bottom Left", "0px 0px 0px 0px"],
	          backgroundPosition: ["X Y", "0% 0%"],
	          transformOrigin: ["X Y Z", "50% 50% 0px"],
	          perspectiveOrigin: ["X Y", "50% 50%"]
	        },
	        registered: {},
	        register: function() {
	          for (var e = 0; e < x.Lists.colors.length; e++) {
	            var t = "color" === x.Lists.colors[e] ? "0 0 0 1" : "255 255 255 1";
	            x.Hooks.templates[x.Lists.colors[e]] = ["Red Green Blue Alpha", t];
	          }
	          var r,
	              a,
	              n;
	          if (f)
	            for (r in x.Hooks.templates) {
	              a = x.Hooks.templates[r], n = a[0].split(" ");
	              var o = a[1].match(x.RegEx.valueSplit);
	              "Color" === n[0] && (n.push(n.shift()), o.push(o.shift()), x.Hooks.templates[r] = [n.join(" "), o.join(" ")]);
	            }
	          for (r in x.Hooks.templates) {
	            a = x.Hooks.templates[r], n = a[0].split(" ");
	            for (var e in n) {
	              var i = r + n[e],
	                  s = e;
	              x.Hooks.registered[i] = [r, s];
	            }
	          }
	        },
	        getRoot: function(e) {
	          var t = x.Hooks.registered[e];
	          return t ? t[0] : e;
	        },
	        cleanRootPropertyValue: function(e, t) {
	          return x.RegEx.valueUnwrap.test(t) && (t = t.match(x.RegEx.valueUnwrap)[1]), x.Values.isCSSNullValue(t) && (t = x.Hooks.templates[e][1]), t;
	        },
	        extractValue: function(e, t) {
	          var r = x.Hooks.registered[e];
	          if (r) {
	            var a = r[0],
	                n = r[1];
	            return t = x.Hooks.cleanRootPropertyValue(a, t), t.toString().match(x.RegEx.valueSplit)[n];
	          }
	          return t;
	        },
	        injectValue: function(e, t, r) {
	          var a = x.Hooks.registered[e];
	          if (a) {
	            var n = a[0],
	                o = a[1],
	                i,
	                s;
	            return r = x.Hooks.cleanRootPropertyValue(n, r), i = r.toString().match(x.RegEx.valueSplit), i[o] = t, s = i.join(" ");
	          }
	          return r;
	        }
	      },
	      Normalizations: {
	        registered: {
	          clip: function(e, t, r) {
	            switch (e) {
	              case "name":
	                return "clip";
	              case "extract":
	                var a;
	                return x.RegEx.wrappedValueAlreadyExtracted.test(r) ? a = r : (a = r.toString().match(x.RegEx.valueUnwrap), a = a ? a[1].replace(/,(\s+)?/g, " ") : r), a;
	              case "inject":
	                return "rect(" + r + ")";
	            }
	          },
	          blur: function(e, t, r) {
	            switch (e) {
	              case "name":
	                return v.State.isFirefox ? "filter" : "-webkit-filter";
	              case "extract":
	                var a = parseFloat(r);
	                if (!a && 0 !== a) {
	                  var n = r.toString().match(/blur\(([0-9]+[A-z]+)\)/i);
	                  a = n ? n[1] : 0;
	                }
	                return a;
	              case "inject":
	                return parseFloat(r) ? "blur(" + r + ")" : "none";
	            }
	          },
	          opacity: function(e, t, r) {
	            if (8 >= f)
	              switch (e) {
	                case "name":
	                  return "filter";
	                case "extract":
	                  var a = r.toString().match(/alpha\(opacity=(.*)\)/i);
	                  return r = a ? a[1] / 100 : 1;
	                case "inject":
	                  return t.style.zoom = 1, parseFloat(r) >= 1 ? "" : "alpha(opacity=" + parseInt(100 * parseFloat(r), 10) + ")";
	              }
	            else
	              switch (e) {
	                case "name":
	                  return "opacity";
	                case "extract":
	                  return r;
	                case "inject":
	                  return r;
	              }
	          }
	        },
	        register: function() {
	          9 >= f || v.State.isGingerbread || (x.Lists.transformsBase = x.Lists.transformsBase.concat(x.Lists.transforms3D));
	          for (var e = 0; e < x.Lists.transformsBase.length; e++)
	            !function() {
	              var t = x.Lists.transformsBase[e];
	              x.Normalizations.registered[t] = function(e, r, n) {
	                switch (e) {
	                  case "name":
	                    return "transform";
	                  case "extract":
	                    return i(r) === a || i(r).transformCache[t] === a ? /^scale/i.test(t) ? 1 : 0 : i(r).transformCache[t].replace(/[()]/g, "");
	                  case "inject":
	                    var o = !1;
	                    switch (t.substr(0, t.length - 1)) {
	                      case "translate":
	                        o = !/(%|px|em|rem|vw|vh|\d)$/i.test(n);
	                        break;
	                      case "scal":
	                      case "scale":
	                        v.State.isAndroid && i(r).transformCache[t] === a && 1 > n && (n = 1), o = !/(\d)$/i.test(n);
	                        break;
	                      case "skew":
	                        o = !/(deg|\d)$/i.test(n);
	                        break;
	                      case "rotate":
	                        o = !/(deg|\d)$/i.test(n);
	                    }
	                    return o || (i(r).transformCache[t] = "(" + n + ")"), i(r).transformCache[t];
	                }
	              };
	            }();
	          for (var e = 0; e < x.Lists.colors.length; e++)
	            !function() {
	              var t = x.Lists.colors[e];
	              x.Normalizations.registered[t] = function(e, r, n) {
	                switch (e) {
	                  case "name":
	                    return t;
	                  case "extract":
	                    var o;
	                    if (x.RegEx.wrappedValueAlreadyExtracted.test(n))
	                      o = n;
	                    else {
	                      var i,
	                          s = {
	                            black: "rgb(0, 0, 0)",
	                            blue: "rgb(0, 0, 255)",
	                            gray: "rgb(128, 128, 128)",
	                            green: "rgb(0, 128, 0)",
	                            red: "rgb(255, 0, 0)",
	                            white: "rgb(255, 255, 255)"
	                          };
	                      /^[A-z]+$/i.test(n) ? i = s[n] !== a ? s[n] : s.black : x.RegEx.isHex.test(n) ? i = "rgb(" + x.Values.hexToRgb(n).join(" ") + ")" : /^rgba?\(/i.test(n) || (i = s.black), o = (i || n).toString().match(x.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g, " ");
	                    }
	                    return 8 >= f || 3 !== o.split(" ").length || (o += " 1"), o;
	                  case "inject":
	                    return 8 >= f ? 4 === n.split(" ").length && (n = n.split(/\s+/).slice(0, 3).join(" ")) : 3 === n.split(" ").length && (n += " 1"), (8 >= f ? "rgb" : "rgba") + "(" + n.replace(/\s+/g, ",").replace(/\.(\d)+(?=,)/g, "") + ")";
	                }
	              };
	            }();
	        }
	      },
	      Names: {
	        camelCase: function(e) {
	          return e.replace(/-(\w)/g, function(e, t) {
	            return t.toUpperCase();
	          });
	        },
	        SVGAttribute: function(e) {
	          var t = "width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";
	          return (f || v.State.isAndroid && !v.State.isChrome) && (t += "|transform"), new RegExp("^(" + t + ")$", "i").test(e);
	        },
	        prefixCheck: function(e) {
	          if (v.State.prefixMatches[e])
	            return [v.State.prefixMatches[e], !0];
	          for (var t = ["", "Webkit", "Moz", "ms", "O"],
	              r = 0,
	              a = t.length; a > r; r++) {
	            var n;
	            if (n = 0 === r ? e : t[r] + e.replace(/^\w/, function(e) {
	              return e.toUpperCase();
	            }), g.isString(v.State.prefixElement.style[n]))
	              return v.State.prefixMatches[e] = n, [n, !0];
	          }
	          return [e, !1];
	        }
	      },
	      Values: {
	        hexToRgb: function(e) {
	          var t = /^#?([a-f\d])([a-f\d])([a-f\d])$/i,
	              r = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,
	              a;
	          return e = e.replace(t, function(e, t, r, a) {
	            return t + t + r + r + a + a;
	          }), a = r.exec(e), a ? [parseInt(a[1], 16), parseInt(a[2], 16), parseInt(a[3], 16)] : [0, 0, 0];
	        },
	        isCSSNullValue: function(e) {
	          return 0 == e || /^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e);
	        },
	        getUnitType: function(e) {
	          return /^(rotate|skew)/i.test(e) ? "deg" : /(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e) ? "" : "px";
	        },
	        getDisplayType: function(e) {
	          var t = e && e.tagName.toString().toLowerCase();
	          return /^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t) ? "inline" : /^(li)$/i.test(t) ? "list-item" : /^(tr)$/i.test(t) ? "table-row" : /^(table)$/i.test(t) ? "table" : /^(tbody)$/i.test(t) ? "table-row-group" : "block";
	        },
	        addClass: function(e, t) {
	          e.classList ? e.classList.add(t) : e.className += (e.className.length ? " " : "") + t;
	        },
	        removeClass: function(e, t) {
	          e.classList ? e.classList.remove(t) : e.className = e.className.toString().replace(new RegExp("(^|\\s)" + t.split(" ").join("|") + "(\\s|$)", "gi"), " ");
	        }
	      },
	      getPropertyValue: function(e, r, n, o) {
	        function s(e, r) {
	          function n() {
	            u && x.setPropertyValue(e, "display", "none");
	          }
	          var l = 0;
	          if (8 >= f)
	            l = $.css(e, r);
	          else {
	            var u = !1;
	            if (/^(width|height)$/.test(r) && 0 === x.getPropertyValue(e, "display") && (u = !0, x.setPropertyValue(e, "display", x.Values.getDisplayType(e))), !o) {
	              if ("height" === r && "border-box" !== x.getPropertyValue(e, "boxSizing").toString().toLowerCase()) {
	                var c = e.offsetHeight - (parseFloat(x.getPropertyValue(e, "borderTopWidth")) || 0) - (parseFloat(x.getPropertyValue(e, "borderBottomWidth")) || 0) - (parseFloat(x.getPropertyValue(e, "paddingTop")) || 0) - (parseFloat(x.getPropertyValue(e, "paddingBottom")) || 0);
	                return n(), c;
	              }
	              if ("width" === r && "border-box" !== x.getPropertyValue(e, "boxSizing").toString().toLowerCase()) {
	                var p = e.offsetWidth - (parseFloat(x.getPropertyValue(e, "borderLeftWidth")) || 0) - (parseFloat(x.getPropertyValue(e, "borderRightWidth")) || 0) - (parseFloat(x.getPropertyValue(e, "paddingLeft")) || 0) - (parseFloat(x.getPropertyValue(e, "paddingRight")) || 0);
	                return n(), p;
	              }
	            }
	            var d;
	            d = i(e) === a ? t.getComputedStyle(e, null) : i(e).computedStyle ? i(e).computedStyle : i(e).computedStyle = t.getComputedStyle(e, null), "borderColor" === r && (r = "borderTopColor"), l = 9 === f && "filter" === r ? d.getPropertyValue(r) : d[r], ("" === l || null === l) && (l = e.style[r]), n();
	          }
	          if ("auto" === l && /^(top|right|bottom|left)$/i.test(r)) {
	            var g = s(e, "position");
	            ("fixed" === g || "absolute" === g && /top|left/i.test(r)) && (l = $(e).position()[r] + "px");
	          }
	          return l;
	        }
	        var l;
	        if (x.Hooks.registered[r]) {
	          var u = r,
	              c = x.Hooks.getRoot(u);
	          n === a && (n = x.getPropertyValue(e, x.Names.prefixCheck(c)[0])), x.Normalizations.registered[c] && (n = x.Normalizations.registered[c]("extract", e, n)), l = x.Hooks.extractValue(u, n);
	        } else if (x.Normalizations.registered[r]) {
	          var p,
	              d;
	          p = x.Normalizations.registered[r]("name", e), "transform" !== p && (d = s(e, x.Names.prefixCheck(p)[0]), x.Values.isCSSNullValue(d) && x.Hooks.templates[r] && (d = x.Hooks.templates[r][1])), l = x.Normalizations.registered[r]("extract", e, d);
	        }
	        if (!/^[\d-]/.test(l))
	          if (i(e) && i(e).isSVG && x.Names.SVGAttribute(r))
	            if (/^(height|width)$/i.test(r))
	              try {
	                l = e.getBBox()[r];
	              } catch (g) {
	                l = 0;
	              }
	            else
	              l = e.getAttribute(r);
	          else
	            l = s(e, x.Names.prefixCheck(r)[0]);
	        return x.Values.isCSSNullValue(l) && (l = 0), v.debug >= 2 && console.log("Get " + r + ": " + l), l;
	      },
	      setPropertyValue: function(e, r, a, n, o) {
	        var s = r;
	        if ("scroll" === r)
	          o.container ? o.container["scroll" + o.direction] = a : "Left" === o.direction ? t.scrollTo(a, o.alternateValue) : t.scrollTo(o.alternateValue, a);
	        else if (x.Normalizations.registered[r] && "transform" === x.Normalizations.registered[r]("name", e))
	          x.Normalizations.registered[r]("inject", e, a), s = "transform", a = i(e).transformCache[r];
	        else {
	          if (x.Hooks.registered[r]) {
	            var l = r,
	                u = x.Hooks.getRoot(r);
	            n = n || x.getPropertyValue(e, u), a = x.Hooks.injectValue(l, a, n), r = u;
	          }
	          if (x.Normalizations.registered[r] && (a = x.Normalizations.registered[r]("inject", e, a), r = x.Normalizations.registered[r]("name", e)), s = x.Names.prefixCheck(r)[0], 8 >= f)
	            try {
	              e.style[s] = a;
	            } catch (c) {
	              v.debug && console.log("Browser does not support [" + a + "] for [" + s + "]");
	            }
	          else
	            i(e) && i(e).isSVG && x.Names.SVGAttribute(r) ? e.setAttribute(r, a) : e.style[s] = a;
	          v.debug >= 2 && console.log("Set " + r + " (" + s + "): " + a);
	        }
	        return [s, a];
	      },
	      flushTransformCache: function(e) {
	        function t(t) {
	          return parseFloat(x.getPropertyValue(e, t));
	        }
	        var r = "";
	        if ((f || v.State.isAndroid && !v.State.isChrome) && i(e).isSVG) {
	          var a = {
	            translate: [t("translateX"), t("translateY")],
	            skewX: [t("skewX")],
	            skewY: [t("skewY")],
	            scale: 1 !== t("scale") ? [t("scale"), t("scale")] : [t("scaleX"), t("scaleY")],
	            rotate: [t("rotateZ"), 0, 0]
	          };
	          $.each(i(e).transformCache, function(e) {
	            /^translate/i.test(e) ? e = "translate" : /^scale/i.test(e) ? e = "scale" : /^rotate/i.test(e) && (e = "rotate"), a[e] && (r += e + "(" + a[e].join(" ") + ") ", delete a[e]);
	          });
	        } else {
	          var n,
	              o;
	          $.each(i(e).transformCache, function(t) {
	            return n = i(e).transformCache[t], "transformPerspective" === t ? (o = n, !0) : (9 === f && "rotateZ" === t && (t = "rotate"), void(r += t + n + " "));
	          }), o && (r = "perspective" + o + " " + r);
	        }
	        x.setPropertyValue(e, "transform", r);
	      }
	    };
	    x.Hooks.register(), x.Normalizations.register(), v.hook = function(e, t, r) {
	      var n = a;
	      return e = o(e), $.each(e, function(e, o) {
	        if (i(o) === a && v.init(o), r === a)
	          n === a && (n = v.CSS.getPropertyValue(o, t));
	        else {
	          var s = v.CSS.setPropertyValue(o, t, r);
	          "transform" === s[0] && v.CSS.flushTransformCache(o), n = s;
	        }
	      }), n;
	    };
	    var S = function() {
	      function e() {
	        return l ? T.promise || null : f;
	      }
	      function n() {
	        function e(e) {
	          function p(e, t) {
	            var r = a,
	                i = a,
	                s = a;
	            return g.isArray(e) ? (r = e[0], !g.isArray(e[1]) && /^[\d-]/.test(e[1]) || g.isFunction(e[1]) || x.RegEx.isHex.test(e[1]) ? s = e[1] : (g.isString(e[1]) && !x.RegEx.isHex.test(e[1]) || g.isArray(e[1])) && (i = t ? e[1] : u(e[1], o.duration), e[2] !== a && (s = e[2]))) : r = e, t || (i = i || o.easing), g.isFunction(r) && (r = r.call(n, w, P)), g.isFunction(s) && (s = s.call(n, w, P)), [r || 0, i, s];
	          }
	          function f(e, t) {
	            var r,
	                a;
	            return a = (t || "0").toString().toLowerCase().replace(/[%A-z]+$/, function(e) {
	              return r = e, "";
	            }), r || (r = x.Values.getUnitType(e)), [a, r];
	          }
	          function d() {
	            var e = {
	              myParent: n.parentNode || r.body,
	              position: x.getPropertyValue(n, "position"),
	              fontSize: x.getPropertyValue(n, "fontSize")
	            },
	                a = e.position === N.lastPosition && e.myParent === N.lastParent,
	                o = e.fontSize === N.lastFontSize;
	            N.lastParent = e.myParent, N.lastPosition = e.position, N.lastFontSize = e.fontSize;
	            var s = 100,
	                l = {};
	            if (o && a)
	              l.emToPx = N.lastEmToPx, l.percentToPxWidth = N.lastPercentToPxWidth, l.percentToPxHeight = N.lastPercentToPxHeight;
	            else {
	              var u = i(n).isSVG ? r.createElementNS("http://www.w3.org/2000/svg", "rect") : r.createElement("div");
	              v.init(u), e.myParent.appendChild(u), $.each(["overflow", "overflowX", "overflowY"], function(e, t) {
	                v.CSS.setPropertyValue(u, t, "hidden");
	              }), v.CSS.setPropertyValue(u, "position", e.position), v.CSS.setPropertyValue(u, "fontSize", e.fontSize), v.CSS.setPropertyValue(u, "boxSizing", "content-box"), $.each(["minWidth", "maxWidth", "width", "minHeight", "maxHeight", "height"], function(e, t) {
	                v.CSS.setPropertyValue(u, t, s + "%");
	              }), v.CSS.setPropertyValue(u, "paddingLeft", s + "em"), l.percentToPxWidth = N.lastPercentToPxWidth = (parseFloat(x.getPropertyValue(u, "width", null, !0)) || 1) / s, l.percentToPxHeight = N.lastPercentToPxHeight = (parseFloat(x.getPropertyValue(u, "height", null, !0)) || 1) / s, l.emToPx = N.lastEmToPx = (parseFloat(x.getPropertyValue(u, "paddingLeft")) || 1) / s, e.myParent.removeChild(u);
	            }
	            return null === N.remToPx && (N.remToPx = parseFloat(x.getPropertyValue(r.body, "fontSize")) || 16), null === N.vwToPx && (N.vwToPx = parseFloat(t.innerWidth) / 100, N.vhToPx = parseFloat(t.innerHeight) / 100), l.remToPx = N.remToPx, l.vwToPx = N.vwToPx, l.vhToPx = N.vhToPx, v.debug >= 1 && console.log("Unit ratios: " + JSON.stringify(l), n), l;
	          }
	          if (o.begin && 0 === w)
	            try {
	              o.begin.call(m, m);
	            } catch (y) {
	              setTimeout(function() {
	                throw y;
	              }, 1);
	            }
	          if ("scroll" === k) {
	            var S = /^x$/i.test(o.axis) ? "Left" : "Top",
	                V = parseFloat(o.offset) || 0,
	                C,
	                A,
	                F;
	            o.container ? g.isWrapped(o.container) || g.isNode(o.container) ? (o.container = o.container[0] || o.container, C = o.container["scroll" + S], F = C + $(n).position()[S.toLowerCase()] + V) : o.container = null : (C = v.State.scrollAnchor[v.State["scrollProperty" + S]], A = v.State.scrollAnchor[v.State["scrollProperty" + ("Left" === S ? "Top" : "Left")]], F = $(n).offset()[S.toLowerCase()] + V), s = {
	              scroll: {
	                rootPropertyValue: !1,
	                startValue: C,
	                currentValue: C,
	                endValue: F,
	                unitType: "",
	                easing: o.easing,
	                scrollData: {
	                  container: o.container,
	                  direction: S,
	                  alternateValue: A
	                }
	              },
	              element: n
	            }, v.debug && console.log("tweensContainer (scroll): ", s.scroll, n);
	          } else if ("reverse" === k) {
	            if (!i(n).tweensContainer)
	              return void $.dequeue(n, o.queue);
	            "none" === i(n).opts.display && (i(n).opts.display = "auto"), "hidden" === i(n).opts.visibility && (i(n).opts.visibility = "visible"), i(n).opts.loop = !1, i(n).opts.begin = null, i(n).opts.complete = null, b.easing || delete o.easing, b.duration || delete o.duration, o = $.extend({}, i(n).opts, o);
	            var E = $.extend(!0, {}, i(n).tweensContainer);
	            for (var j in E)
	              if ("element" !== j) {
	                var H = E[j].startValue;
	                E[j].startValue = E[j].currentValue = E[j].endValue, E[j].endValue = H, g.isEmptyObject(b) || (E[j].easing = o.easing), v.debug && console.log("reverse tweensContainer (" + j + "): " + JSON.stringify(E[j]), n);
	              }
	            s = E;
	          } else if ("start" === k) {
	            var E;
	            i(n).tweensContainer && i(n).isAnimating === !0 && (E = i(n).tweensContainer), $.each(h, function(e, t) {
	              if (RegExp("^" + x.Lists.colors.join("$|^") + "$").test(e)) {
	                var r = p(t, !0),
	                    n = r[0],
	                    o = r[1],
	                    i = r[2];
	                if (x.RegEx.isHex.test(n)) {
	                  for (var s = ["Red", "Green", "Blue"],
	                      l = x.Values.hexToRgb(n),
	                      u = i ? x.Values.hexToRgb(i) : a,
	                      c = 0; c < s.length; c++) {
	                    var f = [l[c]];
	                    o && f.push(o), u !== a && f.push(u[c]), h[e + s[c]] = f;
	                  }
	                  delete h[e];
	                }
	              }
	            });
	            for (var R in h) {
	              var O = p(h[R]),
	                  z = O[0],
	                  q = O[1],
	                  M = O[2];
	              R = x.Names.camelCase(R);
	              var I = x.Hooks.getRoot(R),
	                  B = !1;
	              if (i(n).isSVG || "tween" === I || x.Names.prefixCheck(I)[1] !== !1 || x.Normalizations.registered[I] !== a) {
	                (o.display !== a && null !== o.display && "none" !== o.display || o.visibility !== a && "hidden" !== o.visibility) && /opacity|filter/.test(R) && !M && 0 !== z && (M = 0), o._cacheValues && E && E[R] ? (M === a && (M = E[R].endValue + E[R].unitType), B = i(n).rootPropertyValueCache[I]) : x.Hooks.registered[R] ? M === a ? (B = x.getPropertyValue(n, I), M = x.getPropertyValue(n, R, B)) : B = x.Hooks.templates[I][1] : M === a && (M = x.getPropertyValue(n, R));
	                var W,
	                    G,
	                    D,
	                    X = !1;
	                if (W = f(R, M), M = W[0], D = W[1], W = f(R, z), z = W[0].replace(/^([+-\/*])=/, function(e, t) {
	                  return X = t, "";
	                }), G = W[1], M = parseFloat(M) || 0, z = parseFloat(z) || 0, "%" === G && (/^(fontSize|lineHeight)$/.test(R) ? (z /= 100, G = "em") : /^scale/.test(R) ? (z /= 100, G = "") : /(Red|Green|Blue)$/i.test(R) && (z = z / 100 * 255, G = "")), /[\/*]/.test(X))
	                  G = D;
	                else if (D !== G && 0 !== M)
	                  if (0 === z)
	                    G = D;
	                  else {
	                    l = l || d();
	                    var Y = /margin|padding|left|right|width|text|word|letter/i.test(R) || /X$/.test(R) || "x" === R ? "x" : "y";
	                    switch (D) {
	                      case "%":
	                        M *= "x" === Y ? l.percentToPxWidth : l.percentToPxHeight;
	                        break;
	                      case "px":
	                        break;
	                      default:
	                        M *= l[D + "ToPx"];
	                    }
	                    switch (G) {
	                      case "%":
	                        M *= 1 / ("x" === Y ? l.percentToPxWidth : l.percentToPxHeight);
	                        break;
	                      case "px":
	                        break;
	                      default:
	                        M *= 1 / l[G + "ToPx"];
	                    }
	                  }
	                switch (X) {
	                  case "+":
	                    z = M + z;
	                    break;
	                  case "-":
	                    z = M - z;
	                    break;
	                  case "*":
	                    z = M * z;
	                    break;
	                  case "/":
	                    z = M / z;
	                }
	                s[R] = {
	                  rootPropertyValue: B,
	                  startValue: M,
	                  currentValue: M,
	                  endValue: z,
	                  unitType: G,
	                  easing: q
	                }, v.debug && console.log("tweensContainer (" + R + "): " + JSON.stringify(s[R]), n);
	              } else
	                v.debug && console.log("Skipping [" + I + "] due to a lack of browser support.");
	            }
	            s.element = n;
	          }
	          s.element && (x.Values.addClass(n, "velocity-animating"), L.push(s), "" === o.queue && (i(n).tweensContainer = s, i(n).opts = o), i(n).isAnimating = !0, w === P - 1 ? (v.State.calls.push([L, m, o, null, T.resolver]), v.State.isTicking === !1 && (v.State.isTicking = !0, c())) : w++);
	        }
	        var n = this,
	            o = $.extend({}, v.defaults, b),
	            s = {},
	            l;
	        switch (i(n) === a && v.init(n), parseFloat(o.delay) && o.queue !== !1 && $.queue(n, o.queue, function(e) {
	          v.velocityQueueEntryFlag = !0, i(n).delayTimer = {
	            setTimeout: setTimeout(e, parseFloat(o.delay)),
	            next: e
	          };
	        }), o.duration.toString().toLowerCase()) {
	          case "fast":
	            o.duration = 200;
	            break;
	          case "normal":
	            o.duration = y;
	            break;
	          case "slow":
	            o.duration = 600;
	            break;
	          default:
	            o.duration = parseFloat(o.duration) || 1;
	        }
	        v.mock !== !1 && (v.mock === !0 ? o.duration = o.delay = 1 : (o.duration *= parseFloat(v.mock) || 1, o.delay *= parseFloat(v.mock) || 1)), o.easing = u(o.easing, o.duration), o.begin && !g.isFunction(o.begin) && (o.begin = null), o.progress && !g.isFunction(o.progress) && (o.progress = null), o.complete && !g.isFunction(o.complete) && (o.complete = null), o.display !== a && null !== o.display && (o.display = o.display.toString().toLowerCase(), "auto" === o.display && (o.display = v.CSS.Values.getDisplayType(n))), o.visibility !== a && null !== o.visibility && (o.visibility = o.visibility.toString().toLowerCase()), o.mobileHA = o.mobileHA && v.State.isMobile && !v.State.isGingerbread, o.queue === !1 ? o.delay ? setTimeout(e, o.delay) : e() : $.queue(n, o.queue, function(t, r) {
	          return r === !0 ? (T.promise && T.resolver(m), !0) : (v.velocityQueueEntryFlag = !0, void e(t));
	        }), "" !== o.queue && "fx" !== o.queue || "inprogress" === $.queue(n)[0] || $.dequeue(n);
	      }
	      var s = arguments[0] && (arguments[0].p || $.isPlainObject(arguments[0].properties) && !arguments[0].properties.names || g.isString(arguments[0].properties)),
	          l,
	          f,
	          d,
	          m,
	          h,
	          b;
	      if (g.isWrapped(this) ? (l = !1, d = 0, m = this, f = this) : (l = !0, d = 1, m = s ? arguments[0].elements || arguments[0].e : arguments[0]), m = o(m)) {
	        s ? (h = arguments[0].properties || arguments[0].p, b = arguments[0].options || arguments[0].o) : (h = arguments[d], b = arguments[d + 1]);
	        var P = m.length,
	            w = 0;
	        if (!/^(stop|finish)$/i.test(h) && !$.isPlainObject(b)) {
	          var V = d + 1;
	          b = {};
	          for (var C = V; C < arguments.length; C++)
	            g.isArray(arguments[C]) || !/^(fast|normal|slow)$/i.test(arguments[C]) && !/^\d/.test(arguments[C]) ? g.isString(arguments[C]) || g.isArray(arguments[C]) ? b.easing = arguments[C] : g.isFunction(arguments[C]) && (b.complete = arguments[C]) : b.duration = arguments[C];
	        }
	        var T = {
	          promise: null,
	          resolver: null,
	          rejecter: null
	        };
	        l && v.Promise && (T.promise = new v.Promise(function(e, t) {
	          T.resolver = e, T.rejecter = t;
	        }));
	        var k;
	        switch (h) {
	          case "scroll":
	            k = "scroll";
	            break;
	          case "reverse":
	            k = "reverse";
	            break;
	          case "finish":
	          case "stop":
	            $.each(m, function(e, t) {
	              i(t) && i(t).delayTimer && (clearTimeout(i(t).delayTimer.setTimeout), i(t).delayTimer.next && i(t).delayTimer.next(), delete i(t).delayTimer);
	            });
	            var A = [];
	            return $.each(v.State.calls, function(e, t) {
	              t && $.each(t[1], function(r, n) {
	                var o = b === a ? "" : b;
	                return o === !0 || t[2].queue === o || b === a && t[2].queue === !1 ? void $.each(m, function(r, a) {
	                  a === n && ((b === !0 || g.isString(b)) && ($.each($.queue(a, g.isString(b) ? b : ""), function(e, t) {
	                    g.isFunction(t) && t(null, !0);
	                  }), $.queue(a, g.isString(b) ? b : "", [])), "stop" === h ? (i(a) && i(a).tweensContainer && o !== !1 && $.each(i(a).tweensContainer, function(e, t) {
	                    t.endValue = t.currentValue;
	                  }), A.push(e)) : "finish" === h && (t[2].duration = 1));
	                }) : !0;
	              });
	            }), "stop" === h && ($.each(A, function(e, t) {
	              p(t, !0);
	            }), T.promise && T.resolver(m)), e();
	          default:
	            if (!$.isPlainObject(h) || g.isEmptyObject(h)) {
	              if (g.isString(h) && v.Redirects[h]) {
	                var F = $.extend({}, b),
	                    E = F.duration,
	                    j = F.delay || 0;
	                return F.backwards === !0 && (m = $.extend(!0, [], m).reverse()), $.each(m, function(e, t) {
	                  parseFloat(F.stagger) ? F.delay = j + parseFloat(F.stagger) * e : g.isFunction(F.stagger) && (F.delay = j + F.stagger.call(t, e, P)), F.drag && (F.duration = parseFloat(E) || (/^(callout|transition)/.test(h) ? 1e3 : y), F.duration = Math.max(F.duration * (F.backwards ? 1 - e / P : (e + 1) / P), .75 * F.duration, 200)), v.Redirects[h].call(t, t, F || {}, e, P, m, T.promise ? T : a);
	                }), e();
	              }
	              var H = "Velocity: First argument (" + h + ") was not a property map, a known action, or a registered redirect. Aborting.";
	              return T.promise ? T.rejecter(new Error(H)) : console.log(H), e();
	            }
	            k = "start";
	        }
	        var N = {
	          lastParent: null,
	          lastPosition: null,
	          lastFontSize: null,
	          lastPercentToPxWidth: null,
	          lastPercentToPxHeight: null,
	          lastEmToPx: null,
	          remToPx: null,
	          vwToPx: null,
	          vhToPx: null
	        },
	            L = [];
	        $.each(m, function(e, t) {
	          g.isNode(t) && n.call(t);
	        });
	        var F = $.extend({}, v.defaults, b),
	            R;
	        if (F.loop = parseInt(F.loop), R = 2 * F.loop - 1, F.loop)
	          for (var O = 0; R > O; O++) {
	            var z = {
	              delay: F.delay,
	              progress: F.progress
	            };
	            O === R - 1 && (z.display = F.display, z.visibility = F.visibility, z.complete = F.complete), S(m, "reverse", z);
	          }
	        return e();
	      }
	    };
	    v = $.extend(S, v), v.animate = S;
	    var P = t.requestAnimationFrame || d;
	    return v.State.isMobile || r.hidden === a || r.addEventListener("visibilitychange", function() {
	      r.hidden ? (P = function(e) {
	        return setTimeout(function() {
	          e(!0);
	        }, 16);
	      }, c()) : P = t.requestAnimationFrame || d;
	    }), e.Velocity = v, e !== t && (e.fn.velocity = S, e.fn.velocity.defaults = v.defaults), $.each(["Down", "Up"], function(e, t) {
	      v.Redirects["slide" + t] = function(e, r, n, o, i, s) {
	        var l = $.extend({}, r),
	            u = l.begin,
	            c = l.complete,
	            p = {
	              height: "",
	              marginTop: "",
	              marginBottom: "",
	              paddingTop: "",
	              paddingBottom: ""
	            },
	            f = {};
	        l.display === a && (l.display = "Down" === t ? "inline" === v.CSS.Values.getDisplayType(e) ? "inline-block" : "block" : "none"), l.begin = function() {
	          u && u.call(i, i);
	          for (var r in p) {
	            f[r] = e.style[r];
	            var a = v.CSS.getPropertyValue(e, r);
	            p[r] = "Down" === t ? [a, 0] : [0, a];
	          }
	          f.overflow = e.style.overflow, e.style.overflow = "hidden";
	        }, l.complete = function() {
	          for (var t in f)
	            e.style[t] = f[t];
	          c && c.call(i, i), s && s.resolver(i);
	        }, v(e, p, l);
	      };
	    }), $.each(["In", "Out"], function(e, t) {
	      v.Redirects["fade" + t] = function(e, r, n, o, i, s) {
	        var l = $.extend({}, r),
	            u = {opacity: "In" === t ? 1 : 0},
	            c = l.complete;
	        l.complete = n !== o - 1 ? l.begin = null : function() {
	          c && c.call(i, i), s && s.resolver(i);
	        }, l.display === a && (l.display = "In" === t ? "auto" : "none"), v(this, u, l);
	      };
	    }), v;
	  }(window.jQuery || window.Zepto || window, window, document);
	});


/***/ },
/* 36 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* WEBPACK VAR INJECTION */(function(module) {(function() {
	  var Color,
	      K,
	      PITHIRD,
	      TWOPI,
	      X,
	      Y,
	      Z,
	      bezier,
	      brewer,
	      chroma,
	      clip_rgb,
	      colors,
	      cos,
	      css2rgb,
	      hex2rgb,
	      hsi2rgb,
	      hsl2rgb,
	      hsv2rgb,
	      lab2lch,
	      lab2rgb,
	      lab_xyz,
	      lch2lab,
	      lch2rgb,
	      limit,
	      luminance,
	      luminance_x,
	      rgb2hex,
	      rgb2hsi,
	      rgb2hsl,
	      rgb2hsv,
	      rgb2lab,
	      rgb2lch,
	      rgb_xyz,
	      root,
	      type,
	      unpack,
	      xyz_lab,
	      xyz_rgb,
	      _ref;
	  chroma = function(x, y, z, m) {
	    return new Color(x, y, z, m);
	  };
	  if ((typeof module !== "undefined" && module !== null) && (module.exports != null)) {
	    module.exports = chroma;
	  }
	  if (true) {
	    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function() {
	      return chroma;
	    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	  } else {
	    root = typeof exports !== "undefined" && exports !== null ? exports : this;
	    root.chroma = chroma;
	  }
	  chroma.color = function(x, y, z, m) {
	    return new Color(x, y, z, m);
	  };
	  chroma.hsl = function(h, s, l, a) {
	    return new Color(h, s, l, a, 'hsl');
	  };
	  chroma.hsv = function(h, s, v, a) {
	    return new Color(h, s, v, a, 'hsv');
	  };
	  chroma.rgb = function(r, g, b, a) {
	    return new Color(r, g, b, a, 'rgb');
	  };
	  chroma.hex = function(x) {
	    return new Color(x);
	  };
	  chroma.css = function(x) {
	    return new Color(x);
	  };
	  chroma.lab = function(l, a, b) {
	    return new Color(l, a, b, 'lab');
	  };
	  chroma.lch = function(l, c, h) {
	    return new Color(l, c, h, 'lch');
	  };
	  chroma.hsi = function(h, s, i) {
	    return new Color(h, s, i, 'hsi');
	  };
	  chroma.gl = function(r, g, b, a) {
	    return new Color(r * 255, g * 255, b * 255, a, 'gl');
	  };
	  chroma.interpolate = function(a, b, f, m) {
	    if ((a == null) || (b == null)) {
	      return '#000';
	    }
	    if (type(a) === 'string') {
	      a = new Color(a);
	    }
	    if (type(b) === 'string') {
	      b = new Color(b);
	    }
	    return a.interpolate(f, b, m);
	  };
	  chroma.mix = chroma.interpolate;
	  chroma.contrast = function(a, b) {
	    var l1,
	        l2;
	    if (type(a) === 'string') {
	      a = new Color(a);
	    }
	    if (type(b) === 'string') {
	      b = new Color(b);
	    }
	    l1 = a.luminance();
	    l2 = b.luminance();
	    if (l1 > l2) {
	      return (l1 + 0.05) / (l2 + 0.05);
	    } else {
	      return (l2 + 0.05) / (l1 + 0.05);
	    }
	  };
	  chroma.luminance = function(color) {
	    return chroma(color).luminance();
	  };
	  chroma._Color = Color;
	  Color = (function() {
	    function Color() {
	      var a,
	          arg,
	          args,
	          m,
	          me,
	          me_rgb,
	          x,
	          y,
	          z,
	          _i,
	          _len,
	          _ref,
	          _ref1,
	          _ref2,
	          _ref3;
	      me = this;
	      args = [];
	      for (_i = 0, _len = arguments.length; _i < _len; _i++) {
	        arg = arguments[_i];
	        if (arg != null) {
	          args.push(arg);
	        }
	      }
	      if (args.length === 0) {
	        _ref = [255, 0, 255, 1, 'rgb'], x = _ref[0], y = _ref[1], z = _ref[2], a = _ref[3], m = _ref[4];
	      } else if (type(args[0]) === "array") {
	        if (args[0].length === 3) {
	          _ref1 = args[0], x = _ref1[0], y = _ref1[1], z = _ref1[2];
	          a = 1;
	        } else if (args[0].length === 4) {
	          _ref2 = args[0], x = _ref2[0], y = _ref2[1], z = _ref2[2], a = _ref2[3];
	        } else {
	          throw 'unknown input argument';
	        }
	        m = args[1];
	      } else if (type(args[0]) === "string") {
	        x = args[0];
	        m = 'hex';
	      } else if (type(args[0]) === "object") {
	        _ref3 = args[0]._rgb, x = _ref3[0], y = _ref3[1], z = _ref3[2], a = _ref3[3];
	        m = 'rgb';
	      } else if (args.length >= 3) {
	        x = args[0];
	        y = args[1];
	        z = args[2];
	      }
	      if (args.length === 3) {
	        m = 'rgb';
	        a = 1;
	      } else if (args.length === 4) {
	        if (type(args[3]) === "string") {
	          m = args[3];
	          a = 1;
	        } else if (type(args[3]) === "number") {
	          m = 'rgb';
	          a = args[3];
	        }
	      } else if (args.length === 5) {
	        a = args[3];
	        m = args[4];
	      }
	      if (a == null) {
	        a = 1;
	      }
	      if (m === 'rgb') {
	        me._rgb = [x, y, z, a];
	      } else if (m === 'gl') {
	        me._rgb = [x * 255, y * 255, z * 255, a];
	      } else if (m === 'hsl') {
	        me._rgb = hsl2rgb(x, y, z);
	        me._rgb[3] = a;
	      } else if (m === 'hsv') {
	        me._rgb = hsv2rgb(x, y, z);
	        me._rgb[3] = a;
	      } else if (m === 'hex') {
	        me._rgb = hex2rgb(x);
	      } else if (m === 'lab') {
	        me._rgb = lab2rgb(x, y, z);
	        me._rgb[3] = a;
	      } else if (m === 'lch') {
	        me._rgb = lch2rgb(x, y, z);
	        me._rgb[3] = a;
	      } else if (m === 'hsi') {
	        me._rgb = hsi2rgb(x, y, z);
	        me._rgb[3] = a;
	      }
	      me_rgb = clip_rgb(me._rgb);
	    }
	    Color.prototype.rgb = function() {
	      return this._rgb.slice(0, 3);
	    };
	    Color.prototype.rgba = function() {
	      return this._rgb;
	    };
	    Color.prototype.hex = function() {
	      return rgb2hex(this._rgb);
	    };
	    Color.prototype.toString = function() {
	      return this.name();
	    };
	    Color.prototype.hsl = function() {
	      return rgb2hsl(this._rgb);
	    };
	    Color.prototype.hsv = function() {
	      return rgb2hsv(this._rgb);
	    };
	    Color.prototype.lab = function() {
	      return rgb2lab(this._rgb);
	    };
	    Color.prototype.lch = function() {
	      return rgb2lch(this._rgb);
	    };
	    Color.prototype.hsi = function() {
	      return rgb2hsi(this._rgb);
	    };
	    Color.prototype.gl = function() {
	      return [this._rgb[0] / 255, this._rgb[1] / 255, this._rgb[2] / 255, this._rgb[3]];
	    };
	    Color.prototype.luminance = function() {
	      return luminance(this._rgb);
	    };
	    Color.prototype.name = function() {
	      var h,
	          k;
	      h = this.hex();
	      for (k in chroma.colors) {
	        if (h === chroma.colors[k]) {
	          return k;
	        }
	      }
	      return h;
	    };
	    Color.prototype.alpha = function(alpha) {
	      if (arguments.length) {
	        this._rgb[3] = alpha;
	        return this;
	      }
	      return this._rgb[3];
	    };
	    Color.prototype.css = function(mode) {
	      var hsl,
	          me,
	          rgb,
	          rnd;
	      if (mode == null) {
	        mode = 'rgb';
	      }
	      me = this;
	      rgb = me._rgb;
	      if (mode.length === 3 && rgb[3] < 1) {
	        mode += 'a';
	      }
	      if (mode === 'rgb') {
	        return mode + '(' + rgb.slice(0, 3).join(',') + ')';
	      } else if (mode === 'rgba') {
	        return mode + '(' + rgb.join(',') + ')';
	      } else if (mode === 'hsl' || mode === 'hsla') {
	        hsl = me.hsl();
	        rnd = function(a) {
	          return Math.round(a * 100) / 100;
	        };
	        hsl[0] = rnd(hsl[0]);
	        hsl[1] = rnd(hsl[1] * 100) + '%';
	        hsl[2] = rnd(hsl[2] * 100) + '%';
	        if (mode.length === 4) {
	          hsl[3] = rgb[3];
	        }
	        return mode + '(' + hsl.join(',') + ')';
	      }
	    };
	    Color.prototype.interpolate = function(f, col, m) {
	      var dh,
	          hue,
	          hue0,
	          hue1,
	          lbv,
	          lbv0,
	          lbv1,
	          me,
	          res,
	          sat,
	          sat0,
	          sat1,
	          xyz0,
	          xyz1;
	      me = this;
	      if (m == null) {
	        m = 'rgb';
	      }
	      if (type(col) === "string") {
	        col = new Color(col);
	      }
	      if (m === 'hsl' || m === 'hsv' || m === 'lch' || m === 'hsi') {
	        if (m === 'hsl') {
	          xyz0 = me.hsl();
	          xyz1 = col.hsl();
	        } else if (m === 'hsv') {
	          xyz0 = me.hsv();
	          xyz1 = col.hsv();
	        } else if (m === 'hsi') {
	          xyz0 = me.hsi();
	          xyz1 = col.hsi();
	        } else if (m === 'lch') {
	          xyz0 = me.lch();
	          xyz1 = col.lch();
	        }
	        if (m.substr(0, 1) === 'h') {
	          hue0 = xyz0[0], sat0 = xyz0[1], lbv0 = xyz0[2];
	          hue1 = xyz1[0], sat1 = xyz1[1], lbv1 = xyz1[2];
	        } else {
	          lbv0 = xyz0[0], sat0 = xyz0[1], hue0 = xyz0[2];
	          lbv1 = xyz1[0], sat1 = xyz1[1], hue1 = xyz1[2];
	        }
	        if (!isNaN(hue0) && !isNaN(hue1)) {
	          if (hue1 > hue0 && hue1 - hue0 > 180) {
	            dh = hue1 - (hue0 + 360);
	          } else if (hue1 < hue0 && hue0 - hue1 > 180) {
	            dh = hue1 + 360 - hue0;
	          } else {
	            dh = hue1 - hue0;
	          }
	          hue = hue0 + f * dh;
	        } else if (!isNaN(hue0)) {
	          hue = hue0;
	          if ((lbv1 === 1 || lbv1 === 0) && m !== 'hsv') {
	            sat = sat0;
	          }
	        } else if (!isNaN(hue1)) {
	          hue = hue1;
	          if ((lbv0 === 1 || lbv0 === 0) && m !== 'hsv') {
	            sat = sat1;
	          }
	        } else {
	          hue = Number.NaN;
	        }
	        if (sat == null) {
	          sat = sat0 + f * (sat1 - sat0);
	        }
	        lbv = lbv0 + f * (lbv1 - lbv0);
	        if (m.substr(0, 1) === 'h') {
	          res = new Color(hue, sat, lbv, m);
	        } else {
	          res = new Color(lbv, sat, hue, m);
	        }
	      } else if (m === 'rgb') {
	        xyz0 = me._rgb;
	        xyz1 = col._rgb;
	        res = new Color(xyz0[0] + f * (xyz1[0] - xyz0[0]), xyz0[1] + f * (xyz1[1] - xyz0[1]), xyz0[2] + f * (xyz1[2] - xyz0[2]), m);
	      } else if (m === 'lab') {
	        xyz0 = me.lab();
	        xyz1 = col.lab();
	        res = new Color(xyz0[0] + f * (xyz1[0] - xyz0[0]), xyz0[1] + f * (xyz1[1] - xyz0[1]), xyz0[2] + f * (xyz1[2] - xyz0[2]), m);
	      } else {
	        throw "color mode " + m + " is not supported";
	      }
	      res.alpha(me.alpha() + f * (col.alpha() - me.alpha()));
	      return res;
	    };
	    Color.prototype.premultiply = function() {
	      var a,
	          rgb;
	      rgb = this.rgb();
	      a = this.alpha();
	      return chroma(rgb[0] * a, rgb[1] * a, rgb[2] * a, a);
	    };
	    Color.prototype.darken = function(amount) {
	      var lch,
	          me;
	      if (amount == null) {
	        amount = 20;
	      }
	      me = this;
	      lch = me.lch();
	      lch[0] -= amount;
	      return chroma.lch(lch).alpha(me.alpha());
	    };
	    Color.prototype.darker = function(amount) {
	      return this.darken(amount);
	    };
	    Color.prototype.brighten = function(amount) {
	      if (amount == null) {
	        amount = 20;
	      }
	      return this.darken(-amount);
	    };
	    Color.prototype.brighter = function(amount) {
	      return this.brighten(amount);
	    };
	    Color.prototype.saturate = function(amount) {
	      var lch,
	          me;
	      if (amount == null) {
	        amount = 20;
	      }
	      me = this;
	      lch = me.lch();
	      lch[1] += amount;
	      return chroma.lch(lch).alpha(me.alpha());
	    };
	    Color.prototype.desaturate = function(amount) {
	      if (amount == null) {
	        amount = 20;
	      }
	      return this.saturate(-amount);
	    };
	    return Color;
	  })();
	  clip_rgb = function(rgb) {
	    var i;
	    for (i in rgb) {
	      if (i < 3) {
	        if (rgb[i] < 0) {
	          rgb[i] = 0;
	        }
	        if (rgb[i] > 255) {
	          rgb[i] = 255;
	        }
	      } else if (i === 3) {
	        if (rgb[i] < 0) {
	          rgb[i] = 0;
	        }
	        if (rgb[i] > 1) {
	          rgb[i] = 1;
	        }
	      }
	    }
	    return rgb;
	  };
	  css2rgb = function(css) {
	    var hsl,
	        i,
	        m,
	        rgb,
	        _i,
	        _j,
	        _k,
	        _l;
	    css = css.toLowerCase();
	    if ((chroma.colors != null) && chroma.colors[css]) {
	      return hex2rgb(chroma.colors[css]);
	    }
	    if (m = css.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)) {
	      rgb = m.slice(1, 4);
	      for (i = _i = 0; _i <= 2; i = ++_i) {
	        rgb[i] = +rgb[i];
	      }
	      rgb[3] = 1;
	    } else if (m = css.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/)) {
	      rgb = m.slice(1, 5);
	      for (i = _j = 0; _j <= 3; i = ++_j) {
	        rgb[i] = +rgb[i];
	      }
	    } else if (m = css.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)) {
	      rgb = m.slice(1, 4);
	      for (i = _k = 0; _k <= 2; i = ++_k) {
	        rgb[i] = Math.round(rgb[i] * 2.55);
	      }
	      rgb[3] = 1;
	    } else if (m = css.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)) {
	      rgb = m.slice(1, 5);
	      for (i = _l = 0; _l <= 2; i = ++_l) {
	        rgb[i] = Math.round(rgb[i] * 2.55);
	      }
	      rgb[3] = +rgb[3];
	    } else if (m = css.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)) {
	      hsl = m.slice(1, 4);
	      hsl[1] *= 0.01;
	      hsl[2] *= 0.01;
	      rgb = hsl2rgb(hsl);
	      rgb[3] = 1;
	    } else if (m = css.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)) {
	      hsl = m.slice(1, 4);
	      hsl[1] *= 0.01;
	      hsl[2] *= 0.01;
	      rgb = hsl2rgb(hsl);
	      rgb[3] = +m[4];
	    }
	    return rgb;
	  };
	  hex2rgb = function(hex) {
	    var a,
	        b,
	        g,
	        r,
	        rgb,
	        u;
	    if (hex.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)) {
	      if (hex.length === 4 || hex.length === 7) {
	        hex = hex.substr(1);
	      }
	      if (hex.length === 3) {
	        hex = hex.split("");
	        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
	      }
	      u = parseInt(hex, 16);
	      r = u >> 16;
	      g = u >> 8 & 0xFF;
	      b = u & 0xFF;
	      return [r, g, b, 1];
	    }
	    if (hex.match(/^#?([A-Fa-f0-9]{8})$/)) {
	      if (hex.length === 9) {
	        hex = hex.substr(1);
	      }
	      u = parseInt(hex, 16);
	      r = u >> 24 & 0xFF;
	      g = u >> 16 & 0xFF;
	      b = u >> 8 & 0xFF;
	      a = u & 0xFF;
	      return [r, g, b, a];
	    }
	    if (rgb = css2rgb(hex)) {
	      return rgb;
	    }
	    throw "unknown color: " + hex;
	  };
	  hsi2rgb = function(h, s, i) {
	    var b,
	        g,
	        r,
	        _ref;
	    _ref = unpack(arguments), h = _ref[0], s = _ref[1], i = _ref[2];
	    h /= 360;
	    if (h < 1 / 3) {
	      b = (1 - s) / 3;
	      r = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;
	      g = 1 - (b + r);
	    } else if (h < 2 / 3) {
	      h -= 1 / 3;
	      r = (1 - s) / 3;
	      g = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;
	      b = 1 - (r + g);
	    } else {
	      h -= 2 / 3;
	      g = (1 - s) / 3;
	      b = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;
	      r = 1 - (g + b);
	    }
	    r = limit(i * r * 3);
	    g = limit(i * g * 3);
	    b = limit(i * b * 3);
	    return [r * 255, g * 255, b * 255];
	  };
	  hsl2rgb = function() {
	    var b,
	        c,
	        g,
	        h,
	        i,
	        l,
	        r,
	        s,
	        t1,
	        t2,
	        t3,
	        _i,
	        _ref,
	        _ref1;
	    _ref = unpack(arguments), h = _ref[0], s = _ref[1], l = _ref[2];
	    if (s === 0) {
	      r = g = b = l * 255;
	    } else {
	      t3 = [0, 0, 0];
	      c = [0, 0, 0];
	      t2 = l < 0.5 ? l * (1 + s) : l + s - l * s;
	      t1 = 2 * l - t2;
	      h /= 360;
	      t3[0] = h + 1 / 3;
	      t3[1] = h;
	      t3[2] = h - 1 / 3;
	      for (i = _i = 0; _i <= 2; i = ++_i) {
	        if (t3[i] < 0) {
	          t3[i] += 1;
	        }
	        if (t3[i] > 1) {
	          t3[i] -= 1;
	        }
	        if (6 * t3[i] < 1) {
	          c[i] = t1 + (t2 - t1) * 6 * t3[i];
	        } else if (2 * t3[i] < 1) {
	          c[i] = t2;
	        } else if (3 * t3[i] < 2) {
	          c[i] = t1 + (t2 - t1) * ((2 / 3) - t3[i]) * 6;
	        } else {
	          c[i] = t1;
	        }
	      }
	      _ref1 = [Math.round(c[0] * 255), Math.round(c[1] * 255), Math.round(c[2] * 255)], r = _ref1[0], g = _ref1[1], b = _ref1[2];
	    }
	    return [r, g, b];
	  };
	  hsv2rgb = function() {
	    var b,
	        f,
	        g,
	        h,
	        i,
	        p,
	        q,
	        r,
	        s,
	        t,
	        v,
	        _ref,
	        _ref1,
	        _ref2,
	        _ref3,
	        _ref4,
	        _ref5,
	        _ref6;
	    _ref = unpack(arguments), h = _ref[0], s = _ref[1], v = _ref[2];
	    v *= 255;
	    if (s === 0) {
	      r = g = b = v;
	    } else {
	      if (h === 360) {
	        h = 0;
	      }
	      if (h > 360) {
	        h -= 360;
	      }
	      if (h < 0) {
	        h += 360;
	      }
	      h /= 60;
	      i = Math.floor(h);
	      f = h - i;
	      p = v * (1 - s);
	      q = v * (1 - s * f);
	      t = v * (1 - s * (1 - f));
	      switch (i) {
	        case 0:
	          _ref1 = [v, t, p], r = _ref1[0], g = _ref1[1], b = _ref1[2];
	          break;
	        case 1:
	          _ref2 = [q, v, p], r = _ref2[0], g = _ref2[1], b = _ref2[2];
	          break;
	        case 2:
	          _ref3 = [p, v, t], r = _ref3[0], g = _ref3[1], b = _ref3[2];
	          break;
	        case 3:
	          _ref4 = [p, q, v], r = _ref4[0], g = _ref4[1], b = _ref4[2];
	          break;
	        case 4:
	          _ref5 = [t, p, v], r = _ref5[0], g = _ref5[1], b = _ref5[2];
	          break;
	        case 5:
	          _ref6 = [v, p, q], r = _ref6[0], g = _ref6[1], b = _ref6[2];
	      }
	    }
	    r = Math.round(r);
	    g = Math.round(g);
	    b = Math.round(b);
	    return [r, g, b];
	  };
	  K = 18;
	  X = 0.950470;
	  Y = 1;
	  Z = 1.088830;
	  lab2lch = function() {
	    var a,
	        b,
	        c,
	        h,
	        l,
	        _ref;
	    _ref = unpack(arguments), l = _ref[0], a = _ref[1], b = _ref[2];
	    c = Math.sqrt(a * a + b * b);
	    h = Math.atan2(b, a) / Math.PI * 180;
	    return [l, c, h];
	  };
	  lab2rgb = function(l, a, b) {
	    var g,
	        r,
	        x,
	        y,
	        z,
	        _ref,
	        _ref1;
	    if (l !== void 0 && l.length === 3) {
	      _ref = l, l = _ref[0], a = _ref[1], b = _ref[2];
	    }
	    if (l !== void 0 && l.length === 3) {
	      _ref1 = l, l = _ref1[0], a = _ref1[1], b = _ref1[2];
	    }
	    y = (l + 16) / 116;
	    x = y + a / 500;
	    z = y - b / 200;
	    x = lab_xyz(x) * X;
	    y = lab_xyz(y) * Y;
	    z = lab_xyz(z) * Z;
	    r = xyz_rgb(3.2404542 * x - 1.5371385 * y - 0.4985314 * z);
	    g = xyz_rgb(-0.9692660 * x + 1.8760108 * y + 0.0415560 * z);
	    b = xyz_rgb(0.0556434 * x - 0.2040259 * y + 1.0572252 * z);
	    return [limit(r, 0, 255), limit(g, 0, 255), limit(b, 0, 255), 1];
	  };
	  lab_xyz = function(x) {
	    if (x > 0.206893034) {
	      return x * x * x;
	    } else {
	      return (x - 4 / 29) / 7.787037;
	    }
	  };
	  xyz_rgb = function(r) {
	    return Math.round(255 * (r <= 0.00304 ? 12.92 * r : 1.055 * Math.pow(r, 1 / 2.4) - 0.055));
	  };
	  lch2lab = function() {
	    var c,
	        h,
	        l,
	        _ref;
	    _ref = unpack(arguments), l = _ref[0], c = _ref[1], h = _ref[2];
	    h = h * Math.PI / 180;
	    return [l, Math.cos(h) * c, Math.sin(h) * c];
	  };
	  lch2rgb = function(l, c, h) {
	    var L,
	        a,
	        b,
	        g,
	        r,
	        _ref,
	        _ref1;
	    _ref = lch2lab(l, c, h), L = _ref[0], a = _ref[1], b = _ref[2];
	    _ref1 = lab2rgb(L, a, b), r = _ref1[0], g = _ref1[1], b = _ref1[2];
	    return [limit(r, 0, 255), limit(g, 0, 255), limit(b, 0, 255)];
	  };
	  luminance = function(r, g, b) {
	    var _ref;
	    _ref = unpack(arguments), r = _ref[0], g = _ref[1], b = _ref[2];
	    r = luminance_x(r);
	    g = luminance_x(g);
	    b = luminance_x(b);
	    return 0.2126 * r + 0.7152 * g + 0.0722 * b;
	  };
	  luminance_x = function(x) {
	    x /= 255;
	    if (x <= 0.03928) {
	      return x / 12.92;
	    } else {
	      return Math.pow((x + 0.055) / 1.055, 2.4);
	    }
	  };
	  rgb2hex = function() {
	    var b,
	        g,
	        r,
	        str,
	        u,
	        _ref;
	    _ref = unpack(arguments), r = _ref[0], g = _ref[1], b = _ref[2];
	    u = r << 16 | g << 8 | b;
	    str = "000000" + u.toString(16);
	    return "#" + str.substr(str.length - 6);
	  };
	  rgb2hsi = function() {
	    var TWOPI,
	        b,
	        g,
	        h,
	        i,
	        min,
	        r,
	        s,
	        _ref;
	    _ref = unpack(arguments), r = _ref[0], g = _ref[1], b = _ref[2];
	    TWOPI = Math.PI * 2;
	    r /= 255;
	    g /= 255;
	    b /= 255;
	    min = Math.min(r, g, b);
	    i = (r + g + b) / 3;
	    s = 1 - min / i;
	    if (s === 0) {
	      h = 0;
	    } else {
	      h = ((r - g) + (r - b)) / 2;
	      h /= Math.sqrt((r - g) * (r - g) + (r - b) * (g - b));
	      h = Math.acos(h);
	      if (b > g) {
	        h = TWOPI - h;
	      }
	      h /= TWOPI;
	    }
	    return [h * 360, s, i];
	  };
	  rgb2hsl = function(r, g, b) {
	    var h,
	        l,
	        max,
	        min,
	        s,
	        _ref;
	    if (r !== void 0 && r.length >= 3) {
	      _ref = r, r = _ref[0], g = _ref[1], b = _ref[2];
	    }
	    r /= 255;
	    g /= 255;
	    b /= 255;
	    min = Math.min(r, g, b);
	    max = Math.max(r, g, b);
	    l = (max + min) / 2;
	    if (max === min) {
	      s = 0;
	      h = Number.NaN;
	    } else {
	      s = l < 0.5 ? (max - min) / (max + min) : (max - min) / (2 - max - min);
	    }
	    if (r === max) {
	      h = (g - b) / (max - min);
	    } else if (g === max) {
	      h = 2 + (b - r) / (max - min);
	    } else if (b === max) {
	      h = 4 + (r - g) / (max - min);
	    }
	    h *= 60;
	    if (h < 0) {
	      h += 360;
	    }
	    return [h, s, l];
	  };
	  rgb2hsv = function() {
	    var b,
	        delta,
	        g,
	        h,
	        max,
	        min,
	        r,
	        s,
	        v,
	        _ref;
	    _ref = unpack(arguments), r = _ref[0], g = _ref[1], b = _ref[2];
	    min = Math.min(r, g, b);
	    max = Math.max(r, g, b);
	    delta = max - min;
	    v = max / 255.0;
	    if (max === 0) {
	      h = Number.NaN;
	      s = 0;
	    } else {
	      s = delta / max;
	      if (r === max) {
	        h = (g - b) / delta;
	      }
	      if (g === max) {
	        h = 2 + (b - r) / delta;
	      }
	      if (b === max) {
	        h = 4 + (r - g) / delta;
	      }
	      h *= 60;
	      if (h < 0) {
	        h += 360;
	      }
	    }
	    return [h, s, v];
	  };
	  rgb2lab = function() {
	    var b,
	        g,
	        r,
	        x,
	        y,
	        z,
	        _ref;
	    _ref = unpack(arguments), r = _ref[0], g = _ref[1], b = _ref[2];
	    r = rgb_xyz(r);
	    g = rgb_xyz(g);
	    b = rgb_xyz(b);
	    x = xyz_lab((0.4124564 * r + 0.3575761 * g + 0.1804375 * b) / X);
	    y = xyz_lab((0.2126729 * r + 0.7151522 * g + 0.0721750 * b) / Y);
	    z = xyz_lab((0.0193339 * r + 0.1191920 * g + 0.9503041 * b) / Z);
	    return [116 * y - 16, 500 * (x - y), 200 * (y - z)];
	  };
	  rgb_xyz = function(r) {
	    if ((r /= 255) <= 0.04045) {
	      return r / 12.92;
	    } else {
	      return Math.pow((r + 0.055) / 1.055, 2.4);
	    }
	  };
	  xyz_lab = function(x) {
	    if (x > 0.008856) {
	      return Math.pow(x, 1 / 3);
	    } else {
	      return 7.787037 * x + 4 / 29;
	    }
	  };
	  rgb2lch = function() {
	    var a,
	        b,
	        g,
	        l,
	        r,
	        _ref,
	        _ref1;
	    _ref = unpack(arguments), r = _ref[0], g = _ref[1], b = _ref[2];
	    _ref1 = rgb2lab(r, g, b), l = _ref1[0], a = _ref1[1], b = _ref1[2];
	    return lab2lch(l, a, b);
	  };
	  chroma.scale = function(colors, positions) {
	    var classifyValue,
	        f,
	        getClass,
	        getColor,
	        resetCache,
	        setColors,
	        setDomain,
	        tmap,
	        _colorCache,
	        _colors,
	        _correctLightness,
	        _domain,
	        _fixed,
	        _max,
	        _min,
	        _mode,
	        _nacol,
	        _numClasses,
	        _out,
	        _pos,
	        _spread;
	    _mode = 'rgb';
	    _nacol = chroma('#ccc');
	    _spread = 0;
	    _fixed = false;
	    _domain = [0, 1];
	    _colors = [];
	    _out = false;
	    _pos = [];
	    _min = 0;
	    _max = 1;
	    _correctLightness = false;
	    _numClasses = 0;
	    _colorCache = {};
	    setColors = function(colors, positions) {
	      var c,
	          col,
	          _i,
	          _j,
	          _ref,
	          _ref1,
	          _ref2;
	      if (colors == null) {
	        colors = ['#ddd', '#222'];
	      }
	      if ((colors != null) && type(colors) === 'string' && (((_ref = chroma.brewer) != null ? _ref[colors] : void 0) != null)) {
	        colors = chroma.brewer[colors];
	      }
	      if (type(colors) === 'array') {
	        colors = colors.slice(0);
	        for (c = _i = 0, _ref1 = colors.length - 1; 0 <= _ref1 ? _i <= _ref1 : _i >= _ref1; c = 0 <= _ref1 ? ++_i : --_i) {
	          col = colors[c];
	          if (type(col) === "string") {
	            colors[c] = chroma(col);
	          }
	        }
	        if (positions != null) {
	          _pos = positions;
	        } else {
	          _pos = [];
	          for (c = _j = 0, _ref2 = colors.length - 1; 0 <= _ref2 ? _j <= _ref2 : _j >= _ref2; c = 0 <= _ref2 ? ++_j : --_j) {
	            _pos.push(c / (colors.length - 1));
	          }
	        }
	      }
	      resetCache();
	      return _colors = colors;
	    };
	    setDomain = function(domain) {
	      if (domain == null) {
	        domain = [];
	      }
	      _domain = domain;
	      _min = domain[0];
	      _max = domain[domain.length - 1];
	      resetCache();
	      if (domain.length === 2) {
	        return _numClasses = 0;
	      } else {
	        return _numClasses = domain.length - 1;
	      }
	    };
	    getClass = function(value) {
	      var i,
	          n;
	      if (_domain != null) {
	        n = _domain.length - 1;
	        i = 0;
	        while (i < n && value >= _domain[i]) {
	          i++;
	        }
	        return i - 1;
	      }
	      return 0;
	    };
	    tmap = function(t) {
	      return t;
	    };
	    classifyValue = function(value) {
	      var i,
	          maxc,
	          minc,
	          n,
	          val;
	      val = value;
	      if (_domain.length > 2) {
	        n = _domain.length - 1;
	        i = getClass(value);
	        minc = _domain[0] + (_domain[1] - _domain[0]) * (0 + _spread * 0.5);
	        maxc = _domain[n - 1] + (_domain[n] - _domain[n - 1]) * (1 - _spread * 0.5);
	        val = _min + ((_domain[i] + (_domain[i + 1] - _domain[i]) * 0.5 - minc) / (maxc - minc)) * (_max - _min);
	      }
	      return val;
	    };
	    getColor = function(val, bypassMap) {
	      var c,
	          col,
	          f0,
	          i,
	          k,
	          p,
	          t,
	          _i,
	          _ref;
	      if (bypassMap == null) {
	        bypassMap = false;
	      }
	      if (isNaN(val)) {
	        return _nacol;
	      }
	      if (!bypassMap) {
	        if (_domain.length > 2) {
	          c = getClass(val);
	          t = c / (_numClasses - 1);
	        } else {
	          t = f0 = (val - _min) / (_max - _min);
	          t = Math.min(1, Math.max(0, t));
	        }
	      } else {
	        t = val;
	      }
	      if (!bypassMap) {
	        t = tmap(t);
	      }
	      k = Math.floor(t * 10000);
	      if (_colorCache[k]) {
	        col = _colorCache[k];
	      } else {
	        if (type(_colors) === 'array') {
	          for (i = _i = 0, _ref = _pos.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
	            p = _pos[i];
	            if (t <= p) {
	              col = _colors[i];
	              break;
	            }
	            if (t >= p && i === _pos.length - 1) {
	              col = _colors[i];
	              break;
	            }
	            if (t > p && t < _pos[i + 1]) {
	              t = (t - p) / (_pos[i + 1] - p);
	              col = chroma.interpolate(_colors[i], _colors[i + 1], t, _mode);
	              break;
	            }
	          }
	        } else if (type(_colors) === 'function') {
	          col = _colors(t);
	        }
	        _colorCache[k] = col;
	      }
	      return col;
	    };
	    resetCache = function() {
	      return _colorCache = {};
	    };
	    setColors(colors, positions);
	    f = function(v) {
	      var c;
	      c = getColor(v);
	      if (_out && c[_out]) {
	        return c[_out]();
	      } else {
	        return c;
	      }
	    };
	    f.domain = function(domain, classes, mode, key) {
	      var d;
	      if (mode == null) {
	        mode = 'e';
	      }
	      if (!arguments.length) {
	        return _domain;
	      }
	      if (classes != null) {
	        d = chroma.analyze(domain, key);
	        if (classes === 0) {
	          domain = [d.min, d.max];
	        } else {
	          domain = chroma.limits(d, mode, classes);
	        }
	      }
	      setDomain(domain);
	      return f;
	    };
	    f.mode = function(_m) {
	      if (!arguments.length) {
	        return _mode;
	      }
	      _mode = _m;
	      resetCache();
	      return f;
	    };
	    f.range = function(colors, _pos) {
	      setColors(colors, _pos);
	      return f;
	    };
	    f.out = function(_o) {
	      _out = _o;
	      return f;
	    };
	    f.spread = function(val) {
	      if (!arguments.length) {
	        return _spread;
	      }
	      _spread = val;
	      return f;
	    };
	    f.correctLightness = function(v) {
	      if (!arguments.length) {
	        return _correctLightness;
	      }
	      _correctLightness = v;
	      resetCache();
	      if (_correctLightness) {
	        tmap = function(t) {
	          var L0,
	              L1,
	              L_actual,
	              L_diff,
	              L_ideal,
	              max_iter,
	              pol,
	              t0,
	              t1;
	          L0 = getColor(0, true).lab()[0];
	          L1 = getColor(1, true).lab()[0];
	          pol = L0 > L1;
	          L_actual = getColor(t, true).lab()[0];
	          L_ideal = L0 + (L1 - L0) * t;
	          L_diff = L_actual - L_ideal;
	          t0 = 0;
	          t1 = 1;
	          max_iter = 20;
	          while (Math.abs(L_diff) > 1e-2 && max_iter-- > 0) {
	            (function() {
	              if (pol) {
	                L_diff *= -1;
	              }
	              if (L_diff < 0) {
	                t0 = t;
	                t += (t1 - t) * 0.5;
	              } else {
	                t1 = t;
	                t += (t0 - t) * 0.5;
	              }
	              L_actual = getColor(t, true).lab()[0];
	              return L_diff = L_actual - L_ideal;
	            })();
	          }
	          return t;
	        };
	      } else {
	        tmap = function(t) {
	          return t;
	        };
	      }
	      return f;
	    };
	    f.colors = function(out) {
	      var i,
	          samples,
	          _i,
	          _j,
	          _len,
	          _ref;
	      if (out == null) {
	        out = 'hex';
	      }
	      colors = [];
	      samples = [];
	      if (_domain.length > 2) {
	        for (i = _i = 1, _ref = _domain.length; 1 <= _ref ? _i < _ref : _i > _ref; i = 1 <= _ref ? ++_i : --_i) {
	          samples.push((_domain[i - 1] + _domain[i]) * 0.5);
	        }
	      } else {
	        samples = _domain;
	      }
	      for (_j = 0, _len = samples.length; _j < _len; _j++) {
	        i = samples[_j];
	        colors.push(f(i)[out]());
	      }
	      return colors;
	    };
	    return f;
	  };
	  if ((_ref = chroma.scales) == null) {
	    chroma.scales = {};
	  }
	  chroma.scales.cool = function() {
	    return chroma.scale([chroma.hsl(180, 1, .9), chroma.hsl(250, .7, .4)]);
	  };
	  chroma.scales.hot = function() {
	    return chroma.scale(['#000', '#f00', '#ff0', '#fff'], [0, .25, .75, 1]).mode('rgb');
	  };
	  chroma.analyze = function(data, key, filter) {
	    var add,
	        k,
	        r,
	        val,
	        visit,
	        _i,
	        _len;
	    r = {
	      min: Number.MAX_VALUE,
	      max: Number.MAX_VALUE * -1,
	      sum: 0,
	      values: [],
	      count: 0
	    };
	    if (filter == null) {
	      filter = function() {
	        return true;
	      };
	    }
	    add = function(val) {
	      if ((val != null) && !isNaN(val)) {
	        r.values.push(val);
	        r.sum += val;
	        if (val < r.min) {
	          r.min = val;
	        }
	        if (val > r.max) {
	          r.max = val;
	        }
	        r.count += 1;
	      }
	    };
	    visit = function(val, k) {
	      if (filter(val, k)) {
	        if ((key != null) && type(key) === 'function') {
	          return add(key(val));
	        } else if ((key != null) && type(key) === 'string' || type(key) === 'number') {
	          return add(val[key]);
	        } else {
	          return add(val);
	        }
	      }
	    };
	    if (type(data) === 'array') {
	      for (_i = 0, _len = data.length; _i < _len; _i++) {
	        val = data[_i];
	        visit(val);
	      }
	    } else {
	      for (k in data) {
	        val = data[k];
	        visit(val, k);
	      }
	    }
	    r.domain = [r.min, r.max];
	    r.limits = function(mode, num) {
	      return chroma.limits(r, mode, num);
	    };
	    return r;
	  };
	  chroma.limits = function(data, mode, num) {
	    var assignments,
	        best,
	        centroids,
	        cluster,
	        clusterSizes,
	        dist,
	        i,
	        j,
	        kClusters,
	        limits,
	        max,
	        max_log,
	        min,
	        min_log,
	        mindist,
	        n,
	        nb_iters,
	        newCentroids,
	        p,
	        pb,
	        pr,
	        repeat,
	        sum,
	        tmpKMeansBreaks,
	        value,
	        values,
	        _i,
	        _j,
	        _k,
	        _l,
	        _m,
	        _n,
	        _o,
	        _p,
	        _q,
	        _r,
	        _ref1,
	        _ref10,
	        _ref11,
	        _ref12,
	        _ref13,
	        _ref14,
	        _ref15,
	        _ref2,
	        _ref3,
	        _ref4,
	        _ref5,
	        _ref6,
	        _ref7,
	        _ref8,
	        _ref9,
	        _s,
	        _t,
	        _u,
	        _v,
	        _w;
	    if (mode == null) {
	      mode = 'equal';
	    }
	    if (num == null) {
	      num = 7;
	    }
	    if (data.values == null) {
	      data = chroma.analyze(data);
	    }
	    min = data.min;
	    max = data.max;
	    sum = data.sum;
	    values = data.values.sort(function(a, b) {
	      return a - b;
	    });
	    limits = [];
	    if (mode.substr(0, 1) === 'c') {
	      limits.push(min);
	      limits.push(max);
	    }
	    if (mode.substr(0, 1) === 'e') {
	      limits.push(min);
	      for (i = _i = 1, _ref1 = num - 1; 1 <= _ref1 ? _i <= _ref1 : _i >= _ref1; i = 1 <= _ref1 ? ++_i : --_i) {
	        limits.push(min + (i / num) * (max - min));
	      }
	      limits.push(max);
	    } else if (mode.substr(0, 1) === 'l') {
	      if (min <= 0) {
	        throw 'Logarithmic scales are only possible for values > 0';
	      }
	      min_log = Math.LOG10E * Math.log(min);
	      max_log = Math.LOG10E * Math.log(max);
	      limits.push(min);
	      for (i = _j = 1, _ref2 = num - 1; 1 <= _ref2 ? _j <= _ref2 : _j >= _ref2; i = 1 <= _ref2 ? ++_j : --_j) {
	        limits.push(Math.pow(10, min_log + (i / num) * (max_log - min_log)));
	      }
	      limits.push(max);
	    } else if (mode.substr(0, 1) === 'q') {
	      limits.push(min);
	      for (i = _k = 1, _ref3 = num - 1; 1 <= _ref3 ? _k <= _ref3 : _k >= _ref3; i = 1 <= _ref3 ? ++_k : --_k) {
	        p = values.length * i / num;
	        pb = Math.floor(p);
	        if (pb === p) {
	          limits.push(values[pb]);
	        } else {
	          pr = p - pb;
	          limits.push(values[pb] * pr + values[pb + 1] * (1 - pr));
	        }
	      }
	      limits.push(max);
	    } else if (mode.substr(0, 1) === 'k') {
	      n = values.length;
	      assignments = new Array(n);
	      clusterSizes = new Array(num);
	      repeat = true;
	      nb_iters = 0;
	      centroids = null;
	      centroids = [];
	      centroids.push(min);
	      for (i = _l = 1, _ref4 = num - 1; 1 <= _ref4 ? _l <= _ref4 : _l >= _ref4; i = 1 <= _ref4 ? ++_l : --_l) {
	        centroids.push(min + (i / num) * (max - min));
	      }
	      centroids.push(max);
	      while (repeat) {
	        for (j = _m = 0, _ref5 = num - 1; 0 <= _ref5 ? _m <= _ref5 : _m >= _ref5; j = 0 <= _ref5 ? ++_m : --_m) {
	          clusterSizes[j] = 0;
	        }
	        for (i = _n = 0, _ref6 = n - 1; 0 <= _ref6 ? _n <= _ref6 : _n >= _ref6; i = 0 <= _ref6 ? ++_n : --_n) {
	          value = values[i];
	          mindist = Number.MAX_VALUE;
	          for (j = _o = 0, _ref7 = num - 1; 0 <= _ref7 ? _o <= _ref7 : _o >= _ref7; j = 0 <= _ref7 ? ++_o : --_o) {
	            dist = Math.abs(centroids[j] - value);
	            if (dist < mindist) {
	              mindist = dist;
	              best = j;
	            }
	          }
	          clusterSizes[best]++;
	          assignments[i] = best;
	        }
	        newCentroids = new Array(num);
	        for (j = _p = 0, _ref8 = num - 1; 0 <= _ref8 ? _p <= _ref8 : _p >= _ref8; j = 0 <= _ref8 ? ++_p : --_p) {
	          newCentroids[j] = null;
	        }
	        for (i = _q = 0, _ref9 = n - 1; 0 <= _ref9 ? _q <= _ref9 : _q >= _ref9; i = 0 <= _ref9 ? ++_q : --_q) {
	          cluster = assignments[i];
	          if (newCentroids[cluster] === null) {
	            newCentroids[cluster] = values[i];
	          } else {
	            newCentroids[cluster] += values[i];
	          }
	        }
	        for (j = _r = 0, _ref10 = num - 1; 0 <= _ref10 ? _r <= _ref10 : _r >= _ref10; j = 0 <= _ref10 ? ++_r : --_r) {
	          newCentroids[j] *= 1 / clusterSizes[j];
	        }
	        repeat = false;
	        for (j = _s = 0, _ref11 = num - 1; 0 <= _ref11 ? _s <= _ref11 : _s >= _ref11; j = 0 <= _ref11 ? ++_s : --_s) {
	          if (newCentroids[j] !== centroids[i]) {
	            repeat = true;
	            break;
	          }
	        }
	        centroids = newCentroids;
	        nb_iters++;
	        if (nb_iters > 200) {
	          repeat = false;
	        }
	      }
	      kClusters = {};
	      for (j = _t = 0, _ref12 = num - 1; 0 <= _ref12 ? _t <= _ref12 : _t >= _ref12; j = 0 <= _ref12 ? ++_t : --_t) {
	        kClusters[j] = [];
	      }
	      for (i = _u = 0, _ref13 = n - 1; 0 <= _ref13 ? _u <= _ref13 : _u >= _ref13; i = 0 <= _ref13 ? ++_u : --_u) {
	        cluster = assignments[i];
	        kClusters[cluster].push(values[i]);
	      }
	      tmpKMeansBreaks = [];
	      for (j = _v = 0, _ref14 = num - 1; 0 <= _ref14 ? _v <= _ref14 : _v >= _ref14; j = 0 <= _ref14 ? ++_v : --_v) {
	        tmpKMeansBreaks.push(kClusters[j][0]);
	        tmpKMeansBreaks.push(kClusters[j][kClusters[j].length - 1]);
	      }
	      tmpKMeansBreaks = tmpKMeansBreaks.sort(function(a, b) {
	        return a - b;
	      });
	      limits.push(tmpKMeansBreaks[0]);
	      for (i = _w = 1, _ref15 = tmpKMeansBreaks.length - 1; _w <= _ref15; i = _w += 2) {
	        if (!isNaN(tmpKMeansBreaks[i])) {
	          limits.push(tmpKMeansBreaks[i]);
	        }
	      }
	    }
	    return limits;
	  };
	  chroma.brewer = brewer = {
	    OrRd: ['#fff7ec', '#fee8c8', '#fdd49e', '#fdbb84', '#fc8d59', '#ef6548', '#d7301f', '#b30000', '#7f0000'],
	    PuBu: ['#fff7fb', '#ece7f2', '#d0d1e6', '#a6bddb', '#74a9cf', '#3690c0', '#0570b0', '#045a8d', '#023858'],
	    BuPu: ['#f7fcfd', '#e0ecf4', '#bfd3e6', '#9ebcda', '#8c96c6', '#8c6bb1', '#88419d', '#810f7c', '#4d004b'],
	    Oranges: ['#fff5eb', '#fee6ce', '#fdd0a2', '#fdae6b', '#fd8d3c', '#f16913', '#d94801', '#a63603', '#7f2704'],
	    BuGn: ['#f7fcfd', '#e5f5f9', '#ccece6', '#99d8c9', '#66c2a4', '#41ae76', '#238b45', '#006d2c', '#00441b'],
	    YlOrBr: ['#ffffe5', '#fff7bc', '#fee391', '#fec44f', '#fe9929', '#ec7014', '#cc4c02', '#993404', '#662506'],
	    YlGn: ['#ffffe5', '#f7fcb9', '#d9f0a3', '#addd8e', '#78c679', '#41ab5d', '#238443', '#006837', '#004529'],
	    Reds: ['#fff5f0', '#fee0d2', '#fcbba1', '#fc9272', '#fb6a4a', '#ef3b2c', '#cb181d', '#a50f15', '#67000d'],
	    RdPu: ['#fff7f3', '#fde0dd', '#fcc5c0', '#fa9fb5', '#f768a1', '#dd3497', '#ae017e', '#7a0177', '#49006a'],
	    Greens: ['#f7fcf5', '#e5f5e0', '#c7e9c0', '#a1d99b', '#74c476', '#41ab5d', '#238b45', '#006d2c', '#00441b'],
	    YlGnBu: ['#ffffd9', '#edf8b1', '#c7e9b4', '#7fcdbb', '#41b6c4', '#1d91c0', '#225ea8', '#253494', '#081d58'],
	    Purples: ['#fcfbfd', '#efedf5', '#dadaeb', '#bcbddc', '#9e9ac8', '#807dba', '#6a51a3', '#54278f', '#3f007d'],
	    GnBu: ['#f7fcf0', '#e0f3db', '#ccebc5', '#a8ddb5', '#7bccc4', '#4eb3d3', '#2b8cbe', '#0868ac', '#084081'],
	    Greys: ['#ffffff', '#f0f0f0', '#d9d9d9', '#bdbdbd', '#969696', '#737373', '#525252', '#252525', '#000000'],
	    YlOrRd: ['#ffffcc', '#ffeda0', '#fed976', '#feb24c', '#fd8d3c', '#fc4e2a', '#e31a1c', '#bd0026', '#800026'],
	    PuRd: ['#f7f4f9', '#e7e1ef', '#d4b9da', '#c994c7', '#df65b0', '#e7298a', '#ce1256', '#980043', '#67001f'],
	    Blues: ['#f7fbff', '#deebf7', '#c6dbef', '#9ecae1', '#6baed6', '#4292c6', '#2171b5', '#08519c', '#08306b'],
	    PuBuGn: ['#fff7fb', '#ece2f0', '#d0d1e6', '#a6bddb', '#67a9cf', '#3690c0', '#02818a', '#016c59', '#014636'],
	    Spectral: ['#9e0142', '#d53e4f', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#e6f598', '#abdda4', '#66c2a5', '#3288bd', '#5e4fa2'],
	    RdYlGn: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#d9ef8b', '#a6d96a', '#66bd63', '#1a9850', '#006837'],
	    RdBu: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#f7f7f7', '#d1e5f0', '#92c5de', '#4393c3', '#2166ac', '#053061'],
	    PiYG: ['#8e0152', '#c51b7d', '#de77ae', '#f1b6da', '#fde0ef', '#f7f7f7', '#e6f5d0', '#b8e186', '#7fbc41', '#4d9221', '#276419'],
	    PRGn: ['#40004b', '#762a83', '#9970ab', '#c2a5cf', '#e7d4e8', '#f7f7f7', '#d9f0d3', '#a6dba0', '#5aae61', '#1b7837', '#00441b'],
	    RdYlBu: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee090', '#ffffbf', '#e0f3f8', '#abd9e9', '#74add1', '#4575b4', '#313695'],
	    BrBG: ['#543005', '#8c510a', '#bf812d', '#dfc27d', '#f6e8c3', '#f5f5f5', '#c7eae5', '#80cdc1', '#35978f', '#01665e', '#003c30'],
	    RdGy: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#ffffff', '#e0e0e0', '#bababa', '#878787', '#4d4d4d', '#1a1a1a'],
	    PuOr: ['#7f3b08', '#b35806', '#e08214', '#fdb863', '#fee0b6', '#f7f7f7', '#d8daeb', '#b2abd2', '#8073ac', '#542788', '#2d004b'],
	    Set2: ['#66c2a5', '#fc8d62', '#8da0cb', '#e78ac3', '#a6d854', '#ffd92f', '#e5c494', '#b3b3b3'],
	    Accent: ['#7fc97f', '#beaed4', '#fdc086', '#ffff99', '#386cb0', '#f0027f', '#bf5b17', '#666666'],
	    Set1: ['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf', '#999999'],
	    Set3: ['#8dd3c7', '#ffffb3', '#bebada', '#fb8072', '#80b1d3', '#fdb462', '#b3de69', '#fccde5', '#d9d9d9', '#bc80bd', '#ccebc5', '#ffed6f'],
	    Dark2: ['#1b9e77', '#d95f02', '#7570b3', '#e7298a', '#66a61e', '#e6ab02', '#a6761d', '#666666'],
	    Paired: ['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c', '#fb9a99', '#e31a1c', '#fdbf6f', '#ff7f00', '#cab2d6', '#6a3d9a', '#ffff99', '#b15928'],
	    Pastel2: ['#b3e2cd', '#fdcdac', '#cbd5e8', '#f4cae4', '#e6f5c9', '#fff2ae', '#f1e2cc', '#cccccc'],
	    Pastel1: ['#fbb4ae', '#b3cde3', '#ccebc5', '#decbe4', '#fed9a6', '#ffffcc', '#e5d8bd', '#fddaec', '#f2f2f2']
	  };
	  chroma.colors = colors = {
	    indigo: "#4b0082",
	    gold: "#ffd700",
	    hotpink: "#ff69b4",
	    firebrick: "#b22222",
	    indianred: "#cd5c5c",
	    yellow: "#ffff00",
	    mistyrose: "#ffe4e1",
	    darkolivegreen: "#556b2f",
	    olive: "#808000",
	    darkseagreen: "#8fbc8f",
	    pink: "#ffc0cb",
	    tomato: "#ff6347",
	    lightcoral: "#f08080",
	    orangered: "#ff4500",
	    navajowhite: "#ffdead",
	    lime: "#00ff00",
	    palegreen: "#98fb98",
	    darkslategrey: "#2f4f4f",
	    greenyellow: "#adff2f",
	    burlywood: "#deb887",
	    seashell: "#fff5ee",
	    mediumspringgreen: "#00fa9a",
	    fuchsia: "#ff00ff",
	    papayawhip: "#ffefd5",
	    blanchedalmond: "#ffebcd",
	    chartreuse: "#7fff00",
	    dimgray: "#696969",
	    black: "#000000",
	    peachpuff: "#ffdab9",
	    springgreen: "#00ff7f",
	    aquamarine: "#7fffd4",
	    white: "#ffffff",
	    orange: "#ffa500",
	    lightsalmon: "#ffa07a",
	    darkslategray: "#2f4f4f",
	    brown: "#a52a2a",
	    ivory: "#fffff0",
	    dodgerblue: "#1e90ff",
	    peru: "#cd853f",
	    lawngreen: "#7cfc00",
	    chocolate: "#d2691e",
	    crimson: "#dc143c",
	    forestgreen: "#228b22",
	    darkgrey: "#a9a9a9",
	    lightseagreen: "#20b2aa",
	    cyan: "#00ffff",
	    mintcream: "#f5fffa",
	    silver: "#c0c0c0",
	    antiquewhite: "#faebd7",
	    mediumorchid: "#ba55d3",
	    skyblue: "#87ceeb",
	    gray: "#808080",
	    darkturquoise: "#00ced1",
	    goldenrod: "#daa520",
	    darkgreen: "#006400",
	    floralwhite: "#fffaf0",
	    darkviolet: "#9400d3",
	    darkgray: "#a9a9a9",
	    moccasin: "#ffe4b5",
	    saddlebrown: "#8b4513",
	    grey: "#808080",
	    darkslateblue: "#483d8b",
	    lightskyblue: "#87cefa",
	    lightpink: "#ffb6c1",
	    mediumvioletred: "#c71585",
	    slategrey: "#708090",
	    red: "#ff0000",
	    deeppink: "#ff1493",
	    limegreen: "#32cd32",
	    darkmagenta: "#8b008b",
	    palegoldenrod: "#eee8aa",
	    plum: "#dda0dd",
	    turquoise: "#40e0d0",
	    lightgrey: "#d3d3d3",
	    lightgoldenrodyellow: "#fafad2",
	    darkgoldenrod: "#b8860b",
	    lavender: "#e6e6fa",
	    maroon: "#800000",
	    yellowgreen: "#9acd32",
	    sandybrown: "#f4a460",
	    thistle: "#d8bfd8",
	    violet: "#ee82ee",
	    navy: "#000080",
	    magenta: "#ff00ff",
	    dimgrey: "#696969",
	    tan: "#d2b48c",
	    rosybrown: "#bc8f8f",
	    olivedrab: "#6b8e23",
	    blue: "#0000ff",
	    lightblue: "#add8e6",
	    ghostwhite: "#f8f8ff",
	    honeydew: "#f0fff0",
	    cornflowerblue: "#6495ed",
	    slateblue: "#6a5acd",
	    linen: "#faf0e6",
	    darkblue: "#00008b",
	    powderblue: "#b0e0e6",
	    seagreen: "#2e8b57",
	    darkkhaki: "#bdb76b",
	    snow: "#fffafa",
	    sienna: "#a0522d",
	    mediumblue: "#0000cd",
	    royalblue: "#4169e1",
	    lightcyan: "#e0ffff",
	    green: "#008000",
	    mediumpurple: "#9370db",
	    midnightblue: "#191970",
	    cornsilk: "#fff8dc",
	    paleturquoise: "#afeeee",
	    bisque: "#ffe4c4",
	    slategray: "#708090",
	    darkcyan: "#008b8b",
	    khaki: "#f0e68c",
	    wheat: "#f5deb3",
	    teal: "#008080",
	    darkorchid: "#9932cc",
	    deepskyblue: "#00bfff",
	    salmon: "#fa8072",
	    darkred: "#8b0000",
	    steelblue: "#4682b4",
	    palevioletred: "#db7093",
	    lightslategray: "#778899",
	    aliceblue: "#f0f8ff",
	    lightslategrey: "#778899",
	    lightgreen: "#90ee90",
	    orchid: "#da70d6",
	    gainsboro: "#dcdcdc",
	    mediumseagreen: "#3cb371",
	    lightgray: "#d3d3d3",
	    mediumturquoise: "#48d1cc",
	    lemonchiffon: "#fffacd",
	    cadetblue: "#5f9ea0",
	    lightyellow: "#ffffe0",
	    lavenderblush: "#fff0f5",
	    coral: "#ff7f50",
	    purple: "#800080",
	    aqua: "#00ffff",
	    whitesmoke: "#f5f5f5",
	    mediumslateblue: "#7b68ee",
	    darkorange: "#ff8c00",
	    mediumaquamarine: "#66cdaa",
	    darksalmon: "#e9967a",
	    beige: "#f5f5dc",
	    blueviolet: "#8a2be2",
	    azure: "#f0ffff",
	    lightsteelblue: "#b0c4de",
	    oldlace: "#fdf5e6"
	  };
	  type = (function() {
	    var classToType,
	        name,
	        _i,
	        _len,
	        _ref1;
	    classToType = {};
	    _ref1 = "Boolean Number String Function Array Date RegExp Undefined Null".split(" ");
	    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
	      name = _ref1[_i];
	      classToType["[object " + name + "]"] = name.toLowerCase();
	    }
	    return function(obj) {
	      var strType;
	      strType = Object.prototype.toString.call(obj);
	      return classToType[strType] || "object";
	    };
	  })();
	  limit = function(x, min, max) {
	    if (min == null) {
	      min = 0;
	    }
	    if (max == null) {
	      max = 1;
	    }
	    if (x < min) {
	      x = min;
	    }
	    if (x > max) {
	      x = max;
	    }
	    return x;
	  };
	  unpack = function(args) {
	    if (args.length >= 3) {
	      return args;
	    } else {
	      return args[0];
	    }
	  };
	  TWOPI = Math.PI * 2;
	  PITHIRD = Math.PI / 3;
	  cos = Math.cos;
	  bezier = function(colors) {
	    var I,
	        I0,
	        I1,
	        c,
	        lab0,
	        lab1,
	        lab2,
	        lab3,
	        _ref1,
	        _ref2,
	        _ref3;
	    colors = (function() {
	      var _i,
	          _len,
	          _results;
	      _results = [];
	      for (_i = 0, _len = colors.length; _i < _len; _i++) {
	        c = colors[_i];
	        _results.push(chroma(c));
	      }
	      return _results;
	    })();
	    if (colors.length === 2) {
	      _ref1 = (function() {
	        var _i,
	            _len,
	            _results;
	        _results = [];
	        for (_i = 0, _len = colors.length; _i < _len; _i++) {
	          c = colors[_i];
	          _results.push(c.lab());
	        }
	        return _results;
	      })(), lab0 = _ref1[0], lab1 = _ref1[1];
	      I = function(t) {
	        var i,
	            lab;
	        lab = (function() {
	          var _i,
	              _results;
	          _results = [];
	          for (i = _i = 0; _i <= 2; i = ++_i) {
	            _results.push(lab0[i] + t * (lab1[i] - lab0[i]));
	          }
	          return _results;
	        })();
	        return chroma.lab.apply(chroma, lab);
	      };
	    } else if (colors.length === 3) {
	      _ref2 = (function() {
	        var _i,
	            _len,
	            _results;
	        _results = [];
	        for (_i = 0, _len = colors.length; _i < _len; _i++) {
	          c = colors[_i];
	          _results.push(c.lab());
	        }
	        return _results;
	      })(), lab0 = _ref2[0], lab1 = _ref2[1], lab2 = _ref2[2];
	      I = function(t) {
	        var i,
	            lab;
	        lab = (function() {
	          var _i,
	              _results;
	          _results = [];
	          for (i = _i = 0; _i <= 2; i = ++_i) {
	            _results.push((1 - t) * (1 - t) * lab0[i] + 2 * (1 - t) * t * lab1[i] + t * t * lab2[i]);
	          }
	          return _results;
	        })();
	        return chroma.lab.apply(chroma, lab);
	      };
	    } else if (colors.length === 4) {
	      _ref3 = (function() {
	        var _i,
	            _len,
	            _results;
	        _results = [];
	        for (_i = 0, _len = colors.length; _i < _len; _i++) {
	          c = colors[_i];
	          _results.push(c.lab());
	        }
	        return _results;
	      })(), lab0 = _ref3[0], lab1 = _ref3[1], lab2 = _ref3[2], lab3 = _ref3[3];
	      I = function(t) {
	        var i,
	            lab;
	        lab = (function() {
	          var _i,
	              _results;
	          _results = [];
	          for (i = _i = 0; _i <= 2; i = ++_i) {
	            _results.push((1 - t) * (1 - t) * (1 - t) * lab0[i] + 3 * (1 - t) * (1 - t) * t * lab1[i] + 3 * (1 - t) * t * t * lab2[i] + t * t * t * lab3[i]);
	          }
	          return _results;
	        })();
	        return chroma.lab.apply(chroma, lab);
	      };
	    } else if (colors.length === 5) {
	      I0 = bezier(colors.slice(0, 3));
	      I1 = bezier(colors.slice(2, 5));
	      I = function(t) {
	        if (t < 0.5) {
	          return I0(t * 2);
	        } else {
	          return I1((t - 0.5) * 2);
	        }
	      };
	    }
	    return I;
	  };
	  chroma.interpolate.bezier = bezier;
	}).call(this);
	
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(46)(module)))

/***/ },
/* 37 */
/***/ function(module, exports, __webpack_require__) {

	module.exports = function() {
	  var list = [];
	  list.toString = function toString() {
	    var result = [];
	    for (var i = 0; i < this.length; i++) {
	      var item = this[i];
	      if (item[2]) {
	        result.push("@media " + item[2] + "{" + item[1] + "}");
	      } else {
	        result.push(item[1]);
	      }
	    }
	    return result.join("");
	  };
	  return list;
	};


/***/ },
/* 38 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(16), __webpack_require__(21), __webpack_require__(39), __webpack_require__(45), __webpack_require__(40), __webpack_require__(20), __webpack_require__(22)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, P, U, KefirSignalHandler, uniqueID, dm, plugin, defer) {
	  'use strict';
	  return plugin.selected.then((function() {
	    if (U.isDefined(window._amy_Artefact)) {
	      return window._amy_Artefact;
	    }
	    window._amy_Artefact = dm.vp('Artefact', U.newSubclass(KefirSignalHandler, (function(superFn) {
	      return function Artefact(options) {
	        superFn.apply(this, arguments);
	        this._options = options;
	        var $__1 = options,
	            id = $__1.id,
	            type = $__1.type,
	            parent = $__1.parent,
	            beforeConstruction = $__1.beforeConstruction;
	        this._id = id || uniqueID(type);
	        this._type = type;
	        this._parent = parent;
	        this._children = [];
	        if (parent) {
	          U.array(parent, '_children').push(this);
	        }
	        this.newEvent('destroy');
	        this.beforeConstruction(beforeConstruction);
	        if (this.root === this) {
	          this._artefactsByID = {};
	          this._registerArtefact = function(artefact) {
	            U.getDef(this._artefactsByID, artefact.id, defer).resolve(artefact);
	          };
	        }
	      };
	    }), {
	      beforeConstruction: function(possiblePromise) {
	        if (!possiblePromise || !$.isFunction(possiblePromise.then)) {
	          return;
	        }
	        if (!this.constructed) {
	          this.constructed = P.resolve(this);
	        }
	        this.constructed = this.constructed.tap((function() {
	          return P.resolve(possiblePromise);
	        }));
	      },
	      get options() {
	        return this._options;
	      },
	      get id() {
	        return this._id;
	      },
	      get type() {
	        return this._type;
	      },
	      get parent() {
	        return this._parent;
	      },
	      get children() {
	        return this._children;
	      },
	      get root() {
	        if (!this._root) {
	          this._root = this.parent ? this.parent.root : this;
	        }
	        return this._root;
	      },
	      artefactById: function(id) {
	        return U.getDef(this.root._artefactsByID, id, defer).promise;
	      },
	      traverseArtefacts: function(fn) {
	        var options = arguments[1] !== (void 0) ? arguments[1] : {};
	        var order = options.order;
	        if (!order) {
	          order = 'prefix';
	        }
	        if (order === 'prefix') {
	          fn(this);
	        }
	        this.children.forEach((function(child) {
	          child.traverseArtefacts(fn, options);
	        }));
	        if (order === 'postfix') {
	          fn(this);
	        }
	      },
	      traverseArtefactsByType: function(type, fn) {
	        var options = arguments[2] !== (void 0) ? arguments[2] : {};
	        var order = options.order;
	        if (!order) {
	          order = 'prefix';
	        }
	        if (order === 'prefix' && this.type === type) {
	          fn(this);
	        }
	        if (options.beforeGoingIn) {
	          options.beforeGoingIn(this);
	        }
	        this.closestDescendantsByType(type).forEach((function(descendent) {
	          descendent.traverseArtefactsByType(type, fn, options);
	        }));
	        if (options.beforeGoingOut) {
	          options.beforeGoingOut(this);
	        }
	        if (order === 'postfix' && this.type === type) {
	          fn(this);
	        }
	      },
	      closestAncestorByType: function(type) {
	        var result = this;
	        do {
	          result = result.parent;
	        } while (result && result.type && result.type !== type);
	        return result;
	      },
	      closestDescendantsByType: function(type) {
	        var result = [];
	        this.children.forEach((function(child) {
	          if (child.type === type) {
	            result.push(child);
	          } else {
	            result = result.concat(child.closestDescendantsByType(type));
	          }
	        }));
	        return result;
	      },
	      destroy: function() {
	        this.trigger('destroy');
	        this.children.forEach((function(child) {
	          child.destroy();
	        }));
	      }
	    }));
	    window._amy_Artefact.newSubclass = function newSubClass(name, constructor) {
	      var prototype = arguments[2] !== (void 0) ? arguments[2] : {};
	      var optionDefaults = arguments[3] !== (void 0) ? arguments[3] : {};
	      return dm.vp(name, U.newSubclass(window._amy_Artefact, (function(superFn) {
	        return function() {
	          var options = arguments[0] !== (void 0) ? arguments[0] : {};
	          var $__0 = this;
	          var processedOptions = options;
	          Object.keys(optionDefaults).forEach((function(key) {
	            if (U.isUndefined(processedOptions[key])) {
	              processedOptions[key] = optionDefaults[key];
	            }
	          }));
	          processedOptions.type = name;
	          superFn.call(this, U.extend(options, processedOptions));
	          constructor.call(this, processedOptions);
	          if (this.constructed) {
	            this.constructed = this.constructed.then((function() {
	              if ($.isFunction($__0.construct)) {
	                return P.resolve($__0.construct(options)).return($__0);
	              }
	              return $__0;
	            }));
	          } else if ($.isFunction(this.construct)) {
	            this.beforeConstruction(this.construct(options));
	          }
	          (this.constructed || P.resolve()).then((function() {
	            $__0.root._registerArtefact($__0);
	          }));
	        };
	      }), U.extend({}, prototype, {get circuitboard() {
	          if (!this._circuitboard) {
	            this._circuitboard = this.closestAncestorByType('Circuitboard');
	          }
	          return this._circuitboard;
	        }})));
	    };
	    return window._amy_Artefact;
	  })).tap((function(c) {
	    $.circuitboard.Artefact = c;
	  }));
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 39 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;'use strict';
	!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(15), __webpack_require__(21), __webpack_require__(26)], __WEBPACK_AMD_DEFINE_RESULT__ = function($, U, Kefir) {
	  var KefirSignalHandler = U.newClass(function KefirSignalHandler() {
	    this._events = {};
	    this._properties = {};
	    this._propertyBusses = {};
	  }, {
	    newEvent: function(name) {
	      var source = (arguments[1] !== (void 0) ? arguments[1] : {}).source;
	      U.assert(!this._events[name], ("There is already an event '" + name + "' on this object."));
	      U.assert(!this._properties[name], ("There is already a property '" + name + "' on this object."));
	      var bus = Kefir.bus();
	      if (source) {
	        bus.plug(source);
	      }
	      return this._events[name] = bus;
	    },
	    event: function(name) {
	      U.assert(this._events[name], ("There is no event '" + name + "' on this object."));
	      return this._events[name];
	    },
	    property: function(name) {
	      return this._properties[name];
	    },
	    p: function(name) {
	      return this._properties[name];
	    },
	    newProperty: function(name) {
	      var $__1 = arguments[1] !== (void 0) ? arguments[1] : {},
	          settable = $__1.settable,
	          initial = $__1.initial,
	          isEqual = $__1.isEqual;
	      U.assert(!this._events[name], ("There is already an event '" + name + "' on this object."));
	      U.assert(!this._properties[name], ("There is already a property '" + name + "' on this object."));
	      if (U.isUndefined(settable)) {
	        settable = true;
	      }
	      var bus = Kefir.bus();
	      var property = this._properties[name] = bus.toProperty(initial).skipDuplicates(isEqual);
	      property.plug = (function(observable) {
	        bus.plug(observable);
	        return property;
	      });
	      property.unplug = (function(observable) {
	        bus.unplug(observable);
	        return property;
	      });
	      property.get = (function() {
	        return property._current;
	      });
	      if (settable) {
	        property.set = (function(value) {
	          bus.emit(value);
	          return property;
	        });
	      }
	      Object.defineProperty(this, name, {
	        get: property.get,
	        set: settable ? property.set : undefined
	      });
	      property.run();
	      this.event('destroy').onValue((function() {
	        bus.end();
	      }));
	      return property;
	    },
	    trigger: function(name, value) {
	      U.assert(this._events[name], ("There is no event '" + name + "' on this object."));
	      this._events[name].emit(value);
	    },
	    on: function(name, expectedValue, options, callback) {
	      var argsObj = this._gatherOnArguments(name, expectedValue, options, callback);
	      return this._on(argsObj);
	    },
	    _on: function($__1) {
	      var $__2 = $__1,
	          name = $__2.name,
	          expectedValue = $__2.expectedValue,
	          callback = $__2.callback;
	      U.assert(this._events[name] || this._properties[name], ("There is no event or property '" + name + "' on this object."));
	      var result = this._events[name] || this._properties[name];
	      if (U.isDefined(expectedValue)) {
	        result = result.filter((function(v) {
	          return v === expectedValue;
	        }));
	      }
	      if (callback) {
	        result = result.onValue(callback);
	      }
	      return result;
	    },
	    _gatherOnArguments: function() {
	      for (var args = [],
	          $__0 = 0; $__0 < arguments.length; $__0++)
	        args[$__0] = arguments[$__0];
	      var result = {name: args.shift()};
	      if (U.isDefined(args[0]) && !U.isFunction(args[0]) && !U.isPlainObject(args[0])) {
	        result.expectedValue = args.shift();
	      }
	      if (U.isDefined(args[0]) && U.isFunction(args[0])) {
	        result.callback = args.shift();
	      }
	      return result;
	    }
	  });
	  return KefirSignalHandler;
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 40 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(16), __webpack_require__(47)], __WEBPACK_AMD_DEFINE_RESULT__ = function(P, DM) {
	  'use strict';
	  if (window.__apinatomy_core_delta_model) {
	    return window.__apinatomy_core_delta_model;
	  }
	  DM.registerPromiseResolver(P.resolve);
	  window.__apinatomy_core_delta_model = new DM();
	  return window.__apinatomy_core_delta_model;
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 41 */
/***/ function(module, exports, __webpack_require__) {

	var process = module.exports = {};
	process.nextTick = (function() {
	  var canSetImmediate = typeof window !== 'undefined' && window.setImmediate;
	  var canMutationObserver = typeof window !== 'undefined' && window.MutationObserver;
	  var canPost = typeof window !== 'undefined' && window.postMessage && window.addEventListener;
	  ;
	  if (canSetImmediate) {
	    return function(f) {
	      return window.setImmediate(f);
	    };
	  }
	  var queue = [];
	  if (canMutationObserver) {
	    var hiddenDiv = document.createElement("div");
	    var observer = new MutationObserver(function() {
	      var queueList = queue.slice();
	      queue.length = 0;
	      queueList.forEach(function(fn) {
	        fn();
	      });
	    });
	    observer.observe(hiddenDiv, {attributes: true});
	    return function nextTick(fn) {
	      if (!queue.length) {
	        hiddenDiv.setAttribute('yes', 'no');
	      }
	      queue.push(fn);
	    };
	  }
	  if (canPost) {
	    window.addEventListener('message', function(ev) {
	      var source = ev.source;
	      if ((source === window || source === null) && ev.data === 'process-tick') {
	        ev.stopPropagation();
	        if (queue.length > 0) {
	          var fn = queue.shift();
	          fn();
	        }
	      }
	    }, true);
	    return function nextTick(fn) {
	      queue.push(fn);
	      window.postMessage('process-tick', '*');
	    };
	  }
	  return function nextTick(fn) {
	    setTimeout(fn, 0);
	  };
	})();
	process.title = 'browser';
	process.browser = true;
	process.env = {};
	process.argv = [];
	function noop() {}
	process.on = noop;
	process.addListener = noop;
	process.once = noop;
	process.off = noop;
	process.removeListener = noop;
	process.removeAllListeners = noop;
	process.emit = noop;
	process.binding = function(name) {
	  throw new Error('process.binding is not supported');
	};
	process.cwd = function() {
	  return '/';
	};
	process.chdir = function(dir) {
	  throw new Error('process.chdir is not supported');
	};


/***/ },
/* 42 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;;
	(function(global) {
	  "use strict";
	  var Kefir = {};
	  function and() {
	    for (var i = 0; i < arguments.length; i++) {
	      if (!arguments[i]) {
	        return arguments[i];
	      }
	    }
	    return arguments[i - 1];
	  }
	  function or() {
	    for (var i = 0; i < arguments.length; i++) {
	      if (arguments[i]) {
	        return arguments[i];
	      }
	    }
	    return arguments[i - 1];
	  }
	  function not(x) {
	    return !x;
	  }
	  function concat(a, b) {
	    var result,
	        length,
	        i,
	        j;
	    if (a.length === 0) {
	      return b;
	    }
	    if (b.length === 0) {
	      return a;
	    }
	    j = 0;
	    result = new Array(a.length + b.length);
	    length = a.length;
	    for (i = 0; i < length; i++, j++) {
	      result[j] = a[i];
	    }
	    length = b.length;
	    for (i = 0; i < length; i++, j++) {
	      result[j] = b[i];
	    }
	    return result;
	  }
	  function find(arr, value) {
	    var length = arr.length,
	        i;
	    for (i = 0; i < length; i++) {
	      if (arr[i] === value) {
	        return i;
	      }
	    }
	    return -1;
	  }
	  function findByPred(arr, pred) {
	    var length = arr.length,
	        i;
	    for (i = 0; i < length; i++) {
	      if (pred(arr[i])) {
	        return i;
	      }
	    }
	    return -1;
	  }
	  function cloneArray(input) {
	    var length = input.length,
	        result = new Array(length),
	        i;
	    for (i = 0; i < length; i++) {
	      result[i] = input[i];
	    }
	    return result;
	  }
	  function remove(input, index) {
	    var length = input.length,
	        result,
	        i,
	        j;
	    if (index >= 0 && index < length) {
	      if (length === 1) {
	        return [];
	      } else {
	        result = new Array(length - 1);
	        for (i = 0, j = 0; i < length; i++) {
	          if (i !== index) {
	            result[j] = input[i];
	            j++;
	          }
	        }
	        return result;
	      }
	    } else {
	      return input;
	    }
	  }
	  function removeByPred(input, pred) {
	    return remove(input, findByPred(input, pred));
	  }
	  function map(input, fn) {
	    var length = input.length,
	        result = new Array(length),
	        i;
	    for (i = 0; i < length; i++) {
	      result[i] = fn(input[i]);
	    }
	    return result;
	  }
	  function forEach(arr, fn) {
	    var length = arr.length,
	        i;
	    for (i = 0; i < length; i++) {
	      fn(arr[i]);
	    }
	  }
	  function fillArray(arr, value) {
	    var length = arr.length,
	        i;
	    for (i = 0; i < length; i++) {
	      arr[i] = value;
	    }
	  }
	  function contains(arr, value) {
	    return find(arr, value) !== -1;
	  }
	  function rest(arr, start, onEmpty) {
	    if (arr.length > start) {
	      return Array.prototype.slice.call(arr, start);
	    }
	    return onEmpty;
	  }
	  function slide(cur, next, max) {
	    var length = Math.min(max, cur.length + 1),
	        offset = cur.length - length + 1,
	        result = new Array(length),
	        i;
	    for (i = offset; i < length; i++) {
	      result[i - offset] = cur[i];
	    }
	    result[length - 1] = next;
	    return result;
	  }
	  function isEqualArrays(a, b) {
	    var length,
	        i;
	    if (a == null && b == null) {
	      return true;
	    }
	    if (a == null || b == null) {
	      return false;
	    }
	    if (a.length !== b.length) {
	      return false;
	    }
	    for (i = 0, length = a.length; i < length; i++) {
	      if (a[i] !== b[i]) {
	        return false;
	      }
	    }
	    return true;
	  }
	  function spread(fn, length) {
	    switch (length) {
	      case 0:
	        return function(a) {
	          return fn();
	        };
	      case 1:
	        return function(a) {
	          return fn(a[0]);
	        };
	      case 2:
	        return function(a) {
	          return fn(a[0], a[1]);
	        };
	      case 3:
	        return function(a) {
	          return fn(a[0], a[1], a[2]);
	        };
	      case 4:
	        return function(a) {
	          return fn(a[0], a[1], a[2], a[3]);
	        };
	      default:
	        return function(a) {
	          return fn.apply(null, a);
	        };
	    }
	  }
	  function apply(fn, c, a) {
	    var aLength = a ? a.length : 0;
	    if (c == null) {
	      switch (aLength) {
	        case 0:
	          return fn();
	        case 1:
	          return fn(a[0]);
	        case 2:
	          return fn(a[0], a[1]);
	        case 3:
	          return fn(a[0], a[1], a[2]);
	        case 4:
	          return fn(a[0], a[1], a[2], a[3]);
	        default:
	          return fn.apply(null, a);
	      }
	    } else {
	      switch (aLength) {
	        case 0:
	          return fn.call(c);
	        default:
	          return fn.apply(c, a);
	      }
	    }
	  }
	  function get(map, key, notFound) {
	    if (map && key in map) {
	      return map[key];
	    } else {
	      return notFound;
	    }
	  }
	  function own(obj, prop) {
	    return Object.prototype.hasOwnProperty.call(obj, prop);
	  }
	  function createObj(proto) {
	    var F = function() {};
	    F.prototype = proto;
	    return new F();
	  }
	  function extend(target) {
	    var length = arguments.length,
	        i,
	        prop;
	    for (i = 1; i < length; i++) {
	      for (prop in arguments[i]) {
	        target[prop] = arguments[i][prop];
	      }
	    }
	    return target;
	  }
	  function inherit(Child, Parent) {
	    var length = arguments.length,
	        i;
	    Child.prototype = createObj(Parent.prototype);
	    Child.prototype.constructor = Child;
	    for (i = 2; i < length; i++) {
	      extend(Child.prototype, arguments[i]);
	    }
	    return Child;
	  }
	  var NOTHING = ['<nothing>'];
	  var END = 'end';
	  var VALUE = 'value';
	  var ERROR = 'error';
	  var ANY = 'any';
	  function noop() {}
	  function id(x) {
	    return x;
	  }
	  function strictEqual(a, b) {
	    return a === b;
	  }
	  function defaultDiff(a, b) {
	    return [a, b];
	  }
	  var now = Date.now ? function() {
	    return Date.now();
	  } : function() {
	    return new Date().getTime();
	  };
	  function isFn(fn) {
	    return typeof fn === 'function';
	  }
	  function isUndefined(x) {
	    return typeof x === 'undefined';
	  }
	  function isArrayLike(xs) {
	    return isArray(xs) || isArguments(xs);
	  }
	  var isArray = Array.isArray || function(xs) {
	    return Object.prototype.toString.call(xs) === '[object Array]';
	  };
	  var isArguments = function(xs) {
	    return Object.prototype.toString.call(xs) === '[object Arguments]';
	  };
	  if (!isArguments(arguments)) {
	    isArguments = function(obj) {
	      return !!(obj && own(obj, 'callee'));
	    };
	  }
	  function withInterval(name, mixin) {
	    function AnonymousStream(wait, args) {
	      Stream.call(this);
	      this._wait = wait;
	      this._intervalId = null;
	      var $ = this;
	      this._$onTick = function() {
	        $._onTick();
	      };
	      this._init(args);
	    }
	    inherit(AnonymousStream, Stream, {
	      _name: name,
	      _init: function(args) {},
	      _free: function() {},
	      _onTick: function() {},
	      _onActivation: function() {
	        this._intervalId = setInterval(this._$onTick, this._wait);
	      },
	      _onDeactivation: function() {
	        if (this._intervalId !== null) {
	          clearInterval(this._intervalId);
	          this._intervalId = null;
	        }
	      },
	      _clear: function() {
	        Stream.prototype._clear.call(this);
	        this._$onTick = null;
	        this._free();
	      }
	    }, mixin);
	    Kefir[name] = function(wait) {
	      return new AnonymousStream(wait, rest(arguments, 1, []));
	    };
	  }
	  function withOneSource(name, mixin, options) {
	    options = extend({
	      streamMethod: function(StreamClass, PropertyClass) {
	        return function() {
	          return new StreamClass(this, arguments);
	        };
	      },
	      propertyMethod: function(StreamClass, PropertyClass) {
	        return function() {
	          return new PropertyClass(this, arguments);
	        };
	      }
	    }, options || {});
	    mixin = extend({
	      _init: function(args) {},
	      _free: function() {},
	      _handleValue: function(x, isCurrent) {
	        this._send(VALUE, x, isCurrent);
	      },
	      _handleError: function(x, isCurrent) {
	        this._send(ERROR, x, isCurrent);
	      },
	      _handleEnd: function(__, isCurrent) {
	        this._send(END, null, isCurrent);
	      },
	      _handleAny: function(event) {
	        switch (event.type) {
	          case VALUE:
	            this._handleValue(event.value, event.current);
	            break;
	          case ERROR:
	            this._handleError(event.value, event.current);
	            break;
	          case END:
	            this._handleEnd(event.value, event.current);
	            break;
	        }
	      },
	      _onActivation: function() {
	        this._source.onAny(this._$handleAny);
	      },
	      _onDeactivation: function() {
	        this._source.offAny(this._$handleAny);
	      }
	    }, mixin || {});
	    function buildClass(BaseClass) {
	      function AnonymousObservable(source, args) {
	        BaseClass.call(this);
	        this._source = source;
	        this._name = source._name + '.' + name;
	        this._init(args);
	        var $ = this;
	        this._$handleAny = function(event) {
	          $._handleAny(event);
	        };
	      }
	      inherit(AnonymousObservable, BaseClass, {_clear: function() {
	          BaseClass.prototype._clear.call(this);
	          this._source = null;
	          this._$handleAny = null;
	          this._free();
	        }}, mixin);
	      return AnonymousObservable;
	    }
	    var AnonymousStream = buildClass(Stream);
	    var AnonymousProperty = buildClass(Property);
	    if (options.streamMethod) {
	      Stream.prototype[name] = options.streamMethod(AnonymousStream, AnonymousProperty);
	    }
	    if (options.propertyMethod) {
	      Property.prototype[name] = options.propertyMethod(AnonymousStream, AnonymousProperty);
	    }
	  }
	  function withTwoSources(name, mixin) {
	    mixin = extend({
	      _init: function(args) {},
	      _free: function() {},
	      _handlePrimaryValue: function(x, isCurrent) {
	        this._send(VALUE, x, isCurrent);
	      },
	      _handlePrimaryError: function(x, isCurrent) {
	        this._send(ERROR, x, isCurrent);
	      },
	      _handlePrimaryEnd: function(__, isCurrent) {
	        this._send(END, null, isCurrent);
	      },
	      _handleSecondaryValue: function(x, isCurrent) {
	        this._lastSecondary = x;
	      },
	      _handleSecondaryError: function(x, isCurrent) {
	        this._send(ERROR, x, isCurrent);
	      },
	      _handleSecondaryEnd: function(__, isCurrent) {},
	      _handlePrimaryAny: function(event) {
	        switch (event.type) {
	          case VALUE:
	            this._handlePrimaryValue(event.value, event.current);
	            break;
	          case ERROR:
	            this._handlePrimaryError(event.value, event.current);
	            break;
	          case END:
	            this._handlePrimaryEnd(event.value, event.current);
	            break;
	        }
	      },
	      _handleSecondaryAny: function(event) {
	        switch (event.type) {
	          case VALUE:
	            this._handleSecondaryValue(event.value, event.current);
	            break;
	          case ERROR:
	            this._handleSecondaryError(event.value, event.current);
	            break;
	          case END:
	            this._handleSecondaryEnd(event.value, event.current);
	            this._removeSecondary();
	            break;
	        }
	      },
	      _removeSecondary: function() {
	        if (this._secondary !== null) {
	          this._secondary.offAny(this._$handleSecondaryAny);
	          this._$handleSecondaryAny = null;
	          this._secondary = null;
	        }
	      },
	      _onActivation: function() {
	        if (this._secondary !== null) {
	          this._secondary.onAny(this._$handleSecondaryAny);
	        }
	        if (this._alive) {
	          this._primary.onAny(this._$handlePrimaryAny);
	        }
	      },
	      _onDeactivation: function() {
	        if (this._secondary !== null) {
	          this._secondary.offAny(this._$handleSecondaryAny);
	        }
	        this._primary.offAny(this._$handlePrimaryAny);
	      }
	    }, mixin || {});
	    function buildClass(BaseClass) {
	      function AnonymousObservable(primary, secondary, args) {
	        BaseClass.call(this);
	        this._primary = primary;
	        this._secondary = secondary;
	        this._name = primary._name + '.' + name;
	        this._lastSecondary = NOTHING;
	        var $ = this;
	        this._$handleSecondaryAny = function(event) {
	          $._handleSecondaryAny(event);
	        };
	        this._$handlePrimaryAny = function(event) {
	          $._handlePrimaryAny(event);
	        };
	        this._init(args);
	      }
	      inherit(AnonymousObservable, BaseClass, {_clear: function() {
	          BaseClass.prototype._clear.call(this);
	          this._primary = null;
	          this._secondary = null;
	          this._lastSecondary = null;
	          this._$handleSecondaryAny = null;
	          this._$handlePrimaryAny = null;
	          this._free();
	        }}, mixin);
	      return AnonymousObservable;
	    }
	    var AnonymousStream = buildClass(Stream);
	    var AnonymousProperty = buildClass(Property);
	    Stream.prototype[name] = function(secondary) {
	      return new AnonymousStream(this, secondary, rest(arguments, 1, []));
	    };
	    Property.prototype[name] = function(secondary) {
	      return new AnonymousProperty(this, secondary, rest(arguments, 1, []));
	    };
	  }
	  function Subscribers() {
	    this._items = [];
	  }
	  extend(Subscribers, {
	    callOne: function(fnData, event) {
	      if (fnData.type === ANY) {
	        fnData.fn(event);
	      } else if (fnData.type === event.type) {
	        if (fnData.type === VALUE || fnData.type === ERROR) {
	          fnData.fn(event.value);
	        } else {
	          fnData.fn();
	        }
	      }
	    },
	    callOnce: function(type, fn, event) {
	      if (type === ANY) {
	        fn(event);
	      } else if (type === event.type) {
	        if (type === VALUE || type === ERROR) {
	          fn(event.value);
	        } else {
	          fn();
	        }
	      }
	    }
	  });
	  extend(Subscribers.prototype, {
	    add: function(type, fn, _key) {
	      this._items = concat(this._items, [{
	        type: type,
	        fn: fn,
	        key: _key || null
	      }]);
	    },
	    remove: function(type, fn, _key) {
	      var pred = isArray(_key) ? function(fnData) {
	        return fnData.type === type && isEqualArrays(fnData.key, _key);
	      } : function(fnData) {
	        return fnData.type === type && fnData.fn === fn;
	      };
	      this._items = removeByPred(this._items, pred);
	    },
	    callAll: function(event) {
	      var items = this._items;
	      for (var i = 0; i < items.length; i++) {
	        Subscribers.callOne(items[i], event);
	      }
	    },
	    isEmpty: function() {
	      return this._items.length === 0;
	    }
	  });
	  function Event(type, value, current) {
	    return {
	      type: type,
	      value: value,
	      current: !!current
	    };
	  }
	  var CURRENT_END = Event(END, undefined, true);
	  function Observable() {
	    this._subscribers = new Subscribers();
	    this._active = false;
	    this._alive = true;
	  }
	  Kefir.Observable = Observable;
	  extend(Observable.prototype, {
	    _name: 'observable',
	    _onActivation: function() {},
	    _onDeactivation: function() {},
	    _setActive: function(active) {
	      if (this._active !== active) {
	        this._active = active;
	        if (active) {
	          this._onActivation();
	        } else {
	          this._onDeactivation();
	        }
	      }
	    },
	    _clear: function() {
	      this._setActive(false);
	      this._alive = false;
	      this._subscribers = null;
	    },
	    _send: function(type, x, isCurrent) {
	      if (this._alive) {
	        this._subscribers.callAll(Event(type, x, isCurrent));
	        if (type === END) {
	          this._clear();
	        }
	      }
	    },
	    _on: function(type, fn, _key) {
	      if (this._alive) {
	        this._subscribers.add(type, fn, _key);
	        this._setActive(true);
	      } else {
	        Subscribers.callOnce(type, fn, CURRENT_END);
	      }
	      return this;
	    },
	    _off: function(type, fn, _key) {
	      if (this._alive) {
	        this._subscribers.remove(type, fn, _key);
	        if (this._subscribers.isEmpty()) {
	          this._setActive(false);
	        }
	      }
	      return this;
	    },
	    onValue: function(fn, _key) {
	      return this._on(VALUE, fn, _key);
	    },
	    onError: function(fn, _key) {
	      return this._on(ERROR, fn, _key);
	    },
	    onEnd: function(fn, _key) {
	      return this._on(END, fn, _key);
	    },
	    onAny: function(fn, _key) {
	      return this._on(ANY, fn, _key);
	    },
	    offValue: function(fn, _key) {
	      return this._off(VALUE, fn, _key);
	    },
	    offError: function(fn, _key) {
	      return this._off(ERROR, fn, _key);
	    },
	    offEnd: function(fn, _key) {
	      return this._off(END, fn, _key);
	    },
	    offAny: function(fn, _key) {
	      return this._off(ANY, fn, _key);
	    }
	  });
	  Observable.prototype.toString = function() {
	    return '[' + this._name + ']';
	  };
	  function Stream() {
	    Observable.call(this);
	  }
	  Kefir.Stream = Stream;
	  inherit(Stream, Observable, {_name: 'stream'});
	  function Property() {
	    Observable.call(this);
	    this._current = NOTHING;
	    this._currentError = NOTHING;
	  }
	  Kefir.Property = Property;
	  inherit(Property, Observable, {
	    _name: 'property',
	    _send: function(type, x, isCurrent) {
	      if (this._alive) {
	        if (!isCurrent) {
	          this._subscribers.callAll(Event(type, x));
	        }
	        if (type === VALUE) {
	          this._current = x;
	        }
	        if (type === ERROR) {
	          this._currentError = x;
	        }
	        if (type === END) {
	          this._clear();
	        }
	      }
	    },
	    _on: function(type, fn, _key) {
	      if (this._alive) {
	        this._subscribers.add(type, fn, _key);
	        this._setActive(true);
	      }
	      if (this._current !== NOTHING) {
	        Subscribers.callOnce(type, fn, Event(VALUE, this._current, true));
	      }
	      if (this._currentError !== NOTHING) {
	        Subscribers.callOnce(type, fn, Event(ERROR, this._currentError, true));
	      }
	      if (!this._alive) {
	        Subscribers.callOnce(type, fn, CURRENT_END);
	      }
	      return this;
	    }
	  });
	  Observable.prototype.log = function(name) {
	    name = name || this.toString();
	    this.onAny(function(event) {
	      var typeStr = '<' + event.type + (event.current ? ':current' : '') + '>';
	      if (event.type === VALUE || event.type === ERROR) {
	        console.log(name, typeStr, event.value);
	      } else {
	        console.log(name, typeStr);
	      }
	    }, ['__logKey__', this, name]);
	    return this;
	  };
	  Observable.prototype.offLog = function(name) {
	    name = name || this.toString();
	    this.offAny(null, ['__logKey__', this, name]);
	    return this;
	  };
	  withInterval('withInterval', {
	    _init: function(args) {
	      this._fn = args[0];
	      var $ = this;
	      this._emitter = {
	        emit: function(x) {
	          $._send(VALUE, x);
	        },
	        error: function(x) {
	          $._send(ERROR, x);
	        },
	        end: function() {
	          $._send(END);
	        }
	      };
	    },
	    _free: function() {
	      this._fn = null;
	      this._emitter = null;
	    },
	    _onTick: function() {
	      this._fn(this._emitter);
	    }
	  });
	  withInterval('fromPoll', {
	    _init: function(args) {
	      this._fn = args[0];
	    },
	    _free: function() {
	      this._fn = null;
	    },
	    _onTick: function() {
	      this._send(VALUE, this._fn());
	    }
	  });
	  withInterval('interval', {
	    _init: function(args) {
	      this._x = args[0];
	    },
	    _free: function() {
	      this._x = null;
	    },
	    _onTick: function() {
	      this._send(VALUE, this._x);
	    }
	  });
	  withInterval('sequentially', {
	    _init: function(args) {
	      this._xs = cloneArray(args[0]);
	      if (this._xs.length === 0) {
	        this._send(END);
	      }
	    },
	    _free: function() {
	      this._xs = null;
	    },
	    _onTick: function() {
	      switch (this._xs.length) {
	        case 1:
	          this._send(VALUE, this._xs[0]);
	          this._send(END);
	          break;
	        default:
	          this._send(VALUE, this._xs.shift());
	      }
	    }
	  });
	  withInterval('repeatedly', {
	    _init: function(args) {
	      this._xs = cloneArray(args[0]);
	      this._i = -1;
	    },
	    _onTick: function() {
	      if (this._xs.length > 0) {
	        this._i = (this._i + 1) % this._xs.length;
	        this._send(VALUE, this._xs[this._i]);
	      }
	    }
	  });
	  withInterval('later', {
	    _init: function(args) {
	      this._x = args[0];
	    },
	    _free: function() {
	      this._x = null;
	    },
	    _onTick: function() {
	      this._send(VALUE, this._x);
	      this._send(END);
	    }
	  });
	  function _AbstractPool(options) {
	    Stream.call(this);
	    this._queueLim = get(options, 'queueLim', 0);
	    this._concurLim = get(options, 'concurLim', -1);
	    this._drop = get(options, 'drop', 'new');
	    if (this._concurLim === 0) {
	      throw new Error('options.concurLim can\'t be 0');
	    }
	    var $ = this;
	    this._$handleSubAny = function(event) {
	      $._handleSubAny(event);
	    };
	    this._queue = [];
	    this._curSources = [];
	    this._activating = false;
	  }
	  inherit(_AbstractPool, Stream, {
	    _name: 'abstractPool',
	    _add: function(obj, toObs) {
	      toObs = toObs || id;
	      if (this._concurLim === -1 || this._curSources.length < this._concurLim) {
	        this._addToCur(toObs(obj));
	      } else {
	        if (this._queueLim === -1 || this._queue.length < this._queueLim) {
	          this._addToQueue(toObs(obj));
	        } else if (this._drop === 'old') {
	          this._removeOldest();
	          this._add(toObs(obj));
	        }
	      }
	    },
	    _addAll: function(obss) {
	      var $ = this;
	      forEach(obss, function(obs) {
	        $._add(obs);
	      });
	    },
	    _remove: function(obs) {
	      if (this._removeCur(obs) === -1) {
	        this._removeQueue(obs);
	      }
	    },
	    _addToQueue: function(obs) {
	      this._queue = concat(this._queue, [obs]);
	    },
	    _addToCur: function(obs) {
	      this._curSources = concat(this._curSources, [obs]);
	      if (this._active) {
	        this._subscribe(obs);
	      }
	    },
	    _subscribe: function(obs) {
	      var $ = this;
	      obs.onAny(this._$handleSubAny);
	      obs.onEnd(function() {
	        $._removeCur(obs);
	      }, [this, obs]);
	    },
	    _unsubscribe: function(obs) {
	      obs.offAny(this._$handleSubAny);
	      obs.offEnd(null, [this, obs]);
	    },
	    _handleSubAny: function(event) {
	      if (event.type === VALUE || event.type === ERROR) {
	        this._send(event.type, event.value, event.current && this._activating);
	      }
	    },
	    _removeQueue: function(obs) {
	      var index = find(this._queue, obs);
	      this._queue = remove(this._queue, index);
	      return index;
	    },
	    _removeCur: function(obs) {
	      if (this._active) {
	        this._unsubscribe(obs);
	      }
	      var index = find(this._curSources, obs);
	      this._curSources = remove(this._curSources, index);
	      if (index !== -1) {
	        if (this._queue.length !== 0) {
	          this._pullQueue();
	        } else if (this._curSources.length === 0) {
	          this._onEmpty();
	        }
	      }
	      return index;
	    },
	    _removeOldest: function() {
	      this._removeCur(this._curSources[0]);
	    },
	    _pullQueue: function() {
	      if (this._queue.length !== 0) {
	        this._queue = cloneArray(this._queue);
	        this._addToCur(this._queue.shift());
	      }
	    },
	    _onActivation: function() {
	      var sources = this._curSources,
	          i;
	      this._activating = true;
	      for (i = 0; i < sources.length; i++) {
	        this._subscribe(sources[i]);
	      }
	      this._activating = false;
	    },
	    _onDeactivation: function() {
	      var sources = this._curSources,
	          i;
	      for (i = 0; i < sources.length; i++) {
	        this._unsubscribe(sources[i]);
	      }
	    },
	    _isEmpty: function() {
	      return this._curSources.length === 0;
	    },
	    _onEmpty: function() {},
	    _clear: function() {
	      Stream.prototype._clear.call(this);
	      this._queue = null;
	      this._curSources = null;
	      this._$handleSubAny = null;
	    }
	  });
	  var MergeLike = {_onEmpty: function() {
	      if (this._initialised) {
	        this._send(END, null, this._activating);
	      }
	    }};
	  function Merge(sources) {
	    _AbstractPool.call(this);
	    if (sources.length === 0) {
	      this._send(END);
	    } else {
	      this._addAll(sources);
	    }
	    this._initialised = true;
	  }
	  inherit(Merge, _AbstractPool, extend({_name: 'merge'}, MergeLike));
	  Kefir.merge = function(obss) {
	    return new Merge(obss);
	  };
	  Observable.prototype.merge = function(other) {
	    return Kefir.merge([this, other]);
	  };
	  function Concat(sources) {
	    _AbstractPool.call(this, {
	      concurLim: 1,
	      queueLim: -1
	    });
	    if (sources.length === 0) {
	      this._send(END);
	    } else {
	      this._addAll(sources);
	    }
	    this._initialised = true;
	  }
	  inherit(Concat, _AbstractPool, extend({_name: 'concat'}, MergeLike));
	  Kefir.concat = function(obss) {
	    return new Concat(obss);
	  };
	  Observable.prototype.concat = function(other) {
	    return Kefir.concat([this, other]);
	  };
	  function Pool() {
	    _AbstractPool.call(this);
	  }
	  inherit(Pool, _AbstractPool, {
	    _name: 'pool',
	    plug: function(obs) {
	      this._add(obs);
	      return this;
	    },
	    unplug: function(obs) {
	      this._remove(obs);
	      return this;
	    }
	  });
	  Kefir.pool = function() {
	    return new Pool();
	  };
	  function Bus() {
	    _AbstractPool.call(this);
	  }
	  inherit(Bus, _AbstractPool, {
	    _name: 'bus',
	    plug: function(obs) {
	      this._add(obs);
	      return this;
	    },
	    unplug: function(obs) {
	      this._remove(obs);
	      return this;
	    },
	    emit: function(x) {
	      this._send(VALUE, x);
	      return this;
	    },
	    error: function(x) {
	      this._send(ERROR, x);
	      return this;
	    },
	    end: function() {
	      this._send(END);
	      return this;
	    }
	  });
	  Kefir.bus = function() {
	    return new Bus();
	  };
	  function FlatMap(source, fn, options) {
	    _AbstractPool.call(this, options);
	    this._source = source;
	    this._fn = fn || id;
	    this._mainEnded = false;
	    this._lastCurrent = null;
	    var $ = this;
	    this._$handleMainSource = function(event) {
	      $._handleMainSource(event);
	    };
	  }
	  inherit(FlatMap, _AbstractPool, {
	    _onActivation: function() {
	      _AbstractPool.prototype._onActivation.call(this);
	      if (this._active) {
	        this._activating = true;
	        this._source.onAny(this._$handleMainSource);
	        this._activating = false;
	      }
	    },
	    _onDeactivation: function() {
	      _AbstractPool.prototype._onDeactivation.call(this);
	      this._source.offAny(this._$handleMainSource);
	    },
	    _handleMainSource: function(event) {
	      if (event.type === VALUE) {
	        if (!event.current || this._lastCurrent !== event.value) {
	          this._add(event.value, this._fn);
	        }
	        this._lastCurrent = event.value;
	      }
	      if (event.type === ERROR) {
	        this._send(ERROR, event.value, event.current);
	      }
	      if (event.type === END) {
	        if (this._isEmpty()) {
	          this._send(END, null, event.current);
	        } else {
	          this._mainEnded = true;
	        }
	      }
	    },
	    _onEmpty: function() {
	      if (this._mainEnded) {
	        this._send(END);
	      }
	    },
	    _clear: function() {
	      _AbstractPool.prototype._clear.call(this);
	      this._source = null;
	      this._lastCurrent = null;
	      this._$handleMainSource = null;
	    }
	  });
	  Observable.prototype.flatMap = function(fn) {
	    return new FlatMap(this, fn).setName(this, 'flatMap');
	  };
	  Observable.prototype.flatMapLatest = function(fn) {
	    return new FlatMap(this, fn, {
	      concurLim: 1,
	      drop: 'old'
	    }).setName(this, 'flatMapLatest');
	  };
	  Observable.prototype.flatMapFirst = function(fn) {
	    return new FlatMap(this, fn, {concurLim: 1}).setName(this, 'flatMapFirst');
	  };
	  Observable.prototype.flatMapConcat = function(fn) {
	    return new FlatMap(this, fn, {
	      queueLim: -1,
	      concurLim: 1
	    }).setName(this, 'flatMapConcat');
	  };
	  Observable.prototype.flatMapConcurLimit = function(fn, limit) {
	    var result;
	    if (limit === 0) {
	      result = Kefir.never();
	    } else {
	      if (limit < 0) {
	        limit = -1;
	      }
	      result = new FlatMap(this, fn, {
	        queueLim: -1,
	        concurLim: limit
	      });
	    }
	    return result.setName(this, 'flatMapConcurLimit');
	  };
	  function Zip(sources, combinator) {
	    Stream.call(this);
	    if (sources.length === 0) {
	      this._send(END);
	    } else {
	      this._buffers = map(sources, function(source) {
	        return isArray(source) ? cloneArray(source) : [];
	      });
	      this._sources = map(sources, function(source) {
	        return isArray(source) ? Kefir.never() : source;
	      });
	      this._combinator = combinator ? spread(combinator, this._sources.length) : id;
	      this._aliveCount = 0;
	    }
	  }
	  inherit(Zip, Stream, {
	    _name: 'zip',
	    _onActivation: function() {
	      var i,
	          length = this._sources.length;
	      this._drainArrays();
	      this._aliveCount = length;
	      for (i = 0; i < length; i++) {
	        this._sources[i].onAny(this._bindHandleAny(i), [this, i]);
	      }
	    },
	    _onDeactivation: function() {
	      for (var i = 0; i < this._sources.length; i++) {
	        this._sources[i].offAny(null, [this, i]);
	      }
	    },
	    _emit: function(isCurrent) {
	      var values = new Array(this._buffers.length);
	      for (var i = 0; i < this._buffers.length; i++) {
	        values[i] = this._buffers[i].shift();
	      }
	      this._send(VALUE, this._combinator(values), isCurrent);
	    },
	    _isFull: function() {
	      for (var i = 0; i < this._buffers.length; i++) {
	        if (this._buffers[i].length === 0) {
	          return false;
	        }
	      }
	      return true;
	    },
	    _emitIfFull: function(isCurrent) {
	      if (this._isFull()) {
	        this._emit(isCurrent);
	      }
	    },
	    _drainArrays: function() {
	      while (this._isFull()) {
	        this._emit(true);
	      }
	    },
	    _bindHandleAny: function(i) {
	      var $ = this;
	      return function(event) {
	        $._handleAny(i, event);
	      };
	    },
	    _handleAny: function(i, event) {
	      if (event.type === VALUE) {
	        this._buffers[i].push(event.value);
	        this._emitIfFull(event.current);
	      }
	      if (event.type === ERROR) {
	        this._send(ERROR, event.value, event.current);
	      }
	      if (event.type === END) {
	        this._aliveCount--;
	        if (this._aliveCount === 0) {
	          this._send(END, null, event.current);
	        }
	      }
	    },
	    _clear: function() {
	      Stream.prototype._clear.call(this);
	      this._sources = null;
	      this._buffers = null;
	      this._combinator = null;
	    }
	  });
	  Kefir.zip = function(sources, combinator) {
	    return new Zip(sources, combinator);
	  };
	  Observable.prototype.zip = function(other, combinator) {
	    return new Zip([this, other], combinator);
	  };
	  function SampledBy(passive, active, combinator) {
	    Stream.call(this);
	    if (active.length === 0) {
	      this._send(END);
	    } else {
	      this._passiveCount = passive.length;
	      this._sources = concat(passive, active);
	      this._combinator = combinator ? spread(combinator, this._sources.length) : id;
	      this._aliveCount = 0;
	      this._currents = new Array(this._sources.length);
	      fillArray(this._currents, NOTHING);
	      this._activating = false;
	      this._emitAfterActivation = false;
	      this._endAfterActivation = false;
	    }
	  }
	  inherit(SampledBy, Stream, {
	    _name: 'sampledBy',
	    _onActivation: function() {
	      var length = this._sources.length,
	          i;
	      this._aliveCount = length - this._passiveCount;
	      this._activating = true;
	      for (i = 0; i < length; i++) {
	        this._sources[i].onAny(this._bindHandleAny(i), [this, i]);
	      }
	      this._activating = false;
	      if (this._emitAfterActivation) {
	        this._emitAfterActivation = false;
	        this._emitIfFull(true);
	      }
	      if (this._endAfterActivation) {
	        this._send(END, null, true);
	      }
	    },
	    _onDeactivation: function() {
	      var length = this._sources.length,
	          i;
	      for (i = 0; i < length; i++) {
	        this._sources[i].offAny(null, [this, i]);
	      }
	    },
	    _emitIfFull: function(isCurrent) {
	      if (!contains(this._currents, NOTHING)) {
	        var combined = cloneArray(this._currents);
	        combined = this._combinator(combined);
	        this._send(VALUE, combined, isCurrent);
	      }
	    },
	    _bindHandleAny: function(i) {
	      var $ = this;
	      return function(event) {
	        $._handleAny(i, event);
	      };
	    },
	    _handleAny: function(i, event) {
	      if (event.type === VALUE) {
	        this._currents[i] = event.value;
	        if (i >= this._passiveCount) {
	          if (this._activating) {
	            this._emitAfterActivation = true;
	          } else {
	            this._emitIfFull(event.current);
	          }
	        }
	      }
	      if (event.type === ERROR) {
	        this._send(ERROR, event.value, event.current);
	      }
	      if (event.type === END) {
	        if (i >= this._passiveCount) {
	          this._aliveCount--;
	          if (this._aliveCount === 0) {
	            if (this._activating) {
	              this._endAfterActivation = true;
	            } else {
	              this._send(END, null, event.current);
	            }
	          }
	        }
	      }
	    },
	    _clear: function() {
	      Stream.prototype._clear.call(this);
	      this._sources = null;
	      this._currents = null;
	      this._combinator = null;
	    }
	  });
	  Kefir.sampledBy = function(passive, active, combinator) {
	    return new SampledBy(passive, active, combinator);
	  };
	  Observable.prototype.sampledBy = function(other, combinator) {
	    return Kefir.sampledBy([this], [other], combinator || id);
	  };
	  Kefir.combine = function(sources, combinator) {
	    return new SampledBy([], sources, combinator).setName('combine');
	  };
	  Observable.prototype.combine = function(other, combinator) {
	    return Kefir.combine([this, other], combinator);
	  };
	  function produceStream(StreamClass, PropertyClass) {
	    return function() {
	      return new StreamClass(this, arguments);
	    };
	  }
	  function produceProperty(StreamClass, PropertyClass) {
	    return function() {
	      return new PropertyClass(this, arguments);
	    };
	  }
	  withOneSource('toProperty', {_init: function(args) {
	      if (args.length > 0) {
	        this._send(VALUE, args[0]);
	      }
	    }}, {
	    propertyMethod: produceProperty,
	    streamMethod: produceProperty
	  });
	  withOneSource('changes', {
	    _handleValue: function(x, isCurrent) {
	      if (!isCurrent) {
	        this._send(VALUE, x);
	      }
	    },
	    _handleError: function(x, isCurrent) {
	      if (!isCurrent) {
	        this._send(ERROR, x);
	      }
	    }
	  }, {
	    streamMethod: function() {
	      return function() {
	        return this;
	      };
	    },
	    propertyMethod: produceStream
	  });
	  withOneSource('withHandler', {
	    _init: function(args) {
	      this._handler = args[0];
	      this._forcedCurrent = false;
	      var $ = this;
	      this._emitter = {
	        emit: function(x) {
	          $._send(VALUE, x, $._forcedCurrent);
	        },
	        error: function(x) {
	          $._send(ERROR, x, $._forcedCurrent);
	        },
	        end: function() {
	          $._send(END, null, $._forcedCurrent);
	        }
	      };
	    },
	    _free: function() {
	      this._handler = null;
	      this._emitter = null;
	    },
	    _handleAny: function(event) {
	      this._forcedCurrent = event.current;
	      this._handler(this._emitter, event);
	      this._forcedCurrent = false;
	    }
	  });
	  withOneSource('flatten', {
	    _init: function(args) {
	      this._fn = args[0] ? args[0] : id;
	    },
	    _free: function() {
	      this._fn = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      var xs = this._fn(x);
	      for (var i = 0; i < xs.length; i++) {
	        this._send(VALUE, xs[i], isCurrent);
	      }
	    }
	  });
	  function xformForObs(obs) {
	    return {
	      step: function(res, input) {
	        obs._send(VALUE, input, obs._forcedCurrent);
	        return null;
	      },
	      result: function(res) {
	        obs._send(END, null, obs._forcedCurrent);
	        return null;
	      }
	    };
	  }
	  withOneSource('transduce', {
	    _init: function(args) {
	      this._xform = args[0](xformForObs(this));
	    },
	    _free: function() {
	      this._xform = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      this._forcedCurrent = isCurrent;
	      if (this._xform.step(null, x) !== null) {
	        this._xform.result(null);
	      }
	      this._forcedCurrent = false;
	    },
	    _handleEnd: function(__, isCurrent) {
	      this._forcedCurrent = isCurrent;
	      this._xform.result(null);
	      this._forcedCurrent = false;
	    }
	  });
	  var withFnArgMixin = {
	    _init: function(args) {
	      this._fn = args[0] || id;
	    },
	    _free: function() {
	      this._fn = null;
	    }
	  };
	  withOneSource('map', extend({_handleValue: function(x, isCurrent) {
	      this._send(VALUE, this._fn(x), isCurrent);
	    }}, withFnArgMixin));
	  withOneSource('mapErrors', extend({_handleError: function(x, isCurrent) {
	      this._send(ERROR, this._fn(x), isCurrent);
	    }}, withFnArgMixin));
	  function defaultErrorsToValuesHandler(x) {
	    return {
	      convert: true,
	      value: x
	    };
	  }
	  withOneSource('errorsToValues', extend({
	    _init: function(args) {
	      this._fn = args[0] || defaultErrorsToValuesHandler;
	    },
	    _free: function() {
	      this._fn = null;
	    },
	    _handleError: function(x, isCurrent) {
	      var result = this._fn(x);
	      var type = result.convert ? VALUE : ERROR;
	      var newX = result.convert ? result.value : x;
	      this._send(type, newX, isCurrent);
	    }
	  }));
	  function defaultValuesToErrorsHandler(x) {
	    return {
	      convert: true,
	      error: x
	    };
	  }
	  withOneSource('valuesToErrors', extend({
	    _init: function(args) {
	      this._fn = args[0] || defaultValuesToErrorsHandler;
	    },
	    _free: function() {
	      this._fn = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      var result = this._fn(x);
	      var type = result.convert ? ERROR : VALUE;
	      var newX = result.convert ? result.error : x;
	      this._send(type, newX, isCurrent);
	    }
	  }));
	  withOneSource('filter', extend({_handleValue: function(x, isCurrent) {
	      if (this._fn(x)) {
	        this._send(VALUE, x, isCurrent);
	      }
	    }}, withFnArgMixin));
	  withOneSource('filterErrors', extend({_handleError: function(x, isCurrent) {
	      if (this._fn(x)) {
	        this._send(ERROR, x, isCurrent);
	      }
	    }}, withFnArgMixin));
	  withOneSource('takeWhile', extend({_handleValue: function(x, isCurrent) {
	      if (this._fn(x)) {
	        this._send(VALUE, x, isCurrent);
	      } else {
	        this._send(END, null, isCurrent);
	      }
	    }}, withFnArgMixin));
	  withOneSource('take', {
	    _init: function(args) {
	      this._n = args[0];
	      if (this._n <= 0) {
	        this._send(END);
	      }
	    },
	    _handleValue: function(x, isCurrent) {
	      this._n--;
	      this._send(VALUE, x, isCurrent);
	      if (this._n === 0) {
	        this._send(END, null, isCurrent);
	      }
	    }
	  });
	  withOneSource('skip', {
	    _init: function(args) {
	      this._n = Math.max(0, args[0]);
	    },
	    _handleValue: function(x, isCurrent) {
	      if (this._n === 0) {
	        this._send(VALUE, x, isCurrent);
	      } else {
	        this._n--;
	      }
	    }
	  });
	  withOneSource('skipDuplicates', {
	    _init: function(args) {
	      this._fn = args[0] || strictEqual;
	      this._prev = NOTHING;
	    },
	    _free: function() {
	      this._fn = null;
	      this._prev = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      if (this._prev === NOTHING || !this._fn(this._prev, x)) {
	        this._prev = x;
	        this._send(VALUE, x, isCurrent);
	      }
	    }
	  });
	  withOneSource('skipWhile', {
	    _init: function(args) {
	      this._fn = args[0] || id;
	      this._skip = true;
	    },
	    _free: function() {
	      this._fn = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      if (!this._skip) {
	        this._send(VALUE, x, isCurrent);
	        return;
	      }
	      if (!this._fn(x)) {
	        this._skip = false;
	        this._fn = null;
	        this._send(VALUE, x, isCurrent);
	      }
	    }
	  });
	  withOneSource('diff', {
	    _init: function(args) {
	      this._fn = args[0] || defaultDiff;
	      this._prev = args.length > 1 ? args[1] : NOTHING;
	    },
	    _free: function() {
	      this._prev = null;
	      this._fn = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      if (this._prev !== NOTHING) {
	        this._send(VALUE, this._fn(this._prev, x), isCurrent);
	      }
	      this._prev = x;
	    }
	  });
	  withOneSource('scan', {
	    _init: function(args) {
	      this._fn = args[0];
	      if (args.length > 1) {
	        this._send(VALUE, args[1], true);
	      }
	    },
	    _free: function() {
	      this._fn = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      if (this._current !== NOTHING) {
	        x = this._fn(this._current, x);
	      }
	      this._send(VALUE, x, isCurrent);
	    }
	  }, {streamMethod: produceProperty});
	  withOneSource('reduce', {
	    _init: function(args) {
	      this._fn = args[0];
	      this._result = args.length > 1 ? args[1] : NOTHING;
	    },
	    _free: function() {
	      this._fn = null;
	      this._result = null;
	    },
	    _handleValue: function(x) {
	      this._result = (this._result === NOTHING) ? x : this._fn(this._result, x);
	    },
	    _handleEnd: function(__, isCurrent) {
	      if (this._result !== NOTHING) {
	        this._send(VALUE, this._result, isCurrent);
	      }
	      this._send(END, null, isCurrent);
	    }
	  });
	  withOneSource('mapEnd', {
	    _init: function(args) {
	      this._fn = args[0];
	    },
	    _free: function() {
	      this._fn = null;
	    },
	    _handleEnd: function(__, isCurrent) {
	      this._send(VALUE, this._fn(), isCurrent);
	      this._send(END, null, isCurrent);
	    }
	  });
	  withOneSource('skipValues', {_handleValue: function() {}});
	  withOneSource('skipErrors', {_handleError: function() {}});
	  withOneSource('skipEnd', {_handleEnd: function() {}});
	  withOneSource('endOnError', extend({_handleError: function(x, isCurrent) {
	      this._send(ERROR, x, isCurrent);
	      this._send(END, null, isCurrent);
	    }}));
	  withOneSource('slidingWindow', {
	    _init: function(args) {
	      this._max = args[0];
	      this._min = args[1] || 0;
	      this._buff = [];
	    },
	    _free: function() {
	      this._buff = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      this._buff = slide(this._buff, x, this._max);
	      if (this._buff.length >= this._min) {
	        this._send(VALUE, this._buff, isCurrent);
	      }
	    }
	  });
	  withOneSource('bufferWhile', {
	    _init: function(args) {
	      this._fn = args[0] || id;
	      this._flushOnEnd = get(args[1], 'flushOnEnd', true);
	      this._buff = [];
	    },
	    _free: function() {
	      this._buff = null;
	    },
	    _flush: function(isCurrent) {
	      if (this._buff !== null && this._buff.length !== 0) {
	        this._send(VALUE, this._buff, isCurrent);
	        this._buff = [];
	      }
	    },
	    _handleValue: function(x, isCurrent) {
	      this._buff.push(x);
	      if (!this._fn(x)) {
	        this._flush(isCurrent);
	      }
	    },
	    _handleEnd: function(x, isCurrent) {
	      if (this._flushOnEnd) {
	        this._flush(isCurrent);
	      }
	      this._send(END, null, isCurrent);
	    }
	  });
	  withOneSource('debounce', {
	    _init: function(args) {
	      this._wait = Math.max(0, args[0]);
	      this._immediate = get(args[1], 'immediate', false);
	      this._lastAttempt = 0;
	      this._timeoutId = null;
	      this._laterValue = null;
	      this._endLater = false;
	      var $ = this;
	      this._$later = function() {
	        $._later();
	      };
	    },
	    _free: function() {
	      this._laterValue = null;
	      this._$later = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      if (isCurrent) {
	        this._send(VALUE, x, isCurrent);
	      } else {
	        this._lastAttempt = now();
	        if (this._immediate && !this._timeoutId) {
	          this._send(VALUE, x);
	        }
	        if (!this._timeoutId) {
	          this._timeoutId = setTimeout(this._$later, this._wait);
	        }
	        if (!this._immediate) {
	          this._laterValue = x;
	        }
	      }
	    },
	    _handleEnd: function(__, isCurrent) {
	      if (isCurrent) {
	        this._send(END, null, isCurrent);
	      } else {
	        if (this._timeoutId && !this._immediate) {
	          this._endLater = true;
	        } else {
	          this._send(END);
	        }
	      }
	    },
	    _later: function() {
	      var last = now() - this._lastAttempt;
	      if (last < this._wait && last >= 0) {
	        this._timeoutId = setTimeout(this._$later, this._wait - last);
	      } else {
	        this._timeoutId = null;
	        if (!this._immediate) {
	          this._send(VALUE, this._laterValue);
	          this._laterValue = null;
	        }
	        if (this._endLater) {
	          this._send(END);
	        }
	      }
	    }
	  });
	  withOneSource('throttle', {
	    _init: function(args) {
	      this._wait = Math.max(0, args[0]);
	      this._leading = get(args[1], 'leading', true);
	      this._trailing = get(args[1], 'trailing', true);
	      this._trailingValue = null;
	      this._timeoutId = null;
	      this._endLater = false;
	      this._lastCallTime = 0;
	      var $ = this;
	      this._$trailingCall = function() {
	        $._trailingCall();
	      };
	    },
	    _free: function() {
	      this._trailingValue = null;
	      this._$trailingCall = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      if (isCurrent) {
	        this._send(VALUE, x, isCurrent);
	      } else {
	        var curTime = now();
	        if (this._lastCallTime === 0 && !this._leading) {
	          this._lastCallTime = curTime;
	        }
	        var remaining = this._wait - (curTime - this._lastCallTime);
	        if (remaining <= 0) {
	          this._cancelTraling();
	          this._lastCallTime = curTime;
	          this._send(VALUE, x);
	        } else if (this._trailing) {
	          this._cancelTraling();
	          this._trailingValue = x;
	          this._timeoutId = setTimeout(this._$trailingCall, remaining);
	        }
	      }
	    },
	    _handleEnd: function(__, isCurrent) {
	      if (isCurrent) {
	        this._send(END, null, isCurrent);
	      } else {
	        if (this._timeoutId) {
	          this._endLater = true;
	        } else {
	          this._send(END);
	        }
	      }
	    },
	    _cancelTraling: function() {
	      if (this._timeoutId !== null) {
	        clearTimeout(this._timeoutId);
	        this._timeoutId = null;
	      }
	    },
	    _trailingCall: function() {
	      this._send(VALUE, this._trailingValue);
	      this._timeoutId = null;
	      this._trailingValue = null;
	      this._lastCallTime = !this._leading ? 0 : now();
	      if (this._endLater) {
	        this._send(END);
	      }
	    }
	  });
	  withOneSource('delay', {
	    _init: function(args) {
	      this._wait = Math.max(0, args[0]);
	      this._buff = [];
	      var $ = this;
	      this._$shiftBuff = function() {
	        $._send(VALUE, $._buff.shift());
	      };
	    },
	    _free: function() {
	      this._buff = null;
	      this._$shiftBuff = null;
	    },
	    _handleValue: function(x, isCurrent) {
	      if (isCurrent) {
	        this._send(VALUE, x, isCurrent);
	      } else {
	        this._buff.push(x);
	        setTimeout(this._$shiftBuff, this._wait);
	      }
	    },
	    _handleEnd: function(__, isCurrent) {
	      if (isCurrent) {
	        this._send(END, null, isCurrent);
	      } else {
	        var $ = this;
	        setTimeout(function() {
	          $._send(END);
	        }, this._wait);
	      }
	    }
	  });
	  function FromBinder(fn) {
	    Stream.call(this);
	    this._fn = fn;
	    this._unsubscribe = null;
	  }
	  inherit(FromBinder, Stream, {
	    _name: 'fromBinder',
	    _onActivation: function() {
	      var $ = this,
	          isCurrent = true,
	          emitter = {
	            emit: function(x) {
	              $._send(VALUE, x, isCurrent);
	            },
	            error: function(x) {
	              $._send(ERROR, x, isCurrent);
	            },
	            end: function() {
	              $._send(END, null, isCurrent);
	            }
	          };
	      this._unsubscribe = this._fn(emitter) || null;
	      if (!this._active && this._unsubscribe !== null) {
	        this._unsubscribe();
	        this._unsubscribe = null;
	      }
	      isCurrent = false;
	    },
	    _onDeactivation: function() {
	      if (this._unsubscribe !== null) {
	        this._unsubscribe();
	        this._unsubscribe = null;
	      }
	    },
	    _clear: function() {
	      Stream.prototype._clear.call(this);
	      this._fn = null;
	    }
	  });
	  Kefir.fromBinder = function(fn) {
	    return new FromBinder(fn);
	  };
	  function Emitter() {
	    Stream.call(this);
	  }
	  inherit(Emitter, Stream, {
	    _name: 'emitter',
	    emit: function(x) {
	      this._send(VALUE, x);
	      return this;
	    },
	    error: function(x) {
	      this._send(ERROR, x);
	      return this;
	    },
	    end: function() {
	      this._send(END);
	      return this;
	    }
	  });
	  Kefir.emitter = function() {
	    return new Emitter();
	  };
	  Kefir.Emitter = Emitter;
	  var neverObj = new Stream();
	  neverObj._send(END);
	  neverObj._name = 'never';
	  Kefir.never = function() {
	    return neverObj;
	  };
	  function Constant(x) {
	    Property.call(this);
	    this._send(VALUE, x);
	    this._send(END);
	  }
	  inherit(Constant, Property, {_name: 'constant'});
	  Kefir.constant = function(x) {
	    return new Constant(x);
	  };
	  function ConstantError(x) {
	    Property.call(this);
	    this._send(ERROR, x);
	    this._send(END);
	  }
	  inherit(ConstantError, Property, {_name: 'constantError'});
	  Kefir.constantError = function(x) {
	    return new ConstantError(x);
	  };
	  Observable.prototype.setName = function(sourceObs, selfName) {
	    this._name = selfName ? sourceObs._name + '.' + selfName : sourceObs;
	    return this;
	  };
	  Observable.prototype.mapTo = function(value) {
	    return this.map(function() {
	      return value;
	    }).setName(this, 'mapTo');
	  };
	  Observable.prototype.pluck = function(propertyName) {
	    return this.map(function(x) {
	      return x[propertyName];
	    }).setName(this, 'pluck');
	  };
	  Observable.prototype.invoke = function(methodName) {
	    var args = rest(arguments, 1);
	    return this.map(args ? function(x) {
	      return apply(x[methodName], x, args);
	    } : function(x) {
	      return x[methodName]();
	    }).setName(this, 'invoke');
	  };
	  Observable.prototype.timestamp = function() {
	    return this.map(function(x) {
	      return {
	        value: x,
	        time: now()
	      };
	    }).setName(this, 'timestamp');
	  };
	  Observable.prototype.tap = function(fn) {
	    return this.map(function(x) {
	      fn(x);
	      return x;
	    }).setName(this, 'tap');
	  };
	  Kefir.and = function(observables) {
	    return Kefir.combine(observables, and).setName('and');
	  };
	  Observable.prototype.and = function(other) {
	    return this.combine(other, and).setName('and');
	  };
	  Kefir.or = function(observables) {
	    return Kefir.combine(observables, or).setName('or');
	  };
	  Observable.prototype.or = function(other) {
	    return this.combine(other, or).setName('or');
	  };
	  Observable.prototype.not = function() {
	    return this.map(not).setName(this, 'not');
	  };
	  Observable.prototype.awaiting = function(other) {
	    return Kefir.merge([this.mapTo(true), other.mapTo(false)]).skipDuplicates().toProperty(false).setName(this, 'awaiting');
	  };
	  Kefir.fromCallback = function(callbackConsumer) {
	    var called = false;
	    return Kefir.fromBinder(function(emitter) {
	      if (!called) {
	        callbackConsumer(function(x) {
	          emitter.emit(x);
	          emitter.end();
	        });
	        called = true;
	      }
	    }).setName('fromCallback');
	  };
	  Kefir.fromNodeCallback = function(callbackConsumer) {
	    var called = false;
	    return Kefir.fromBinder(function(emitter) {
	      if (!called) {
	        callbackConsumer(function(error, x) {
	          if (error) {
	            emitter.error(error);
	          } else {
	            emitter.emit(x);
	          }
	          emitter.end();
	        });
	        called = true;
	      }
	    }).setName('fromNodeCallback');
	  };
	  Kefir.fromPromise = function(promise) {
	    var called = false;
	    return Kefir.fromBinder(function(emitter) {
	      if (!called) {
	        var onValue = function(x) {
	          emitter.emit(x);
	          emitter.end();
	        };
	        var onError = function(x) {
	          emitter.error(x);
	          emitter.end();
	        };
	        var _promise = promise.then(onValue, onError);
	        if (_promise && isFn(_promise.done)) {
	          _promise.done();
	        }
	        called = true;
	      }
	    }).toProperty().setName('fromPromise');
	  };
	  Kefir.fromSubUnsub = function(sub, unsub, transformer) {
	    return Kefir.fromBinder(function(emitter) {
	      var handler = transformer ? function() {
	        emitter.emit(apply(transformer, this, arguments));
	      } : emitter.emit;
	      sub(handler);
	      return function() {
	        unsub(handler);
	      };
	    });
	  };
	  var subUnsubPairs = [['addEventListener', 'removeEventListener'], ['addListener', 'removeListener'], ['on', 'off']];
	  Kefir.fromEvent = function(target, eventName, transformer) {
	    var pair,
	        sub,
	        unsub;
	    for (var i = 0; i < subUnsubPairs.length; i++) {
	      pair = subUnsubPairs[i];
	      if (isFn(target[pair[0]]) && isFn(target[pair[1]])) {
	        sub = pair[0];
	        unsub = pair[1];
	        break;
	      }
	    }
	    if (sub === undefined) {
	      throw new Error('target don\'t support any of ' + 'addEventListener/removeEventListener, addListener/removeListener, on/off method pair');
	    }
	    return Kefir.fromSubUnsub(function(handler) {
	      target[sub](eventName, handler);
	    }, function(handler) {
	      target[unsub](eventName, handler);
	    }, transformer).setName('fromEvent');
	  };
	  var withTwoSourcesAndBufferMixin = {
	    _init: function(args) {
	      this._buff = [];
	      this._flushOnEnd = get(args[0], 'flushOnEnd', true);
	    },
	    _free: function() {
	      this._buff = null;
	    },
	    _flush: function(isCurrent) {
	      if (this._buff !== null && this._buff.length !== 0) {
	        this._send(VALUE, this._buff, isCurrent);
	        this._buff = [];
	      }
	    },
	    _handlePrimaryEnd: function(__, isCurrent) {
	      if (this._flushOnEnd) {
	        this._flush(isCurrent);
	      }
	      this._send(END, null, isCurrent);
	    }
	  };
	  withTwoSources('bufferBy', extend({
	    _onActivation: function() {
	      this._primary.onAny(this._$handlePrimaryAny);
	      if (this._alive && this._secondary !== null) {
	        this._secondary.onAny(this._$handleSecondaryAny);
	      }
	    },
	    _handlePrimaryValue: function(x, isCurrent) {
	      this._buff.push(x);
	    },
	    _handleSecondaryValue: function(x, isCurrent) {
	      this._flush(isCurrent);
	    },
	    _handleSecondaryEnd: function(x, isCurrent) {
	      if (!this._flushOnEnd) {
	        this._send(END, null, isCurrent);
	      }
	    }
	  }, withTwoSourcesAndBufferMixin));
	  withTwoSources('bufferWhileBy', extend({
	    _handlePrimaryValue: function(x, isCurrent) {
	      this._buff.push(x);
	      if (this._lastSecondary !== NOTHING && !this._lastSecondary) {
	        this._flush(isCurrent);
	      }
	    },
	    _handleSecondaryEnd: function(x, isCurrent) {
	      if (!this._flushOnEnd && (this._lastSecondary === NOTHING || this._lastSecondary)) {
	        this._send(END, null, isCurrent);
	      }
	    }
	  }, withTwoSourcesAndBufferMixin));
	  withTwoSources('filterBy', {
	    _handlePrimaryValue: function(x, isCurrent) {
	      if (this._lastSecondary !== NOTHING && this._lastSecondary) {
	        this._send(VALUE, x, isCurrent);
	      }
	    },
	    _handleSecondaryEnd: function(__, isCurrent) {
	      if (this._lastSecondary === NOTHING || !this._lastSecondary) {
	        this._send(END, null, isCurrent);
	      }
	    }
	  });
	  withTwoSources('skipUntilBy', {
	    _handlePrimaryValue: function(x, isCurrent) {
	      if (this._lastSecondary !== NOTHING) {
	        this._send(VALUE, x, isCurrent);
	      }
	    },
	    _handleSecondaryEnd: function(__, isCurrent) {
	      if (this._lastSecondary === NOTHING) {
	        this._send(END, null, isCurrent);
	      }
	    }
	  });
	  withTwoSources('takeUntilBy', {_handleSecondaryValue: function(x, isCurrent) {
	      this._send(END, null, isCurrent);
	    }});
	  withTwoSources('takeWhileBy', {
	    _handlePrimaryValue: function(x, isCurrent) {
	      if (this._lastSecondary !== NOTHING) {
	        this._send(VALUE, x, isCurrent);
	      }
	    },
	    _handleSecondaryValue: function(x, isCurrent) {
	      this._lastSecondary = x;
	      if (!this._lastSecondary) {
	        this._send(END, null, isCurrent);
	      }
	    },
	    _handleSecondaryEnd: function(__, isCurrent) {
	      if (this._lastSecondary === NOTHING) {
	        this._send(END, null, isCurrent);
	      }
	    }
	  });
	  withTwoSources('skipWhileBy', {
	    _init: function() {
	      this._hasFalseyFromSecondary = false;
	    },
	    _handlePrimaryValue: function(x, isCurrent) {
	      if (this._hasFalseyFromSecondary) {
	        this._send(VALUE, x, isCurrent);
	      }
	    },
	    _handleSecondaryValue: function(x, isCurrent) {
	      this._hasFalseyFromSecondary = this._hasFalseyFromSecondary || !x;
	    },
	    _handleSecondaryEnd: function(__, isCurrent) {
	      if (!this._hasFalseyFromSecondary) {
	        this._send(END, null, isCurrent);
	      }
	    }
	  });
	  if (true) {
	    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function() {
	      return Kefir;
	    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	    global.Kefir = Kefir;
	  } else if (typeof module === "object" && typeof exports === "object") {
	    module.exports = Kefir;
	    Kefir.Kefir = Kefir;
	  } else {
	    global.Kefir = Kefir;
	  }
	}(this));


/***/ },
/* 43 */
/***/ function(module, exports, __webpack_require__) {

	void 0 === Date.now && (Date.now = function() {
	  return (new Date).valueOf();
	});
	var TWEEN = TWEEN || function() {
	  var n = [];
	  return {
	    REVISION: "14",
	    getAll: function() {
	      return n;
	    },
	    removeAll: function() {
	      n = [];
	    },
	    add: function(t) {
	      n.push(t);
	    },
	    remove: function(t) {
	      var r = n.indexOf(t);
	      -1 !== r && n.splice(r, 1);
	    },
	    update: function(t) {
	      if (0 === n.length)
	        return !1;
	      var r = 0;
	      for (t = void 0 !== t ? t : "undefined" != typeof window && void 0 !== window.performance && void 0 !== window.performance.now ? window.performance.now() : Date.now(); r < n.length; )
	        n[r].update(t) ? r++ : n.splice(r, 1);
	      return !0;
	    }
	  };
	}();
	TWEEN.Tween = function(n) {
	  var t = n,
	      r = {},
	      i = {},
	      u = {},
	      o = 1e3,
	      e = 0,
	      a = !1,
	      f = !1,
	      c = !1,
	      s = 0,
	      h = null,
	      l = TWEEN.Easing.Linear.None,
	      p = TWEEN.Interpolation.Linear,
	      E = [],
	      d = null,
	      v = !1,
	      I = null,
	      w = null,
	      M = null;
	  for (var O in n)
	    r[O] = parseFloat(n[O], 10);
	  this.to = function(n, t) {
	    return void 0 !== t && (o = t), i = n, this;
	  }, this.start = function(n) {
	    TWEEN.add(this), f = !0, v = !1, h = void 0 !== n ? n : "undefined" != typeof window && void 0 !== window.performance && void 0 !== window.performance.now ? window.performance.now() : Date.now(), h += s;
	    for (var o in i) {
	      if (i[o] instanceof Array) {
	        if (0 === i[o].length)
	          continue;
	        i[o] = [t[o]].concat(i[o]);
	      }
	      r[o] = t[o], r[o] instanceof Array == !1 && (r[o] *= 1), u[o] = r[o] || 0;
	    }
	    return this;
	  }, this.stop = function() {
	    return f ? (TWEEN.remove(this), f = !1, null !== M && M.call(t), this.stopChainedTweens(), this) : this;
	  }, this.stopChainedTweens = function() {
	    for (var n = 0,
	        t = E.length; t > n; n++)
	      E[n].stop();
	  }, this.delay = function(n) {
	    return s = n, this;
	  }, this.repeat = function(n) {
	    return e = n, this;
	  }, this.yoyo = function(n) {
	    return a = n, this;
	  }, this.easing = function(n) {
	    return l = n, this;
	  }, this.interpolation = function(n) {
	    return p = n, this;
	  }, this.chain = function() {
	    return E = arguments, this;
	  }, this.onStart = function(n) {
	    return d = n, this;
	  }, this.onUpdate = function(n) {
	    return I = n, this;
	  }, this.onComplete = function(n) {
	    return w = n, this;
	  }, this.onStop = function(n) {
	    return M = n, this;
	  }, this.update = function(n) {
	    var f;
	    if (h > n)
	      return !0;
	    v === !1 && (null !== d && d.call(t), v = !0);
	    var M = (n - h) / o;
	    M = M > 1 ? 1 : M;
	    var O = l(M);
	    for (f in i) {
	      var m = r[f] || 0,
	          N = i[f];
	      N instanceof Array ? t[f] = p(N, O) : ("string" == typeof N && (N = m + parseFloat(N, 10)), "number" == typeof N && (t[f] = m + (N - m) * O));
	    }
	    if (null !== I && I.call(t, O), 1 == M) {
	      if (e > 0) {
	        isFinite(e) && e--;
	        for (f in u) {
	          if ("string" == typeof i[f] && (u[f] = u[f] + parseFloat(i[f], 10)), a) {
	            var T = u[f];
	            u[f] = i[f], i[f] = T;
	          }
	          r[f] = u[f];
	        }
	        return a && (c = !c), h = n + s, !0;
	      }
	      null !== w && w.call(t);
	      for (var g = 0,
	          W = E.length; W > g; g++)
	        E[g].start(n);
	      return !1;
	    }
	    return !0;
	  };
	}, TWEEN.Easing = {
	  Linear: {None: function(n) {
	      return n;
	    }},
	  Quadratic: {
	    In: function(n) {
	      return n * n;
	    },
	    Out: function(n) {
	      return n * (2 - n);
	    },
	    InOut: function(n) {
	      return (n *= 2) < 1 ? .5 * n * n : -.5 * (--n * (n - 2) - 1);
	    }
	  },
	  Cubic: {
	    In: function(n) {
	      return n * n * n;
	    },
	    Out: function(n) {
	      return --n * n * n + 1;
	    },
	    InOut: function(n) {
	      return (n *= 2) < 1 ? .5 * n * n * n : .5 * ((n -= 2) * n * n + 2);
	    }
	  },
	  Quartic: {
	    In: function(n) {
	      return n * n * n * n;
	    },
	    Out: function(n) {
	      return 1 - --n * n * n * n;
	    },
	    InOut: function(n) {
	      return (n *= 2) < 1 ? .5 * n * n * n * n : -.5 * ((n -= 2) * n * n * n - 2);
	    }
	  },
	  Quintic: {
	    In: function(n) {
	      return n * n * n * n * n;
	    },
	    Out: function(n) {
	      return --n * n * n * n * n + 1;
	    },
	    InOut: function(n) {
	      return (n *= 2) < 1 ? .5 * n * n * n * n * n : .5 * ((n -= 2) * n * n * n * n + 2);
	    }
	  },
	  Sinusoidal: {
	    In: function(n) {
	      return 1 - Math.cos(n * Math.PI / 2);
	    },
	    Out: function(n) {
	      return Math.sin(n * Math.PI / 2);
	    },
	    InOut: function(n) {
	      return .5 * (1 - Math.cos(Math.PI * n));
	    }
	  },
	  Exponential: {
	    In: function(n) {
	      return 0 === n ? 0 : Math.pow(1024, n - 1);
	    },
	    Out: function(n) {
	      return 1 === n ? 1 : 1 - Math.pow(2, -10 * n);
	    },
	    InOut: function(n) {
	      return 0 === n ? 0 : 1 === n ? 1 : (n *= 2) < 1 ? .5 * Math.pow(1024, n - 1) : .5 * (-Math.pow(2, -10 * (n - 1)) + 2);
	    }
	  },
	  Circular: {
	    In: function(n) {
	      return 1 - Math.sqrt(1 - n * n);
	    },
	    Out: function(n) {
	      return Math.sqrt(1 - --n * n);
	    },
	    InOut: function(n) {
	      return (n *= 2) < 1 ? -.5 * (Math.sqrt(1 - n * n) - 1) : .5 * (Math.sqrt(1 - (n -= 2) * n) + 1);
	    }
	  },
	  Elastic: {
	    In: function(n) {
	      var t,
	          r = .1,
	          i = .4;
	      return 0 === n ? 0 : 1 === n ? 1 : (!r || 1 > r ? (r = 1, t = i / 4) : t = i * Math.asin(1 / r) / (2 * Math.PI), -(r * Math.pow(2, 10 * (n -= 1)) * Math.sin(2 * (n - t) * Math.PI / i)));
	    },
	    Out: function(n) {
	      var t,
	          r = .1,
	          i = .4;
	      return 0 === n ? 0 : 1 === n ? 1 : (!r || 1 > r ? (r = 1, t = i / 4) : t = i * Math.asin(1 / r) / (2 * Math.PI), r * Math.pow(2, -10 * n) * Math.sin(2 * (n - t) * Math.PI / i) + 1);
	    },
	    InOut: function(n) {
	      var t,
	          r = .1,
	          i = .4;
	      return 0 === n ? 0 : 1 === n ? 1 : (!r || 1 > r ? (r = 1, t = i / 4) : t = i * Math.asin(1 / r) / (2 * Math.PI), (n *= 2) < 1 ? -.5 * r * Math.pow(2, 10 * (n -= 1)) * Math.sin(2 * (n - t) * Math.PI / i) : r * Math.pow(2, -10 * (n -= 1)) * Math.sin(2 * (n - t) * Math.PI / i) * .5 + 1);
	    }
	  },
	  Back: {
	    In: function(n) {
	      var t = 1.70158;
	      return n * n * ((t + 1) * n - t);
	    },
	    Out: function(n) {
	      var t = 1.70158;
	      return --n * n * ((t + 1) * n + t) + 1;
	    },
	    InOut: function(n) {
	      var t = 2.5949095;
	      return (n *= 2) < 1 ? .5 * n * n * ((t + 1) * n - t) : .5 * ((n -= 2) * n * ((t + 1) * n + t) + 2);
	    }
	  },
	  Bounce: {
	    In: function(n) {
	      return 1 - TWEEN.Easing.Bounce.Out(1 - n);
	    },
	    Out: function(n) {
	      return 1 / 2.75 > n ? 7.5625 * n * n : 2 / 2.75 > n ? 7.5625 * (n -= 1.5 / 2.75) * n + .75 : 2.5 / 2.75 > n ? 7.5625 * (n -= 2.25 / 2.75) * n + .9375 : 7.5625 * (n -= 2.625 / 2.75) * n + .984375;
	    },
	    InOut: function(n) {
	      return .5 > n ? .5 * TWEEN.Easing.Bounce.In(2 * n) : .5 * TWEEN.Easing.Bounce.Out(2 * n - 1) + .5;
	    }
	  }
	}, TWEEN.Interpolation = {
	  Linear: function(n, t) {
	    var r = n.length - 1,
	        i = r * t,
	        u = Math.floor(i),
	        o = TWEEN.Interpolation.Utils.Linear;
	    return 0 > t ? o(n[0], n[1], i) : t > 1 ? o(n[r], n[r - 1], r - i) : o(n[u], n[u + 1 > r ? r : u + 1], i - u);
	  },
	  Bezier: function(n, t) {
	    var r,
	        i = 0,
	        u = n.length - 1,
	        o = Math.pow,
	        e = TWEEN.Interpolation.Utils.Bernstein;
	    for (r = 0; u >= r; r++)
	      i += o(1 - t, u - r) * o(t, r) * n[r] * e(u, r);
	    return i;
	  },
	  CatmullRom: function(n, t) {
	    var r = n.length - 1,
	        i = r * t,
	        u = Math.floor(i),
	        o = TWEEN.Interpolation.Utils.CatmullRom;
	    return n[0] === n[r] ? (0 > t && (u = Math.floor(i = r * (1 + t))), o(n[(u - 1 + r) % r], n[u], n[(u + 1) % r], n[(u + 2) % r], i - u)) : 0 > t ? n[0] - (o(n[0], n[0], n[1], n[1], -i) - n[0]) : t > 1 ? n[r] - (o(n[r], n[r], n[r - 1], n[r - 1], i - r) - n[r]) : o(n[u ? u - 1 : 0], n[u], n[u + 1 > r ? r : u + 1], n[u + 2 > r ? r : u + 2], i - u);
	  },
	  Utils: {
	    Linear: function(n, t, r) {
	      return (t - n) * r + n;
	    },
	    Bernstein: function(n, t) {
	      var r = TWEEN.Interpolation.Utils.Factorial;
	      return r(n) / r(t) / r(n - t);
	    },
	    Factorial: function() {
	      var n = [1];
	      return function(t) {
	        var r,
	            i = 1;
	        if (n[t])
	          return n[t];
	        for (r = t; r > 1; r--)
	          i *= r;
	        return n[t] = i;
	      };
	    }(),
	    CatmullRom: function(n, t, r, i, u) {
	      var o = .5 * (r - n),
	          e = .5 * (i - t),
	          a = u * u,
	          f = u * a;
	      return (2 * t - 2 * r + o + e) * f + (-3 * t + 3 * r - 2 * o - e) * a + o * u + t;
	    }
	  }
	}, "undefined" != typeof module && module.exports && (module.exports = TWEEN);


/***/ },
/* 44 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;;
	(function(global) {
	  "use strict";
	  function init(Kefir, $) {
	    $.fn.asKefirStream = function(eventName, selector, transformer) {
	      var $el = this;
	      if (transformer == null && selector != null && 'string' !== typeof selector) {
	        transformer = selector;
	        selector = null;
	      }
	      return Kefir.fromSubUnsub(function(handler) {
	        $el.on(eventName, selector, handler);
	      }, function(handler) {
	        $el.off(eventName, selector, handler);
	      }, transformer).setName('asKefirStream');
	    };
	    $.fn.asKefirProperty = function(eventName, selector, getter) {
	      if (getter == null) {
	        getter = selector;
	        selector = null;
	      }
	      return this.asKefirStream(eventName, selector, getter).toProperty(getter()).setName('asKefirProperty');
	    };
	  }
	  var exports = {init: init};
	  if (true) {
	    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function() {
	      return exports;
	    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	    global.KefirJQuery = exports;
	  } else if (typeof module === "object" && typeof exports === "object") {
	    module.exports = exports;
	  } else {
	    global.KefirJQuery = exports;
	  }
	}(this));


/***/ },
/* 45 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function() {
	  'use strict';
	  var _nextId = 0;
	  return function uniqueId(prefix) {
	    return ((prefix || "unique-id") + "-" + _nextId++);
	  };
	}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ },
/* 46 */
/***/ function(module, exports, __webpack_require__) {

	module.exports = function(module) {
	  if (!module.webpackPolyfill) {
	    module.deprecate = function() {};
	    module.paths = [];
	    module.children = [];
	    module.webpackPolyfill = 1;
	  }
	  return module;
	};


/***/ },
/* 47 */
/***/ function(module, exports, __webpack_require__) {

	(function webpackUniversalModuleDefinition(root, factory) {
	  if (true)
	    module.exports = factory(__webpack_require__(48));
	  else if (typeof define === 'function' && define.amd)
	    define(["js-graph"], factory);
	  else if (typeof exports === 'object')
	    exports["DeltaModel"] = factory(require("js-graph"));
	  else
	    root["DeltaModel"] = factory(root["JsGraph"]);
	})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {
	  return (function(modules) {
	    var installedModules = {};
	    function __webpack_require__(moduleId) {
	      if (installedModules[moduleId])
	        return installedModules[moduleId].exports;
	      var module = installedModules[moduleId] = {
	        exports: {},
	        id: moduleId,
	        loaded: false
	      };
	      modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
	      module.loaded = true;
	      return module.exports;
	    }
	    __webpack_require__.m = modules;
	    __webpack_require__.c = installedModules;
	    __webpack_require__.p = "";
	    return __webpack_require__(0);
	  })([function(module, exports, __webpack_require__) {
	    var __WEBPACK_AMD_DEFINE_ARRAY__,
	        __WEBPACK_AMD_DEFINE_RESULT__;
	    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1), __webpack_require__(2)], __WEBPACK_AMD_DEFINE_RESULT__ = function(JsGraph, U) {
	      'use strict';
	      var keepFirst = (function() {});
	      var keepSecond = (function(d1, p, d2) {
	        d1.operations[p] = d2;
	      });
	      var applySecondToFirstValue = (function(d1, p, d2) {
	        d2.applyTo(d1.operations[p], 'value');
	      });
	      function assertFunction(val, opType) {
	        U.assert(typeof val === 'function', ("The operation '" + opType + "' expects the property it acts on to be a function."));
	      }
	      function assertDefined(val, opType) {
	        U.assert(U.isDefined(val), ("The operation '" + opType + "' expects the property to be defined."));
	      }
	      function assertUndefined(val, opType) {
	        U.assert(U.isUndefined(val), ("The operation '" + opType + "' expects the property to be undefined."));
	      }
	      var DeltaModel = U.newClass(function() {
	        var $__0 = this;
	        var _opTypes = {};
	        var _composeFns = [];
	        U.extend(this, {
	          _addOperationType: function($__4) {
	            var $__5 = $__4,
	                name = $__5.name,
	                constructor = $__5.constructor,
	                applyTo = $__5.applyTo,
	                prototype = $__5.prototype,
	                method = $__5.method;
	            var objectWithMethod = {};
	            _opTypes[name] = {
	              name: name,
	              Delta: constructor,
	              method: objectWithMethod[name]
	            };
	            U.extend(_opTypes[name].Delta.prototype, prototype, {
	              constructor: constructor,
	              type: name,
	              applyTo: applyTo
	            });
	            _opTypes['modify'].Delta.prototype[name] = U.isDefined(method) ? method : function(property) {
	              for (var values = [],
	                  $__1 = 1; $__1 < arguments.length; $__1++)
	                values[$__1 - 1] = arguments[$__1];
	              this._addOperation(_opTypes[name], property, values);
	              return this;
	            };
	          },
	          _addOperationAlias: function($__4) {
	            var $__5 = $__4,
	                name = $__5.name,
	                target = $__5.target,
	                transform = $__5.transform;
	            var objectWithMethod = {};
	            Object.defineProperty(objectWithMethod, name, {value: function(property) {
	                for (var values = [],
	                    $__1 = 1; $__1 < arguments.length; $__1++)
	                  values[$__1 - 1] = arguments[$__1];
	                this._addOperation(_opTypes[target], property, transform(values));
	                return this;
	              }});
	            _opTypes[name] = {
	              name: name,
	              method: objectWithMethod[name]
	            };
	            _opTypes['modify'].Delta.prototype[name] = _opTypes[name].method;
	          },
	          _addCompositionRule: function(op1Type, op2Type, composeFn) {
	            _composeFns.push({
	              op1Type: op1Type,
	              op2Type: op2Type,
	              composeFn: composeFn
	            });
	          },
	          _newDelta: function(type) {
	            for (var values = [],
	                $__1 = 1; $__1 < arguments.length; $__1++)
	              values[$__1 - 1] = arguments[$__1];
	            return U.applyConstructor(_opTypes[type].Delta, values);
	          }
	        });
	        var thisDM = this;
	        this._addOperationType({
	          name: 'modify',
	          constructor: function Modify() {
	            var deltaDescription = arguments[0] !== (void 0) ? arguments[0] : {};
	            var operations = arguments[1] !== (void 0) ? arguments[1] : {};
	            var $__0 = this;
	            this.operations = operations;
	            Object.keys(deltaDescription).forEach((function(key) {
	              var match = key.match(/^(\w+)\s+([\w\.]+)$/);
	              if (match) {
	                var operation = match[1];
	                var property = match[2];
	                U.assert(operation in _opTypes, ("I don't know the '" + operation + "' operation."));
	                $__0[operation](property, deltaDescription[key]);
	              }
	            }));
	          },
	          applyTo: function(obj, property) {
	            var $__0 = this;
	            if (U.isDefined(property)) {
	              U.assert(U.isDefined(obj[property]), "The 'modify' operation expects the property to be already defined.");
	              Object.keys(this.operations).forEach((function(subProperty) {
	                $__0.operations[subProperty].applyTo(obj[property], subProperty);
	              }));
	            } else {
	              U.assert(U.isDefined(obj), "The 'modify' operation expects the property to be already defined.");
	              Object.keys(this.operations).forEach((function(subProperty) {
	                $__0.operations[subProperty].applyTo(obj, subProperty);
	              }));
	            }
	          },
	          prototype: {
	            selectivelyApplyTo: function(obj, subProperty) {
	              U.assert(U.isDefined(obj), "The 'modify' operation expects the property to be already defined.");
	              if (U.isDefined(this.operations[subProperty])) {
	                this.operations[subProperty].applyTo(obj, subProperty);
	              }
	            },
	            compose: function(property, op2) {
	              var $__0 = this;
	              if (U.isUndefined(op2)) {
	                return this;
	              }
	              var foundComposeFn;
	              _composeFns.some((function($__4) {
	                var $__5 = $__4,
	                    op1Type = $__5.op1Type,
	                    op2Type = $__5.op2Type,
	                    composeFn = $__5.composeFn;
	                if ($__0.operations[property].type === op1Type && op2.type === op2Type) {
	                  foundComposeFn = composeFn;
	                  return true;
	                }
	              }));
	              if (foundComposeFn) {
	                foundComposeFn(this, property, op2);
	              } else {
	                var err = new Error(("You cannot follow a '" + this.operations[property].type + "' operation ") + ("with a '" + op2.type + "' operation on the same property."));
	                err.op1 = this.operations[property].type;
	                err.op2 = op2.type;
	                throw err;
	              }
	            },
	            _addOperation: function(opType, property, values) {
	              var dotIndex = property.indexOf('.');
	              if (dotIndex !== -1) {
	                var actualProperty = property.slice(0, dotIndex);
	                var restOfProperty = property.slice(dotIndex + 1);
	                var newModifyDelta = this._addOperation(_opTypes['modify'], actualProperty);
	                return newModifyDelta[opType.name].apply(newModifyDelta, [restOfProperty].concat(values));
	              } else {
	                var _newDelta = thisDM._newDelta.apply(thisDM, [opType.name].concat(values));
	                if (this.operations.hasOwnProperty(property) && U.isDefined(this.operations[property])) {
	                  this.compose(property, _newDelta);
	                } else {
	                  this.operations[property] = _newDelta;
	                }
	                return this.operations[property];
	              }
	            }
	          },
	          method: function(property, deltaDescription) {
	            return this._addOperation(_opTypes['modify'], property, [deltaDescription]);
	          }
	        });
	        this._addOperationType({
	          name: 'add',
	          constructor: function Add(value) {
	            this.value = value;
	          },
	          applyTo: function(obj, property) {
	            assertUndefined(obj[property], 'add');
	            obj[property] = this.value;
	          }
	        });
	        this._addOperationType({
	          name: 'replace',
	          constructor: function Replace(value) {
	            this.value = value;
	          },
	          applyTo: function(obj, property) {
	            assertDefined(obj[property], 'replace');
	            obj[property] = this.value;
	          }
	        });
	        this._addOperationType({
	          name: 'replaceAround',
	          constructor: function ReplaceAround(value) {
	            this.value = value;
	          },
	          applyTo: function(obj, property) {
	            assertDefined(obj[property], 'replaceAround');
	            obj[property] = this.value(obj[property]);
	          }
	        });
	        this._addOperationType({
	          name: 'remove',
	          constructor: function Remove() {},
	          applyTo: function(obj, property) {
	            assertDefined(obj[property], 'remove');
	            delete obj[property];
	          }
	        });
	        this._addOperationType({
	          name: 'forbid',
	          constructor: function Forbid() {},
	          applyTo: function(obj, property) {
	            assertUndefined(obj[property], 'forbid');
	          }
	        });
	        this._addCompositionRule('add', 'replace', (function(d1, p, d2) {
	          d1.operations[p] = DeltaModel._newDelta('add', d2.value);
	        }));
	        this._addCompositionRule('add', 'modify', applySecondToFirstValue);
	        this._addCompositionRule('add', 'remove', (function(d1, p) {
	          d1.operations[p] = DeltaModel._newDelta('forbid');
	        }));
	        this._addCompositionRule('replace', 'replace', keepSecond);
	        this._addCompositionRule('replace', 'modify', applySecondToFirstValue);
	        this._addCompositionRule('replace', 'remove', keepSecond);
	        this._addCompositionRule('modify', 'replace', keepSecond);
	        this._addCompositionRule('modify', 'modify', (function(d1, p, d2) {
	          Object.keys(d2.operations).forEach((function(prop) {
	            d1.compose(prop, d2.operations[prop]);
	          }));
	        }));
	        this._addCompositionRule('modify', 'remove', keepSecond);
	        this._addCompositionRule('remove', 'add', (function(d1, p, d2) {
	          d1.operations[p] = DeltaModel._newDelta('replace', d2.value);
	        }));
	        this._addCompositionRule('remove', 'forbid', keepFirst);
	        this._addCompositionRule('forbid', 'add', keepSecond);
	        this._addCompositionRule('forbid', 'forbid', keepFirst);
	        this._addOperationType({
	          name: 'alter',
	          constructor: function Alter(value, alias) {
	            this.value = value || [];
	            this.alias = alias || 'alter';
	          },
	          applyTo: function(obj, property) {
	            assertFunction(obj[property], this.alias);
	            this.value.forEach((function(subOp) {
	              var partOne = obj[property];
	              var partTwo = subOp.value;
	              if (subOp.type === 'prepend') {
	                obj[property] = function() {
	                  for (var args = [],
	                      $__2 = 0; $__2 < arguments.length; $__2++)
	                    args[$__2] = arguments[$__2];
	                  partTwo.apply(this, args);
	                  partOne.apply(this, args);
	                };
	              } else {
	                obj[property] = function() {
	                  for (var args = [],
	                      $__3 = 0; $__3 < arguments.length; $__3++)
	                    args[$__3] = arguments[$__3];
	                  partOne.apply(this, args);
	                  partTwo.apply(this, args);
	                };
	              }
	            }));
	          }
	        });
	        this._addCompositionRule('alter', 'alter', (function(d1, p, d2) {
	          [].push.apply(d1.operations[p].value, d2.value);
	        }));
	        this._addCompositionRule('alter', 'replace', keepSecond);
	        this._addCompositionRule('alter', 'remove', (function(d1, p) {
	          d1.operations[p] = DeltaModel._newDelta('forbid');
	        }));
	        this._addCompositionRule('add', 'alter', (function(d1, p, d2) {
	          assertFunction(d1.operations[p].value, d2.alias);
	          applySecondToFirstValue(d1, p, d2);
	        }));
	        this._addCompositionRule('replace', 'alter', (function(d1, p, d2) {
	          assertFunction(d1.operations[p].value, d2.alias);
	          applySecondToFirstValue(d1, p, d2);
	        }));
	        ['prepend', 'insert', 'append'].forEach((function(opType) {
	          $__0._addOperationAlias({
	            name: opType,
	            target: 'alter',
	            transform: (function(args) {
	              return [[{
	                type: opType,
	                value: args[0]
	              }], opType];
	            })
	          });
	        }));
	        this._addOperationType({
	          name: 'after',
	          constructor: function After(value) {
	            U.assert(typeof resolvePromise === 'function', "Before creating an 'after' operation, you must register a promise resolver with delta.js.");
	            this.value = value;
	          },
	          applyTo: function(obj, property) {
	            assertFunction(obj[property], 'after');
	            var partOne = obj[property];
	            var partTwo = this.value;
	            obj[property] = function() {
	              for (var args = [],
	                  $__2 = 0; $__2 < arguments.length; $__2++)
	                args[$__2] = arguments[$__2];
	              return resolvePromise(partOne.apply(this, args)).then(function() {
	                return partTwo.apply(this, args);
	              }.bind(this));
	            };
	          }
	        });
	        this._addCompositionRule('after', 'replace', keepSecond);
	        this._addCompositionRule('after', 'remove', keepSecond);
	        this._addCompositionRule('add', 'after', (function(d1, p, d2) {
	          assertFunction(d1.operations[p].value, 'after');
	          applySecondToFirstValue(d1, p, d2);
	        }));
	        this._addCompositionRule('replace', 'after', (function(d1, p, d2) {
	          assertFunction(d1.operations[p].value, 'after');
	          applySecondToFirstValue(d1, p, d2);
	        }));
	        this._addCompositionRule('insert', 'after', applySecondToFirstValue);
	        this._addCompositionRule('after', 'insert', applySecondToFirstValue);
	        var _graph = new JsGraph();
	        U.extend(this, {graph: function() {
	            return _graph;
	          }});
	        var _deltaConditions = {};
	        var _settledDeltaConditions = {};
	        var _conditionsUnsettled = false;
	        function _registerDisjunct(deltaName, disjunct) {
	          _conditionsUnsettled = true;
	          if (disjunct === true) {
	            _settledDeltaConditions[deltaName] = true;
	          } else if (disjunct === false) {} else if (_deltaConditions[deltaName] !== true) {
	            U.array(_deltaConditions, deltaName).push(disjunct);
	          }
	        }
	        function _settleConditions() {
	          if (_conditionsUnsettled) {
	            _conditionsUnsettled = false;
	            var somethingChanged;
	            do {
	              somethingChanged = false;
	              _graph.eachVertex((function(deltaName) {
	                if (_settledDeltaConditions[deltaName]) {
	                  return;
	                }
	                if (U.isUndefined(_deltaConditions[deltaName])) {
	                  return;
	                }
	                if (_deltaConditions[deltaName].some((function(disjunct) {
	                  return disjunct.every((function(conjunct) {
	                    return _settledDeltaConditions[conjunct];
	                  }));
	                }))) {
	                  _settledDeltaConditions[deltaName] = true;
	                  somethingChanged = true;
	                }
	              }));
	            } while (somethingChanged);
	          }
	        }
	        this.Delta = U.newSubclass(_opTypes['modify'].Delta, function Delta(superFn, deltaName) {
	          var options = arguments[2] !== (void 0) ? arguments[2] : {};
	          superFn.call(this, options);
	          U.assert(options instanceof Object, "A delta should be given as an object.");
	          Object.defineProperties(this, {
	            name: {get: function() {
	                return deltaName;
	              }},
	            manuallySelectable: {get: function() {
	                if (U.isDefined(options['manuallySelectable'])) {
	                  return !!options['manuallySelectable'];
	                } else if (U.isDefined(options['resolves']) && options['resolves'].length > 0) {
	                  return false;
	                } else {
	                  return true;
	                }
	              }},
	            selected: {get: function() {
	                _settleConditions();
	                return !!_settledDeltaConditions[deltaName];
	              }},
	            if: {get: function() {
	                if (options['if'] === true || options['if'] === false) {
	                  return options['if'];
	                } else if (options['if'] || options['iff'] || options['resolves']) {
	                  return [].concat(options['if'] || [], options['iff'] || [], options['resolves'] || []);
	                } else {
	                  return false;
	                }
	              }},
	            onlyIf: {get: function() {
	                if (options['onlyIf'] === true || options['onlyIf'] === false) {
	                  return options['onlyIf'];
	                } else if (options['onlyIf'] || options['iff'] || options['expects'] || options['resolves']) {
	                  return [].concat(options['onlyIf'] || [], options['iff'] || [], options['expects'] || [], options['resolves'] || []);
	                } else {
	                  return true;
	                }
	              }},
	            appliedAfter: {get: function() {
	                return [].concat(options['appliedAfter'] || [], options['expects'] || [], options['resolves'] || [], options['requires'] || []);
	              }},
	            selects: {get: function() {
	                return [].concat(options['selects'] || [], options['requires'] || []);
	              }}
	          });
	          _conditionsUnsettled = true;
	          if (U.isDefined(this.if)) {
	            _registerDisjunct(deltaName, this.if);
	          }
	          this.selects.forEach((function(otherDeltaName) {
	            _registerDisjunct(otherDeltaName, [deltaName]);
	          }));
	          _graph.addVertex(deltaName, this);
	          this.appliedAfter.forEach((function(otherDeltaName) {
	            _graph.createEdge(otherDeltaName, deltaName);
	          }));
	          U.assert(!_graph.hasCycle(), ("The delta " + deltaName + " introduced a cycle in the application order."));
	        });
	        U.extend(this, {
	          select: function() {
	            for (var deltaNames = [],
	                $__2 = 0; $__2 < arguments.length; $__2++)
	              deltaNames[$__2] = arguments[$__2];
	            deltaNames.forEach((function(deltaName) {
	              _registerDisjunct(deltaName, true);
	            }));
	          },
	          vp: function(vpName, val) {
	            var obj = {};
	            obj[vpName] = val;
	            _settleConditions();
	            _graph.eachVertex((function(name, delta) {
	              U.assert(!delta.selected || delta.onlyIf === true || delta.onlyIf.every((function(d) {
	                return _graph.vertexValue(d).selected;
	              })), ("The 'onlyIf' condition of delta '" + delta.name + "' was violated."));
	            }));
	            _graph.topologically((function(name, delta) {
	              if (delta.selected) {
	                delta.selectivelyApplyTo(obj, vpName);
	              }
	            }));
	            return obj[vpName];
	          }
	        });
	      });
	      var resolvePromise = null;
	      U.extend(DeltaModel, {registerPromiseResolver: function(promiseResolverFn) {
	          resolvePromise = promiseResolverFn;
	        }});
	      return DeltaModel;
	    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	  }, function(module, exports, __webpack_require__) {
	    module.exports = __WEBPACK_EXTERNAL_MODULE_1__;
	  }, function(module, exports, __webpack_require__) {
	    var __WEBPACK_AMD_DEFINE_RESULT__;
	    !(__WEBPACK_AMD_DEFINE_RESULT__ = function() {
	      'use strict';
	      var U = {
	        newClass: function(constructor, prototype) {
	          prototype = prototype || {};
	          var cls = function() {
	            for (var args = [],
	                $__0 = 0; $__0 < arguments.length; $__0++)
	              args[$__0] = arguments[$__0];
	            constructor.apply(this, args);
	          };
	          cls.prototype = prototype;
	          cls.prototype.constructor = cls;
	          return cls;
	        },
	        newSubclass: function(superClass, constructor, prototype) {
	          prototype = prototype || {};
	          var cls = function() {
	            for (var args = [],
	                $__0 = 0; $__0 < arguments.length; $__0++)
	              args[$__0] = arguments[$__0];
	            constructor.apply(this, [superClass.prototype.constructor].concat(args));
	          };
	          cls.prototype = Object.create(superClass.prototype, prototype);
	          cls.prototype.constructor = cls;
	          return cls;
	        },
	        extend: function(obj1) {
	          for (var rest = [],
	              $__0 = 1; $__0 < arguments.length; $__0++)
	            rest[$__0 - 1] = arguments[$__0];
	          rest.forEach((function(obj) {
	            for (var key in obj) {
	              if (obj.hasOwnProperty(key)) {
	                obj1[key] = obj[key];
	              }
	            }
	          }));
	          return obj1;
	        },
	        array: function(obj, name) {
	          if (U.isUndefined(obj[name])) {
	            obj[name] = [];
	          }
	          return obj[name];
	        },
	        bindA: function(fn, ctx, args) {
	          return fn.bind.apply(fn, [ctx].concat(args));
	        },
	        bind: function(obj, m) {
	          for (var args = [],
	              $__1 = 2; $__1 < arguments.length; $__1++)
	            args[$__1 - 2] = arguments[$__1];
	          return U.bindA(obj[m], obj, args);
	        },
	        applyConstructor: function(ConstructorFn, args) {
	          var NewConstructorFn = ConstructorFn.bind.apply(ConstructorFn, [null].concat(args));
	          return new NewConstructorFn();
	        },
	        assert: function(condition, message) {
	          if (!condition) {
	            throw new Error(message || "Assertion failed");
	          }
	        },
	        isUndefined: function(val) {
	          return typeof val === 'undefined';
	        },
	        isDefined: function(val) {
	          return typeof val !== 'undefined';
	        }
	      };
	      return U;
	    }.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	  }]);
	});


/***/ },
/* 48 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;'use strict';
	(function(root, name, factory) {
	  if (true) {
	    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	  } else if (typeof exports === 'object') {
	    module.exports = factory();
	  } else {
	    root[name] = factory();
	  }
	}(this, 'JsGraph', function() {
	  function JsGraph() {
	    var that = this;
	    var _vertices = {};
	    var _edges = {};
	    var _reverseEdges = {};
	    var _vertexCount = 0;
	    var _edgeCount = 0;
	    var _addVertexCallbacks = new Callbacks();
	    var _removeVertexCallbacks = new Callbacks();
	    that.onAddVertex = _addVertexCallbacks.add;
	    that.onRemoveVertex = _removeVertexCallbacks.add;
	    that.addNewVertex = function(key, value) {
	      if (that.hasVertex(key)) {
	        throw new JsGraph.VertexExistsError(key, _vertices[key]);
	      }
	      _vertices[key] = value;
	      _edges[key] = {};
	      _reverseEdges[key] = {};
	      _vertexCount += 1;
	      _addVertexCallbacks.fire(key, value);
	    };
	    that.setVertex = function(key, value) {
	      if (!that.hasVertex(key)) {
	        throw new JsGraph.VertexNotExistsError(key);
	      }
	      _vertices[key] = value;
	    };
	    that.ensureVertex = function(key, value) {
	      if (!that.hasVertex(key)) {
	        that.addNewVertex(key, value);
	      }
	    };
	    that.addVertex = function(key, value) {
	      if (that.hasVertex(key)) {
	        that.setVertex(key, value);
	      } else {
	        that.addNewVertex(key, value);
	      }
	    };
	    that.removeExistingVertex = function(key) {
	      if (!that.hasVertex(key)) {
	        throw new JsGraph.VertexNotExistsError(key);
	      }
	      if (Object.keys(_edges[key]).length) {
	        throw new JsGraph.HasConnectedEdgesError(key);
	      }
	      if (Object.keys(_reverseEdges[key]).length) {
	        throw new JsGraph.HasConnectedEdgesError(key);
	      }
	      var valueOfRemovedVertex = _vertices[key];
	      delete _vertices[key];
	      _vertexCount -= 1;
	      _removeVertexCallbacks.fire(key, valueOfRemovedVertex);
	    };
	    that.destroyExistingVertex = function(key) {
	      if (!that.hasVertex(key)) {
	        throw new JsGraph.VertexNotExistsError(key);
	      }
	      that.eachVertexFrom(key, function(to) {
	        that.removeEdge(key, to);
	      });
	      that.eachVertexTo(key, function(from) {
	        that.removeEdge(from, key);
	      });
	      that.removeExistingVertex(key);
	    };
	    that.removeVertex = function(key) {
	      if (that.hasVertex(key)) {
	        that.removeExistingVertex(key);
	      }
	    };
	    that.destroyVertex = function(key) {
	      if (that.hasVertex(key)) {
	        that.destroyExistingVertex(key);
	      }
	    };
	    var _addEdgeCallbacks = new Callbacks();
	    var _removeEdgeCallbacks = new Callbacks();
	    that.onAddEdge = _addEdgeCallbacks.add;
	    that.onRemoveEdge = _removeEdgeCallbacks.add;
	    that.addNewEdge = function(from, to, value) {
	      if (that.hasEdge(from, to)) {
	        throw new JsGraph.EdgeExistsError(from, to, that.edgeValue(from, to));
	      }
	      if (!that.hasVertex(from)) {
	        if (that.hasVertex(to)) {
	          throw new JsGraph.VertexNotExistsError(from);
	        } else {
	          throw new JsGraph.VertexNotExistsError(from).v(to);
	        }
	      } else if (!that.hasVertex(to)) {
	        throw new JsGraph.VertexNotExistsError(to);
	      }
	      _edges[from][to] = value;
	      _reverseEdges[to][from] = null;
	      _edgeCount += 1;
	      _addEdgeCallbacks.fire(from, to, value);
	    };
	    that.createNewEdge = function(from, to, value) {
	      if (that.hasEdge(from, to)) {
	        throw new JsGraph.EdgeExistsError(from, to, that.edgeValue(from, to));
	      }
	      that.ensureVertex(from);
	      that.ensureVertex(to);
	      that.addNewEdge(from, to, value);
	    };
	    that.setEdge = function(from, to, value) {
	      if (!that.hasEdge(from, to)) {
	        throw new JsGraph.EdgeNotExistsError(from, to);
	      }
	      _edges[from][to] = value;
	    };
	    that.spanEdge = function(from, to, value) {
	      if (!that.hasVertex(from)) {
	        if (that.hasVertex(to)) {
	          throw new JsGraph.VertexNotExistsError(from);
	        } else {
	          throw new JsGraph.VertexNotExistsError(from).v(to);
	        }
	      } else if (!that.hasVertex(to)) {
	        throw new JsGraph.VertexNotExistsError(to);
	      }
	      if (!that.hasEdge(from, to)) {
	        that.addNewEdge(from, to, value);
	      }
	    };
	    that.addEdge = function(from, to, value) {
	      if (that.hasEdge(from, to)) {
	        that.setEdge(from, to, value);
	      } else {
	        that.addNewEdge(from, to, value);
	      }
	    };
	    that.ensureEdge = function(from, to, value) {
	      if (!that.hasEdge(from, to)) {
	        that.createNewEdge(from, to, value);
	      }
	    };
	    that.createEdge = function(from, to, value) {
	      if (that.hasEdge(from, to)) {
	        that.setEdge(from, to, value);
	      } else {
	        that.createNewEdge(from, to, value);
	      }
	    };
	    that.removeExistingEdge = function(from, to) {
	      if (!that.hasEdge(from, to)) {
	        throw new JsGraph.EdgeNotExistsError(from, to);
	      }
	      var valueOfRemovedEdge = _edges[from][to];
	      delete _edges[from][to];
	      delete _reverseEdges[to][from];
	      _edgeCount -= 1;
	      _removeEdgeCallbacks.fire(from, to, valueOfRemovedEdge);
	    };
	    that.removeEdge = function(from, to) {
	      if (that.hasEdge(from, to)) {
	        that.removeExistingEdge(from, to);
	      }
	    };
	    that.vertexCount = function() {
	      return _vertexCount;
	    };
	    that.hasVertex = function(key) {
	      return key in _vertices;
	    };
	    that.vertexValue = function(key) {
	      return _vertices[key];
	    };
	    that.edgeCount = function() {
	      return _edgeCount;
	    };
	    that.hasEdge = function(from, to) {
	      return that.hasVertex(from) && that.hasVertex(to) && from in _edges && to in _edges[from];
	    };
	    that.edgeValue = function(from, to) {
	      return that.hasEdge(from, to) ? _edges[from][to] : undefined;
	    };
	    that.successors = function(from) {
	      if (!that.hasVertex(from)) {
	        throw new JsGraph.VertexNotExistsError(from);
	      }
	      return Object.keys(_edges[from]);
	    };
	    that.predecessors = function(to) {
	      if (!that.hasVertex(to)) {
	        throw new JsGraph.VertexNotExistsError(to);
	      }
	      return Object.keys(_reverseEdges[to]);
	    };
	    that.eachVertex = function(handler) {
	      Object.keys(_vertices).every(function(key) {
	        var r = handler(key, _vertices[key]);
	        return (r !== false);
	      });
	    };
	    that.eachVertexFrom = function(from, handler) {
	      if (!that.hasVertex(from)) {
	        throw new JsGraph.VertexNotExistsError(from);
	      }
	      Object.keys(_edges[from]).every(function(to) {
	        var r = handler(to, that.vertexValue(to), that.edgeValue(from, to));
	        return (r !== false);
	      });
	    };
	    that.eachVertexTo = function(to, handler) {
	      if (!that.hasVertex(to)) {
	        throw new JsGraph.VertexNotExistsError(to);
	      }
	      Object.keys(_reverseEdges[to]).every(function(from) {
	        var r = handler(from, that.vertexValue(from), that.edgeValue(from, to));
	        return (r !== false);
	      });
	    };
	    that.eachEdge = function(handler) {
	      Object.keys(_edges).every(function(from) {
	        return Object.keys(_edges[from]).every(function(to) {
	          var r = handler(from, to, _edges[from][to]);
	          return (r !== false);
	        });
	      });
	    };
	    that.clearEdges = function() {
	      that.eachEdge(that.removeEdge);
	    };
	    that.clear = function() {
	      that.eachVertex(that.destroyVertex);
	    };
	    that.hasCycle = function() {
	      var visited = {};
	      var handled = {};
	      var cycleFound = false;
	      function visit(a) {
	        if (visited[a]) {
	          cycleFound = true;
	          return;
	        }
	        if (handled[a]) {
	          return;
	        }
	        handled[a] = true;
	        visited[a] = true;
	        that.eachVertexFrom(a, function(b) {
	          visit(b);
	          if (cycleFound) {
	            return false;
	          }
	        });
	        visited[a] = false;
	      }
	      that.eachVertex(function(a) {
	        visit(a);
	        if (cycleFound) {
	          return false;
	        }
	      });
	      return cycleFound;
	    };
	    that.hasPath = function(from, to) {
	      if (!that.hasVertex(from) || !that.hasVertex(to)) {
	        return false;
	      }
	      var visited = {};
	      function hasPathAux(current) {
	        if (that.hasEdge(current, to)) {
	          return true;
	        }
	        visited[current] = true;
	        var found = false;
	        that.eachVertexFrom(current, function(next) {
	          if (!found && !visited[next] && hasPathAux(next)) {
	            found = true;
	          }
	        });
	        delete visited[current];
	        return found;
	      }
	      return hasPathAux(from);
	    };
	    that.topologically = function(handler) {
	      var visited = [];
	      var handled = {};
	      function visit(a) {
	        visited.push(a);
	        var i = visited.indexOf(a);
	        if (i !== visited.length - 1) {
	          var cycle = visited.slice(i + 1).reverse();
	          throw new JsGraph.CycleError(cycle);
	        }
	        if (!handled[a]) {
	          that.eachVertexTo(a, visit);
	          handled[a] = {returned: handler(a, that.vertexValue(a))};
	        }
	        visited.pop();
	      }
	      that.eachVertex(function(a) {
	        if (!handled[a]) {
	          visit(a);
	        }
	      });
	    };
	    that.transitiveReduction = function() {
	      var result = new JsGraph();
	      that.eachVertex(function(key, val) {
	        result.addVertex(key, val);
	      });
	      that.eachEdge(function(from, to, val) {
	        result.addEdge(from, to, val);
	      });
	      result.eachVertex(function(x) {
	        result.eachVertex(function(y) {
	          if (result.hasEdge(x, y)) {
	            result.eachVertex(function(z) {
	              if (result.hasPath(y, z)) {
	                result.removeEdge(x, z);
	              }
	            });
	          }
	        });
	      });
	      return result;
	    };
	  }
	  function set2dObj(A, one, two, val) {
	    if (typeof A[one] === 'undefined') {
	      A[one] = {};
	    }
	    A[one][two] = val;
	  }
	  function Callbacks() {
	    var callbacks = [];
	    this.add = function(fn) {
	      if (callbacks.indexOf(fn) === -1) {
	        callbacks.push(fn);
	      }
	      return function removeCallback() {
	        var index = callbacks.indexOf(fn);
	        if (index !== -1) {
	          callbacks.splice(index, 1);
	        }
	      };
	    };
	    this.fire = function() {
	      var args = arguments;
	      callbacks.forEach(function(fn) {
	        fn.apply(null, args);
	      });
	    };
	  }
	  function newError(name, constructor) {
	    constructor.prototype.__proto__ = Error.prototype;
	    constructor.prototype.constructor = constructor;
	    constructor.prototype.name = name;
	    return constructor;
	  }
	  JsGraph.VertexExistsError = newError("VertexExistsError", function(key, value) {
	    var that = this;
	    function refreshMessage() {
	      that.message = "This graph has " + (that.vertices === 1 ? "a vertex" : "vertices") + " '" + Object.keys(that.vertices).join("', '") + "'";
	    }
	    that.v = function(key, value) {
	      that.vertices[key] = value;
	      refreshMessage();
	      return that;
	    };
	    that.vertices = {};
	    that.v(key, value);
	    refreshMessage();
	  });
	  JsGraph.VertexNotExistsError = newError("VertexNotExistError", function(key) {
	    var that = this;
	    function refreshMessage() {
	      that.message = "This graph does not have " + (that.vertices === 1 ? "a vertex" : "vertices") + " '" + Object.keys(that.vertices).join("', '") + "'";
	    }
	    that.v = function(key) {
	      that.vertices[key] = undefined;
	      refreshMessage();
	      return that;
	    };
	    that.vertices = {};
	    that.v(key);
	    refreshMessage();
	  });
	  JsGraph.EdgeExistsError = newError("EdgeExistsError", function(from, to, value) {
	    var that = this;
	    function refreshMessage() {
	      var edges = [];
	      Object.keys(that.edges).forEach(function(from) {
	        Object.keys(that.edges[from]).forEach(function(to) {
	          edges.push("('" + from + "', '" + to + "')");
	        });
	      });
	      that.message = "This graph has " + (edges.length === 1 ? "an edge " : "edges ") + edges.join(", ");
	    }
	    that.e = function(from, to, value) {
	      set2dObj(that.edges, from, to, value);
	      refreshMessage();
	      return that;
	    };
	    that.edges = {};
	    that.e(from, to, value);
	    refreshMessage();
	  });
	  JsGraph.EdgeNotExistsError = newError("EdgeNotExistError", function(from, to) {
	    var that = this;
	    function refreshMessage() {
	      var edges = [];
	      Object.keys(that.edges).forEach(function(from) {
	        Object.keys(that.edges[from]).forEach(function(to) {
	          edges.push("('" + from + "', '" + to + "')");
	        });
	      });
	      that.message = "This graph does not have " + (edges.length === 1 ? "an edge " : "edges ") + edges.join(", ");
	    }
	    that.e = function(from, to) {
	      set2dObj(that.edges, from, to, undefined);
	      refreshMessage();
	      return that;
	    };
	    that.edges = {};
	    that.e(from, to);
	    refreshMessage();
	  });
	  JsGraph.HasConnectedEdgesError = newError("HasConnectedEdgesError", function(key) {
	    this.message = "The '" + key + "' vertex has connected edges";
	    this.key = key;
	  });
	  JsGraph.CycleError = newError("CycleError", function(cycle) {
	    this.message = "This graph contains a cycle: " + cycle;
	    this.cycle = cycle;
	  });
	  return JsGraph;
	}));


/***/ }
/******/ ])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMjc5NTQ2MjU3NTY2YjNjNTcxZGQiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGUyL2V4YW1wbGUyLmpzIiwid2VicGFjazovLy8uL3NyYy9jaXJjdWl0Ym9hcmQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3AtY29yZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcC10aWxlLXNraW4uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3AtdGlsZS1zcGFjaW5nLmpzIiwid2VicGFjazovLy8uL3NyYy9wLXRpbGUtY2xpY2stdG8tb3Blbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcC10aWxlLXdlaWdodC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcC10aWxlLWFjdGl2ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcC10aWxlLW9wZW4uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3AtdGlsZS1ncm93LXdoZW4tb3Blbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcC10aWxlLW9wZW4tYWN0aXZlLmpzIiwid2VicGFjazovLy8uL3NyYy9wLXRpbGUtc2tpbi1ncm93LXdoZW4tb3Blbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcC1wb3NpdGlvbi10cmFja2luZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcC10cmFuc2l0aW9uLXBvc2l0aW9uLXRyYWNraW5nLmpzIiwid2VicGFjazovLy8uL2Jvd2VyX2NvbXBvbmVudHMvanF1ZXJ5L2Rpc3QvanF1ZXJ5LmpzP2ZkMDMiLCJ3ZWJwYWNrOi8vLy4vYm93ZXJfY29tcG9uZW50cy9qcXVlcnkvZGlzdC9qcXVlcnkuanMiLCJ3ZWJwYWNrOi8vLy4vfi9ibHVlYmlyZC9qcy9icm93c2VyL2JsdWViaXJkLmpzIiwid2VicGFjazovLy8uL3NyYy9leGFtcGxlMi9leGFtcGxlMi5zY3NzPzU2MGEiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V4YW1wbGUyL2V4YW1wbGUyLnNjc3MiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvbmV3V2lkZ2V0VHlwZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9wbHVnaW4uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvbWlzYy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9kZWZlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9uZXN0ZWQtZmxleC1ncm93LmpzIiwid2VicGFjazovLy8uL3NyYy9wLWNvcmUuc2Nzcz9lM2MwIiwid2VicGFjazovLy8uL3NyYy9wLWNvcmUuc2NzcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9rZWZpci1hbmQtZWdncy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9kZWZhdWx0cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9wdXQtY3NzLXJ1bGVzLmpzIiwid2VicGFjazovLy8uL3NyYy9wLXRpbGUtc2tpbi5zY3NzPzMwYWEiLCJ3ZWJwYWNrOi8vLy4vc3JjL3AtdGlsZS1za2luLnNjc3MiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvY29kZXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3AtdGlsZS1za2luLWdyb3ctd2hlbi1vcGVuLnNjc3M/N2I5MCIsIndlYnBhY2s6Ly8vLi9zcmMvcC10aWxlLXNraW4tZ3Jvdy13aGVuLW9wZW4uc2NzcyIsIndlYnBhY2s6Ly8vLi9+L3N0eWxlLWxvYWRlci9hZGRTdHlsZXMuanMiLCJ3ZWJwYWNrOi8vLy4vYm93ZXJfY29tcG9uZW50cy92ZWxvY2l0eS92ZWxvY2l0eS5taW4uanMiLCJ3ZWJwYWNrOi8vLy4vYm93ZXJfY29tcG9uZW50cy9jaHJvbWEtanMvY2hyb21hLmpzIiwid2VicGFjazovLy8uL34vY3NzLWxvYWRlci9jc3NUb1N0cmluZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvQXJ0ZWZhY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwva2VmaXItc2lnbmFsLWhhbmRsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvbWFpbi1kZWx0YS1tb2RlbC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL34vbm9kZS1saWJzLWJyb3dzZXIvfi9wcm9jZXNzL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vYm93ZXJfY29tcG9uZW50cy9rZWZpci9kaXN0L2tlZmlyLmpzIiwid2VicGFjazovLy8uL2Jvd2VyX2NvbXBvbmVudHMvdHdlZW5qcy9idWlsZC90d2Vlbi5taW4uanMiLCJ3ZWJwYWNrOi8vLy4vYm93ZXJfY29tcG9uZW50cy9rZWZpci1qcXVlcnkva2VmaXItanF1ZXJ5LmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL3VuaXF1ZS1pZC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovLy8uL2Jvd2VyX2NvbXBvbmVudHMvZGVsdGEuanMvZGlzdC9kZWx0YS5qcyIsIndlYnBhY2s6Ly8vLi9ib3dlcl9jb21wb25lbnRzL2pzLWdyYXBoL2Rpc3QvanMtZ3JhcGguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0Esd0M7Ozs7Ozs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFVLFNBQVMsTUFBTTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7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QUFDTCxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0wsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0EsTUFBSztBQUNMLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBLE1BQUs7QUFDTCxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0wsSUFBRztBQUNIO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMLElBQUc7QUFDSCxFQUFDOzs7Ozs7O2lFQzFIRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNILDBEQUF5RDtBQUN6RCxFQUFDOzs7Ozs7O0FDUEQsMkc7Ozs7Ozs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVSxZQUFZO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTCx3QkFBdUI7QUFDdkI7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWdCLFlBQVk7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLGlCQUFnQixZQUFZO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBWSxTQUFTO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQVksWUFBWTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFjLFlBQVk7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBLHFCQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWdCLFNBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0Esd0JBQXVCLElBQUk7QUFDM0I7QUFDQTtBQUNBO0FBQ0EsK0NBQThDLElBQUk7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTCxlQUFjO0FBQ2Q7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWU7QUFDZjtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWEsb0JBQW9CO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsVUFBUztBQUNULHVDQUFzQyxNQUFNO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQW9CO0FBQ3BCLGVBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxlQUFjLGtCQUFrQjtBQUNoQztBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1QsZUFBYztBQUNkLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1gsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZSxvRUFBb0U7QUFDbkY7QUFDQSxnQkFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLDREQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQSx1Q0FBc0MsTUFBTTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLGlCQUFnQixZQUFZO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsaUJBQWdCLFlBQVk7QUFDNUI7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxpQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLGlCQUFnQixjQUFjO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBWSxTQUFTO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsZ0VBQStEO0FBQy9EO0FBQ0E7QUFDQSxnQkFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBWSxTQUFTO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBWSxTQUFTO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWCxhQUFZLFNBQVM7QUFDckI7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxtQkFBa0IsU0FBUztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFIQUFvSCw2Q0FBNkM7QUFDaks7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQWtCLHdDQUF3QztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBcUIsU0FBUztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBLGtCQUFpQixTQUFTO0FBQzFCO0FBQ0E7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Q0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFjLFNBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBeUMsTUFBTTtBQUMvQztBQUNBLFNBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBc0M7QUFDdEM7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSx5RUFBd0U7QUFDeEUsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBc0IsU0FBUztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1AsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSx1RUFBc0U7QUFDdEU7QUFDQSxVQUFTLEVBQUU7QUFDWDtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1AsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxlQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBYyxLQUFLO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQXlEO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFrRTtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFjLGNBQWM7QUFDNUI7QUFDQTtBQUNBLHdCQUF1QixtQkFBbUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBLGlCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBLGNBQWEsZUFBZTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1Asc0JBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCxNQUFLO0FBQ0w7QUFDQTtBQUNB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Q0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMLGlCQUFnQixPQUFPO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSCxlQUFjO0FBQ2Q7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLE1BQUs7QUFDTCxpQkFBZ0IsV0FBVztBQUMzQjtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0Esa0NBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZUFBYyxTQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZUFBYyxTQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFZLE9BQU87QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0EscUJBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQLE9BQU07QUFDTixrQkFBaUI7QUFDakIsZ0JBQWU7QUFDZjtBQUNBO0FBQ0EsV0FBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWdCLFNBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTTtBQUNOO0FBQ0EsOEJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFxQjtBQUNyQixzQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0tBQStKO0FBQy9KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBTztBQUNQLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxRQUFPO0FBQ1AsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLHdCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFpQjtBQUNqQjtBQUNBLGtCQUFpQjtBQUNqQixnSUFBK0gsdUJBQXVCO0FBQ3RKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBLGVBQWMsb0dBQW9HO0FBQ2xILGdCQUFlLDhCQUE4QjtBQUM3QyxrQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0wsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBLE1BQUs7QUFDTCxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDOzs7Ozs7O0FDOXhMRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFtQixjQUFjO0FBQ2pDO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLLElBQUk7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1gsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYixZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYixZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSyxJQUFJO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLLEdBQUcsbUJBQW1CO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBeUIsa0JBQWtCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFlO0FBQ2YsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUF5Qiw0QkFBNEI7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBeUIsMkJBQTJCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLHlFQUF3RTtBQUN4RTtBQUNBLGdCQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFtQjtBQUNuQixrQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTJDLFNBQVM7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUssSUFBSTtBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUEyQixTQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsZ0JBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQXlCLFNBQVM7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW1CLEtBQUs7QUFDeEIsb0JBQW1CLEtBQUs7QUFDeEIsb0JBQW1CLEtBQUs7QUFDeEI7QUFDQSxnQ0FBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUssSUFBSTtBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtB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MkJBQTJCLDJDQUEyQyw0QkFBNEIsUTs7Ozs7O0FDRHpvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQLE1BQUs7QUFDTCxJQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1QsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1AsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1AsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQLE1BQUs7QUFDTDtBQUNBLGtFQUFpRTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXVCLE9BQU87QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXVCLE9BQU87QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUFzQixxQkFBcUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBcUIsT0FBTztBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF1QixPQUFPO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQTZCLE9BQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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O0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWCxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JB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QzdDO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBLE1BQUs7QUFDTCxJQUFHO0FBQ0gsRUFBQzs7Ozs7OztpRUNodUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBMkMsV0FBVztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUFzQixTQUFTO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBLHVCQUFzQixTQUFTO0FBQy9CO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSx1QkFBc0IsU0FBUztBQUMvQjtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSx1QkFBc0IsU0FBUztBQUMvQjtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBbUMsRUFBRSxhQUFhLEVBQUU7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBbUMsRUFBRTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBc0IsU0FBUztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0EsVUFBUztBQUNUO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFtRCx3Q0FBd0M7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQSxzREFBcUQsd0NBQXdDO0FBQzdGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQSxtREFBa0QscUNBQXFDO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBd0MsMkNBQTJDO0FBQ25GO0FBQ0E7QUFDQSx1Q0FBc0MsMkNBQTJDO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXdDLDJDQUEyQztBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsNERBQTJELGNBQWM7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXFDLFdBQVc7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF3QyxXQUFXO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEwQyxXQUFXO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTBCLFNBQVM7QUFDbkM7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEwQyxXQUFXO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZSxZQUFZO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZSxZQUFZO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQThCO0FBQzlCLDJCQUEwQjtBQUMxQiw2QkFBNEI7QUFDNUI7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUssZUFBZTtBQUNwQjtBQUNBLCtCQUE4QjtBQUM5QiwyQkFBMEI7QUFDMUI7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsTUFBSyxhQUFhO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBK0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBOEI7QUFDOUIsMkJBQTBCO0FBQzFCO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUCxzREFBcUQ7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLLGFBQWE7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBK0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0Esc0JBQXFCLGtCQUFrQjtBQUN2QztBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFnQztBQUNoQyxtQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBK0IsZ0JBQWdCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1AsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWlCLG9CQUFvQjtBQUNyQztBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esa0JBQWlCLG9CQUFvQjtBQUNyQztBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0wsNEJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSCxvQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF3QyxlQUFlO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBeUMsZ0JBQWdCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsbUNBQWtDLGFBQWE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7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O0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUErQixrQkFBa0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFvQyx1QkFBdUI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW1CLDBCQUEwQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSCxrQ0FBaUM7QUFDakM7QUFDQSxPQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0EsRUFBQzs7Ozs7OztBQ3htRUQ7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhLQUE2SyxjQUFjO0FBQzNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQSxhQUFZO0FBQ1osYUFBWTtBQUNaLGFBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBLElBQUc7QUFDSDtBQUNBLHNCQUFxQixPQUFPO0FBQzVCO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBdUIsT0FBTztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNELFlBQVc7QUFDWDtBQUNBLE9BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1QsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1QsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNULFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0EsRUFBQyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDI3OTU0NjI1NzU2NmIzYzU3MWRkXG4gKiovIiwicmVxdWlyZSgnLi9leGFtcGxlMi5zY3NzJyk7XG52YXIgJCA9IHJlcXVpcmUoJ2V4cG9zZT9qUXVlcnkhanF1ZXJ5Jyk7XG52YXIgUCA9IHJlcXVpcmUoJ2JsdWViaXJkJyk7XG52YXIgY2lyY3VpdGJvYXJkID0gcmVxdWlyZSgnLi4vY2lyY3VpdGJvYXJkLmpzJyk7XG5yZXF1aXJlKCcuLi9wLWNvcmUuanMnKTtcbnJlcXVpcmUoJy4uL3AtdGlsZS1za2luLmpzJyk7XG5yZXF1aXJlKCcuLi9wLXRpbGUtc3BhY2luZy5qcycpO1xucmVxdWlyZSgnLi4vcC10aWxlLWNsaWNrLXRvLW9wZW4uanMnKTtcbnJlcXVpcmUoJy4uL3AtdGlsZS13ZWlnaHQuanMnKTtcbnJlcXVpcmUoJy4uL3AtdGlsZS1hY3RpdmUuanMnKTtcbnJlcXVpcmUoJy4uL3AtdGlsZS1vcGVuLmpzJyk7XG5yZXF1aXJlKCcuLi9wLXRpbGUtZ3Jvdy13aGVuLW9wZW4uanMnKTtcbnJlcXVpcmUoJy4uL3AtdGlsZS1vcGVuLWFjdGl2ZS5qcycpO1xucmVxdWlyZSgnLi4vcC10aWxlLXNraW4tZ3Jvdy13aGVuLW9wZW4uanMnKTtcbnJlcXVpcmUoJy4uL3AtcG9zaXRpb24tdHJhY2tpbmcuanMnKTtcbnJlcXVpcmUoJy4uL3AtdHJhbnNpdGlvbi1wb3NpdGlvbi10cmFja2luZy5qcycpO1xuY2lyY3VpdGJvYXJkLnBsdWdpbihbJ3RpbGUtc2tpbicsICd0aWxlLWNsaWNrLXRvLW9wZW4nLCAndGlsZS1ncm93LXdoZW4tb3BlbicsICd0aWxlLXNwYWNpbmcnLCAndGlsZS1hY3RpdmUnXSk7XG52YXIgbW9kZWxQcm90b3R5cGUgPSB7XG4gIGdldCBpZCgpIHtcbiAgICByZXR1cm4gdGhpcy5uYW1lO1xuICB9LFxuICBnZXRDaGlsZElkczogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4gfHwgW107XG4gIH0sXG4gIGdldE1vZGVsczogZnVuY3Rpb24oaWRzKSB7XG4gICAgcmV0dXJuIGdldE1vZGVsc0J5SWRzKGlkcyk7XG4gIH1cbn07XG5mdW5jdGlvbiBiZ0NvbG9yKGNvbG9yKSB7XG4gIHJldHVybiB7bm9ybWFsOiB7Y3NzOiB7JyYnOiB7XG4gICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBjb2xvcixcbiAgICAgICAgICBib3JkZXJDb2xvcjogJ2JsYWNrJ1xuICAgICAgICB9fX19O1xufVxudmFyIG1vZGVscyA9IHtcbiAgcm9vdDoge1xuICAgIG5hbWU6ICdyb290JyxcbiAgICBjaGlsZHJlbjogWydBJywgJ0InLCAnQycsICdEJywgJ0UnXVxuICB9LFxuICBBOiB7XG4gICAgbmFtZTogJ0EnLFxuICAgIGNoaWxkcmVuOiBbJ0ExJywgJ0EyJywgJ0EzJ10sXG4gICAgdGlsZTogYmdDb2xvcignbGlnaHRibHVlJylcbiAgfSxcbiAgQjoge1xuICAgIG5hbWU6ICdCJyxcbiAgICBjaGlsZHJlbjogWydCMScsICdCMicsICdCMyddLFxuICAgIHRpbGU6IGJnQ29sb3IoJ2xpZ2h0Z3JlZW4nKVxuICB9LFxuICBDOiB7XG4gICAgbmFtZTogJ0MnLFxuICAgIGNoaWxkcmVuOiBbJ0MxJywgJ0MyJywgJ0MzJ11cbiAgfSxcbiAgRDoge1xuICAgIG5hbWU6ICdEJyxcbiAgICBjaGlsZHJlbjogWydEMScsICdEMicsICdEMyddXG4gIH0sXG4gIEU6IHtcbiAgICBuYW1lOiAnRScsXG4gICAgY2hpbGRyZW46IFsnRTEnLCAnRTInLCAnRTMnXVxuICB9LFxuICBBMToge1xuICAgIG5hbWU6ICdBMScsXG4gICAgdGlsZTogYmdDb2xvcignb3JhbmdlJylcbiAgfSxcbiAgQTI6IHtuYW1lOiAnQTInfSxcbiAgQTM6IHtuYW1lOiAnQTMnfSxcbiAgQjE6IHtuYW1lOiAnQjEnfSxcbiAgQjI6IHtuYW1lOiAnQjInfSxcbiAgQjM6IHtuYW1lOiAnQjMnfSxcbiAgQzE6IHtuYW1lOiAnQzEnfSxcbiAgQzI6IHtuYW1lOiAnQzInfSxcbiAgQzM6IHtuYW1lOiAnQzMnfSxcbiAgRDE6IHtuYW1lOiAnRDEnfSxcbiAgRDI6IHtuYW1lOiAnRDInfSxcbiAgRDM6IHtuYW1lOiAnRDMnfSxcbiAgRTE6IHtuYW1lOiAnRTEnfSxcbiAgRTI6IHtuYW1lOiAnRTInfSxcbiAgRTM6IHtuYW1lOiAnRTMnfVxufTtcbmZ1bmN0aW9uIGdldE1vZGVsc0J5SWRzKGlkcykge1xuICB2YXIgcmVzdWx0ID0gW107XG4gIGlkcy5mb3JFYWNoKGZ1bmN0aW9uKGlkKSB7XG4gICAgdmFyIG1vZGVsID0gT2JqZWN0LmNyZWF0ZShtb2RlbFByb3RvdHlwZSk7XG4gICAgT2JqZWN0LmtleXMobW9kZWxzW2lkXSkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgIG1vZGVsW2tleV0gPSBtb2RlbHNbaWRdW2tleV07XG4gICAgfSk7XG4gICAgcmVzdWx0LnB1c2goUC5yZXNvbHZlKG1vZGVsKSk7XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufVxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICQoJyNjaXJjdWl0Ym9hcmQnKS5jaXJjdWl0Ym9hcmQoe1xuICAgIG1vZGVsOiBnZXRNb2RlbHNCeUlkcyhbJ3Jvb3QnXSlbMF0sXG4gICAgdGlsZVNwYWNpbmc6IDQsXG4gICAgdGlsZW1hcE1hcmdpbjogNFxuICB9KS5jaXJjdWl0Ym9hcmQoJ2luc3RhbmNlJykudGhlbihmdW5jdGlvbihjaXJjdWl0Ym9hcmQpIHtcbiAgICBjb25zb2xlLmluZm8oJ2NpcmN1aXRib2FyZCBsb2FkZWQnKTtcbiAgfSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvZXhhbXBsZTIvZXhhbXBsZTIuanNcbiAqKiBtb2R1bGUgaWQgPSAwXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJkZWZpbmUoWydqcXVlcnknLCAnYmx1ZWJpcmQnLCAnLi91dGlsL25ld1dpZGdldFR5cGUuanMnLCAnLi91dGlsL3BsdWdpbi5qcyddLCBmdW5jdGlvbigkLCBQLCBuZXdXaWRnZXRUeXBlLCBwbHVnaW4pIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICAkLmNpcmN1aXRib2FyZCA9IHtwbHVnaW46IHBsdWdpbn07XG4gIHZhciBDaXJjdWl0Ym9hcmRQID0gbmV3V2lkZ2V0VHlwZSgnQ2lyY3VpdGJvYXJkJywge1xuICAgIGNzc0NsYXNzOiBcImNpcmN1aXRib2FyZFwiLFxuICAgIGZpbHRlcjogKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFAucmVzb2x2ZSh0cnVlKTtcbiAgICB9KVxuICB9KTtcbiAgdmFyIFRpbGVtYXBQID0gbmV3V2lkZ2V0VHlwZSgnVGlsZW1hcCcsIHtjc3NDbGFzczogXCJ0aWxlbWFwXCJ9KTtcbiAgdmFyIFRpbGVQID0gbmV3V2lkZ2V0VHlwZSgnVGlsZScsIHtjc3NDbGFzczogXCJ0aWxlXCJ9KTtcbiAgQ2lyY3VpdGJvYXJkUC50aGVuKChmdW5jdGlvbihjKSB7XG4gICAgJC5jaXJjdWl0Ym9hcmQuQ2lyY3VpdGJvYXJkID0gYztcbiAgfSkpO1xuICBUaWxlbWFwUC50aGVuKChmdW5jdGlvbihjKSB7XG4gICAgJC5jaXJjdWl0Ym9hcmQuVGlsZW1hcCA9IGM7XG4gIH0pKTtcbiAgVGlsZVAudGhlbigoZnVuY3Rpb24oYykge1xuICAgICQuY2lyY3VpdGJvYXJkLlRpbGUgPSBjO1xuICB9KSk7XG4gIHJldHVybiAkLmNpcmN1aXRib2FyZDtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9jaXJjdWl0Ym9hcmQuanNcbiAqKiBtb2R1bGUgaWQgPSAxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJkZWZpbmUoWydqcXVlcnknLCAnYmx1ZWJpcmQnLCAnLi91dGlsL21pc2MuanMnLCAnLi91dGlsL2RlZmVyLmpzJywgJy4vdXRpbC9uZXN0ZWQtZmxleC1ncm93LmpzJywgJy4vcC1jb3JlLnNjc3MnXSwgZnVuY3Rpb24oJCwgUCwgVSwgZGVmZXIpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgcGx1Z2luID0gJC5jaXJjdWl0Ym9hcmQucGx1Z2luKHtcbiAgICBuYW1lOiAnY29yZScsXG4gICAgaWY6IHRydWVcbiAgfSk7XG4gIHBsdWdpbi5tb2RpZnkoJ0NpcmN1aXRib2FyZC5wcm90b3R5cGUnKS5hZGQoJ19yZWdpc3RlclRpbGUnLCBmdW5jdGlvbiBfcmVnaXN0ZXJUaWxlKHRpbGUpIHtcbiAgICBVLmdldERlZih0aGlzLl9wX2NpcmN1aXRib2FyZENvcmVfdGlsZXNCeU1vZGVsSWQsIHRpbGUubW9kZWwuaWQsIGRlZmVyKS5yZXNvbHZlKHRpbGUpO1xuICB9KS5hZGQoJ2FsbFRpbGVzJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIHZhciB0aWxlcyA9IHt9O1xuICAgIE9iamVjdC5rZXlzKHRoaXMuX3BfY2lyY3VpdGJvYXJkQ29yZV90aWxlc0J5TW9kZWxJZCkuZm9yRWFjaCgoZnVuY3Rpb24oaWQpIHtcbiAgICAgIHRpbGVzW2lkXSA9ICRfXzAuX3BfY2lyY3VpdGJvYXJkQ29yZV90aWxlc0J5TW9kZWxJZFtpZF0ucHJvbWlzZTtcbiAgICB9KSk7XG4gICAgcmV0dXJuIHRpbGVzO1xuICB9KS5hZGQoJ3RpbGUnLCBmdW5jdGlvbih0aWxlU2VsZWN0b3IpIHtcbiAgICByZXR1cm4gVS5nZXREZWYodGhpcy5fcF9jaXJjdWl0Ym9hcmRDb3JlX3RpbGVzQnlNb2RlbElkLCB0aWxlU2VsZWN0b3IsIGRlZmVyKS5wcm9taXNlO1xuICB9KS5hZGQoJ2NvbnN0cnVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX3BfY2lyY3VpdGJvYXJkQ29yZV90aWxlc0J5TW9kZWxJZCA9IHt9O1xuICAgICQoJzxkaXYvPicpLmFwcGVuZFRvKHRoaXMuZWxlbWVudCkuY3NzKCdmbGV4LWdyb3cnLCAxKS50aWxlbWFwKHtcbiAgICAgIG1vZGVsOiB0aGlzLm9wdGlvbnMubW9kZWwsXG4gICAgICBwYXJlbnQ6IHRoaXNcbiAgICB9KS50aWxlbWFwKCdpbnN0YW5jZScpO1xuICB9KTtcbiAgcGx1Z2luLm1vZGlmeSgnVGlsZW1hcC5wcm90b3R5cGUnKS5hZGQoJ3JlZnJlc2hUaWxlcycsIGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18wID0gdGhpcztcbiAgICBVLmFzc2VydChVLmlzRGVmaW5lZCh0aGlzLm1vZGVsKSwgXCJBbiBBcGlOQVRPTVkgdGlsZW1hcCBzaG91bGQgaGF2ZSBhIG1vZGVsLlwiKTtcbiAgICByZXR1cm4gUC5yZXNvbHZlKHRoaXMubW9kZWwpLmNhbGwoJ2dldENoaWxkSWRzJykubWFwKChmdW5jdGlvbihpZCkge1xuICAgICAgcmV0dXJuIFAucmVzb2x2ZSgkX18wLmNpcmN1aXRib2FyZC5vcHRpb25zLmZpbHRlcihpZCwgVS5iaW5kKFAucmVzb2x2ZSgkX18wLm1vZGVsKS52YWx1ZSgpLCAnZ2V0TW9kZWxzJywgaWQpKSkudGhlbigoZnVuY3Rpb24oc2hvdykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICBzaG93OiBzaG93XG4gICAgICAgIH07XG4gICAgICB9KSk7XG4gICAgfSkpLmZpbHRlcihVLmZpZWxkKCdzaG93JykpLm1hcChVLmZpZWxkKCdpZCcpKS50aGVuKChmdW5jdGlvbihpZHMpIHtcbiAgICAgIHJldHVybiBQLnJlc29sdmUoJF9fMC5tb2RlbCkudmFsdWUoKS5nZXRNb2RlbHMoaWRzKTtcbiAgICB9KSkudGhlbigoZnVuY3Rpb24oY2hpbGRyZW5Ub0Rpc3BsYXkpIHtcbiAgICAgICRfXzAuZWxlbWVudC5jaGlsZHJlbigpLmVtcHR5KCk7XG4gICAgICAkX18wLmVsZW1lbnQuZW1wdHkoKTtcbiAgICAgICRfXzAuX3BfdGlsZW1hcENvcmVfdGlsZXMgPSBbXTtcbiAgICAgIHZhciByb3dDb3VudCA9IE1hdGguZmxvb3IoTWF0aC5zcXJ0KGNoaWxkcmVuVG9EaXNwbGF5Lmxlbmd0aCkpO1xuICAgICAgdmFyIGNvbENvdW50ID0gTWF0aC5jZWlsKGNoaWxkcmVuVG9EaXNwbGF5Lmxlbmd0aCAvIHJvd0NvdW50KTtcbiAgICAgIHdoaWxlIChyb3dDb3VudC0tKSB7XG4gICAgICAgIHZhciByb3cgPSAkKCc8ZGl2Lz4nKS5hZGRDbGFzcygndGlsZXJvdycpLmFwcGVuZFRvKCRfXzAuZWxlbWVudCk7XG4gICAgICAgIGZvciAodmFyIGNvbHVtbiA9IDA7IGNvbHVtbiA8IGNvbENvdW50ICYmIGNoaWxkcmVuVG9EaXNwbGF5Lmxlbmd0aCA+IDA7IGNvbHVtbiArPSAxKSB7XG4gICAgICAgICAgJCgnPGRpdi8+JykudGlsZSh7XG4gICAgICAgICAgICBtb2RlbDogY2hpbGRyZW5Ub0Rpc3BsYXkuc2hpZnQoKSxcbiAgICAgICAgICAgIHBhcmVudDogJF9fMFxuICAgICAgICAgIH0pLmFwcGVuZFRvKHJvdykuYW15TmVzdGVkRmxleEdyb3coMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSkudGhlbigoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLnRyaWdnZXIoJ3RpbGVzLXJlZnJlc2hlZCcpO1xuICAgIH0pKTtcbiAgfSkuYWRkKCdjb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMCA9IHRoaXM7XG4gICAgdGhpcy5uZXdFdmVudCgndGlsZXMtcmVmcmVzaGVkJyk7XG4gICAgdGhpcy5fcF90aWxlbWFwQ29yZV90aWxlcyA9IG51bGw7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICd0aWxlcycsIHtnZXQ6IChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRfXzAuX3BfdGlsZW1hcENvcmVfdGlsZXM7XG4gICAgICB9KX0pO1xuICAgIHRoaXMucmVmcmVzaFRpbGVzKCk7XG4gIH0pO1xuICBwbHVnaW4ubW9kaWZ5KCdUaWxlLnByb3RvdHlwZScpLmFkZCgncG9wdWxhdGVJbm5lclRpbGVtYXAnLCBmdW5jdGlvbiBwb3B1bGF0ZUlubmVyVGlsZW1hcCgpIHtcbiAgICBpZiAoIXRoaXMuX3BfdGlsZUNvcmVfdGlsZW1hcCkge1xuICAgICAgdGhpcy5fcF90aWxlQ29yZV90aWxlbWFwID0gdGhpcy5kb20udGlsZW1hcCh7XG4gICAgICAgIG1vZGVsOiB0aGlzLm9wdGlvbnMubW9kZWwsXG4gICAgICAgIHBhcmVudDogdGhpc1xuICAgICAgfSkudGlsZW1hcCgnaW5zdGFuY2UnKTtcbiAgICB9XG4gIH0pLmFkZCgnY29uc3RydWN0JywgZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIHRoaXMuX3BfdGlsZUNvcmVfdGlsZW1hcCA9IG51bGw7XG4gICAgWydtb3VzZW92ZXInLCAnbW91c2VvdXQnLCAnbW91c2VlbnRlcicsICdtb3VzZWxlYXZlJ10uZm9yRWFjaCgoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICRfXzAubmV3RXZlbnQoZXZlbnQsIHtzb3VyY2U6ICRfXzAuZWxlbWVudC5hc0tlZmlyU3RyZWFtKGV2ZW50KX0pO1xuICAgIH0pKTtcbiAgICB0aGlzLm5ld0V2ZW50KCdjbGljaycsIHtzb3VyY2U6IHRoaXMuZWxlbWVudC5tb3VzZUNsaWNrKHt0aHJlc2hvbGQ6IHRoaXMuY2lyY3VpdGJvYXJkLm9wdGlvbnMuZHJhZ1RocmVzaG9sZH0pfSk7XG4gICAgdGhpcy5kb20gPSB0aGlzLmVsZW1lbnQ7XG4gICAgdGhpcy5lbGVtZW50LmF0dHIoJ2lkJywgdGhpcy5pZCk7XG4gICAgdGhpcy5jaXJjdWl0Ym9hcmQuX3JlZ2lzdGVyVGlsZSh0aGlzKTtcbiAgfSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC1jb3JlLmpzXG4gKiogbW9kdWxlIGlkID0gMlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZGVmaW5lKFsnanF1ZXJ5JywgJ2Nocm9tYS1qcycsICcuL3V0aWwvbWlzYy5qcycsICcuL3V0aWwva2VmaXItYW5kLWVnZ3MuanMnLCAnLi91dGlsL2RlZmF1bHRzLmpzJywgJy4vdXRpbC9wdXQtY3NzLXJ1bGVzLmpzJywgJy4vcC10aWxlLXNraW4uc2NzcyddLCBmdW5jdGlvbigkLCBjb2xvciwgVSwgS2VmaXIsIGRlZmF1bHRzKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyIHBsdWdpbiA9ICQuY2lyY3VpdGJvYXJkLnBsdWdpbih7XG4gICAgbmFtZTogJ3RpbGUtc2tpbicsXG4gICAgcmVxdWlyZXM6IFsndGlsZS1vcGVuJywgJ3Bvc2l0aW9uLXRyYWNraW5nJ11cbiAgfSkubW9kaWZ5KCdUaWxlLnByb3RvdHlwZScpO1xuICB2YXIgYXBwbHlTdHlsZURlZmF1bHRzID0gZGVmYXVsdHMoe1xuICAgICcmJzoge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiBcIiAnd2hpdGUnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiLFxuICAgICAgYm9yZGVyQ29sb3I6IFwiIGNvbG9yKGBbJyYnXS5iYWNrZ3JvdW5kQ29sb3JgKS5icmlnaHRlbigyMCkuY3NzKCkgICAgICAgICAgICAgICAgICAgICAgXCIsXG4gICAgICBjb2xvcjogXCIgY29sb3IoYFsnJiddLmJhY2tncm91bmRDb2xvcmApLmx1bWluYW5jZSgpID4gMC41ICYmICdibGFjaycgfHwgJ3doaXRlJyBcIlxuICAgIH0sXG4gICAgJyYgPiBoZWFkZXInOiB7Ym9yZGVyQ29sb3I6IFwiIGBbJyYnXS5ib3JkZXJDb2xvcmAgXCJ9LFxuICAgICcmID4gaWNvbi1idG4nOiB7YmFja2dyb3VuZENvbG9yOiBcIiBgWycmJ10uYmFja2dyb3VuZENvbG9yYCBcIn1cbiAgfSwge2NvbG9yOiBjb2xvcn0pO1xuICBwbHVnaW4uaW5zZXJ0KCdjb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMCA9IHRoaXM7XG4gICAgdmFyIG9yaWdFbGVtZW50ID0gdGhpcy5kb207XG4gICAgb3JpZ0VsZW1lbnQuYWRkQ2xhc3MoJ3NraW5uZWQtdGlsZScpO1xuICAgIHRoaXMuX3BfdGlsZVNraW5faGVhZGVyRWxlbWVudCA9ICQoXCI8aGVhZGVyLz5cIikuYXBwZW5kVG8ob3JpZ0VsZW1lbnQpO1xuICAgIHRoaXMuZG9tID0gJChcIjxzZWN0aW9uLz5cIikuYXBwZW5kVG8ob3JpZ0VsZW1lbnQpO1xuICAgIHRoaXMubW9kZWwuZ2V0KCduYW1lJykudGhlbigoZnVuY3Rpb24obmFtZSkge1xuICAgICAgJF9fMC5fcF90aWxlU2tpbl9oZWFkZXJFbGVtZW50LnRleHQobmFtZSk7XG4gICAgfSkpO1xuICAgIHRoaXMubW9kZWwuZ2V0KCd0aWxlJykuZ2V0KCdub3JtYWwnKS5nZXQoJ2NzcycpLnRoZW4oKGZ1bmN0aW9uKGNzcykge1xuICAgICAgJF9fMC5lbGVtZW50LmFteVB1dENzc1J1bGVzKGFwcGx5U3R5bGVEZWZhdWx0cyhjc3MpKTtcbiAgICB9KSkuY2F0Y2goKGZ1bmN0aW9uKCkge30pKTtcbiAgICB0aGlzLm9uKCdzaXplJykuZmlsdGVyQnkodGhpcy5wKCdvcGVuJykubm90KCkpLm9uVmFsdWUoKGZ1bmN0aW9uKHNpemUpIHtcbiAgICAgICRfXzAuX3BfdGlsZVNraW5faGVhZGVyRWxlbWVudC5jc3MoJ2ZvbnRTaXplJywgTWF0aC5taW4oMC4yICogTWF0aC5wb3coc2l6ZS5oZWlnaHQsIDEuMDEpLCAwLjEzICogTWF0aC5wb3coc2l6ZS53aWR0aCwgMS4wMSkpKTtcbiAgICB9KSk7XG4gICAgdGhpcy5uZXdQcm9wZXJ0eSgnaGVhZGVyU2l6ZScsIHtcbiAgICAgIHNldHRhYmxlOiBmYWxzZSxcbiAgICAgIGlzRXF1YWw6IFUuU2l6ZS5lcXVhbHNcbiAgICB9KS5wbHVnKEtlZmlyLm1lcmdlKFtLZWZpci5vbmNlKCksIHRoaXMub24oJ3NpemUnKS5jaGFuZ2VzKCksIHRoaXMub24oJ29wZW4nKS5jaGFuZ2VzKCldKS5tYXAoKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBVLlNpemUoJF9fMC5fcF90aWxlU2tpbl9oZWFkZXJFbGVtZW50LmhlaWdodCgpLCAkX18wLnNpemUud2lkdGgpO1xuICAgIH0pKSk7XG4gICAgdGhpcy5uZXdQcm9wZXJ0eSgnaGVhZGVyUG9zaXRpb24nLCB7c2V0dGFibGU6IGZhbHNlfSkucGx1Zyh0aGlzLm9uKCdwb3NpdGlvbicpKTtcbiAgfSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC10aWxlLXNraW4uanNcbiAqKiBtb2R1bGUgaWQgPSAzXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJkZWZpbmUoWydqcXVlcnknXSwgZnVuY3Rpb24oJCkge1xuICAndXNlIHN0cmljdCc7XG4gIHZhciBwbHVnaW4gPSAkLmNpcmN1aXRib2FyZC5wbHVnaW4oe1xuICAgIG5hbWU6ICd0aWxlLXNwYWNpbmcnLFxuICAgIHJlcXVpcmVzOiBbJ2NvcmUnXVxuICB9KS5tb2RpZnkoJ1RpbGVtYXAucHJvdG90eXBlJyk7XG4gIHBsdWdpbi5hZGQoJ3JlZnJlc2hUaWxlU3BhY2luZycsIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZWxlbWVudC5jc3MoJ21hcmdpbicsIHRoaXMuY2lyY3VpdGJvYXJkLm9wdGlvbnMudGlsZW1hcE1hcmdpbik7XG4gICAgdGhpcy5lbGVtZW50LmNoaWxkcmVuKCkuY3NzKCdtYXJnaW4tYm90dG9tJywgdGhpcy5jaXJjdWl0Ym9hcmQub3B0aW9ucy50aWxlU3BhY2luZyk7XG4gICAgdGhpcy5lbGVtZW50LmNoaWxkcmVuKCkuY2hpbGRyZW4oKS5jc3MoJ21hcmdpbi1yaWdodCcsIHRoaXMuY2lyY3VpdGJvYXJkLm9wdGlvbnMudGlsZVNwYWNpbmcpO1xuICB9KTtcbiAgcGx1Z2luLmFmdGVyKCdyZWZyZXNoVGlsZXMnLCBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnJlZnJlc2hUaWxlU3BhY2luZygpO1xuICB9KTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9wLXRpbGUtc3BhY2luZy5qc1xuICoqIG1vZHVsZSBpZCA9IDRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2pxdWVyeScsICcuL3V0aWwvY29kZXMuanMnLCAnLi91dGlsL2tlZmlyLWFuZC1lZ2dzLmpzJ10sIGZ1bmN0aW9uKCQsICRfXzEpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgYnV0dG9uID0gJF9fMS5idXR0b247XG4gIHZhciBwbHVnaW4gPSAkLmNpcmN1aXRib2FyZC5wbHVnaW4oe1xuICAgIG5hbWU6ICd0aWxlLWNsaWNrLXRvLW9wZW4nLFxuICAgIHJlcXVpcmVzOiBbJ3RpbGUtb3BlbiddXG4gIH0pLm1vZGlmeSgnVGlsZS5wcm90b3R5cGUnKTtcbiAgcGx1Z2luLmluc2VydCgnY29uc3RydWN0JywgZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIHRoaXMub24oJ2NsaWNrJykud2hpY2goYnV0dG9uLkxFRlQpLnNraXBQcm9wYWdhdGlvbigndGlsZS1sZWZ0LWNsaWNrJykub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLm9wZW4gPSAhJF9fMC5vcGVuO1xuICAgIH0pKTtcbiAgfSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC10aWxlLWNsaWNrLXRvLW9wZW4uanNcbiAqKiBtb2R1bGUgaWQgPSA1XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJkZWZpbmUoWydqcXVlcnknXSwgZnVuY3Rpb24oJCkge1xuICAndXNlIHN0cmljdCc7XG4gIHZhciBwbHVnaW4gPSAkLmNpcmN1aXRib2FyZC5wbHVnaW4oe1xuICAgIG5hbWU6ICd0aWxlLXdlaWdodCcsXG4gICAgcmVxdWlyZXM6IFsnY29yZSddXG4gIH0pLm1vZGlmeSgnVGlsZS5wcm90b3R5cGUnKTtcbiAgcGx1Z2luLmluc2VydCgnY29uc3RydWN0JywgZnVuY3Rpb24oKSB7fSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC10aWxlLXdlaWdodC5qc1xuICoqIG1vZHVsZSBpZCA9IDZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2pxdWVyeScsICcuL3V0aWwvbWlzYy5qcyddLCBmdW5jdGlvbigkLCBVKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyIHBsdWdpbiA9ICQuY2lyY3VpdGJvYXJkLnBsdWdpbih7XG4gICAgbmFtZTogJ3RpbGUtYWN0aXZlJyxcbiAgICByZXF1aXJlczogWydjb3JlJ11cbiAgfSkubW9kaWZ5KCdUaWxlLnByb3RvdHlwZScpO1xuICBwbHVnaW4uaW5zZXJ0KCdjb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMCA9IHRoaXM7XG4gICAgaWYgKCF0aGlzLm1vZGVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubmV3UHJvcGVydHkoJ2FjdGl2ZScsIHtpbml0aWFsOiBmYWxzZX0pO1xuICAgIHZhciBfYWN0aXZhdGVQcm9wZXJUaWxlID0gKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHRpbGVzID0gJF9fMC5tb2RlbC5fcF9hbXlBY3RpdmVUaWxlUXVldWU7XG4gICAgICBpZiAodGlsZXNbMV0pIHtcbiAgICAgICAgdGlsZXNbMV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAodGlsZXNbMF0pIHtcbiAgICAgICAgdGlsZXNbMF0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBVLmFycmF5KHRoaXMubW9kZWwsICdfcF9hbXlBY3RpdmVUaWxlUXVldWUnKS5wdXNoKHRoaXMpO1xuICAgIF9hY3RpdmF0ZVByb3BlclRpbGUoKTtcbiAgICB0aGlzLm9uKCdkZXN0cm95JykudGFrZSgxKS5vblZhbHVlKChmdW5jdGlvbigpIHtcbiAgICAgIHZhciBpbmRleCA9ICRfXzAubW9kZWwuX3BfYW15QWN0aXZlVGlsZVF1ZXVlLmluZGV4T2YoJF9fMCk7XG4gICAgICAkX18wLm1vZGVsLl9wX2FteUFjdGl2ZVRpbGVRdWV1ZS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgX2FjdGl2YXRlUHJvcGVyVGlsZSgpO1xuICAgIH0pKTtcbiAgICB0aGlzLnAoJ2FjdGl2ZScpLnZhbHVlKHRydWUpLm9uVmFsdWUoKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGluZGV4ID0gJF9fMC5tb2RlbC5fcF9hbXlBY3RpdmVUaWxlUXVldWUuaW5kZXhPZigkX18wKTtcbiAgICAgIGlmIChpbmRleCAhPT0gMCkge1xuICAgICAgICAkX18wLm1vZGVsLl9wX2FteUFjdGl2ZVRpbGVRdWV1ZS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAkX18wLm1vZGVsLl9wX2FteUFjdGl2ZVRpbGVRdWV1ZS51bnNoaWZ0KCRfXzApO1xuICAgICAgICBfYWN0aXZhdGVQcm9wZXJUaWxlKCk7XG4gICAgICB9XG4gICAgfSkpO1xuICAgIHRoaXMub24oJ2FjdGl2ZScpLm9uVmFsdWUoKGZ1bmN0aW9uKGEpIHtcbiAgICAgICRfXzAuZWxlbWVudC50b2dnbGVDbGFzcygnYWN0aXZlJywgYSk7XG4gICAgfSkpO1xuICB9KTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9wLXRpbGUtYWN0aXZlLmpzXG4gKiogbW9kdWxlIGlkID0gN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZGVmaW5lKFsnanF1ZXJ5J10sIGZ1bmN0aW9uKCQpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgcGx1Z2luID0gJC5jaXJjdWl0Ym9hcmQucGx1Z2luKHtcbiAgICBuYW1lOiAndGlsZS1vcGVuJyxcbiAgICByZXF1aXJlczogWydjb3JlJ11cbiAgfSkubW9kaWZ5KCdUaWxlLnByb3RvdHlwZScpO1xuICBwbHVnaW4uaW5zZXJ0KCdjb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMCA9IHRoaXM7XG4gICAgdGhpcy5uZXdQcm9wZXJ0eSgnb3BlbicsIHtpbml0aWFsOiBmYWxzZX0pO1xuICAgIHRoaXMucCgnb3BlbicpLnZhbHVlKHRydWUpLnRha2UoMSkub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLnBvcHVsYXRlSW5uZXJUaWxlbWFwKCk7XG4gICAgfSkpO1xuICAgIHRoaXMucCgnb3BlbicpLm9uVmFsdWUoKGZ1bmN0aW9uKG8pIHtcbiAgICAgICRfXzAuZWxlbWVudC50b2dnbGVDbGFzcygnb3BlbicsIG8pO1xuICAgIH0pKTtcbiAgICB0aGlzLnAoJ29wZW4nKS52YWx1ZShmYWxzZSkub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLmNsb3Nlc3REZXNjZW5kYW50c0J5VHlwZSgnVGlsZScpLmZvckVhY2goKGZ1bmN0aW9uKHRpbGUpIHtcbiAgICAgICAgdGlsZS5vcGVuID0gZmFsc2U7XG4gICAgICB9KSk7XG4gICAgfSkpO1xuICB9KTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9wLXRpbGUtb3Blbi5qc1xuICoqIG1vZHVsZSBpZCA9IDhcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2pxdWVyeScsICdibHVlYmlyZCcsICcuL3V0aWwva2VmaXItYW5kLWVnZ3MuanMnLCAndmVsb2NpdHknXSwgZnVuY3Rpb24oJCwgUCwgS2VmaXIpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgcGx1Z2luID0gJC5jaXJjdWl0Ym9hcmQucGx1Z2luKHtcbiAgICBuYW1lOiAndGlsZS1ncm93LXdoZW4tb3BlbicsXG4gICAgcmVxdWlyZXM6IFsndGlsZS1vcGVuJ11cbiAgfSkubW9kaWZ5KCdUaWxlLnByb3RvdHlwZScpO1xuICBwbHVnaW4uYWRkKCd3ZWlnaHRXaGVuT3BlbicsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmNpcmN1aXRib2FyZC5vcHRpb25zLndlaWdodFdoZW5PcGVuIHx8IDI7XG4gIH0pLmFkZCgnd2VpZ2h0V2hlbkNsb3NlZCcsIChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gMTtcbiAgfSkpO1xuICBwbHVnaW4uYWRkKCdncm93V2hlbk9wZW4nLCBmdW5jdGlvbihvcGVuKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIHZhciBmbGV4R3Jvd0Zyb20gPSBwYXJzZUZsb2F0KHRoaXMuZWxlbWVudC5kYXRhKCdhbXlGbGV4R3Jvd1RhcmdldCcpIHx8IDEpO1xuICAgIHZhciBmbGV4R3Jvd1RvID0gb3BlbiA/IHRoaXMud2VpZ2h0V2hlbk9wZW4oKSA6IHRoaXMud2VpZ2h0V2hlbkNsb3NlZCgpO1xuICAgIHRoaXMuZWxlbWVudC5kYXRhKCdhbXlGbGV4R3Jvd1RhcmdldCcsIGZsZXhHcm93VG8pO1xuICAgIHZhciByb3dGbGV4R3Jvd1RvID0gMDtcbiAgICB0aGlzLmVsZW1lbnQucGFyZW50KCkuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgcm93RmxleEdyb3dUbyArPSBwYXJzZUZsb2F0KCQodGhpcykuZGF0YSgnYW15RmxleEdyb3dUYXJnZXQnKSB8fCAxKTtcbiAgICB9KTtcbiAgICB2YXIgcm93RmxleEdyb3dGcm9tID0gcm93RmxleEdyb3dUbyAtIGZsZXhHcm93VG8gKyBmbGV4R3Jvd0Zyb207XG4gICAgcmV0dXJuIFAuYWxsKFtuZXcgUCgoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgJF9fMC5lbGVtZW50LnZlbG9jaXR5KHtmbGV4R3JvdzogW2ZsZXhHcm93VG8sIGZsZXhHcm93RnJvbV19LCB7XG4gICAgICAgIGNvbXBsZXRlOiByZXNvbHZlLFxuICAgICAgICBkdXJhdGlvbjogMzAwXG4gICAgICB9KTtcbiAgICB9KSksIG5ldyBQKChmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAkX18wLmVsZW1lbnQucGFyZW50KCkudmVsb2NpdHkoe2ZsZXhHcm93OiBbcm93RmxleEdyb3dUbywgcm93RmxleEdyb3dGcm9tXX0sIHtcbiAgICAgICAgY29tcGxldGU6IHJlc29sdmUsXG4gICAgICAgIGR1cmF0aW9uOiAzMDBcbiAgICAgIH0pO1xuICAgIH0pKV0pO1xuICB9KTtcbiAgcGx1Z2luLmluc2VydCgnY29uc3RydWN0JywgZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIHRoaXMucCgnb3BlbicpLmNoYW5nZXMoKS5vblZhbHVlKChmdW5jdGlvbihvcGVuKSB7XG4gICAgICAkX18wLmdyb3dXaGVuT3BlbihvcGVuKS50aGVuKChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKG9wZW4pIHtcbiAgICAgICAgICBmaW5pc2hlZE9wZW5pbmdCdXMuZW1pdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZpbmlzaGVkQ2xvc2luZ0J1cy5lbWl0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICB9KSk7XG4gICAgdmFyIGZpbmlzaGVkT3BlbmluZ0J1cyA9IEtlZmlyLmJ1cygpO1xuICAgIHZhciBmaW5pc2hlZENsb3NpbmdCdXMgPSBLZWZpci5idXMoKTtcbiAgICB0aGlzLm5ld1Byb3BlcnR5KCdmdWxseU9wZW4nLCB7XG4gICAgICBzZXR0YWJsZTogZmFsc2UsXG4gICAgICBpbml0aWFsOiB0aGlzLm9wZW5cbiAgICB9KS5wbHVnKHRoaXMucCgnb3BlbicpLnZhbHVlKGZhbHNlKSkucGx1ZyhmaW5pc2hlZE9wZW5pbmdCdXMubWFwVG8odHJ1ZSkpO1xuICAgIHRoaXMubmV3UHJvcGVydHkoJ2Z1bGx5Q2xvc2VkJywge1xuICAgICAgc2V0dGFibGU6IGZhbHNlLFxuICAgICAgaW5pdGlhbDogIXRoaXMub3BlblxuICAgIH0pLnBsdWcodGhpcy5wKCdvcGVuJykubm90KCkudmFsdWUoZmFsc2UpKS5wbHVnKGZpbmlzaGVkQ2xvc2luZ0J1cy5tYXBUbyh0cnVlKSk7XG4gIH0pO1xufSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3AtdGlsZS1ncm93LXdoZW4tb3Blbi5qc1xuICoqIG1vZHVsZSBpZCA9IDlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2pxdWVyeScsICcuL3V0aWwvbWlzYy5qcyddLCBmdW5jdGlvbigkLCBVKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyIHBsdWdpbiA9ICQuY2lyY3VpdGJvYXJkLnBsdWdpbih7XG4gICAgbmFtZTogJ3RpbGUtb3Blbi1hY3RpdmUnLFxuICAgIHJlc29sdmVzOiBbJ3RpbGUtb3BlbicsICd0aWxlLWFjdGl2ZSddXG4gIH0pLm1vZGlmeSgnVGlsZS5wcm90b3R5cGUnKTtcbiAgcGx1Z2luLmluc2VydCgnY29uc3RydWN0JywgZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIGlmIChVLmlzVW5kZWZpbmVkKHRoaXMuYWN0aXZlKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm9uKCdvcGVuJykudmFsdWUodHJ1ZSkub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLmFjdGl2ZSA9IHRydWU7XG4gICAgfSkpO1xuICAgIHRoaXMub24oJ2FjdGl2ZScpLnZhbHVlKGZhbHNlKS5vblZhbHVlKChmdW5jdGlvbigpIHtcbiAgICAgICRfXzAub3BlbiA9IGZhbHNlO1xuICAgIH0pKTtcbiAgfSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC10aWxlLW9wZW4tYWN0aXZlLmpzXG4gKiogbW9kdWxlIGlkID0gMTBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2pxdWVyeScsICdibHVlYmlyZCcsICcuL3AtdGlsZS1za2luLWdyb3ctd2hlbi1vcGVuLnNjc3MnXSwgZnVuY3Rpb24oJCwgUCkge1xuICAndXNlIHN0cmljdCc7XG4gIHZhciBwbHVnaW4gPSAkLmNpcmN1aXRib2FyZC5wbHVnaW4oe1xuICAgIG5hbWU6ICd0aWxlLXNraW4tZ3Jvdy13aGVuLW9wZW4nLFxuICAgIHJlc29sdmVzOiBbJ3RpbGUtc2tpbicsICd0aWxlLWdyb3ctd2hlbi1vcGVuJ11cbiAgfSkubW9kaWZ5KCdUaWxlLnByb3RvdHlwZScpO1xuICBwbHVnaW4uYXBwZW5kKCdjb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgZmxleEdyb3dGcm9tID0gMTtcbiAgICB2YXIgcm93RmxleEdyb3dGcm9tID0gdGhpcy5lbGVtZW50LnBhcmVudCgpLmNoaWxkcmVuKCkubGVuZ3RoO1xuICAgIHRoaXMuZWxlbWVudC52ZWxvY2l0eSh7ZmxleEdyb3c6IFtmbGV4R3Jvd0Zyb20sIGZsZXhHcm93RnJvbV19LCB7ZHVyYXRpb246IDF9KTtcbiAgICB0aGlzLmVsZW1lbnQucGFyZW50KCkudmVsb2NpdHkoe2ZsZXhHcm93OiBbcm93RmxleEdyb3dGcm9tLCByb3dGbGV4R3Jvd0Zyb21dfSwge2R1cmF0aW9uOiAxfSk7XG4gIH0pO1xuICBwbHVnaW4ucmVwbGFjZSgnZ3Jvd1doZW5PcGVuJywgZnVuY3Rpb24ob3Blbikge1xuICAgIHZhciAkX18wID0gdGhpcztcbiAgICB2YXIgb3BlbkNsb3NlVHJhbnNpdGlvbiA9IChmdW5jdGlvbigpIHtcbiAgICAgIHZhciBmbGV4R3Jvd0Zyb20gPSBwYXJzZUZsb2F0KCRfXzAuZWxlbWVudC5kYXRhKCdhbXlGbGV4R3Jvd1RhcmdldCcpIHx8IDEpO1xuICAgICAgdmFyIGZsZXhHcm93VG8gPSBvcGVuID8gJF9fMC53ZWlnaHRXaGVuT3BlbigpIDogJF9fMC53ZWlnaHRXaGVuQ2xvc2VkKCk7XG4gICAgICAkX18wLmVsZW1lbnQuZGF0YSgnYW15RmxleEdyb3dUYXJnZXQnLCBmbGV4R3Jvd1RvKTtcbiAgICAgIHZhciByb3dGbGV4R3Jvd1RvID0gMDtcbiAgICAgICRfXzAuZWxlbWVudC5wYXJlbnQoKS5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHJvd0ZsZXhHcm93VG8gKz0gcGFyc2VGbG9hdCgkKHRoaXMpLmRhdGEoJ2FteUZsZXhHcm93VGFyZ2V0JykgfHwgMSk7XG4gICAgICB9KTtcbiAgICAgIHZhciByb3dGbGV4R3Jvd0Zyb20gPSByb3dGbGV4R3Jvd1RvIC0gZmxleEdyb3dUbyArIGZsZXhHcm93RnJvbTtcbiAgICAgIHJldHVybiBQLmFsbChbbmV3IFAoKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgJF9fMC5lbGVtZW50LnZlbG9jaXR5KHtmbGV4R3JvdzogW2ZsZXhHcm93VG8sIGZsZXhHcm93RnJvbV19LCB7XG4gICAgICAgICAgY29tcGxldGU6IHJlc29sdmUsXG4gICAgICAgICAgZHVyYXRpb246IDMwMFxuICAgICAgICB9KTtcbiAgICAgIH0pKSwgbmV3IFAoKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgJF9fMC5lbGVtZW50LnBhcmVudCgpLnZlbG9jaXR5KHtmbGV4R3JvdzogW3Jvd0ZsZXhHcm93VG8sIHJvd0ZsZXhHcm93RnJvbV19LCB7XG4gICAgICAgICAgY29tcGxldGU6IHJlc29sdmUsXG4gICAgICAgICAgZHVyYXRpb246IDMwMFxuICAgICAgICB9KTtcbiAgICAgIH0pKV0pO1xuICAgIH0pO1xuICAgIHZhciBzZWN0aW9uRWxlbWVudCA9IHRoaXMuZWxlbWVudC5jaGlsZHJlbignc2VjdGlvbicpO1xuICAgIGlmIChvcGVuKSB7XG4gICAgICBzZWN0aW9uRWxlbWVudC5jc3Moe1xuICAgICAgICB2aXNpYmlsaXR5OiAnaGlkZGVuJyxcbiAgICAgICAgb3BhY2l0eTogMFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gb3BlbkNsb3NlVHJhbnNpdGlvbigpLnRoZW4oKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFAoKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgICBzZWN0aW9uRWxlbWVudC5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICAgICAgICAgIHNlY3Rpb25FbGVtZW50LnZlbG9jaXR5KHtvcGFjaXR5OiBbMSwgMF19LCB7XG4gICAgICAgICAgICBjb21wbGV0ZTogcmVzb2x2ZSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAyMDBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSkpO1xuICAgICAgfSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWN0aW9uRWxlbWVudC5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICAgICAgcmV0dXJuIG9wZW5DbG9zZVRyYW5zaXRpb24oKS50aGVuKChmdW5jdGlvbigpIHtcbiAgICAgICAgc2VjdGlvbkVsZW1lbnQuY3NzKCd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICAgICAgfSkpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC10aWxlLXNraW4tZ3Jvdy13aGVuLW9wZW4uanNcbiAqKiBtb2R1bGUgaWQgPSAxMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZGVmaW5lKFsnanF1ZXJ5JywgJy4vdXRpbC9taXNjLmpzJywgJy4vdXRpbC9rZWZpci1hbmQtZWdncy5qcyddLCBmdW5jdGlvbigkLCBVLCBLZWZpcikge1xuICAndXNlIHN0cmljdCc7XG4gIHZhciBwbHVnaW4gPSAkLmNpcmN1aXRib2FyZC5wbHVnaW4oe1xuICAgIG5hbWU6ICdwb3NpdGlvbi10cmFja2luZycsXG4gICAgZXhwZWN0czogWydjb3JlJywgJ3RpbGUtZ3Jvdy13aGVuLW9wZW4nLCAndGlsZS1ncm93LXdoZW4tbWF4aW1pemVkJywgJ3RpbGUtc2hyaW5rLXdoZW4taGlkZGVuJ11cbiAgfSk7XG4gIHBsdWdpbi5hZGQoJ0NpcmN1aXRib2FyZC5wcm90b3R5cGUuX3Bvc1RyYWNraW5nV2luZG93JywgZnVuY3Rpb24od2luZG93KSB7XG4gICAgd2luZG93KCk7XG4gIH0pO1xuICBwbHVnaW4uaW5zZXJ0KCdDaXJjdWl0Ym9hcmQucHJvdG90eXBlLmNvbnN0cnVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX3Bvc1RyYWNraW5nTGltaXRlciA9IEtlZmlyLmxpbWl0ZXIoS2VmaXIubWVyZ2UoW0tlZmlyLm9uY2UoKSwgS2VmaXIuaW50ZXJ2YWwoMTAwKV0pLCB0aGlzLl9wb3NUcmFja2luZ1dpbmRvdy5iaW5kKHRoaXMpKTtcbiAgfSk7XG4gIHBsdWdpbi5pbnNlcnQoJ1RpbGUucHJvdG90eXBlLmNvbnN0cnVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMubmV3UHJvcGVydHkoJ2FuaW1hdGlvbklkbGUnLCB7XG4gICAgICBzZXR0YWJsZTogZmFsc2UsXG4gICAgICBpbml0aWFsOiB0cnVlXG4gICAgfSkucGx1ZyhLZWZpci5hbmQoW3RoaXMucCgnZnVsbHlPcGVuJykub3IodGhpcy5wKCdmdWxseUNsb3NlZCcpKSwgdGhpcy5wKCdmdWxseUhpZGRlbicpLm9yKHRoaXMucCgnZnVsbHlWaXNpYmxlJykpLCB0aGlzLnAoJ2Z1bGx5TWF4aW1pemVkJykub3IodGhpcy5wKCdmdWxseU5vdE1heGltaXplZCcpKV0pKTtcbiAgfSk7XG4gIHBsdWdpbi5pbnNlcnQoJ0NpcmN1aXRib2FyZC5wcm90b3R5cGUuY29uc3RydWN0JywgZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIHRoaXMubmV3UHJvcGVydHkoJ29mZnNldCcsIHtcbiAgICAgIHNldHRhYmxlOiBmYWxzZSxcbiAgICAgIGlzRXF1YWw6IFUuUG9zaXRpb24uZXF1YWxzLFxuICAgICAgaW5pdGlhbDogdGhpcy5lbGVtZW50Lm9mZnNldCgpXG4gICAgfSkucGx1ZyhLZWZpci5tZXJnZShbS2VmaXIub25jZSgpLCBLZWZpci5pbnRlcnZhbCgxMDAwKV0pLmxpbWl0ZWRCeSh0aGlzLl9wb3NUcmFja2luZ0xpbWl0ZXIpLm1hcCgoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fMC5lbGVtZW50Lm9mZnNldCgpO1xuICAgIH0pKSk7XG4gIH0pLmluc2VydCgnVGlsZW1hcC5wcm90b3R5cGUuY29uc3RydWN0JywgZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIHRoaXMubmV3UHJvcGVydHkoJ29mZnNldCcsIHtcbiAgICAgIHNldHRhYmxlOiBmYWxzZSxcbiAgICAgIGlzRXF1YWw6IFUuUG9zaXRpb24uZXF1YWxzLFxuICAgICAgaW5pdGlhbDogdGhpcy5lbGVtZW50Lm9mZnNldCgpXG4gICAgfSkucGx1ZyhLZWZpci5tZXJnZShbS2VmaXIub25jZSgpLCB0aGlzLnBhcmVudC5wKCdzaXplJykuY2hhbmdlcygpLCB0aGlzLnBhcmVudC5wKCdvZmZzZXQnKS5jaGFuZ2VzKCldKS5saW1pdGVkQnkodGhpcy5jaXJjdWl0Ym9hcmQuX3Bvc1RyYWNraW5nTGltaXRlcikubWFwKChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX18wLmVsZW1lbnQub2Zmc2V0KCk7XG4gICAgfSkpKTtcbiAgfSkuaW5zZXJ0KCdUaWxlLnByb3RvdHlwZS5jb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMCA9IHRoaXM7XG4gICAgdGhpcy5uZXdQcm9wZXJ0eSgnb2Zmc2V0Jywge1xuICAgICAgc2V0dGFibGU6IGZhbHNlLFxuICAgICAgaXNFcXVhbDogVS5Qb3NpdGlvbi5lcXVhbHMsXG4gICAgICBpbml0aWFsOiB0aGlzLmVsZW1lbnQub2Zmc2V0KClcbiAgICB9KS5wbHVnKEtlZmlyLm1lcmdlKFtLZWZpci5vbmNlKCksIHRoaXMucGFyZW50LnAoJ3NpemUnKS5jaGFuZ2VzKCksIHRoaXMucGFyZW50LnAoJ29mZnNldCcpLmNoYW5nZXMoKSwgdGhpcy5wYXJlbnQub24oJ3Jlb3JnYW5pemUnKSwgdGhpcy5wKCdhbmltYXRpb25JZGxlJykudmFsdWUodHJ1ZSksIEtlZmlyLmludGVydmFsKDEwMDApLmZpbHRlckJ5KHRoaXMucCgnYW5pbWF0aW9uSWRsZScpKV0pLmZpbHRlcigoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gISRfXzAuX29mZnNldFVwZGF0ZWQ7XG4gICAgfSkpLmxpbWl0ZWRCeSh0aGlzLmNpcmN1aXRib2FyZC5fcG9zVHJhY2tpbmdMaW1pdGVyKS5tYXAoKGZ1bmN0aW9uKCkge1xuICAgICAgJF9fMC5fb2Zmc2V0VXBkYXRlZCA9IHRydWU7XG4gICAgICByZXR1cm4gJF9fMC5lbGVtZW50Lm9mZnNldCgpO1xuICAgIH0pKSk7XG4gICAgdGhpcy5fb2Zmc2V0VXBkYXRlZCA9IGZhbHNlO1xuICAgIEtlZmlyLmludGVydmFsKDEwMCkub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLl9vZmZzZXRVcGRhdGVkID0gZmFsc2U7XG4gICAgfSkpO1xuICB9KTtcbiAgcGx1Z2luLmluc2VydCgnQ2lyY3VpdGJvYXJkLnByb3RvdHlwZS5jb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm5ld1Byb3BlcnR5KCdwb3NpdGlvbicsIHtcbiAgICAgIHNldHRhYmxlOiBmYWxzZSxcbiAgICAgIGluaXRpYWw6IG5ldyBVLlBvc2l0aW9uKDAsIDApXG4gICAgfSk7XG4gIH0pLmluc2VydCgnVGlsZW1hcC5wcm90b3R5cGUuY29uc3RydWN0JywgZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzAgPSB0aGlzO1xuICAgIHRoaXMubmV3UHJvcGVydHkoJ3Bvc2l0aW9uJywge1xuICAgICAgc2V0dGFibGU6IGZhbHNlLFxuICAgICAgaXNFcXVhbDogVS5Qb3NpdGlvbi5lcXVhbHNcbiAgICB9KS5wbHVnKEtlZmlyLm1lcmdlKFtLZWZpci5vbmNlKCksIHRoaXMucCgnb2Zmc2V0JykuY2hhbmdlcygpLCB0aGlzLmNpcmN1aXRib2FyZC5wKCdvZmZzZXQnKS5jaGFuZ2VzKCldKS5tYXAoKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFUuUG9zaXRpb24uc3VidHJhY3QoJF9fMC5vZmZzZXQsICRfXzAuY2lyY3VpdGJvYXJkLm9mZnNldCk7XG4gICAgfSkpKTtcbiAgfSkuaW5zZXJ0KCdUaWxlLnByb3RvdHlwZS5jb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMCA9IHRoaXM7XG4gICAgdGhpcy5uZXdQcm9wZXJ0eSgncG9zaXRpb24nLCB7XG4gICAgICBzZXR0YWJsZTogZmFsc2UsXG4gICAgICBpc0VxdWFsOiBVLlBvc2l0aW9uLmVxdWFsc1xuICAgIH0pLnBsdWcoS2VmaXIubWVyZ2UoW0tlZmlyLm9uY2UoKSwgdGhpcy5wKCdvZmZzZXQnKS5jaGFuZ2VzKCksIHRoaXMuY2lyY3VpdGJvYXJkLnAoJ29mZnNldCcpLmNoYW5nZXMoKSwgdGhpcy5wKCdhbmltYXRpb25JZGxlJykudmFsdWUodHJ1ZSksIEtlZmlyLmludGVydmFsKDEwMDApLmZpbHRlckJ5KHRoaXMucCgnYW5pbWF0aW9uSWRsZScpKV0pLmZpbHRlcigoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gISRfXzAuX3Bvc2l0aW9uVXBkYXRlZDtcbiAgICB9KSkubWFwKChmdW5jdGlvbigpIHtcbiAgICAgICRfXzAuX3Bvc2l0aW9uVXBkYXRlZCA9IHRydWU7XG4gICAgICByZXR1cm4gVS5Qb3NpdGlvbi5zdWJ0cmFjdCgkX18wLm9mZnNldCwgJF9fMC5jaXJjdWl0Ym9hcmQub2Zmc2V0KTtcbiAgICB9KSkpO1xuICAgIHRoaXMuX3Bvc2l0aW9uVXBkYXRlZCA9IGZhbHNlO1xuICAgIEtlZmlyLmludGVydmFsKDEwMCkub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLl9wb3NpdGlvblVwZGF0ZWQgPSBmYWxzZTtcbiAgICB9KSk7XG4gIH0pO1xuICBwbHVnaW4uaW5zZXJ0KCdDaXJjdWl0Ym9hcmQucHJvdG90eXBlLmNvbnN0cnVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18wID0gdGhpcztcbiAgICB0aGlzLm5ld1Byb3BlcnR5KCdzaXplJywge1xuICAgICAgc2V0dGFibGU6IGZhbHNlLFxuICAgICAgaXNFcXVhbDogVS5TaXplLmVxdWFsc1xuICAgIH0pLnBsdWcoS2VmaXIubWVyZ2UoW0tlZmlyLm9uY2UoKSwgdGhpcy5vcHRpb25zLnJlc2l6ZUV2ZW50IHx8ICQod2luZG93KS5hc0tlZmlyU3RyZWFtKCdyZXNpemUnKV0pLm1hcCgoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IFUuU2l6ZSgkX18wLmVsZW1lbnQuaGVpZ2h0KCksICRfXzAuZWxlbWVudC53aWR0aCgpKTtcbiAgICB9KSkpO1xuICB9KS5pbnNlcnQoJ1RpbGVtYXAucHJvdG90eXBlLmNvbnN0cnVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18wID0gdGhpcztcbiAgICB0aGlzLm5ld1Byb3BlcnR5KCdzaXplJywge1xuICAgICAgc2V0dGFibGU6IGZhbHNlLFxuICAgICAgaXNFcXVhbDogVS5TaXplLmVxdWFsc1xuICAgIH0pLnBsdWcoS2VmaXIubWVyZ2UoW0tlZmlyLm9uY2UoKSwgdGhpcy5wYXJlbnQucCgnc2l6ZScpLmNoYW5nZXMoKV0pLm1hcCgoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IFUuU2l6ZSgkX18wLmVsZW1lbnQuaGVpZ2h0KCksICRfXzAuZWxlbWVudC53aWR0aCgpKTtcbiAgICB9KSkpO1xuICB9KS5pbnNlcnQoJ1RpbGUucHJvdG90eXBlLmNvbnN0cnVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18wID0gdGhpcztcbiAgICB0aGlzLm5ld1Byb3BlcnR5KCdzaXplJywge1xuICAgICAgc2V0dGFibGU6IGZhbHNlLFxuICAgICAgaXNFcXVhbDogVS5TaXplLmVxdWFsc1xuICAgIH0pLnBsdWcoS2VmaXIubWVyZ2UoW0tlZmlyLm9uY2UoKSwgdGhpcy5wYXJlbnQucCgnc2l6ZScpLmNoYW5nZXMoKSwgdGhpcy5wYXJlbnQub24oJ3Jlb3JnYW5pemUnKSwgdGhpcy5wKCdhbmltYXRpb25JZGxlJykudmFsdWUodHJ1ZSksIEtlZmlyLmludGVydmFsKDEwMDApLmZpbHRlckJ5KHRoaXMucCgnYW5pbWF0aW9uSWRsZScpKV0pLmZpbHRlcigoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gISRfXzAuX3NpemVVcGRhdGVkO1xuICAgIH0pKS5tYXAoKGZ1bmN0aW9uKCkge1xuICAgICAgJF9fMC5fc2l6ZVVwZGF0ZWQgPSB0cnVlO1xuICAgICAgcmV0dXJuIG5ldyBVLlNpemUoJF9fMC5lbGVtZW50LmhlaWdodCgpLCAkX18wLmVsZW1lbnQud2lkdGgoKSk7XG4gICAgfSkpKTtcbiAgICB0aGlzLl9zaXplVXBkYXRlZCA9IGZhbHNlO1xuICAgIEtlZmlyLmludGVydmFsKDEwMCkub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLl9zaXplVXBkYXRlZCA9IGZhbHNlO1xuICAgIH0pKTtcbiAgfSk7XG4gIHBsdWdpbi5pbnNlcnQoJ1RpbGVtYXAucHJvdG90eXBlLmNvbnN0cnVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMubmV3RXZlbnQoJ3Jlb3JnYW5pemUnKTtcbiAgfSkuaW5zZXJ0KCdUaWxlLnByb3RvdHlwZS5jb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMCA9IHRoaXM7XG4gICAgdGhpcy5wKCdzaXplJykub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLnBhcmVudC50cmlnZ2VyKCdyZW9yZ2FuaXplJyk7XG4gICAgfSkpO1xuICB9KTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9wLXBvc2l0aW9uLXRyYWNraW5nLmpzXG4gKiogbW9kdWxlIGlkID0gMTJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2pxdWVyeScsICcuL3V0aWwva2VmaXItYW5kLWVnZ3MuanMnLCAnLi91dGlsL21pc2MuanMnXSwgZnVuY3Rpb24oJCwgS2VmaXIpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgcGx1Z2luID0gJC5jaXJjdWl0Ym9hcmQucGx1Z2luKHtcbiAgICBuYW1lOiAndHJhbnNpdGlvbi1wb3NpdGlvbi10cmFja2luZycsXG4gICAgcmVzb2x2ZXM6IFsncG9zaXRpb24tdHJhY2tpbmcnLCAndGlsZS1ncm93LXdoZW4tb3BlbiddXG4gIH0pO1xuICBwbHVnaW4uaW5zZXJ0KCdUaWxlLnByb3RvdHlwZS5jb25zdHJ1Y3QnLCBmdW5jdGlvbigpIHt9KTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9wLXRyYW5zaXRpb24tcG9zaXRpb24tdHJhY2tpbmcuanNcbiAqKiBtb2R1bGUgaWQgPSAxM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBnbG9iYWxbXCJqUXVlcnlcIl0gPSByZXF1aXJlKFwiLSEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvdHJhY2V1ci1sb2FkZXIvaW5kZXguanM/c291cmNlTWFwcz1mYWxzZSZzY3JpcHQhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvYm93ZXJfY29tcG9uZW50cy9qcXVlcnkvZGlzdC9qcXVlcnkuanNcIik7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vZXhwb3NlLWxvYWRlcj9qUXVlcnkhLi9ib3dlcl9jb21wb25lbnRzL2pxdWVyeS9kaXN0L2pxdWVyeS5qc1xuICoqIG1vZHVsZSBpZCA9IDE0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIoZnVuY3Rpb24oZ2xvYmFsLCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gXCJvYmplY3RcIikge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZ2xvYmFsLmRvY3VtZW50ID8gZmFjdG9yeShnbG9iYWwsIHRydWUpIDogZnVuY3Rpb24odykge1xuICAgICAgaWYgKCF3LmRvY3VtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnRcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFjdG9yeSh3KTtcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGZhY3RvcnkoZ2xvYmFsKTtcbiAgfVxufSh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24od2luZG93LCBub0dsb2JhbCkge1xuICB2YXIgYXJyID0gW107XG4gIHZhciBzbGljZSA9IGFyci5zbGljZTtcbiAgdmFyIGNvbmNhdCA9IGFyci5jb25jYXQ7XG4gIHZhciBwdXNoID0gYXJyLnB1c2g7XG4gIHZhciBpbmRleE9mID0gYXJyLmluZGV4T2Y7XG4gIHZhciBjbGFzczJ0eXBlID0ge307XG4gIHZhciB0b1N0cmluZyA9IGNsYXNzMnR5cGUudG9TdHJpbmc7XG4gIHZhciBoYXNPd24gPSBjbGFzczJ0eXBlLmhhc093blByb3BlcnR5O1xuICB2YXIgc3VwcG9ydCA9IHt9O1xuICB2YXIgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQsXG4gICAgICB2ZXJzaW9uID0gXCIyLjEuM1wiLFxuICAgICAgalF1ZXJ5ID0gZnVuY3Rpb24oc2VsZWN0b3IsIGNvbnRleHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBqUXVlcnkuZm4uaW5pdChzZWxlY3RvciwgY29udGV4dCk7XG4gICAgICB9LFxuICAgICAgcnRyaW0gPSAvXltcXHNcXHVGRUZGXFx4QTBdK3xbXFxzXFx1RkVGRlxceEEwXSskL2csXG4gICAgICBybXNQcmVmaXggPSAvXi1tcy0vLFxuICAgICAgcmRhc2hBbHBoYSA9IC8tKFtcXGRhLXpdKS9naSxcbiAgICAgIGZjYW1lbENhc2UgPSBmdW5jdGlvbihhbGwsIGxldHRlcikge1xuICAgICAgICByZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7XG4gICAgICB9O1xuICBqUXVlcnkuZm4gPSBqUXVlcnkucHJvdG90eXBlID0ge1xuICAgIGpxdWVyeTogdmVyc2lvbixcbiAgICBjb25zdHJ1Y3RvcjogalF1ZXJ5LFxuICAgIHNlbGVjdG9yOiBcIlwiLFxuICAgIGxlbmd0aDogMCxcbiAgICB0b0FycmF5OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzbGljZS5jYWxsKHRoaXMpO1xuICAgIH0sXG4gICAgZ2V0OiBmdW5jdGlvbihudW0pIHtcbiAgICAgIHJldHVybiBudW0gIT0gbnVsbCA/IChudW0gPCAwID8gdGhpc1tudW0gKyB0aGlzLmxlbmd0aF0gOiB0aGlzW251bV0pIDogc2xpY2UuY2FsbCh0aGlzKTtcbiAgICB9LFxuICAgIHB1c2hTdGFjazogZnVuY3Rpb24oZWxlbXMpIHtcbiAgICAgIHZhciByZXQgPSBqUXVlcnkubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLCBlbGVtcyk7XG4gICAgICByZXQucHJldk9iamVjdCA9IHRoaXM7XG4gICAgICByZXQuY29udGV4dCA9IHRoaXMuY29udGV4dDtcbiAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcbiAgICBlYWNoOiBmdW5jdGlvbihjYWxsYmFjaywgYXJncykge1xuICAgICAgcmV0dXJuIGpRdWVyeS5lYWNoKHRoaXMsIGNhbGxiYWNrLCBhcmdzKTtcbiAgICB9LFxuICAgIG1hcDogZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhqUXVlcnkubWFwKHRoaXMsIGZ1bmN0aW9uKGVsZW0sIGkpIHtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrLmNhbGwoZWxlbSwgaSwgZWxlbSk7XG4gICAgICB9KSk7XG4gICAgfSxcbiAgICBzbGljZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2soc2xpY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gICAgfSxcbiAgICBmaXJzdDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5lcSgwKTtcbiAgICB9LFxuICAgIGxhc3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZXEoLTEpO1xuICAgIH0sXG4gICAgZXE6IGZ1bmN0aW9uKGkpIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aCxcbiAgICAgICAgICBqID0gK2kgKyAoaSA8IDAgPyBsZW4gOiAwKTtcbiAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhqID49IDAgJiYgaiA8IGxlbiA/IFt0aGlzW2pdXSA6IFtdKTtcbiAgICB9LFxuICAgIGVuZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5wcmV2T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IobnVsbCk7XG4gICAgfSxcbiAgICBwdXNoOiBwdXNoLFxuICAgIHNvcnQ6IGFyci5zb3J0LFxuICAgIHNwbGljZTogYXJyLnNwbGljZVxuICB9O1xuICBqUXVlcnkuZXh0ZW5kID0galF1ZXJ5LmZuLmV4dGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBvcHRpb25zLFxuICAgICAgICBuYW1lLFxuICAgICAgICBzcmMsXG4gICAgICAgIGNvcHksXG4gICAgICAgIGNvcHlJc0FycmF5LFxuICAgICAgICBjbG9uZSxcbiAgICAgICAgdGFyZ2V0ID0gYXJndW1lbnRzWzBdIHx8IHt9LFxuICAgICAgICBpID0gMSxcbiAgICAgICAgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aCxcbiAgICAgICAgZGVlcCA9IGZhbHNlO1xuICAgIGlmICh0eXBlb2YgdGFyZ2V0ID09PSBcImJvb2xlYW5cIikge1xuICAgICAgZGVlcCA9IHRhcmdldDtcbiAgICAgIHRhcmdldCA9IGFyZ3VtZW50c1tpXSB8fCB7fTtcbiAgICAgIGkrKztcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB0YXJnZXQgIT09IFwib2JqZWN0XCIgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKHRhcmdldCkpIHtcbiAgICAgIHRhcmdldCA9IHt9O1xuICAgIH1cbiAgICBpZiAoaSA9PT0gbGVuZ3RoKSB7XG4gICAgICB0YXJnZXQgPSB0aGlzO1xuICAgICAgaS0tO1xuICAgIH1cbiAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoKG9wdGlvbnMgPSBhcmd1bWVudHNbaV0pICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChuYW1lIGluIG9wdGlvbnMpIHtcbiAgICAgICAgICBzcmMgPSB0YXJnZXRbbmFtZV07XG4gICAgICAgICAgY29weSA9IG9wdGlvbnNbbmFtZV07XG4gICAgICAgICAgaWYgKHRhcmdldCA9PT0gY29weSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChkZWVwICYmIGNvcHkgJiYgKGpRdWVyeS5pc1BsYWluT2JqZWN0KGNvcHkpIHx8IChjb3B5SXNBcnJheSA9IGpRdWVyeS5pc0FycmF5KGNvcHkpKSkpIHtcbiAgICAgICAgICAgIGlmIChjb3B5SXNBcnJheSkge1xuICAgICAgICAgICAgICBjb3B5SXNBcnJheSA9IGZhbHNlO1xuICAgICAgICAgICAgICBjbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNBcnJheShzcmMpID8gc3JjIDogW107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdChzcmMpID8gc3JjIDoge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YXJnZXRbbmFtZV0gPSBqUXVlcnkuZXh0ZW5kKGRlZXAsIGNsb25lLCBjb3B5KTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGNvcHkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGFyZ2V0W25hbWVdID0gY29weTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcbiAgalF1ZXJ5LmV4dGVuZCh7XG4gICAgZXhwYW5kbzogXCJqUXVlcnlcIiArICh2ZXJzaW9uICsgTWF0aC5yYW5kb20oKSkucmVwbGFjZSgvXFxEL2csIFwiXCIpLFxuICAgIGlzUmVhZHk6IHRydWUsXG4gICAgZXJyb3I6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gICAgfSxcbiAgICBub29wOiBmdW5jdGlvbigpIHt9LFxuICAgIGlzRnVuY3Rpb246IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIGpRdWVyeS50eXBlKG9iaikgPT09IFwiZnVuY3Rpb25cIjtcbiAgICB9LFxuICAgIGlzQXJyYXk6IEFycmF5LmlzQXJyYXksXG4gICAgaXNXaW5kb3c6IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIG9iaiAhPSBudWxsICYmIG9iaiA9PT0gb2JqLndpbmRvdztcbiAgICB9LFxuICAgIGlzTnVtZXJpYzogZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gIWpRdWVyeS5pc0FycmF5KG9iaikgJiYgKG9iaiAtIHBhcnNlRmxvYXQob2JqKSArIDEpID49IDA7XG4gICAgfSxcbiAgICBpc1BsYWluT2JqZWN0OiBmdW5jdGlvbihvYmopIHtcbiAgICAgIGlmIChqUXVlcnkudHlwZShvYmopICE9PSBcIm9iamVjdFwiIHx8IG9iai5ub2RlVHlwZSB8fCBqUXVlcnkuaXNXaW5kb3cob2JqKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob2JqLmNvbnN0cnVjdG9yICYmICFoYXNPd24uY2FsbChvYmouY29uc3RydWN0b3IucHJvdG90eXBlLCBcImlzUHJvdG90eXBlT2ZcIikpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBpc0VtcHR5T2JqZWN0OiBmdW5jdGlvbihvYmopIHtcbiAgICAgIHZhciBuYW1lO1xuICAgICAgZm9yIChuYW1lIGluIG9iaikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIHR5cGU6IGZ1bmN0aW9uKG9iaikge1xuICAgICAgaWYgKG9iaiA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBvYmogKyBcIlwiO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIG9iaiA9PT0gXCJmdW5jdGlvblwiID8gY2xhc3MydHlwZVt0b1N0cmluZy5jYWxsKG9iaildIHx8IFwib2JqZWN0XCIgOiB0eXBlb2Ygb2JqO1xuICAgIH0sXG4gICAgZ2xvYmFsRXZhbDogZnVuY3Rpb24oY29kZSkge1xuICAgICAgdmFyIHNjcmlwdCxcbiAgICAgICAgICBpbmRpcmVjdCA9IGV2YWw7XG4gICAgICBjb2RlID0galF1ZXJ5LnRyaW0oY29kZSk7XG4gICAgICBpZiAoY29kZSkge1xuICAgICAgICBpZiAoY29kZS5pbmRleE9mKFwidXNlIHN0cmljdFwiKSA9PT0gMSkge1xuICAgICAgICAgIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgICAgICAgc2NyaXB0LnRleHQgPSBjb2RlO1xuICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW5kaXJlY3QoY29kZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGNhbWVsQ2FzZTogZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2Uocm1zUHJlZml4LCBcIm1zLVwiKS5yZXBsYWNlKHJkYXNoQWxwaGEsIGZjYW1lbENhc2UpO1xuICAgIH0sXG4gICAgbm9kZU5hbWU6IGZ1bmN0aW9uKGVsZW0sIG5hbWUpIHtcbiAgICAgIHJldHVybiBlbGVtLm5vZGVOYW1lICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIH0sXG4gICAgZWFjaDogZnVuY3Rpb24ob2JqLCBjYWxsYmFjaywgYXJncykge1xuICAgICAgdmFyIHZhbHVlLFxuICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgIGxlbmd0aCA9IG9iai5sZW5ndGgsXG4gICAgICAgICAgaXNBcnJheSA9IGlzQXJyYXlsaWtlKG9iaik7XG4gICAgICBpZiAoYXJncykge1xuICAgICAgICBpZiAoaXNBcnJheSkge1xuICAgICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhbHVlID0gY2FsbGJhY2suYXBwbHkob2JqW2ldLCBhcmdzKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAoaSBpbiBvYmopIHtcbiAgICAgICAgICAgIHZhbHVlID0gY2FsbGJhY2suYXBwbHkob2JqW2ldLCBhcmdzKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoaXNBcnJheSkge1xuICAgICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhbHVlID0gY2FsbGJhY2suY2FsbChvYmpbaV0sIGksIG9ialtpXSk7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGkgaW4gb2JqKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGNhbGxiYWNrLmNhbGwob2JqW2ldLCBpLCBvYmpbaV0pO1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcbiAgICB0cmltOiBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICByZXR1cm4gdGV4dCA9PSBudWxsID8gXCJcIiA6ICh0ZXh0ICsgXCJcIikucmVwbGFjZShydHJpbSwgXCJcIik7XG4gICAgfSxcbiAgICBtYWtlQXJyYXk6IGZ1bmN0aW9uKGFyciwgcmVzdWx0cykge1xuICAgICAgdmFyIHJldCA9IHJlc3VsdHMgfHwgW107XG4gICAgICBpZiAoYXJyICE9IG51bGwpIHtcbiAgICAgICAgaWYgKGlzQXJyYXlsaWtlKE9iamVjdChhcnIpKSkge1xuICAgICAgICAgIGpRdWVyeS5tZXJnZShyZXQsIHR5cGVvZiBhcnIgPT09IFwic3RyaW5nXCIgPyBbYXJyXSA6IGFycik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHVzaC5jYWxsKHJldCwgYXJyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9LFxuICAgIGluQXJyYXk6IGZ1bmN0aW9uKGVsZW0sIGFyciwgaSkge1xuICAgICAgcmV0dXJuIGFyciA9PSBudWxsID8gLTEgOiBpbmRleE9mLmNhbGwoYXJyLCBlbGVtLCBpKTtcbiAgICB9LFxuICAgIG1lcmdlOiBmdW5jdGlvbihmaXJzdCwgc2Vjb25kKSB7XG4gICAgICB2YXIgbGVuID0gK3NlY29uZC5sZW5ndGgsXG4gICAgICAgICAgaiA9IDAsXG4gICAgICAgICAgaSA9IGZpcnN0Lmxlbmd0aDtcbiAgICAgIGZvciAoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgZmlyc3RbaSsrXSA9IHNlY29uZFtqXTtcbiAgICAgIH1cbiAgICAgIGZpcnN0Lmxlbmd0aCA9IGk7XG4gICAgICByZXR1cm4gZmlyc3Q7XG4gICAgfSxcbiAgICBncmVwOiBmdW5jdGlvbihlbGVtcywgY2FsbGJhY2ssIGludmVydCkge1xuICAgICAgdmFyIGNhbGxiYWNrSW52ZXJzZSxcbiAgICAgICAgICBtYXRjaGVzID0gW10sXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgbGVuZ3RoID0gZWxlbXMubGVuZ3RoLFxuICAgICAgICAgIGNhbGxiYWNrRXhwZWN0ID0gIWludmVydDtcbiAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2FsbGJhY2tJbnZlcnNlID0gIWNhbGxiYWNrKGVsZW1zW2ldLCBpKTtcbiAgICAgICAgaWYgKGNhbGxiYWNrSW52ZXJzZSAhPT0gY2FsbGJhY2tFeHBlY3QpIHtcbiAgICAgICAgICBtYXRjaGVzLnB1c2goZWxlbXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbWF0Y2hlcztcbiAgICB9LFxuICAgIG1hcDogZnVuY3Rpb24oZWxlbXMsIGNhbGxiYWNrLCBhcmcpIHtcbiAgICAgIHZhciB2YWx1ZSxcbiAgICAgICAgICBpID0gMCxcbiAgICAgICAgICBsZW5ndGggPSBlbGVtcy5sZW5ndGgsXG4gICAgICAgICAgaXNBcnJheSA9IGlzQXJyYXlsaWtlKGVsZW1zKSxcbiAgICAgICAgICByZXQgPSBbXTtcbiAgICAgIGlmIChpc0FycmF5KSB7XG4gICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YWx1ZSA9IGNhbGxiYWNrKGVsZW1zW2ldLCBpLCBhcmcpO1xuICAgICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXQucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKGkgaW4gZWxlbXMpIHtcbiAgICAgICAgICB2YWx1ZSA9IGNhbGxiYWNrKGVsZW1zW2ldLCBpLCBhcmcpO1xuICAgICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXQucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gY29uY2F0LmFwcGx5KFtdLCByZXQpO1xuICAgIH0sXG4gICAgZ3VpZDogMSxcbiAgICBwcm94eTogZnVuY3Rpb24oZm4sIGNvbnRleHQpIHtcbiAgICAgIHZhciB0bXAsXG4gICAgICAgICAgYXJncyxcbiAgICAgICAgICBwcm94eTtcbiAgICAgIGlmICh0eXBlb2YgY29udGV4dCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB0bXAgPSBmbltjb250ZXh0XTtcbiAgICAgICAgY29udGV4dCA9IGZuO1xuICAgICAgICBmbiA9IHRtcDtcbiAgICAgIH1cbiAgICAgIGlmICghalF1ZXJ5LmlzRnVuY3Rpb24oZm4pKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgICAgcHJveHkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGZuLmFwcGx5KGNvbnRleHQgfHwgdGhpcywgYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7XG4gICAgICB9O1xuICAgICAgcHJveHkuZ3VpZCA9IGZuLmd1aWQgPSBmbi5ndWlkIHx8IGpRdWVyeS5ndWlkKys7XG4gICAgICByZXR1cm4gcHJveHk7XG4gICAgfSxcbiAgICBub3c6IERhdGUubm93LFxuICAgIHN1cHBvcnQ6IHN1cHBvcnRcbiAgfSk7XG4gIGpRdWVyeS5lYWNoKFwiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvclwiLnNwbGl0KFwiIFwiKSwgZnVuY3Rpb24oaSwgbmFtZSkge1xuICAgIGNsYXNzMnR5cGVbXCJbb2JqZWN0IFwiICsgbmFtZSArIFwiXVwiXSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgfSk7XG4gIGZ1bmN0aW9uIGlzQXJyYXlsaWtlKG9iaikge1xuICAgIHZhciBsZW5ndGggPSBvYmoubGVuZ3RoLFxuICAgICAgICB0eXBlID0galF1ZXJ5LnR5cGUob2JqKTtcbiAgICBpZiAodHlwZSA9PT0gXCJmdW5jdGlvblwiIHx8IGpRdWVyeS5pc1dpbmRvdyhvYmopKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChvYmoubm9kZVR5cGUgPT09IDEgJiYgbGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGUgPT09IFwiYXJyYXlcIiB8fCBsZW5ndGggPT09IDAgfHwgdHlwZW9mIGxlbmd0aCA9PT0gXCJudW1iZXJcIiAmJiBsZW5ndGggPiAwICYmIChsZW5ndGggLSAxKSBpbiBvYmo7XG4gIH1cbiAgdmFyIFNpenpsZSA9IChmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB2YXIgaSxcbiAgICAgICAgc3VwcG9ydCxcbiAgICAgICAgRXhwcixcbiAgICAgICAgZ2V0VGV4dCxcbiAgICAgICAgaXNYTUwsXG4gICAgICAgIHRva2VuaXplLFxuICAgICAgICBjb21waWxlLFxuICAgICAgICBzZWxlY3QsXG4gICAgICAgIG91dGVybW9zdENvbnRleHQsXG4gICAgICAgIHNvcnRJbnB1dCxcbiAgICAgICAgaGFzRHVwbGljYXRlLFxuICAgICAgICBzZXREb2N1bWVudCxcbiAgICAgICAgZG9jdW1lbnQsXG4gICAgICAgIGRvY0VsZW0sXG4gICAgICAgIGRvY3VtZW50SXNIVE1MLFxuICAgICAgICByYnVnZ3lRU0EsXG4gICAgICAgIHJidWdneU1hdGNoZXMsXG4gICAgICAgIG1hdGNoZXMsXG4gICAgICAgIGNvbnRhaW5zLFxuICAgICAgICBleHBhbmRvID0gXCJzaXp6bGVcIiArIDEgKiBuZXcgRGF0ZSgpLFxuICAgICAgICBwcmVmZXJyZWREb2MgPSB3aW5kb3cuZG9jdW1lbnQsXG4gICAgICAgIGRpcnJ1bnMgPSAwLFxuICAgICAgICBkb25lID0gMCxcbiAgICAgICAgY2xhc3NDYWNoZSA9IGNyZWF0ZUNhY2hlKCksXG4gICAgICAgIHRva2VuQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLFxuICAgICAgICBjb21waWxlckNhY2hlID0gY3JlYXRlQ2FjaGUoKSxcbiAgICAgICAgc29ydE9yZGVyID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgIGlmIChhID09PSBiKSB7XG4gICAgICAgICAgICBoYXNEdXBsaWNhdGUgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgTUFYX05FR0FUSVZFID0gMSA8PCAzMSxcbiAgICAgICAgaGFzT3duID0gKHt9KS5oYXNPd25Qcm9wZXJ0eSxcbiAgICAgICAgYXJyID0gW10sXG4gICAgICAgIHBvcCA9IGFyci5wb3AsXG4gICAgICAgIHB1c2hfbmF0aXZlID0gYXJyLnB1c2gsXG4gICAgICAgIHB1c2ggPSBhcnIucHVzaCxcbiAgICAgICAgc2xpY2UgPSBhcnIuc2xpY2UsXG4gICAgICAgIGluZGV4T2YgPSBmdW5jdGlvbihsaXN0LCBlbGVtKSB7XG4gICAgICAgICAgdmFyIGkgPSAwLFxuICAgICAgICAgICAgICBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobGlzdFtpXSA9PT0gZWxlbSkge1xuICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9LFxuICAgICAgICBib29sZWFucyA9IFwiY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWRcIixcbiAgICAgICAgd2hpdGVzcGFjZSA9IFwiW1xcXFx4MjBcXFxcdFxcXFxyXFxcXG5cXFxcZl1cIixcbiAgICAgICAgY2hhcmFjdGVyRW5jb2RpbmcgPSBcIig/OlxcXFxcXFxcLnxbXFxcXHctXXxbXlxcXFx4MDAtXFxcXHhhMF0pK1wiLFxuICAgICAgICBpZGVudGlmaWVyID0gY2hhcmFjdGVyRW5jb2RpbmcucmVwbGFjZShcIndcIiwgXCJ3I1wiKSxcbiAgICAgICAgYXR0cmlidXRlcyA9IFwiXFxcXFtcIiArIHdoaXRlc3BhY2UgKyBcIiooXCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArIFwiKSg/OlwiICsgd2hpdGVzcGFjZSArIFwiKihbKl4kfCF+XT89KVwiICsgd2hpdGVzcGFjZSArIFwiKig/OicoKD86XFxcXFxcXFwufFteXFxcXFxcXFwnXSkqKSd8XFxcIigoPzpcXFxcXFxcXC58W15cXFxcXFxcXFxcXCJdKSopXFxcInwoXCIgKyBpZGVudGlmaWVyICsgXCIpKXwpXCIgKyB3aGl0ZXNwYWNlICsgXCIqXFxcXF1cIixcbiAgICAgICAgcHNldWRvcyA9IFwiOihcIiArIGNoYXJhY3RlckVuY29kaW5nICsgXCIpKD86XFxcXCgoXCIgKyBcIignKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcJ10pKiknfFxcXCIoKD86XFxcXFxcXFwufFteXFxcXFxcXFxcXFwiXSkqKVxcXCIpfFwiICsgXCIoKD86XFxcXFxcXFwufFteXFxcXFxcXFwoKVtcXFxcXV18XCIgKyBhdHRyaWJ1dGVzICsgXCIpKil8XCIgKyBcIi4qXCIgKyBcIilcXFxcKXwpXCIsXG4gICAgICAgIHJ3aGl0ZXNwYWNlID0gbmV3IFJlZ0V4cCh3aGl0ZXNwYWNlICsgXCIrXCIsIFwiZ1wiKSxcbiAgICAgICAgcnRyaW0gPSBuZXcgUmVnRXhwKFwiXlwiICsgd2hpdGVzcGFjZSArIFwiK3woKD86XnxbXlxcXFxcXFxcXSkoPzpcXFxcXFxcXC4pKilcIiArIHdoaXRlc3BhY2UgKyBcIiskXCIsIFwiZ1wiKSxcbiAgICAgICAgcmNvbW1hID0gbmV3IFJlZ0V4cChcIl5cIiArIHdoaXRlc3BhY2UgKyBcIiosXCIgKyB3aGl0ZXNwYWNlICsgXCIqXCIpLFxuICAgICAgICByY29tYmluYXRvcnMgPSBuZXcgUmVnRXhwKFwiXlwiICsgd2hpdGVzcGFjZSArIFwiKihbPit+XXxcIiArIHdoaXRlc3BhY2UgKyBcIilcIiArIHdoaXRlc3BhY2UgKyBcIipcIiksXG4gICAgICAgIHJhdHRyaWJ1dGVRdW90ZXMgPSBuZXcgUmVnRXhwKFwiPVwiICsgd2hpdGVzcGFjZSArIFwiKihbXlxcXFxdJ1xcXCJdKj8pXCIgKyB3aGl0ZXNwYWNlICsgXCIqXFxcXF1cIiwgXCJnXCIpLFxuICAgICAgICBycHNldWRvID0gbmV3IFJlZ0V4cChwc2V1ZG9zKSxcbiAgICAgICAgcmlkZW50aWZpZXIgPSBuZXcgUmVnRXhwKFwiXlwiICsgaWRlbnRpZmllciArIFwiJFwiKSxcbiAgICAgICAgbWF0Y2hFeHByID0ge1xuICAgICAgICAgIFwiSURcIjogbmV3IFJlZ0V4cChcIl4jKFwiICsgY2hhcmFjdGVyRW5jb2RpbmcgKyBcIilcIiksXG4gICAgICAgICAgXCJDTEFTU1wiOiBuZXcgUmVnRXhwKFwiXlxcXFwuKFwiICsgY2hhcmFjdGVyRW5jb2RpbmcgKyBcIilcIiksXG4gICAgICAgICAgXCJUQUdcIjogbmV3IFJlZ0V4cChcIl4oXCIgKyBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKFwid1wiLCBcIncqXCIpICsgXCIpXCIpLFxuICAgICAgICAgIFwiQVRUUlwiOiBuZXcgUmVnRXhwKFwiXlwiICsgYXR0cmlidXRlcyksXG4gICAgICAgICAgXCJQU0VVRE9cIjogbmV3IFJlZ0V4cChcIl5cIiArIHBzZXVkb3MpLFxuICAgICAgICAgIFwiQ0hJTERcIjogbmV3IFJlZ0V4cChcIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcXFwoXCIgKyB3aGl0ZXNwYWNlICsgXCIqKGV2ZW58b2RkfCgoWystXXwpKFxcXFxkKilufClcIiArIHdoaXRlc3BhY2UgKyBcIiooPzooWystXXwpXCIgKyB3aGl0ZXNwYWNlICsgXCIqKFxcXFxkKyl8KSlcIiArIHdoaXRlc3BhY2UgKyBcIipcXFxcKXwpXCIsIFwiaVwiKSxcbiAgICAgICAgICBcImJvb2xcIjogbmV3IFJlZ0V4cChcIl4oPzpcIiArIGJvb2xlYW5zICsgXCIpJFwiLCBcImlcIiksXG4gICAgICAgICAgXCJuZWVkc0NvbnRleHRcIjogbmV3IFJlZ0V4cChcIl5cIiArIHdoaXRlc3BhY2UgKyBcIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcXFwoXCIgKyB3aGl0ZXNwYWNlICsgXCIqKCg/Oi1cXFxcZCk/XFxcXGQqKVwiICsgd2hpdGVzcGFjZSArIFwiKlxcXFwpfCkoPz1bXi1dfCQpXCIsIFwiaVwiKVxuICAgICAgICB9LFxuICAgICAgICByaW5wdXRzID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaSxcbiAgICAgICAgcmhlYWRlciA9IC9eaFxcZCQvaSxcbiAgICAgICAgcm5hdGl2ZSA9IC9eW157XStcXHtcXHMqXFxbbmF0aXZlIFxcdy8sXG4gICAgICAgIHJxdWlja0V4cHIgPSAvXig/OiMoW1xcdy1dKyl8KFxcdyspfFxcLihbXFx3LV0rKSkkLyxcbiAgICAgICAgcnNpYmxpbmcgPSAvWyt+XS8sXG4gICAgICAgIHJlc2NhcGUgPSAvJ3xcXFxcL2csXG4gICAgICAgIHJ1bmVzY2FwZSA9IG5ldyBSZWdFeHAoXCJcXFxcXFxcXChbXFxcXGRhLWZdezEsNn1cIiArIHdoaXRlc3BhY2UgKyBcIj98KFwiICsgd2hpdGVzcGFjZSArIFwiKXwuKVwiLCBcImlnXCIpLFxuICAgICAgICBmdW5lc2NhcGUgPSBmdW5jdGlvbihfLCBlc2NhcGVkLCBlc2NhcGVkV2hpdGVzcGFjZSkge1xuICAgICAgICAgIHZhciBoaWdoID0gXCIweFwiICsgZXNjYXBlZCAtIDB4MTAwMDA7XG4gICAgICAgICAgcmV0dXJuIGhpZ2ggIT09IGhpZ2ggfHwgZXNjYXBlZFdoaXRlc3BhY2UgPyBlc2NhcGVkIDogaGlnaCA8IDAgPyBTdHJpbmcuZnJvbUNoYXJDb2RlKGhpZ2ggKyAweDEwMDAwKSA6IFN0cmluZy5mcm9tQ2hhckNvZGUoaGlnaCA+PiAxMCB8IDB4RDgwMCwgaGlnaCAmIDB4M0ZGIHwgMHhEQzAwKTtcbiAgICAgICAgfSxcbiAgICAgICAgdW5sb2FkSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNldERvY3VtZW50KCk7XG4gICAgICAgIH07XG4gICAgdHJ5IHtcbiAgICAgIHB1c2guYXBwbHkoKGFyciA9IHNsaWNlLmNhbGwocHJlZmVycmVkRG9jLmNoaWxkTm9kZXMpKSwgcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMpO1xuICAgICAgYXJyW3ByZWZlcnJlZERvYy5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcHVzaCA9IHthcHBseTogYXJyLmxlbmd0aCA/IGZ1bmN0aW9uKHRhcmdldCwgZWxzKSB7XG4gICAgICAgICAgcHVzaF9uYXRpdmUuYXBwbHkodGFyZ2V0LCBzbGljZS5jYWxsKGVscykpO1xuICAgICAgICB9IDogZnVuY3Rpb24odGFyZ2V0LCBlbHMpIHtcbiAgICAgICAgICB2YXIgaiA9IHRhcmdldC5sZW5ndGgsXG4gICAgICAgICAgICAgIGkgPSAwO1xuICAgICAgICAgIHdoaWxlICgodGFyZ2V0W2orK10gPSBlbHNbaSsrXSkpIHt9XG4gICAgICAgICAgdGFyZ2V0Lmxlbmd0aCA9IGogLSAxO1xuICAgICAgICB9fTtcbiAgICB9XG4gICAgZnVuY3Rpb24gU2l6emxlKHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkKSB7XG4gICAgICB2YXIgbWF0Y2gsXG4gICAgICAgICAgZWxlbSxcbiAgICAgICAgICBtLFxuICAgICAgICAgIG5vZGVUeXBlLFxuICAgICAgICAgIGksXG4gICAgICAgICAgZ3JvdXBzLFxuICAgICAgICAgIG9sZCxcbiAgICAgICAgICBuaWQsXG4gICAgICAgICAgbmV3Q29udGV4dCxcbiAgICAgICAgICBuZXdTZWxlY3RvcjtcbiAgICAgIGlmICgoY29udGV4dCA/IGNvbnRleHQub3duZXJEb2N1bWVudCB8fCBjb250ZXh0IDogcHJlZmVycmVkRG9jKSAhPT0gZG9jdW1lbnQpIHtcbiAgICAgICAgc2V0RG9jdW1lbnQoY29udGV4dCk7XG4gICAgICB9XG4gICAgICBjb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDtcbiAgICAgIHJlc3VsdHMgPSByZXN1bHRzIHx8IFtdO1xuICAgICAgbm9kZVR5cGUgPSBjb250ZXh0Lm5vZGVUeXBlO1xuICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciAhPT0gXCJzdHJpbmdcIiB8fCAhc2VsZWN0b3IgfHwgbm9kZVR5cGUgIT09IDEgJiYgbm9kZVR5cGUgIT09IDkgJiYgbm9kZVR5cGUgIT09IDExKSB7XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgfVxuICAgICAgaWYgKCFzZWVkICYmIGRvY3VtZW50SXNIVE1MKSB7XG4gICAgICAgIGlmIChub2RlVHlwZSAhPT0gMTEgJiYgKG1hdGNoID0gcnF1aWNrRXhwci5leGVjKHNlbGVjdG9yKSkpIHtcbiAgICAgICAgICBpZiAoKG0gPSBtYXRjaFsxXSkpIHtcbiAgICAgICAgICAgIGlmIChub2RlVHlwZSA9PT0gOSkge1xuICAgICAgICAgICAgICBlbGVtID0gY29udGV4dC5nZXRFbGVtZW50QnlJZChtKTtcbiAgICAgICAgICAgICAgaWYgKGVsZW0gJiYgZWxlbS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW0uaWQgPT09IG0pIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChlbGVtKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKGNvbnRleHQub3duZXJEb2N1bWVudCAmJiAoZWxlbSA9IGNvbnRleHQub3duZXJEb2N1bWVudC5nZXRFbGVtZW50QnlJZChtKSkgJiYgY29udGFpbnMoY29udGV4dCwgZWxlbSkgJiYgZWxlbS5pZCA9PT0gbSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChlbGVtKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2hbMl0pIHtcbiAgICAgICAgICAgIHB1c2guYXBwbHkocmVzdWx0cywgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZShzZWxlY3RvcikpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICAgICAgfSBlbHNlIGlmICgobSA9IG1hdGNoWzNdKSAmJiBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHB1c2guYXBwbHkocmVzdWx0cywgY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG0pKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3VwcG9ydC5xc2EgJiYgKCFyYnVnZ3lRU0EgfHwgIXJidWdneVFTQS50ZXN0KHNlbGVjdG9yKSkpIHtcbiAgICAgICAgICBuaWQgPSBvbGQgPSBleHBhbmRvO1xuICAgICAgICAgIG5ld0NvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICAgIG5ld1NlbGVjdG9yID0gbm9kZVR5cGUgIT09IDEgJiYgc2VsZWN0b3I7XG4gICAgICAgICAgaWYgKG5vZGVUeXBlID09PSAxICYmIGNvbnRleHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgZ3JvdXBzID0gdG9rZW5pemUoc2VsZWN0b3IpO1xuICAgICAgICAgICAgaWYgKChvbGQgPSBjb250ZXh0LmdldEF0dHJpYnV0ZShcImlkXCIpKSkge1xuICAgICAgICAgICAgICBuaWQgPSBvbGQucmVwbGFjZShyZXNjYXBlLCBcIlxcXFwkJlwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnRleHQuc2V0QXR0cmlidXRlKFwiaWRcIiwgbmlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5pZCA9IFwiW2lkPSdcIiArIG5pZCArIFwiJ10gXCI7XG4gICAgICAgICAgICBpID0gZ3JvdXBzLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgZ3JvdXBzW2ldID0gbmlkICsgdG9TZWxlY3Rvcihncm91cHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3Q29udGV4dCA9IHJzaWJsaW5nLnRlc3Qoc2VsZWN0b3IpICYmIHRlc3RDb250ZXh0KGNvbnRleHQucGFyZW50Tm9kZSkgfHwgY29udGV4dDtcbiAgICAgICAgICAgIG5ld1NlbGVjdG9yID0gZ3JvdXBzLmpvaW4oXCIsXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobmV3U2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHB1c2guYXBwbHkocmVzdWx0cywgbmV3Q29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKG5ld1NlbGVjdG9yKSk7XG4gICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgICAgfSBjYXRjaCAocXNhRXJyb3IpIHt9IGZpbmFsbHkge1xuICAgICAgICAgICAgICBpZiAoIW9sZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQucmVtb3ZlQXR0cmlidXRlKFwiaWRcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBzZWxlY3Qoc2VsZWN0b3IucmVwbGFjZShydHJpbSwgXCIkMVwiKSwgY29udGV4dCwgcmVzdWx0cywgc2VlZCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCkge1xuICAgICAgdmFyIGtleXMgPSBbXTtcbiAgICAgIGZ1bmN0aW9uIGNhY2hlKGtleSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKGtleXMucHVzaChrZXkgKyBcIiBcIikgPiBFeHByLmNhY2hlTGVuZ3RoKSB7XG4gICAgICAgICAgZGVsZXRlIGNhY2hlW2tleXMuc2hpZnQoKV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChjYWNoZVtrZXkgKyBcIiBcIl0gPSB2YWx1ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY2FjaGU7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG1hcmtGdW5jdGlvbihmbikge1xuICAgICAgZm5bZXhwYW5kb10gPSB0cnVlO1xuICAgICAgcmV0dXJuIGZuO1xuICAgIH1cbiAgICBmdW5jdGlvbiBhc3NlcnQoZm4pIHtcbiAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuICEhZm4oZGl2KTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGRpdi5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgZGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGl2KTtcbiAgICAgICAgfVxuICAgICAgICBkaXYgPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBhZGRIYW5kbGUoYXR0cnMsIGhhbmRsZXIpIHtcbiAgICAgIHZhciBhcnIgPSBhdHRycy5zcGxpdChcInxcIiksXG4gICAgICAgICAgaSA9IGF0dHJzLmxlbmd0aDtcbiAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgRXhwci5hdHRySGFuZGxlW2FycltpXV0gPSBoYW5kbGVyO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzaWJsaW5nQ2hlY2soYSwgYikge1xuICAgICAgdmFyIGN1ciA9IGIgJiYgYSxcbiAgICAgICAgICBkaWZmID0gY3VyICYmIGEubm9kZVR5cGUgPT09IDEgJiYgYi5ub2RlVHlwZSA9PT0gMSAmJiAofmIuc291cmNlSW5kZXggfHwgTUFYX05FR0FUSVZFKSAtICh+YS5zb3VyY2VJbmRleCB8fCBNQVhfTkVHQVRJVkUpO1xuICAgICAgaWYgKGRpZmYpIHtcbiAgICAgICAgcmV0dXJuIGRpZmY7XG4gICAgICB9XG4gICAgICBpZiAoY3VyKSB7XG4gICAgICAgIHdoaWxlICgoY3VyID0gY3VyLm5leHRTaWJsaW5nKSkge1xuICAgICAgICAgIGlmIChjdXIgPT09IGIpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBhID8gMSA6IC0xO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVJbnB1dFBzZXVkbyh0eXBlKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICB2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgcmV0dXJuIG5hbWUgPT09IFwiaW5wdXRcIiAmJiBlbGVtLnR5cGUgPT09IHR5cGU7XG4gICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVCdXR0b25Qc2V1ZG8odHlwZSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHJldHVybiAobmFtZSA9PT0gXCJpbnB1dFwiIHx8IG5hbWUgPT09IFwiYnV0dG9uXCIpICYmIGVsZW0udHlwZSA9PT0gdHlwZTtcbiAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZm4pIHtcbiAgICAgIHJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oYXJndW1lbnQpIHtcbiAgICAgICAgYXJndW1lbnQgPSArYXJndW1lbnQ7XG4gICAgICAgIHJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VlZCwgbWF0Y2hlcykge1xuICAgICAgICAgIHZhciBqLFxuICAgICAgICAgICAgICBtYXRjaEluZGV4ZXMgPSBmbihbXSwgc2VlZC5sZW5ndGgsIGFyZ3VtZW50KSxcbiAgICAgICAgICAgICAgaSA9IG1hdGNoSW5kZXhlcy5sZW5ndGg7XG4gICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgaWYgKHNlZWRbKGogPSBtYXRjaEluZGV4ZXNbaV0pXSkge1xuICAgICAgICAgICAgICBzZWVkW2pdID0gIShtYXRjaGVzW2pdID0gc2VlZFtqXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0ZXN0Q29udGV4dChjb250ZXh0KSB7XG4gICAgICByZXR1cm4gY29udGV4dCAmJiB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjb250ZXh0O1xuICAgIH1cbiAgICBzdXBwb3J0ID0gU2l6emxlLnN1cHBvcnQgPSB7fTtcbiAgICBpc1hNTCA9IFNpenpsZS5pc1hNTCA9IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIHZhciBkb2N1bWVudEVsZW1lbnQgPSBlbGVtICYmIChlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSkuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgcmV0dXJuIGRvY3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gXCJIVE1MXCIgOiBmYWxzZTtcbiAgICB9O1xuICAgIHNldERvY3VtZW50ID0gU2l6emxlLnNldERvY3VtZW50ID0gZnVuY3Rpb24obm9kZSkge1xuICAgICAgdmFyIGhhc0NvbXBhcmUsXG4gICAgICAgICAgcGFyZW50LFxuICAgICAgICAgIGRvYyA9IG5vZGUgPyBub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSA6IHByZWZlcnJlZERvYztcbiAgICAgIGlmIChkb2MgPT09IGRvY3VtZW50IHx8IGRvYy5ub2RlVHlwZSAhPT0gOSB8fCAhZG9jLmRvY3VtZW50RWxlbWVudCkge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQ7XG4gICAgICB9XG4gICAgICBkb2N1bWVudCA9IGRvYztcbiAgICAgIGRvY0VsZW0gPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgcGFyZW50ID0gZG9jLmRlZmF1bHRWaWV3O1xuICAgICAgaWYgKHBhcmVudCAmJiBwYXJlbnQgIT09IHBhcmVudC50b3ApIHtcbiAgICAgICAgaWYgKHBhcmVudC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgcGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ1bmxvYWRcIiwgdW5sb2FkSGFuZGxlciwgZmFsc2UpO1xuICAgICAgICB9IGVsc2UgaWYgKHBhcmVudC5hdHRhY2hFdmVudCkge1xuICAgICAgICAgIHBhcmVudC5hdHRhY2hFdmVudChcIm9udW5sb2FkXCIsIHVubG9hZEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBkb2N1bWVudElzSFRNTCA9ICFpc1hNTChkb2MpO1xuICAgICAgc3VwcG9ydC5hdHRyaWJ1dGVzID0gYXNzZXJ0KGZ1bmN0aW9uKGRpdikge1xuICAgICAgICBkaXYuY2xhc3NOYW1lID0gXCJpXCI7XG4gICAgICAgIHJldHVybiAhZGl2LmdldEF0dHJpYnV0ZShcImNsYXNzTmFtZVwiKTtcbiAgICAgIH0pO1xuICAgICAgc3VwcG9ydC5nZXRFbGVtZW50c0J5VGFnTmFtZSA9IGFzc2VydChmdW5jdGlvbihkaXYpIHtcbiAgICAgICAgZGl2LmFwcGVuZENoaWxkKGRvYy5jcmVhdGVDb21tZW50KFwiXCIpKTtcbiAgICAgICAgcmV0dXJuICFkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpLmxlbmd0aDtcbiAgICAgIH0pO1xuICAgICAgc3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gcm5hdGl2ZS50ZXN0KGRvYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKTtcbiAgICAgIHN1cHBvcnQuZ2V0QnlJZCA9IGFzc2VydChmdW5jdGlvbihkaXYpIHtcbiAgICAgICAgZG9jRWxlbS5hcHBlbmRDaGlsZChkaXYpLmlkID0gZXhwYW5kbztcbiAgICAgICAgcmV0dXJuICFkb2MuZ2V0RWxlbWVudHNCeU5hbWUgfHwgIWRvYy5nZXRFbGVtZW50c0J5TmFtZShleHBhbmRvKS5sZW5ndGg7XG4gICAgICB9KTtcbiAgICAgIGlmIChzdXBwb3J0LmdldEJ5SWQpIHtcbiAgICAgICAgRXhwci5maW5kW1wiSURcIl0gPSBmdW5jdGlvbihpZCwgY29udGV4dCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50QnlJZCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBkb2N1bWVudElzSFRNTCkge1xuICAgICAgICAgICAgdmFyIG0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICAgICAgICAgIHJldHVybiBtICYmIG0ucGFyZW50Tm9kZSA/IFttXSA6IFtdO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRXhwci5maWx0ZXJbXCJJRFwiXSA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgICAgdmFyIGF0dHJJZCA9IGlkLnJlcGxhY2UocnVuZXNjYXBlLCBmdW5lc2NhcGUpO1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoXCJpZFwiKSA9PT0gYXR0cklkO1xuICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZWxldGUgRXhwci5maW5kW1wiSURcIl07XG4gICAgICAgIEV4cHIuZmlsdGVyW1wiSURcIl0gPSBmdW5jdGlvbihpZCkge1xuICAgICAgICAgIHZhciBhdHRySWQgPSBpZC5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgICAgdmFyIG5vZGUgPSB0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlICE9PSBcInVuZGVmaW5lZFwiICYmIGVsZW0uZ2V0QXR0cmlidXRlTm9kZShcImlkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG5vZGUgJiYgbm9kZS52YWx1ZSA9PT0gYXR0cklkO1xuICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBFeHByLmZpbmRbXCJUQUdcIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lID8gZnVuY3Rpb24odGFnLCBjb250ZXh0KSB7XG4gICAgICAgIGlmICh0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZyk7XG4gICAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5xc2EpIHtcbiAgICAgICAgICByZXR1cm4gY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKHRhZyk7XG4gICAgICAgIH1cbiAgICAgIH0gOiBmdW5jdGlvbih0YWcsIGNvbnRleHQpIHtcbiAgICAgICAgdmFyIGVsZW0sXG4gICAgICAgICAgICB0bXAgPSBbXSxcbiAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgcmVzdWx0cyA9IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnKTtcbiAgICAgICAgaWYgKHRhZyA9PT0gXCIqXCIpIHtcbiAgICAgICAgICB3aGlsZSAoKGVsZW0gPSByZXN1bHRzW2krK10pKSB7XG4gICAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICAgICAgICB0bXAucHVzaChlbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRtcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgIH07XG4gICAgICBFeHByLmZpbmRbXCJDTEFTU1wiXSA9IHN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJiBmdW5jdGlvbihjbGFzc05hbWUsIGNvbnRleHQpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50SXNIVE1MKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc05hbWUpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgcmJ1Z2d5TWF0Y2hlcyA9IFtdO1xuICAgICAgcmJ1Z2d5UVNBID0gW107XG4gICAgICBpZiAoKHN1cHBvcnQucXNhID0gcm5hdGl2ZS50ZXN0KGRvYy5xdWVyeVNlbGVjdG9yQWxsKSkpIHtcbiAgICAgICAgYXNzZXJ0KGZ1bmN0aW9uKGRpdikge1xuICAgICAgICAgIGRvY0VsZW0uYXBwZW5kQ2hpbGQoZGl2KS5pbm5lckhUTUwgPSBcIjxhIGlkPSdcIiArIGV4cGFuZG8gKyBcIic+PC9hPlwiICsgXCI8c2VsZWN0IGlkPSdcIiArIGV4cGFuZG8gKyBcIi1cXGZdJyBtc2FsbG93Y2FwdHVyZT0nJz5cIiArIFwiPG9wdGlvbiBzZWxlY3RlZD0nJz48L29wdGlvbj48L3NlbGVjdD5cIjtcbiAgICAgICAgICBpZiAoZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbbXNhbGxvd2NhcHR1cmVePScnXVwiKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJidWdneVFTQS5wdXNoKFwiWypeJF09XCIgKyB3aGl0ZXNwYWNlICsgXCIqKD86Jyd8XFxcIlxcXCIpXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWRpdi5xdWVyeVNlbGVjdG9yQWxsKFwiW3NlbGVjdGVkXVwiKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJidWdneVFTQS5wdXNoKFwiXFxcXFtcIiArIHdoaXRlc3BhY2UgKyBcIiooPzp2YWx1ZXxcIiArIGJvb2xlYW5zICsgXCIpXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWRpdi5xdWVyeVNlbGVjdG9yQWxsKFwiW2lkfj1cIiArIGV4cGFuZG8gKyBcIi1dXCIpLmxlbmd0aCkge1xuICAgICAgICAgICAgcmJ1Z2d5UVNBLnB1c2goXCJ+PVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFkaXYucXVlcnlTZWxlY3RvckFsbChcIjpjaGVja2VkXCIpLmxlbmd0aCkge1xuICAgICAgICAgICAgcmJ1Z2d5UVNBLnB1c2goXCI6Y2hlY2tlZFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFkaXYucXVlcnlTZWxlY3RvckFsbChcImEjXCIgKyBleHBhbmRvICsgXCIrKlwiKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJidWdneVFTQS5wdXNoKFwiLiMuK1srfl1cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgYXNzZXJ0KGZ1bmN0aW9uKGRpdikge1xuICAgICAgICAgIHZhciBpbnB1dCA9IGRvYy5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImhpZGRlblwiKTtcbiAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoaW5wdXQpLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJEXCIpO1xuICAgICAgICAgIGlmIChkaXYucXVlcnlTZWxlY3RvckFsbChcIltuYW1lPWRdXCIpLmxlbmd0aCkge1xuICAgICAgICAgICAgcmJ1Z2d5UVNBLnB1c2goXCJuYW1lXCIgKyB3aGl0ZXNwYWNlICsgXCIqWypeJHwhfl0/PVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFkaXYucXVlcnlTZWxlY3RvckFsbChcIjplbmFibGVkXCIpLmxlbmd0aCkge1xuICAgICAgICAgICAgcmJ1Z2d5UVNBLnB1c2goXCI6ZW5hYmxlZFwiLCBcIjpkaXNhYmxlZFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoXCIqLDp4XCIpO1xuICAgICAgICAgIHJidWdneVFTQS5wdXNoKFwiLC4qOlwiKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoKHN1cHBvcnQubWF0Y2hlc1NlbGVjdG9yID0gcm5hdGl2ZS50ZXN0KChtYXRjaGVzID0gZG9jRWxlbS5tYXRjaGVzIHx8IGRvY0VsZW0ud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8IGRvY0VsZW0ubW96TWF0Y2hlc1NlbGVjdG9yIHx8IGRvY0VsZW0ub01hdGNoZXNTZWxlY3RvciB8fCBkb2NFbGVtLm1zTWF0Y2hlc1NlbGVjdG9yKSkpKSB7XG4gICAgICAgIGFzc2VydChmdW5jdGlvbihkaXYpIHtcbiAgICAgICAgICBzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoID0gbWF0Y2hlcy5jYWxsKGRpdiwgXCJkaXZcIik7XG4gICAgICAgICAgbWF0Y2hlcy5jYWxsKGRpdiwgXCJbcyE9JyddOnhcIik7XG4gICAgICAgICAgcmJ1Z2d5TWF0Y2hlcy5wdXNoKFwiIT1cIiwgcHNldWRvcyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmJ1Z2d5UVNBID0gcmJ1Z2d5UVNBLmxlbmd0aCAmJiBuZXcgUmVnRXhwKHJidWdneVFTQS5qb2luKFwifFwiKSk7XG4gICAgICByYnVnZ3lNYXRjaGVzID0gcmJ1Z2d5TWF0Y2hlcy5sZW5ndGggJiYgbmV3IFJlZ0V4cChyYnVnZ3lNYXRjaGVzLmpvaW4oXCJ8XCIpKTtcbiAgICAgIGhhc0NvbXBhcmUgPSBybmF0aXZlLnRlc3QoZG9jRWxlbS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbik7XG4gICAgICBjb250YWlucyA9IGhhc0NvbXBhcmUgfHwgcm5hdGl2ZS50ZXN0KGRvY0VsZW0uY29udGFpbnMpID8gZnVuY3Rpb24oYSwgYikge1xuICAgICAgICB2YXIgYWRvd24gPSBhLm5vZGVUeXBlID09PSA5ID8gYS5kb2N1bWVudEVsZW1lbnQgOiBhLFxuICAgICAgICAgICAgYnVwID0gYiAmJiBiLnBhcmVudE5vZGU7XG4gICAgICAgIHJldHVybiBhID09PSBidXAgfHwgISEoYnVwICYmIGJ1cC5ub2RlVHlwZSA9PT0gMSAmJiAoYWRvd24uY29udGFpbnMgPyBhZG93bi5jb250YWlucyhidXApIDogYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiAmJiBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGJ1cCkgJiAxNikpO1xuICAgICAgfSA6IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgaWYgKGIpIHtcbiAgICAgICAgICB3aGlsZSAoKGIgPSBiLnBhcmVudE5vZGUpKSB7XG4gICAgICAgICAgICBpZiAoYiA9PT0gYSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIHNvcnRPcmRlciA9IGhhc0NvbXBhcmUgPyBmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgIGlmIChhID09PSBiKSB7XG4gICAgICAgICAgaGFzRHVwbGljYXRlID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29tcGFyZSA9ICFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIC0gIWIuY29tcGFyZURvY3VtZW50UG9zaXRpb247XG4gICAgICAgIGlmIChjb21wYXJlKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbXBhcmU7XG4gICAgICAgIH1cbiAgICAgICAgY29tcGFyZSA9IChhLm93bmVyRG9jdW1lbnQgfHwgYSkgPT09IChiLm93bmVyRG9jdW1lbnQgfHwgYikgPyBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGIpIDogMTtcbiAgICAgICAgaWYgKGNvbXBhcmUgJiAxIHx8ICghc3VwcG9ydC5zb3J0RGV0YWNoZWQgJiYgYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihhKSA9PT0gY29tcGFyZSkpIHtcbiAgICAgICAgICBpZiAoYSA9PT0gZG9jIHx8IGEub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYSkpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGIgPT09IGRvYyB8fCBiLm93bmVyRG9jdW1lbnQgPT09IHByZWZlcnJlZERvYyAmJiBjb250YWlucyhwcmVmZXJyZWREb2MsIGIpKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHNvcnRJbnB1dCA/IChpbmRleE9mKHNvcnRJbnB1dCwgYSkgLSBpbmRleE9mKHNvcnRJbnB1dCwgYikpIDogMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tcGFyZSAmIDQgPyAtMSA6IDE7XG4gICAgICB9IDogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICBpZiAoYSA9PT0gYikge1xuICAgICAgICAgIGhhc0R1cGxpY2F0ZSA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cixcbiAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgYXVwID0gYS5wYXJlbnROb2RlLFxuICAgICAgICAgICAgYnVwID0gYi5wYXJlbnROb2RlLFxuICAgICAgICAgICAgYXAgPSBbYV0sXG4gICAgICAgICAgICBicCA9IFtiXTtcbiAgICAgICAgaWYgKCFhdXAgfHwgIWJ1cCkge1xuICAgICAgICAgIHJldHVybiBhID09PSBkb2MgPyAtMSA6IGIgPT09IGRvYyA/IDEgOiBhdXAgPyAtMSA6IGJ1cCA/IDEgOiBzb3J0SW5wdXQgPyAoaW5kZXhPZihzb3J0SW5wdXQsIGEpIC0gaW5kZXhPZihzb3J0SW5wdXQsIGIpKSA6IDA7XG4gICAgICAgIH0gZWxzZSBpZiAoYXVwID09PSBidXApIHtcbiAgICAgICAgICByZXR1cm4gc2libGluZ0NoZWNrKGEsIGIpO1xuICAgICAgICB9XG4gICAgICAgIGN1ciA9IGE7XG4gICAgICAgIHdoaWxlICgoY3VyID0gY3VyLnBhcmVudE5vZGUpKSB7XG4gICAgICAgICAgYXAudW5zaGlmdChjdXIpO1xuICAgICAgICB9XG4gICAgICAgIGN1ciA9IGI7XG4gICAgICAgIHdoaWxlICgoY3VyID0gY3VyLnBhcmVudE5vZGUpKSB7XG4gICAgICAgICAgYnAudW5zaGlmdChjdXIpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChhcFtpXSA9PT0gYnBbaV0pIHtcbiAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGkgPyBzaWJsaW5nQ2hlY2soYXBbaV0sIGJwW2ldKSA6IGFwW2ldID09PSBwcmVmZXJyZWREb2MgPyAtMSA6IGJwW2ldID09PSBwcmVmZXJyZWREb2MgPyAxIDogMDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gZG9jO1xuICAgIH07XG4gICAgU2l6emxlLm1hdGNoZXMgPSBmdW5jdGlvbihleHByLCBlbGVtZW50cykge1xuICAgICAgcmV0dXJuIFNpenpsZShleHByLCBudWxsLCBudWxsLCBlbGVtZW50cyk7XG4gICAgfTtcbiAgICBTaXp6bGUubWF0Y2hlc1NlbGVjdG9yID0gZnVuY3Rpb24oZWxlbSwgZXhwcikge1xuICAgICAgaWYgKChlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSkgIT09IGRvY3VtZW50KSB7XG4gICAgICAgIHNldERvY3VtZW50KGVsZW0pO1xuICAgICAgfVxuICAgICAgZXhwciA9IGV4cHIucmVwbGFjZShyYXR0cmlidXRlUXVvdGVzLCBcIj0nJDEnXVwiKTtcbiAgICAgIGlmIChzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciAmJiBkb2N1bWVudElzSFRNTCAmJiAoIXJidWdneU1hdGNoZXMgfHwgIXJidWdneU1hdGNoZXMudGVzdChleHByKSkgJiYgKCFyYnVnZ3lRU0EgfHwgIXJidWdneVFTQS50ZXN0KGV4cHIpKSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhciByZXQgPSBtYXRjaGVzLmNhbGwoZWxlbSwgZXhwcik7XG4gICAgICAgICAgaWYgKHJldCB8fCBzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoIHx8IGVsZW0uZG9jdW1lbnQgJiYgZWxlbS5kb2N1bWVudC5ub2RlVHlwZSAhPT0gMTEpIHtcbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgfVxuICAgICAgcmV0dXJuIFNpenpsZShleHByLCBkb2N1bWVudCwgbnVsbCwgW2VsZW1dKS5sZW5ndGggPiAwO1xuICAgIH07XG4gICAgU2l6emxlLmNvbnRhaW5zID0gZnVuY3Rpb24oY29udGV4dCwgZWxlbSkge1xuICAgICAgaWYgKChjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCkgIT09IGRvY3VtZW50KSB7XG4gICAgICAgIHNldERvY3VtZW50KGNvbnRleHQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbnRhaW5zKGNvbnRleHQsIGVsZW0pO1xuICAgIH07XG4gICAgU2l6emxlLmF0dHIgPSBmdW5jdGlvbihlbGVtLCBuYW1lKSB7XG4gICAgICBpZiAoKGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtKSAhPT0gZG9jdW1lbnQpIHtcbiAgICAgICAgc2V0RG9jdW1lbnQoZWxlbSk7XG4gICAgICB9XG4gICAgICB2YXIgZm4gPSBFeHByLmF0dHJIYW5kbGVbbmFtZS50b0xvd2VyQ2FzZSgpXSxcbiAgICAgICAgICB2YWwgPSBmbiAmJiBoYXNPd24uY2FsbChFeHByLmF0dHJIYW5kbGUsIG5hbWUudG9Mb3dlckNhc2UoKSkgPyBmbihlbGVtLCBuYW1lLCAhZG9jdW1lbnRJc0hUTUwpIDogdW5kZWZpbmVkO1xuICAgICAgcmV0dXJuIHZhbCAhPT0gdW5kZWZpbmVkID8gdmFsIDogc3VwcG9ydC5hdHRyaWJ1dGVzIHx8ICFkb2N1bWVudElzSFRNTCA/IGVsZW0uZ2V0QXR0cmlidXRlKG5hbWUpIDogKHZhbCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKSkgJiYgdmFsLnNwZWNpZmllZCA/IHZhbC52YWx1ZSA6IG51bGw7XG4gICAgfTtcbiAgICBTaXp6bGUuZXJyb3IgPSBmdW5jdGlvbihtc2cpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246IFwiICsgbXNnKTtcbiAgICB9O1xuICAgIFNpenpsZS51bmlxdWVTb3J0ID0gZnVuY3Rpb24ocmVzdWx0cykge1xuICAgICAgdmFyIGVsZW0sXG4gICAgICAgICAgZHVwbGljYXRlcyA9IFtdLFxuICAgICAgICAgIGogPSAwLFxuICAgICAgICAgIGkgPSAwO1xuICAgICAgaGFzRHVwbGljYXRlID0gIXN1cHBvcnQuZGV0ZWN0RHVwbGljYXRlcztcbiAgICAgIHNvcnRJbnB1dCA9ICFzdXBwb3J0LnNvcnRTdGFibGUgJiYgcmVzdWx0cy5zbGljZSgwKTtcbiAgICAgIHJlc3VsdHMuc29ydChzb3J0T3JkZXIpO1xuICAgICAgaWYgKGhhc0R1cGxpY2F0ZSkge1xuICAgICAgICB3aGlsZSAoKGVsZW0gPSByZXN1bHRzW2krK10pKSB7XG4gICAgICAgICAgaWYgKGVsZW0gPT09IHJlc3VsdHNbaV0pIHtcbiAgICAgICAgICAgIGogPSBkdXBsaWNhdGVzLnB1c2goaSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChqLS0pIHtcbiAgICAgICAgICByZXN1bHRzLnNwbGljZShkdXBsaWNhdGVzW2pdLCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgc29ydElucHV0ID0gbnVsbDtcbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH07XG4gICAgZ2V0VGV4dCA9IFNpenpsZS5nZXRUZXh0ID0gZnVuY3Rpb24oZWxlbSkge1xuICAgICAgdmFyIG5vZGUsXG4gICAgICAgICAgcmV0ID0gXCJcIixcbiAgICAgICAgICBpID0gMCxcbiAgICAgICAgICBub2RlVHlwZSA9IGVsZW0ubm9kZVR5cGU7XG4gICAgICBpZiAoIW5vZGVUeXBlKSB7XG4gICAgICAgIHdoaWxlICgobm9kZSA9IGVsZW1baSsrXSkpIHtcbiAgICAgICAgICByZXQgKz0gZ2V0VGV4dChub2RlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChub2RlVHlwZSA9PT0gMSB8fCBub2RlVHlwZSA9PT0gOSB8fCBub2RlVHlwZSA9PT0gMTEpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBlbGVtLnRleHRDb250ZW50ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgcmV0dXJuIGVsZW0udGV4dENvbnRlbnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yIChlbGVtID0gZWxlbS5maXJzdENoaWxkOyBlbGVtOyBlbGVtID0gZWxlbS5uZXh0U2libGluZykge1xuICAgICAgICAgICAgcmV0ICs9IGdldFRleHQoZWxlbSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG5vZGVUeXBlID09PSAzIHx8IG5vZGVUeXBlID09PSA0KSB7XG4gICAgICAgIHJldHVybiBlbGVtLm5vZGVWYWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcbiAgICBFeHByID0gU2l6emxlLnNlbGVjdG9ycyA9IHtcbiAgICAgIGNhY2hlTGVuZ3RoOiA1MCxcbiAgICAgIGNyZWF0ZVBzZXVkbzogbWFya0Z1bmN0aW9uLFxuICAgICAgbWF0Y2g6IG1hdGNoRXhwcixcbiAgICAgIGF0dHJIYW5kbGU6IHt9LFxuICAgICAgZmluZDoge30sXG4gICAgICByZWxhdGl2ZToge1xuICAgICAgICBcIj5cIjoge1xuICAgICAgICAgIGRpcjogXCJwYXJlbnROb2RlXCIsXG4gICAgICAgICAgZmlyc3Q6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgXCIgXCI6IHtkaXI6IFwicGFyZW50Tm9kZVwifSxcbiAgICAgICAgXCIrXCI6IHtcbiAgICAgICAgICBkaXI6IFwicHJldmlvdXNTaWJsaW5nXCIsXG4gICAgICAgICAgZmlyc3Q6IHRydWVcbiAgICAgICAgfSxcbiAgICAgICAgXCJ+XCI6IHtkaXI6IFwicHJldmlvdXNTaWJsaW5nXCJ9XG4gICAgICB9LFxuICAgICAgcHJlRmlsdGVyOiB7XG4gICAgICAgIFwiQVRUUlwiOiBmdW5jdGlvbihtYXRjaCkge1xuICAgICAgICAgIG1hdGNoWzFdID0gbWF0Y2hbMV0ucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSk7XG4gICAgICAgICAgbWF0Y2hbM10gPSAobWF0Y2hbM10gfHwgbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgXCJcIikucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSk7XG4gICAgICAgICAgaWYgKG1hdGNoWzJdID09PSBcIn49XCIpIHtcbiAgICAgICAgICAgIG1hdGNoWzNdID0gXCIgXCIgKyBtYXRjaFszXSArIFwiIFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbWF0Y2guc2xpY2UoMCwgNCk7XG4gICAgICAgIH0sXG4gICAgICAgIFwiQ0hJTERcIjogZnVuY3Rpb24obWF0Y2gpIHtcbiAgICAgICAgICBtYXRjaFsxXSA9IG1hdGNoWzFdLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKG1hdGNoWzFdLnNsaWNlKDAsIDMpID09PSBcIm50aFwiKSB7XG4gICAgICAgICAgICBpZiAoIW1hdGNoWzNdKSB7XG4gICAgICAgICAgICAgIFNpenpsZS5lcnJvcihtYXRjaFswXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXRjaFs0XSA9ICsobWF0Y2hbNF0gPyBtYXRjaFs1XSArIChtYXRjaFs2XSB8fCAxKSA6IDIgKiAobWF0Y2hbM10gPT09IFwiZXZlblwiIHx8IG1hdGNoWzNdID09PSBcIm9kZFwiKSk7XG4gICAgICAgICAgICBtYXRjaFs1XSA9ICsoKG1hdGNoWzddICsgbWF0Y2hbOF0pIHx8IG1hdGNoWzNdID09PSBcIm9kZFwiKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoWzNdKSB7XG4gICAgICAgICAgICBTaXp6bGUuZXJyb3IobWF0Y2hbMF0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbWF0Y2g7XG4gICAgICAgIH0sXG4gICAgICAgIFwiUFNFVURPXCI6IGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgICAgICAgdmFyIGV4Y2VzcyxcbiAgICAgICAgICAgICAgdW5xdW90ZWQgPSAhbWF0Y2hbNl0gJiYgbWF0Y2hbMl07XG4gICAgICAgICAgaWYgKG1hdGNoRXhwcltcIkNISUxEXCJdLnRlc3QobWF0Y2hbMF0pKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG1hdGNoWzNdKSB7XG4gICAgICAgICAgICBtYXRjaFsyXSA9IG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8IFwiXCI7XG4gICAgICAgICAgfSBlbHNlIGlmICh1bnF1b3RlZCAmJiBycHNldWRvLnRlc3QodW5xdW90ZWQpICYmIChleGNlc3MgPSB0b2tlbml6ZSh1bnF1b3RlZCwgdHJ1ZSkpICYmIChleGNlc3MgPSB1bnF1b3RlZC5pbmRleE9mKFwiKVwiLCB1bnF1b3RlZC5sZW5ndGggLSBleGNlc3MpIC0gdW5xdW90ZWQubGVuZ3RoKSkge1xuICAgICAgICAgICAgbWF0Y2hbMF0gPSBtYXRjaFswXS5zbGljZSgwLCBleGNlc3MpO1xuICAgICAgICAgICAgbWF0Y2hbMl0gPSB1bnF1b3RlZC5zbGljZSgwLCBleGNlc3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbWF0Y2guc2xpY2UoMCwgMyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBmaWx0ZXI6IHtcbiAgICAgICAgXCJUQUdcIjogZnVuY3Rpb24obm9kZU5hbWVTZWxlY3Rvcikge1xuICAgICAgICAgIHZhciBub2RlTmFtZSA9IG5vZGVOYW1lU2VsZWN0b3IucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICByZXR1cm4gbm9kZU5hbWVTZWxlY3RvciA9PT0gXCIqXCIgPyBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH0gOiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5vZGVOYW1lO1xuICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIFwiQ0xBU1NcIjogZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG4gICAgICAgICAgdmFyIHBhdHRlcm4gPSBjbGFzc0NhY2hlW2NsYXNzTmFtZSArIFwiIFwiXTtcbiAgICAgICAgICByZXR1cm4gcGF0dGVybiB8fCAocGF0dGVybiA9IG5ldyBSZWdFeHAoXCIoXnxcIiArIHdoaXRlc3BhY2UgKyBcIilcIiArIGNsYXNzTmFtZSArIFwiKFwiICsgd2hpdGVzcGFjZSArIFwifCQpXCIpKSAmJiBjbGFzc0NhY2hlKGNsYXNzTmFtZSwgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm4udGVzdCh0eXBlb2YgZWxlbS5jbGFzc05hbWUgPT09IFwic3RyaW5nXCIgJiYgZWxlbS5jbGFzc05hbWUgfHwgdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlICE9PSBcInVuZGVmaW5lZFwiICYmIGVsZW0uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIikgfHwgXCJcIik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIFwiQVRUUlwiOiBmdW5jdGlvbihuYW1lLCBvcGVyYXRvciwgY2hlY2spIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFNpenpsZS5hdHRyKGVsZW0sIG5hbWUpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvcGVyYXRvciA9PT0gXCIhPVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFvcGVyYXRvcikge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3VsdCArPSBcIlwiO1xuICAgICAgICAgICAgcmV0dXJuIG9wZXJhdG9yID09PSBcIj1cIiA/IHJlc3VsdCA9PT0gY2hlY2sgOiBvcGVyYXRvciA9PT0gXCIhPVwiID8gcmVzdWx0ICE9PSBjaGVjayA6IG9wZXJhdG9yID09PSBcIl49XCIgPyBjaGVjayAmJiByZXN1bHQuaW5kZXhPZihjaGVjaykgPT09IDAgOiBvcGVyYXRvciA9PT0gXCIqPVwiID8gY2hlY2sgJiYgcmVzdWx0LmluZGV4T2YoY2hlY2spID4gLTEgOiBvcGVyYXRvciA9PT0gXCIkPVwiID8gY2hlY2sgJiYgcmVzdWx0LnNsaWNlKC1jaGVjay5sZW5ndGgpID09PSBjaGVjayA6IG9wZXJhdG9yID09PSBcIn49XCIgPyAoXCIgXCIgKyByZXN1bHQucmVwbGFjZShyd2hpdGVzcGFjZSwgXCIgXCIpICsgXCIgXCIpLmluZGV4T2YoY2hlY2spID4gLTEgOiBvcGVyYXRvciA9PT0gXCJ8PVwiID8gcmVzdWx0ID09PSBjaGVjayB8fCByZXN1bHQuc2xpY2UoMCwgY2hlY2subGVuZ3RoICsgMSkgPT09IGNoZWNrICsgXCItXCIgOiBmYWxzZTtcbiAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBcIkNISUxEXCI6IGZ1bmN0aW9uKHR5cGUsIHdoYXQsIGFyZ3VtZW50LCBmaXJzdCwgbGFzdCkge1xuICAgICAgICAgIHZhciBzaW1wbGUgPSB0eXBlLnNsaWNlKDAsIDMpICE9PSBcIm50aFwiLFxuICAgICAgICAgICAgICBmb3J3YXJkID0gdHlwZS5zbGljZSgtNCkgIT09IFwibGFzdFwiLFxuICAgICAgICAgICAgICBvZlR5cGUgPSB3aGF0ID09PSBcIm9mLXR5cGVcIjtcbiAgICAgICAgICByZXR1cm4gZmlyc3QgPT09IDEgJiYgbGFzdCA9PT0gMCA/IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgICAgIHJldHVybiAhIWVsZW0ucGFyZW50Tm9kZTtcbiAgICAgICAgICB9IDogZnVuY3Rpb24oZWxlbSwgY29udGV4dCwgeG1sKSB7XG4gICAgICAgICAgICB2YXIgY2FjaGUsXG4gICAgICAgICAgICAgICAgb3V0ZXJDYWNoZSxcbiAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgIGRpZmYsXG4gICAgICAgICAgICAgICAgbm9kZUluZGV4LFxuICAgICAgICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgICAgICAgIGRpciA9IHNpbXBsZSAhPT0gZm9yd2FyZCA/IFwibmV4dFNpYmxpbmdcIiA6IFwicHJldmlvdXNTaWJsaW5nXCIsXG4gICAgICAgICAgICAgICAgcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlLFxuICAgICAgICAgICAgICAgIG5hbWUgPSBvZlR5cGUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgIHVzZUNhY2hlID0gIXhtbCAmJiAhb2ZUeXBlO1xuICAgICAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgICBpZiAoc2ltcGxlKSB7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGRpcikge1xuICAgICAgICAgICAgICAgICAgbm9kZSA9IGVsZW07XG4gICAgICAgICAgICAgICAgICB3aGlsZSAoKG5vZGUgPSBub2RlW2Rpcl0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvZlR5cGUgPyBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOiBub2RlLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBzdGFydCA9IGRpciA9IHR5cGUgPT09IFwib25seVwiICYmICFzdGFydCAmJiBcIm5leHRTaWJsaW5nXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHN0YXJ0ID0gW2ZvcndhcmQgPyBwYXJlbnQuZmlyc3RDaGlsZCA6IHBhcmVudC5sYXN0Q2hpbGRdO1xuICAgICAgICAgICAgICBpZiAoZm9yd2FyZCAmJiB1c2VDYWNoZSkge1xuICAgICAgICAgICAgICAgIG91dGVyQ2FjaGUgPSBwYXJlbnRbZXhwYW5kb10gfHwgKHBhcmVudFtleHBhbmRvXSA9IHt9KTtcbiAgICAgICAgICAgICAgICBjYWNoZSA9IG91dGVyQ2FjaGVbdHlwZV0gfHwgW107XG4gICAgICAgICAgICAgICAgbm9kZUluZGV4ID0gY2FjaGVbMF0gPT09IGRpcnJ1bnMgJiYgY2FjaGVbMV07XG4gICAgICAgICAgICAgICAgZGlmZiA9IGNhY2hlWzBdID09PSBkaXJydW5zICYmIGNhY2hlWzJdO1xuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlSW5kZXggJiYgcGFyZW50LmNoaWxkTm9kZXNbbm9kZUluZGV4XTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoKG5vZGUgPSArK25vZGVJbmRleCAmJiBub2RlICYmIG5vZGVbZGlyXSB8fCAoZGlmZiA9IG5vZGVJbmRleCA9IDApIHx8IHN0YXJ0LnBvcCgpKSkge1xuICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDEgJiYgKytkaWZmICYmIG5vZGUgPT09IGVsZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0ZXJDYWNoZVt0eXBlXSA9IFtkaXJydW5zLCBub2RlSW5kZXgsIGRpZmZdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAodXNlQ2FjaGUgJiYgKGNhY2hlID0gKGVsZW1bZXhwYW5kb10gfHwgKGVsZW1bZXhwYW5kb10gPSB7fSkpW3R5cGVdKSAmJiBjYWNoZVswXSA9PT0gZGlycnVucykge1xuICAgICAgICAgICAgICAgIGRpZmYgPSBjYWNoZVsxXTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAoKG5vZGUgPSArK25vZGVJbmRleCAmJiBub2RlICYmIG5vZGVbZGlyXSB8fCAoZGlmZiA9IG5vZGVJbmRleCA9IDApIHx8IHN0YXJ0LnBvcCgpKSkge1xuICAgICAgICAgICAgICAgICAgaWYgKChvZlR5cGUgPyBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOiBub2RlLm5vZGVUeXBlID09PSAxKSAmJiArK2RpZmYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZUNhY2hlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgKG5vZGVbZXhwYW5kb10gfHwgKG5vZGVbZXhwYW5kb10gPSB7fSkpW3R5cGVdID0gW2RpcnJ1bnMsIGRpZmZdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlID09PSBlbGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZGlmZiAtPSBsYXN0O1xuICAgICAgICAgICAgICByZXR1cm4gZGlmZiA9PT0gZmlyc3QgfHwgKGRpZmYgJSBmaXJzdCA9PT0gMCAmJiBkaWZmIC8gZmlyc3QgPj0gMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgXCJQU0VVRE9cIjogZnVuY3Rpb24ocHNldWRvLCBhcmd1bWVudCkge1xuICAgICAgICAgIHZhciBhcmdzLFxuICAgICAgICAgICAgICBmbiA9IEV4cHIucHNldWRvc1twc2V1ZG9dIHx8IEV4cHIuc2V0RmlsdGVyc1twc2V1ZG8udG9Mb3dlckNhc2UoKV0gfHwgU2l6emxlLmVycm9yKFwidW5zdXBwb3J0ZWQgcHNldWRvOiBcIiArIHBzZXVkbyk7XG4gICAgICAgICAgaWYgKGZuW2V4cGFuZG9dKSB7XG4gICAgICAgICAgICByZXR1cm4gZm4oYXJndW1lbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZm4ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgYXJncyA9IFtwc2V1ZG8sIHBzZXVkbywgXCJcIiwgYXJndW1lbnRdO1xuICAgICAgICAgICAgcmV0dXJuIEV4cHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShwc2V1ZG8udG9Mb3dlckNhc2UoKSkgPyBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VlZCwgbWF0Y2hlcykge1xuICAgICAgICAgICAgICB2YXIgaWR4LFxuICAgICAgICAgICAgICAgICAgbWF0Y2hlZCA9IGZuKHNlZWQsIGFyZ3VtZW50KSxcbiAgICAgICAgICAgICAgICAgIGkgPSBtYXRjaGVkLmxlbmd0aDtcbiAgICAgICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgICAgIGlkeCA9IGluZGV4T2Yoc2VlZCwgbWF0Y2hlZFtpXSk7XG4gICAgICAgICAgICAgICAgc2VlZFtpZHhdID0gIShtYXRjaGVzW2lkeF0gPSBtYXRjaGVkW2ldKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkgOiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmbihlbGVtLCAwLCBhcmdzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBmbjtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHBzZXVkb3M6IHtcbiAgICAgICAgXCJub3RcIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICAgICAgdmFyIGlucHV0ID0gW10sXG4gICAgICAgICAgICAgIHJlc3VsdHMgPSBbXSxcbiAgICAgICAgICAgICAgbWF0Y2hlciA9IGNvbXBpbGUoc2VsZWN0b3IucmVwbGFjZShydHJpbSwgXCIkMVwiKSk7XG4gICAgICAgICAgcmV0dXJuIG1hdGNoZXJbZXhwYW5kb10gPyBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VlZCwgbWF0Y2hlcywgY29udGV4dCwgeG1sKSB7XG4gICAgICAgICAgICB2YXIgZWxlbSxcbiAgICAgICAgICAgICAgICB1bm1hdGNoZWQgPSBtYXRjaGVyKHNlZWQsIG51bGwsIHhtbCwgW10pLFxuICAgICAgICAgICAgICAgIGkgPSBzZWVkLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgaWYgKChlbGVtID0gdW5tYXRjaGVkW2ldKSkge1xuICAgICAgICAgICAgICAgIHNlZWRbaV0gPSAhKG1hdGNoZXNbaV0gPSBlbGVtKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pIDogZnVuY3Rpb24oZWxlbSwgY29udGV4dCwgeG1sKSB7XG4gICAgICAgICAgICBpbnB1dFswXSA9IGVsZW07XG4gICAgICAgICAgICBtYXRjaGVyKGlucHV0LCBudWxsLCB4bWwsIHJlc3VsdHMpO1xuICAgICAgICAgICAgaW5wdXRbMF0gPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuICFyZXN1bHRzLnBvcCgpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgICBcImhhc1wiOiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgICAgcmV0dXJuIFNpenpsZShzZWxlY3RvciwgZWxlbSkubGVuZ3RoID4gMDtcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgICAgXCJjb250YWluc1wiOiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24odGV4dCkge1xuICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UocnVuZXNjYXBlLCBmdW5lc2NhcGUpO1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gKGVsZW0udGV4dENvbnRlbnQgfHwgZWxlbS5pbm5lclRleHQgfHwgZ2V0VGV4dChlbGVtKSkuaW5kZXhPZih0ZXh0KSA+IC0xO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgICBcImxhbmdcIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKGxhbmcpIHtcbiAgICAgICAgICBpZiAoIXJpZGVudGlmaWVyLnRlc3QobGFuZyB8fCBcIlwiKSkge1xuICAgICAgICAgICAgU2l6emxlLmVycm9yKFwidW5zdXBwb3J0ZWQgbGFuZzogXCIgKyBsYW5nKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGFuZyA9IGxhbmcucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgICAgdmFyIGVsZW1MYW5nO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICBpZiAoKGVsZW1MYW5nID0gZG9jdW1lbnRJc0hUTUwgPyBlbGVtLmxhbmcgOiBlbGVtLmdldEF0dHJpYnV0ZShcInhtbDpsYW5nXCIpIHx8IGVsZW0uZ2V0QXR0cmlidXRlKFwibGFuZ1wiKSkpIHtcbiAgICAgICAgICAgICAgICBlbGVtTGFuZyA9IGVsZW1MYW5nLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1MYW5nID09PSBsYW5nIHx8IGVsZW1MYW5nLmluZGV4T2YobGFuZyArIFwiLVwiKSA9PT0gMDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAoKGVsZW0gPSBlbGVtLnBhcmVudE5vZGUpICYmIGVsZW0ubm9kZVR5cGUgPT09IDEpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgICBcInRhcmdldFwiOiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24gJiYgd2luZG93LmxvY2F0aW9uLmhhc2g7XG4gICAgICAgICAgcmV0dXJuIGhhc2ggJiYgaGFzaC5zbGljZSgxKSA9PT0gZWxlbS5pZDtcbiAgICAgICAgfSxcbiAgICAgICAgXCJyb290XCI6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgICByZXR1cm4gZWxlbSA9PT0gZG9jRWxlbTtcbiAgICAgICAgfSxcbiAgICAgICAgXCJmb2N1c1wiOiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgcmV0dXJuIGVsZW0gPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgKCFkb2N1bWVudC5oYXNGb2N1cyB8fCBkb2N1bWVudC5oYXNGb2N1cygpKSAmJiAhIShlbGVtLnR5cGUgfHwgZWxlbS5ocmVmIHx8IH5lbGVtLnRhYkluZGV4KTtcbiAgICAgICAgfSxcbiAgICAgICAgXCJlbmFibGVkXCI6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgICByZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIFwiZGlzYWJsZWRcIjogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgIHJldHVybiBlbGVtLmRpc2FibGVkID09PSB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBcImNoZWNrZWRcIjogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgIHZhciBub2RlTmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICByZXR1cm4gKG5vZGVOYW1lID09PSBcImlucHV0XCIgJiYgISFlbGVtLmNoZWNrZWQpIHx8IChub2RlTmFtZSA9PT0gXCJvcHRpb25cIiAmJiAhIWVsZW0uc2VsZWN0ZWQpO1xuICAgICAgICB9LFxuICAgICAgICBcInNlbGVjdGVkXCI6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgICBpZiAoZWxlbS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICBlbGVtLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGVsZW0uc2VsZWN0ZWQgPT09IHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIFwiZW1wdHlcIjogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgIGZvciAoZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIGlmIChlbGVtLm5vZGVUeXBlIDwgNikge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBcInBhcmVudFwiOiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgcmV0dXJuICFFeHByLnBzZXVkb3NbXCJlbXB0eVwiXShlbGVtKTtcbiAgICAgICAgfSxcbiAgICAgICAgXCJoZWFkZXJcIjogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgIHJldHVybiByaGVhZGVyLnRlc3QoZWxlbS5ub2RlTmFtZSk7XG4gICAgICAgIH0sXG4gICAgICAgIFwiaW5wdXRcIjogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgIHJldHVybiByaW5wdXRzLnRlc3QoZWxlbS5ub2RlTmFtZSk7XG4gICAgICAgIH0sXG4gICAgICAgIFwiYnV0dG9uXCI6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgICB2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICByZXR1cm4gbmFtZSA9PT0gXCJpbnB1dFwiICYmIGVsZW0udHlwZSA9PT0gXCJidXR0b25cIiB8fCBuYW1lID09PSBcImJ1dHRvblwiO1xuICAgICAgICB9LFxuICAgICAgICBcInRleHRcIjogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgIHZhciBhdHRyO1xuICAgICAgICAgIHJldHVybiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IFwiaW5wdXRcIiAmJiBlbGVtLnR5cGUgPT09IFwidGV4dFwiICYmICgoYXR0ciA9IGVsZW0uZ2V0QXR0cmlidXRlKFwidHlwZVwiKSkgPT0gbnVsbCB8fCBhdHRyLnRvTG93ZXJDYXNlKCkgPT09IFwidGV4dFwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgXCJmaXJzdFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBbMF07XG4gICAgICAgIH0pLFxuICAgICAgICBcImxhc3RcIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsIGxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBbbGVuZ3RoIC0gMV07XG4gICAgICAgIH0pLFxuICAgICAgICBcImVxXCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24obWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIFthcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50XTtcbiAgICAgICAgfSksXG4gICAgICAgIFwiZXZlblwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKG1hdGNoSW5kZXhlcywgbGVuZ3RoKSB7XG4gICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpICs9IDIpIHtcbiAgICAgICAgICAgIG1hdGNoSW5kZXhlcy5wdXNoKGkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbWF0Y2hJbmRleGVzO1xuICAgICAgICB9KSxcbiAgICAgICAgXCJvZGRcIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsIGxlbmd0aCkge1xuICAgICAgICAgIHZhciBpID0gMTtcbiAgICAgICAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgICAgICBtYXRjaEluZGV4ZXMucHVzaChpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG1hdGNoSW5kZXhlcztcbiAgICAgICAgfSksXG4gICAgICAgIFwibHRcIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbihtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQpIHtcbiAgICAgICAgICB2YXIgaSA9IGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQ7XG4gICAgICAgICAgZm9yICg7IC0taSA+PSAwOyApIHtcbiAgICAgICAgICAgIG1hdGNoSW5kZXhlcy5wdXNoKGkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbWF0Y2hJbmRleGVzO1xuICAgICAgICB9KSxcbiAgICAgICAgXCJndFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCkge1xuICAgICAgICAgIHZhciBpID0gYXJndW1lbnQgPCAwID8gYXJndW1lbnQgKyBsZW5ndGggOiBhcmd1bWVudDtcbiAgICAgICAgICBmb3IgKDsgKytpIDwgbGVuZ3RoOyApIHtcbiAgICAgICAgICAgIG1hdGNoSW5kZXhlcy5wdXNoKGkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbWF0Y2hJbmRleGVzO1xuICAgICAgICB9KVxuICAgICAgfVxuICAgIH07XG4gICAgRXhwci5wc2V1ZG9zW1wibnRoXCJdID0gRXhwci5wc2V1ZG9zW1wiZXFcIl07XG4gICAgZm9yIChpIGluIHtcbiAgICAgIHJhZGlvOiB0cnVlLFxuICAgICAgY2hlY2tib3g6IHRydWUsXG4gICAgICBmaWxlOiB0cnVlLFxuICAgICAgcGFzc3dvcmQ6IHRydWUsXG4gICAgICBpbWFnZTogdHJ1ZVxuICAgIH0pIHtcbiAgICAgIEV4cHIucHNldWRvc1tpXSA9IGNyZWF0ZUlucHV0UHNldWRvKGkpO1xuICAgIH1cbiAgICBmb3IgKGkgaW4ge1xuICAgICAgc3VibWl0OiB0cnVlLFxuICAgICAgcmVzZXQ6IHRydWVcbiAgICB9KSB7XG4gICAgICBFeHByLnBzZXVkb3NbaV0gPSBjcmVhdGVCdXR0b25Qc2V1ZG8oaSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldEZpbHRlcnMoKSB7fVxuICAgIHNldEZpbHRlcnMucHJvdG90eXBlID0gRXhwci5maWx0ZXJzID0gRXhwci5wc2V1ZG9zO1xuICAgIEV4cHIuc2V0RmlsdGVycyA9IG5ldyBzZXRGaWx0ZXJzKCk7XG4gICAgdG9rZW5pemUgPSBTaXp6bGUudG9rZW5pemUgPSBmdW5jdGlvbihzZWxlY3RvciwgcGFyc2VPbmx5KSB7XG4gICAgICB2YXIgbWF0Y2hlZCxcbiAgICAgICAgICBtYXRjaCxcbiAgICAgICAgICB0b2tlbnMsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICBzb0ZhcixcbiAgICAgICAgICBncm91cHMsXG4gICAgICAgICAgcHJlRmlsdGVycyxcbiAgICAgICAgICBjYWNoZWQgPSB0b2tlbkNhY2hlW3NlbGVjdG9yICsgXCIgXCJdO1xuICAgICAgaWYgKGNhY2hlZCkge1xuICAgICAgICByZXR1cm4gcGFyc2VPbmx5ID8gMCA6IGNhY2hlZC5zbGljZSgwKTtcbiAgICAgIH1cbiAgICAgIHNvRmFyID0gc2VsZWN0b3I7XG4gICAgICBncm91cHMgPSBbXTtcbiAgICAgIHByZUZpbHRlcnMgPSBFeHByLnByZUZpbHRlcjtcbiAgICAgIHdoaWxlIChzb0Zhcikge1xuICAgICAgICBpZiAoIW1hdGNoZWQgfHwgKG1hdGNoID0gcmNvbW1hLmV4ZWMoc29GYXIpKSkge1xuICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgc29GYXIgPSBzb0Zhci5zbGljZShtYXRjaFswXS5sZW5ndGgpIHx8IHNvRmFyO1xuICAgICAgICAgIH1cbiAgICAgICAgICBncm91cHMucHVzaCgodG9rZW5zID0gW10pKTtcbiAgICAgICAgfVxuICAgICAgICBtYXRjaGVkID0gZmFsc2U7XG4gICAgICAgIGlmICgobWF0Y2ggPSByY29tYmluYXRvcnMuZXhlYyhzb0ZhcikpKSB7XG4gICAgICAgICAgbWF0Y2hlZCA9IG1hdGNoLnNoaWZ0KCk7XG4gICAgICAgICAgdG9rZW5zLnB1c2goe1xuICAgICAgICAgICAgdmFsdWU6IG1hdGNoZWQsXG4gICAgICAgICAgICB0eXBlOiBtYXRjaFswXS5yZXBsYWNlKHJ0cmltLCBcIiBcIilcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBzb0ZhciA9IHNvRmFyLnNsaWNlKG1hdGNoZWQubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHR5cGUgaW4gRXhwci5maWx0ZXIpIHtcbiAgICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hFeHByW3R5cGVdLmV4ZWMoc29GYXIpKSAmJiAoIXByZUZpbHRlcnNbdHlwZV0gfHwgKG1hdGNoID0gcHJlRmlsdGVyc1t0eXBlXShtYXRjaCkpKSkge1xuICAgICAgICAgICAgbWF0Y2hlZCA9IG1hdGNoLnNoaWZ0KCk7XG4gICAgICAgICAgICB0b2tlbnMucHVzaCh7XG4gICAgICAgICAgICAgIHZhbHVlOiBtYXRjaGVkLFxuICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICBtYXRjaGVzOiBtYXRjaFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzb0ZhciA9IHNvRmFyLnNsaWNlKG1hdGNoZWQubGVuZ3RoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFtYXRjaGVkKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBwYXJzZU9ubHkgPyBzb0Zhci5sZW5ndGggOiBzb0ZhciA/IFNpenpsZS5lcnJvcihzZWxlY3RvcikgOiB0b2tlbkNhY2hlKHNlbGVjdG9yLCBncm91cHMpLnNsaWNlKDApO1xuICAgIH07XG4gICAgZnVuY3Rpb24gdG9TZWxlY3Rvcih0b2tlbnMpIHtcbiAgICAgIHZhciBpID0gMCxcbiAgICAgICAgICBsZW4gPSB0b2tlbnMubGVuZ3RoLFxuICAgICAgICAgIHNlbGVjdG9yID0gXCJcIjtcbiAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgc2VsZWN0b3IgKz0gdG9rZW5zW2ldLnZhbHVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlbGVjdG9yO1xuICAgIH1cbiAgICBmdW5jdGlvbiBhZGRDb21iaW5hdG9yKG1hdGNoZXIsIGNvbWJpbmF0b3IsIGJhc2UpIHtcbiAgICAgIHZhciBkaXIgPSBjb21iaW5hdG9yLmRpcixcbiAgICAgICAgICBjaGVja05vbkVsZW1lbnRzID0gYmFzZSAmJiBkaXIgPT09IFwicGFyZW50Tm9kZVwiLFxuICAgICAgICAgIGRvbmVOYW1lID0gZG9uZSsrO1xuICAgICAgcmV0dXJuIGNvbWJpbmF0b3IuZmlyc3QgPyBmdW5jdGlvbihlbGVtLCBjb250ZXh0LCB4bWwpIHtcbiAgICAgICAgd2hpbGUgKChlbGVtID0gZWxlbVtkaXJdKSkge1xuICAgICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXRjaGVyKGVsZW0sIGNvbnRleHQsIHhtbCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IDogZnVuY3Rpb24oZWxlbSwgY29udGV4dCwgeG1sKSB7XG4gICAgICAgIHZhciBvbGRDYWNoZSxcbiAgICAgICAgICAgIG91dGVyQ2FjaGUsXG4gICAgICAgICAgICBuZXdDYWNoZSA9IFtkaXJydW5zLCBkb25lTmFtZV07XG4gICAgICAgIGlmICh4bWwpIHtcbiAgICAgICAgICB3aGlsZSAoKGVsZW0gPSBlbGVtW2Rpcl0pKSB7XG4gICAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzKSB7XG4gICAgICAgICAgICAgIGlmIChtYXRjaGVyKGVsZW0sIGNvbnRleHQsIHhtbCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3aGlsZSAoKGVsZW0gPSBlbGVtW2Rpcl0pKSB7XG4gICAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzKSB7XG4gICAgICAgICAgICAgIG91dGVyQ2FjaGUgPSBlbGVtW2V4cGFuZG9dIHx8IChlbGVtW2V4cGFuZG9dID0ge30pO1xuICAgICAgICAgICAgICBpZiAoKG9sZENhY2hlID0gb3V0ZXJDYWNoZVtkaXJdKSAmJiBvbGRDYWNoZVswXSA9PT0gZGlycnVucyAmJiBvbGRDYWNoZVsxXSA9PT0gZG9uZU5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKG5ld0NhY2hlWzJdID0gb2xkQ2FjaGVbMl0pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dGVyQ2FjaGVbZGlyXSA9IG5ld0NhY2hlO1xuICAgICAgICAgICAgICAgIGlmICgobmV3Q2FjaGVbMl0gPSBtYXRjaGVyKGVsZW0sIGNvbnRleHQsIHhtbCkpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGVsZW1lbnRNYXRjaGVyKG1hdGNoZXJzKSB7XG4gICAgICByZXR1cm4gbWF0Y2hlcnMubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKGVsZW0sIGNvbnRleHQsIHhtbCkge1xuICAgICAgICB2YXIgaSA9IG1hdGNoZXJzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgIGlmICghbWF0Y2hlcnNbaV0oZWxlbSwgY29udGV4dCwgeG1sKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gOiBtYXRjaGVyc1swXTtcbiAgICB9XG4gICAgZnVuY3Rpb24gbXVsdGlwbGVDb250ZXh0cyhzZWxlY3RvciwgY29udGV4dHMsIHJlc3VsdHMpIHtcbiAgICAgIHZhciBpID0gMCxcbiAgICAgICAgICBsZW4gPSBjb250ZXh0cy5sZW5ndGg7XG4gICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIFNpenpsZShzZWxlY3RvciwgY29udGV4dHNbaV0sIHJlc3VsdHMpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNvbmRlbnNlKHVubWF0Y2hlZCwgbWFwLCBmaWx0ZXIsIGNvbnRleHQsIHhtbCkge1xuICAgICAgdmFyIGVsZW0sXG4gICAgICAgICAgbmV3VW5tYXRjaGVkID0gW10sXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgbGVuID0gdW5tYXRjaGVkLmxlbmd0aCxcbiAgICAgICAgICBtYXBwZWQgPSBtYXAgIT0gbnVsbDtcbiAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKChlbGVtID0gdW5tYXRjaGVkW2ldKSkge1xuICAgICAgICAgIGlmICghZmlsdGVyIHx8IGZpbHRlcihlbGVtLCBjb250ZXh0LCB4bWwpKSB7XG4gICAgICAgICAgICBuZXdVbm1hdGNoZWQucHVzaChlbGVtKTtcbiAgICAgICAgICAgIGlmIChtYXBwZWQpIHtcbiAgICAgICAgICAgICAgbWFwLnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3VW5tYXRjaGVkO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRNYXRjaGVyKHByZUZpbHRlciwgc2VsZWN0b3IsIG1hdGNoZXIsIHBvc3RGaWx0ZXIsIHBvc3RGaW5kZXIsIHBvc3RTZWxlY3Rvcikge1xuICAgICAgaWYgKHBvc3RGaWx0ZXIgJiYgIXBvc3RGaWx0ZXJbZXhwYW5kb10pIHtcbiAgICAgICAgcG9zdEZpbHRlciA9IHNldE1hdGNoZXIocG9zdEZpbHRlcik7XG4gICAgICB9XG4gICAgICBpZiAocG9zdEZpbmRlciAmJiAhcG9zdEZpbmRlcltleHBhbmRvXSkge1xuICAgICAgICBwb3N0RmluZGVyID0gc2V0TWF0Y2hlcihwb3N0RmluZGVyLCBwb3N0U2VsZWN0b3IpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbihzZWVkLCByZXN1bHRzLCBjb250ZXh0LCB4bWwpIHtcbiAgICAgICAgdmFyIHRlbXAsXG4gICAgICAgICAgICBpLFxuICAgICAgICAgICAgZWxlbSxcbiAgICAgICAgICAgIHByZU1hcCA9IFtdLFxuICAgICAgICAgICAgcG9zdE1hcCA9IFtdLFxuICAgICAgICAgICAgcHJlZXhpc3RpbmcgPSByZXN1bHRzLmxlbmd0aCxcbiAgICAgICAgICAgIGVsZW1zID0gc2VlZCB8fCBtdWx0aXBsZUNvbnRleHRzKHNlbGVjdG9yIHx8IFwiKlwiLCBjb250ZXh0Lm5vZGVUeXBlID8gW2NvbnRleHRdIDogY29udGV4dCwgW10pLFxuICAgICAgICAgICAgbWF0Y2hlckluID0gcHJlRmlsdGVyICYmIChzZWVkIHx8ICFzZWxlY3RvcikgPyBjb25kZW5zZShlbGVtcywgcHJlTWFwLCBwcmVGaWx0ZXIsIGNvbnRleHQsIHhtbCkgOiBlbGVtcyxcbiAgICAgICAgICAgIG1hdGNoZXJPdXQgPSBtYXRjaGVyID8gcG9zdEZpbmRlciB8fCAoc2VlZCA/IHByZUZpbHRlciA6IHByZWV4aXN0aW5nIHx8IHBvc3RGaWx0ZXIpID8gW10gOiByZXN1bHRzIDogbWF0Y2hlckluO1xuICAgICAgICBpZiAobWF0Y2hlcikge1xuICAgICAgICAgIG1hdGNoZXIobWF0Y2hlckluLCBtYXRjaGVyT3V0LCBjb250ZXh0LCB4bWwpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3N0RmlsdGVyKSB7XG4gICAgICAgICAgdGVtcCA9IGNvbmRlbnNlKG1hdGNoZXJPdXQsIHBvc3RNYXApO1xuICAgICAgICAgIHBvc3RGaWx0ZXIodGVtcCwgW10sIGNvbnRleHQsIHhtbCk7XG4gICAgICAgICAgaSA9IHRlbXAubGVuZ3RoO1xuICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIGlmICgoZWxlbSA9IHRlbXBbaV0pKSB7XG4gICAgICAgICAgICAgIG1hdGNoZXJPdXRbcG9zdE1hcFtpXV0gPSAhKG1hdGNoZXJJbltwb3N0TWFwW2ldXSA9IGVsZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VlZCkge1xuICAgICAgICAgIGlmIChwb3N0RmluZGVyIHx8IHByZUZpbHRlcikge1xuICAgICAgICAgICAgaWYgKHBvc3RGaW5kZXIpIHtcbiAgICAgICAgICAgICAgdGVtcCA9IFtdO1xuICAgICAgICAgICAgICBpID0gbWF0Y2hlck91dC5sZW5ndGg7XG4gICAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICBpZiAoKGVsZW0gPSBtYXRjaGVyT3V0W2ldKSkge1xuICAgICAgICAgICAgICAgICAgdGVtcC5wdXNoKChtYXRjaGVySW5baV0gPSBlbGVtKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHBvc3RGaW5kZXIobnVsbCwgKG1hdGNoZXJPdXQgPSBbXSksIHRlbXAsIHhtbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpID0gbWF0Y2hlck91dC5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgICAgIGlmICgoZWxlbSA9IG1hdGNoZXJPdXRbaV0pICYmICh0ZW1wID0gcG9zdEZpbmRlciA/IGluZGV4T2Yoc2VlZCwgZWxlbSkgOiBwcmVNYXBbaV0pID4gLTEpIHtcbiAgICAgICAgICAgICAgICBzZWVkW3RlbXBdID0gIShyZXN1bHRzW3RlbXBdID0gZWxlbSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWF0Y2hlck91dCA9IGNvbmRlbnNlKG1hdGNoZXJPdXQgPT09IHJlc3VsdHMgPyBtYXRjaGVyT3V0LnNwbGljZShwcmVleGlzdGluZywgbWF0Y2hlck91dC5sZW5ndGgpIDogbWF0Y2hlck91dCk7XG4gICAgICAgICAgaWYgKHBvc3RGaW5kZXIpIHtcbiAgICAgICAgICAgIHBvc3RGaW5kZXIobnVsbCwgcmVzdWx0cywgbWF0Y2hlck91dCwgeG1sKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHVzaC5hcHBseShyZXN1bHRzLCBtYXRjaGVyT3V0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBtYXRjaGVyRnJvbVRva2Vucyh0b2tlbnMpIHtcbiAgICAgIHZhciBjaGVja0NvbnRleHQsXG4gICAgICAgICAgbWF0Y2hlcixcbiAgICAgICAgICBqLFxuICAgICAgICAgIGxlbiA9IHRva2Vucy5sZW5ndGgsXG4gICAgICAgICAgbGVhZGluZ1JlbGF0aXZlID0gRXhwci5yZWxhdGl2ZVt0b2tlbnNbMF0udHlwZV0sXG4gICAgICAgICAgaW1wbGljaXRSZWxhdGl2ZSA9IGxlYWRpbmdSZWxhdGl2ZSB8fCBFeHByLnJlbGF0aXZlW1wiIFwiXSxcbiAgICAgICAgICBpID0gbGVhZGluZ1JlbGF0aXZlID8gMSA6IDAsXG4gICAgICAgICAgbWF0Y2hDb250ZXh0ID0gYWRkQ29tYmluYXRvcihmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbSA9PT0gY2hlY2tDb250ZXh0O1xuICAgICAgICAgIH0sIGltcGxpY2l0UmVsYXRpdmUsIHRydWUpLFxuICAgICAgICAgIG1hdGNoQW55Q29udGV4dCA9IGFkZENvbWJpbmF0b3IoZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4T2YoY2hlY2tDb250ZXh0LCBlbGVtKSA+IC0xO1xuICAgICAgICAgIH0sIGltcGxpY2l0UmVsYXRpdmUsIHRydWUpLFxuICAgICAgICAgIG1hdGNoZXJzID0gW2Z1bmN0aW9uKGVsZW0sIGNvbnRleHQsIHhtbCkge1xuICAgICAgICAgICAgdmFyIHJldCA9ICghbGVhZGluZ1JlbGF0aXZlICYmICh4bWwgfHwgY29udGV4dCAhPT0gb3V0ZXJtb3N0Q29udGV4dCkpIHx8ICgoY2hlY2tDb250ZXh0ID0gY29udGV4dCkubm9kZVR5cGUgPyBtYXRjaENvbnRleHQoZWxlbSwgY29udGV4dCwgeG1sKSA6IG1hdGNoQW55Q29udGV4dChlbGVtLCBjb250ZXh0LCB4bWwpKTtcbiAgICAgICAgICAgIGNoZWNrQ29udGV4dCA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgIH1dO1xuICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoKG1hdGNoZXIgPSBFeHByLnJlbGF0aXZlW3Rva2Vuc1tpXS50eXBlXSkpIHtcbiAgICAgICAgICBtYXRjaGVycyA9IFthZGRDb21iaW5hdG9yKGVsZW1lbnRNYXRjaGVyKG1hdGNoZXJzKSwgbWF0Y2hlcildO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1hdGNoZXIgPSBFeHByLmZpbHRlclt0b2tlbnNbaV0udHlwZV0uYXBwbHkobnVsbCwgdG9rZW5zW2ldLm1hdGNoZXMpO1xuICAgICAgICAgIGlmIChtYXRjaGVyW2V4cGFuZG9dKSB7XG4gICAgICAgICAgICBqID0gKytpO1xuICAgICAgICAgICAgZm9yICg7IGogPCBsZW47IGorKykge1xuICAgICAgICAgICAgICBpZiAoRXhwci5yZWxhdGl2ZVt0b2tlbnNbal0udHlwZV0pIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNldE1hdGNoZXIoaSA+IDEgJiYgZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpLCBpID4gMSAmJiB0b1NlbGVjdG9yKHRva2Vucy5zbGljZSgwLCBpIC0gMSkuY29uY2F0KHt2YWx1ZTogdG9rZW5zW2kgLSAyXS50eXBlID09PSBcIiBcIiA/IFwiKlwiIDogXCJcIn0pKS5yZXBsYWNlKHJ0cmltLCBcIiQxXCIpLCBtYXRjaGVyLCBpIDwgaiAmJiBtYXRjaGVyRnJvbVRva2Vucyh0b2tlbnMuc2xpY2UoaSwgaikpLCBqIDwgbGVuICYmIG1hdGNoZXJGcm9tVG9rZW5zKCh0b2tlbnMgPSB0b2tlbnMuc2xpY2UoaikpKSwgaiA8IGxlbiAmJiB0b1NlbGVjdG9yKHRva2VucykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtYXRjaGVycy5wdXNoKG1hdGNoZXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZWxlbWVudE1hdGNoZXIobWF0Y2hlcnMpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBtYXRjaGVyRnJvbUdyb3VwTWF0Y2hlcnMoZWxlbWVudE1hdGNoZXJzLCBzZXRNYXRjaGVycykge1xuICAgICAgdmFyIGJ5U2V0ID0gc2V0TWF0Y2hlcnMubGVuZ3RoID4gMCxcbiAgICAgICAgICBieUVsZW1lbnQgPSBlbGVtZW50TWF0Y2hlcnMubGVuZ3RoID4gMCxcbiAgICAgICAgICBzdXBlck1hdGNoZXIgPSBmdW5jdGlvbihzZWVkLCBjb250ZXh0LCB4bWwsIHJlc3VsdHMsIG91dGVybW9zdCkge1xuICAgICAgICAgICAgdmFyIGVsZW0sXG4gICAgICAgICAgICAgICAgaixcbiAgICAgICAgICAgICAgICBtYXRjaGVyLFxuICAgICAgICAgICAgICAgIG1hdGNoZWRDb3VudCA9IDAsXG4gICAgICAgICAgICAgICAgaSA9IFwiMFwiLFxuICAgICAgICAgICAgICAgIHVubWF0Y2hlZCA9IHNlZWQgJiYgW10sXG4gICAgICAgICAgICAgICAgc2V0TWF0Y2hlZCA9IFtdLFxuICAgICAgICAgICAgICAgIGNvbnRleHRCYWNrdXAgPSBvdXRlcm1vc3RDb250ZXh0LFxuICAgICAgICAgICAgICAgIGVsZW1zID0gc2VlZCB8fCBieUVsZW1lbnQgJiYgRXhwci5maW5kW1wiVEFHXCJdKFwiKlwiLCBvdXRlcm1vc3QpLFxuICAgICAgICAgICAgICAgIGRpcnJ1bnNVbmlxdWUgPSAoZGlycnVucyArPSBjb250ZXh0QmFja3VwID09IG51bGwgPyAxIDogTWF0aC5yYW5kb20oKSB8fCAwLjEpLFxuICAgICAgICAgICAgICAgIGxlbiA9IGVsZW1zLmxlbmd0aDtcbiAgICAgICAgICAgIGlmIChvdXRlcm1vc3QpIHtcbiAgICAgICAgICAgICAgb3V0ZXJtb3N0Q29udGV4dCA9IGNvbnRleHQgIT09IGRvY3VtZW50ICYmIGNvbnRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKDsgaSAhPT0gbGVuICYmIChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKykge1xuICAgICAgICAgICAgICBpZiAoYnlFbGVtZW50ICYmIGVsZW0pIHtcbiAgICAgICAgICAgICAgICBqID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoKG1hdGNoZXIgPSBlbGVtZW50TWF0Y2hlcnNbaisrXSkpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVyKGVsZW0sIGNvbnRleHQsIHhtbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKGVsZW0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG91dGVybW9zdCkge1xuICAgICAgICAgICAgICAgICAgZGlycnVucyA9IGRpcnJ1bnNVbmlxdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChieVNldCkge1xuICAgICAgICAgICAgICAgIGlmICgoZWxlbSA9ICFtYXRjaGVyICYmIGVsZW0pKSB7XG4gICAgICAgICAgICAgICAgICBtYXRjaGVkQ291bnQtLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNlZWQpIHtcbiAgICAgICAgICAgICAgICAgIHVubWF0Y2hlZC5wdXNoKGVsZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWF0Y2hlZENvdW50ICs9IGk7XG4gICAgICAgICAgICBpZiAoYnlTZXQgJiYgaSAhPT0gbWF0Y2hlZENvdW50KSB7XG4gICAgICAgICAgICAgIGogPSAwO1xuICAgICAgICAgICAgICB3aGlsZSAoKG1hdGNoZXIgPSBzZXRNYXRjaGVyc1tqKytdKSkge1xuICAgICAgICAgICAgICAgIG1hdGNoZXIodW5tYXRjaGVkLCBzZXRNYXRjaGVkLCBjb250ZXh0LCB4bWwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChzZWVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoZWRDb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodW5tYXRjaGVkW2ldIHx8IHNldE1hdGNoZWRbaV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgc2V0TWF0Y2hlZFtpXSA9IHBvcC5jYWxsKHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldE1hdGNoZWQgPSBjb25kZW5zZShzZXRNYXRjaGVkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBwdXNoLmFwcGx5KHJlc3VsdHMsIHNldE1hdGNoZWQpO1xuICAgICAgICAgICAgICBpZiAob3V0ZXJtb3N0ICYmICFzZWVkICYmIHNldE1hdGNoZWQubGVuZ3RoID4gMCAmJiAobWF0Y2hlZENvdW50ICsgc2V0TWF0Y2hlcnMubGVuZ3RoKSA+IDEpIHtcbiAgICAgICAgICAgICAgICBTaXp6bGUudW5pcXVlU29ydChyZXN1bHRzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG91dGVybW9zdCkge1xuICAgICAgICAgICAgICBkaXJydW5zID0gZGlycnVuc1VuaXF1ZTtcbiAgICAgICAgICAgICAgb3V0ZXJtb3N0Q29udGV4dCA9IGNvbnRleHRCYWNrdXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5tYXRjaGVkO1xuICAgICAgICAgIH07XG4gICAgICByZXR1cm4gYnlTZXQgPyBtYXJrRnVuY3Rpb24oc3VwZXJNYXRjaGVyKSA6IHN1cGVyTWF0Y2hlcjtcbiAgICB9XG4gICAgY29tcGlsZSA9IFNpenpsZS5jb21waWxlID0gZnVuY3Rpb24oc2VsZWN0b3IsIG1hdGNoKSB7XG4gICAgICB2YXIgaSxcbiAgICAgICAgICBzZXRNYXRjaGVycyA9IFtdLFxuICAgICAgICAgIGVsZW1lbnRNYXRjaGVycyA9IFtdLFxuICAgICAgICAgIGNhY2hlZCA9IGNvbXBpbGVyQ2FjaGVbc2VsZWN0b3IgKyBcIiBcIl07XG4gICAgICBpZiAoIWNhY2hlZCkge1xuICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgbWF0Y2ggPSB0b2tlbml6ZShzZWxlY3Rvcik7XG4gICAgICAgIH1cbiAgICAgICAgaSA9IG1hdGNoLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgIGNhY2hlZCA9IG1hdGNoZXJGcm9tVG9rZW5zKG1hdGNoW2ldKTtcbiAgICAgICAgICBpZiAoY2FjaGVkW2V4cGFuZG9dKSB7XG4gICAgICAgICAgICBzZXRNYXRjaGVycy5wdXNoKGNhY2hlZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsZW1lbnRNYXRjaGVycy5wdXNoKGNhY2hlZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhY2hlZCA9IGNvbXBpbGVyQ2FjaGUoc2VsZWN0b3IsIG1hdGNoZXJGcm9tR3JvdXBNYXRjaGVycyhlbGVtZW50TWF0Y2hlcnMsIHNldE1hdGNoZXJzKSk7XG4gICAgICAgIGNhY2hlZC5zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICB9O1xuICAgIHNlbGVjdCA9IFNpenpsZS5zZWxlY3QgPSBmdW5jdGlvbihzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCkge1xuICAgICAgdmFyIGksXG4gICAgICAgICAgdG9rZW5zLFxuICAgICAgICAgIHRva2VuLFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgZmluZCxcbiAgICAgICAgICBjb21waWxlZCA9IHR5cGVvZiBzZWxlY3RvciA9PT0gXCJmdW5jdGlvblwiICYmIHNlbGVjdG9yLFxuICAgICAgICAgIG1hdGNoID0gIXNlZWQgJiYgdG9rZW5pemUoKHNlbGVjdG9yID0gY29tcGlsZWQuc2VsZWN0b3IgfHwgc2VsZWN0b3IpKTtcbiAgICAgIHJlc3VsdHMgPSByZXN1bHRzIHx8IFtdO1xuICAgICAgaWYgKG1hdGNoLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICB0b2tlbnMgPSBtYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKDApO1xuICAgICAgICBpZiAodG9rZW5zLmxlbmd0aCA+IDIgJiYgKHRva2VuID0gdG9rZW5zWzBdKS50eXBlID09PSBcIklEXCIgJiYgc3VwcG9ydC5nZXRCeUlkICYmIGNvbnRleHQubm9kZVR5cGUgPT09IDkgJiYgZG9jdW1lbnRJc0hUTUwgJiYgRXhwci5yZWxhdGl2ZVt0b2tlbnNbMV0udHlwZV0pIHtcbiAgICAgICAgICBjb250ZXh0ID0gKEV4cHIuZmluZFtcIklEXCJdKHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSksIGNvbnRleHQpIHx8IFtdKVswXTtcbiAgICAgICAgICBpZiAoIWNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY29tcGlsZWQpIHtcbiAgICAgICAgICAgIGNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5vZGU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHNlbGVjdG9yID0gc2VsZWN0b3Iuc2xpY2UodG9rZW5zLnNoaWZ0KCkudmFsdWUubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICBpID0gbWF0Y2hFeHByW1wibmVlZHNDb250ZXh0XCJdLnRlc3Qoc2VsZWN0b3IpID8gMCA6IHRva2Vucy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICB0b2tlbiA9IHRva2Vuc1tpXTtcbiAgICAgICAgICBpZiAoRXhwci5yZWxhdGl2ZVsodHlwZSA9IHRva2VuLnR5cGUpXSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICgoZmluZCA9IEV4cHIuZmluZFt0eXBlXSkpIHtcbiAgICAgICAgICAgIGlmICgoc2VlZCA9IGZpbmQodG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKSwgcnNpYmxpbmcudGVzdCh0b2tlbnNbMF0udHlwZSkgJiYgdGVzdENvbnRleHQoY29udGV4dC5wYXJlbnROb2RlKSB8fCBjb250ZXh0KSkpIHtcbiAgICAgICAgICAgICAgdG9rZW5zLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgc2VsZWN0b3IgPSBzZWVkLmxlbmd0aCAmJiB0b1NlbGVjdG9yKHRva2Vucyk7XG4gICAgICAgICAgICAgIGlmICghc2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICBwdXNoLmFwcGx5KHJlc3VsdHMsIHNlZWQpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgKGNvbXBpbGVkIHx8IGNvbXBpbGUoc2VsZWN0b3IsIG1hdGNoKSkoc2VlZCwgY29udGV4dCwgIWRvY3VtZW50SXNIVE1MLCByZXN1bHRzLCByc2libGluZy50ZXN0KHNlbGVjdG9yKSAmJiB0ZXN0Q29udGV4dChjb250ZXh0LnBhcmVudE5vZGUpIHx8IGNvbnRleHQpO1xuICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfTtcbiAgICBzdXBwb3J0LnNvcnRTdGFibGUgPSBleHBhbmRvLnNwbGl0KFwiXCIpLnNvcnQoc29ydE9yZGVyKS5qb2luKFwiXCIpID09PSBleHBhbmRvO1xuICAgIHN1cHBvcnQuZGV0ZWN0RHVwbGljYXRlcyA9ICEhaGFzRHVwbGljYXRlO1xuICAgIHNldERvY3VtZW50KCk7XG4gICAgc3VwcG9ydC5zb3J0RGV0YWNoZWQgPSBhc3NlcnQoZnVuY3Rpb24oZGl2MSkge1xuICAgICAgcmV0dXJuIGRpdjEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSkgJiAxO1xuICAgIH0pO1xuICAgIGlmICghYXNzZXJ0KGZ1bmN0aW9uKGRpdikge1xuICAgICAgZGl2LmlubmVySFRNTCA9IFwiPGEgaHJlZj0nIyc+PC9hPlwiO1xuICAgICAgcmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZShcImhyZWZcIikgPT09IFwiI1wiO1xuICAgIH0pKSB7XG4gICAgICBhZGRIYW5kbGUoXCJ0eXBlfGhyZWZ8aGVpZ2h0fHdpZHRoXCIsIGZ1bmN0aW9uKGVsZW0sIG5hbWUsIGlzWE1MKSB7XG4gICAgICAgIGlmICghaXNYTUwpIHtcbiAgICAgICAgICByZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUobmFtZSwgbmFtZS50b0xvd2VyQ2FzZSgpID09PSBcInR5cGVcIiA/IDEgOiAyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICghc3VwcG9ydC5hdHRyaWJ1dGVzIHx8ICFhc3NlcnQoZnVuY3Rpb24oZGl2KSB7XG4gICAgICBkaXYuaW5uZXJIVE1MID0gXCI8aW5wdXQvPlwiO1xuICAgICAgZGl2LmZpcnN0Q2hpbGQuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJcIik7XG4gICAgICByZXR1cm4gZGl2LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIikgPT09IFwiXCI7XG4gICAgfSkpIHtcbiAgICAgIGFkZEhhbmRsZShcInZhbHVlXCIsIGZ1bmN0aW9uKGVsZW0sIG5hbWUsIGlzWE1MKSB7XG4gICAgICAgIGlmICghaXNYTUwgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImlucHV0XCIpIHtcbiAgICAgICAgICByZXR1cm4gZWxlbS5kZWZhdWx0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIWFzc2VydChmdW5jdGlvbihkaXYpIHtcbiAgICAgIHJldHVybiBkaXYuZ2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIikgPT0gbnVsbDtcbiAgICB9KSkge1xuICAgICAgYWRkSGFuZGxlKGJvb2xlYW5zLCBmdW5jdGlvbihlbGVtLCBuYW1lLCBpc1hNTCkge1xuICAgICAgICB2YXIgdmFsO1xuICAgICAgICBpZiAoIWlzWE1MKSB7XG4gICAgICAgICAgcmV0dXJuIGVsZW1bbmFtZV0gPT09IHRydWUgPyBuYW1lLnRvTG93ZXJDYXNlKCkgOiAodmFsID0gZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKG5hbWUpKSAmJiB2YWwuc3BlY2lmaWVkID8gdmFsLnZhbHVlIDogbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBTaXp6bGU7XG4gIH0pKHdpbmRvdyk7XG4gIGpRdWVyeS5maW5kID0gU2l6emxlO1xuICBqUXVlcnkuZXhwciA9IFNpenpsZS5zZWxlY3RvcnM7XG4gIGpRdWVyeS5leHByW1wiOlwiXSA9IGpRdWVyeS5leHByLnBzZXVkb3M7XG4gIGpRdWVyeS51bmlxdWUgPSBTaXp6bGUudW5pcXVlU29ydDtcbiAgalF1ZXJ5LnRleHQgPSBTaXp6bGUuZ2V0VGV4dDtcbiAgalF1ZXJ5LmlzWE1MRG9jID0gU2l6emxlLmlzWE1MO1xuICBqUXVlcnkuY29udGFpbnMgPSBTaXp6bGUuY29udGFpbnM7XG4gIHZhciBybmVlZHNDb250ZXh0ID0galF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0O1xuICB2YXIgcnNpbmdsZVRhZyA9ICgvXjwoXFx3KylcXHMqXFwvPz4oPzo8XFwvXFwxPnwpJC8pO1xuICB2YXIgcmlzU2ltcGxlID0gL14uW146I1xcW1xcLixdKiQvO1xuICBmdW5jdGlvbiB3aW5ub3coZWxlbWVudHMsIHF1YWxpZmllciwgbm90KSB7XG4gICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKHF1YWxpZmllcikpIHtcbiAgICAgIHJldHVybiBqUXVlcnkuZ3JlcChlbGVtZW50cywgZnVuY3Rpb24oZWxlbSwgaSkge1xuICAgICAgICByZXR1cm4gISFxdWFsaWZpZXIuY2FsbChlbGVtLCBpLCBlbGVtKSAhPT0gbm90O1xuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChxdWFsaWZpZXIubm9kZVR5cGUpIHtcbiAgICAgIHJldHVybiBqUXVlcnkuZ3JlcChlbGVtZW50cywgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICByZXR1cm4gKGVsZW0gPT09IHF1YWxpZmllcikgIT09IG5vdDtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHF1YWxpZmllciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgaWYgKHJpc1NpbXBsZS50ZXN0KHF1YWxpZmllcikpIHtcbiAgICAgICAgcmV0dXJuIGpRdWVyeS5maWx0ZXIocXVhbGlmaWVyLCBlbGVtZW50cywgbm90KTtcbiAgICAgIH1cbiAgICAgIHF1YWxpZmllciA9IGpRdWVyeS5maWx0ZXIocXVhbGlmaWVyLCBlbGVtZW50cyk7XG4gICAgfVxuICAgIHJldHVybiBqUXVlcnkuZ3JlcChlbGVtZW50cywgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgcmV0dXJuIChpbmRleE9mLmNhbGwocXVhbGlmaWVyLCBlbGVtKSA+PSAwKSAhPT0gbm90O1xuICAgIH0pO1xuICB9XG4gIGpRdWVyeS5maWx0ZXIgPSBmdW5jdGlvbihleHByLCBlbGVtcywgbm90KSB7XG4gICAgdmFyIGVsZW0gPSBlbGVtc1swXTtcbiAgICBpZiAobm90KSB7XG4gICAgICBleHByID0gXCI6bm90KFwiICsgZXhwciArIFwiKVwiO1xuICAgIH1cbiAgICByZXR1cm4gZWxlbXMubGVuZ3RoID09PSAxICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgPyBqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoZWxlbSwgZXhwcikgPyBbZWxlbV0gOiBbXSA6IGpRdWVyeS5maW5kLm1hdGNoZXMoZXhwciwgalF1ZXJ5LmdyZXAoZWxlbXMsIGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIHJldHVybiBlbGVtLm5vZGVUeXBlID09PSAxO1xuICAgIH0pKTtcbiAgfTtcbiAgalF1ZXJ5LmZuLmV4dGVuZCh7XG4gICAgZmluZDogZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICAgIHZhciBpLFxuICAgICAgICAgIGxlbiA9IHRoaXMubGVuZ3RoLFxuICAgICAgICAgIHJldCA9IFtdLFxuICAgICAgICAgIHNlbGYgPSB0aGlzO1xuICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2soalF1ZXJ5KHNlbGVjdG9yKS5maWx0ZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoalF1ZXJ5LmNvbnRhaW5zKHNlbGZbaV0sIHRoaXMpKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGpRdWVyeS5maW5kKHNlbGVjdG9yLCBzZWxmW2ldLCByZXQpO1xuICAgICAgfVxuICAgICAgcmV0ID0gdGhpcy5wdXNoU3RhY2sobGVuID4gMSA/IGpRdWVyeS51bmlxdWUocmV0KSA6IHJldCk7XG4gICAgICByZXQuc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yID8gdGhpcy5zZWxlY3RvciArIFwiIFwiICsgc2VsZWN0b3IgOiBzZWxlY3RvcjtcbiAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcbiAgICBmaWx0ZXI6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2sod2lubm93KHRoaXMsIHNlbGVjdG9yIHx8IFtdLCBmYWxzZSkpO1xuICAgIH0sXG4gICAgbm90OiBmdW5jdGlvbihzZWxlY3Rvcikge1xuICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKHdpbm5vdyh0aGlzLCBzZWxlY3RvciB8fCBbXSwgdHJ1ZSkpO1xuICAgIH0sXG4gICAgaXM6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICByZXR1cm4gISF3aW5ub3codGhpcywgdHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiICYmIHJuZWVkc0NvbnRleHQudGVzdChzZWxlY3RvcikgPyBqUXVlcnkoc2VsZWN0b3IpIDogc2VsZWN0b3IgfHwgW10sIGZhbHNlKS5sZW5ndGg7XG4gICAgfVxuICB9KTtcbiAgdmFyIHJvb3RqUXVlcnksXG4gICAgICBycXVpY2tFeHByID0gL14oPzpcXHMqKDxbXFx3XFxXXSs+KVtePl0qfCMoW1xcdy1dKikpJC8sXG4gICAgICBpbml0ID0galF1ZXJ5LmZuLmluaXQgPSBmdW5jdGlvbihzZWxlY3RvciwgY29udGV4dCkge1xuICAgICAgICB2YXIgbWF0Y2gsXG4gICAgICAgICAgICBlbGVtO1xuICAgICAgICBpZiAoIXNlbGVjdG9yKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGlmIChzZWxlY3RvclswXSA9PT0gXCI8XCIgJiYgc2VsZWN0b3Jbc2VsZWN0b3IubGVuZ3RoIC0gMV0gPT09IFwiPlwiICYmIHNlbGVjdG9yLmxlbmd0aCA+PSAzKSB7XG4gICAgICAgICAgICBtYXRjaCA9IFtudWxsLCBzZWxlY3RvciwgbnVsbF07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hdGNoID0gcnF1aWNrRXhwci5leGVjKHNlbGVjdG9yKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG1hdGNoICYmIChtYXRjaFsxXSB8fCAhY29udGV4dCkpIHtcbiAgICAgICAgICAgIGlmIChtYXRjaFsxXSkge1xuICAgICAgICAgICAgICBjb250ZXh0ID0gY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSA/IGNvbnRleHRbMF0gOiBjb250ZXh0O1xuICAgICAgICAgICAgICBqUXVlcnkubWVyZ2UodGhpcywgalF1ZXJ5LnBhcnNlSFRNTChtYXRjaFsxXSwgY29udGV4dCAmJiBjb250ZXh0Lm5vZGVUeXBlID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBkb2N1bWVudCwgdHJ1ZSkpO1xuICAgICAgICAgICAgICBpZiAocnNpbmdsZVRhZy50ZXN0KG1hdGNoWzFdKSAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdChjb250ZXh0KSkge1xuICAgICAgICAgICAgICAgIGZvciAobWF0Y2ggaW4gY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKHRoaXNbbWF0Y2hdKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW21hdGNoXShjb250ZXh0W21hdGNoXSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHIobWF0Y2gsIGNvbnRleHRbbWF0Y2hdKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWF0Y2hbMl0pO1xuICAgICAgICAgICAgICBpZiAoZWxlbSAmJiBlbGVtLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxlbmd0aCA9IDE7XG4gICAgICAgICAgICAgICAgdGhpc1swXSA9IGVsZW07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gZG9jdW1lbnQ7XG4gICAgICAgICAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmICghY29udGV4dCB8fCBjb250ZXh0LmpxdWVyeSkge1xuICAgICAgICAgICAgcmV0dXJuIChjb250ZXh0IHx8IHJvb3RqUXVlcnkpLmZpbmQoc2VsZWN0b3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvcihjb250ZXh0KS5maW5kKHNlbGVjdG9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0b3Iubm9kZVR5cGUpIHtcbiAgICAgICAgICB0aGlzLmNvbnRleHQgPSB0aGlzWzBdID0gc2VsZWN0b3I7XG4gICAgICAgICAgdGhpcy5sZW5ndGggPSAxO1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9IGVsc2UgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKHNlbGVjdG9yKSkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2Ygcm9vdGpRdWVyeS5yZWFkeSAhPT0gXCJ1bmRlZmluZWRcIiA/IHJvb3RqUXVlcnkucmVhZHkoc2VsZWN0b3IpIDogc2VsZWN0b3IoalF1ZXJ5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0b3Iuc2VsZWN0b3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3Rvci5zZWxlY3RvcjtcbiAgICAgICAgICB0aGlzLmNvbnRleHQgPSBzZWxlY3Rvci5jb250ZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBqUXVlcnkubWFrZUFycmF5KHNlbGVjdG9yLCB0aGlzKTtcbiAgICAgIH07XG4gIGluaXQucHJvdG90eXBlID0galF1ZXJ5LmZuO1xuICByb290alF1ZXJ5ID0galF1ZXJ5KGRvY3VtZW50KTtcbiAgdmFyIHJwYXJlbnRzcHJldiA9IC9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLFxuICAgICAgZ3VhcmFudGVlZFVuaXF1ZSA9IHtcbiAgICAgICAgY2hpbGRyZW46IHRydWUsXG4gICAgICAgIGNvbnRlbnRzOiB0cnVlLFxuICAgICAgICBuZXh0OiB0cnVlLFxuICAgICAgICBwcmV2OiB0cnVlXG4gICAgICB9O1xuICBqUXVlcnkuZXh0ZW5kKHtcbiAgICBkaXI6IGZ1bmN0aW9uKGVsZW0sIGRpciwgdW50aWwpIHtcbiAgICAgIHZhciBtYXRjaGVkID0gW10sXG4gICAgICAgICAgdHJ1bmNhdGUgPSB1bnRpbCAhPT0gdW5kZWZpbmVkO1xuICAgICAgd2hpbGUgKChlbGVtID0gZWxlbVtkaXJdKSAmJiBlbGVtLm5vZGVUeXBlICE9PSA5KSB7XG4gICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgaWYgKHRydW5jYXRlICYmIGpRdWVyeShlbGVtKS5pcyh1bnRpbCkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBtYXRjaGVkLnB1c2goZWxlbSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBtYXRjaGVkO1xuICAgIH0sXG4gICAgc2libGluZzogZnVuY3Rpb24obiwgZWxlbSkge1xuICAgICAgdmFyIG1hdGNoZWQgPSBbXTtcbiAgICAgIGZvciAoOyBuOyBuID0gbi5uZXh0U2libGluZykge1xuICAgICAgICBpZiAobi5ub2RlVHlwZSA9PT0gMSAmJiBuICE9PSBlbGVtKSB7XG4gICAgICAgICAgbWF0Y2hlZC5wdXNoKG4pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbWF0Y2hlZDtcbiAgICB9XG4gIH0pO1xuICBqUXVlcnkuZm4uZXh0ZW5kKHtcbiAgICBoYXM6IGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICAgdmFyIHRhcmdldHMgPSBqUXVlcnkodGFyZ2V0LCB0aGlzKSxcbiAgICAgICAgICBsID0gdGFyZ2V0cy5sZW5ndGg7XG4gICAgICByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICBpZiAoalF1ZXJ5LmNvbnRhaW5zKHRoaXMsIHRhcmdldHNbaV0pKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY2xvc2VzdDogZnVuY3Rpb24oc2VsZWN0b3JzLCBjb250ZXh0KSB7XG4gICAgICB2YXIgY3VyLFxuICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgIGwgPSB0aGlzLmxlbmd0aCxcbiAgICAgICAgICBtYXRjaGVkID0gW10sXG4gICAgICAgICAgcG9zID0gcm5lZWRzQ29udGV4dC50ZXN0KHNlbGVjdG9ycykgfHwgdHlwZW9mIHNlbGVjdG9ycyAhPT0gXCJzdHJpbmdcIiA/IGpRdWVyeShzZWxlY3RvcnMsIGNvbnRleHQgfHwgdGhpcy5jb250ZXh0KSA6IDA7XG4gICAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgICBmb3IgKGN1ciA9IHRoaXNbaV07IGN1ciAmJiBjdXIgIT09IGNvbnRleHQ7IGN1ciA9IGN1ci5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgaWYgKGN1ci5ub2RlVHlwZSA8IDExICYmIChwb3MgPyBwb3MuaW5kZXgoY3VyKSA+IC0xIDogY3VyLm5vZGVUeXBlID09PSAxICYmIGpRdWVyeS5maW5kLm1hdGNoZXNTZWxlY3RvcihjdXIsIHNlbGVjdG9ycykpKSB7XG4gICAgICAgICAgICBtYXRjaGVkLnB1c2goY3VyKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKG1hdGNoZWQubGVuZ3RoID4gMSA/IGpRdWVyeS51bmlxdWUobWF0Y2hlZCkgOiBtYXRjaGVkKTtcbiAgICB9LFxuICAgIGluZGV4OiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICBpZiAoIWVsZW0pIHtcbiAgICAgICAgcmV0dXJuICh0aGlzWzBdICYmIHRoaXNbMF0ucGFyZW50Tm9kZSkgPyB0aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aCA6IC0xO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBlbGVtID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiBpbmRleE9mLmNhbGwoalF1ZXJ5KGVsZW0pLCB0aGlzWzBdKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBpbmRleE9mLmNhbGwodGhpcywgZWxlbS5qcXVlcnkgPyBlbGVtWzBdIDogZWxlbSk7XG4gICAgfSxcbiAgICBhZGQ6IGZ1bmN0aW9uKHNlbGVjdG9yLCBjb250ZXh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2soalF1ZXJ5LnVuaXF1ZShqUXVlcnkubWVyZ2UodGhpcy5nZXQoKSwgalF1ZXJ5KHNlbGVjdG9yLCBjb250ZXh0KSkpKTtcbiAgICB9LFxuICAgIGFkZEJhY2s6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICByZXR1cm4gdGhpcy5hZGQoc2VsZWN0b3IgPT0gbnVsbCA/IHRoaXMucHJldk9iamVjdCA6IHRoaXMucHJldk9iamVjdC5maWx0ZXIoc2VsZWN0b3IpKTtcbiAgICB9XG4gIH0pO1xuICBmdW5jdGlvbiBzaWJsaW5nKGN1ciwgZGlyKSB7XG4gICAgd2hpbGUgKChjdXIgPSBjdXJbZGlyXSkgJiYgY3VyLm5vZGVUeXBlICE9PSAxKSB7fVxuICAgIHJldHVybiBjdXI7XG4gIH1cbiAgalF1ZXJ5LmVhY2goe1xuICAgIHBhcmVudDogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTtcbiAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50Lm5vZGVUeXBlICE9PSAxMSA/IHBhcmVudCA6IG51bGw7XG4gICAgfSxcbiAgICBwYXJlbnRzOiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICByZXR1cm4galF1ZXJ5LmRpcihlbGVtLCBcInBhcmVudE5vZGVcIik7XG4gICAgfSxcbiAgICBwYXJlbnRzVW50aWw6IGZ1bmN0aW9uKGVsZW0sIGksIHVudGlsKSB7XG4gICAgICByZXR1cm4galF1ZXJ5LmRpcihlbGVtLCBcInBhcmVudE5vZGVcIiwgdW50aWwpO1xuICAgIH0sXG4gICAgbmV4dDogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgcmV0dXJuIHNpYmxpbmcoZWxlbSwgXCJuZXh0U2libGluZ1wiKTtcbiAgICB9LFxuICAgIHByZXY6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIHJldHVybiBzaWJsaW5nKGVsZW0sIFwicHJldmlvdXNTaWJsaW5nXCIpO1xuICAgIH0sXG4gICAgbmV4dEFsbDogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgcmV0dXJuIGpRdWVyeS5kaXIoZWxlbSwgXCJuZXh0U2libGluZ1wiKTtcbiAgICB9LFxuICAgIHByZXZBbGw6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIHJldHVybiBqUXVlcnkuZGlyKGVsZW0sIFwicHJldmlvdXNTaWJsaW5nXCIpO1xuICAgIH0sXG4gICAgbmV4dFVudGlsOiBmdW5jdGlvbihlbGVtLCBpLCB1bnRpbCkge1xuICAgICAgcmV0dXJuIGpRdWVyeS5kaXIoZWxlbSwgXCJuZXh0U2libGluZ1wiLCB1bnRpbCk7XG4gICAgfSxcbiAgICBwcmV2VW50aWw6IGZ1bmN0aW9uKGVsZW0sIGksIHVudGlsKSB7XG4gICAgICByZXR1cm4galF1ZXJ5LmRpcihlbGVtLCBcInByZXZpb3VzU2libGluZ1wiLCB1bnRpbCk7XG4gICAgfSxcbiAgICBzaWJsaW5nczogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgcmV0dXJuIGpRdWVyeS5zaWJsaW5nKChlbGVtLnBhcmVudE5vZGUgfHwge30pLmZpcnN0Q2hpbGQsIGVsZW0pO1xuICAgIH0sXG4gICAgY2hpbGRyZW46IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIHJldHVybiBqUXVlcnkuc2libGluZyhlbGVtLmZpcnN0Q2hpbGQpO1xuICAgIH0sXG4gICAgY29udGVudHM6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgIHJldHVybiBlbGVtLmNvbnRlbnREb2N1bWVudCB8fCBqUXVlcnkubWVyZ2UoW10sIGVsZW0uY2hpbGROb2Rlcyk7XG4gICAgfVxuICB9LCBmdW5jdGlvbihuYW1lLCBmbikge1xuICAgIGpRdWVyeS5mbltuYW1lXSA9IGZ1bmN0aW9uKHVudGlsLCBzZWxlY3Rvcikge1xuICAgICAgdmFyIG1hdGNoZWQgPSBqUXVlcnkubWFwKHRoaXMsIGZuLCB1bnRpbCk7XG4gICAgICBpZiAobmFtZS5zbGljZSgtNSkgIT09IFwiVW50aWxcIikge1xuICAgICAgICBzZWxlY3RvciA9IHVudGlsO1xuICAgICAgfVxuICAgICAgaWYgKHNlbGVjdG9yICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBtYXRjaGVkID0galF1ZXJ5LmZpbHRlcihzZWxlY3RvciwgbWF0Y2hlZCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGlmICghZ3VhcmFudGVlZFVuaXF1ZVtuYW1lXSkge1xuICAgICAgICAgIGpRdWVyeS51bmlxdWUobWF0Y2hlZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJwYXJlbnRzcHJldi50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgbWF0Y2hlZC5yZXZlcnNlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhtYXRjaGVkKTtcbiAgICB9O1xuICB9KTtcbiAgdmFyIHJub3R3aGl0ZSA9ICgvXFxTKy9nKTtcbiAgdmFyIG9wdGlvbnNDYWNoZSA9IHt9O1xuICBmdW5jdGlvbiBjcmVhdGVPcHRpb25zKG9wdGlvbnMpIHtcbiAgICB2YXIgb2JqZWN0ID0gb3B0aW9uc0NhY2hlW29wdGlvbnNdID0ge307XG4gICAgalF1ZXJ5LmVhY2gob3B0aW9ucy5tYXRjaChybm90d2hpdGUpIHx8IFtdLCBmdW5jdGlvbihfLCBmbGFnKSB7XG4gICAgICBvYmplY3RbZmxhZ10gPSB0cnVlO1xuICAgIH0pO1xuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cbiAgalF1ZXJ5LkNhbGxiYWNrcyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIgPyAob3B0aW9uc0NhY2hlW29wdGlvbnNdIHx8IGNyZWF0ZU9wdGlvbnMob3B0aW9ucykpIDogalF1ZXJ5LmV4dGVuZCh7fSwgb3B0aW9ucyk7XG4gICAgdmFyIG1lbW9yeSxcbiAgICAgICAgZmlyZWQsXG4gICAgICAgIGZpcmluZyxcbiAgICAgICAgZmlyaW5nU3RhcnQsXG4gICAgICAgIGZpcmluZ0xlbmd0aCxcbiAgICAgICAgZmlyaW5nSW5kZXgsXG4gICAgICAgIGxpc3QgPSBbXSxcbiAgICAgICAgc3RhY2sgPSAhb3B0aW9ucy5vbmNlICYmIFtdLFxuICAgICAgICBmaXJlID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIG1lbW9yeSA9IG9wdGlvbnMubWVtb3J5ICYmIGRhdGE7XG4gICAgICAgICAgZmlyZWQgPSB0cnVlO1xuICAgICAgICAgIGZpcmluZ0luZGV4ID0gZmlyaW5nU3RhcnQgfHwgMDtcbiAgICAgICAgICBmaXJpbmdTdGFydCA9IDA7XG4gICAgICAgICAgZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5ndGg7XG4gICAgICAgICAgZmlyaW5nID0gdHJ1ZTtcbiAgICAgICAgICBmb3IgKDsgbGlzdCAmJiBmaXJpbmdJbmRleCA8IGZpcmluZ0xlbmd0aDsgZmlyaW5nSW5kZXgrKykge1xuICAgICAgICAgICAgaWYgKGxpc3RbZmlyaW5nSW5kZXhdLmFwcGx5KGRhdGFbMF0sIGRhdGFbMV0pID09PSBmYWxzZSAmJiBvcHRpb25zLnN0b3BPbkZhbHNlKSB7XG4gICAgICAgICAgICAgIG1lbW9yeSA9IGZhbHNlO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZmlyaW5nID0gZmFsc2U7XG4gICAgICAgICAgaWYgKGxpc3QpIHtcbiAgICAgICAgICAgIGlmIChzdGFjaykge1xuICAgICAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZmlyZShzdGFjay5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChtZW1vcnkpIHtcbiAgICAgICAgICAgICAgbGlzdCA9IFtdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc2VsZi5kaXNhYmxlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZWxmID0ge1xuICAgICAgICAgIGFkZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAobGlzdCkge1xuICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgKGZ1bmN0aW9uIGFkZChhcmdzKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5LmVhY2goYXJncywgZnVuY3Rpb24oXywgYXJnKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGpRdWVyeS50eXBlKGFyZyk7XG4gICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy51bmlxdWUgfHwgIXNlbGYuaGFzKGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICBsaXN0LnB1c2goYXJnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhcmcgJiYgYXJnLmxlbmd0aCAmJiB0eXBlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZChhcmcpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9KShhcmd1bWVudHMpO1xuICAgICAgICAgICAgICBpZiAoZmlyaW5nKSB7XG4gICAgICAgICAgICAgICAgZmlyaW5nTGVuZ3RoID0gbGlzdC5sZW5ndGg7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVtb3J5KSB7XG4gICAgICAgICAgICAgICAgZmlyaW5nU3RhcnQgPSBzdGFydDtcbiAgICAgICAgICAgICAgICBmaXJlKG1lbW9yeSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChsaXN0KSB7XG4gICAgICAgICAgICAgIGpRdWVyeS5lYWNoKGFyZ3VtZW50cywgZnVuY3Rpb24oXywgYXJnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4O1xuICAgICAgICAgICAgICAgIHdoaWxlICgoaW5kZXggPSBqUXVlcnkuaW5BcnJheShhcmcsIGxpc3QsIGluZGV4KSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgbGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgaWYgKGZpcmluZykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPD0gZmlyaW5nTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZmlyaW5nTGVuZ3RoLS07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4IDw9IGZpcmluZ0luZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgZmlyaW5nSW5kZXgtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICB9LFxuICAgICAgICAgIGhhczogZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgIHJldHVybiBmbiA/IGpRdWVyeS5pbkFycmF5KGZuLCBsaXN0KSA+IC0xIDogISEobGlzdCAmJiBsaXN0Lmxlbmd0aCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlbXB0eTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsaXN0ID0gW107XG4gICAgICAgICAgICBmaXJpbmdMZW5ndGggPSAwO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBkaXNhYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxpc3QgPSBzdGFjayA9IG1lbW9yeSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZGlzYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICFsaXN0O1xuICAgICAgICAgIH0sXG4gICAgICAgICAgbG9jazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzdGFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmICghbWVtb3J5KSB7XG4gICAgICAgICAgICAgIHNlbGYuZGlzYWJsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBsb2NrZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICFzdGFjaztcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZpcmVXaXRoOiBmdW5jdGlvbihjb250ZXh0LCBhcmdzKSB7XG4gICAgICAgICAgICBpZiAobGlzdCAmJiAoIWZpcmVkIHx8IHN0YWNrKSkge1xuICAgICAgICAgICAgICBhcmdzID0gYXJncyB8fCBbXTtcbiAgICAgICAgICAgICAgYXJncyA9IFtjb250ZXh0LCBhcmdzLnNsaWNlID8gYXJncy5zbGljZSgpIDogYXJnc107XG4gICAgICAgICAgICAgIGlmIChmaXJpbmcpIHtcbiAgICAgICAgICAgICAgICBzdGFjay5wdXNoKGFyZ3MpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpcmUoYXJncyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZmlyZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLmZpcmVXaXRoKHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZpcmVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAhIWZpcmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICByZXR1cm4gc2VsZjtcbiAgfTtcbiAgalF1ZXJ5LmV4dGVuZCh7XG4gICAgRGVmZXJyZWQ6IGZ1bmN0aW9uKGZ1bmMpIHtcbiAgICAgIHZhciB0dXBsZXMgPSBbW1wicmVzb2x2ZVwiLCBcImRvbmVcIiwgalF1ZXJ5LkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLCBcInJlc29sdmVkXCJdLCBbXCJyZWplY3RcIiwgXCJmYWlsXCIsIGpRdWVyeS5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSwgXCJyZWplY3RlZFwiXSwgW1wibm90aWZ5XCIsIFwicHJvZ3Jlc3NcIiwgalF1ZXJ5LkNhbGxiYWNrcyhcIm1lbW9yeVwiKV1dLFxuICAgICAgICAgIHN0YXRlID0gXCJwZW5kaW5nXCIsXG4gICAgICAgICAgcHJvbWlzZSA9IHtcbiAgICAgICAgICAgIHN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFsd2F5czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGRlZmVycmVkLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICB2YXIgZm5zID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgICByZXR1cm4galF1ZXJ5LkRlZmVycmVkKGZ1bmN0aW9uKG5ld0RlZmVyKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5LmVhY2godHVwbGVzLCBmdW5jdGlvbihpLCB0dXBsZSkge1xuICAgICAgICAgICAgICAgICAgdmFyIGZuID0galF1ZXJ5LmlzRnVuY3Rpb24oZm5zW2ldKSAmJiBmbnNbaV07XG4gICAgICAgICAgICAgICAgICBkZWZlcnJlZFt0dXBsZVsxXV0oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXR1cm5lZCA9IGZuICYmIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXR1cm5lZCAmJiBqUXVlcnkuaXNGdW5jdGlvbihyZXR1cm5lZC5wcm9taXNlKSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybmVkLnByb21pc2UoKS5kb25lKG5ld0RlZmVyLnJlc29sdmUpLmZhaWwobmV3RGVmZXIucmVqZWN0KS5wcm9ncmVzcyhuZXdEZWZlci5ub3RpZnkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIG5ld0RlZmVyW3R1cGxlWzBdICsgXCJXaXRoXCJdKHRoaXMgPT09IHByb21pc2UgPyBuZXdEZWZlci5wcm9taXNlKCkgOiB0aGlzLCBmbiA/IFtyZXR1cm5lZF0gOiBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBmbnMgPSBudWxsO1xuICAgICAgICAgICAgICB9KS5wcm9taXNlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvbWlzZTogZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvYmogIT0gbnVsbCA/IGpRdWVyeS5leHRlbmQob2JqLCBwcm9taXNlKSA6IHByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBkZWZlcnJlZCA9IHt9O1xuICAgICAgcHJvbWlzZS5waXBlID0gcHJvbWlzZS50aGVuO1xuICAgICAgalF1ZXJ5LmVhY2godHVwbGVzLCBmdW5jdGlvbihpLCB0dXBsZSkge1xuICAgICAgICB2YXIgbGlzdCA9IHR1cGxlWzJdLFxuICAgICAgICAgICAgc3RhdGVTdHJpbmcgPSB0dXBsZVszXTtcbiAgICAgICAgcHJvbWlzZVt0dXBsZVsxXV0gPSBsaXN0LmFkZDtcbiAgICAgICAgaWYgKHN0YXRlU3RyaW5nKSB7XG4gICAgICAgICAgbGlzdC5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzdGF0ZSA9IHN0YXRlU3RyaW5nO1xuICAgICAgICAgIH0sIHR1cGxlc1tpIF4gMV1bMl0uZGlzYWJsZSwgdHVwbGVzWzJdWzJdLmxvY2spO1xuICAgICAgICB9XG4gICAgICAgIGRlZmVycmVkW3R1cGxlWzBdXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGRlZmVycmVkW3R1cGxlWzBdICsgXCJXaXRoXCJdKHRoaXMgPT09IGRlZmVycmVkID8gcHJvbWlzZSA6IHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIGRlZmVycmVkW3R1cGxlWzBdICsgXCJXaXRoXCJdID0gbGlzdC5maXJlV2l0aDtcbiAgICAgIH0pO1xuICAgICAgcHJvbWlzZS5wcm9taXNlKGRlZmVycmVkKTtcbiAgICAgIGlmIChmdW5jKSB7XG4gICAgICAgIGZ1bmMuY2FsbChkZWZlcnJlZCwgZGVmZXJyZWQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRlZmVycmVkO1xuICAgIH0sXG4gICAgd2hlbjogZnVuY3Rpb24oc3Vib3JkaW5hdGUpIHtcbiAgICAgIHZhciBpID0gMCxcbiAgICAgICAgICByZXNvbHZlVmFsdWVzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpLFxuICAgICAgICAgIGxlbmd0aCA9IHJlc29sdmVWYWx1ZXMubGVuZ3RoLFxuICAgICAgICAgIHJlbWFpbmluZyA9IGxlbmd0aCAhPT0gMSB8fCAoc3Vib3JkaW5hdGUgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oc3Vib3JkaW5hdGUucHJvbWlzZSkpID8gbGVuZ3RoIDogMCxcbiAgICAgICAgICBkZWZlcnJlZCA9IHJlbWFpbmluZyA9PT0gMSA/IHN1Ym9yZGluYXRlIDogalF1ZXJ5LkRlZmVycmVkKCksXG4gICAgICAgICAgdXBkYXRlRnVuYyA9IGZ1bmN0aW9uKGksIGNvbnRleHRzLCB2YWx1ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICBjb250ZXh0c1tpXSA9IHRoaXM7XG4gICAgICAgICAgICAgIHZhbHVlc1tpXSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gc2xpY2UuY2FsbChhcmd1bWVudHMpIDogdmFsdWU7XG4gICAgICAgICAgICAgIGlmICh2YWx1ZXMgPT09IHByb2dyZXNzVmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQubm90aWZ5V2l0aChjb250ZXh0cywgdmFsdWVzKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmICghKC0tcmVtYWluaW5nKSkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmVXaXRoKGNvbnRleHRzLCB2YWx1ZXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcHJvZ3Jlc3NWYWx1ZXMsXG4gICAgICAgICAgcHJvZ3Jlc3NDb250ZXh0cyxcbiAgICAgICAgICByZXNvbHZlQ29udGV4dHM7XG4gICAgICBpZiAobGVuZ3RoID4gMSkge1xuICAgICAgICBwcm9ncmVzc1ZhbHVlcyA9IG5ldyBBcnJheShsZW5ndGgpO1xuICAgICAgICBwcm9ncmVzc0NvbnRleHRzID0gbmV3IEFycmF5KGxlbmd0aCk7XG4gICAgICAgIHJlc29sdmVDb250ZXh0cyA9IG5ldyBBcnJheShsZW5ndGgpO1xuICAgICAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKHJlc29sdmVWYWx1ZXNbaV0gJiYgalF1ZXJ5LmlzRnVuY3Rpb24ocmVzb2x2ZVZhbHVlc1tpXS5wcm9taXNlKSkge1xuICAgICAgICAgICAgcmVzb2x2ZVZhbHVlc1tpXS5wcm9taXNlKCkuZG9uZSh1cGRhdGVGdW5jKGksIHJlc29sdmVDb250ZXh0cywgcmVzb2x2ZVZhbHVlcykpLmZhaWwoZGVmZXJyZWQucmVqZWN0KS5wcm9ncmVzcyh1cGRhdGVGdW5jKGksIHByb2dyZXNzQ29udGV4dHMsIHByb2dyZXNzVmFsdWVzKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC0tcmVtYWluaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCFyZW1haW5pbmcpIHtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZVdpdGgocmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gICAgfVxuICB9KTtcbiAgdmFyIHJlYWR5TGlzdDtcbiAgalF1ZXJ5LmZuLnJlYWR5ID0gZnVuY3Rpb24oZm4pIHtcbiAgICBqUXVlcnkucmVhZHkucHJvbWlzZSgpLmRvbmUoZm4pO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICBqUXVlcnkuZXh0ZW5kKHtcbiAgICBpc1JlYWR5OiBmYWxzZSxcbiAgICByZWFkeVdhaXQ6IDEsXG4gICAgaG9sZFJlYWR5OiBmdW5jdGlvbihob2xkKSB7XG4gICAgICBpZiAoaG9sZCkge1xuICAgICAgICBqUXVlcnkucmVhZHlXYWl0Kys7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBqUXVlcnkucmVhZHkodHJ1ZSk7XG4gICAgICB9XG4gICAgfSxcbiAgICByZWFkeTogZnVuY3Rpb24od2FpdCkge1xuICAgICAgaWYgKHdhaXQgPT09IHRydWUgPyAtLWpRdWVyeS5yZWFkeVdhaXQgOiBqUXVlcnkuaXNSZWFkeSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBqUXVlcnkuaXNSZWFkeSA9IHRydWU7XG4gICAgICBpZiAod2FpdCAhPT0gdHJ1ZSAmJiAtLWpRdWVyeS5yZWFkeVdhaXQgPiAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHJlYWR5TGlzdC5yZXNvbHZlV2l0aChkb2N1bWVudCwgW2pRdWVyeV0pO1xuICAgICAgaWYgKGpRdWVyeS5mbi50cmlnZ2VySGFuZGxlcikge1xuICAgICAgICBqUXVlcnkoZG9jdW1lbnQpLnRyaWdnZXJIYW5kbGVyKFwicmVhZHlcIik7XG4gICAgICAgIGpRdWVyeShkb2N1bWVudCkub2ZmKFwicmVhZHlcIik7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgZnVuY3Rpb24gY29tcGxldGVkKCkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGNvbXBsZXRlZCwgZmFsc2UpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLCBjb21wbGV0ZWQsIGZhbHNlKTtcbiAgICBqUXVlcnkucmVhZHkoKTtcbiAgfVxuICBqUXVlcnkucmVhZHkucHJvbWlzZSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmICghcmVhZHlMaXN0KSB7XG4gICAgICByZWFkeUxpc3QgPSBqUXVlcnkuRGVmZXJyZWQoKTtcbiAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImNvbXBsZXRlXCIpIHtcbiAgICAgICAgc2V0VGltZW91dChqUXVlcnkucmVhZHkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgY29tcGxldGVkLCBmYWxzZSk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBjb21wbGV0ZWQsIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlYWR5TGlzdC5wcm9taXNlKG9iaik7XG4gIH07XG4gIGpRdWVyeS5yZWFkeS5wcm9taXNlKCk7XG4gIHZhciBhY2Nlc3MgPSBqUXVlcnkuYWNjZXNzID0gZnVuY3Rpb24oZWxlbXMsIGZuLCBrZXksIHZhbHVlLCBjaGFpbmFibGUsIGVtcHR5R2V0LCByYXcpIHtcbiAgICB2YXIgaSA9IDAsXG4gICAgICAgIGxlbiA9IGVsZW1zLmxlbmd0aCxcbiAgICAgICAgYnVsayA9IGtleSA9PSBudWxsO1xuICAgIGlmIChqUXVlcnkudHlwZShrZXkpID09PSBcIm9iamVjdFwiKSB7XG4gICAgICBjaGFpbmFibGUgPSB0cnVlO1xuICAgICAgZm9yIChpIGluIGtleSkge1xuICAgICAgICBqUXVlcnkuYWNjZXNzKGVsZW1zLCBmbiwgaSwga2V5W2ldLCB0cnVlLCBlbXB0eUdldCwgcmF3KTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNoYWluYWJsZSA9IHRydWU7XG4gICAgICBpZiAoIWpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgICByYXcgPSB0cnVlO1xuICAgICAgfVxuICAgICAgaWYgKGJ1bGspIHtcbiAgICAgICAgaWYgKHJhdykge1xuICAgICAgICAgIGZuLmNhbGwoZWxlbXMsIHZhbHVlKTtcbiAgICAgICAgICBmbiA9IG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYnVsayA9IGZuO1xuICAgICAgICAgIGZuID0gZnVuY3Rpb24oZWxlbSwga2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGJ1bGsuY2FsbChqUXVlcnkoZWxlbSksIHZhbHVlKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZm4pIHtcbiAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIGZuKGVsZW1zW2ldLCBrZXksIHJhdyA/IHZhbHVlIDogdmFsdWUuY2FsbChlbGVtc1tpXSwgaSwgZm4oZWxlbXNbaV0sIGtleSkpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY2hhaW5hYmxlID8gZWxlbXMgOiBidWxrID8gZm4uY2FsbChlbGVtcykgOiBsZW4gPyBmbihlbGVtc1swXSwga2V5KSA6IGVtcHR5R2V0O1xuICB9O1xuICBqUXVlcnkuYWNjZXB0RGF0YSA9IGZ1bmN0aW9uKG93bmVyKSB7XG4gICAgcmV0dXJuIG93bmVyLm5vZGVUeXBlID09PSAxIHx8IG93bmVyLm5vZGVUeXBlID09PSA5IHx8ICEoK293bmVyLm5vZGVUeXBlKTtcbiAgfTtcbiAgZnVuY3Rpb24gRGF0YSgpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5jYWNoZSA9IHt9LCAwLCB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgfX0pO1xuICAgIHRoaXMuZXhwYW5kbyA9IGpRdWVyeS5leHBhbmRvICsgRGF0YS51aWQrKztcbiAgfVxuICBEYXRhLnVpZCA9IDE7XG4gIERhdGEuYWNjZXB0cyA9IGpRdWVyeS5hY2NlcHREYXRhO1xuICBEYXRhLnByb3RvdHlwZSA9IHtcbiAgICBrZXk6IGZ1bmN0aW9uKG93bmVyKSB7XG4gICAgICBpZiAoIURhdGEuYWNjZXB0cyhvd25lcikpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IHt9LFxuICAgICAgICAgIHVubG9jayA9IG93bmVyW3RoaXMuZXhwYW5kb107XG4gICAgICBpZiAoIXVubG9jaykge1xuICAgICAgICB1bmxvY2sgPSBEYXRhLnVpZCsrO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGRlc2NyaXB0b3JbdGhpcy5leHBhbmRvXSA9IHt2YWx1ZTogdW5sb2NrfTtcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhvd25lciwgZGVzY3JpcHRvcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBkZXNjcmlwdG9yW3RoaXMuZXhwYW5kb10gPSB1bmxvY2s7XG4gICAgICAgICAgalF1ZXJ5LmV4dGVuZChvd25lciwgZGVzY3JpcHRvcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5jYWNoZVt1bmxvY2tdKSB7XG4gICAgICAgIHRoaXMuY2FjaGVbdW5sb2NrXSA9IHt9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVubG9jaztcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24ob3duZXIsIGRhdGEsIHZhbHVlKSB7XG4gICAgICB2YXIgcHJvcCxcbiAgICAgICAgICB1bmxvY2sgPSB0aGlzLmtleShvd25lciksXG4gICAgICAgICAgY2FjaGUgPSB0aGlzLmNhY2hlW3VubG9ja107XG4gICAgICBpZiAodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgY2FjaGVbZGF0YV0gPSB2YWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChqUXVlcnkuaXNFbXB0eU9iamVjdChjYWNoZSkpIHtcbiAgICAgICAgICBqUXVlcnkuZXh0ZW5kKHRoaXMuY2FjaGVbdW5sb2NrXSwgZGF0YSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yIChwcm9wIGluIGRhdGEpIHtcbiAgICAgICAgICAgIGNhY2hlW3Byb3BdID0gZGF0YVtwcm9wXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBjYWNoZTtcbiAgICB9LFxuICAgIGdldDogZnVuY3Rpb24ob3duZXIsIGtleSkge1xuICAgICAgdmFyIGNhY2hlID0gdGhpcy5jYWNoZVt0aGlzLmtleShvd25lcildO1xuICAgICAgcmV0dXJuIGtleSA9PT0gdW5kZWZpbmVkID8gY2FjaGUgOiBjYWNoZVtrZXldO1xuICAgIH0sXG4gICAgYWNjZXNzOiBmdW5jdGlvbihvd25lciwga2V5LCB2YWx1ZSkge1xuICAgICAgdmFyIHN0b3JlZDtcbiAgICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZCB8fCAoKGtleSAmJiB0eXBlb2Yga2V5ID09PSBcInN0cmluZ1wiKSAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgICBzdG9yZWQgPSB0aGlzLmdldChvd25lciwga2V5KTtcbiAgICAgICAgcmV0dXJuIHN0b3JlZCAhPT0gdW5kZWZpbmVkID8gc3RvcmVkIDogdGhpcy5nZXQob3duZXIsIGpRdWVyeS5jYW1lbENhc2Uoa2V5KSk7XG4gICAgICB9XG4gICAgICB0aGlzLnNldChvd25lciwga2V5LCB2YWx1ZSk7XG4gICAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDoga2V5O1xuICAgIH0sXG4gICAgcmVtb3ZlOiBmdW5jdGlvbihvd25lciwga2V5KSB7XG4gICAgICB2YXIgaSxcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGNhbWVsLFxuICAgICAgICAgIHVubG9jayA9IHRoaXMua2V5KG93bmVyKSxcbiAgICAgICAgICBjYWNoZSA9IHRoaXMuY2FjaGVbdW5sb2NrXTtcbiAgICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNhY2hlW3VubG9ja10gPSB7fTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChqUXVlcnkuaXNBcnJheShrZXkpKSB7XG4gICAgICAgICAgbmFtZSA9IGtleS5jb25jYXQoa2V5Lm1hcChqUXVlcnkuY2FtZWxDYXNlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FtZWwgPSBqUXVlcnkuY2FtZWxDYXNlKGtleSk7XG4gICAgICAgICAgaWYgKGtleSBpbiBjYWNoZSkge1xuICAgICAgICAgICAgbmFtZSA9IFtrZXksIGNhbWVsXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmFtZSA9IGNhbWVsO1xuICAgICAgICAgICAgbmFtZSA9IG5hbWUgaW4gY2FjaGUgPyBbbmFtZV0gOiAobmFtZS5tYXRjaChybm90d2hpdGUpIHx8IFtdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaSA9IG5hbWUubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgZGVsZXRlIGNhY2hlW25hbWVbaV1dO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBoYXNEYXRhOiBmdW5jdGlvbihvd25lcikge1xuICAgICAgcmV0dXJuICFqUXVlcnkuaXNFbXB0eU9iamVjdCh0aGlzLmNhY2hlW293bmVyW3RoaXMuZXhwYW5kb11dIHx8IHt9KTtcbiAgICB9LFxuICAgIGRpc2NhcmQ6IGZ1bmN0aW9uKG93bmVyKSB7XG4gICAgICBpZiAob3duZXJbdGhpcy5leHBhbmRvXSkge1xuICAgICAgICBkZWxldGUgdGhpcy5jYWNoZVtvd25lclt0aGlzLmV4cGFuZG9dXTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHZhciBkYXRhX3ByaXYgPSBuZXcgRGF0YSgpO1xuICB2YXIgZGF0YV91c2VyID0gbmV3IERhdGEoKTtcbiAgdmFyIHJicmFjZSA9IC9eKD86XFx7W1xcd1xcV10qXFx9fFxcW1tcXHdcXFddKlxcXSkkLyxcbiAgICAgIHJtdWx0aURhc2ggPSAvKFtBLVpdKS9nO1xuICBmdW5jdGlvbiBkYXRhQXR0cihlbGVtLCBrZXksIGRhdGEpIHtcbiAgICB2YXIgbmFtZTtcbiAgICBpZiAoZGF0YSA9PT0gdW5kZWZpbmVkICYmIGVsZW0ubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgIG5hbWUgPSBcImRhdGEtXCIgKyBrZXkucmVwbGFjZShybXVsdGlEYXNoLCBcIi0kMVwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgZGF0YSA9IGVsZW0uZ2V0QXR0cmlidXRlKG5hbWUpO1xuICAgICAgaWYgKHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZGF0YSA9IGRhdGEgPT09IFwidHJ1ZVwiID8gdHJ1ZSA6IGRhdGEgPT09IFwiZmFsc2VcIiA/IGZhbHNlIDogZGF0YSA9PT0gXCJudWxsXCIgPyBudWxsIDogK2RhdGEgKyBcIlwiID09PSBkYXRhID8gK2RhdGEgOiByYnJhY2UudGVzdChkYXRhKSA/IGpRdWVyeS5wYXJzZUpTT04oZGF0YSkgOiBkYXRhO1xuICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICBkYXRhX3VzZXIuc2V0KGVsZW0sIGtleSwgZGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkYXRhID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBqUXVlcnkuZXh0ZW5kKHtcbiAgICBoYXNEYXRhOiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICByZXR1cm4gZGF0YV91c2VyLmhhc0RhdGEoZWxlbSkgfHwgZGF0YV9wcml2Lmhhc0RhdGEoZWxlbSk7XG4gICAgfSxcbiAgICBkYXRhOiBmdW5jdGlvbihlbGVtLCBuYW1lLCBkYXRhKSB7XG4gICAgICByZXR1cm4gZGF0YV91c2VyLmFjY2VzcyhlbGVtLCBuYW1lLCBkYXRhKTtcbiAgICB9LFxuICAgIHJlbW92ZURhdGE6IGZ1bmN0aW9uKGVsZW0sIG5hbWUpIHtcbiAgICAgIGRhdGFfdXNlci5yZW1vdmUoZWxlbSwgbmFtZSk7XG4gICAgfSxcbiAgICBfZGF0YTogZnVuY3Rpb24oZWxlbSwgbmFtZSwgZGF0YSkge1xuICAgICAgcmV0dXJuIGRhdGFfcHJpdi5hY2Nlc3MoZWxlbSwgbmFtZSwgZGF0YSk7XG4gICAgfSxcbiAgICBfcmVtb3ZlRGF0YTogZnVuY3Rpb24oZWxlbSwgbmFtZSkge1xuICAgICAgZGF0YV9wcml2LnJlbW92ZShlbGVtLCBuYW1lKTtcbiAgICB9XG4gIH0pO1xuICBqUXVlcnkuZm4uZXh0ZW5kKHtcbiAgICBkYXRhOiBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICB2YXIgaSxcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgZWxlbSA9IHRoaXNbMF0sXG4gICAgICAgICAgYXR0cnMgPSBlbGVtICYmIGVsZW0uYXR0cmlidXRlcztcbiAgICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodGhpcy5sZW5ndGgpIHtcbiAgICAgICAgICBkYXRhID0gZGF0YV91c2VyLmdldChlbGVtKTtcbiAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAhZGF0YV9wcml2LmdldChlbGVtLCBcImhhc0RhdGFBdHRyc1wiKSkge1xuICAgICAgICAgICAgaSA9IGF0dHJzLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgICAgaWYgKGF0dHJzW2ldKSB7XG4gICAgICAgICAgICAgICAgbmFtZSA9IGF0dHJzW2ldLm5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUuaW5kZXhPZihcImRhdGEtXCIpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICBuYW1lID0galF1ZXJ5LmNhbWVsQ2FzZShuYW1lLnNsaWNlKDUpKTtcbiAgICAgICAgICAgICAgICAgIGRhdGFBdHRyKGVsZW0sIG5hbWUsIGRhdGFbbmFtZV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YV9wcml2LnNldChlbGVtLCBcImhhc0RhdGFBdHRyc1wiLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIGtleSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGRhdGFfdXNlci5zZXQodGhpcywga2V5KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYWNjZXNzKHRoaXMsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBkYXRhLFxuICAgICAgICAgICAgY2FtZWxLZXkgPSBqUXVlcnkuY2FtZWxDYXNlKGtleSk7XG4gICAgICAgIGlmIChlbGVtICYmIHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBkYXRhID0gZGF0YV91c2VyLmdldChlbGVtLCBrZXkpO1xuICAgICAgICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkYXRhID0gZGF0YV91c2VyLmdldChlbGVtLCBjYW1lbEtleSk7XG4gICAgICAgICAgaWYgKGRhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGRhdGEgPSBkYXRhQXR0cihlbGVtLCBjYW1lbEtleSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICBpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgZGF0YSA9IGRhdGFfdXNlci5nZXQodGhpcywgY2FtZWxLZXkpO1xuICAgICAgICAgIGRhdGFfdXNlci5zZXQodGhpcywgY2FtZWxLZXksIHZhbHVlKTtcbiAgICAgICAgICBpZiAoa2V5LmluZGV4T2YoXCItXCIpICE9PSAtMSAmJiBkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRhdGFfdXNlci5zZXQodGhpcywga2V5LCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSwgbnVsbCwgdHJ1ZSk7XG4gICAgfSxcbiAgICByZW1vdmVEYXRhOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIGRhdGFfdXNlci5yZW1vdmUodGhpcywga2V5KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIGpRdWVyeS5leHRlbmQoe1xuICAgIHF1ZXVlOiBmdW5jdGlvbihlbGVtLCB0eXBlLCBkYXRhKSB7XG4gICAgICB2YXIgcXVldWU7XG4gICAgICBpZiAoZWxlbSkge1xuICAgICAgICB0eXBlID0gKHR5cGUgfHwgXCJmeFwiKSArIFwicXVldWVcIjtcbiAgICAgICAgcXVldWUgPSBkYXRhX3ByaXYuZ2V0KGVsZW0sIHR5cGUpO1xuICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgIGlmICghcXVldWUgfHwgalF1ZXJ5LmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgIHF1ZXVlID0gZGF0YV9wcml2LmFjY2VzcyhlbGVtLCB0eXBlLCBqUXVlcnkubWFrZUFycmF5KGRhdGEpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcXVldWUucHVzaChkYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHF1ZXVlIHx8IFtdO1xuICAgICAgfVxuICAgIH0sXG4gICAgZGVxdWV1ZTogZnVuY3Rpb24oZWxlbSwgdHlwZSkge1xuICAgICAgdHlwZSA9IHR5cGUgfHwgXCJmeFwiO1xuICAgICAgdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKGVsZW0sIHR5cGUpLFxuICAgICAgICAgIHN0YXJ0TGVuZ3RoID0gcXVldWUubGVuZ3RoLFxuICAgICAgICAgIGZuID0gcXVldWUuc2hpZnQoKSxcbiAgICAgICAgICBob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyhlbGVtLCB0eXBlKSxcbiAgICAgICAgICBuZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBqUXVlcnkuZGVxdWV1ZShlbGVtLCB0eXBlKTtcbiAgICAgICAgICB9O1xuICAgICAgaWYgKGZuID09PSBcImlucHJvZ3Jlc3NcIikge1xuICAgICAgICBmbiA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgIHN0YXJ0TGVuZ3RoLS07XG4gICAgICB9XG4gICAgICBpZiAoZm4pIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFwiZnhcIikge1xuICAgICAgICAgIHF1ZXVlLnVuc2hpZnQoXCJpbnByb2dyZXNzXCIpO1xuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSBob29rcy5zdG9wO1xuICAgICAgICBmbi5jYWxsKGVsZW0sIG5leHQsIGhvb2tzKTtcbiAgICAgIH1cbiAgICAgIGlmICghc3RhcnRMZW5ndGggJiYgaG9va3MpIHtcbiAgICAgICAgaG9va3MuZW1wdHkuZmlyZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgX3F1ZXVlSG9va3M6IGZ1bmN0aW9uKGVsZW0sIHR5cGUpIHtcbiAgICAgIHZhciBrZXkgPSB0eXBlICsgXCJxdWV1ZUhvb2tzXCI7XG4gICAgICByZXR1cm4gZGF0YV9wcml2LmdldChlbGVtLCBrZXkpIHx8IGRhdGFfcHJpdi5hY2Nlc3MoZWxlbSwga2V5LCB7ZW1wdHk6IGpRdWVyeS5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKS5hZGQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZGF0YV9wcml2LnJlbW92ZShlbGVtLCBbdHlwZSArIFwicXVldWVcIiwga2V5XSk7XG4gICAgICAgIH0pfSk7XG4gICAgfVxuICB9KTtcbiAgalF1ZXJ5LmZuLmV4dGVuZCh7XG4gICAgcXVldWU6IGZ1bmN0aW9uKHR5cGUsIGRhdGEpIHtcbiAgICAgIHZhciBzZXR0ZXIgPSAyO1xuICAgICAgaWYgKHR5cGVvZiB0eXBlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGRhdGEgPSB0eXBlO1xuICAgICAgICB0eXBlID0gXCJmeFwiO1xuICAgICAgICBzZXR0ZXItLTtcbiAgICAgIH1cbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgc2V0dGVyKSB7XG4gICAgICAgIHJldHVybiBqUXVlcnkucXVldWUodGhpc1swXSwgdHlwZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YSA9PT0gdW5kZWZpbmVkID8gdGhpcyA6IHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKHRoaXMsIHR5cGUsIGRhdGEpO1xuICAgICAgICBqUXVlcnkuX3F1ZXVlSG9va3ModGhpcywgdHlwZSk7XG4gICAgICAgIGlmICh0eXBlID09PSBcImZ4XCIgJiYgcXVldWVbMF0gIT09IFwiaW5wcm9ncmVzc1wiKSB7XG4gICAgICAgICAgalF1ZXJ5LmRlcXVldWUodGhpcywgdHlwZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVxdWV1ZTogZnVuY3Rpb24odHlwZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgalF1ZXJ5LmRlcXVldWUodGhpcywgdHlwZSk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGNsZWFyUXVldWU6IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgIHJldHVybiB0aGlzLnF1ZXVlKHR5cGUgfHwgXCJmeFwiLCBbXSk7XG4gICAgfSxcbiAgICBwcm9taXNlOiBmdW5jdGlvbih0eXBlLCBvYmopIHtcbiAgICAgIHZhciB0bXAsXG4gICAgICAgICAgY291bnQgPSAxLFxuICAgICAgICAgIGRlZmVyID0galF1ZXJ5LkRlZmVycmVkKCksXG4gICAgICAgICAgZWxlbWVudHMgPSB0aGlzLFxuICAgICAgICAgIGkgPSB0aGlzLmxlbmd0aCxcbiAgICAgICAgICByZXNvbHZlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoISgtLWNvdW50KSkge1xuICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlV2l0aChlbGVtZW50cywgW2VsZW1lbnRzXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgIGlmICh0eXBlb2YgdHlwZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBvYmogPSB0eXBlO1xuICAgICAgICB0eXBlID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgdHlwZSA9IHR5cGUgfHwgXCJmeFwiO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICB0bXAgPSBkYXRhX3ByaXYuZ2V0KGVsZW1lbnRzW2ldLCB0eXBlICsgXCJxdWV1ZUhvb2tzXCIpO1xuICAgICAgICBpZiAodG1wICYmIHRtcC5lbXB0eSkge1xuICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgdG1wLmVtcHR5LmFkZChyZXNvbHZlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzb2x2ZSgpO1xuICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2Uob2JqKTtcbiAgICB9XG4gIH0pO1xuICB2YXIgcG51bSA9ICgvWystXT8oPzpcXGQqXFwufClcXGQrKD86W2VFXVsrLV0/XFxkK3wpLykuc291cmNlO1xuICB2YXIgY3NzRXhwYW5kID0gW1wiVG9wXCIsIFwiUmlnaHRcIiwgXCJCb3R0b21cIiwgXCJMZWZ0XCJdO1xuICB2YXIgaXNIaWRkZW4gPSBmdW5jdGlvbihlbGVtLCBlbCkge1xuICAgIGVsZW0gPSBlbCB8fCBlbGVtO1xuICAgIHJldHVybiBqUXVlcnkuY3NzKGVsZW0sIFwiZGlzcGxheVwiKSA9PT0gXCJub25lXCIgfHwgIWpRdWVyeS5jb250YWlucyhlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0pO1xuICB9O1xuICB2YXIgcmNoZWNrYWJsZVR5cGUgPSAoL14oPzpjaGVja2JveHxyYWRpbykkL2kpO1xuICAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxuICAgICAgICBkaXYgPSBmcmFnbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKSxcbiAgICAgICAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInJhZGlvXCIpO1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZShcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIpO1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJ0XCIpO1xuICAgIGRpdi5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgc3VwcG9ydC5jaGVja0Nsb25lID0gZGl2LmNsb25lTm9kZSh0cnVlKS5jbG9uZU5vZGUodHJ1ZSkubGFzdENoaWxkLmNoZWNrZWQ7XG4gICAgZGl2LmlubmVySFRNTCA9IFwiPHRleHRhcmVhPng8L3RleHRhcmVhPlwiO1xuICAgIHN1cHBvcnQubm9DbG9uZUNoZWNrZWQgPSAhIWRpdi5jbG9uZU5vZGUodHJ1ZSkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZTtcbiAgfSkoKTtcbiAgdmFyIHN0cnVuZGVmaW5lZCA9IHR5cGVvZiB1bmRlZmluZWQ7XG4gIHN1cHBvcnQuZm9jdXNpbkJ1YmJsZXMgPSBcIm9uZm9jdXNpblwiIGluIHdpbmRvdztcbiAgdmFyIHJrZXlFdmVudCA9IC9ea2V5LyxcbiAgICAgIHJtb3VzZUV2ZW50ID0gL14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51KXxjbGljay8sXG4gICAgICByZm9jdXNNb3JwaCA9IC9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLyxcbiAgICAgIHJ0eXBlbmFtZXNwYWNlID0gL14oW14uXSopKD86XFwuKC4rKXwpJC87XG4gIGZ1bmN0aW9uIHJldHVyblRydWUoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgZnVuY3Rpb24gcmV0dXJuRmFsc2UoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGZ1bmN0aW9uIHNhZmVBY3RpdmVFbGVtZW50KCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICB9IGNhdGNoIChlcnIpIHt9XG4gIH1cbiAgalF1ZXJ5LmV2ZW50ID0ge1xuICAgIGdsb2JhbDoge30sXG4gICAgYWRkOiBmdW5jdGlvbihlbGVtLCB0eXBlcywgaGFuZGxlciwgZGF0YSwgc2VsZWN0b3IpIHtcbiAgICAgIHZhciBoYW5kbGVPYmpJbixcbiAgICAgICAgICBldmVudEhhbmRsZSxcbiAgICAgICAgICB0bXAsXG4gICAgICAgICAgZXZlbnRzLFxuICAgICAgICAgIHQsXG4gICAgICAgICAgaGFuZGxlT2JqLFxuICAgICAgICAgIHNwZWNpYWwsXG4gICAgICAgICAgaGFuZGxlcnMsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICBuYW1lc3BhY2VzLFxuICAgICAgICAgIG9yaWdUeXBlLFxuICAgICAgICAgIGVsZW1EYXRhID0gZGF0YV9wcml2LmdldChlbGVtKTtcbiAgICAgIGlmICghZWxlbURhdGEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGhhbmRsZXIuaGFuZGxlcikge1xuICAgICAgICBoYW5kbGVPYmpJbiA9IGhhbmRsZXI7XG4gICAgICAgIGhhbmRsZXIgPSBoYW5kbGVPYmpJbi5oYW5kbGVyO1xuICAgICAgICBzZWxlY3RvciA9IGhhbmRsZU9iakluLnNlbGVjdG9yO1xuICAgICAgfVxuICAgICAgaWYgKCFoYW5kbGVyLmd1aWQpIHtcbiAgICAgICAgaGFuZGxlci5ndWlkID0galF1ZXJ5Lmd1aWQrKztcbiAgICAgIH1cbiAgICAgIGlmICghKGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cykpIHtcbiAgICAgICAgZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzID0ge307XG4gICAgICB9XG4gICAgICBpZiAoIShldmVudEhhbmRsZSA9IGVsZW1EYXRhLmhhbmRsZSkpIHtcbiAgICAgICAgZXZlbnRIYW5kbGUgPSBlbGVtRGF0YS5oYW5kbGUgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiBqUXVlcnkgIT09IHN0cnVuZGVmaW5lZCAmJiBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkICE9PSBlLnR5cGUgPyBqUXVlcnkuZXZlbnQuZGlzcGF0Y2guYXBwbHkoZWxlbSwgYXJndW1lbnRzKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHR5cGVzID0gKHR5cGVzIHx8IFwiXCIpLm1hdGNoKHJub3R3aGl0ZSkgfHwgW1wiXCJdO1xuICAgICAgdCA9IHR5cGVzLmxlbmd0aDtcbiAgICAgIHdoaWxlICh0LS0pIHtcbiAgICAgICAgdG1wID0gcnR5cGVuYW1lc3BhY2UuZXhlYyh0eXBlc1t0XSkgfHwgW107XG4gICAgICAgIHR5cGUgPSBvcmlnVHlwZSA9IHRtcFsxXTtcbiAgICAgICAgbmFtZXNwYWNlcyA9ICh0bXBbMl0gfHwgXCJcIikuc3BsaXQoXCIuXCIpLnNvcnQoKTtcbiAgICAgICAgaWYgKCF0eXBlKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsW3R5cGVdIHx8IHt9O1xuICAgICAgICB0eXBlID0gKHNlbGVjdG9yID8gc3BlY2lhbC5kZWxlZ2F0ZVR5cGUgOiBzcGVjaWFsLmJpbmRUeXBlKSB8fCB0eXBlO1xuICAgICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge307XG4gICAgICAgIGhhbmRsZU9iaiA9IGpRdWVyeS5leHRlbmQoe1xuICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgb3JpZ1R5cGU6IG9yaWdUeXBlLFxuICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgaGFuZGxlcjogaGFuZGxlcixcbiAgICAgICAgICBndWlkOiBoYW5kbGVyLmd1aWQsXG4gICAgICAgICAgc2VsZWN0b3I6IHNlbGVjdG9yLFxuICAgICAgICAgIG5lZWRzQ29udGV4dDogc2VsZWN0b3IgJiYgalF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3Qoc2VsZWN0b3IpLFxuICAgICAgICAgIG5hbWVzcGFjZTogbmFtZXNwYWNlcy5qb2luKFwiLlwiKVxuICAgICAgICB9LCBoYW5kbGVPYmpJbik7XG4gICAgICAgIGlmICghKGhhbmRsZXJzID0gZXZlbnRzW3R5cGVdKSkge1xuICAgICAgICAgIGhhbmRsZXJzID0gZXZlbnRzW3R5cGVdID0gW107XG4gICAgICAgICAgaGFuZGxlcnMuZGVsZWdhdGVDb3VudCA9IDA7XG4gICAgICAgICAgaWYgKCFzcGVjaWFsLnNldHVwIHx8IHNwZWNpYWwuc2V0dXAuY2FsbChlbGVtLCBkYXRhLCBuYW1lc3BhY2VzLCBldmVudEhhbmRsZSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBpZiAoZWxlbS5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBldmVudEhhbmRsZSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3BlY2lhbC5hZGQpIHtcbiAgICAgICAgICBzcGVjaWFsLmFkZC5jYWxsKGVsZW0sIGhhbmRsZU9iaik7XG4gICAgICAgICAgaWYgKCFoYW5kbGVPYmouaGFuZGxlci5ndWlkKSB7XG4gICAgICAgICAgICBoYW5kbGVPYmouaGFuZGxlci5ndWlkID0gaGFuZGxlci5ndWlkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgICBoYW5kbGVycy5zcGxpY2UoaGFuZGxlcnMuZGVsZWdhdGVDb3VudCsrLCAwLCBoYW5kbGVPYmopO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlT2JqKTtcbiAgICAgICAgfVxuICAgICAgICBqUXVlcnkuZXZlbnQuZ2xvYmFsW3R5cGVdID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHJlbW92ZTogZnVuY3Rpb24oZWxlbSwgdHlwZXMsIGhhbmRsZXIsIHNlbGVjdG9yLCBtYXBwZWRUeXBlcykge1xuICAgICAgdmFyIGosXG4gICAgICAgICAgb3JpZ0NvdW50LFxuICAgICAgICAgIHRtcCxcbiAgICAgICAgICBldmVudHMsXG4gICAgICAgICAgdCxcbiAgICAgICAgICBoYW5kbGVPYmosXG4gICAgICAgICAgc3BlY2lhbCxcbiAgICAgICAgICBoYW5kbGVycyxcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIG5hbWVzcGFjZXMsXG4gICAgICAgICAgb3JpZ1R5cGUsXG4gICAgICAgICAgZWxlbURhdGEgPSBkYXRhX3ByaXYuaGFzRGF0YShlbGVtKSAmJiBkYXRhX3ByaXYuZ2V0KGVsZW0pO1xuICAgICAgaWYgKCFlbGVtRGF0YSB8fCAhKGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdHlwZXMgPSAodHlwZXMgfHwgXCJcIikubWF0Y2gocm5vdHdoaXRlKSB8fCBbXCJcIl07XG4gICAgICB0ID0gdHlwZXMubGVuZ3RoO1xuICAgICAgd2hpbGUgKHQtLSkge1xuICAgICAgICB0bXAgPSBydHlwZW5hbWVzcGFjZS5leGVjKHR5cGVzW3RdKSB8fCBbXTtcbiAgICAgICAgdHlwZSA9IG9yaWdUeXBlID0gdG1wWzFdO1xuICAgICAgICBuYW1lc3BhY2VzID0gKHRtcFsyXSB8fCBcIlwiKS5zcGxpdChcIi5cIikuc29ydCgpO1xuICAgICAgICBpZiAoIXR5cGUpIHtcbiAgICAgICAgICBmb3IgKHR5cGUgaW4gZXZlbnRzKSB7XG4gICAgICAgICAgICBqUXVlcnkuZXZlbnQucmVtb3ZlKGVsZW0sIHR5cGUgKyB0eXBlc1t0XSwgaGFuZGxlciwgc2VsZWN0b3IsIHRydWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge307XG4gICAgICAgIHR5cGUgPSAoc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUpIHx8IHR5cGU7XG4gICAgICAgIGhhbmRsZXJzID0gZXZlbnRzW3R5cGVdIHx8IFtdO1xuICAgICAgICB0bXAgPSB0bXBbMl0gJiYgbmV3IFJlZ0V4cChcIihefFxcXFwuKVwiICsgbmFtZXNwYWNlcy5qb2luKFwiXFxcXC4oPzouKlxcXFwufClcIikgKyBcIihcXFxcLnwkKVwiKTtcbiAgICAgICAgb3JpZ0NvdW50ID0gaiA9IGhhbmRsZXJzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGotLSkge1xuICAgICAgICAgIGhhbmRsZU9iaiA9IGhhbmRsZXJzW2pdO1xuICAgICAgICAgIGlmICgobWFwcGVkVHlwZXMgfHwgb3JpZ1R5cGUgPT09IGhhbmRsZU9iai5vcmlnVHlwZSkgJiYgKCFoYW5kbGVyIHx8IGhhbmRsZXIuZ3VpZCA9PT0gaGFuZGxlT2JqLmd1aWQpICYmICghdG1wIHx8IHRtcC50ZXN0KGhhbmRsZU9iai5uYW1lc3BhY2UpKSAmJiAoIXNlbGVjdG9yIHx8IHNlbGVjdG9yID09PSBoYW5kbGVPYmouc2VsZWN0b3IgfHwgc2VsZWN0b3IgPT09IFwiKipcIiAmJiBoYW5kbGVPYmouc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICBoYW5kbGVycy5zcGxpY2UoaiwgMSk7XG4gICAgICAgICAgICBpZiAoaGFuZGxlT2JqLnNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgIGhhbmRsZXJzLmRlbGVnYXRlQ291bnQtLTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzcGVjaWFsLnJlbW92ZSkge1xuICAgICAgICAgICAgICBzcGVjaWFsLnJlbW92ZS5jYWxsKGVsZW0sIGhhbmRsZU9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChvcmlnQ291bnQgJiYgIWhhbmRsZXJzLmxlbmd0aCkge1xuICAgICAgICAgIGlmICghc3BlY2lhbC50ZWFyZG93biB8fCBzcGVjaWFsLnRlYXJkb3duLmNhbGwoZWxlbSwgbmFtZXNwYWNlcywgZWxlbURhdGEuaGFuZGxlKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGpRdWVyeS5yZW1vdmVFdmVudChlbGVtLCB0eXBlLCBlbGVtRGF0YS5oYW5kbGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkZWxldGUgZXZlbnRzW3R5cGVdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoalF1ZXJ5LmlzRW1wdHlPYmplY3QoZXZlbnRzKSkge1xuICAgICAgICBkZWxldGUgZWxlbURhdGEuaGFuZGxlO1xuICAgICAgICBkYXRhX3ByaXYucmVtb3ZlKGVsZW0sIFwiZXZlbnRzXCIpO1xuICAgICAgfVxuICAgIH0sXG4gICAgdHJpZ2dlcjogZnVuY3Rpb24oZXZlbnQsIGRhdGEsIGVsZW0sIG9ubHlIYW5kbGVycykge1xuICAgICAgdmFyIGksXG4gICAgICAgICAgY3VyLFxuICAgICAgICAgIHRtcCxcbiAgICAgICAgICBidWJibGVUeXBlLFxuICAgICAgICAgIG9udHlwZSxcbiAgICAgICAgICBoYW5kbGUsXG4gICAgICAgICAgc3BlY2lhbCxcbiAgICAgICAgICBldmVudFBhdGggPSBbZWxlbSB8fCBkb2N1bWVudF0sXG4gICAgICAgICAgdHlwZSA9IGhhc093bi5jYWxsKGV2ZW50LCBcInR5cGVcIikgPyBldmVudC50eXBlIDogZXZlbnQsXG4gICAgICAgICAgbmFtZXNwYWNlcyA9IGhhc093bi5jYWxsKGV2ZW50LCBcIm5hbWVzcGFjZVwiKSA/IGV2ZW50Lm5hbWVzcGFjZS5zcGxpdChcIi5cIikgOiBbXTtcbiAgICAgIGN1ciA9IHRtcCA9IGVsZW0gPSBlbGVtIHx8IGRvY3VtZW50O1xuICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IDMgfHwgZWxlbS5ub2RlVHlwZSA9PT0gOCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAocmZvY3VzTW9ycGgudGVzdCh0eXBlICsgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGUuaW5kZXhPZihcIi5cIikgPj0gMCkge1xuICAgICAgICBuYW1lc3BhY2VzID0gdHlwZS5zcGxpdChcIi5cIik7XG4gICAgICAgIHR5cGUgPSBuYW1lc3BhY2VzLnNoaWZ0KCk7XG4gICAgICAgIG5hbWVzcGFjZXMuc29ydCgpO1xuICAgICAgfVxuICAgICAgb250eXBlID0gdHlwZS5pbmRleE9mKFwiOlwiKSA8IDAgJiYgXCJvblwiICsgdHlwZTtcbiAgICAgIGV2ZW50ID0gZXZlbnRbalF1ZXJ5LmV4cGFuZG9dID8gZXZlbnQgOiBuZXcgalF1ZXJ5LkV2ZW50KHR5cGUsIHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCk7XG4gICAgICBldmVudC5pc1RyaWdnZXIgPSBvbmx5SGFuZGxlcnMgPyAyIDogMztcbiAgICAgIGV2ZW50Lm5hbWVzcGFjZSA9IG5hbWVzcGFjZXMuam9pbihcIi5cIik7XG4gICAgICBldmVudC5uYW1lc3BhY2VfcmUgPSBldmVudC5uYW1lc3BhY2UgPyBuZXcgUmVnRXhwKFwiKF58XFxcXC4pXCIgKyBuYW1lc3BhY2VzLmpvaW4oXCJcXFxcLig/Oi4qXFxcXC58KVwiKSArIFwiKFxcXFwufCQpXCIpIDogbnVsbDtcbiAgICAgIGV2ZW50LnJlc3VsdCA9IHVuZGVmaW5lZDtcbiAgICAgIGlmICghZXZlbnQudGFyZ2V0KSB7XG4gICAgICAgIGV2ZW50LnRhcmdldCA9IGVsZW07XG4gICAgICB9XG4gICAgICBkYXRhID0gZGF0YSA9PSBudWxsID8gW2V2ZW50XSA6IGpRdWVyeS5tYWtlQXJyYXkoZGF0YSwgW2V2ZW50XSk7XG4gICAgICBzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbdHlwZV0gfHwge307XG4gICAgICBpZiAoIW9ubHlIYW5kbGVycyAmJiBzcGVjaWFsLnRyaWdnZXIgJiYgc3BlY2lhbC50cmlnZ2VyLmFwcGx5KGVsZW0sIGRhdGEpID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoIW9ubHlIYW5kbGVycyAmJiAhc3BlY2lhbC5ub0J1YmJsZSAmJiAhalF1ZXJ5LmlzV2luZG93KGVsZW0pKSB7XG4gICAgICAgIGJ1YmJsZVR5cGUgPSBzcGVjaWFsLmRlbGVnYXRlVHlwZSB8fCB0eXBlO1xuICAgICAgICBpZiAoIXJmb2N1c01vcnBoLnRlc3QoYnViYmxlVHlwZSArIHR5cGUpKSB7XG4gICAgICAgICAgY3VyID0gY3VyLnBhcmVudE5vZGU7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IGN1cjsgY3VyID0gY3VyLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICBldmVudFBhdGgucHVzaChjdXIpO1xuICAgICAgICAgIHRtcCA9IGN1cjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodG1wID09PSAoZWxlbS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50KSkge1xuICAgICAgICAgIGV2ZW50UGF0aC5wdXNoKHRtcC5kZWZhdWx0VmlldyB8fCB0bXAucGFyZW50V2luZG93IHx8IHdpbmRvdyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGkgPSAwO1xuICAgICAgd2hpbGUgKChjdXIgPSBldmVudFBhdGhbaSsrXSkgJiYgIWV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpIHtcbiAgICAgICAgZXZlbnQudHlwZSA9IGkgPiAxID8gYnViYmxlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUgfHwgdHlwZTtcbiAgICAgICAgaGFuZGxlID0gKGRhdGFfcHJpdi5nZXQoY3VyLCBcImV2ZW50c1wiKSB8fCB7fSlbZXZlbnQudHlwZV0gJiYgZGF0YV9wcml2LmdldChjdXIsIFwiaGFuZGxlXCIpO1xuICAgICAgICBpZiAoaGFuZGxlKSB7XG4gICAgICAgICAgaGFuZGxlLmFwcGx5KGN1ciwgZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgaGFuZGxlID0gb250eXBlICYmIGN1cltvbnR5cGVdO1xuICAgICAgICBpZiAoaGFuZGxlICYmIGhhbmRsZS5hcHBseSAmJiBqUXVlcnkuYWNjZXB0RGF0YShjdXIpKSB7XG4gICAgICAgICAgZXZlbnQucmVzdWx0ID0gaGFuZGxlLmFwcGx5KGN1ciwgZGF0YSk7XG4gICAgICAgICAgaWYgKGV2ZW50LnJlc3VsdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBldmVudC50eXBlID0gdHlwZTtcbiAgICAgIGlmICghb25seUhhbmRsZXJzICYmICFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkge1xuICAgICAgICBpZiAoKCFzcGVjaWFsLl9kZWZhdWx0IHx8IHNwZWNpYWwuX2RlZmF1bHQuYXBwbHkoZXZlbnRQYXRoLnBvcCgpLCBkYXRhKSA9PT0gZmFsc2UpICYmIGpRdWVyeS5hY2NlcHREYXRhKGVsZW0pKSB7XG4gICAgICAgICAgaWYgKG9udHlwZSAmJiBqUXVlcnkuaXNGdW5jdGlvbihlbGVtW3R5cGVdKSAmJiAhalF1ZXJ5LmlzV2luZG93KGVsZW0pKSB7XG4gICAgICAgICAgICB0bXAgPSBlbGVtW29udHlwZV07XG4gICAgICAgICAgICBpZiAodG1wKSB7XG4gICAgICAgICAgICAgIGVsZW1bb250eXBlXSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdHlwZTtcbiAgICAgICAgICAgIGVsZW1bdHlwZV0oKTtcbiAgICAgICAgICAgIGpRdWVyeS5ldmVudC50cmlnZ2VyZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAodG1wKSB7XG4gICAgICAgICAgICAgIGVsZW1bb250eXBlXSA9IHRtcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBldmVudC5yZXN1bHQ7XG4gICAgfSxcbiAgICBkaXNwYXRjaDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGV2ZW50ID0galF1ZXJ5LmV2ZW50LmZpeChldmVudCk7XG4gICAgICB2YXIgaSxcbiAgICAgICAgICBqLFxuICAgICAgICAgIHJldCxcbiAgICAgICAgICBtYXRjaGVkLFxuICAgICAgICAgIGhhbmRsZU9iaixcbiAgICAgICAgICBoYW5kbGVyUXVldWUgPSBbXSxcbiAgICAgICAgICBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpLFxuICAgICAgICAgIGhhbmRsZXJzID0gKGRhdGFfcHJpdi5nZXQodGhpcywgXCJldmVudHNcIikgfHwge30pW2V2ZW50LnR5cGVdIHx8IFtdLFxuICAgICAgICAgIHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFtldmVudC50eXBlXSB8fCB7fTtcbiAgICAgIGFyZ3NbMF0gPSBldmVudDtcbiAgICAgIGV2ZW50LmRlbGVnYXRlVGFyZ2V0ID0gdGhpcztcbiAgICAgIGlmIChzcGVjaWFsLnByZURpc3BhdGNoICYmIHNwZWNpYWwucHJlRGlzcGF0Y2guY2FsbCh0aGlzLCBldmVudCkgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGhhbmRsZXJRdWV1ZSA9IGpRdWVyeS5ldmVudC5oYW5kbGVycy5jYWxsKHRoaXMsIGV2ZW50LCBoYW5kbGVycyk7XG4gICAgICBpID0gMDtcbiAgICAgIHdoaWxlICgobWF0Y2hlZCA9IGhhbmRsZXJRdWV1ZVtpKytdKSAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSkge1xuICAgICAgICBldmVudC5jdXJyZW50VGFyZ2V0ID0gbWF0Y2hlZC5lbGVtO1xuICAgICAgICBqID0gMDtcbiAgICAgICAgd2hpbGUgKChoYW5kbGVPYmogPSBtYXRjaGVkLmhhbmRsZXJzW2orK10pICYmICFldmVudC5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKSB7XG4gICAgICAgICAgaWYgKCFldmVudC5uYW1lc3BhY2VfcmUgfHwgZXZlbnQubmFtZXNwYWNlX3JlLnRlc3QoaGFuZGxlT2JqLm5hbWVzcGFjZSkpIHtcbiAgICAgICAgICAgIGV2ZW50LmhhbmRsZU9iaiA9IGhhbmRsZU9iajtcbiAgICAgICAgICAgIGV2ZW50LmRhdGEgPSBoYW5kbGVPYmouZGF0YTtcbiAgICAgICAgICAgIHJldCA9ICgoalF1ZXJ5LmV2ZW50LnNwZWNpYWxbaGFuZGxlT2JqLm9yaWdUeXBlXSB8fCB7fSkuaGFuZGxlIHx8IGhhbmRsZU9iai5oYW5kbGVyKS5hcHBseShtYXRjaGVkLmVsZW0sIGFyZ3MpO1xuICAgICAgICAgICAgaWYgKHJldCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGlmICgoZXZlbnQucmVzdWx0ID0gcmV0KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoc3BlY2lhbC5wb3N0RGlzcGF0Y2gpIHtcbiAgICAgICAgc3BlY2lhbC5wb3N0RGlzcGF0Y2guY2FsbCh0aGlzLCBldmVudCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZXZlbnQucmVzdWx0O1xuICAgIH0sXG4gICAgaGFuZGxlcnM6IGZ1bmN0aW9uKGV2ZW50LCBoYW5kbGVycykge1xuICAgICAgdmFyIGksXG4gICAgICAgICAgbWF0Y2hlcyxcbiAgICAgICAgICBzZWwsXG4gICAgICAgICAgaGFuZGxlT2JqLFxuICAgICAgICAgIGhhbmRsZXJRdWV1ZSA9IFtdLFxuICAgICAgICAgIGRlbGVnYXRlQ291bnQgPSBoYW5kbGVycy5kZWxlZ2F0ZUNvdW50LFxuICAgICAgICAgIGN1ciA9IGV2ZW50LnRhcmdldDtcbiAgICAgIGlmIChkZWxlZ2F0ZUNvdW50ICYmIGN1ci5ub2RlVHlwZSAmJiAoIWV2ZW50LmJ1dHRvbiB8fCBldmVudC50eXBlICE9PSBcImNsaWNrXCIpKSB7XG4gICAgICAgIGZvciAoOyBjdXIgIT09IHRoaXM7IGN1ciA9IGN1ci5wYXJlbnROb2RlIHx8IHRoaXMpIHtcbiAgICAgICAgICBpZiAoY3VyLmRpc2FibGVkICE9PSB0cnVlIHx8IGV2ZW50LnR5cGUgIT09IFwiY2xpY2tcIikge1xuICAgICAgICAgICAgbWF0Y2hlcyA9IFtdO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGRlbGVnYXRlQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgICBoYW5kbGVPYmogPSBoYW5kbGVyc1tpXTtcbiAgICAgICAgICAgICAgc2VsID0gaGFuZGxlT2JqLnNlbGVjdG9yICsgXCIgXCI7XG4gICAgICAgICAgICAgIGlmIChtYXRjaGVzW3NlbF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG1hdGNoZXNbc2VsXSA9IGhhbmRsZU9iai5uZWVkc0NvbnRleHQgPyBqUXVlcnkoc2VsLCB0aGlzKS5pbmRleChjdXIpID49IDAgOiBqUXVlcnkuZmluZChzZWwsIHRoaXMsIG51bGwsIFtjdXJdKS5sZW5ndGg7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKG1hdGNoZXNbc2VsXSkge1xuICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaChoYW5kbGVPYmopO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobWF0Y2hlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgaGFuZGxlclF1ZXVlLnB1c2goe1xuICAgICAgICAgICAgICAgIGVsZW06IGN1cixcbiAgICAgICAgICAgICAgICBoYW5kbGVyczogbWF0Y2hlc1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChkZWxlZ2F0ZUNvdW50IDwgaGFuZGxlcnMubGVuZ3RoKSB7XG4gICAgICAgIGhhbmRsZXJRdWV1ZS5wdXNoKHtcbiAgICAgICAgICBlbGVtOiB0aGlzLFxuICAgICAgICAgIGhhbmRsZXJzOiBoYW5kbGVycy5zbGljZShkZWxlZ2F0ZUNvdW50KVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBoYW5kbGVyUXVldWU7XG4gICAgfSxcbiAgICBwcm9wczogXCJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2hcIi5zcGxpdChcIiBcIiksXG4gICAgZml4SG9va3M6IHt9LFxuICAgIGtleUhvb2tzOiB7XG4gICAgICBwcm9wczogXCJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlXCIuc3BsaXQoXCIgXCIpLFxuICAgICAgZmlsdGVyOiBmdW5jdGlvbihldmVudCwgb3JpZ2luYWwpIHtcbiAgICAgICAgaWYgKGV2ZW50LndoaWNoID09IG51bGwpIHtcbiAgICAgICAgICBldmVudC53aGljaCA9IG9yaWdpbmFsLmNoYXJDb2RlICE9IG51bGwgPyBvcmlnaW5hbC5jaGFyQ29kZSA6IG9yaWdpbmFsLmtleUNvZGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV2ZW50O1xuICAgICAgfVxuICAgIH0sXG4gICAgbW91c2VIb29rczoge1xuICAgICAgcHJvcHM6IFwiYnV0dG9uIGJ1dHRvbnMgY2xpZW50WCBjbGllbnRZIG9mZnNldFggb2Zmc2V0WSBwYWdlWCBwYWdlWSBzY3JlZW5YIHNjcmVlblkgdG9FbGVtZW50XCIuc3BsaXQoXCIgXCIpLFxuICAgICAgZmlsdGVyOiBmdW5jdGlvbihldmVudCwgb3JpZ2luYWwpIHtcbiAgICAgICAgdmFyIGV2ZW50RG9jLFxuICAgICAgICAgICAgZG9jLFxuICAgICAgICAgICAgYm9keSxcbiAgICAgICAgICAgIGJ1dHRvbiA9IG9yaWdpbmFsLmJ1dHRvbjtcbiAgICAgICAgaWYgKGV2ZW50LnBhZ2VYID09IG51bGwgJiYgb3JpZ2luYWwuY2xpZW50WCAhPSBudWxsKSB7XG4gICAgICAgICAgZXZlbnREb2MgPSBldmVudC50YXJnZXQub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudDtcbiAgICAgICAgICBkb2MgPSBldmVudERvYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgICAgYm9keSA9IGV2ZW50RG9jLmJvZHk7XG4gICAgICAgICAgZXZlbnQucGFnZVggPSBvcmlnaW5hbC5jbGllbnRYICsgKGRvYyAmJiBkb2Muc2Nyb2xsTGVmdCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsTGVmdCB8fCAwKSAtIChkb2MgJiYgZG9jLmNsaWVudExlZnQgfHwgYm9keSAmJiBib2R5LmNsaWVudExlZnQgfHwgMCk7XG4gICAgICAgICAgZXZlbnQucGFnZVkgPSBvcmlnaW5hbC5jbGllbnRZICsgKGRvYyAmJiBkb2Muc2Nyb2xsVG9wIHx8IGJvZHkgJiYgYm9keS5zY3JvbGxUb3AgfHwgMCkgLSAoZG9jICYmIGRvYy5jbGllbnRUb3AgfHwgYm9keSAmJiBib2R5LmNsaWVudFRvcCB8fCAwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWV2ZW50LndoaWNoICYmIGJ1dHRvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgZXZlbnQud2hpY2ggPSAoYnV0dG9uICYgMSA/IDEgOiAoYnV0dG9uICYgMiA/IDMgOiAoYnV0dG9uICYgNCA/IDIgOiAwKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudDtcbiAgICAgIH1cbiAgICB9LFxuICAgIGZpeDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmIChldmVudFtqUXVlcnkuZXhwYW5kb10pIHtcbiAgICAgICAgcmV0dXJuIGV2ZW50O1xuICAgICAgfVxuICAgICAgdmFyIGksXG4gICAgICAgICAgcHJvcCxcbiAgICAgICAgICBjb3B5LFxuICAgICAgICAgIHR5cGUgPSBldmVudC50eXBlLFxuICAgICAgICAgIG9yaWdpbmFsRXZlbnQgPSBldmVudCxcbiAgICAgICAgICBmaXhIb29rID0gdGhpcy5maXhIb29rc1t0eXBlXTtcbiAgICAgIGlmICghZml4SG9vaykge1xuICAgICAgICB0aGlzLmZpeEhvb2tzW3R5cGVdID0gZml4SG9vayA9IHJtb3VzZUV2ZW50LnRlc3QodHlwZSkgPyB0aGlzLm1vdXNlSG9va3MgOiBya2V5RXZlbnQudGVzdCh0eXBlKSA/IHRoaXMua2V5SG9va3MgOiB7fTtcbiAgICAgIH1cbiAgICAgIGNvcHkgPSBmaXhIb29rLnByb3BzID8gdGhpcy5wcm9wcy5jb25jYXQoZml4SG9vay5wcm9wcykgOiB0aGlzLnByb3BzO1xuICAgICAgZXZlbnQgPSBuZXcgalF1ZXJ5LkV2ZW50KG9yaWdpbmFsRXZlbnQpO1xuICAgICAgaSA9IGNvcHkubGVuZ3RoO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBwcm9wID0gY29weVtpXTtcbiAgICAgICAgZXZlbnRbcHJvcF0gPSBvcmlnaW5hbEV2ZW50W3Byb3BdO1xuICAgICAgfVxuICAgICAgaWYgKCFldmVudC50YXJnZXQpIHtcbiAgICAgICAgZXZlbnQudGFyZ2V0ID0gZG9jdW1lbnQ7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5vZGVUeXBlID09PSAzKSB7XG4gICAgICAgIGV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZpeEhvb2suZmlsdGVyID8gZml4SG9vay5maWx0ZXIoZXZlbnQsIG9yaWdpbmFsRXZlbnQpIDogZXZlbnQ7XG4gICAgfSxcbiAgICBzcGVjaWFsOiB7XG4gICAgICBsb2FkOiB7bm9CdWJibGU6IHRydWV9LFxuICAgICAgZm9jdXM6IHtcbiAgICAgICAgdHJpZ2dlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMgIT09IHNhZmVBY3RpdmVFbGVtZW50KCkgJiYgdGhpcy5mb2N1cykge1xuICAgICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZGVsZWdhdGVUeXBlOiBcImZvY3VzaW5cIlxuICAgICAgfSxcbiAgICAgIGJsdXI6IHtcbiAgICAgICAgdHJpZ2dlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMgPT09IHNhZmVBY3RpdmVFbGVtZW50KCkgJiYgdGhpcy5ibHVyKSB7XG4gICAgICAgICAgICB0aGlzLmJsdXIoKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGVnYXRlVHlwZTogXCJmb2N1c291dFwiXG4gICAgICB9LFxuICAgICAgY2xpY2s6IHtcbiAgICAgICAgdHJpZ2dlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gXCJjaGVja2JveFwiICYmIHRoaXMuY2xpY2sgJiYgalF1ZXJ5Lm5vZGVOYW1lKHRoaXMsIFwiaW5wdXRcIikpIHtcbiAgICAgICAgICAgIHRoaXMuY2xpY2soKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9kZWZhdWx0OiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgIHJldHVybiBqUXVlcnkubm9kZU5hbWUoZXZlbnQudGFyZ2V0LCBcImFcIik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBiZWZvcmV1bmxvYWQ6IHtwb3N0RGlzcGF0Y2g6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgaWYgKGV2ZW50LnJlc3VsdCAhPT0gdW5kZWZpbmVkICYmIGV2ZW50Lm9yaWdpbmFsRXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50Lm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWUgPSBldmVudC5yZXN1bHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9fVxuICAgIH0sXG4gICAgc2ltdWxhdGU6IGZ1bmN0aW9uKHR5cGUsIGVsZW0sIGV2ZW50LCBidWJibGUpIHtcbiAgICAgIHZhciBlID0galF1ZXJ5LmV4dGVuZChuZXcgalF1ZXJ5LkV2ZW50KCksIGV2ZW50LCB7XG4gICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgIGlzU2ltdWxhdGVkOiB0cnVlLFxuICAgICAgICBvcmlnaW5hbEV2ZW50OiB7fVxuICAgICAgfSk7XG4gICAgICBpZiAoYnViYmxlKSB7XG4gICAgICAgIGpRdWVyeS5ldmVudC50cmlnZ2VyKGUsIG51bGwsIGVsZW0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgalF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmNhbGwoZWxlbSwgZSk7XG4gICAgICB9XG4gICAgICBpZiAoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgalF1ZXJ5LnJlbW92ZUV2ZW50ID0gZnVuY3Rpb24oZWxlbSwgdHlwZSwgaGFuZGxlKSB7XG4gICAgaWYgKGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcikge1xuICAgICAgZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZSwgZmFsc2UpO1xuICAgIH1cbiAgfTtcbiAgalF1ZXJ5LkV2ZW50ID0gZnVuY3Rpb24oc3JjLCBwcm9wcykge1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBqUXVlcnkuRXZlbnQpKSB7XG4gICAgICByZXR1cm4gbmV3IGpRdWVyeS5FdmVudChzcmMsIHByb3BzKTtcbiAgICB9XG4gICAgaWYgKHNyYyAmJiBzcmMudHlwZSkge1xuICAgICAgdGhpcy5vcmlnaW5hbEV2ZW50ID0gc3JjO1xuICAgICAgdGhpcy50eXBlID0gc3JjLnR5cGU7XG4gICAgICB0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IHNyYy5kZWZhdWx0UHJldmVudGVkIHx8IHNyYy5kZWZhdWx0UHJldmVudGVkID09PSB1bmRlZmluZWQgJiYgc3JjLnJldHVyblZhbHVlID09PSBmYWxzZSA/IHJldHVyblRydWUgOiByZXR1cm5GYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50eXBlID0gc3JjO1xuICAgIH1cbiAgICBpZiAocHJvcHMpIHtcbiAgICAgIGpRdWVyeS5leHRlbmQodGhpcywgcHJvcHMpO1xuICAgIH1cbiAgICB0aGlzLnRpbWVTdGFtcCA9IHNyYyAmJiBzcmMudGltZVN0YW1wIHx8IGpRdWVyeS5ub3coKTtcbiAgICB0aGlzW2pRdWVyeS5leHBhbmRvXSA9IHRydWU7XG4gIH07XG4gIGpRdWVyeS5FdmVudC5wcm90b3R5cGUgPSB7XG4gICAgaXNEZWZhdWx0UHJldmVudGVkOiByZXR1cm5GYWxzZSxcbiAgICBpc1Byb3BhZ2F0aW9uU3RvcHBlZDogcmV0dXJuRmFsc2UsXG4gICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLFxuICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50O1xuICAgICAgdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSByZXR1cm5UcnVlO1xuICAgICAgaWYgKGUgJiYgZS5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7XG4gICAgICB0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTtcbiAgICAgIGlmIChlICYmIGUuc3RvcFByb3BhZ2F0aW9uKSB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7XG4gICAgICB0aGlzLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTtcbiAgICAgIGlmIChlICYmIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKSB7XG4gICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICB9XG4gICAgICB0aGlzLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cbiAgfTtcbiAgalF1ZXJ5LmVhY2goe1xuICAgIG1vdXNlZW50ZXI6IFwibW91c2VvdmVyXCIsXG4gICAgbW91c2VsZWF2ZTogXCJtb3VzZW91dFwiLFxuICAgIHBvaW50ZXJlbnRlcjogXCJwb2ludGVyb3ZlclwiLFxuICAgIHBvaW50ZXJsZWF2ZTogXCJwb2ludGVyb3V0XCJcbiAgfSwgZnVuY3Rpb24ob3JpZywgZml4KSB7XG4gICAgalF1ZXJ5LmV2ZW50LnNwZWNpYWxbb3JpZ10gPSB7XG4gICAgICBkZWxlZ2F0ZVR5cGU6IGZpeCxcbiAgICAgIGJpbmRUeXBlOiBmaXgsXG4gICAgICBoYW5kbGU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHZhciByZXQsXG4gICAgICAgICAgICB0YXJnZXQgPSB0aGlzLFxuICAgICAgICAgICAgcmVsYXRlZCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQsXG4gICAgICAgICAgICBoYW5kbGVPYmogPSBldmVudC5oYW5kbGVPYmo7XG4gICAgICAgIGlmICghcmVsYXRlZCB8fCAocmVsYXRlZCAhPT0gdGFyZ2V0ICYmICFqUXVlcnkuY29udGFpbnModGFyZ2V0LCByZWxhdGVkKSkpIHtcbiAgICAgICAgICBldmVudC50eXBlID0gaGFuZGxlT2JqLm9yaWdUeXBlO1xuICAgICAgICAgIHJldCA9IGhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgZXZlbnQudHlwZSA9IGZpeDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xuICBpZiAoIXN1cHBvcnQuZm9jdXNpbkJ1YmJsZXMpIHtcbiAgICBqUXVlcnkuZWFjaCh7XG4gICAgICBmb2N1czogXCJmb2N1c2luXCIsXG4gICAgICBibHVyOiBcImZvY3Vzb3V0XCJcbiAgICB9LCBmdW5jdGlvbihvcmlnLCBmaXgpIHtcbiAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKGZpeCwgZXZlbnQudGFyZ2V0LCBqUXVlcnkuZXZlbnQuZml4KGV2ZW50KSwgdHJ1ZSk7XG4gICAgICB9O1xuICAgICAgalF1ZXJ5LmV2ZW50LnNwZWNpYWxbZml4XSA9IHtcbiAgICAgICAgc2V0dXA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBkb2MgPSB0aGlzLm93bmVyRG9jdW1lbnQgfHwgdGhpcyxcbiAgICAgICAgICAgICAgYXR0YWNoZXMgPSBkYXRhX3ByaXYuYWNjZXNzKGRvYywgZml4KTtcbiAgICAgICAgICBpZiAoIWF0dGFjaGVzKSB7XG4gICAgICAgICAgICBkb2MuYWRkRXZlbnRMaXN0ZW5lcihvcmlnLCBoYW5kbGVyLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGF0YV9wcml2LmFjY2Vzcyhkb2MsIGZpeCwgKGF0dGFjaGVzIHx8IDApICsgMSk7XG4gICAgICAgIH0sXG4gICAgICAgIHRlYXJkb3duOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsXG4gICAgICAgICAgICAgIGF0dGFjaGVzID0gZGF0YV9wcml2LmFjY2Vzcyhkb2MsIGZpeCkgLSAxO1xuICAgICAgICAgIGlmICghYXR0YWNoZXMpIHtcbiAgICAgICAgICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKG9yaWcsIGhhbmRsZXIsIHRydWUpO1xuICAgICAgICAgICAgZGF0YV9wcml2LnJlbW92ZShkb2MsIGZpeCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRhdGFfcHJpdi5hY2Nlc3MoZG9jLCBmaXgsIGF0dGFjaGVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSk7XG4gIH1cbiAgalF1ZXJ5LmZuLmV4dGVuZCh7XG4gICAgb246IGZ1bmN0aW9uKHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4sIG9uZSkge1xuICAgICAgdmFyIG9yaWdGbixcbiAgICAgICAgICB0eXBlO1xuICAgICAgaWYgKHR5cGVvZiB0eXBlcyA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgZGF0YSA9IGRhdGEgfHwgc2VsZWN0b3I7XG4gICAgICAgICAgc2VsZWN0b3IgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh0eXBlIGluIHR5cGVzKSB7XG4gICAgICAgICAgdGhpcy5vbih0eXBlLCBzZWxlY3RvciwgZGF0YSwgdHlwZXNbdHlwZV0sIG9uZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICBpZiAoZGF0YSA9PSBudWxsICYmIGZuID09IG51bGwpIHtcbiAgICAgICAgZm4gPSBzZWxlY3RvcjtcbiAgICAgICAgZGF0YSA9IHNlbGVjdG9yID0gdW5kZWZpbmVkO1xuICAgICAgfSBlbHNlIGlmIChmbiA9PSBudWxsKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICBmbiA9IGRhdGE7XG4gICAgICAgICAgZGF0YSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmbiA9IGRhdGE7XG4gICAgICAgICAgZGF0YSA9IHNlbGVjdG9yO1xuICAgICAgICAgIHNlbGVjdG9yID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZm4gPT09IGZhbHNlKSB7XG4gICAgICAgIGZuID0gcmV0dXJuRmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKCFmbikge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIGlmIChvbmUgPT09IDEpIHtcbiAgICAgICAgb3JpZ0ZuID0gZm47XG4gICAgICAgIGZuID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICBqUXVlcnkoKS5vZmYoZXZlbnQpO1xuICAgICAgICAgIHJldHVybiBvcmlnRm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICAgICAgZm4uZ3VpZCA9IG9yaWdGbi5ndWlkIHx8IChvcmlnRm4uZ3VpZCA9IGpRdWVyeS5ndWlkKyspO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgalF1ZXJ5LmV2ZW50LmFkZCh0aGlzLCB0eXBlcywgZm4sIGRhdGEsIHNlbGVjdG9yKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgb25lOiBmdW5jdGlvbih0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuKSB7XG4gICAgICByZXR1cm4gdGhpcy5vbih0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLCAxKTtcbiAgICB9LFxuICAgIG9mZjogZnVuY3Rpb24odHlwZXMsIHNlbGVjdG9yLCBmbikge1xuICAgICAgdmFyIGhhbmRsZU9iaixcbiAgICAgICAgICB0eXBlO1xuICAgICAgaWYgKHR5cGVzICYmIHR5cGVzLnByZXZlbnREZWZhdWx0ICYmIHR5cGVzLmhhbmRsZU9iaikge1xuICAgICAgICBoYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7XG4gICAgICAgIGpRdWVyeSh0eXBlcy5kZWxlZ2F0ZVRhcmdldCkub2ZmKGhhbmRsZU9iai5uYW1lc3BhY2UgPyBoYW5kbGVPYmoub3JpZ1R5cGUgKyBcIi5cIiArIGhhbmRsZU9iai5uYW1lc3BhY2UgOiBoYW5kbGVPYmoub3JpZ1R5cGUsIGhhbmRsZU9iai5zZWxlY3RvciwgaGFuZGxlT2JqLmhhbmRsZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdHlwZXMgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgZm9yICh0eXBlIGluIHR5cGVzKSB7XG4gICAgICAgICAgdGhpcy5vZmYodHlwZSwgc2VsZWN0b3IsIHR5cGVzW3R5cGVdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIGlmIChzZWxlY3RvciA9PT0gZmFsc2UgfHwgdHlwZW9mIHNlbGVjdG9yID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgZm4gPSBzZWxlY3RvcjtcbiAgICAgICAgc2VsZWN0b3IgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBpZiAoZm4gPT09IGZhbHNlKSB7XG4gICAgICAgIGZuID0gcmV0dXJuRmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBqUXVlcnkuZXZlbnQucmVtb3ZlKHRoaXMsIHR5cGVzLCBmbiwgc2VsZWN0b3IpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICB0cmlnZ2VyOiBmdW5jdGlvbih0eXBlLCBkYXRhKSB7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBqUXVlcnkuZXZlbnQudHJpZ2dlcih0eXBlLCBkYXRhLCB0aGlzKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uKHR5cGUsIGRhdGEpIHtcbiAgICAgIHZhciBlbGVtID0gdGhpc1swXTtcbiAgICAgIGlmIChlbGVtKSB7XG4gICAgICAgIHJldHVybiBqUXVlcnkuZXZlbnQudHJpZ2dlcih0eXBlLCBkYXRhLCBlbGVtLCB0cnVlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICB2YXIgcnhodG1sVGFnID0gLzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzpdKylbXj5dKilcXC8+L2dpLFxuICAgICAgcnRhZ05hbWUgPSAvPChbXFx3Ol0rKS8sXG4gICAgICByaHRtbCA9IC88fCYjP1xcdys7LyxcbiAgICAgIHJub0lubmVyaHRtbCA9IC88KD86c2NyaXB0fHN0eWxlfGxpbmspL2ksXG4gICAgICByY2hlY2tlZCA9IC9jaGVja2VkXFxzKig/OltePV18PVxccyouY2hlY2tlZC4pL2ksXG4gICAgICByc2NyaXB0VHlwZSA9IC9eJHxcXC8oPzpqYXZhfGVjbWEpc2NyaXB0L2ksXG4gICAgICByc2NyaXB0VHlwZU1hc2tlZCA9IC9edHJ1ZVxcLyguKikvLFxuICAgICAgcmNsZWFuU2NyaXB0ID0gL15cXHMqPCEoPzpcXFtDREFUQVxcW3wtLSl8KD86XFxdXFxdfC0tKT5cXHMqJC9nLFxuICAgICAgd3JhcE1hcCA9IHtcbiAgICAgICAgb3B0aW9uOiBbMSwgXCI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+XCIsIFwiPC9zZWxlY3Q+XCJdLFxuICAgICAgICB0aGVhZDogWzEsIFwiPHRhYmxlPlwiLCBcIjwvdGFibGU+XCJdLFxuICAgICAgICBjb2w6IFsyLCBcIjx0YWJsZT48Y29sZ3JvdXA+XCIsIFwiPC9jb2xncm91cD48L3RhYmxlPlwiXSxcbiAgICAgICAgdHI6IFsyLCBcIjx0YWJsZT48dGJvZHk+XCIsIFwiPC90Ym9keT48L3RhYmxlPlwiXSxcbiAgICAgICAgdGQ6IFszLCBcIjx0YWJsZT48dGJvZHk+PHRyPlwiLCBcIjwvdHI+PC90Ym9keT48L3RhYmxlPlwiXSxcbiAgICAgICAgX2RlZmF1bHQ6IFswLCBcIlwiLCBcIlwiXVxuICAgICAgfTtcbiAgd3JhcE1hcC5vcHRncm91cCA9IHdyYXBNYXAub3B0aW9uO1xuICB3cmFwTWFwLnRib2R5ID0gd3JhcE1hcC50Zm9vdCA9IHdyYXBNYXAuY29sZ3JvdXAgPSB3cmFwTWFwLmNhcHRpb24gPSB3cmFwTWFwLnRoZWFkO1xuICB3cmFwTWFwLnRoID0gd3JhcE1hcC50ZDtcbiAgZnVuY3Rpb24gbWFuaXB1bGF0aW9uVGFyZ2V0KGVsZW0sIGNvbnRlbnQpIHtcbiAgICByZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKGVsZW0sIFwidGFibGVcIikgJiYgalF1ZXJ5Lm5vZGVOYW1lKGNvbnRlbnQubm9kZVR5cGUgIT09IDExID8gY29udGVudCA6IGNvbnRlbnQuZmlyc3RDaGlsZCwgXCJ0clwiKSA/IGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0Ym9keVwiKVswXSB8fCBlbGVtLmFwcGVuZENoaWxkKGVsZW0ub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGJvZHlcIikpIDogZWxlbTtcbiAgfVxuICBmdW5jdGlvbiBkaXNhYmxlU2NyaXB0KGVsZW0pIHtcbiAgICBlbGVtLnR5cGUgPSAoZWxlbS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpICE9PSBudWxsKSArIFwiL1wiICsgZWxlbS50eXBlO1xuICAgIHJldHVybiBlbGVtO1xuICB9XG4gIGZ1bmN0aW9uIHJlc3RvcmVTY3JpcHQoZWxlbSkge1xuICAgIHZhciBtYXRjaCA9IHJzY3JpcHRUeXBlTWFza2VkLmV4ZWMoZWxlbS50eXBlKTtcbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgIGVsZW0udHlwZSA9IG1hdGNoWzFdO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZShcInR5cGVcIik7XG4gICAgfVxuICAgIHJldHVybiBlbGVtO1xuICB9XG4gIGZ1bmN0aW9uIHNldEdsb2JhbEV2YWwoZWxlbXMsIHJlZkVsZW1lbnRzKSB7XG4gICAgdmFyIGkgPSAwLFxuICAgICAgICBsID0gZWxlbXMubGVuZ3RoO1xuICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgICBkYXRhX3ByaXYuc2V0KGVsZW1zW2ldLCBcImdsb2JhbEV2YWxcIiwgIXJlZkVsZW1lbnRzIHx8IGRhdGFfcHJpdi5nZXQocmVmRWxlbWVudHNbaV0sIFwiZ2xvYmFsRXZhbFwiKSk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGNsb25lQ29weUV2ZW50KHNyYywgZGVzdCkge1xuICAgIHZhciBpLFxuICAgICAgICBsLFxuICAgICAgICB0eXBlLFxuICAgICAgICBwZGF0YU9sZCxcbiAgICAgICAgcGRhdGFDdXIsXG4gICAgICAgIHVkYXRhT2xkLFxuICAgICAgICB1ZGF0YUN1cixcbiAgICAgICAgZXZlbnRzO1xuICAgIGlmIChkZXN0Lm5vZGVUeXBlICE9PSAxKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChkYXRhX3ByaXYuaGFzRGF0YShzcmMpKSB7XG4gICAgICBwZGF0YU9sZCA9IGRhdGFfcHJpdi5hY2Nlc3Moc3JjKTtcbiAgICAgIHBkYXRhQ3VyID0gZGF0YV9wcml2LnNldChkZXN0LCBwZGF0YU9sZCk7XG4gICAgICBldmVudHMgPSBwZGF0YU9sZC5ldmVudHM7XG4gICAgICBpZiAoZXZlbnRzKSB7XG4gICAgICAgIGRlbGV0ZSBwZGF0YUN1ci5oYW5kbGU7XG4gICAgICAgIHBkYXRhQ3VyLmV2ZW50cyA9IHt9O1xuICAgICAgICBmb3IgKHR5cGUgaW4gZXZlbnRzKSB7XG4gICAgICAgICAgZm9yIChpID0gMCwgbCA9IGV2ZW50c1t0eXBlXS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIGpRdWVyeS5ldmVudC5hZGQoZGVzdCwgdHlwZSwgZXZlbnRzW3R5cGVdW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGRhdGFfdXNlci5oYXNEYXRhKHNyYykpIHtcbiAgICAgIHVkYXRhT2xkID0gZGF0YV91c2VyLmFjY2VzcyhzcmMpO1xuICAgICAgdWRhdGFDdXIgPSBqUXVlcnkuZXh0ZW5kKHt9LCB1ZGF0YU9sZCk7XG4gICAgICBkYXRhX3VzZXIuc2V0KGRlc3QsIHVkYXRhQ3VyKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gZ2V0QWxsKGNvbnRleHQsIHRhZykge1xuICAgIHZhciByZXQgPSBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lID8gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWcgfHwgXCIqXCIpIDogY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsID8gY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKHRhZyB8fCBcIipcIikgOiBbXTtcbiAgICByZXR1cm4gdGFnID09PSB1bmRlZmluZWQgfHwgdGFnICYmIGpRdWVyeS5ub2RlTmFtZShjb250ZXh0LCB0YWcpID8galF1ZXJ5Lm1lcmdlKFtjb250ZXh0XSwgcmV0KSA6IHJldDtcbiAgfVxuICBmdW5jdGlvbiBmaXhJbnB1dChzcmMsIGRlc3QpIHtcbiAgICB2YXIgbm9kZU5hbWUgPSBkZXN0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKG5vZGVOYW1lID09PSBcImlucHV0XCIgJiYgcmNoZWNrYWJsZVR5cGUudGVzdChzcmMudHlwZSkpIHtcbiAgICAgIGRlc3QuY2hlY2tlZCA9IHNyYy5jaGVja2VkO1xuICAgIH0gZWxzZSBpZiAobm9kZU5hbWUgPT09IFwiaW5wdXRcIiB8fCBub2RlTmFtZSA9PT0gXCJ0ZXh0YXJlYVwiKSB7XG4gICAgICBkZXN0LmRlZmF1bHRWYWx1ZSA9IHNyYy5kZWZhdWx0VmFsdWU7XG4gICAgfVxuICB9XG4gIGpRdWVyeS5leHRlbmQoe1xuICAgIGNsb25lOiBmdW5jdGlvbihlbGVtLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cykge1xuICAgICAgdmFyIGksXG4gICAgICAgICAgbCxcbiAgICAgICAgICBzcmNFbGVtZW50cyxcbiAgICAgICAgICBkZXN0RWxlbWVudHMsXG4gICAgICAgICAgY2xvbmUgPSBlbGVtLmNsb25lTm9kZSh0cnVlKSxcbiAgICAgICAgICBpblBhZ2UgPSBqUXVlcnkuY29udGFpbnMoZWxlbS5vd25lckRvY3VtZW50LCBlbGVtKTtcbiAgICAgIGlmICghc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCAmJiAoZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBlbGVtLm5vZGVUeXBlID09PSAxMSkgJiYgIWpRdWVyeS5pc1hNTERvYyhlbGVtKSkge1xuICAgICAgICBkZXN0RWxlbWVudHMgPSBnZXRBbGwoY2xvbmUpO1xuICAgICAgICBzcmNFbGVtZW50cyA9IGdldEFsbChlbGVtKTtcbiAgICAgICAgZm9yIChpID0gMCwgbCA9IHNyY0VsZW1lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIGZpeElucHV0KHNyY0VsZW1lbnRzW2ldLCBkZXN0RWxlbWVudHNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZGF0YUFuZEV2ZW50cykge1xuICAgICAgICBpZiAoZGVlcERhdGFBbmRFdmVudHMpIHtcbiAgICAgICAgICBzcmNFbGVtZW50cyA9IHNyY0VsZW1lbnRzIHx8IGdldEFsbChlbGVtKTtcbiAgICAgICAgICBkZXN0RWxlbWVudHMgPSBkZXN0RWxlbWVudHMgfHwgZ2V0QWxsKGNsb25lKTtcbiAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gc3JjRWxlbWVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBjbG9uZUNvcHlFdmVudChzcmNFbGVtZW50c1tpXSwgZGVzdEVsZW1lbnRzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2xvbmVDb3B5RXZlbnQoZWxlbSwgY2xvbmUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBkZXN0RWxlbWVudHMgPSBnZXRBbGwoY2xvbmUsIFwic2NyaXB0XCIpO1xuICAgICAgaWYgKGRlc3RFbGVtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNldEdsb2JhbEV2YWwoZGVzdEVsZW1lbnRzLCAhaW5QYWdlICYmIGdldEFsbChlbGVtLCBcInNjcmlwdFwiKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY2xvbmU7XG4gICAgfSxcbiAgICBidWlsZEZyYWdtZW50OiBmdW5jdGlvbihlbGVtcywgY29udGV4dCwgc2NyaXB0cywgc2VsZWN0aW9uKSB7XG4gICAgICB2YXIgZWxlbSxcbiAgICAgICAgICB0bXAsXG4gICAgICAgICAgdGFnLFxuICAgICAgICAgIHdyYXAsXG4gICAgICAgICAgY29udGFpbnMsXG4gICAgICAgICAgaixcbiAgICAgICAgICBmcmFnbWVudCA9IGNvbnRleHQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxuICAgICAgICAgIG5vZGVzID0gW10sXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgbCA9IGVsZW1zLmxlbmd0aDtcbiAgICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGVsZW0gPSBlbGVtc1tpXTtcbiAgICAgICAgaWYgKGVsZW0gfHwgZWxlbSA9PT0gMCkge1xuICAgICAgICAgIGlmIChqUXVlcnkudHlwZShlbGVtKSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgalF1ZXJ5Lm1lcmdlKG5vZGVzLCBlbGVtLm5vZGVUeXBlID8gW2VsZW1dIDogZWxlbSk7XG4gICAgICAgICAgfSBlbHNlIGlmICghcmh0bWwudGVzdChlbGVtKSkge1xuICAgICAgICAgICAgbm9kZXMucHVzaChjb250ZXh0LmNyZWF0ZVRleHROb2RlKGVsZW0pKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG1wID0gdG1wIHx8IGZyYWdtZW50LmFwcGVuZENoaWxkKGNvbnRleHQuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7XG4gICAgICAgICAgICB0YWcgPSAocnRhZ05hbWUuZXhlYyhlbGVtKSB8fCBbXCJcIiwgXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB3cmFwID0gd3JhcE1hcFt0YWddIHx8IHdyYXBNYXAuX2RlZmF1bHQ7XG4gICAgICAgICAgICB0bXAuaW5uZXJIVE1MID0gd3JhcFsxXSArIGVsZW0ucmVwbGFjZShyeGh0bWxUYWcsIFwiPCQxPjwvJDI+XCIpICsgd3JhcFsyXTtcbiAgICAgICAgICAgIGogPSB3cmFwWzBdO1xuICAgICAgICAgICAgd2hpbGUgKGotLSkge1xuICAgICAgICAgICAgICB0bXAgPSB0bXAubGFzdENoaWxkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgalF1ZXJ5Lm1lcmdlKG5vZGVzLCB0bXAuY2hpbGROb2Rlcyk7XG4gICAgICAgICAgICB0bXAgPSBmcmFnbWVudC5maXJzdENoaWxkO1xuICAgICAgICAgICAgdG1wLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZyYWdtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgIGkgPSAwO1xuICAgICAgd2hpbGUgKChlbGVtID0gbm9kZXNbaSsrXSkpIHtcbiAgICAgICAgaWYgKHNlbGVjdGlvbiAmJiBqUXVlcnkuaW5BcnJheShlbGVtLCBzZWxlY3Rpb24pICE9PSAtMSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRhaW5zID0galF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSk7XG4gICAgICAgIHRtcCA9IGdldEFsbChmcmFnbWVudC5hcHBlbmRDaGlsZChlbGVtKSwgXCJzY3JpcHRcIik7XG4gICAgICAgIGlmIChjb250YWlucykge1xuICAgICAgICAgIHNldEdsb2JhbEV2YWwodG1wKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NyaXB0cykge1xuICAgICAgICAgIGogPSAwO1xuICAgICAgICAgIHdoaWxlICgoZWxlbSA9IHRtcFtqKytdKSkge1xuICAgICAgICAgICAgaWYgKHJzY3JpcHRUeXBlLnRlc3QoZWxlbS50eXBlIHx8IFwiXCIpKSB7XG4gICAgICAgICAgICAgIHNjcmlwdHMucHVzaChlbGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmcmFnbWVudDtcbiAgICB9LFxuICAgIGNsZWFuRGF0YTogZnVuY3Rpb24oZWxlbXMpIHtcbiAgICAgIHZhciBkYXRhLFxuICAgICAgICAgIGVsZW0sXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICBrZXksXG4gICAgICAgICAgc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsLFxuICAgICAgICAgIGkgPSAwO1xuICAgICAgZm9yICg7IChlbGVtID0gZWxlbXNbaV0pICE9PSB1bmRlZmluZWQ7IGkrKykge1xuICAgICAgICBpZiAoalF1ZXJ5LmFjY2VwdERhdGEoZWxlbSkpIHtcbiAgICAgICAgICBrZXkgPSBlbGVtW2RhdGFfcHJpdi5leHBhbmRvXTtcbiAgICAgICAgICBpZiAoa2V5ICYmIChkYXRhID0gZGF0YV9wcml2LmNhY2hlW2tleV0pKSB7XG4gICAgICAgICAgICBpZiAoZGF0YS5ldmVudHMpIHtcbiAgICAgICAgICAgICAgZm9yICh0eXBlIGluIGRhdGEuZXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNwZWNpYWxbdHlwZV0pIHtcbiAgICAgICAgICAgICAgICAgIGpRdWVyeS5ldmVudC5yZW1vdmUoZWxlbSwgdHlwZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGpRdWVyeS5yZW1vdmVFdmVudChlbGVtLCB0eXBlLCBkYXRhLmhhbmRsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGF0YV9wcml2LmNhY2hlW2tleV0pIHtcbiAgICAgICAgICAgICAgZGVsZXRlIGRhdGFfcHJpdi5jYWNoZVtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgZGF0YV91c2VyLmNhY2hlW2VsZW1bZGF0YV91c2VyLmV4cGFuZG9dXTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBqUXVlcnkuZm4uZXh0ZW5kKHtcbiAgICB0ZXh0OiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIGFjY2Vzcyh0aGlzLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IGpRdWVyeS50ZXh0KHRoaXMpIDogdGhpcy5lbXB0eSgpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSkge1xuICAgICAgICAgICAgdGhpcy50ZXh0Q29udGVudCA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9LCBudWxsLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgfSxcbiAgICBhcHBlbmQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgIGlmICh0aGlzLm5vZGVUeXBlID09PSAxIHx8IHRoaXMubm9kZVR5cGUgPT09IDExIHx8IHRoaXMubm9kZVR5cGUgPT09IDkpIHtcbiAgICAgICAgICB2YXIgdGFyZ2V0ID0gbWFuaXB1bGF0aW9uVGFyZ2V0KHRoaXMsIGVsZW0pO1xuICAgICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChlbGVtKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBwcmVwZW5kOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICBpZiAodGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5KSB7XG4gICAgICAgICAgdmFyIHRhcmdldCA9IG1hbmlwdWxhdGlvblRhcmdldCh0aGlzLCBlbGVtKTtcbiAgICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKGVsZW0sIHRhcmdldC5maXJzdENoaWxkKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBiZWZvcmU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICB0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGVsZW0sIHRoaXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFmdGVyOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtLCB0aGlzLm5leHRTaWJsaW5nKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZW1vdmU6IGZ1bmN0aW9uKHNlbGVjdG9yLCBrZWVwRGF0YSkge1xuICAgICAgdmFyIGVsZW0sXG4gICAgICAgICAgZWxlbXMgPSBzZWxlY3RvciA/IGpRdWVyeS5maWx0ZXIoc2VsZWN0b3IsIHRoaXMpIDogdGhpcyxcbiAgICAgICAgICBpID0gMDtcbiAgICAgIGZvciAoOyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKyspIHtcbiAgICAgICAgaWYgKCFrZWVwRGF0YSAmJiBlbGVtLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgalF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwoZWxlbSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICBpZiAoa2VlcERhdGEgJiYgalF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSkpIHtcbiAgICAgICAgICAgIHNldEdsb2JhbEV2YWwoZ2V0QWxsKGVsZW0sIFwic2NyaXB0XCIpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIGVtcHR5OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBlbGVtLFxuICAgICAgICAgIGkgPSAwO1xuICAgICAgZm9yICg7IChlbGVtID0gdGhpc1tpXSkgIT0gbnVsbDsgaSsrKSB7XG4gICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgalF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwoZWxlbSwgZmFsc2UpKTtcbiAgICAgICAgICBlbGVtLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBjbG9uZTogZnVuY3Rpb24oZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMpIHtcbiAgICAgIGRhdGFBbmRFdmVudHMgPSBkYXRhQW5kRXZlbnRzID09IG51bGwgPyBmYWxzZSA6IGRhdGFBbmRFdmVudHM7XG4gICAgICBkZWVwRGF0YUFuZEV2ZW50cyA9IGRlZXBEYXRhQW5kRXZlbnRzID09IG51bGwgPyBkYXRhQW5kRXZlbnRzIDogZGVlcERhdGFBbmRFdmVudHM7XG4gICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBqUXVlcnkuY2xvbmUodGhpcywgZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBodG1sOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIGFjY2Vzcyh0aGlzLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB2YXIgZWxlbSA9IHRoaXNbMF0gfHwge30sXG4gICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgIGwgPSB0aGlzLmxlbmd0aDtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICAgIHJldHVybiBlbGVtLmlubmVySFRNTDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmICFybm9Jbm5lcmh0bWwudGVzdCh2YWx1ZSkgJiYgIXdyYXBNYXBbKHJ0YWdOYW1lLmV4ZWModmFsdWUpIHx8IFtcIlwiLCBcIlwiXSlbMV0udG9Mb3dlckNhc2UoKV0pIHtcbiAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UocnhodG1sVGFnLCBcIjwkMT48LyQyPlwiKTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgZWxlbSA9IHRoaXNbaV0gfHwge307XG4gICAgICAgICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5LmNsZWFuRGF0YShnZXRBbGwoZWxlbSwgZmFsc2UpKTtcbiAgICAgICAgICAgICAgICBlbGVtLmlubmVySFRNTCA9IHZhbHVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbGVtID0gMDtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtKSB7XG4gICAgICAgICAgdGhpcy5lbXB0eSgpLmFwcGVuZCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoKTtcbiAgICB9LFxuICAgIHJlcGxhY2VXaXRoOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmcgPSBhcmd1bWVudHNbMF07XG4gICAgICB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICBhcmcgPSB0aGlzLnBhcmVudE5vZGU7XG4gICAgICAgIGpRdWVyeS5jbGVhbkRhdGEoZ2V0QWxsKHRoaXMpKTtcbiAgICAgICAgaWYgKGFyZykge1xuICAgICAgICAgIGFyZy5yZXBsYWNlQ2hpbGQoZWxlbSwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFyZyAmJiAoYXJnLmxlbmd0aCB8fCBhcmcubm9kZVR5cGUpID8gdGhpcyA6IHRoaXMucmVtb3ZlKCk7XG4gICAgfSxcbiAgICBkZXRhY2g6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZW1vdmUoc2VsZWN0b3IsIHRydWUpO1xuICAgIH0sXG4gICAgZG9tTWFuaXA6IGZ1bmN0aW9uKGFyZ3MsIGNhbGxiYWNrKSB7XG4gICAgICBhcmdzID0gY29uY2F0LmFwcGx5KFtdLCBhcmdzKTtcbiAgICAgIHZhciBmcmFnbWVudCxcbiAgICAgICAgICBmaXJzdCxcbiAgICAgICAgICBzY3JpcHRzLFxuICAgICAgICAgIGhhc1NjcmlwdHMsXG4gICAgICAgICAgbm9kZSxcbiAgICAgICAgICBkb2MsXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgbCA9IHRoaXMubGVuZ3RoLFxuICAgICAgICAgIHNldCA9IHRoaXMsXG4gICAgICAgICAgaU5vQ2xvbmUgPSBsIC0gMSxcbiAgICAgICAgICB2YWx1ZSA9IGFyZ3NbMF0sXG4gICAgICAgICAgaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKTtcbiAgICAgIGlmIChpc0Z1bmN0aW9uIHx8IChsID4gMSAmJiB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgIXN1cHBvcnQuY2hlY2tDbG9uZSAmJiByY2hlY2tlZC50ZXN0KHZhbHVlKSkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgIHZhciBzZWxmID0gc2V0LmVxKGluZGV4KTtcbiAgICAgICAgICBpZiAoaXNGdW5jdGlvbikge1xuICAgICAgICAgICAgYXJnc1swXSA9IHZhbHVlLmNhbGwodGhpcywgaW5kZXgsIHNlbGYuaHRtbCgpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2VsZi5kb21NYW5pcChhcmdzLCBjYWxsYmFjayk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGwpIHtcbiAgICAgICAgZnJhZ21lbnQgPSBqUXVlcnkuYnVpbGRGcmFnbWVudChhcmdzLCB0aGlzWzBdLm93bmVyRG9jdW1lbnQsIGZhbHNlLCB0aGlzKTtcbiAgICAgICAgZmlyc3QgPSBmcmFnbWVudC5maXJzdENoaWxkO1xuICAgICAgICBpZiAoZnJhZ21lbnQuY2hpbGROb2Rlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICBmcmFnbWVudCA9IGZpcnN0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaXJzdCkge1xuICAgICAgICAgIHNjcmlwdHMgPSBqUXVlcnkubWFwKGdldEFsbChmcmFnbWVudCwgXCJzY3JpcHRcIiksIGRpc2FibGVTY3JpcHQpO1xuICAgICAgICAgIGhhc1NjcmlwdHMgPSBzY3JpcHRzLmxlbmd0aDtcbiAgICAgICAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgbm9kZSA9IGZyYWdtZW50O1xuICAgICAgICAgICAgaWYgKGkgIT09IGlOb0Nsb25lKSB7XG4gICAgICAgICAgICAgIG5vZGUgPSBqUXVlcnkuY2xvbmUobm9kZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgIGlmIChoYXNTY3JpcHRzKSB7XG4gICAgICAgICAgICAgICAgalF1ZXJ5Lm1lcmdlKHNjcmlwdHMsIGdldEFsbChub2RlLCBcInNjcmlwdFwiKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc1tpXSwgbm9kZSwgaSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoYXNTY3JpcHRzKSB7XG4gICAgICAgICAgICBkb2MgPSBzY3JpcHRzW3NjcmlwdHMubGVuZ3RoIC0gMV0ub3duZXJEb2N1bWVudDtcbiAgICAgICAgICAgIGpRdWVyeS5tYXAoc2NyaXB0cywgcmVzdG9yZVNjcmlwdCk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaGFzU2NyaXB0czsgaSsrKSB7XG4gICAgICAgICAgICAgIG5vZGUgPSBzY3JpcHRzW2ldO1xuICAgICAgICAgICAgICBpZiAocnNjcmlwdFR5cGUudGVzdChub2RlLnR5cGUgfHwgXCJcIikgJiYgIWRhdGFfcHJpdi5hY2Nlc3Mobm9kZSwgXCJnbG9iYWxFdmFsXCIpICYmIGpRdWVyeS5jb250YWlucyhkb2MsIG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuc3JjKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoalF1ZXJ5Ll9ldmFsVXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIGpRdWVyeS5fZXZhbFVybChub2RlLnNyYyk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGpRdWVyeS5nbG9iYWxFdmFsKG5vZGUudGV4dENvbnRlbnQucmVwbGFjZShyY2xlYW5TY3JpcHQsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSk7XG4gIGpRdWVyeS5lYWNoKHtcbiAgICBhcHBlbmRUbzogXCJhcHBlbmRcIixcbiAgICBwcmVwZW5kVG86IFwicHJlcGVuZFwiLFxuICAgIGluc2VydEJlZm9yZTogXCJiZWZvcmVcIixcbiAgICBpbnNlcnRBZnRlcjogXCJhZnRlclwiLFxuICAgIHJlcGxhY2VBbGw6IFwicmVwbGFjZVdpdGhcIlxuICB9LCBmdW5jdGlvbihuYW1lLCBvcmlnaW5hbCkge1xuICAgIGpRdWVyeS5mbltuYW1lXSA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICB2YXIgZWxlbXMsXG4gICAgICAgICAgcmV0ID0gW10sXG4gICAgICAgICAgaW5zZXJ0ID0galF1ZXJ5KHNlbGVjdG9yKSxcbiAgICAgICAgICBsYXN0ID0gaW5zZXJ0Lmxlbmd0aCAtIDEsXG4gICAgICAgICAgaSA9IDA7XG4gICAgICBmb3IgKDsgaSA8PSBsYXN0OyBpKyspIHtcbiAgICAgICAgZWxlbXMgPSBpID09PSBsYXN0ID8gdGhpcyA6IHRoaXMuY2xvbmUodHJ1ZSk7XG4gICAgICAgIGpRdWVyeShpbnNlcnRbaV0pW29yaWdpbmFsXShlbGVtcyk7XG4gICAgICAgIHB1c2guYXBwbHkocmV0LCBlbGVtcy5nZXQoKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2socmV0KTtcbiAgICB9O1xuICB9KTtcbiAgdmFyIGlmcmFtZSxcbiAgICAgIGVsZW1kaXNwbGF5ID0ge307XG4gIGZ1bmN0aW9uIGFjdHVhbERpc3BsYXkobmFtZSwgZG9jKSB7XG4gICAgdmFyIHN0eWxlLFxuICAgICAgICBlbGVtID0galF1ZXJ5KGRvYy5jcmVhdGVFbGVtZW50KG5hbWUpKS5hcHBlbmRUbyhkb2MuYm9keSksXG4gICAgICAgIGRpc3BsYXkgPSB3aW5kb3cuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUgJiYgKHN0eWxlID0gd2luZG93LmdldERlZmF1bHRDb21wdXRlZFN0eWxlKGVsZW1bMF0pKSA/IHN0eWxlLmRpc3BsYXkgOiBqUXVlcnkuY3NzKGVsZW1bMF0sIFwiZGlzcGxheVwiKTtcbiAgICBlbGVtLmRldGFjaCgpO1xuICAgIHJldHVybiBkaXNwbGF5O1xuICB9XG4gIGZ1bmN0aW9uIGRlZmF1bHREaXNwbGF5KG5vZGVOYW1lKSB7XG4gICAgdmFyIGRvYyA9IGRvY3VtZW50LFxuICAgICAgICBkaXNwbGF5ID0gZWxlbWRpc3BsYXlbbm9kZU5hbWVdO1xuICAgIGlmICghZGlzcGxheSkge1xuICAgICAgZGlzcGxheSA9IGFjdHVhbERpc3BsYXkobm9kZU5hbWUsIGRvYyk7XG4gICAgICBpZiAoZGlzcGxheSA9PT0gXCJub25lXCIgfHwgIWRpc3BsYXkpIHtcbiAgICAgICAgaWZyYW1lID0gKGlmcmFtZSB8fCBqUXVlcnkoXCI8aWZyYW1lIGZyYW1lYm9yZGVyPScwJyB3aWR0aD0nMCcgaGVpZ2h0PScwJy8+XCIpKS5hcHBlbmRUbyhkb2MuZG9jdW1lbnRFbGVtZW50KTtcbiAgICAgICAgZG9jID0gaWZyYW1lWzBdLmNvbnRlbnREb2N1bWVudDtcbiAgICAgICAgZG9jLndyaXRlKCk7XG4gICAgICAgIGRvYy5jbG9zZSgpO1xuICAgICAgICBkaXNwbGF5ID0gYWN0dWFsRGlzcGxheShub2RlTmFtZSwgZG9jKTtcbiAgICAgICAgaWZyYW1lLmRldGFjaCgpO1xuICAgICAgfVxuICAgICAgZWxlbWRpc3BsYXlbbm9kZU5hbWVdID0gZGlzcGxheTtcbiAgICB9XG4gICAgcmV0dXJuIGRpc3BsYXk7XG4gIH1cbiAgdmFyIHJtYXJnaW4gPSAoL15tYXJnaW4vKTtcbiAgdmFyIHJudW1ub25weCA9IG5ldyBSZWdFeHAoXCJeKFwiICsgcG51bSArIFwiKSg/IXB4KVthLXolXSskXCIsIFwiaVwiKTtcbiAgdmFyIGdldFN0eWxlcyA9IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICBpZiAoZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3Lm9wZW5lcikge1xuICAgICAgcmV0dXJuIGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZW0sIG51bGwpO1xuICAgIH1cbiAgICByZXR1cm4gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbSwgbnVsbCk7XG4gIH07XG4gIGZ1bmN0aW9uIGN1ckNTUyhlbGVtLCBuYW1lLCBjb21wdXRlZCkge1xuICAgIHZhciB3aWR0aCxcbiAgICAgICAgbWluV2lkdGgsXG4gICAgICAgIG1heFdpZHRoLFxuICAgICAgICByZXQsXG4gICAgICAgIHN0eWxlID0gZWxlbS5zdHlsZTtcbiAgICBjb21wdXRlZCA9IGNvbXB1dGVkIHx8IGdldFN0eWxlcyhlbGVtKTtcbiAgICBpZiAoY29tcHV0ZWQpIHtcbiAgICAgIHJldCA9IGNvbXB1dGVkLmdldFByb3BlcnR5VmFsdWUobmFtZSkgfHwgY29tcHV0ZWRbbmFtZV07XG4gICAgfVxuICAgIGlmIChjb21wdXRlZCkge1xuICAgICAgaWYgKHJldCA9PT0gXCJcIiAmJiAhalF1ZXJ5LmNvbnRhaW5zKGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSkpIHtcbiAgICAgICAgcmV0ID0galF1ZXJ5LnN0eWxlKGVsZW0sIG5hbWUpO1xuICAgICAgfVxuICAgICAgaWYgKHJudW1ub25weC50ZXN0KHJldCkgJiYgcm1hcmdpbi50ZXN0KG5hbWUpKSB7XG4gICAgICAgIHdpZHRoID0gc3R5bGUud2lkdGg7XG4gICAgICAgIG1pbldpZHRoID0gc3R5bGUubWluV2lkdGg7XG4gICAgICAgIG1heFdpZHRoID0gc3R5bGUubWF4V2lkdGg7XG4gICAgICAgIHN0eWxlLm1pbldpZHRoID0gc3R5bGUubWF4V2lkdGggPSBzdHlsZS53aWR0aCA9IHJldDtcbiAgICAgICAgcmV0ID0gY29tcHV0ZWQud2lkdGg7XG4gICAgICAgIHN0eWxlLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHN0eWxlLm1pbldpZHRoID0gbWluV2lkdGg7XG4gICAgICAgIHN0eWxlLm1heFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQgIT09IHVuZGVmaW5lZCA/IHJldCArIFwiXCIgOiByZXQ7XG4gIH1cbiAgZnVuY3Rpb24gYWRkR2V0SG9va0lmKGNvbmRpdGlvbkZuLCBob29rRm4pIHtcbiAgICByZXR1cm4ge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChjb25kaXRpb25GbigpKSB7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuZ2V0O1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHRoaXMuZ2V0ID0gaG9va0ZuKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfX07XG4gIH1cbiAgKGZ1bmN0aW9uKCkge1xuICAgIHZhciBwaXhlbFBvc2l0aW9uVmFsLFxuICAgICAgICBib3hTaXppbmdSZWxpYWJsZVZhbCxcbiAgICAgICAgZG9jRWxlbSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxcbiAgICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcbiAgICAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBpZiAoIWRpdi5zdHlsZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPSBcImNvbnRlbnQtYm94XCI7XG4gICAgZGl2LmNsb25lTm9kZSh0cnVlKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9IFwiXCI7XG4gICAgc3VwcG9ydC5jbGVhckNsb25lU3R5bGUgPSBkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPT09IFwiY29udGVudC1ib3hcIjtcbiAgICBjb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IFwiYm9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHg7bWFyZ2luLXRvcDoxcHg7XCIgKyBcInBvc2l0aW9uOmFic29sdXRlXCI7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGRpdik7XG4gICAgZnVuY3Rpb24gY29tcHV0ZVBpeGVsUG9zaXRpb25BbmRCb3hTaXppbmdSZWxpYWJsZSgpIHtcbiAgICAgIGRpdi5zdHlsZS5jc3NUZXh0ID0gXCItd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveDtcIiArIFwiYm94LXNpemluZzpib3JkZXItYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luLXRvcDoxJTt0b3A6MSU7XCIgKyBcImJvcmRlcjoxcHg7cGFkZGluZzoxcHg7d2lkdGg6NHB4O3Bvc2l0aW9uOmFic29sdXRlXCI7XG4gICAgICBkaXYuaW5uZXJIVE1MID0gXCJcIjtcbiAgICAgIGRvY0VsZW0uYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgIHZhciBkaXZTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRpdiwgbnVsbCk7XG4gICAgICBwaXhlbFBvc2l0aW9uVmFsID0gZGl2U3R5bGUudG9wICE9PSBcIjElXCI7XG4gICAgICBib3hTaXppbmdSZWxpYWJsZVZhbCA9IGRpdlN0eWxlLndpZHRoID09PSBcIjRweFwiO1xuICAgICAgZG9jRWxlbS5yZW1vdmVDaGlsZChjb250YWluZXIpO1xuICAgIH1cbiAgICBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHtcbiAgICAgIGpRdWVyeS5leHRlbmQoc3VwcG9ydCwge1xuICAgICAgICBwaXhlbFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjb21wdXRlUGl4ZWxQb3NpdGlvbkFuZEJveFNpemluZ1JlbGlhYmxlKCk7XG4gICAgICAgICAgcmV0dXJuIHBpeGVsUG9zaXRpb25WYWw7XG4gICAgICAgIH0sXG4gICAgICAgIGJveFNpemluZ1JlbGlhYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoYm94U2l6aW5nUmVsaWFibGVWYWwgPT0gbnVsbCkge1xuICAgICAgICAgICAgY29tcHV0ZVBpeGVsUG9zaXRpb25BbmRCb3hTaXppbmdSZWxpYWJsZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gYm94U2l6aW5nUmVsaWFibGVWYWw7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbGlhYmxlTWFyZ2luUmlnaHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciByZXQsXG4gICAgICAgICAgICAgIG1hcmdpbkRpdiA9IGRpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTtcbiAgICAgICAgICBtYXJnaW5EaXYuc3R5bGUuY3NzVGV4dCA9IGRpdi5zdHlsZS5jc3NUZXh0ID0gXCItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94O1wiICsgXCJib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzowXCI7XG4gICAgICAgICAgbWFyZ2luRGl2LnN0eWxlLm1hcmdpblJpZ2h0ID0gbWFyZ2luRGl2LnN0eWxlLndpZHRoID0gXCIwXCI7XG4gICAgICAgICAgZGl2LnN0eWxlLndpZHRoID0gXCIxcHhcIjtcbiAgICAgICAgICBkb2NFbGVtLmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG4gICAgICAgICAgcmV0ID0gIXBhcnNlRmxvYXQod2luZG93LmdldENvbXB1dGVkU3R5bGUobWFyZ2luRGl2LCBudWxsKS5tYXJnaW5SaWdodCk7XG4gICAgICAgICAgZG9jRWxlbS5yZW1vdmVDaGlsZChjb250YWluZXIpO1xuICAgICAgICAgIGRpdi5yZW1vdmVDaGlsZChtYXJnaW5EaXYpO1xuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSkoKTtcbiAgalF1ZXJ5LnN3YXAgPSBmdW5jdGlvbihlbGVtLCBvcHRpb25zLCBjYWxsYmFjaywgYXJncykge1xuICAgIHZhciByZXQsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIG9sZCA9IHt9O1xuICAgIGZvciAobmFtZSBpbiBvcHRpb25zKSB7XG4gICAgICBvbGRbbmFtZV0gPSBlbGVtLnN0eWxlW25hbWVdO1xuICAgICAgZWxlbS5zdHlsZVtuYW1lXSA9IG9wdGlvbnNbbmFtZV07XG4gICAgfVxuICAgIHJldCA9IGNhbGxiYWNrLmFwcGx5KGVsZW0sIGFyZ3MgfHwgW10pO1xuICAgIGZvciAobmFtZSBpbiBvcHRpb25zKSB7XG4gICAgICBlbGVtLnN0eWxlW25hbWVdID0gb2xkW25hbWVdO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9O1xuICB2YXIgcmRpc3BsYXlzd2FwID0gL14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLFxuICAgICAgcm51bXNwbGl0ID0gbmV3IFJlZ0V4cChcIl4oXCIgKyBwbnVtICsgXCIpKC4qKSRcIiwgXCJpXCIpLFxuICAgICAgcnJlbE51bSA9IG5ldyBSZWdFeHAoXCJeKFsrLV0pPShcIiArIHBudW0gKyBcIilcIiwgXCJpXCIpLFxuICAgICAgY3NzU2hvdyA9IHtcbiAgICAgICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICAgICAgdmlzaWJpbGl0eTogXCJoaWRkZW5cIixcbiAgICAgICAgZGlzcGxheTogXCJibG9ja1wiXG4gICAgICB9LFxuICAgICAgY3NzTm9ybWFsVHJhbnNmb3JtID0ge1xuICAgICAgICBsZXR0ZXJTcGFjaW5nOiBcIjBcIixcbiAgICAgICAgZm9udFdlaWdodDogXCI0MDBcIlxuICAgICAgfSxcbiAgICAgIGNzc1ByZWZpeGVzID0gW1wiV2Via2l0XCIsIFwiT1wiLCBcIk1velwiLCBcIm1zXCJdO1xuICBmdW5jdGlvbiB2ZW5kb3JQcm9wTmFtZShzdHlsZSwgbmFtZSkge1xuICAgIGlmIChuYW1lIGluIHN0eWxlKSB7XG4gICAgICByZXR1cm4gbmFtZTtcbiAgICB9XG4gICAgdmFyIGNhcE5hbWUgPSBuYW1lWzBdLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpLFxuICAgICAgICBvcmlnTmFtZSA9IG5hbWUsXG4gICAgICAgIGkgPSBjc3NQcmVmaXhlcy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgbmFtZSA9IGNzc1ByZWZpeGVzW2ldICsgY2FwTmFtZTtcbiAgICAgIGlmIChuYW1lIGluIHN0eWxlKSB7XG4gICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3JpZ05hbWU7XG4gIH1cbiAgZnVuY3Rpb24gc2V0UG9zaXRpdmVOdW1iZXIoZWxlbSwgdmFsdWUsIHN1YnRyYWN0KSB7XG4gICAgdmFyIG1hdGNoZXMgPSBybnVtc3BsaXQuZXhlYyh2YWx1ZSk7XG4gICAgcmV0dXJuIG1hdGNoZXMgPyBNYXRoLm1heCgwLCBtYXRjaGVzWzFdIC0gKHN1YnRyYWN0IHx8IDApKSArIChtYXRjaGVzWzJdIHx8IFwicHhcIikgOiB2YWx1ZTtcbiAgfVxuICBmdW5jdGlvbiBhdWdtZW50V2lkdGhPckhlaWdodChlbGVtLCBuYW1lLCBleHRyYSwgaXNCb3JkZXJCb3gsIHN0eWxlcykge1xuICAgIHZhciBpID0gZXh0cmEgPT09IChpc0JvcmRlckJveCA/IFwiYm9yZGVyXCIgOiBcImNvbnRlbnRcIikgPyA0IDogbmFtZSA9PT0gXCJ3aWR0aFwiID8gMSA6IDAsXG4gICAgICAgIHZhbCA9IDA7XG4gICAgZm9yICg7IGkgPCA0OyBpICs9IDIpIHtcbiAgICAgIGlmIChleHRyYSA9PT0gXCJtYXJnaW5cIikge1xuICAgICAgICB2YWwgKz0galF1ZXJ5LmNzcyhlbGVtLCBleHRyYSArIGNzc0V4cGFuZFtpXSwgdHJ1ZSwgc3R5bGVzKTtcbiAgICAgIH1cbiAgICAgIGlmIChpc0JvcmRlckJveCkge1xuICAgICAgICBpZiAoZXh0cmEgPT09IFwiY29udGVudFwiKSB7XG4gICAgICAgICAgdmFsIC09IGpRdWVyeS5jc3MoZWxlbSwgXCJwYWRkaW5nXCIgKyBjc3NFeHBhbmRbaV0sIHRydWUsIHN0eWxlcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4dHJhICE9PSBcIm1hcmdpblwiKSB7XG4gICAgICAgICAgdmFsIC09IGpRdWVyeS5jc3MoZWxlbSwgXCJib3JkZXJcIiArIGNzc0V4cGFuZFtpXSArIFwiV2lkdGhcIiwgdHJ1ZSwgc3R5bGVzKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsICs9IGpRdWVyeS5jc3MoZWxlbSwgXCJwYWRkaW5nXCIgKyBjc3NFeHBhbmRbaV0sIHRydWUsIHN0eWxlcyk7XG4gICAgICAgIGlmIChleHRyYSAhPT0gXCJwYWRkaW5nXCIpIHtcbiAgICAgICAgICB2YWwgKz0galF1ZXJ5LmNzcyhlbGVtLCBcImJvcmRlclwiICsgY3NzRXhwYW5kW2ldICsgXCJXaWR0aFwiLCB0cnVlLCBzdHlsZXMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWw7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0V2lkdGhPckhlaWdodChlbGVtLCBuYW1lLCBleHRyYSkge1xuICAgIHZhciB2YWx1ZUlzQm9yZGVyQm94ID0gdHJ1ZSxcbiAgICAgICAgdmFsID0gbmFtZSA9PT0gXCJ3aWR0aFwiID8gZWxlbS5vZmZzZXRXaWR0aCA6IGVsZW0ub2Zmc2V0SGVpZ2h0LFxuICAgICAgICBzdHlsZXMgPSBnZXRTdHlsZXMoZWxlbSksXG4gICAgICAgIGlzQm9yZGVyQm94ID0galF1ZXJ5LmNzcyhlbGVtLCBcImJveFNpemluZ1wiLCBmYWxzZSwgc3R5bGVzKSA9PT0gXCJib3JkZXItYm94XCI7XG4gICAgaWYgKHZhbCA8PSAwIHx8IHZhbCA9PSBudWxsKSB7XG4gICAgICB2YWwgPSBjdXJDU1MoZWxlbSwgbmFtZSwgc3R5bGVzKTtcbiAgICAgIGlmICh2YWwgPCAwIHx8IHZhbCA9PSBudWxsKSB7XG4gICAgICAgIHZhbCA9IGVsZW0uc3R5bGVbbmFtZV07XG4gICAgICB9XG4gICAgICBpZiAocm51bW5vbnB4LnRlc3QodmFsKSkge1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgfVxuICAgICAgdmFsdWVJc0JvcmRlckJveCA9IGlzQm9yZGVyQm94ICYmIChzdXBwb3J0LmJveFNpemluZ1JlbGlhYmxlKCkgfHwgdmFsID09PSBlbGVtLnN0eWxlW25hbWVdKTtcbiAgICAgIHZhbCA9IHBhcnNlRmxvYXQodmFsKSB8fCAwO1xuICAgIH1cbiAgICByZXR1cm4gKHZhbCArIGF1Z21lbnRXaWR0aE9ySGVpZ2h0KGVsZW0sIG5hbWUsIGV4dHJhIHx8IChpc0JvcmRlckJveCA/IFwiYm9yZGVyXCIgOiBcImNvbnRlbnRcIiksIHZhbHVlSXNCb3JkZXJCb3gsIHN0eWxlcykpICsgXCJweFwiO1xuICB9XG4gIGZ1bmN0aW9uIHNob3dIaWRlKGVsZW1lbnRzLCBzaG93KSB7XG4gICAgdmFyIGRpc3BsYXksXG4gICAgICAgIGVsZW0sXG4gICAgICAgIGhpZGRlbixcbiAgICAgICAgdmFsdWVzID0gW10sXG4gICAgICAgIGluZGV4ID0gMCxcbiAgICAgICAgbGVuZ3RoID0gZWxlbWVudHMubGVuZ3RoO1xuICAgIGZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgZWxlbSA9IGVsZW1lbnRzW2luZGV4XTtcbiAgICAgIGlmICghZWxlbS5zdHlsZSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHZhbHVlc1tpbmRleF0gPSBkYXRhX3ByaXYuZ2V0KGVsZW0sIFwib2xkZGlzcGxheVwiKTtcbiAgICAgIGRpc3BsYXkgPSBlbGVtLnN0eWxlLmRpc3BsYXk7XG4gICAgICBpZiAoc2hvdykge1xuICAgICAgICBpZiAoIXZhbHVlc1tpbmRleF0gJiYgZGlzcGxheSA9PT0gXCJub25lXCIpIHtcbiAgICAgICAgICBlbGVtLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtLnN0eWxlLmRpc3BsYXkgPT09IFwiXCIgJiYgaXNIaWRkZW4oZWxlbSkpIHtcbiAgICAgICAgICB2YWx1ZXNbaW5kZXhdID0gZGF0YV9wcml2LmFjY2VzcyhlbGVtLCBcIm9sZGRpc3BsYXlcIiwgZGVmYXVsdERpc3BsYXkoZWxlbS5ub2RlTmFtZSkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoaWRkZW4gPSBpc0hpZGRlbihlbGVtKTtcbiAgICAgICAgaWYgKGRpc3BsYXkgIT09IFwibm9uZVwiIHx8ICFoaWRkZW4pIHtcbiAgICAgICAgICBkYXRhX3ByaXYuc2V0KGVsZW0sIFwib2xkZGlzcGxheVwiLCBoaWRkZW4gPyBkaXNwbGF5IDogalF1ZXJ5LmNzcyhlbGVtLCBcImRpc3BsYXlcIikpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgZWxlbSA9IGVsZW1lbnRzW2luZGV4XTtcbiAgICAgIGlmICghZWxlbS5zdHlsZSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmICghc2hvdyB8fCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09IFwibm9uZVwiIHx8IGVsZW0uc3R5bGUuZGlzcGxheSA9PT0gXCJcIikge1xuICAgICAgICBlbGVtLnN0eWxlLmRpc3BsYXkgPSBzaG93ID8gdmFsdWVzW2luZGV4XSB8fCBcIlwiIDogXCJub25lXCI7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50cztcbiAgfVxuICBqUXVlcnkuZXh0ZW5kKHtcbiAgICBjc3NIb29rczoge29wYWNpdHk6IHtnZXQ6IGZ1bmN0aW9uKGVsZW0sIGNvbXB1dGVkKSB7XG4gICAgICAgICAgaWYgKGNvbXB1dGVkKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gY3VyQ1NTKGVsZW0sIFwib3BhY2l0eVwiKTtcbiAgICAgICAgICAgIHJldHVybiByZXQgPT09IFwiXCIgPyBcIjFcIiA6IHJldDtcbiAgICAgICAgICB9XG4gICAgICAgIH19fSxcbiAgICBjc3NOdW1iZXI6IHtcbiAgICAgIFwiY29sdW1uQ291bnRcIjogdHJ1ZSxcbiAgICAgIFwiZmlsbE9wYWNpdHlcIjogdHJ1ZSxcbiAgICAgIFwiZmxleEdyb3dcIjogdHJ1ZSxcbiAgICAgIFwiZmxleFNocmlua1wiOiB0cnVlLFxuICAgICAgXCJmb250V2VpZ2h0XCI6IHRydWUsXG4gICAgICBcImxpbmVIZWlnaHRcIjogdHJ1ZSxcbiAgICAgIFwib3BhY2l0eVwiOiB0cnVlLFxuICAgICAgXCJvcmRlclwiOiB0cnVlLFxuICAgICAgXCJvcnBoYW5zXCI6IHRydWUsXG4gICAgICBcIndpZG93c1wiOiB0cnVlLFxuICAgICAgXCJ6SW5kZXhcIjogdHJ1ZSxcbiAgICAgIFwiem9vbVwiOiB0cnVlXG4gICAgfSxcbiAgICBjc3NQcm9wczoge1wiZmxvYXRcIjogXCJjc3NGbG9hdFwifSxcbiAgICBzdHlsZTogZnVuY3Rpb24oZWxlbSwgbmFtZSwgdmFsdWUsIGV4dHJhKSB7XG4gICAgICBpZiAoIWVsZW0gfHwgZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4IHx8ICFlbGVtLnN0eWxlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciByZXQsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICBob29rcyxcbiAgICAgICAgICBvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UobmFtZSksXG4gICAgICAgICAgc3R5bGUgPSBlbGVtLnN0eWxlO1xuICAgICAgbmFtZSA9IGpRdWVyeS5jc3NQcm9wc1tvcmlnTmFtZV0gfHwgKGpRdWVyeS5jc3NQcm9wc1tvcmlnTmFtZV0gPSB2ZW5kb3JQcm9wTmFtZShzdHlsZSwgb3JpZ05hbWUpKTtcbiAgICAgIGhvb2tzID0galF1ZXJ5LmNzc0hvb2tzW25hbWVdIHx8IGpRdWVyeS5jc3NIb29rc1tvcmlnTmFtZV07XG4gICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0eXBlID0gdHlwZW9mIHZhbHVlO1xuICAgICAgICBpZiAodHlwZSA9PT0gXCJzdHJpbmdcIiAmJiAocmV0ID0gcnJlbE51bS5leGVjKHZhbHVlKSkpIHtcbiAgICAgICAgICB2YWx1ZSA9IChyZXRbMV0gKyAxKSAqIHJldFsyXSArIHBhcnNlRmxvYXQoalF1ZXJ5LmNzcyhlbGVtLCBuYW1lKSk7XG4gICAgICAgICAgdHlwZSA9IFwibnVtYmVyXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSBcIm51bWJlclwiICYmICFqUXVlcnkuY3NzTnVtYmVyW29yaWdOYW1lXSkge1xuICAgICAgICAgIHZhbHVlICs9IFwicHhcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlICYmIHZhbHVlID09PSBcIlwiICYmIG5hbWUuaW5kZXhPZihcImJhY2tncm91bmRcIikgPT09IDApIHtcbiAgICAgICAgICBzdHlsZVtuYW1lXSA9IFwiaW5oZXJpdFwiO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaG9va3MgfHwgIShcInNldFwiIGluIGhvb2tzKSB8fCAodmFsdWUgPSBob29rcy5zZXQoZWxlbSwgdmFsdWUsIGV4dHJhKSkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHN0eWxlW25hbWVdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChob29rcyAmJiBcImdldFwiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoZWxlbSwgZmFsc2UsIGV4dHJhKSkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0eWxlW25hbWVdO1xuICAgICAgfVxuICAgIH0sXG4gICAgY3NzOiBmdW5jdGlvbihlbGVtLCBuYW1lLCBleHRyYSwgc3R5bGVzKSB7XG4gICAgICB2YXIgdmFsLFxuICAgICAgICAgIG51bSxcbiAgICAgICAgICBob29rcyxcbiAgICAgICAgICBvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UobmFtZSk7XG4gICAgICBuYW1lID0galF1ZXJ5LmNzc1Byb3BzW29yaWdOYW1lXSB8fCAoalF1ZXJ5LmNzc1Byb3BzW29yaWdOYW1lXSA9IHZlbmRvclByb3BOYW1lKGVsZW0uc3R5bGUsIG9yaWdOYW1lKSk7XG4gICAgICBob29rcyA9IGpRdWVyeS5jc3NIb29rc1tuYW1lXSB8fCBqUXVlcnkuY3NzSG9va3Nbb3JpZ05hbWVdO1xuICAgICAgaWYgKGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MpIHtcbiAgICAgICAgdmFsID0gaG9va3MuZ2V0KGVsZW0sIHRydWUsIGV4dHJhKTtcbiAgICAgIH1cbiAgICAgIGlmICh2YWwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YWwgPSBjdXJDU1MoZWxlbSwgbmFtZSwgc3R5bGVzKTtcbiAgICAgIH1cbiAgICAgIGlmICh2YWwgPT09IFwibm9ybWFsXCIgJiYgbmFtZSBpbiBjc3NOb3JtYWxUcmFuc2Zvcm0pIHtcbiAgICAgICAgdmFsID0gY3NzTm9ybWFsVHJhbnNmb3JtW25hbWVdO1xuICAgICAgfVxuICAgICAgaWYgKGV4dHJhID09PSBcIlwiIHx8IGV4dHJhKSB7XG4gICAgICAgIG51bSA9IHBhcnNlRmxvYXQodmFsKTtcbiAgICAgICAgcmV0dXJuIGV4dHJhID09PSB0cnVlIHx8IGpRdWVyeS5pc051bWVyaWMobnVtKSA/IG51bSB8fCAwIDogdmFsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG4gIH0pO1xuICBqUXVlcnkuZWFjaChbXCJoZWlnaHRcIiwgXCJ3aWR0aFwiXSwgZnVuY3Rpb24oaSwgbmFtZSkge1xuICAgIGpRdWVyeS5jc3NIb29rc1tuYW1lXSA9IHtcbiAgICAgIGdldDogZnVuY3Rpb24oZWxlbSwgY29tcHV0ZWQsIGV4dHJhKSB7XG4gICAgICAgIGlmIChjb21wdXRlZCkge1xuICAgICAgICAgIHJldHVybiByZGlzcGxheXN3YXAudGVzdChqUXVlcnkuY3NzKGVsZW0sIFwiZGlzcGxheVwiKSkgJiYgZWxlbS5vZmZzZXRXaWR0aCA9PT0gMCA/IGpRdWVyeS5zd2FwKGVsZW0sIGNzc1Nob3csIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFdpZHRoT3JIZWlnaHQoZWxlbSwgbmFtZSwgZXh0cmEpO1xuICAgICAgICAgIH0pIDogZ2V0V2lkdGhPckhlaWdodChlbGVtLCBuYW1lLCBleHRyYSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uKGVsZW0sIHZhbHVlLCBleHRyYSkge1xuICAgICAgICB2YXIgc3R5bGVzID0gZXh0cmEgJiYgZ2V0U3R5bGVzKGVsZW0pO1xuICAgICAgICByZXR1cm4gc2V0UG9zaXRpdmVOdW1iZXIoZWxlbSwgdmFsdWUsIGV4dHJhID8gYXVnbWVudFdpZHRoT3JIZWlnaHQoZWxlbSwgbmFtZSwgZXh0cmEsIGpRdWVyeS5jc3MoZWxlbSwgXCJib3hTaXppbmdcIiwgZmFsc2UsIHN0eWxlcykgPT09IFwiYm9yZGVyLWJveFwiLCBzdHlsZXMpIDogMCk7XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG4gIGpRdWVyeS5jc3NIb29rcy5tYXJnaW5SaWdodCA9IGFkZEdldEhvb2tJZihzdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmlnaHQsIGZ1bmN0aW9uKGVsZW0sIGNvbXB1dGVkKSB7XG4gICAgaWYgKGNvbXB1dGVkKSB7XG4gICAgICByZXR1cm4galF1ZXJ5LnN3YXAoZWxlbSwge1wiZGlzcGxheVwiOiBcImlubGluZS1ibG9ja1wifSwgY3VyQ1NTLCBbZWxlbSwgXCJtYXJnaW5SaWdodFwiXSk7XG4gICAgfVxuICB9KTtcbiAgalF1ZXJ5LmVhY2goe1xuICAgIG1hcmdpbjogXCJcIixcbiAgICBwYWRkaW5nOiBcIlwiLFxuICAgIGJvcmRlcjogXCJXaWR0aFwiXG4gIH0sIGZ1bmN0aW9uKHByZWZpeCwgc3VmZml4KSB7XG4gICAgalF1ZXJ5LmNzc0hvb2tzW3ByZWZpeCArIHN1ZmZpeF0gPSB7ZXhwYW5kOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB2YXIgaSA9IDAsXG4gICAgICAgICAgICBleHBhbmRlZCA9IHt9LFxuICAgICAgICAgICAgcGFydHMgPSB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgPyB2YWx1ZS5zcGxpdChcIiBcIikgOiBbdmFsdWVdO1xuICAgICAgICBmb3IgKDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgIGV4cGFuZGVkW3ByZWZpeCArIGNzc0V4cGFuZFtpXSArIHN1ZmZpeF0gPSBwYXJ0c1tpXSB8fCBwYXJ0c1tpIC0gMl0gfHwgcGFydHNbMF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV4cGFuZGVkO1xuICAgICAgfX07XG4gICAgaWYgKCFybWFyZ2luLnRlc3QocHJlZml4KSkge1xuICAgICAgalF1ZXJ5LmNzc0hvb2tzW3ByZWZpeCArIHN1ZmZpeF0uc2V0ID0gc2V0UG9zaXRpdmVOdW1iZXI7XG4gICAgfVxuICB9KTtcbiAgalF1ZXJ5LmZuLmV4dGVuZCh7XG4gICAgY3NzOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgICAgcmV0dXJuIGFjY2Vzcyh0aGlzLCBmdW5jdGlvbihlbGVtLCBuYW1lLCB2YWx1ZSkge1xuICAgICAgICB2YXIgc3R5bGVzLFxuICAgICAgICAgICAgbGVuLFxuICAgICAgICAgICAgbWFwID0ge30sXG4gICAgICAgICAgICBpID0gMDtcbiAgICAgICAgaWYgKGpRdWVyeS5pc0FycmF5KG5hbWUpKSB7XG4gICAgICAgICAgc3R5bGVzID0gZ2V0U3R5bGVzKGVsZW0pO1xuICAgICAgICAgIGxlbiA9IG5hbWUubGVuZ3RoO1xuICAgICAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG1hcFtuYW1lW2ldXSA9IGpRdWVyeS5jc3MoZWxlbSwgbmFtZVtpXSwgZmFsc2UsIHN0eWxlcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBtYXA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyBqUXVlcnkuc3R5bGUoZWxlbSwgbmFtZSwgdmFsdWUpIDogalF1ZXJ5LmNzcyhlbGVtLCBuYW1lKTtcbiAgICAgIH0sIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSk7XG4gICAgfSxcbiAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzaG93SGlkZSh0aGlzLCB0cnVlKTtcbiAgICB9LFxuICAgIGhpZGU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNob3dIaWRlKHRoaXMpO1xuICAgIH0sXG4gICAgdG9nZ2xlOiBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlID8gdGhpcy5zaG93KCkgOiB0aGlzLmhpZGUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChpc0hpZGRlbih0aGlzKSkge1xuICAgICAgICAgIGpRdWVyeSh0aGlzKS5zaG93KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgalF1ZXJ5KHRoaXMpLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbiAgZnVuY3Rpb24gVHdlZW4oZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcpIHtcbiAgICByZXR1cm4gbmV3IFR3ZWVuLnByb3RvdHlwZS5pbml0KGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nKTtcbiAgfVxuICBqUXVlcnkuVHdlZW4gPSBUd2VlbjtcbiAgVHdlZW4ucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBUd2VlbixcbiAgICBpbml0OiBmdW5jdGlvbihlbGVtLCBvcHRpb25zLCBwcm9wLCBlbmQsIGVhc2luZywgdW5pdCkge1xuICAgICAgdGhpcy5lbGVtID0gZWxlbTtcbiAgICAgIHRoaXMucHJvcCA9IHByb3A7XG4gICAgICB0aGlzLmVhc2luZyA9IGVhc2luZyB8fCBcInN3aW5nXCI7XG4gICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgdGhpcy5zdGFydCA9IHRoaXMubm93ID0gdGhpcy5jdXIoKTtcbiAgICAgIHRoaXMuZW5kID0gZW5kO1xuICAgICAgdGhpcy51bml0ID0gdW5pdCB8fCAoalF1ZXJ5LmNzc051bWJlcltwcm9wXSA/IFwiXCIgOiBcInB4XCIpO1xuICAgIH0sXG4gICAgY3VyOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBob29rcyA9IFR3ZWVuLnByb3BIb29rc1t0aGlzLnByb3BdO1xuICAgICAgcmV0dXJuIGhvb2tzICYmIGhvb2tzLmdldCA/IGhvb2tzLmdldCh0aGlzKSA6IFR3ZWVuLnByb3BIb29rcy5fZGVmYXVsdC5nZXQodGhpcyk7XG4gICAgfSxcbiAgICBydW46IGZ1bmN0aW9uKHBlcmNlbnQpIHtcbiAgICAgIHZhciBlYXNlZCxcbiAgICAgICAgICBob29rcyA9IFR3ZWVuLnByb3BIb29rc1t0aGlzLnByb3BdO1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5kdXJhdGlvbikge1xuICAgICAgICB0aGlzLnBvcyA9IGVhc2VkID0galF1ZXJ5LmVhc2luZ1t0aGlzLmVhc2luZ10ocGVyY2VudCwgdGhpcy5vcHRpb25zLmR1cmF0aW9uICogcGVyY2VudCwgMCwgMSwgdGhpcy5vcHRpb25zLmR1cmF0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucG9zID0gZWFzZWQgPSBwZXJjZW50O1xuICAgICAgfVxuICAgICAgdGhpcy5ub3cgPSAodGhpcy5lbmQgLSB0aGlzLnN0YXJ0KSAqIGVhc2VkICsgdGhpcy5zdGFydDtcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc3RlcCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMpO1xuICAgICAgfVxuICAgICAgaWYgKGhvb2tzICYmIGhvb2tzLnNldCkge1xuICAgICAgICBob29rcy5zZXQodGhpcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBUd2Vlbi5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KHRoaXMpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9O1xuICBUd2Vlbi5wcm90b3R5cGUuaW5pdC5wcm90b3R5cGUgPSBUd2Vlbi5wcm90b3R5cGU7XG4gIFR3ZWVuLnByb3BIb29rcyA9IHtfZGVmYXVsdDoge1xuICAgICAgZ2V0OiBmdW5jdGlvbih0d2Vlbikge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAodHdlZW4uZWxlbVt0d2Vlbi5wcm9wXSAhPSBudWxsICYmICghdHdlZW4uZWxlbS5zdHlsZSB8fCB0d2Vlbi5lbGVtLnN0eWxlW3R3ZWVuLnByb3BdID09IG51bGwpKSB7XG4gICAgICAgICAgcmV0dXJuIHR3ZWVuLmVsZW1bdHdlZW4ucHJvcF07XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0galF1ZXJ5LmNzcyh0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCBcIlwiKTtcbiAgICAgICAgcmV0dXJuICFyZXN1bHQgfHwgcmVzdWx0ID09PSBcImF1dG9cIiA/IDAgOiByZXN1bHQ7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbih0d2Vlbikge1xuICAgICAgICBpZiAoalF1ZXJ5LmZ4LnN0ZXBbdHdlZW4ucHJvcF0pIHtcbiAgICAgICAgICBqUXVlcnkuZnguc3RlcFt0d2Vlbi5wcm9wXSh0d2Vlbik7XG4gICAgICAgIH0gZWxzZSBpZiAodHdlZW4uZWxlbS5zdHlsZSAmJiAodHdlZW4uZWxlbS5zdHlsZVtqUXVlcnkuY3NzUHJvcHNbdHdlZW4ucHJvcF1dICE9IG51bGwgfHwgalF1ZXJ5LmNzc0hvb2tzW3R3ZWVuLnByb3BdKSkge1xuICAgICAgICAgIGpRdWVyeS5zdHlsZSh0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCB0d2Vlbi5ub3cgKyB0d2Vlbi51bml0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0d2Vlbi5lbGVtW3R3ZWVuLnByb3BdID0gdHdlZW4ubm93O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfX07XG4gIFR3ZWVuLnByb3BIb29rcy5zY3JvbGxUb3AgPSBUd2Vlbi5wcm9wSG9va3Muc2Nyb2xsTGVmdCA9IHtzZXQ6IGZ1bmN0aW9uKHR3ZWVuKSB7XG4gICAgICBpZiAodHdlZW4uZWxlbS5ub2RlVHlwZSAmJiB0d2Vlbi5lbGVtLnBhcmVudE5vZGUpIHtcbiAgICAgICAgdHdlZW4uZWxlbVt0d2Vlbi5wcm9wXSA9IHR3ZWVuLm5vdztcbiAgICAgIH1cbiAgICB9fTtcbiAgalF1ZXJ5LmVhc2luZyA9IHtcbiAgICBsaW5lYXI6IGZ1bmN0aW9uKHApIHtcbiAgICAgIHJldHVybiBwO1xuICAgIH0sXG4gICAgc3dpbmc6IGZ1bmN0aW9uKHApIHtcbiAgICAgIHJldHVybiAwLjUgLSBNYXRoLmNvcyhwICogTWF0aC5QSSkgLyAyO1xuICAgIH1cbiAgfTtcbiAgalF1ZXJ5LmZ4ID0gVHdlZW4ucHJvdG90eXBlLmluaXQ7XG4gIGpRdWVyeS5meC5zdGVwID0ge307XG4gIHZhciBmeE5vdyxcbiAgICAgIHRpbWVySWQsXG4gICAgICByZnh0eXBlcyA9IC9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLyxcbiAgICAgIHJmeG51bSA9IG5ldyBSZWdFeHAoXCJeKD86KFsrLV0pPXwpKFwiICsgcG51bSArIFwiKShbYS16JV0qKSRcIiwgXCJpXCIpLFxuICAgICAgcnJ1biA9IC9xdWV1ZUhvb2tzJC8sXG4gICAgICBhbmltYXRpb25QcmVmaWx0ZXJzID0gW2RlZmF1bHRQcmVmaWx0ZXJdLFxuICAgICAgdHdlZW5lcnMgPSB7XCIqXCI6IFtmdW5jdGlvbihwcm9wLCB2YWx1ZSkge1xuICAgICAgICAgIHZhciB0d2VlbiA9IHRoaXMuY3JlYXRlVHdlZW4ocHJvcCwgdmFsdWUpLFxuICAgICAgICAgICAgICB0YXJnZXQgPSB0d2Vlbi5jdXIoKSxcbiAgICAgICAgICAgICAgcGFydHMgPSByZnhudW0uZXhlYyh2YWx1ZSksXG4gICAgICAgICAgICAgIHVuaXQgPSBwYXJ0cyAmJiBwYXJ0c1szXSB8fCAoalF1ZXJ5LmNzc051bWJlcltwcm9wXSA/IFwiXCIgOiBcInB4XCIpLFxuICAgICAgICAgICAgICBzdGFydCA9IChqUXVlcnkuY3NzTnVtYmVyW3Byb3BdIHx8IHVuaXQgIT09IFwicHhcIiAmJiArdGFyZ2V0KSAmJiByZnhudW0uZXhlYyhqUXVlcnkuY3NzKHR3ZWVuLmVsZW0sIHByb3ApKSxcbiAgICAgICAgICAgICAgc2NhbGUgPSAxLFxuICAgICAgICAgICAgICBtYXhJdGVyYXRpb25zID0gMjA7XG4gICAgICAgICAgaWYgKHN0YXJ0ICYmIHN0YXJ0WzNdICE9PSB1bml0KSB7XG4gICAgICAgICAgICB1bml0ID0gdW5pdCB8fCBzdGFydFszXTtcbiAgICAgICAgICAgIHBhcnRzID0gcGFydHMgfHwgW107XG4gICAgICAgICAgICBzdGFydCA9ICt0YXJnZXQgfHwgMTtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgc2NhbGUgPSBzY2FsZSB8fCBcIi41XCI7XG4gICAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnQgLyBzY2FsZTtcbiAgICAgICAgICAgICAgalF1ZXJ5LnN0eWxlKHR3ZWVuLmVsZW0sIHByb3AsIHN0YXJ0ICsgdW5pdCk7XG4gICAgICAgICAgICB9IHdoaWxlIChzY2FsZSAhPT0gKHNjYWxlID0gdHdlZW4uY3VyKCkgLyB0YXJnZXQpICYmIHNjYWxlICE9PSAxICYmIC0tbWF4SXRlcmF0aW9ucyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChwYXJ0cykge1xuICAgICAgICAgICAgc3RhcnQgPSB0d2Vlbi5zdGFydCA9ICtzdGFydCB8fCArdGFyZ2V0IHx8IDA7XG4gICAgICAgICAgICB0d2Vlbi51bml0ID0gdW5pdDtcbiAgICAgICAgICAgIHR3ZWVuLmVuZCA9IHBhcnRzWzFdID8gc3RhcnQgKyAocGFydHNbMV0gKyAxKSAqIHBhcnRzWzJdIDogK3BhcnRzWzJdO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdHdlZW47XG4gICAgICAgIH1dfTtcbiAgZnVuY3Rpb24gY3JlYXRlRnhOb3coKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGZ4Tm93ID0gdW5kZWZpbmVkO1xuICAgIH0pO1xuICAgIHJldHVybiAoZnhOb3cgPSBqUXVlcnkubm93KCkpO1xuICB9XG4gIGZ1bmN0aW9uIGdlbkZ4KHR5cGUsIGluY2x1ZGVXaWR0aCkge1xuICAgIHZhciB3aGljaCxcbiAgICAgICAgaSA9IDAsXG4gICAgICAgIGF0dHJzID0ge2hlaWdodDogdHlwZX07XG4gICAgaW5jbHVkZVdpZHRoID0gaW5jbHVkZVdpZHRoID8gMSA6IDA7XG4gICAgZm9yICg7IGkgPCA0OyBpICs9IDIgLSBpbmNsdWRlV2lkdGgpIHtcbiAgICAgIHdoaWNoID0gY3NzRXhwYW5kW2ldO1xuICAgICAgYXR0cnNbXCJtYXJnaW5cIiArIHdoaWNoXSA9IGF0dHJzW1wicGFkZGluZ1wiICsgd2hpY2hdID0gdHlwZTtcbiAgICB9XG4gICAgaWYgKGluY2x1ZGVXaWR0aCkge1xuICAgICAgYXR0cnMub3BhY2l0eSA9IGF0dHJzLndpZHRoID0gdHlwZTtcbiAgICB9XG4gICAgcmV0dXJuIGF0dHJzO1xuICB9XG4gIGZ1bmN0aW9uIGNyZWF0ZVR3ZWVuKHZhbHVlLCBwcm9wLCBhbmltYXRpb24pIHtcbiAgICB2YXIgdHdlZW4sXG4gICAgICAgIGNvbGxlY3Rpb24gPSAodHdlZW5lcnNbcHJvcF0gfHwgW10pLmNvbmNhdCh0d2VlbmVyc1tcIipcIl0pLFxuICAgICAgICBpbmRleCA9IDAsXG4gICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24ubGVuZ3RoO1xuICAgIGZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgaWYgKCh0d2VlbiA9IGNvbGxlY3Rpb25baW5kZXhdLmNhbGwoYW5pbWF0aW9uLCBwcm9wLCB2YWx1ZSkpKSB7XG4gICAgICAgIHJldHVybiB0d2VlbjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gZGVmYXVsdFByZWZpbHRlcihlbGVtLCBwcm9wcywgb3B0cykge1xuICAgIHZhciBwcm9wLFxuICAgICAgICB2YWx1ZSxcbiAgICAgICAgdG9nZ2xlLFxuICAgICAgICB0d2VlbixcbiAgICAgICAgaG9va3MsXG4gICAgICAgIG9sZGZpcmUsXG4gICAgICAgIGRpc3BsYXksXG4gICAgICAgIGNoZWNrRGlzcGxheSxcbiAgICAgICAgYW5pbSA9IHRoaXMsXG4gICAgICAgIG9yaWcgPSB7fSxcbiAgICAgICAgc3R5bGUgPSBlbGVtLnN0eWxlLFxuICAgICAgICBoaWRkZW4gPSBlbGVtLm5vZGVUeXBlICYmIGlzSGlkZGVuKGVsZW0pLFxuICAgICAgICBkYXRhU2hvdyA9IGRhdGFfcHJpdi5nZXQoZWxlbSwgXCJmeHNob3dcIik7XG4gICAgaWYgKCFvcHRzLnF1ZXVlKSB7XG4gICAgICBob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyhlbGVtLCBcImZ4XCIpO1xuICAgICAgaWYgKGhvb2tzLnVucXVldWVkID09IG51bGwpIHtcbiAgICAgICAgaG9va3MudW5xdWV1ZWQgPSAwO1xuICAgICAgICBvbGRmaXJlID0gaG9va3MuZW1wdHkuZmlyZTtcbiAgICAgICAgaG9va3MuZW1wdHkuZmlyZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICghaG9va3MudW5xdWV1ZWQpIHtcbiAgICAgICAgICAgIG9sZGZpcmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBob29rcy51bnF1ZXVlZCsrO1xuICAgICAgYW5pbS5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgIGFuaW0uYWx3YXlzKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGhvb2tzLnVucXVldWVkLS07XG4gICAgICAgICAgaWYgKCFqUXVlcnkucXVldWUoZWxlbSwgXCJmeFwiKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGhvb2tzLmVtcHR5LmZpcmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSAxICYmIChcImhlaWdodFwiIGluIHByb3BzIHx8IFwid2lkdGhcIiBpbiBwcm9wcykpIHtcbiAgICAgIG9wdHMub3ZlcmZsb3cgPSBbc3R5bGUub3ZlcmZsb3csIHN0eWxlLm92ZXJmbG93WCwgc3R5bGUub3ZlcmZsb3dZXTtcbiAgICAgIGRpc3BsYXkgPSBqUXVlcnkuY3NzKGVsZW0sIFwiZGlzcGxheVwiKTtcbiAgICAgIGNoZWNrRGlzcGxheSA9IGRpc3BsYXkgPT09IFwibm9uZVwiID8gZGF0YV9wcml2LmdldChlbGVtLCBcIm9sZGRpc3BsYXlcIikgfHwgZGVmYXVsdERpc3BsYXkoZWxlbS5ub2RlTmFtZSkgOiBkaXNwbGF5O1xuICAgICAgaWYgKGNoZWNrRGlzcGxheSA9PT0gXCJpbmxpbmVcIiAmJiBqUXVlcnkuY3NzKGVsZW0sIFwiZmxvYXRcIikgPT09IFwibm9uZVwiKSB7XG4gICAgICAgIHN0eWxlLmRpc3BsYXkgPSBcImlubGluZS1ibG9ja1wiO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAob3B0cy5vdmVyZmxvdykge1xuICAgICAgc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuICAgICAgYW5pbS5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgIHN0eWxlLm92ZXJmbG93ID0gb3B0cy5vdmVyZmxvd1swXTtcbiAgICAgICAgc3R5bGUub3ZlcmZsb3dYID0gb3B0cy5vdmVyZmxvd1sxXTtcbiAgICAgICAgc3R5bGUub3ZlcmZsb3dZID0gb3B0cy5vdmVyZmxvd1syXTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmb3IgKHByb3AgaW4gcHJvcHMpIHtcbiAgICAgIHZhbHVlID0gcHJvcHNbcHJvcF07XG4gICAgICBpZiAocmZ4dHlwZXMuZXhlYyh2YWx1ZSkpIHtcbiAgICAgICAgZGVsZXRlIHByb3BzW3Byb3BdO1xuICAgICAgICB0b2dnbGUgPSB0b2dnbGUgfHwgdmFsdWUgPT09IFwidG9nZ2xlXCI7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gKGhpZGRlbiA/IFwiaGlkZVwiIDogXCJzaG93XCIpKSB7XG4gICAgICAgICAgaWYgKHZhbHVlID09PSBcInNob3dcIiAmJiBkYXRhU2hvdyAmJiBkYXRhU2hvd1twcm9wXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBoaWRkZW4gPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3JpZ1twcm9wXSA9IGRhdGFTaG93ICYmIGRhdGFTaG93W3Byb3BdIHx8IGpRdWVyeS5zdHlsZShlbGVtLCBwcm9wKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRpc3BsYXkgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghalF1ZXJ5LmlzRW1wdHlPYmplY3Qob3JpZykpIHtcbiAgICAgIGlmIChkYXRhU2hvdykge1xuICAgICAgICBpZiAoXCJoaWRkZW5cIiBpbiBkYXRhU2hvdykge1xuICAgICAgICAgIGhpZGRlbiA9IGRhdGFTaG93LmhpZGRlbjtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YVNob3cgPSBkYXRhX3ByaXYuYWNjZXNzKGVsZW0sIFwiZnhzaG93XCIsIHt9KTtcbiAgICAgIH1cbiAgICAgIGlmICh0b2dnbGUpIHtcbiAgICAgICAgZGF0YVNob3cuaGlkZGVuID0gIWhpZGRlbjtcbiAgICAgIH1cbiAgICAgIGlmIChoaWRkZW4pIHtcbiAgICAgICAgalF1ZXJ5KGVsZW0pLnNob3coKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFuaW0uZG9uZShmdW5jdGlvbigpIHtcbiAgICAgICAgICBqUXVlcnkoZWxlbSkuaGlkZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGFuaW0uZG9uZShmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHByb3A7XG4gICAgICAgIGRhdGFfcHJpdi5yZW1vdmUoZWxlbSwgXCJmeHNob3dcIik7XG4gICAgICAgIGZvciAocHJvcCBpbiBvcmlnKSB7XG4gICAgICAgICAgalF1ZXJ5LnN0eWxlKGVsZW0sIHByb3AsIG9yaWdbcHJvcF0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGZvciAocHJvcCBpbiBvcmlnKSB7XG4gICAgICAgIHR3ZWVuID0gY3JlYXRlVHdlZW4oaGlkZGVuID8gZGF0YVNob3dbcHJvcF0gOiAwLCBwcm9wLCBhbmltKTtcbiAgICAgICAgaWYgKCEocHJvcCBpbiBkYXRhU2hvdykpIHtcbiAgICAgICAgICBkYXRhU2hvd1twcm9wXSA9IHR3ZWVuLnN0YXJ0O1xuICAgICAgICAgIGlmIChoaWRkZW4pIHtcbiAgICAgICAgICAgIHR3ZWVuLmVuZCA9IHR3ZWVuLnN0YXJ0O1xuICAgICAgICAgICAgdHdlZW4uc3RhcnQgPSBwcm9wID09PSBcIndpZHRoXCIgfHwgcHJvcCA9PT0gXCJoZWlnaHRcIiA/IDEgOiAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoKGRpc3BsYXkgPT09IFwibm9uZVwiID8gZGVmYXVsdERpc3BsYXkoZWxlbS5ub2RlTmFtZSkgOiBkaXNwbGF5KSA9PT0gXCJpbmxpbmVcIikge1xuICAgICAgc3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIHByb3BGaWx0ZXIocHJvcHMsIHNwZWNpYWxFYXNpbmcpIHtcbiAgICB2YXIgaW5kZXgsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGVhc2luZyxcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIGhvb2tzO1xuICAgIGZvciAoaW5kZXggaW4gcHJvcHMpIHtcbiAgICAgIG5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKGluZGV4KTtcbiAgICAgIGVhc2luZyA9IHNwZWNpYWxFYXNpbmdbbmFtZV07XG4gICAgICB2YWx1ZSA9IHByb3BzW2luZGV4XTtcbiAgICAgIGlmIChqUXVlcnkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgZWFzaW5nID0gdmFsdWVbMV07XG4gICAgICAgIHZhbHVlID0gcHJvcHNbaW5kZXhdID0gdmFsdWVbMF07XG4gICAgICB9XG4gICAgICBpZiAoaW5kZXggIT09IG5hbWUpIHtcbiAgICAgICAgcHJvcHNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgZGVsZXRlIHByb3BzW2luZGV4XTtcbiAgICAgIH1cbiAgICAgIGhvb2tzID0galF1ZXJ5LmNzc0hvb2tzW25hbWVdO1xuICAgICAgaWYgKGhvb2tzICYmIFwiZXhwYW5kXCIgaW4gaG9va3MpIHtcbiAgICAgICAgdmFsdWUgPSBob29rcy5leHBhbmQodmFsdWUpO1xuICAgICAgICBkZWxldGUgcHJvcHNbbmFtZV07XG4gICAgICAgIGZvciAoaW5kZXggaW4gdmFsdWUpIHtcbiAgICAgICAgICBpZiAoIShpbmRleCBpbiBwcm9wcykpIHtcbiAgICAgICAgICAgIHByb3BzW2luZGV4XSA9IHZhbHVlW2luZGV4XTtcbiAgICAgICAgICAgIHNwZWNpYWxFYXNpbmdbaW5kZXhdID0gZWFzaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3BlY2lhbEVhc2luZ1tuYW1lXSA9IGVhc2luZztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gQW5pbWF0aW9uKGVsZW0sIHByb3BlcnRpZXMsIG9wdGlvbnMpIHtcbiAgICB2YXIgcmVzdWx0LFxuICAgICAgICBzdG9wcGVkLFxuICAgICAgICBpbmRleCA9IDAsXG4gICAgICAgIGxlbmd0aCA9IGFuaW1hdGlvblByZWZpbHRlcnMubGVuZ3RoLFxuICAgICAgICBkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbigpIHtcbiAgICAgICAgICBkZWxldGUgdGljay5lbGVtO1xuICAgICAgICB9KSxcbiAgICAgICAgdGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmIChzdG9wcGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksXG4gICAgICAgICAgICAgIHJlbWFpbmluZyA9IE1hdGgubWF4KDAsIGFuaW1hdGlvbi5zdGFydFRpbWUgKyBhbmltYXRpb24uZHVyYXRpb24gLSBjdXJyZW50VGltZSksXG4gICAgICAgICAgICAgIHRlbXAgPSByZW1haW5pbmcgLyBhbmltYXRpb24uZHVyYXRpb24gfHwgMCxcbiAgICAgICAgICAgICAgcGVyY2VudCA9IDEgLSB0ZW1wLFxuICAgICAgICAgICAgICBpbmRleCA9IDAsXG4gICAgICAgICAgICAgIGxlbmd0aCA9IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoO1xuICAgICAgICAgIGZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgYW5pbWF0aW9uLnR3ZWVuc1tpbmRleF0ucnVuKHBlcmNlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkZWZlcnJlZC5ub3RpZnlXaXRoKGVsZW0sIFthbmltYXRpb24sIHBlcmNlbnQsIHJlbWFpbmluZ10pO1xuICAgICAgICAgIGlmIChwZXJjZW50IDwgMSAmJiBsZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiByZW1haW5pbmc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmVXaXRoKGVsZW0sIFthbmltYXRpb25dKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFuaW1hdGlvbiA9IGRlZmVycmVkLnByb21pc2Uoe1xuICAgICAgICAgIGVsZW06IGVsZW0sXG4gICAgICAgICAgcHJvcHM6IGpRdWVyeS5leHRlbmQoe30sIHByb3BlcnRpZXMpLFxuICAgICAgICAgIG9wdHM6IGpRdWVyeS5leHRlbmQodHJ1ZSwge3NwZWNpYWxFYXNpbmc6IHt9fSwgb3B0aW9ucyksXG4gICAgICAgICAgb3JpZ2luYWxQcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLFxuICAgICAgICAgIG9yaWdpbmFsT3B0aW9uczogb3B0aW9ucyxcbiAgICAgICAgICBzdGFydFRpbWU6IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksXG4gICAgICAgICAgZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb24sXG4gICAgICAgICAgdHdlZW5zOiBbXSxcbiAgICAgICAgICBjcmVhdGVUd2VlbjogZnVuY3Rpb24ocHJvcCwgZW5kKSB7XG4gICAgICAgICAgICB2YXIgdHdlZW4gPSBqUXVlcnkuVHdlZW4oZWxlbSwgYW5pbWF0aW9uLm9wdHMsIHByb3AsIGVuZCwgYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZ1twcm9wXSB8fCBhbmltYXRpb24ub3B0cy5lYXNpbmcpO1xuICAgICAgICAgICAgYW5pbWF0aW9uLnR3ZWVucy5wdXNoKHR3ZWVuKTtcbiAgICAgICAgICAgIHJldHVybiB0d2VlbjtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uKGdvdG9FbmQpIHtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IDAsXG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gZ290b0VuZCA/IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoIDogMDtcbiAgICAgICAgICAgIGlmIChzdG9wcGVkKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgICBmb3IgKDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgYW5pbWF0aW9uLnR3ZWVuc1tpbmRleF0ucnVuKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdvdG9FbmQpIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZVdpdGgoZWxlbSwgW2FuaW1hdGlvbiwgZ290b0VuZF0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0V2l0aChlbGVtLCBbYW5pbWF0aW9uLCBnb3RvRW5kXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICBwcm9wcyA9IGFuaW1hdGlvbi5wcm9wcztcbiAgICBwcm9wRmlsdGVyKHByb3BzLCBhbmltYXRpb24ub3B0cy5zcGVjaWFsRWFzaW5nKTtcbiAgICBmb3IgKDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIHJlc3VsdCA9IGFuaW1hdGlvblByZWZpbHRlcnNbaW5kZXhdLmNhbGwoYW5pbWF0aW9uLCBlbGVtLCBwcm9wcywgYW5pbWF0aW9uLm9wdHMpO1xuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgIH1cbiAgICBqUXVlcnkubWFwKHByb3BzLCBjcmVhdGVUd2VlbiwgYW5pbWF0aW9uKTtcbiAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24oYW5pbWF0aW9uLm9wdHMuc3RhcnQpKSB7XG4gICAgICBhbmltYXRpb24ub3B0cy5zdGFydC5jYWxsKGVsZW0sIGFuaW1hdGlvbik7XG4gICAgfVxuICAgIGpRdWVyeS5meC50aW1lcihqUXVlcnkuZXh0ZW5kKHRpY2ssIHtcbiAgICAgIGVsZW06IGVsZW0sXG4gICAgICBhbmltOiBhbmltYXRpb24sXG4gICAgICBxdWV1ZTogYW5pbWF0aW9uLm9wdHMucXVldWVcbiAgICB9KSk7XG4gICAgcmV0dXJuIGFuaW1hdGlvbi5wcm9ncmVzcyhhbmltYXRpb24ub3B0cy5wcm9ncmVzcykuZG9uZShhbmltYXRpb24ub3B0cy5kb25lLCBhbmltYXRpb24ub3B0cy5jb21wbGV0ZSkuZmFpbChhbmltYXRpb24ub3B0cy5mYWlsKS5hbHdheXMoYW5pbWF0aW9uLm9wdHMuYWx3YXlzKTtcbiAgfVxuICBqUXVlcnkuQW5pbWF0aW9uID0galF1ZXJ5LmV4dGVuZChBbmltYXRpb24sIHtcbiAgICB0d2VlbmVyOiBmdW5jdGlvbihwcm9wcywgY2FsbGJhY2spIHtcbiAgICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbihwcm9wcykpIHtcbiAgICAgICAgY2FsbGJhY2sgPSBwcm9wcztcbiAgICAgICAgcHJvcHMgPSBbXCIqXCJdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJvcHMgPSBwcm9wcy5zcGxpdChcIiBcIik7XG4gICAgICB9XG4gICAgICB2YXIgcHJvcCxcbiAgICAgICAgICBpbmRleCA9IDAsXG4gICAgICAgICAgbGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuICAgICAgZm9yICg7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIHByb3AgPSBwcm9wc1tpbmRleF07XG4gICAgICAgIHR3ZWVuZXJzW3Byb3BdID0gdHdlZW5lcnNbcHJvcF0gfHwgW107XG4gICAgICAgIHR3ZWVuZXJzW3Byb3BdLnVuc2hpZnQoY2FsbGJhY2spO1xuICAgICAgfVxuICAgIH0sXG4gICAgcHJlZmlsdGVyOiBmdW5jdGlvbihjYWxsYmFjaywgcHJlcGVuZCkge1xuICAgICAgaWYgKHByZXBlbmQpIHtcbiAgICAgICAgYW5pbWF0aW9uUHJlZmlsdGVycy51bnNoaWZ0KGNhbGxiYWNrKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFuaW1hdGlvblByZWZpbHRlcnMucHVzaChjYWxsYmFjayk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgalF1ZXJ5LnNwZWVkID0gZnVuY3Rpb24oc3BlZWQsIGVhc2luZywgZm4pIHtcbiAgICB2YXIgb3B0ID0gc3BlZWQgJiYgdHlwZW9mIHNwZWVkID09PSBcIm9iamVjdFwiID8galF1ZXJ5LmV4dGVuZCh7fSwgc3BlZWQpIDoge1xuICAgICAgY29tcGxldGU6IGZuIHx8ICFmbiAmJiBlYXNpbmcgfHwgalF1ZXJ5LmlzRnVuY3Rpb24oc3BlZWQpICYmIHNwZWVkLFxuICAgICAgZHVyYXRpb246IHNwZWVkLFxuICAgICAgZWFzaW5nOiBmbiAmJiBlYXNpbmcgfHwgZWFzaW5nICYmICFqUXVlcnkuaXNGdW5jdGlvbihlYXNpbmcpICYmIGVhc2luZ1xuICAgIH07XG4gICAgb3B0LmR1cmF0aW9uID0galF1ZXJ5LmZ4Lm9mZiA/IDAgOiB0eXBlb2Ygb3B0LmR1cmF0aW9uID09PSBcIm51bWJlclwiID8gb3B0LmR1cmF0aW9uIDogb3B0LmR1cmF0aW9uIGluIGpRdWVyeS5meC5zcGVlZHMgPyBqUXVlcnkuZnguc3BlZWRzW29wdC5kdXJhdGlvbl0gOiBqUXVlcnkuZnguc3BlZWRzLl9kZWZhdWx0O1xuICAgIGlmIChvcHQucXVldWUgPT0gbnVsbCB8fCBvcHQucXVldWUgPT09IHRydWUpIHtcbiAgICAgIG9wdC5xdWV1ZSA9IFwiZnhcIjtcbiAgICB9XG4gICAgb3B0Lm9sZCA9IG9wdC5jb21wbGV0ZTtcbiAgICBvcHQuY29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbihvcHQub2xkKSkge1xuICAgICAgICBvcHQub2xkLmNhbGwodGhpcyk7XG4gICAgICB9XG4gICAgICBpZiAob3B0LnF1ZXVlKSB7XG4gICAgICAgIGpRdWVyeS5kZXF1ZXVlKHRoaXMsIG9wdC5xdWV1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gb3B0O1xuICB9O1xuICBqUXVlcnkuZm4uZXh0ZW5kKHtcbiAgICBmYWRlVG86IGZ1bmN0aW9uKHNwZWVkLCB0bywgZWFzaW5nLCBjYWxsYmFjaykge1xuICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKGlzSGlkZGVuKS5jc3MoXCJvcGFjaXR5XCIsIDApLnNob3coKS5lbmQoKS5hbmltYXRlKHtvcGFjaXR5OiB0b30sIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrKTtcbiAgICB9LFxuICAgIGFuaW1hdGU6IGZ1bmN0aW9uKHByb3AsIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgZW1wdHkgPSBqUXVlcnkuaXNFbXB0eU9iamVjdChwcm9wKSxcbiAgICAgICAgICBvcHRhbGwgPSBqUXVlcnkuc3BlZWQoc3BlZWQsIGVhc2luZywgY2FsbGJhY2spLFxuICAgICAgICAgIGRvQW5pbWF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYW5pbSA9IEFuaW1hdGlvbih0aGlzLCBqUXVlcnkuZXh0ZW5kKHt9LCBwcm9wKSwgb3B0YWxsKTtcbiAgICAgICAgICAgIGlmIChlbXB0eSB8fCBkYXRhX3ByaXYuZ2V0KHRoaXMsIFwiZmluaXNoXCIpKSB7XG4gICAgICAgICAgICAgIGFuaW0uc3RvcCh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgZG9BbmltYXRpb24uZmluaXNoID0gZG9BbmltYXRpb247XG4gICAgICByZXR1cm4gZW1wdHkgfHwgb3B0YWxsLnF1ZXVlID09PSBmYWxzZSA/IHRoaXMuZWFjaChkb0FuaW1hdGlvbikgOiB0aGlzLnF1ZXVlKG9wdGFsbC5xdWV1ZSwgZG9BbmltYXRpb24pO1xuICAgIH0sXG4gICAgc3RvcDogZnVuY3Rpb24odHlwZSwgY2xlYXJRdWV1ZSwgZ290b0VuZCkge1xuICAgICAgdmFyIHN0b3BRdWV1ZSA9IGZ1bmN0aW9uKGhvb2tzKSB7XG4gICAgICAgIHZhciBzdG9wID0gaG9va3Muc3RvcDtcbiAgICAgICAgZGVsZXRlIGhvb2tzLnN0b3A7XG4gICAgICAgIHN0b3AoZ290b0VuZCk7XG4gICAgICB9O1xuICAgICAgaWYgKHR5cGVvZiB0eXBlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGdvdG9FbmQgPSBjbGVhclF1ZXVlO1xuICAgICAgICBjbGVhclF1ZXVlID0gdHlwZTtcbiAgICAgICAgdHlwZSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIGlmIChjbGVhclF1ZXVlICYmIHR5cGUgIT09IGZhbHNlKSB7XG4gICAgICAgIHRoaXMucXVldWUodHlwZSB8fCBcImZ4XCIsIFtdKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkZXF1ZXVlID0gdHJ1ZSxcbiAgICAgICAgICAgIGluZGV4ID0gdHlwZSAhPSBudWxsICYmIHR5cGUgKyBcInF1ZXVlSG9va3NcIixcbiAgICAgICAgICAgIHRpbWVycyA9IGpRdWVyeS50aW1lcnMsXG4gICAgICAgICAgICBkYXRhID0gZGF0YV9wcml2LmdldCh0aGlzKTtcbiAgICAgICAgaWYgKGluZGV4KSB7XG4gICAgICAgICAgaWYgKGRhdGFbaW5kZXhdICYmIGRhdGFbaW5kZXhdLnN0b3ApIHtcbiAgICAgICAgICAgIHN0b3BRdWV1ZShkYXRhW2luZGV4XSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAoaW5kZXggaW4gZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGFbaW5kZXhdICYmIGRhdGFbaW5kZXhdLnN0b3AgJiYgcnJ1bi50ZXN0KGluZGV4KSkge1xuICAgICAgICAgICAgICBzdG9wUXVldWUoZGF0YVtpbmRleF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGluZGV4ID0gdGltZXJzLmxlbmd0aDsgaW5kZXgtLTsgKSB7XG4gICAgICAgICAgaWYgKHRpbWVyc1tpbmRleF0uZWxlbSA9PT0gdGhpcyAmJiAodHlwZSA9PSBudWxsIHx8IHRpbWVyc1tpbmRleF0ucXVldWUgPT09IHR5cGUpKSB7XG4gICAgICAgICAgICB0aW1lcnNbaW5kZXhdLmFuaW0uc3RvcChnb3RvRW5kKTtcbiAgICAgICAgICAgIGRlcXVldWUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRpbWVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVxdWV1ZSB8fCAhZ290b0VuZCkge1xuICAgICAgICAgIGpRdWVyeS5kZXF1ZXVlKHRoaXMsIHR5cGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGZpbmlzaDogZnVuY3Rpb24odHlwZSkge1xuICAgICAgaWYgKHR5cGUgIT09IGZhbHNlKSB7XG4gICAgICAgIHR5cGUgPSB0eXBlIHx8IFwiZnhcIjtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpbmRleCxcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhX3ByaXYuZ2V0KHRoaXMpLFxuICAgICAgICAgICAgcXVldWUgPSBkYXRhW3R5cGUgKyBcInF1ZXVlXCJdLFxuICAgICAgICAgICAgaG9va3MgPSBkYXRhW3R5cGUgKyBcInF1ZXVlSG9va3NcIl0sXG4gICAgICAgICAgICB0aW1lcnMgPSBqUXVlcnkudGltZXJzLFxuICAgICAgICAgICAgbGVuZ3RoID0gcXVldWUgPyBxdWV1ZS5sZW5ndGggOiAwO1xuICAgICAgICBkYXRhLmZpbmlzaCA9IHRydWU7XG4gICAgICAgIGpRdWVyeS5xdWV1ZSh0aGlzLCB0eXBlLCBbXSk7XG4gICAgICAgIGlmIChob29rcyAmJiBob29rcy5zdG9wKSB7XG4gICAgICAgICAgaG9va3Muc3RvcC5jYWxsKHRoaXMsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHtcbiAgICAgICAgICBpZiAodGltZXJzW2luZGV4XS5lbGVtID09PSB0aGlzICYmIHRpbWVyc1tpbmRleF0ucXVldWUgPT09IHR5cGUpIHtcbiAgICAgICAgICAgIHRpbWVyc1tpbmRleF0uYW5pbS5zdG9wKHRydWUpO1xuICAgICAgICAgICAgdGltZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgIGlmIChxdWV1ZVtpbmRleF0gJiYgcXVldWVbaW5kZXhdLmZpbmlzaCkge1xuICAgICAgICAgICAgcXVldWVbaW5kZXhdLmZpbmlzaC5jYWxsKHRoaXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgZGF0YS5maW5pc2g7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuICBqUXVlcnkuZWFjaChbXCJ0b2dnbGVcIiwgXCJzaG93XCIsIFwiaGlkZVwiXSwgZnVuY3Rpb24oaSwgbmFtZSkge1xuICAgIHZhciBjc3NGbiA9IGpRdWVyeS5mbltuYW1lXTtcbiAgICBqUXVlcnkuZm5bbmFtZV0gPSBmdW5jdGlvbihzcGVlZCwgZWFzaW5nLCBjYWxsYmFjaykge1xuICAgICAgcmV0dXJuIHNwZWVkID09IG51bGwgfHwgdHlwZW9mIHNwZWVkID09PSBcImJvb2xlYW5cIiA/IGNzc0ZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiB0aGlzLmFuaW1hdGUoZ2VuRngobmFtZSwgdHJ1ZSksIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrKTtcbiAgICB9O1xuICB9KTtcbiAgalF1ZXJ5LmVhY2goe1xuICAgIHNsaWRlRG93bjogZ2VuRngoXCJzaG93XCIpLFxuICAgIHNsaWRlVXA6IGdlbkZ4KFwiaGlkZVwiKSxcbiAgICBzbGlkZVRvZ2dsZTogZ2VuRngoXCJ0b2dnbGVcIiksXG4gICAgZmFkZUluOiB7b3BhY2l0eTogXCJzaG93XCJ9LFxuICAgIGZhZGVPdXQ6IHtvcGFjaXR5OiBcImhpZGVcIn0sXG4gICAgZmFkZVRvZ2dsZToge29wYWNpdHk6IFwidG9nZ2xlXCJ9XG4gIH0sIGZ1bmN0aW9uKG5hbWUsIHByb3BzKSB7XG4gICAgalF1ZXJ5LmZuW25hbWVdID0gZnVuY3Rpb24oc3BlZWQsIGVhc2luZywgY2FsbGJhY2spIHtcbiAgICAgIHJldHVybiB0aGlzLmFuaW1hdGUocHJvcHMsIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrKTtcbiAgICB9O1xuICB9KTtcbiAgalF1ZXJ5LnRpbWVycyA9IFtdO1xuICBqUXVlcnkuZngudGljayA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0aW1lcixcbiAgICAgICAgaSA9IDAsXG4gICAgICAgIHRpbWVycyA9IGpRdWVyeS50aW1lcnM7XG4gICAgZnhOb3cgPSBqUXVlcnkubm93KCk7XG4gICAgZm9yICg7IGkgPCB0aW1lcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRpbWVyID0gdGltZXJzW2ldO1xuICAgICAgaWYgKCF0aW1lcigpICYmIHRpbWVyc1tpXSA9PT0gdGltZXIpIHtcbiAgICAgICAgdGltZXJzLnNwbGljZShpLS0sIDEpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXRpbWVycy5sZW5ndGgpIHtcbiAgICAgIGpRdWVyeS5meC5zdG9wKCk7XG4gICAgfVxuICAgIGZ4Tm93ID0gdW5kZWZpbmVkO1xuICB9O1xuICBqUXVlcnkuZngudGltZXIgPSBmdW5jdGlvbih0aW1lcikge1xuICAgIGpRdWVyeS50aW1lcnMucHVzaCh0aW1lcik7XG4gICAgaWYgKHRpbWVyKCkpIHtcbiAgICAgIGpRdWVyeS5meC5zdGFydCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBqUXVlcnkudGltZXJzLnBvcCgpO1xuICAgIH1cbiAgfTtcbiAgalF1ZXJ5LmZ4LmludGVydmFsID0gMTM7XG4gIGpRdWVyeS5meC5zdGFydCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGltZXJJZCkge1xuICAgICAgdGltZXJJZCA9IHNldEludGVydmFsKGpRdWVyeS5meC50aWNrLCBqUXVlcnkuZnguaW50ZXJ2YWwpO1xuICAgIH1cbiAgfTtcbiAgalF1ZXJ5LmZ4LnN0b3AgPSBmdW5jdGlvbigpIHtcbiAgICBjbGVhckludGVydmFsKHRpbWVySWQpO1xuICAgIHRpbWVySWQgPSBudWxsO1xuICB9O1xuICBqUXVlcnkuZnguc3BlZWRzID0ge1xuICAgIHNsb3c6IDYwMCxcbiAgICBmYXN0OiAyMDAsXG4gICAgX2RlZmF1bHQ6IDQwMFxuICB9O1xuICBqUXVlcnkuZm4uZGVsYXkgPSBmdW5jdGlvbih0aW1lLCB0eXBlKSB7XG4gICAgdGltZSA9IGpRdWVyeS5meCA/IGpRdWVyeS5meC5zcGVlZHNbdGltZV0gfHwgdGltZSA6IHRpbWU7XG4gICAgdHlwZSA9IHR5cGUgfHwgXCJmeFwiO1xuICAgIHJldHVybiB0aGlzLnF1ZXVlKHR5cGUsIGZ1bmN0aW9uKG5leHQsIGhvb2tzKSB7XG4gICAgICB2YXIgdGltZW91dCA9IHNldFRpbWVvdXQobmV4dCwgdGltZSk7XG4gICAgICBob29rcy5zdG9wID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG4gIChmdW5jdGlvbigpIHtcbiAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksXG4gICAgICAgIHNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIiksXG4gICAgICAgIG9wdCA9IHNlbGVjdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpKTtcbiAgICBpbnB1dC50eXBlID0gXCJjaGVja2JveFwiO1xuICAgIHN1cHBvcnQuY2hlY2tPbiA9IGlucHV0LnZhbHVlICE9PSBcIlwiO1xuICAgIHN1cHBvcnQub3B0U2VsZWN0ZWQgPSBvcHQuc2VsZWN0ZWQ7XG4gICAgc2VsZWN0LmRpc2FibGVkID0gdHJ1ZTtcbiAgICBzdXBwb3J0Lm9wdERpc2FibGVkID0gIW9wdC5kaXNhYmxlZDtcbiAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICBpbnB1dC52YWx1ZSA9IFwidFwiO1xuICAgIGlucHV0LnR5cGUgPSBcInJhZGlvXCI7XG4gICAgc3VwcG9ydC5yYWRpb1ZhbHVlID0gaW5wdXQudmFsdWUgPT09IFwidFwiO1xuICB9KSgpO1xuICB2YXIgbm9kZUhvb2ssXG4gICAgICBib29sSG9vayxcbiAgICAgIGF0dHJIYW5kbGUgPSBqUXVlcnkuZXhwci5hdHRySGFuZGxlO1xuICBqUXVlcnkuZm4uZXh0ZW5kKHtcbiAgICBhdHRyOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgICAgcmV0dXJuIGFjY2Vzcyh0aGlzLCBqUXVlcnkuYXR0ciwgbmFtZSwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxKTtcbiAgICB9LFxuICAgIHJlbW92ZUF0dHI6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIGpRdWVyeS5yZW1vdmVBdHRyKHRoaXMsIG5hbWUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbiAgalF1ZXJ5LmV4dGVuZCh7XG4gICAgYXR0cjogZnVuY3Rpb24oZWxlbSwgbmFtZSwgdmFsdWUpIHtcbiAgICAgIHZhciBob29rcyxcbiAgICAgICAgICByZXQsXG4gICAgICAgICAgblR5cGUgPSBlbGVtLm5vZGVUeXBlO1xuICAgICAgaWYgKCFlbGVtIHx8IG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGUgPT09IHN0cnVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4galF1ZXJ5LnByb3AoZWxlbSwgbmFtZSwgdmFsdWUpO1xuICAgICAgfVxuICAgICAgaWYgKG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoZWxlbSkpIHtcbiAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaG9va3MgPSBqUXVlcnkuYXR0ckhvb2tzW25hbWVdIHx8IChqUXVlcnkuZXhwci5tYXRjaC5ib29sLnRlc3QobmFtZSkgPyBib29sSG9vayA6IG5vZGVIb29rKTtcbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIGpRdWVyeS5yZW1vdmVBdHRyKGVsZW0sIG5hbWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGhvb2tzICYmIFwic2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLnNldChlbGVtLCB2YWx1ZSwgbmFtZSkpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsZW0uc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlICsgXCJcIik7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldChlbGVtLCBuYW1lKSkgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldCA9IGpRdWVyeS5maW5kLmF0dHIoZWxlbSwgbmFtZSk7XG4gICAgICAgIHJldHVybiByZXQgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IHJldDtcbiAgICAgIH1cbiAgICB9LFxuICAgIHJlbW92ZUF0dHI6IGZ1bmN0aW9uKGVsZW0sIHZhbHVlKSB7XG4gICAgICB2YXIgbmFtZSxcbiAgICAgICAgICBwcm9wTmFtZSxcbiAgICAgICAgICBpID0gMCxcbiAgICAgICAgICBhdHRyTmFtZXMgPSB2YWx1ZSAmJiB2YWx1ZS5tYXRjaChybm90d2hpdGUpO1xuICAgICAgaWYgKGF0dHJOYW1lcyAmJiBlbGVtLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgIHdoaWxlICgobmFtZSA9IGF0dHJOYW1lc1tpKytdKSkge1xuICAgICAgICAgIHByb3BOYW1lID0galF1ZXJ5LnByb3BGaXhbbmFtZV0gfHwgbmFtZTtcbiAgICAgICAgICBpZiAoalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICBlbGVtW3Byb3BOYW1lXSA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgYXR0ckhvb2tzOiB7dHlwZToge3NldDogZnVuY3Rpb24oZWxlbSwgdmFsdWUpIHtcbiAgICAgICAgICBpZiAoIXN1cHBvcnQucmFkaW9WYWx1ZSAmJiB2YWx1ZSA9PT0gXCJyYWRpb1wiICYmIGpRdWVyeS5ub2RlTmFtZShlbGVtLCBcImlucHV0XCIpKSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gZWxlbS52YWx1ZTtcbiAgICAgICAgICAgIGVsZW0uc2V0QXR0cmlidXRlKFwidHlwZVwiLCB2YWx1ZSk7XG4gICAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICAgIGVsZW0udmFsdWUgPSB2YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9fX1cbiAgfSk7XG4gIGJvb2xIb29rID0ge3NldDogZnVuY3Rpb24oZWxlbSwgdmFsdWUsIG5hbWUpIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgalF1ZXJ5LnJlbW92ZUF0dHIoZWxlbSwgbmFtZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZShuYW1lLCBuYW1lKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuYW1lO1xuICAgIH19O1xuICBqUXVlcnkuZWFjaChqUXVlcnkuZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCgvXFx3Ky9nKSwgZnVuY3Rpb24oaSwgbmFtZSkge1xuICAgIHZhciBnZXR0ZXIgPSBhdHRySGFuZGxlW25hbWVdIHx8IGpRdWVyeS5maW5kLmF0dHI7XG4gICAgYXR0ckhhbmRsZVtuYW1lXSA9IGZ1bmN0aW9uKGVsZW0sIG5hbWUsIGlzWE1MKSB7XG4gICAgICB2YXIgcmV0LFxuICAgICAgICAgIGhhbmRsZTtcbiAgICAgIGlmICghaXNYTUwpIHtcbiAgICAgICAgaGFuZGxlID0gYXR0ckhhbmRsZVtuYW1lXTtcbiAgICAgICAgYXR0ckhhbmRsZVtuYW1lXSA9IHJldDtcbiAgICAgICAgcmV0ID0gZ2V0dGVyKGVsZW0sIG5hbWUsIGlzWE1MKSAhPSBudWxsID8gbmFtZS50b0xvd2VyQ2FzZSgpIDogbnVsbDtcbiAgICAgICAgYXR0ckhhbmRsZVtuYW1lXSA9IGhhbmRsZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcbiAgfSk7XG4gIHZhciByZm9jdXNhYmxlID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaTtcbiAgalF1ZXJ5LmZuLmV4dGVuZCh7XG4gICAgcHJvcDogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICAgIHJldHVybiBhY2Nlc3ModGhpcywgalF1ZXJ5LnByb3AsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSk7XG4gICAgfSxcbiAgICByZW1vdmVQcm9wOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBkZWxldGUgdGhpc1tqUXVlcnkucHJvcEZpeFtuYW1lXSB8fCBuYW1lXTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIGpRdWVyeS5leHRlbmQoe1xuICAgIHByb3BGaXg6IHtcbiAgICAgIFwiZm9yXCI6IFwiaHRtbEZvclwiLFxuICAgICAgXCJjbGFzc1wiOiBcImNsYXNzTmFtZVwiXG4gICAgfSxcbiAgICBwcm9wOiBmdW5jdGlvbihlbGVtLCBuYW1lLCB2YWx1ZSkge1xuICAgICAgdmFyIHJldCxcbiAgICAgICAgICBob29rcyxcbiAgICAgICAgICBub3R4bWwsXG4gICAgICAgICAgblR5cGUgPSBlbGVtLm5vZGVUeXBlO1xuICAgICAgaWYgKCFlbGVtIHx8IG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG5vdHhtbCA9IG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoZWxlbSk7XG4gICAgICBpZiAobm90eG1sKSB7XG4gICAgICAgIG5hbWUgPSBqUXVlcnkucHJvcEZpeFtuYW1lXSB8fCBuYW1lO1xuICAgICAgICBob29rcyA9IGpRdWVyeS5wcm9wSG9va3NbbmFtZV07XG4gICAgICB9XG4gICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gaG9va3MgJiYgXCJzZXRcIiBpbiBob29rcyAmJiAocmV0ID0gaG9va3Muc2V0KGVsZW0sIHZhbHVlLCBuYW1lKSkgIT09IHVuZGVmaW5lZCA/IHJldCA6IChlbGVtW25hbWVdID0gdmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldChlbGVtLCBuYW1lKSkgIT09IG51bGwgPyByZXQgOiBlbGVtW25hbWVdO1xuICAgICAgfVxuICAgIH0sXG4gICAgcHJvcEhvb2tzOiB7dGFiSW5kZXg6IHtnZXQ6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgICByZXR1cm4gZWxlbS5oYXNBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKSB8fCByZm9jdXNhYmxlLnRlc3QoZWxlbS5ub2RlTmFtZSkgfHwgZWxlbS5ocmVmID8gZWxlbS50YWJJbmRleCA6IC0xO1xuICAgICAgICB9fX1cbiAgfSk7XG4gIGlmICghc3VwcG9ydC5vcHRTZWxlY3RlZCkge1xuICAgIGpRdWVyeS5wcm9wSG9va3Muc2VsZWN0ZWQgPSB7Z2V0OiBmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7XG4gICAgICAgIGlmIChwYXJlbnQgJiYgcGFyZW50LnBhcmVudE5vZGUpIHtcbiAgICAgICAgICBwYXJlbnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfX07XG4gIH1cbiAgalF1ZXJ5LmVhY2goW1widGFiSW5kZXhcIiwgXCJyZWFkT25seVwiLCBcIm1heExlbmd0aFwiLCBcImNlbGxTcGFjaW5nXCIsIFwiY2VsbFBhZGRpbmdcIiwgXCJyb3dTcGFuXCIsIFwiY29sU3BhblwiLCBcInVzZU1hcFwiLCBcImZyYW1lQm9yZGVyXCIsIFwiY29udGVudEVkaXRhYmxlXCJdLCBmdW5jdGlvbigpIHtcbiAgICBqUXVlcnkucHJvcEZpeFt0aGlzLnRvTG93ZXJDYXNlKCldID0gdGhpcztcbiAgfSk7XG4gIHZhciByY2xhc3MgPSAvW1xcdFxcclxcblxcZl0vZztcbiAgalF1ZXJ5LmZuLmV4dGVuZCh7XG4gICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgY2xhc3NlcyxcbiAgICAgICAgICBlbGVtLFxuICAgICAgICAgIGN1cixcbiAgICAgICAgICBjbGF6eixcbiAgICAgICAgICBqLFxuICAgICAgICAgIGZpbmFsVmFsdWUsXG4gICAgICAgICAgcHJvY2VlZCA9IHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZSxcbiAgICAgICAgICBpID0gMCxcbiAgICAgICAgICBsZW4gPSB0aGlzLmxlbmd0aDtcbiAgICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihqKSB7XG4gICAgICAgICAgalF1ZXJ5KHRoaXMpLmFkZENsYXNzKHZhbHVlLmNhbGwodGhpcywgaiwgdGhpcy5jbGFzc05hbWUpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAocHJvY2VlZCkge1xuICAgICAgICBjbGFzc2VzID0gKHZhbHVlIHx8IFwiXCIpLm1hdGNoKHJub3R3aGl0ZSkgfHwgW107XG4gICAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBlbGVtID0gdGhpc1tpXTtcbiAgICAgICAgICBjdXIgPSBlbGVtLm5vZGVUeXBlID09PSAxICYmIChlbGVtLmNsYXNzTmFtZSA/IChcIiBcIiArIGVsZW0uY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UocmNsYXNzLCBcIiBcIikgOiBcIiBcIik7XG4gICAgICAgICAgaWYgKGN1cikge1xuICAgICAgICAgICAgaiA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoKGNsYXp6ID0gY2xhc3Nlc1tqKytdKSkge1xuICAgICAgICAgICAgICBpZiAoY3VyLmluZGV4T2YoXCIgXCIgKyBjbGF6eiArIFwiIFwiKSA8IDApIHtcbiAgICAgICAgICAgICAgICBjdXIgKz0gY2xhenogKyBcIiBcIjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGpRdWVyeS50cmltKGN1cik7XG4gICAgICAgICAgICBpZiAoZWxlbS5jbGFzc05hbWUgIT09IGZpbmFsVmFsdWUpIHtcbiAgICAgICAgICAgICAgZWxlbS5jbGFzc05hbWUgPSBmaW5hbFZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICByZW1vdmVDbGFzczogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBjbGFzc2VzLFxuICAgICAgICAgIGVsZW0sXG4gICAgICAgICAgY3VyLFxuICAgICAgICAgIGNsYXp6LFxuICAgICAgICAgIGosXG4gICAgICAgICAgZmluYWxWYWx1ZSxcbiAgICAgICAgICBwcm9jZWVkID0gYXJndW1lbnRzLmxlbmd0aCA9PT0gMCB8fCB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUsXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgbGVuID0gdGhpcy5sZW5ndGg7XG4gICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaikge1xuICAgICAgICAgIGpRdWVyeSh0aGlzKS5yZW1vdmVDbGFzcyh2YWx1ZS5jYWxsKHRoaXMsIGosIHRoaXMuY2xhc3NOYW1lKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHByb2NlZWQpIHtcbiAgICAgICAgY2xhc3NlcyA9ICh2YWx1ZSB8fCBcIlwiKS5tYXRjaChybm90d2hpdGUpIHx8IFtdO1xuICAgICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgZWxlbSA9IHRoaXNbaV07XG4gICAgICAgICAgY3VyID0gZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAoZWxlbS5jbGFzc05hbWUgPyAoXCIgXCIgKyBlbGVtLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKHJjbGFzcywgXCIgXCIpIDogXCJcIik7XG4gICAgICAgICAgaWYgKGN1cikge1xuICAgICAgICAgICAgaiA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoKGNsYXp6ID0gY2xhc3Nlc1tqKytdKSkge1xuICAgICAgICAgICAgICB3aGlsZSAoY3VyLmluZGV4T2YoXCIgXCIgKyBjbGF6eiArIFwiIFwiKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgY3VyID0gY3VyLnJlcGxhY2UoXCIgXCIgKyBjbGF6eiArIFwiIFwiLCBcIiBcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsVmFsdWUgPSB2YWx1ZSA/IGpRdWVyeS50cmltKGN1cikgOiBcIlwiO1xuICAgICAgICAgICAgaWYgKGVsZW0uY2xhc3NOYW1lICE9PSBmaW5hbFZhbHVlKSB7XG4gICAgICAgICAgICAgIGVsZW0uY2xhc3NOYW1lID0gZmluYWxWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uKHZhbHVlLCBzdGF0ZVZhbCkge1xuICAgICAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gICAgICBpZiAodHlwZW9mIHN0YXRlVmFsID09PSBcImJvb2xlYW5cIiAmJiB0eXBlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiBzdGF0ZVZhbCA/IHRoaXMuYWRkQ2xhc3ModmFsdWUpIDogdGhpcy5yZW1vdmVDbGFzcyh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSkge1xuICAgICAgICAgIGpRdWVyeSh0aGlzKS50b2dnbGVDbGFzcyh2YWx1ZS5jYWxsKHRoaXMsIGksIHRoaXMuY2xhc3NOYW1lLCBzdGF0ZVZhbCksIHN0YXRlVmFsKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodHlwZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIHZhciBjbGFzc05hbWUsXG4gICAgICAgICAgICAgIGkgPSAwLFxuICAgICAgICAgICAgICBzZWxmID0galF1ZXJ5KHRoaXMpLFxuICAgICAgICAgICAgICBjbGFzc05hbWVzID0gdmFsdWUubWF0Y2gocm5vdHdoaXRlKSB8fCBbXTtcbiAgICAgICAgICB3aGlsZSAoKGNsYXNzTmFtZSA9IGNsYXNzTmFtZXNbaSsrXSkpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmhhc0NsYXNzKGNsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgICAgc2VsZi5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc2VsZi5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBzdHJ1bmRlZmluZWQgfHwgdHlwZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgICBpZiAodGhpcy5jbGFzc05hbWUpIHtcbiAgICAgICAgICAgIGRhdGFfcHJpdi5zZXQodGhpcywgXCJfX2NsYXNzTmFtZV9fXCIsIHRoaXMuY2xhc3NOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSB0aGlzLmNsYXNzTmFtZSB8fCB2YWx1ZSA9PT0gZmFsc2UgPyBcIlwiIDogZGF0YV9wcml2LmdldCh0aGlzLCBcIl9fY2xhc3NOYW1lX19cIikgfHwgXCJcIjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBoYXNDbGFzczogZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICAgIHZhciBjbGFzc05hbWUgPSBcIiBcIiArIHNlbGVjdG9yICsgXCIgXCIsXG4gICAgICAgICAgaSA9IDAsXG4gICAgICAgICAgbCA9IHRoaXMubGVuZ3RoO1xuICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXNbaV0ubm9kZVR5cGUgPT09IDEgJiYgKFwiIFwiICsgdGhpc1tpXS5jbGFzc05hbWUgKyBcIiBcIikucmVwbGFjZShyY2xhc3MsIFwiIFwiKS5pbmRleE9mKGNsYXNzTmFtZSkgPj0gMCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9KTtcbiAgdmFyIHJyZXR1cm4gPSAvXFxyL2c7XG4gIGpRdWVyeS5mbi5leHRlbmQoe3ZhbDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBob29rcyxcbiAgICAgICAgICByZXQsXG4gICAgICAgICAgaXNGdW5jdGlvbixcbiAgICAgICAgICBlbGVtID0gdGhpc1swXTtcbiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICBpZiAoZWxlbSkge1xuICAgICAgICAgIGhvb2tzID0galF1ZXJ5LnZhbEhvb2tzW2VsZW0udHlwZV0gfHwgalF1ZXJ5LnZhbEhvb2tzW2VsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKV07XG4gICAgICAgICAgaWYgKGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldChlbGVtLCBcInZhbHVlXCIpKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXQgPSBlbGVtLnZhbHVlO1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgcmV0ID09PSBcInN0cmluZ1wiID8gcmV0LnJlcGxhY2UocnJldHVybiwgXCJcIikgOiByZXQgPT0gbnVsbCA/IFwiXCIgOiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKTtcbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSkge1xuICAgICAgICB2YXIgdmFsO1xuICAgICAgICBpZiAodGhpcy5ub2RlVHlwZSAhPT0gMSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNGdW5jdGlvbikge1xuICAgICAgICAgIHZhbCA9IHZhbHVlLmNhbGwodGhpcywgaSwgalF1ZXJ5KHRoaXMpLnZhbCgpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YWwgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsID09IG51bGwpIHtcbiAgICAgICAgICB2YWwgPSBcIlwiO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICB2YWwgKz0gXCJcIjtcbiAgICAgICAgfSBlbHNlIGlmIChqUXVlcnkuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgICAgdmFsID0galF1ZXJ5Lm1hcCh2YWwsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWUgPT0gbnVsbCA/IFwiXCIgOiB2YWx1ZSArIFwiXCI7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaG9va3MgPSBqUXVlcnkudmFsSG9va3NbdGhpcy50eXBlXSB8fCBqUXVlcnkudmFsSG9va3NbdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXTtcbiAgICAgICAgaWYgKCFob29rcyB8fCAhKFwic2V0XCIgaW4gaG9va3MpIHx8IGhvb2tzLnNldCh0aGlzLCB2YWwsIFwidmFsdWVcIikgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH19KTtcbiAgalF1ZXJ5LmV4dGVuZCh7dmFsSG9va3M6IHtcbiAgICAgIG9wdGlvbjoge2dldDogZnVuY3Rpb24oZWxlbSkge1xuICAgICAgICAgIHZhciB2YWwgPSBqUXVlcnkuZmluZC5hdHRyKGVsZW0sIFwidmFsdWVcIik7XG4gICAgICAgICAgcmV0dXJuIHZhbCAhPSBudWxsID8gdmFsIDogalF1ZXJ5LnRyaW0oalF1ZXJ5LnRleHQoZWxlbSkpO1xuICAgICAgICB9fSxcbiAgICAgIHNlbGVjdDoge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgICB2YXIgdmFsdWUsXG4gICAgICAgICAgICAgIG9wdGlvbixcbiAgICAgICAgICAgICAgb3B0aW9ucyA9IGVsZW0ub3B0aW9ucyxcbiAgICAgICAgICAgICAgaW5kZXggPSBlbGVtLnNlbGVjdGVkSW5kZXgsXG4gICAgICAgICAgICAgIG9uZSA9IGVsZW0udHlwZSA9PT0gXCJzZWxlY3Qtb25lXCIgfHwgaW5kZXggPCAwLFxuICAgICAgICAgICAgICB2YWx1ZXMgPSBvbmUgPyBudWxsIDogW10sXG4gICAgICAgICAgICAgIG1heCA9IG9uZSA/IGluZGV4ICsgMSA6IG9wdGlvbnMubGVuZ3RoLFxuICAgICAgICAgICAgICBpID0gaW5kZXggPCAwID8gbWF4IDogb25lID8gaW5kZXggOiAwO1xuICAgICAgICAgIGZvciAoOyBpIDwgbWF4OyBpKyspIHtcbiAgICAgICAgICAgIG9wdGlvbiA9IG9wdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoKG9wdGlvbi5zZWxlY3RlZCB8fCBpID09PSBpbmRleCkgJiYgKHN1cHBvcnQub3B0RGlzYWJsZWQgPyAhb3B0aW9uLmRpc2FibGVkIDogb3B0aW9uLmdldEF0dHJpYnV0ZShcImRpc2FibGVkXCIpID09PSBudWxsKSAmJiAoIW9wdGlvbi5wYXJlbnROb2RlLmRpc2FibGVkIHx8ICFqUXVlcnkubm9kZU5hbWUob3B0aW9uLnBhcmVudE5vZGUsIFwib3B0Z3JvdXBcIikpKSB7XG4gICAgICAgICAgICAgIHZhbHVlID0galF1ZXJ5KG9wdGlvbikudmFsKCk7XG4gICAgICAgICAgICAgIGlmIChvbmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKGVsZW0sIHZhbHVlKSB7XG4gICAgICAgICAgdmFyIG9wdGlvblNldCxcbiAgICAgICAgICAgICAgb3B0aW9uLFxuICAgICAgICAgICAgICBvcHRpb25zID0gZWxlbS5vcHRpb25zLFxuICAgICAgICAgICAgICB2YWx1ZXMgPSBqUXVlcnkubWFrZUFycmF5KHZhbHVlKSxcbiAgICAgICAgICAgICAgaSA9IG9wdGlvbnMubGVuZ3RoO1xuICAgICAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgICAgIG9wdGlvbiA9IG9wdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoKG9wdGlvbi5zZWxlY3RlZCA9IGpRdWVyeS5pbkFycmF5KG9wdGlvbi52YWx1ZSwgdmFsdWVzKSA+PSAwKSkge1xuICAgICAgICAgICAgICBvcHRpb25TZXQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIW9wdGlvblNldCkge1xuICAgICAgICAgICAgZWxlbS5zZWxlY3RlZEluZGV4ID0gLTE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9fSk7XG4gIGpRdWVyeS5lYWNoKFtcInJhZGlvXCIsIFwiY2hlY2tib3hcIl0sIGZ1bmN0aW9uKCkge1xuICAgIGpRdWVyeS52YWxIb29rc1t0aGlzXSA9IHtzZXQ6IGZ1bmN0aW9uKGVsZW0sIHZhbHVlKSB7XG4gICAgICAgIGlmIChqUXVlcnkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICByZXR1cm4gKGVsZW0uY2hlY2tlZCA9IGpRdWVyeS5pbkFycmF5KGpRdWVyeShlbGVtKS52YWwoKSwgdmFsdWUpID49IDApO1xuICAgICAgICB9XG4gICAgICB9fTtcbiAgICBpZiAoIXN1cHBvcnQuY2hlY2tPbikge1xuICAgICAgalF1ZXJ5LnZhbEhvb2tzW3RoaXNdLmdldCA9IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKFwidmFsdWVcIikgPT09IG51bGwgPyBcIm9uXCIgOiBlbGVtLnZhbHVlO1xuICAgICAgfTtcbiAgICB9XG4gIH0pO1xuICBqUXVlcnkuZWFjaCgoXCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayBcIiArIFwibW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgXCIgKyBcImNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnVcIikuc3BsaXQoXCIgXCIpLCBmdW5jdGlvbihpLCBuYW1lKSB7XG4gICAgalF1ZXJ5LmZuW25hbWVdID0gZnVuY3Rpb24oZGF0YSwgZm4pIHtcbiAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID4gMCA/IHRoaXMub24obmFtZSwgbnVsbCwgZGF0YSwgZm4pIDogdGhpcy50cmlnZ2VyKG5hbWUpO1xuICAgIH07XG4gIH0pO1xuICBqUXVlcnkuZm4uZXh0ZW5kKHtcbiAgICBob3ZlcjogZnVuY3Rpb24oZm5PdmVyLCBmbk91dCkge1xuICAgICAgcmV0dXJuIHRoaXMubW91c2VlbnRlcihmbk92ZXIpLm1vdXNlbGVhdmUoZm5PdXQgfHwgZm5PdmVyKTtcbiAgICB9LFxuICAgIGJpbmQ6IGZ1bmN0aW9uKHR5cGVzLCBkYXRhLCBmbikge1xuICAgICAgcmV0dXJuIHRoaXMub24odHlwZXMsIG51bGwsIGRhdGEsIGZuKTtcbiAgICB9LFxuICAgIHVuYmluZDogZnVuY3Rpb24odHlwZXMsIGZuKSB7XG4gICAgICByZXR1cm4gdGhpcy5vZmYodHlwZXMsIG51bGwsIGZuKTtcbiAgICB9LFxuICAgIGRlbGVnYXRlOiBmdW5jdGlvbihzZWxlY3RvciwgdHlwZXMsIGRhdGEsIGZuKSB7XG4gICAgICByZXR1cm4gdGhpcy5vbih0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuKTtcbiAgICB9LFxuICAgIHVuZGVsZWdhdGU6IGZ1bmN0aW9uKHNlbGVjdG9yLCB0eXBlcywgZm4pIHtcbiAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gdGhpcy5vZmYoc2VsZWN0b3IsIFwiKipcIikgOiB0aGlzLm9mZih0eXBlcywgc2VsZWN0b3IgfHwgXCIqKlwiLCBmbik7XG4gICAgfVxuICB9KTtcbiAgdmFyIG5vbmNlID0galF1ZXJ5Lm5vdygpO1xuICB2YXIgcnF1ZXJ5ID0gKC9cXD8vKTtcbiAgalF1ZXJ5LnBhcnNlSlNPTiA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhICsgXCJcIik7XG4gIH07XG4gIGpRdWVyeS5wYXJzZVhNTCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB2YXIgeG1sLFxuICAgICAgICB0bXA7XG4gICAgaWYgKCFkYXRhIHx8IHR5cGVvZiBkYXRhICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIHRtcCA9IG5ldyBET01QYXJzZXIoKTtcbiAgICAgIHhtbCA9IHRtcC5wYXJzZUZyb21TdHJpbmcoZGF0YSwgXCJ0ZXh0L3htbFwiKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB4bWwgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlmICgheG1sIHx8IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInBhcnNlcmVycm9yXCIpLmxlbmd0aCkge1xuICAgICAgalF1ZXJ5LmVycm9yKFwiSW52YWxpZCBYTUw6IFwiICsgZGF0YSk7XG4gICAgfVxuICAgIHJldHVybiB4bWw7XG4gIH07XG4gIHZhciByaGFzaCA9IC8jLiokLyxcbiAgICAgIHJ0cyA9IC8oWz8mXSlfPVteJl0qLyxcbiAgICAgIHJoZWFkZXJzID0gL14oLio/KTpbIFxcdF0qKFteXFxyXFxuXSopJC9tZyxcbiAgICAgIHJsb2NhbFByb3RvY29sID0gL14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sXG4gICAgICBybm9Db250ZW50ID0gL14oPzpHRVR8SEVBRCkkLyxcbiAgICAgIHJwcm90b2NvbCA9IC9eXFwvXFwvLyxcbiAgICAgIHJ1cmwgPSAvXihbXFx3ListXSs6KSg/OlxcL1xcLyg/OlteXFwvPyNdKkB8KShbXlxcLz8jOl0qKSg/OjooXFxkKyl8KXwpLyxcbiAgICAgIHByZWZpbHRlcnMgPSB7fSxcbiAgICAgIHRyYW5zcG9ydHMgPSB7fSxcbiAgICAgIGFsbFR5cGVzID0gXCIqL1wiLmNvbmNhdChcIipcIiksXG4gICAgICBhamF4TG9jYXRpb24gPSB3aW5kb3cubG9jYXRpb24uaHJlZixcbiAgICAgIGFqYXhMb2NQYXJ0cyA9IHJ1cmwuZXhlYyhhamF4TG9jYXRpb24udG9Mb3dlckNhc2UoKSkgfHwgW107XG4gIGZ1bmN0aW9uIGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyhzdHJ1Y3R1cmUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oZGF0YVR5cGVFeHByZXNzaW9uLCBmdW5jKSB7XG4gICAgICBpZiAodHlwZW9mIGRhdGFUeXBlRXhwcmVzc2lvbiAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBmdW5jID0gZGF0YVR5cGVFeHByZXNzaW9uO1xuICAgICAgICBkYXRhVHlwZUV4cHJlc3Npb24gPSBcIipcIjtcbiAgICAgIH1cbiAgICAgIHZhciBkYXRhVHlwZSxcbiAgICAgICAgICBpID0gMCxcbiAgICAgICAgICBkYXRhVHlwZXMgPSBkYXRhVHlwZUV4cHJlc3Npb24udG9Mb3dlckNhc2UoKS5tYXRjaChybm90d2hpdGUpIHx8IFtdO1xuICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKGZ1bmMpKSB7XG4gICAgICAgIHdoaWxlICgoZGF0YVR5cGUgPSBkYXRhVHlwZXNbaSsrXSkpIHtcbiAgICAgICAgICBpZiAoZGF0YVR5cGVbMF0gPT09IFwiK1wiKSB7XG4gICAgICAgICAgICBkYXRhVHlwZSA9IGRhdGFUeXBlLnNsaWNlKDEpIHx8IFwiKlwiO1xuICAgICAgICAgICAgKHN0cnVjdHVyZVtkYXRhVHlwZV0gPSBzdHJ1Y3R1cmVbZGF0YVR5cGVdIHx8IFtdKS51bnNoaWZ0KGZ1bmMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAoc3RydWN0dXJlW2RhdGFUeXBlXSA9IHN0cnVjdHVyZVtkYXRhVHlwZV0gfHwgW10pLnB1c2goZnVuYyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyhzdHJ1Y3R1cmUsIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIpIHtcbiAgICB2YXIgaW5zcGVjdGVkID0ge30sXG4gICAgICAgIHNlZWtpbmdUcmFuc3BvcnQgPSAoc3RydWN0dXJlID09PSB0cmFuc3BvcnRzKTtcbiAgICBmdW5jdGlvbiBpbnNwZWN0KGRhdGFUeXBlKSB7XG4gICAgICB2YXIgc2VsZWN0ZWQ7XG4gICAgICBpbnNwZWN0ZWRbZGF0YVR5cGVdID0gdHJ1ZTtcbiAgICAgIGpRdWVyeS5lYWNoKHN0cnVjdHVyZVtkYXRhVHlwZV0gfHwgW10sIGZ1bmN0aW9uKF8sIHByZWZpbHRlck9yRmFjdG9yeSkge1xuICAgICAgICB2YXIgZGF0YVR5cGVPclRyYW5zcG9ydCA9IHByZWZpbHRlck9yRmFjdG9yeShvcHRpb25zLCBvcmlnaW5hbE9wdGlvbnMsIGpxWEhSKTtcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhVHlwZU9yVHJhbnNwb3J0ID09PSBcInN0cmluZ1wiICYmICFzZWVraW5nVHJhbnNwb3J0ICYmICFpbnNwZWN0ZWRbZGF0YVR5cGVPclRyYW5zcG9ydF0pIHtcbiAgICAgICAgICBvcHRpb25zLmRhdGFUeXBlcy51bnNoaWZ0KGRhdGFUeXBlT3JUcmFuc3BvcnQpO1xuICAgICAgICAgIGluc3BlY3QoZGF0YVR5cGVPclRyYW5zcG9ydCk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKHNlZWtpbmdUcmFuc3BvcnQpIHtcbiAgICAgICAgICByZXR1cm4gIShzZWxlY3RlZCA9IGRhdGFUeXBlT3JUcmFuc3BvcnQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzZWxlY3RlZDtcbiAgICB9XG4gICAgcmV0dXJuIGluc3BlY3Qob3B0aW9ucy5kYXRhVHlwZXNbMF0pIHx8ICFpbnNwZWN0ZWRbXCIqXCJdICYmIGluc3BlY3QoXCIqXCIpO1xuICB9XG4gIGZ1bmN0aW9uIGFqYXhFeHRlbmQodGFyZ2V0LCBzcmMpIHtcbiAgICB2YXIga2V5LFxuICAgICAgICBkZWVwLFxuICAgICAgICBmbGF0T3B0aW9ucyA9IGpRdWVyeS5hamF4U2V0dGluZ3MuZmxhdE9wdGlvbnMgfHwge307XG4gICAgZm9yIChrZXkgaW4gc3JjKSB7XG4gICAgICBpZiAoc3JjW2tleV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAoZmxhdE9wdGlvbnNba2V5XSA/IHRhcmdldCA6IChkZWVwIHx8IChkZWVwID0ge30pKSlba2V5XSA9IHNyY1trZXldO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZGVlcCkge1xuICAgICAgalF1ZXJ5LmV4dGVuZCh0cnVlLCB0YXJnZXQsIGRlZXApO1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9XG4gIGZ1bmN0aW9uIGFqYXhIYW5kbGVSZXNwb25zZXMocywganFYSFIsIHJlc3BvbnNlcykge1xuICAgIHZhciBjdCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgZmluYWxEYXRhVHlwZSxcbiAgICAgICAgZmlyc3REYXRhVHlwZSxcbiAgICAgICAgY29udGVudHMgPSBzLmNvbnRlbnRzLFxuICAgICAgICBkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcztcbiAgICB3aGlsZSAoZGF0YVR5cGVzWzBdID09PSBcIipcIikge1xuICAgICAgZGF0YVR5cGVzLnNoaWZ0KCk7XG4gICAgICBpZiAoY3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjdCA9IHMubWltZVR5cGUgfHwganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIik7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjdCkge1xuICAgICAgZm9yICh0eXBlIGluIGNvbnRlbnRzKSB7XG4gICAgICAgIGlmIChjb250ZW50c1t0eXBlXSAmJiBjb250ZW50c1t0eXBlXS50ZXN0KGN0KSkge1xuICAgICAgICAgIGRhdGFUeXBlcy51bnNoaWZ0KHR5cGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChkYXRhVHlwZXNbMF0gaW4gcmVzcG9uc2VzKSB7XG4gICAgICBmaW5hbERhdGFUeXBlID0gZGF0YVR5cGVzWzBdO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKHR5cGUgaW4gcmVzcG9uc2VzKSB7XG4gICAgICAgIGlmICghZGF0YVR5cGVzWzBdIHx8IHMuY29udmVydGVyc1t0eXBlICsgXCIgXCIgKyBkYXRhVHlwZXNbMF1dKSB7XG4gICAgICAgICAgZmluYWxEYXRhVHlwZSA9IHR5cGU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFmaXJzdERhdGFUeXBlKSB7XG4gICAgICAgICAgZmlyc3REYXRhVHlwZSA9IHR5cGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZpbmFsRGF0YVR5cGUgPSBmaW5hbERhdGFUeXBlIHx8IGZpcnN0RGF0YVR5cGU7XG4gICAgfVxuICAgIGlmIChmaW5hbERhdGFUeXBlKSB7XG4gICAgICBpZiAoZmluYWxEYXRhVHlwZSAhPT0gZGF0YVR5cGVzWzBdKSB7XG4gICAgICAgIGRhdGFUeXBlcy51bnNoaWZ0KGZpbmFsRGF0YVR5cGUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3BvbnNlc1tmaW5hbERhdGFUeXBlXTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gYWpheENvbnZlcnQocywgcmVzcG9uc2UsIGpxWEhSLCBpc1N1Y2Nlc3MpIHtcbiAgICB2YXIgY29udjIsXG4gICAgICAgIGN1cnJlbnQsXG4gICAgICAgIGNvbnYsXG4gICAgICAgIHRtcCxcbiAgICAgICAgcHJldixcbiAgICAgICAgY29udmVydGVycyA9IHt9LFxuICAgICAgICBkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcy5zbGljZSgpO1xuICAgIGlmIChkYXRhVHlwZXNbMV0pIHtcbiAgICAgIGZvciAoY29udiBpbiBzLmNvbnZlcnRlcnMpIHtcbiAgICAgICAgY29udmVydGVyc1tjb252LnRvTG93ZXJDYXNlKCldID0gcy5jb252ZXJ0ZXJzW2NvbnZdO1xuICAgICAgfVxuICAgIH1cbiAgICBjdXJyZW50ID0gZGF0YVR5cGVzLnNoaWZ0KCk7XG4gICAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICAgIGlmIChzLnJlc3BvbnNlRmllbGRzW2N1cnJlbnRdKSB7XG4gICAgICAgIGpxWEhSW3MucmVzcG9uc2VGaWVsZHNbY3VycmVudF1dID0gcmVzcG9uc2U7XG4gICAgICB9XG4gICAgICBpZiAoIXByZXYgJiYgaXNTdWNjZXNzICYmIHMuZGF0YUZpbHRlcikge1xuICAgICAgICByZXNwb25zZSA9IHMuZGF0YUZpbHRlcihyZXNwb25zZSwgcy5kYXRhVHlwZSk7XG4gICAgICB9XG4gICAgICBwcmV2ID0gY3VycmVudDtcbiAgICAgIGN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTtcbiAgICAgIGlmIChjdXJyZW50KSB7XG4gICAgICAgIGlmIChjdXJyZW50ID09PSBcIipcIikge1xuICAgICAgICAgIGN1cnJlbnQgPSBwcmV2O1xuICAgICAgICB9IGVsc2UgaWYgKHByZXYgIT09IFwiKlwiICYmIHByZXYgIT09IGN1cnJlbnQpIHtcbiAgICAgICAgICBjb252ID0gY29udmVydGVyc1twcmV2ICsgXCIgXCIgKyBjdXJyZW50XSB8fCBjb252ZXJ0ZXJzW1wiKiBcIiArIGN1cnJlbnRdO1xuICAgICAgICAgIGlmICghY29udikge1xuICAgICAgICAgICAgZm9yIChjb252MiBpbiBjb252ZXJ0ZXJzKSB7XG4gICAgICAgICAgICAgIHRtcCA9IGNvbnYyLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgICAgICAgaWYgKHRtcFsxXSA9PT0gY3VycmVudCkge1xuICAgICAgICAgICAgICAgIGNvbnYgPSBjb252ZXJ0ZXJzW3ByZXYgKyBcIiBcIiArIHRtcFswXV0gfHwgY29udmVydGVyc1tcIiogXCIgKyB0bXBbMF1dO1xuICAgICAgICAgICAgICAgIGlmIChjb252KSB7XG4gICAgICAgICAgICAgICAgICBpZiAoY29udiA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb252ID0gY29udmVydGVyc1tjb252Ml07XG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnZlcnRlcnNbY29udjJdICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSB0bXBbMF07XG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlcy51bnNoaWZ0KHRtcFsxXSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvbnYgIT09IHRydWUpIHtcbiAgICAgICAgICAgIGlmIChjb252ICYmIHNbXCJ0aHJvd3NcIl0pIHtcbiAgICAgICAgICAgICAgcmVzcG9uc2UgPSBjb252KHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBjb252KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICBzdGF0ZTogXCJwYXJzZXJlcnJvclwiLFxuICAgICAgICAgICAgICAgICAgZXJyb3I6IGNvbnYgPyBlIDogXCJObyBjb252ZXJzaW9uIGZyb20gXCIgKyBwcmV2ICsgXCIgdG8gXCIgKyBjdXJyZW50XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgc3RhdGU6IFwic3VjY2Vzc1wiLFxuICAgICAgZGF0YTogcmVzcG9uc2VcbiAgICB9O1xuICB9XG4gIGpRdWVyeS5leHRlbmQoe1xuICAgIGFjdGl2ZTogMCxcbiAgICBsYXN0TW9kaWZpZWQ6IHt9LFxuICAgIGV0YWc6IHt9LFxuICAgIGFqYXhTZXR0aW5nczoge1xuICAgICAgdXJsOiBhamF4TG9jYXRpb24sXG4gICAgICB0eXBlOiBcIkdFVFwiLFxuICAgICAgaXNMb2NhbDogcmxvY2FsUHJvdG9jb2wudGVzdChhamF4TG9jUGFydHNbMV0pLFxuICAgICAgZ2xvYmFsOiB0cnVlLFxuICAgICAgcHJvY2Vzc0RhdGE6IHRydWUsXG4gICAgICBhc3luYzogdHJ1ZSxcbiAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOFwiLFxuICAgICAgYWNjZXB0czoge1xuICAgICAgICBcIipcIjogYWxsVHlwZXMsXG4gICAgICAgIHRleHQ6IFwidGV4dC9wbGFpblwiLFxuICAgICAgICBodG1sOiBcInRleHQvaHRtbFwiLFxuICAgICAgICB4bWw6IFwiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbFwiLFxuICAgICAgICBqc29uOiBcImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdFwiXG4gICAgICB9LFxuICAgICAgY29udGVudHM6IHtcbiAgICAgICAgeG1sOiAveG1sLyxcbiAgICAgICAgaHRtbDogL2h0bWwvLFxuICAgICAgICBqc29uOiAvanNvbi9cbiAgICAgIH0sXG4gICAgICByZXNwb25zZUZpZWxkczoge1xuICAgICAgICB4bWw6IFwicmVzcG9uc2VYTUxcIixcbiAgICAgICAgdGV4dDogXCJyZXNwb25zZVRleHRcIixcbiAgICAgICAganNvbjogXCJyZXNwb25zZUpTT05cIlxuICAgICAgfSxcbiAgICAgIGNvbnZlcnRlcnM6IHtcbiAgICAgICAgXCIqIHRleHRcIjogU3RyaW5nLFxuICAgICAgICBcInRleHQgaHRtbFwiOiB0cnVlLFxuICAgICAgICBcInRleHQganNvblwiOiBqUXVlcnkucGFyc2VKU09OLFxuICAgICAgICBcInRleHQgeG1sXCI6IGpRdWVyeS5wYXJzZVhNTFxuICAgICAgfSxcbiAgICAgIGZsYXRPcHRpb25zOiB7XG4gICAgICAgIHVybDogdHJ1ZSxcbiAgICAgICAgY29udGV4dDogdHJ1ZVxuICAgICAgfVxuICAgIH0sXG4gICAgYWpheFNldHVwOiBmdW5jdGlvbih0YXJnZXQsIHNldHRpbmdzKSB7XG4gICAgICByZXR1cm4gc2V0dGluZ3MgPyBhamF4RXh0ZW5kKGFqYXhFeHRlbmQodGFyZ2V0LCBqUXVlcnkuYWpheFNldHRpbmdzKSwgc2V0dGluZ3MpIDogYWpheEV4dGVuZChqUXVlcnkuYWpheFNldHRpbmdzLCB0YXJnZXQpO1xuICAgIH0sXG4gICAgYWpheFByZWZpbHRlcjogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHByZWZpbHRlcnMpLFxuICAgIGFqYXhUcmFuc3BvcnQ6IGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyh0cmFuc3BvcnRzKSxcbiAgICBhamF4OiBmdW5jdGlvbih1cmwsIG9wdGlvbnMpIHtcbiAgICAgIGlmICh0eXBlb2YgdXJsID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIG9wdGlvbnMgPSB1cmw7XG4gICAgICAgIHVybCA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgdmFyIHRyYW5zcG9ydCxcbiAgICAgICAgICBjYWNoZVVSTCxcbiAgICAgICAgICByZXNwb25zZUhlYWRlcnNTdHJpbmcsXG4gICAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICAgIHRpbWVvdXRUaW1lcixcbiAgICAgICAgICBwYXJ0cyxcbiAgICAgICAgICBmaXJlR2xvYmFscyxcbiAgICAgICAgICBpLFxuICAgICAgICAgIHMgPSBqUXVlcnkuYWpheFNldHVwKHt9LCBvcHRpb25zKSxcbiAgICAgICAgICBjYWxsYmFja0NvbnRleHQgPSBzLmNvbnRleHQgfHwgcyxcbiAgICAgICAgICBnbG9iYWxFdmVudENvbnRleHQgPSBzLmNvbnRleHQgJiYgKGNhbGxiYWNrQ29udGV4dC5ub2RlVHlwZSB8fCBjYWxsYmFja0NvbnRleHQuanF1ZXJ5KSA/IGpRdWVyeShjYWxsYmFja0NvbnRleHQpIDogalF1ZXJ5LmV2ZW50LFxuICAgICAgICAgIGRlZmVycmVkID0galF1ZXJ5LkRlZmVycmVkKCksXG4gICAgICAgICAgY29tcGxldGVEZWZlcnJlZCA9IGpRdWVyeS5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSxcbiAgICAgICAgICBzdGF0dXNDb2RlID0gcy5zdGF0dXNDb2RlIHx8IHt9LFxuICAgICAgICAgIHJlcXVlc3RIZWFkZXJzID0ge30sXG4gICAgICAgICAgcmVxdWVzdEhlYWRlcnNOYW1lcyA9IHt9LFxuICAgICAgICAgIHN0YXRlID0gMCxcbiAgICAgICAgICBzdHJBYm9ydCA9IFwiY2FuY2VsZWRcIixcbiAgICAgICAgICBqcVhIUiA9IHtcbiAgICAgICAgICAgIHJlYWR5U3RhdGU6IDAsXG4gICAgICAgICAgICBnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgICAgIHZhciBtYXRjaDtcbiAgICAgICAgICAgICAgaWYgKHN0YXRlID09PSAyKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlSGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgICAgICAgd2hpbGUgKChtYXRjaCA9IHJoZWFkZXJzLmV4ZWMocmVzcG9uc2VIZWFkZXJzU3RyaW5nKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VIZWFkZXJzW21hdGNoWzFdLnRvTG93ZXJDYXNlKCldID0gbWF0Y2hbMl07XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1hdGNoID0gcmVzcG9uc2VIZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gbWF0Y2ggPT0gbnVsbCA/IG51bGwgOiBtYXRjaDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRBbGxSZXNwb25zZUhlYWRlcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gc3RhdGUgPT09IDIgPyByZXNwb25zZUhlYWRlcnNTdHJpbmcgOiBudWxsO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgICAgICAgIHZhciBsbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgaWYgKCFzdGF0ZSkge1xuICAgICAgICAgICAgICAgIG5hbWUgPSByZXF1ZXN0SGVhZGVyc05hbWVzW2xuYW1lXSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbbG5hbWVdIHx8IG5hbWU7XG4gICAgICAgICAgICAgICAgcmVxdWVzdEhlYWRlcnNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvdmVycmlkZU1pbWVUeXBlOiBmdW5jdGlvbih0eXBlKSB7XG4gICAgICAgICAgICAgIGlmICghc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBzLm1pbWVUeXBlID0gdHlwZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdGF0dXNDb2RlOiBmdW5jdGlvbihtYXApIHtcbiAgICAgICAgICAgICAgdmFyIGNvZGU7XG4gICAgICAgICAgICAgIGlmIChtYXApIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgPCAyKSB7XG4gICAgICAgICAgICAgICAgICBmb3IgKGNvZGUgaW4gbWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGVbY29kZV0gPSBbc3RhdHVzQ29kZVtjb2RlXSwgbWFwW2NvZGVdXTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAganFYSFIuYWx3YXlzKG1hcFtqcVhIUi5zdGF0dXNdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uKHN0YXR1c1RleHQpIHtcbiAgICAgICAgICAgICAgdmFyIGZpbmFsVGV4dCA9IHN0YXR1c1RleHQgfHwgc3RyQWJvcnQ7XG4gICAgICAgICAgICAgIGlmICh0cmFuc3BvcnQpIHtcbiAgICAgICAgICAgICAgICB0cmFuc3BvcnQuYWJvcnQoZmluYWxUZXh0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBkb25lKDAsIGZpbmFsVGV4dCk7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICBkZWZlcnJlZC5wcm9taXNlKGpxWEhSKS5jb21wbGV0ZSA9IGNvbXBsZXRlRGVmZXJyZWQuYWRkO1xuICAgICAganFYSFIuc3VjY2VzcyA9IGpxWEhSLmRvbmU7XG4gICAgICBqcVhIUi5lcnJvciA9IGpxWEhSLmZhaWw7XG4gICAgICBzLnVybCA9ICgodXJsIHx8IHMudXJsIHx8IGFqYXhMb2NhdGlvbikgKyBcIlwiKS5yZXBsYWNlKHJoYXNoLCBcIlwiKS5yZXBsYWNlKHJwcm90b2NvbCwgYWpheExvY1BhcnRzWzFdICsgXCIvL1wiKTtcbiAgICAgIHMudHlwZSA9IG9wdGlvbnMubWV0aG9kIHx8IG9wdGlvbnMudHlwZSB8fCBzLm1ldGhvZCB8fCBzLnR5cGU7XG4gICAgICBzLmRhdGFUeXBlcyA9IGpRdWVyeS50cmltKHMuZGF0YVR5cGUgfHwgXCIqXCIpLnRvTG93ZXJDYXNlKCkubWF0Y2gocm5vdHdoaXRlKSB8fCBbXCJcIl07XG4gICAgICBpZiAocy5jcm9zc0RvbWFpbiA9PSBudWxsKSB7XG4gICAgICAgIHBhcnRzID0gcnVybC5leGVjKHMudXJsLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICBzLmNyb3NzRG9tYWluID0gISEocGFydHMgJiYgKHBhcnRzWzFdICE9PSBhamF4TG9jUGFydHNbMV0gfHwgcGFydHNbMl0gIT09IGFqYXhMb2NQYXJ0c1syXSB8fCAocGFydHNbM10gfHwgKHBhcnRzWzFdID09PSBcImh0dHA6XCIgPyBcIjgwXCIgOiBcIjQ0M1wiKSkgIT09IChhamF4TG9jUGFydHNbM10gfHwgKGFqYXhMb2NQYXJ0c1sxXSA9PT0gXCJodHRwOlwiID8gXCI4MFwiIDogXCI0NDNcIikpKSk7XG4gICAgICB9XG4gICAgICBpZiAocy5kYXRhICYmIHMucHJvY2Vzc0RhdGEgJiYgdHlwZW9mIHMuZGF0YSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBzLmRhdGEgPSBqUXVlcnkucGFyYW0ocy5kYXRhLCBzLnRyYWRpdGlvbmFsKTtcbiAgICAgIH1cbiAgICAgIGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHByZWZpbHRlcnMsIHMsIG9wdGlvbnMsIGpxWEhSKTtcbiAgICAgIGlmIChzdGF0ZSA9PT0gMikge1xuICAgICAgICByZXR1cm4ganFYSFI7XG4gICAgICB9XG4gICAgICBmaXJlR2xvYmFscyA9IGpRdWVyeS5ldmVudCAmJiBzLmdsb2JhbDtcbiAgICAgIGlmIChmaXJlR2xvYmFscyAmJiBqUXVlcnkuYWN0aXZlKysgPT09IDApIHtcbiAgICAgICAgalF1ZXJ5LmV2ZW50LnRyaWdnZXIoXCJhamF4U3RhcnRcIik7XG4gICAgICB9XG4gICAgICBzLnR5cGUgPSBzLnR5cGUudG9VcHBlckNhc2UoKTtcbiAgICAgIHMuaGFzQ29udGVudCA9ICFybm9Db250ZW50LnRlc3Qocy50eXBlKTtcbiAgICAgIGNhY2hlVVJMID0gcy51cmw7XG4gICAgICBpZiAoIXMuaGFzQ29udGVudCkge1xuICAgICAgICBpZiAocy5kYXRhKSB7XG4gICAgICAgICAgY2FjaGVVUkwgPSAocy51cmwgKz0gKHJxdWVyeS50ZXN0KGNhY2hlVVJMKSA/IFwiJlwiIDogXCI/XCIpICsgcy5kYXRhKTtcbiAgICAgICAgICBkZWxldGUgcy5kYXRhO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzLmNhY2hlID09PSBmYWxzZSkge1xuICAgICAgICAgIHMudXJsID0gcnRzLnRlc3QoY2FjaGVVUkwpID8gY2FjaGVVUkwucmVwbGFjZShydHMsIFwiJDFfPVwiICsgbm9uY2UrKykgOiBjYWNoZVVSTCArIChycXVlcnkudGVzdChjYWNoZVVSTCkgPyBcIiZcIiA6IFwiP1wiKSArIFwiXz1cIiArIG5vbmNlKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzLmlmTW9kaWZpZWQpIHtcbiAgICAgICAgaWYgKGpRdWVyeS5sYXN0TW9kaWZpZWRbY2FjaGVVUkxdKSB7XG4gICAgICAgICAganFYSFIuc2V0UmVxdWVzdEhlYWRlcihcIklmLU1vZGlmaWVkLVNpbmNlXCIsIGpRdWVyeS5sYXN0TW9kaWZpZWRbY2FjaGVVUkxdKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoalF1ZXJ5LmV0YWdbY2FjaGVVUkxdKSB7XG4gICAgICAgICAganFYSFIuc2V0UmVxdWVzdEhlYWRlcihcIklmLU5vbmUtTWF0Y2hcIiwgalF1ZXJ5LmV0YWdbY2FjaGVVUkxdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHMuZGF0YSAmJiBzLmhhc0NvbnRlbnQgJiYgcy5jb250ZW50VHlwZSAhPT0gZmFsc2UgfHwgb3B0aW9ucy5jb250ZW50VHlwZSkge1xuICAgICAgICBqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIHMuY29udGVudFR5cGUpO1xuICAgICAgfVxuICAgICAganFYSFIuc2V0UmVxdWVzdEhlYWRlcihcIkFjY2VwdFwiLCBzLmRhdGFUeXBlc1swXSAmJiBzLmFjY2VwdHNbcy5kYXRhVHlwZXNbMF1dID8gcy5hY2NlcHRzW3MuZGF0YVR5cGVzWzBdXSArIChzLmRhdGFUeXBlc1swXSAhPT0gXCIqXCIgPyBcIiwgXCIgKyBhbGxUeXBlcyArIFwiOyBxPTAuMDFcIiA6IFwiXCIpIDogcy5hY2NlcHRzW1wiKlwiXSk7XG4gICAgICBmb3IgKGkgaW4gcy5oZWFkZXJzKSB7XG4gICAgICAgIGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoaSwgcy5oZWFkZXJzW2ldKTtcbiAgICAgIH1cbiAgICAgIGlmIChzLmJlZm9yZVNlbmQgJiYgKHMuYmVmb3JlU2VuZC5jYWxsKGNhbGxiYWNrQ29udGV4dCwganFYSFIsIHMpID09PSBmYWxzZSB8fCBzdGF0ZSA9PT0gMikpIHtcbiAgICAgICAgcmV0dXJuIGpxWEhSLmFib3J0KCk7XG4gICAgICB9XG4gICAgICBzdHJBYm9ydCA9IFwiYWJvcnRcIjtcbiAgICAgIGZvciAoaSBpbiB7XG4gICAgICAgIHN1Y2Nlc3M6IDEsXG4gICAgICAgIGVycm9yOiAxLFxuICAgICAgICBjb21wbGV0ZTogMVxuICAgICAgfSkge1xuICAgICAgICBqcVhIUltpXShzW2ldKTtcbiAgICAgIH1cbiAgICAgIHRyYW5zcG9ydCA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKHRyYW5zcG9ydHMsIHMsIG9wdGlvbnMsIGpxWEhSKTtcbiAgICAgIGlmICghdHJhbnNwb3J0KSB7XG4gICAgICAgIGRvbmUoLTEsIFwiTm8gVHJhbnNwb3J0XCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAganFYSFIucmVhZHlTdGF0ZSA9IDE7XG4gICAgICAgIGlmIChmaXJlR2xvYmFscykge1xuICAgICAgICAgIGdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKFwiYWpheFNlbmRcIiwgW2pxWEhSLCBzXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHMuYXN5bmMgJiYgcy50aW1lb3V0ID4gMCkge1xuICAgICAgICAgIHRpbWVvdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBqcVhIUi5hYm9ydChcInRpbWVvdXRcIik7XG4gICAgICAgICAgfSwgcy50aW1lb3V0KTtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgIHN0YXRlID0gMTtcbiAgICAgICAgICB0cmFuc3BvcnQuc2VuZChyZXF1ZXN0SGVhZGVycywgZG9uZSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPCAyKSB7XG4gICAgICAgICAgICBkb25lKC0xLCBlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGRvbmUoc3RhdHVzLCBuYXRpdmVTdGF0dXNUZXh0LCByZXNwb25zZXMsIGhlYWRlcnMpIHtcbiAgICAgICAgdmFyIGlzU3VjY2VzcyxcbiAgICAgICAgICAgIHN1Y2Nlc3MsXG4gICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgbW9kaWZpZWQsXG4gICAgICAgICAgICBzdGF0dXNUZXh0ID0gbmF0aXZlU3RhdHVzVGV4dDtcbiAgICAgICAgaWYgKHN0YXRlID09PSAyKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHN0YXRlID0gMjtcbiAgICAgICAgaWYgKHRpbWVvdXRUaW1lcikge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRyYW5zcG9ydCA9IHVuZGVmaW5lZDtcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzU3RyaW5nID0gaGVhZGVycyB8fCBcIlwiO1xuICAgICAgICBqcVhIUi5yZWFkeVN0YXRlID0gc3RhdHVzID4gMCA/IDQgOiAwO1xuICAgICAgICBpc1N1Y2Nlc3MgPSBzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCB8fCBzdGF0dXMgPT09IDMwNDtcbiAgICAgICAgaWYgKHJlc3BvbnNlcykge1xuICAgICAgICAgIHJlc3BvbnNlID0gYWpheEhhbmRsZVJlc3BvbnNlcyhzLCBqcVhIUiwgcmVzcG9uc2VzKTtcbiAgICAgICAgfVxuICAgICAgICByZXNwb25zZSA9IGFqYXhDb252ZXJ0KHMsIHJlc3BvbnNlLCBqcVhIUiwgaXNTdWNjZXNzKTtcbiAgICAgICAgaWYgKGlzU3VjY2Vzcykge1xuICAgICAgICAgIGlmIChzLmlmTW9kaWZpZWQpIHtcbiAgICAgICAgICAgIG1vZGlmaWVkID0ganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJMYXN0LU1vZGlmaWVkXCIpO1xuICAgICAgICAgICAgaWYgKG1vZGlmaWVkKSB7XG4gICAgICAgICAgICAgIGpRdWVyeS5sYXN0TW9kaWZpZWRbY2FjaGVVUkxdID0gbW9kaWZpZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtb2RpZmllZCA9IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKFwiZXRhZ1wiKTtcbiAgICAgICAgICAgIGlmIChtb2RpZmllZCkge1xuICAgICAgICAgICAgICBqUXVlcnkuZXRhZ1tjYWNoZVVSTF0gPSBtb2RpZmllZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHN0YXR1cyA9PT0gMjA0IHx8IHMudHlwZSA9PT0gXCJIRUFEXCIpIHtcbiAgICAgICAgICAgIHN0YXR1c1RleHQgPSBcIm5vY29udGVudFwiO1xuICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSAzMDQpIHtcbiAgICAgICAgICAgIHN0YXR1c1RleHQgPSBcIm5vdG1vZGlmaWVkXCI7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YXR1c1RleHQgPSByZXNwb25zZS5zdGF0ZTtcbiAgICAgICAgICAgIHN1Y2Nlc3MgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgZXJyb3IgPSByZXNwb25zZS5lcnJvcjtcbiAgICAgICAgICAgIGlzU3VjY2VzcyA9ICFlcnJvcjtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZXJyb3IgPSBzdGF0dXNUZXh0O1xuICAgICAgICAgIGlmIChzdGF0dXMgfHwgIXN0YXR1c1RleHQpIHtcbiAgICAgICAgICAgIHN0YXR1c1RleHQgPSBcImVycm9yXCI7XG4gICAgICAgICAgICBpZiAoc3RhdHVzIDwgMCkge1xuICAgICAgICAgICAgICBzdGF0dXMgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBqcVhIUi5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgIGpxWEhSLnN0YXR1c1RleHQgPSAobmF0aXZlU3RhdHVzVGV4dCB8fCBzdGF0dXNUZXh0KSArIFwiXCI7XG4gICAgICAgIGlmIChpc1N1Y2Nlc3MpIHtcbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlV2l0aChjYWxsYmFja0NvbnRleHQsIFtzdWNjZXNzLCBzdGF0dXNUZXh0LCBqcVhIUl0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdFdpdGgoY2FsbGJhY2tDb250ZXh0LCBbanFYSFIsIHN0YXR1c1RleHQsIGVycm9yXSk7XG4gICAgICAgIH1cbiAgICAgICAganFYSFIuc3RhdHVzQ29kZShzdGF0dXNDb2RlKTtcbiAgICAgICAgc3RhdHVzQ29kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGZpcmVHbG9iYWxzKSB7XG4gICAgICAgICAgZ2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoaXNTdWNjZXNzID8gXCJhamF4U3VjY2Vzc1wiIDogXCJhamF4RXJyb3JcIiwgW2pxWEhSLCBzLCBpc1N1Y2Nlc3MgPyBzdWNjZXNzIDogZXJyb3JdKTtcbiAgICAgICAgfVxuICAgICAgICBjb21wbGV0ZURlZmVycmVkLmZpcmVXaXRoKGNhbGxiYWNrQ29udGV4dCwgW2pxWEhSLCBzdGF0dXNUZXh0XSk7XG4gICAgICAgIGlmIChmaXJlR2xvYmFscykge1xuICAgICAgICAgIGdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKFwiYWpheENvbXBsZXRlXCIsIFtqcVhIUiwgc10pO1xuICAgICAgICAgIGlmICghKC0talF1ZXJ5LmFjdGl2ZSkpIHtcbiAgICAgICAgICAgIGpRdWVyeS5ldmVudC50cmlnZ2VyKFwiYWpheFN0b3BcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4ganFYSFI7XG4gICAgfSxcbiAgICBnZXRKU09OOiBmdW5jdGlvbih1cmwsIGRhdGEsIGNhbGxiYWNrKSB7XG4gICAgICByZXR1cm4galF1ZXJ5LmdldCh1cmwsIGRhdGEsIGNhbGxiYWNrLCBcImpzb25cIik7XG4gICAgfSxcbiAgICBnZXRTY3JpcHQ6IGZ1bmN0aW9uKHVybCwgY2FsbGJhY2spIHtcbiAgICAgIHJldHVybiBqUXVlcnkuZ2V0KHVybCwgdW5kZWZpbmVkLCBjYWxsYmFjaywgXCJzY3JpcHRcIik7XG4gICAgfVxuICB9KTtcbiAgalF1ZXJ5LmVhY2goW1wiZ2V0XCIsIFwicG9zdFwiXSwgZnVuY3Rpb24oaSwgbWV0aG9kKSB7XG4gICAgalF1ZXJ5W21ldGhvZF0gPSBmdW5jdGlvbih1cmwsIGRhdGEsIGNhbGxiYWNrLCB0eXBlKSB7XG4gICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24oZGF0YSkpIHtcbiAgICAgICAgdHlwZSA9IHR5cGUgfHwgY2FsbGJhY2s7XG4gICAgICAgIGNhbGxiYWNrID0gZGF0YTtcbiAgICAgICAgZGF0YSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBqUXVlcnkuYWpheCh7XG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICB0eXBlOiBtZXRob2QsXG4gICAgICAgIGRhdGFUeXBlOiB0eXBlLFxuICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICBzdWNjZXNzOiBjYWxsYmFja1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG4gIGpRdWVyeS5fZXZhbFVybCA9IGZ1bmN0aW9uKHVybCkge1xuICAgIHJldHVybiBqUXVlcnkuYWpheCh7XG4gICAgICB1cmw6IHVybCxcbiAgICAgIHR5cGU6IFwiR0VUXCIsXG4gICAgICBkYXRhVHlwZTogXCJzY3JpcHRcIixcbiAgICAgIGFzeW5jOiBmYWxzZSxcbiAgICAgIGdsb2JhbDogZmFsc2UsXG4gICAgICBcInRocm93c1wiOiB0cnVlXG4gICAgfSk7XG4gIH07XG4gIGpRdWVyeS5mbi5leHRlbmQoe1xuICAgIHdyYXBBbGw6IGZ1bmN0aW9uKGh0bWwpIHtcbiAgICAgIHZhciB3cmFwO1xuICAgICAgaWYgKGpRdWVyeS5pc0Z1bmN0aW9uKGh0bWwpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSkge1xuICAgICAgICAgIGpRdWVyeSh0aGlzKS53cmFwQWxsKGh0bWwuY2FsbCh0aGlzLCBpKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXNbMF0pIHtcbiAgICAgICAgd3JhcCA9IGpRdWVyeShodG1sLCB0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKHRydWUpO1xuICAgICAgICBpZiAodGhpc1swXS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgd3JhcC5pbnNlcnRCZWZvcmUodGhpc1swXSk7XG4gICAgICAgIH1cbiAgICAgICAgd3JhcC5tYXAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGVsZW0gPSB0aGlzO1xuICAgICAgICAgIHdoaWxlIChlbGVtLmZpcnN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICBlbGVtID0gZWxlbS5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGVsZW07XG4gICAgICAgIH0pLmFwcGVuZCh0aGlzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgd3JhcElubmVyOiBmdW5jdGlvbihodG1sKSB7XG4gICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24oaHRtbCkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKSB7XG4gICAgICAgICAgalF1ZXJ5KHRoaXMpLndyYXBJbm5lcihodG1sLmNhbGwodGhpcywgaSkpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0galF1ZXJ5KHRoaXMpLFxuICAgICAgICAgICAgY29udGVudHMgPSBzZWxmLmNvbnRlbnRzKCk7XG4gICAgICAgIGlmIChjb250ZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICBjb250ZW50cy53cmFwQWxsKGh0bWwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNlbGYuYXBwZW5kKGh0bWwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHdyYXA6IGZ1bmN0aW9uKGh0bWwpIHtcbiAgICAgIHZhciBpc0Z1bmN0aW9uID0galF1ZXJ5LmlzRnVuY3Rpb24oaHRtbCk7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGkpIHtcbiAgICAgICAgalF1ZXJ5KHRoaXMpLndyYXBBbGwoaXNGdW5jdGlvbiA/IGh0bWwuY2FsbCh0aGlzLCBpKSA6IGh0bWwpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICB1bndyYXA6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMucGFyZW50KCkuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCFqUXVlcnkubm9kZU5hbWUodGhpcywgXCJib2R5XCIpKSB7XG4gICAgICAgICAgalF1ZXJ5KHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pLmVuZCgpO1xuICAgIH1cbiAgfSk7XG4gIGpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVuID0gZnVuY3Rpb24oZWxlbSkge1xuICAgIHJldHVybiBlbGVtLm9mZnNldFdpZHRoIDw9IDAgJiYgZWxlbS5vZmZzZXRIZWlnaHQgPD0gMDtcbiAgfTtcbiAgalF1ZXJ5LmV4cHIuZmlsdGVycy52aXNpYmxlID0gZnVuY3Rpb24oZWxlbSkge1xuICAgIHJldHVybiAhalF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4oZWxlbSk7XG4gIH07XG4gIHZhciByMjAgPSAvJTIwL2csXG4gICAgICByYnJhY2tldCA9IC9cXFtcXF0kLyxcbiAgICAgIHJDUkxGID0gL1xccj9cXG4vZyxcbiAgICAgIHJzdWJtaXR0ZXJUeXBlcyA9IC9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSxcbiAgICAgIHJzdWJtaXR0YWJsZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTtcbiAgZnVuY3Rpb24gYnVpbGRQYXJhbXMocHJlZml4LCBvYmosIHRyYWRpdGlvbmFsLCBhZGQpIHtcbiAgICB2YXIgbmFtZTtcbiAgICBpZiAoalF1ZXJ5LmlzQXJyYXkob2JqKSkge1xuICAgICAgalF1ZXJ5LmVhY2gob2JqLCBmdW5jdGlvbihpLCB2KSB7XG4gICAgICAgIGlmICh0cmFkaXRpb25hbCB8fCByYnJhY2tldC50ZXN0KHByZWZpeCkpIHtcbiAgICAgICAgICBhZGQocHJlZml4LCB2KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBidWlsZFBhcmFtcyhwcmVmaXggKyBcIltcIiArICh0eXBlb2YgdiA9PT0gXCJvYmplY3RcIiA/IGkgOiBcIlwiKSArIFwiXVwiLCB2LCB0cmFkaXRpb25hbCwgYWRkKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICghdHJhZGl0aW9uYWwgJiYgalF1ZXJ5LnR5cGUob2JqKSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgZm9yIChuYW1lIGluIG9iaikge1xuICAgICAgICBidWlsZFBhcmFtcyhwcmVmaXggKyBcIltcIiArIG5hbWUgKyBcIl1cIiwgb2JqW25hbWVdLCB0cmFkaXRpb25hbCwgYWRkKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYWRkKHByZWZpeCwgb2JqKTtcbiAgICB9XG4gIH1cbiAgalF1ZXJ5LnBhcmFtID0gZnVuY3Rpb24oYSwgdHJhZGl0aW9uYWwpIHtcbiAgICB2YXIgcHJlZml4LFxuICAgICAgICBzID0gW10sXG4gICAgICAgIGFkZCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICB2YWx1ZSA9IGpRdWVyeS5pc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlKCkgOiAodmFsdWUgPT0gbnVsbCA/IFwiXCIgOiB2YWx1ZSk7XG4gICAgICAgICAgc1tzLmxlbmd0aF0gPSBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcbiAgICAgICAgfTtcbiAgICBpZiAodHJhZGl0aW9uYWwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdHJhZGl0aW9uYWwgPSBqUXVlcnkuYWpheFNldHRpbmdzICYmIGpRdWVyeS5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWw7XG4gICAgfVxuICAgIGlmIChqUXVlcnkuaXNBcnJheShhKSB8fCAoYS5qcXVlcnkgJiYgIWpRdWVyeS5pc1BsYWluT2JqZWN0KGEpKSkge1xuICAgICAgalF1ZXJ5LmVhY2goYSwgZnVuY3Rpb24oKSB7XG4gICAgICAgIGFkZCh0aGlzLm5hbWUsIHRoaXMudmFsdWUpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAocHJlZml4IGluIGEpIHtcbiAgICAgICAgYnVpbGRQYXJhbXMocHJlZml4LCBhW3ByZWZpeF0sIHRyYWRpdGlvbmFsLCBhZGQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcy5qb2luKFwiJlwiKS5yZXBsYWNlKHIyMCwgXCIrXCIpO1xuICB9O1xuICBqUXVlcnkuZm4uZXh0ZW5kKHtcbiAgICBzZXJpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGpRdWVyeS5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpO1xuICAgIH0sXG4gICAgc2VyaWFsaXplQXJyYXk6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZWxlbWVudHMgPSBqUXVlcnkucHJvcCh0aGlzLCBcImVsZW1lbnRzXCIpO1xuICAgICAgICByZXR1cm4gZWxlbWVudHMgPyBqUXVlcnkubWFrZUFycmF5KGVsZW1lbnRzKSA6IHRoaXM7XG4gICAgICB9KS5maWx0ZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0eXBlID0gdGhpcy50eXBlO1xuICAgICAgICByZXR1cm4gdGhpcy5uYW1lICYmICFqUXVlcnkodGhpcykuaXMoXCI6ZGlzYWJsZWRcIikgJiYgcnN1Ym1pdHRhYmxlLnRlc3QodGhpcy5ub2RlTmFtZSkgJiYgIXJzdWJtaXR0ZXJUeXBlcy50ZXN0KHR5cGUpICYmICh0aGlzLmNoZWNrZWQgfHwgIXJjaGVja2FibGVUeXBlLnRlc3QodHlwZSkpO1xuICAgICAgfSkubWFwKGZ1bmN0aW9uKGksIGVsZW0pIHtcbiAgICAgICAgdmFyIHZhbCA9IGpRdWVyeSh0aGlzKS52YWwoKTtcbiAgICAgICAgcmV0dXJuIHZhbCA9PSBudWxsID8gbnVsbCA6IGpRdWVyeS5pc0FycmF5KHZhbCkgPyBqUXVlcnkubWFwKHZhbCwgZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IGVsZW0ubmFtZSxcbiAgICAgICAgICAgIHZhbHVlOiB2YWwucmVwbGFjZShyQ1JMRiwgXCJcXHJcXG5cIilcbiAgICAgICAgICB9O1xuICAgICAgICB9KSA6IHtcbiAgICAgICAgICBuYW1lOiBlbGVtLm5hbWUsXG4gICAgICAgICAgdmFsdWU6IHZhbC5yZXBsYWNlKHJDUkxGLCBcIlxcclxcblwiKVxuICAgICAgICB9O1xuICAgICAgfSkuZ2V0KCk7XG4gICAgfVxuICB9KTtcbiAgalF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIgPSBmdW5jdGlvbigpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG4gIH07XG4gIHZhciB4aHJJZCA9IDAsXG4gICAgICB4aHJDYWxsYmFja3MgPSB7fSxcbiAgICAgIHhoclN1Y2Nlc3NTdGF0dXMgPSB7XG4gICAgICAgIDA6IDIwMCxcbiAgICAgICAgMTIyMzogMjA0XG4gICAgICB9LFxuICAgICAgeGhyU3VwcG9ydGVkID0galF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIoKTtcbiAgaWYgKHdpbmRvdy5hdHRhY2hFdmVudCkge1xuICAgIHdpbmRvdy5hdHRhY2hFdmVudChcIm9udW5sb2FkXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgZm9yICh2YXIga2V5IGluIHhockNhbGxiYWNrcykge1xuICAgICAgICB4aHJDYWxsYmFja3Nba2V5XSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIHN1cHBvcnQuY29ycyA9ICEheGhyU3VwcG9ydGVkICYmIChcIndpdGhDcmVkZW50aWFsc1wiIGluIHhoclN1cHBvcnRlZCk7XG4gIHN1cHBvcnQuYWpheCA9IHhoclN1cHBvcnRlZCA9ICEheGhyU3VwcG9ydGVkO1xuICBqUXVlcnkuYWpheFRyYW5zcG9ydChmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgdmFyIGNhbGxiYWNrO1xuICAgIGlmIChzdXBwb3J0LmNvcnMgfHwgeGhyU3VwcG9ydGVkICYmICFvcHRpb25zLmNyb3NzRG9tYWluKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzZW5kOiBmdW5jdGlvbihoZWFkZXJzLCBjb21wbGV0ZSkge1xuICAgICAgICAgIHZhciBpLFxuICAgICAgICAgICAgICB4aHIgPSBvcHRpb25zLnhocigpLFxuICAgICAgICAgICAgICBpZCA9ICsreGhySWQ7XG4gICAgICAgICAgeGhyLm9wZW4ob3B0aW9ucy50eXBlLCBvcHRpb25zLnVybCwgb3B0aW9ucy5hc3luYywgb3B0aW9ucy51c2VybmFtZSwgb3B0aW9ucy5wYXNzd29yZCk7XG4gICAgICAgICAgaWYgKG9wdGlvbnMueGhyRmllbGRzKSB7XG4gICAgICAgICAgICBmb3IgKGkgaW4gb3B0aW9ucy54aHJGaWVsZHMpIHtcbiAgICAgICAgICAgICAgeGhyW2ldID0gb3B0aW9ucy54aHJGaWVsZHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcHRpb25zLm1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlKSB7XG4gICAgICAgICAgICB4aHIub3ZlcnJpZGVNaW1lVHlwZShvcHRpb25zLm1pbWVUeXBlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFvcHRpb25zLmNyb3NzRG9tYWluICYmICFoZWFkZXJzW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXSkge1xuICAgICAgICAgICAgaGVhZGVyc1tcIlgtUmVxdWVzdGVkLVdpdGhcIl0gPSBcIlhNTEh0dHBSZXF1ZXN0XCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvciAoaSBpbiBoZWFkZXJzKSB7XG4gICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihpLCBoZWFkZXJzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FsbGJhY2sgPSBmdW5jdGlvbih0eXBlKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB4aHJDYWxsYmFja3NbaWRdO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrID0geGhyLm9ubG9hZCA9IHhoci5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJhYm9ydFwiKSB7XG4gICAgICAgICAgICAgICAgICB4aHIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiZXJyb3JcIikge1xuICAgICAgICAgICAgICAgICAgY29tcGxldGUoeGhyLnN0YXR1cywgeGhyLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBjb21wbGV0ZSh4aHJTdWNjZXNzU3RhdHVzW3hoci5zdGF0dXNdIHx8IHhoci5zdGF0dXMsIHhoci5zdGF0dXNUZXh0LCB0eXBlb2YgeGhyLnJlc3BvbnNlVGV4dCA9PT0gXCJzdHJpbmdcIiA/IHt0ZXh0OiB4aHIucmVzcG9uc2VUZXh0fSA6IHVuZGVmaW5lZCwgeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfTtcbiAgICAgICAgICB4aHIub25sb2FkID0gY2FsbGJhY2soKTtcbiAgICAgICAgICB4aHIub25lcnJvciA9IGNhbGxiYWNrKFwiZXJyb3JcIik7XG4gICAgICAgICAgY2FsbGJhY2sgPSB4aHJDYWxsYmFja3NbaWRdID0gY2FsbGJhY2soXCJhYm9ydFwiKTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgeGhyLnNlbmQob3B0aW9ucy5oYXNDb250ZW50ICYmIG9wdGlvbnMuZGF0YSB8fCBudWxsKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGFib3J0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG4gIGpRdWVyeS5hamF4U2V0dXAoe1xuICAgIGFjY2VwdHM6IHtzY3JpcHQ6IFwidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHRcIn0sXG4gICAgY29udGVudHM6IHtzY3JpcHQ6IC8oPzpqYXZhfGVjbWEpc2NyaXB0L30sXG4gICAgY29udmVydGVyczoge1widGV4dCBzY3JpcHRcIjogZnVuY3Rpb24odGV4dCkge1xuICAgICAgICBqUXVlcnkuZ2xvYmFsRXZhbCh0ZXh0KTtcbiAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgICB9fVxuICB9KTtcbiAgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIoXCJzY3JpcHRcIiwgZnVuY3Rpb24ocykge1xuICAgIGlmIChzLmNhY2hlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHMuY2FjaGUgPSBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHMuY3Jvc3NEb21haW4pIHtcbiAgICAgIHMudHlwZSA9IFwiR0VUXCI7XG4gICAgfVxuICB9KTtcbiAgalF1ZXJ5LmFqYXhUcmFuc3BvcnQoXCJzY3JpcHRcIiwgZnVuY3Rpb24ocykge1xuICAgIGlmIChzLmNyb3NzRG9tYWluKSB7XG4gICAgICB2YXIgc2NyaXB0LFxuICAgICAgICAgIGNhbGxiYWNrO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2VuZDogZnVuY3Rpb24oXywgY29tcGxldGUpIHtcbiAgICAgICAgICBzY3JpcHQgPSBqUXVlcnkoXCI8c2NyaXB0PlwiKS5wcm9wKHtcbiAgICAgICAgICAgIGFzeW5jOiB0cnVlLFxuICAgICAgICAgICAgY2hhcnNldDogcy5zY3JpcHRDaGFyc2V0LFxuICAgICAgICAgICAgc3JjOiBzLnVybFxuICAgICAgICAgIH0pLm9uKFwibG9hZCBlcnJvclwiLCBjYWxsYmFjayA9IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgc2NyaXB0LnJlbW92ZSgpO1xuICAgICAgICAgICAgY2FsbGJhY2sgPSBudWxsO1xuICAgICAgICAgICAgaWYgKGV2dCkge1xuICAgICAgICAgICAgICBjb21wbGV0ZShldnQudHlwZSA9PT0gXCJlcnJvclwiID8gNDA0IDogMjAwLCBldnQudHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHRbMF0pO1xuICAgICAgICB9LFxuICAgICAgICBhYm9ydDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xuICB2YXIgb2xkQ2FsbGJhY2tzID0gW10sXG4gICAgICByanNvbnAgPSAvKD0pXFw/KD89JnwkKXxcXD9cXD8vO1xuICBqUXVlcnkuYWpheFNldHVwKHtcbiAgICBqc29ucDogXCJjYWxsYmFja1wiLFxuICAgIGpzb25wQ2FsbGJhY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGNhbGxiYWNrID0gb2xkQ2FsbGJhY2tzLnBvcCgpIHx8IChqUXVlcnkuZXhwYW5kbyArIFwiX1wiICsgKG5vbmNlKyspKTtcbiAgICAgIHRoaXNbY2FsbGJhY2tdID0gdHJ1ZTtcbiAgICAgIHJldHVybiBjYWxsYmFjaztcbiAgICB9XG4gIH0pO1xuICBqUXVlcnkuYWpheFByZWZpbHRlcihcImpzb24ganNvbnBcIiwgZnVuY3Rpb24ocywgb3JpZ2luYWxTZXR0aW5ncywganFYSFIpIHtcbiAgICB2YXIgY2FsbGJhY2tOYW1lLFxuICAgICAgICBvdmVyd3JpdHRlbixcbiAgICAgICAgcmVzcG9uc2VDb250YWluZXIsXG4gICAgICAgIGpzb25Qcm9wID0gcy5qc29ucCAhPT0gZmFsc2UgJiYgKHJqc29ucC50ZXN0KHMudXJsKSA/IFwidXJsXCIgOiB0eXBlb2Ygcy5kYXRhID09PSBcInN0cmluZ1wiICYmICEocy5jb250ZW50VHlwZSB8fCBcIlwiKS5pbmRleE9mKFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIpICYmIHJqc29ucC50ZXN0KHMuZGF0YSkgJiYgXCJkYXRhXCIpO1xuICAgIGlmIChqc29uUHJvcCB8fCBzLmRhdGFUeXBlc1swXSA9PT0gXCJqc29ucFwiKSB7XG4gICAgICBjYWxsYmFja05hbWUgPSBzLmpzb25wQ2FsbGJhY2sgPSBqUXVlcnkuaXNGdW5jdGlvbihzLmpzb25wQ2FsbGJhY2spID8gcy5qc29ucENhbGxiYWNrKCkgOiBzLmpzb25wQ2FsbGJhY2s7XG4gICAgICBpZiAoanNvblByb3ApIHtcbiAgICAgICAgc1tqc29uUHJvcF0gPSBzW2pzb25Qcm9wXS5yZXBsYWNlKHJqc29ucCwgXCIkMVwiICsgY2FsbGJhY2tOYW1lKTtcbiAgICAgIH0gZWxzZSBpZiAocy5qc29ucCAhPT0gZmFsc2UpIHtcbiAgICAgICAgcy51cmwgKz0gKHJxdWVyeS50ZXN0KHMudXJsKSA/IFwiJlwiIDogXCI/XCIpICsgcy5qc29ucCArIFwiPVwiICsgY2FsbGJhY2tOYW1lO1xuICAgICAgfVxuICAgICAgcy5jb252ZXJ0ZXJzW1wic2NyaXB0IGpzb25cIl0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCFyZXNwb25zZUNvbnRhaW5lcikge1xuICAgICAgICAgIGpRdWVyeS5lcnJvcihjYWxsYmFja05hbWUgKyBcIiB3YXMgbm90IGNhbGxlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzcG9uc2VDb250YWluZXJbMF07XG4gICAgICB9O1xuICAgICAgcy5kYXRhVHlwZXNbMF0gPSBcImpzb25cIjtcbiAgICAgIG92ZXJ3cml0dGVuID0gd2luZG93W2NhbGxiYWNrTmFtZV07XG4gICAgICB3aW5kb3dbY2FsbGJhY2tOYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNwb25zZUNvbnRhaW5lciA9IGFyZ3VtZW50cztcbiAgICAgIH07XG4gICAgICBqcVhIUi5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgIHdpbmRvd1tjYWxsYmFja05hbWVdID0gb3ZlcndyaXR0ZW47XG4gICAgICAgIGlmIChzW2NhbGxiYWNrTmFtZV0pIHtcbiAgICAgICAgICBzLmpzb25wQ2FsbGJhY2sgPSBvcmlnaW5hbFNldHRpbmdzLmpzb25wQ2FsbGJhY2s7XG4gICAgICAgICAgb2xkQ2FsbGJhY2tzLnB1c2goY2FsbGJhY2tOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzcG9uc2VDb250YWluZXIgJiYgalF1ZXJ5LmlzRnVuY3Rpb24ob3ZlcndyaXR0ZW4pKSB7XG4gICAgICAgICAgb3ZlcndyaXR0ZW4ocmVzcG9uc2VDb250YWluZXJbMF0pO1xuICAgICAgICB9XG4gICAgICAgIHJlc3BvbnNlQ29udGFpbmVyID0gb3ZlcndyaXR0ZW4gPSB1bmRlZmluZWQ7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBcInNjcmlwdFwiO1xuICAgIH1cbiAgfSk7XG4gIGpRdWVyeS5wYXJzZUhUTUwgPSBmdW5jdGlvbihkYXRhLCBjb250ZXh0LCBrZWVwU2NyaXB0cykge1xuICAgIGlmICghZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgY29udGV4dCA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgIGtlZXBTY3JpcHRzID0gY29udGV4dDtcbiAgICAgIGNvbnRleHQgPSBmYWxzZTtcbiAgICB9XG4gICAgY29udGV4dCA9IGNvbnRleHQgfHwgZG9jdW1lbnQ7XG4gICAgdmFyIHBhcnNlZCA9IHJzaW5nbGVUYWcuZXhlYyhkYXRhKSxcbiAgICAgICAgc2NyaXB0cyA9ICFrZWVwU2NyaXB0cyAmJiBbXTtcbiAgICBpZiAocGFyc2VkKSB7XG4gICAgICByZXR1cm4gW2NvbnRleHQuY3JlYXRlRWxlbWVudChwYXJzZWRbMV0pXTtcbiAgICB9XG4gICAgcGFyc2VkID0galF1ZXJ5LmJ1aWxkRnJhZ21lbnQoW2RhdGFdLCBjb250ZXh0LCBzY3JpcHRzKTtcbiAgICBpZiAoc2NyaXB0cyAmJiBzY3JpcHRzLmxlbmd0aCkge1xuICAgICAgalF1ZXJ5KHNjcmlwdHMpLnJlbW92ZSgpO1xuICAgIH1cbiAgICByZXR1cm4galF1ZXJ5Lm1lcmdlKFtdLCBwYXJzZWQuY2hpbGROb2Rlcyk7XG4gIH07XG4gIHZhciBfbG9hZCA9IGpRdWVyeS5mbi5sb2FkO1xuICBqUXVlcnkuZm4ubG9hZCA9IGZ1bmN0aW9uKHVybCwgcGFyYW1zLCBjYWxsYmFjaykge1xuICAgIGlmICh0eXBlb2YgdXJsICE9PSBcInN0cmluZ1wiICYmIF9sb2FkKSB7XG4gICAgICByZXR1cm4gX2xvYWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gICAgdmFyIHNlbGVjdG9yLFxuICAgICAgICB0eXBlLFxuICAgICAgICByZXNwb25zZSxcbiAgICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICAgIG9mZiA9IHVybC5pbmRleE9mKFwiIFwiKTtcbiAgICBpZiAob2ZmID49IDApIHtcbiAgICAgIHNlbGVjdG9yID0galF1ZXJ5LnRyaW0odXJsLnNsaWNlKG9mZikpO1xuICAgICAgdXJsID0gdXJsLnNsaWNlKDAsIG9mZik7XG4gICAgfVxuICAgIGlmIChqUXVlcnkuaXNGdW5jdGlvbihwYXJhbXMpKSB7XG4gICAgICBjYWxsYmFjayA9IHBhcmFtcztcbiAgICAgIHBhcmFtcyA9IHVuZGVmaW5lZDtcbiAgICB9IGVsc2UgaWYgKHBhcmFtcyAmJiB0eXBlb2YgcGFyYW1zID09PSBcIm9iamVjdFwiKSB7XG4gICAgICB0eXBlID0gXCJQT1NUXCI7XG4gICAgfVxuICAgIGlmIChzZWxmLmxlbmd0aCA+IDApIHtcbiAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgIGRhdGFUeXBlOiBcImh0bWxcIixcbiAgICAgICAgZGF0YTogcGFyYW1zXG4gICAgICB9KS5kb25lKGZ1bmN0aW9uKHJlc3BvbnNlVGV4dCkge1xuICAgICAgICByZXNwb25zZSA9IGFyZ3VtZW50cztcbiAgICAgICAgc2VsZi5odG1sKHNlbGVjdG9yID8galF1ZXJ5KFwiPGRpdj5cIikuYXBwZW5kKGpRdWVyeS5wYXJzZUhUTUwocmVzcG9uc2VUZXh0KSkuZmluZChzZWxlY3RvcikgOiByZXNwb25zZVRleHQpO1xuICAgICAgfSkuY29tcGxldGUoY2FsbGJhY2sgJiYgZnVuY3Rpb24oanFYSFIsIHN0YXR1cykge1xuICAgICAgICBzZWxmLmVhY2goY2FsbGJhY2ssIHJlc3BvbnNlIHx8IFtqcVhIUi5yZXNwb25zZVRleHQsIHN0YXR1cywganFYSFJdKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgalF1ZXJ5LmVhY2goW1wiYWpheFN0YXJ0XCIsIFwiYWpheFN0b3BcIiwgXCJhamF4Q29tcGxldGVcIiwgXCJhamF4RXJyb3JcIiwgXCJhamF4U3VjY2Vzc1wiLCBcImFqYXhTZW5kXCJdLCBmdW5jdGlvbihpLCB0eXBlKSB7XG4gICAgalF1ZXJ5LmZuW3R5cGVdID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgIHJldHVybiB0aGlzLm9uKHR5cGUsIGZuKTtcbiAgICB9O1xuICB9KTtcbiAgalF1ZXJ5LmV4cHIuZmlsdGVycy5hbmltYXRlZCA9IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICByZXR1cm4galF1ZXJ5LmdyZXAoalF1ZXJ5LnRpbWVycywgZnVuY3Rpb24oZm4pIHtcbiAgICAgIHJldHVybiBlbGVtID09PSBmbi5lbGVtO1xuICAgIH0pLmxlbmd0aDtcbiAgfTtcbiAgdmFyIGRvY0VsZW0gPSB3aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICBmdW5jdGlvbiBnZXRXaW5kb3coZWxlbSkge1xuICAgIHJldHVybiBqUXVlcnkuaXNXaW5kb3coZWxlbSkgPyBlbGVtIDogZWxlbS5ub2RlVHlwZSA9PT0gOSAmJiBlbGVtLmRlZmF1bHRWaWV3O1xuICB9XG4gIGpRdWVyeS5vZmZzZXQgPSB7c2V0T2Zmc2V0OiBmdW5jdGlvbihlbGVtLCBvcHRpb25zLCBpKSB7XG4gICAgICB2YXIgY3VyUG9zaXRpb24sXG4gICAgICAgICAgY3VyTGVmdCxcbiAgICAgICAgICBjdXJDU1NUb3AsXG4gICAgICAgICAgY3VyVG9wLFxuICAgICAgICAgIGN1ck9mZnNldCxcbiAgICAgICAgICBjdXJDU1NMZWZ0LFxuICAgICAgICAgIGNhbGN1bGF0ZVBvc2l0aW9uLFxuICAgICAgICAgIHBvc2l0aW9uID0galF1ZXJ5LmNzcyhlbGVtLCBcInBvc2l0aW9uXCIpLFxuICAgICAgICAgIGN1ckVsZW0gPSBqUXVlcnkoZWxlbSksXG4gICAgICAgICAgcHJvcHMgPSB7fTtcbiAgICAgIGlmIChwb3NpdGlvbiA9PT0gXCJzdGF0aWNcIikge1xuICAgICAgICBlbGVtLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuICAgICAgfVxuICAgICAgY3VyT2Zmc2V0ID0gY3VyRWxlbS5vZmZzZXQoKTtcbiAgICAgIGN1ckNTU1RvcCA9IGpRdWVyeS5jc3MoZWxlbSwgXCJ0b3BcIik7XG4gICAgICBjdXJDU1NMZWZ0ID0galF1ZXJ5LmNzcyhlbGVtLCBcImxlZnRcIik7XG4gICAgICBjYWxjdWxhdGVQb3NpdGlvbiA9IChwb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiIHx8IHBvc2l0aW9uID09PSBcImZpeGVkXCIpICYmIChjdXJDU1NUb3AgKyBjdXJDU1NMZWZ0KS5pbmRleE9mKFwiYXV0b1wiKSA+IC0xO1xuICAgICAgaWYgKGNhbGN1bGF0ZVBvc2l0aW9uKSB7XG4gICAgICAgIGN1clBvc2l0aW9uID0gY3VyRWxlbS5wb3NpdGlvbigpO1xuICAgICAgICBjdXJUb3AgPSBjdXJQb3NpdGlvbi50b3A7XG4gICAgICAgIGN1ckxlZnQgPSBjdXJQb3NpdGlvbi5sZWZ0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VyVG9wID0gcGFyc2VGbG9hdChjdXJDU1NUb3ApIHx8IDA7XG4gICAgICAgIGN1ckxlZnQgPSBwYXJzZUZsb2F0KGN1ckNTU0xlZnQpIHx8IDA7XG4gICAgICB9XG4gICAgICBpZiAoalF1ZXJ5LmlzRnVuY3Rpb24ob3B0aW9ucykpIHtcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMuY2FsbChlbGVtLCBpLCBjdXJPZmZzZXQpO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMudG9wICE9IG51bGwpIHtcbiAgICAgICAgcHJvcHMudG9wID0gKG9wdGlvbnMudG9wIC0gY3VyT2Zmc2V0LnRvcCkgKyBjdXJUb3A7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5sZWZ0ICE9IG51bGwpIHtcbiAgICAgICAgcHJvcHMubGVmdCA9IChvcHRpb25zLmxlZnQgLSBjdXJPZmZzZXQubGVmdCkgKyBjdXJMZWZ0O1xuICAgICAgfVxuICAgICAgaWYgKFwidXNpbmdcIiBpbiBvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMudXNpbmcuY2FsbChlbGVtLCBwcm9wcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjdXJFbGVtLmNzcyhwcm9wcyk7XG4gICAgICB9XG4gICAgfX07XG4gIGpRdWVyeS5mbi5leHRlbmQoe1xuICAgIG9mZnNldDogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMgPT09IHVuZGVmaW5lZCA/IHRoaXMgOiB0aGlzLmVhY2goZnVuY3Rpb24oaSkge1xuICAgICAgICAgIGpRdWVyeS5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsIG9wdGlvbnMsIGkpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHZhciBkb2NFbGVtLFxuICAgICAgICAgIHdpbixcbiAgICAgICAgICBlbGVtID0gdGhpc1swXSxcbiAgICAgICAgICBib3ggPSB7XG4gICAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgICBsZWZ0OiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkb2MgPSBlbGVtICYmIGVsZW0ub3duZXJEb2N1bWVudDtcbiAgICAgIGlmICghZG9jKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGRvY0VsZW0gPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgaWYgKCFqUXVlcnkuY29udGFpbnMoZG9jRWxlbSwgZWxlbSkpIHtcbiAgICAgICAgcmV0dXJuIGJveDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QgIT09IHN0cnVuZGVmaW5lZCkge1xuICAgICAgICBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgfVxuICAgICAgd2luID0gZ2V0V2luZG93KGRvYyk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3A6IGJveC50b3AgKyB3aW4ucGFnZVlPZmZzZXQgLSBkb2NFbGVtLmNsaWVudFRvcCxcbiAgICAgICAgbGVmdDogYm94LmxlZnQgKyB3aW4ucGFnZVhPZmZzZXQgLSBkb2NFbGVtLmNsaWVudExlZnRcbiAgICAgIH07XG4gICAgfSxcbiAgICBwb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXRoaXNbMF0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIG9mZnNldFBhcmVudCxcbiAgICAgICAgICBvZmZzZXQsXG4gICAgICAgICAgZWxlbSA9IHRoaXNbMF0sXG4gICAgICAgICAgcGFyZW50T2Zmc2V0ID0ge1xuICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgbGVmdDogMFxuICAgICAgICAgIH07XG4gICAgICBpZiAoalF1ZXJ5LmNzcyhlbGVtLCBcInBvc2l0aW9uXCIpID09PSBcImZpeGVkXCIpIHtcbiAgICAgICAgb2Zmc2V0ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9mZnNldFBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50KCk7XG4gICAgICAgIG9mZnNldCA9IHRoaXMub2Zmc2V0KCk7XG4gICAgICAgIGlmICghalF1ZXJ5Lm5vZGVOYW1lKG9mZnNldFBhcmVudFswXSwgXCJodG1sXCIpKSB7XG4gICAgICAgICAgcGFyZW50T2Zmc2V0ID0gb2Zmc2V0UGFyZW50Lm9mZnNldCgpO1xuICAgICAgICB9XG4gICAgICAgIHBhcmVudE9mZnNldC50b3AgKz0galF1ZXJ5LmNzcyhvZmZzZXRQYXJlbnRbMF0sIFwiYm9yZGVyVG9wV2lkdGhcIiwgdHJ1ZSk7XG4gICAgICAgIHBhcmVudE9mZnNldC5sZWZ0ICs9IGpRdWVyeS5jc3Mob2Zmc2V0UGFyZW50WzBdLCBcImJvcmRlckxlZnRXaWR0aFwiLCB0cnVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogb2Zmc2V0LnRvcCAtIHBhcmVudE9mZnNldC50b3AgLSBqUXVlcnkuY3NzKGVsZW0sIFwibWFyZ2luVG9wXCIsIHRydWUpLFxuICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdCAtIHBhcmVudE9mZnNldC5sZWZ0IC0galF1ZXJ5LmNzcyhlbGVtLCBcIm1hcmdpbkxlZnRcIiwgdHJ1ZSlcbiAgICAgIH07XG4gICAgfSxcbiAgICBvZmZzZXRQYXJlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQgfHwgZG9jRWxlbTtcbiAgICAgICAgd2hpbGUgKG9mZnNldFBhcmVudCAmJiAoIWpRdWVyeS5ub2RlTmFtZShvZmZzZXRQYXJlbnQsIFwiaHRtbFwiKSAmJiBqUXVlcnkuY3NzKG9mZnNldFBhcmVudCwgXCJwb3NpdGlvblwiKSA9PT0gXCJzdGF0aWNcIikpIHtcbiAgICAgICAgICBvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvZmZzZXRQYXJlbnQgfHwgZG9jRWxlbTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIGpRdWVyeS5lYWNoKHtcbiAgICBzY3JvbGxMZWZ0OiBcInBhZ2VYT2Zmc2V0XCIsXG4gICAgc2Nyb2xsVG9wOiBcInBhZ2VZT2Zmc2V0XCJcbiAgfSwgZnVuY3Rpb24obWV0aG9kLCBwcm9wKSB7XG4gICAgdmFyIHRvcCA9IFwicGFnZVlPZmZzZXRcIiA9PT0gcHJvcDtcbiAgICBqUXVlcnkuZm5bbWV0aG9kXSA9IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgcmV0dXJuIGFjY2Vzcyh0aGlzLCBmdW5jdGlvbihlbGVtLCBtZXRob2QsIHZhbCkge1xuICAgICAgICB2YXIgd2luID0gZ2V0V2luZG93KGVsZW0pO1xuICAgICAgICBpZiAodmFsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICByZXR1cm4gd2luID8gd2luW3Byb3BdIDogZWxlbVttZXRob2RdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3aW4pIHtcbiAgICAgICAgICB3aW4uc2Nyb2xsVG8oIXRvcCA/IHZhbCA6IHdpbmRvdy5wYWdlWE9mZnNldCwgdG9wID8gdmFsIDogd2luZG93LnBhZ2VZT2Zmc2V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbGVtW21ldGhvZF0gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH0sIG1ldGhvZCwgdmFsLCBhcmd1bWVudHMubGVuZ3RoLCBudWxsKTtcbiAgICB9O1xuICB9KTtcbiAgalF1ZXJ5LmVhY2goW1widG9wXCIsIFwibGVmdFwiXSwgZnVuY3Rpb24oaSwgcHJvcCkge1xuICAgIGpRdWVyeS5jc3NIb29rc1twcm9wXSA9IGFkZEdldEhvb2tJZihzdXBwb3J0LnBpeGVsUG9zaXRpb24sIGZ1bmN0aW9uKGVsZW0sIGNvbXB1dGVkKSB7XG4gICAgICBpZiAoY29tcHV0ZWQpIHtcbiAgICAgICAgY29tcHV0ZWQgPSBjdXJDU1MoZWxlbSwgcHJvcCk7XG4gICAgICAgIHJldHVybiBybnVtbm9ucHgudGVzdChjb21wdXRlZCkgPyBqUXVlcnkoZWxlbSkucG9zaXRpb24oKVtwcm9wXSArIFwicHhcIiA6IGNvbXB1dGVkO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgalF1ZXJ5LmVhY2goe1xuICAgIEhlaWdodDogXCJoZWlnaHRcIixcbiAgICBXaWR0aDogXCJ3aWR0aFwiXG4gIH0sIGZ1bmN0aW9uKG5hbWUsIHR5cGUpIHtcbiAgICBqUXVlcnkuZWFjaCh7XG4gICAgICBwYWRkaW5nOiBcImlubmVyXCIgKyBuYW1lLFxuICAgICAgY29udGVudDogdHlwZSxcbiAgICAgIFwiXCI6IFwib3V0ZXJcIiArIG5hbWVcbiAgICB9LCBmdW5jdGlvbihkZWZhdWx0RXh0cmEsIGZ1bmNOYW1lKSB7XG4gICAgICBqUXVlcnkuZm5bZnVuY05hbWVdID0gZnVuY3Rpb24obWFyZ2luLCB2YWx1ZSkge1xuICAgICAgICB2YXIgY2hhaW5hYmxlID0gYXJndW1lbnRzLmxlbmd0aCAmJiAoZGVmYXVsdEV4dHJhIHx8IHR5cGVvZiBtYXJnaW4gIT09IFwiYm9vbGVhblwiKSxcbiAgICAgICAgICAgIGV4dHJhID0gZGVmYXVsdEV4dHJhIHx8IChtYXJnaW4gPT09IHRydWUgfHwgdmFsdWUgPT09IHRydWUgPyBcIm1hcmdpblwiIDogXCJib3JkZXJcIik7XG4gICAgICAgIHJldHVybiBhY2Nlc3ModGhpcywgZnVuY3Rpb24oZWxlbSwgdHlwZSwgdmFsdWUpIHtcbiAgICAgICAgICB2YXIgZG9jO1xuICAgICAgICAgIGlmIChqUXVlcnkuaXNXaW5kb3coZWxlbSkpIHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFtcImNsaWVudFwiICsgbmFtZV07XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSA5KSB7XG4gICAgICAgICAgICBkb2MgPSBlbGVtLmRvY3VtZW50RWxlbWVudDtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChlbGVtLmJvZHlbXCJzY3JvbGxcIiArIG5hbWVdLCBkb2NbXCJzY3JvbGxcIiArIG5hbWVdLCBlbGVtLmJvZHlbXCJvZmZzZXRcIiArIG5hbWVdLCBkb2NbXCJvZmZzZXRcIiArIG5hbWVdLCBkb2NbXCJjbGllbnRcIiArIG5hbWVdKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPyBqUXVlcnkuY3NzKGVsZW0sIHR5cGUsIGV4dHJhKSA6IGpRdWVyeS5zdHlsZShlbGVtLCB0eXBlLCB2YWx1ZSwgZXh0cmEpO1xuICAgICAgICB9LCB0eXBlLCBjaGFpbmFibGUgPyBtYXJnaW4gOiB1bmRlZmluZWQsIGNoYWluYWJsZSwgbnVsbCk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9KTtcbiAgalF1ZXJ5LmZuLnNpemUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5sZW5ndGg7XG4gIH07XG4gIGpRdWVyeS5mbi5hbmRTZWxmID0galF1ZXJ5LmZuLmFkZEJhY2s7XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShcImpxdWVyeVwiLCBbXSwgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4galF1ZXJ5O1xuICAgIH0pO1xuICB9XG4gIHZhciBfalF1ZXJ5ID0gd2luZG93LmpRdWVyeSxcbiAgICAgIF8kID0gd2luZG93LiQ7XG4gIGpRdWVyeS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24oZGVlcCkge1xuICAgIGlmICh3aW5kb3cuJCA9PT0galF1ZXJ5KSB7XG4gICAgICB3aW5kb3cuJCA9IF8kO1xuICAgIH1cbiAgICBpZiAoZGVlcCAmJiB3aW5kb3cualF1ZXJ5ID09PSBqUXVlcnkpIHtcbiAgICAgIHdpbmRvdy5qUXVlcnkgPSBfalF1ZXJ5O1xuICAgIH1cbiAgICByZXR1cm4galF1ZXJ5O1xuICB9O1xuICBpZiAodHlwZW9mIG5vR2xvYmFsID09PSBzdHJ1bmRlZmluZWQpIHtcbiAgICB3aW5kb3cualF1ZXJ5ID0gd2luZG93LiQgPSBqUXVlcnk7XG4gIH1cbiAgcmV0dXJuIGpRdWVyeTtcbn0pKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3RyYWNldXItbG9hZGVyP3NvdXJjZU1hcHM9ZmFsc2Umc2NyaXB0IS4vYm93ZXJfY29tcG9uZW50cy9qcXVlcnkvZGlzdC9qcXVlcnkuanNcbiAqKiBtb2R1bGUgaWQgPSAxNVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiIWZ1bmN0aW9uKGUpIHtcbiAgaWYgKFwib2JqZWN0XCIgPT0gdHlwZW9mIGV4cG9ydHMgJiYgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgbW9kdWxlKVxuICAgIG1vZHVsZS5leHBvcnRzID0gZSgpO1xuICBlbHNlIGlmIChcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kKVxuICAgIGRlZmluZShbXSwgZSk7XG4gIGVsc2Uge1xuICAgIHZhciBmO1xuICAgIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyA/IGYgPSB3aW5kb3cgOiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBnbG9iYWwgPyBmID0gZ2xvYmFsIDogXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2Ygc2VsZiAmJiAoZiA9IHNlbGYpLCBmLlByb21pc2UgPSBlKCk7XG4gIH1cbn0oZnVuY3Rpb24oKSB7XG4gIHZhciBkZWZpbmUsXG4gICAgICBtb2R1bGUsXG4gICAgICBleHBvcnRzO1xuICByZXR1cm4gKGZ1bmN0aW9uIGUodCwgbiwgcikge1xuICAgIGZ1bmN0aW9uIHMobywgdSkge1xuICAgICAgaWYgKCFuW29dKSB7XG4gICAgICAgIGlmICghdFtvXSkge1xuICAgICAgICAgIHZhciBhID0gdHlwZW9mIF9kZXJlcV8gPT0gXCJmdW5jdGlvblwiICYmIF9kZXJlcV87XG4gICAgICAgICAgaWYgKCF1ICYmIGEpXG4gICAgICAgICAgICByZXR1cm4gYShvLCAhMCk7XG4gICAgICAgICAgaWYgKGkpXG4gICAgICAgICAgICByZXR1cm4gaShvLCAhMCk7XG4gICAgICAgICAgdmFyIGYgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgbyArIFwiJ1wiKTtcbiAgICAgICAgICB0aHJvdyBmLmNvZGUgPSBcIk1PRFVMRV9OT1RfRk9VTkRcIiwgZjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbCA9IG5bb10gPSB7ZXhwb3J0czoge319O1xuICAgICAgICB0W29dWzBdLmNhbGwobC5leHBvcnRzLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgdmFyIG4gPSB0W29dWzFdW2VdO1xuICAgICAgICAgIHJldHVybiBzKG4gPyBuIDogZSk7XG4gICAgICAgIH0sIGwsIGwuZXhwb3J0cywgZSwgdCwgbiwgcik7XG4gICAgICB9XG4gICAgICByZXR1cm4gbltvXS5leHBvcnRzO1xuICAgIH1cbiAgICB2YXIgaSA9IHR5cGVvZiBfZGVyZXFfID09IFwiZnVuY3Rpb25cIiAmJiBfZGVyZXFfO1xuICAgIGZvciAodmFyIG8gPSAwOyBvIDwgci5sZW5ndGg7IG8rKylcbiAgICAgIHMocltvXSk7XG4gICAgcmV0dXJuIHM7XG4gIH0pKHtcbiAgICAxOiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xuICAgICAgICB2YXIgU29tZVByb21pc2VBcnJheSA9IFByb21pc2UuX1NvbWVQcm9taXNlQXJyYXk7XG4gICAgICAgIGZ1bmN0aW9uIGFueShwcm9taXNlcykge1xuICAgICAgICAgIHZhciByZXQgPSBuZXcgU29tZVByb21pc2VBcnJheShwcm9taXNlcyk7XG4gICAgICAgICAgdmFyIHByb21pc2UgPSByZXQucHJvbWlzZSgpO1xuICAgICAgICAgIHJldC5zZXRIb3dNYW55KDEpO1xuICAgICAgICAgIHJldC5zZXRVbndyYXAoKTtcbiAgICAgICAgICByZXQuaW5pdCgpO1xuICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIFByb21pc2UuYW55ID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgICAgICAgICByZXR1cm4gYW55KHByb21pc2VzKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuYW55ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGFueSh0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge31dLFxuICAgIDI6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgdmFyIGZpcnN0TGluZUVycm9yO1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGZpcnN0TGluZUVycm9yID0gZTtcbiAgICAgIH1cbiAgICAgIHZhciBzY2hlZHVsZSA9IF9kZXJlcV8oXCIuL3NjaGVkdWxlLmpzXCIpO1xuICAgICAgdmFyIFF1ZXVlID0gX2RlcmVxXyhcIi4vcXVldWUuanNcIik7XG4gICAgICB2YXIgX3Byb2Nlc3MgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiA/IHByb2Nlc3MgOiB1bmRlZmluZWQ7XG4gICAgICBmdW5jdGlvbiBBc3luYygpIHtcbiAgICAgICAgdGhpcy5faXNUaWNrVXNlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9sYXRlUXVldWUgPSBuZXcgUXVldWUoMTYpO1xuICAgICAgICB0aGlzLl9ub3JtYWxRdWV1ZSA9IG5ldyBRdWV1ZSgxNik7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5kcmFpblF1ZXVlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNlbGYuX2RyYWluUXVldWVzKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlID0gc2NoZWR1bGUuaXNTdGF0aWMgPyBzY2hlZHVsZSh0aGlzLmRyYWluUXVldWVzKSA6IHNjaGVkdWxlO1xuICAgICAgfVxuICAgICAgQXN5bmMucHJvdG90eXBlLmhhdmVJdGVtc1F1ZXVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbm9ybWFsUXVldWUubGVuZ3RoKCkgPiAwO1xuICAgICAgfTtcbiAgICAgIEFzeW5jLnByb3RvdHlwZS5fd2l0aERvbWFpbiA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgIGlmIChfcHJvY2VzcyAhPT0gdW5kZWZpbmVkICYmIF9wcm9jZXNzLmRvbWFpbiAhPSBudWxsICYmICFmbi5kb21haW4pIHtcbiAgICAgICAgICBmbiA9IF9wcm9jZXNzLmRvbWFpbi5iaW5kKGZuKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZm47XG4gICAgICB9O1xuICAgICAgQXN5bmMucHJvdG90eXBlLnRocm93TGF0ZXIgPSBmdW5jdGlvbihmbiwgYXJnKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgYXJnID0gZm47XG4gICAgICAgICAgZm4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRocm93IGFyZztcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGZuID0gdGhpcy5fd2l0aERvbWFpbihmbik7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBmbihhcmcpO1xuICAgICAgICAgIH0sIDApO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGZuKGFyZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhc3luYyBzY2hlZHVsZXIgYXZhaWxhYmxlXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvbTNPVFhrXFx1MDAwYVwiKTtcbiAgICAgICAgICB9XG4gICAgICB9O1xuICAgICAgQXN5bmMucHJvdG90eXBlLmludm9rZUxhdGVyID0gZnVuY3Rpb24oZm4sIHJlY2VpdmVyLCBhcmcpIHtcbiAgICAgICAgZm4gPSB0aGlzLl93aXRoRG9tYWluKGZuKTtcbiAgICAgICAgdGhpcy5fbGF0ZVF1ZXVlLnB1c2goZm4sIHJlY2VpdmVyLCBhcmcpO1xuICAgICAgICB0aGlzLl9xdWV1ZVRpY2soKTtcbiAgICAgIH07XG4gICAgICBBc3luYy5wcm90b3R5cGUuaW52b2tlRmlyc3QgPSBmdW5jdGlvbihmbiwgcmVjZWl2ZXIsIGFyZykge1xuICAgICAgICBmbiA9IHRoaXMuX3dpdGhEb21haW4oZm4pO1xuICAgICAgICB0aGlzLl9ub3JtYWxRdWV1ZS51bnNoaWZ0KGZuLCByZWNlaXZlciwgYXJnKTtcbiAgICAgICAgdGhpcy5fcXVldWVUaWNrKCk7XG4gICAgICB9O1xuICAgICAgQXN5bmMucHJvdG90eXBlLmludm9rZSA9IGZ1bmN0aW9uKGZuLCByZWNlaXZlciwgYXJnKSB7XG4gICAgICAgIGZuID0gdGhpcy5fd2l0aERvbWFpbihmbik7XG4gICAgICAgIHRoaXMuX25vcm1hbFF1ZXVlLnB1c2goZm4sIHJlY2VpdmVyLCBhcmcpO1xuICAgICAgICB0aGlzLl9xdWV1ZVRpY2soKTtcbiAgICAgIH07XG4gICAgICBBc3luYy5wcm90b3R5cGUuc2V0dGxlUHJvbWlzZXMgPSBmdW5jdGlvbihwcm9taXNlKSB7XG4gICAgICAgIHRoaXMuX25vcm1hbFF1ZXVlLl9wdXNoT25lKHByb21pc2UpO1xuICAgICAgICB0aGlzLl9xdWV1ZVRpY2soKTtcbiAgICAgIH07XG4gICAgICBBc3luYy5wcm90b3R5cGUuX2RyYWluUXVldWUgPSBmdW5jdGlvbihxdWV1ZSkge1xuICAgICAgICB3aGlsZSAocXVldWUubGVuZ3RoKCkgPiAwKSB7XG4gICAgICAgICAgdmFyIGZuID0gcXVldWUuc2hpZnQoKTtcbiAgICAgICAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGZuLl9zZXR0bGVQcm9taXNlcygpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByZWNlaXZlciA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgdmFyIGFyZyA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgZm4uY2FsbChyZWNlaXZlciwgYXJnKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEFzeW5jLnByb3RvdHlwZS5fZHJhaW5RdWV1ZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fZHJhaW5RdWV1ZSh0aGlzLl9ub3JtYWxRdWV1ZSk7XG4gICAgICAgIHRoaXMuX3Jlc2V0KCk7XG4gICAgICAgIHRoaXMuX2RyYWluUXVldWUodGhpcy5fbGF0ZVF1ZXVlKTtcbiAgICAgIH07XG4gICAgICBBc3luYy5wcm90b3R5cGUuX3F1ZXVlVGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2lzVGlja1VzZWQpIHtcbiAgICAgICAgICB0aGlzLl9pc1RpY2tVc2VkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLl9zY2hlZHVsZSh0aGlzLmRyYWluUXVldWVzKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIEFzeW5jLnByb3RvdHlwZS5fcmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5faXNUaWNrVXNlZCA9IGZhbHNlO1xuICAgICAgfTtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gbmV3IEFzeW5jKCk7XG4gICAgICBtb2R1bGUuZXhwb3J0cy5maXJzdExpbmVFcnJvciA9IGZpcnN0TGluZUVycm9yO1xuICAgIH0sIHtcbiAgICAgIFwiLi9xdWV1ZS5qc1wiOiAyOCxcbiAgICAgIFwiLi9zY2hlZHVsZS5qc1wiOiAzMVxuICAgIH1dLFxuICAgIDM6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCwgdHJ5Q29udmVydFRvUHJvbWlzZSkge1xuICAgICAgICB2YXIgcmVqZWN0VGhpcyA9IGZ1bmN0aW9uKF8sIGUpIHtcbiAgICAgICAgICB0aGlzLl9yZWplY3QoZSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0YXJnZXRSZWplY3RlZCA9IGZ1bmN0aW9uKGUsIGNvbnRleHQpIHtcbiAgICAgICAgICBjb250ZXh0LnByb21pc2VSZWplY3Rpb25RdWV1ZWQgPSB0cnVlO1xuICAgICAgICAgIGNvbnRleHQuYmluZGluZ1Byb21pc2UuX3RoZW4ocmVqZWN0VGhpcywgcmVqZWN0VGhpcywgbnVsbCwgdGhpcywgZSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBiaW5kaW5nUmVzb2x2ZWQgPSBmdW5jdGlvbih0aGlzQXJnLCBjb250ZXh0KSB7XG4gICAgICAgICAgdGhpcy5fc2V0Qm91bmRUbyh0aGlzQXJnKTtcbiAgICAgICAgICBpZiAodGhpcy5faXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmVDYWxsYmFjayhjb250ZXh0LnRhcmdldCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgYmluZGluZ1JlamVjdGVkID0gZnVuY3Rpb24oZSwgY29udGV4dCkge1xuICAgICAgICAgIGlmICghY29udGV4dC5wcm9taXNlUmVqZWN0aW9uUXVldWVkKVxuICAgICAgICAgICAgdGhpcy5fcmVqZWN0KGUpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24odGhpc0FyZykge1xuICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKHRoaXNBcmcpO1xuICAgICAgICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgcmV0Ll9wcm9wYWdhdGVGcm9tKHRoaXMsIDEpO1xuICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLl90YXJnZXQoKTtcbiAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB7XG4gICAgICAgICAgICAgIHByb21pc2VSZWplY3Rpb25RdWV1ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICBwcm9taXNlOiByZXQsXG4gICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxuICAgICAgICAgICAgICBiaW5kaW5nUHJvbWlzZTogbWF5YmVQcm9taXNlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGFyZ2V0Ll90aGVuKElOVEVSTkFMLCB0YXJnZXRSZWplY3RlZCwgcmV0Ll9wcm9ncmVzcywgcmV0LCBjb250ZXh0KTtcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdGhlbihiaW5kaW5nUmVzb2x2ZWQsIGJpbmRpbmdSZWplY3RlZCwgcmV0Ll9wcm9ncmVzcywgcmV0LCBjb250ZXh0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0Ll9zZXRCb3VuZFRvKHRoaXNBcmcpO1xuICAgICAgICAgICAgcmV0Ll9yZXNvbHZlQ2FsbGJhY2sodGFyZ2V0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldEJvdW5kVG8gPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICBpZiAob2JqICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAxMzEwNzI7XG4gICAgICAgICAgICB0aGlzLl9ib3VuZFRvID0gb2JqO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH4xMzEwNzIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2lzQm91bmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMTMxMDcyKSA9PT0gMTMxMDcyO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLmJpbmQgPSBmdW5jdGlvbih0aGlzQXJnLCB2YWx1ZSkge1xuICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKHRoaXNBcmcpO1xuICAgICAgICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdGhlbihmdW5jdGlvbih0aGlzQXJnKSB7XG4gICAgICAgICAgICAgIHJldC5fc2V0Qm91bmRUbyh0aGlzQXJnKTtcbiAgICAgICAgICAgICAgcmV0Ll9yZXNvbHZlQ2FsbGJhY2sodmFsdWUpO1xuICAgICAgICAgICAgfSwgcmV0Ll9yZWplY3QsIHJldC5fcHJvZ3Jlc3MsIHJldCwgbnVsbCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldC5fc2V0Qm91bmRUbyh0aGlzQXJnKTtcbiAgICAgICAgICAgIHJldC5fcmVzb2x2ZUNhbGxiYWNrKHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge31dLFxuICAgIDQ6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgdmFyIG9sZDtcbiAgICAgIGlmICh0eXBlb2YgUHJvbWlzZSAhPT0gXCJ1bmRlZmluZWRcIilcbiAgICAgICAgb2xkID0gUHJvbWlzZTtcbiAgICAgIGZ1bmN0aW9uIG5vQ29uZmxpY3QoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKFByb21pc2UgPT09IGJsdWViaXJkKVxuICAgICAgICAgICAgUHJvbWlzZSA9IG9sZDtcbiAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgcmV0dXJuIGJsdWViaXJkO1xuICAgICAgfVxuICAgICAgdmFyIGJsdWViaXJkID0gX2RlcmVxXyhcIi4vcHJvbWlzZS5qc1wiKSgpO1xuICAgICAgYmx1ZWJpcmQubm9Db25mbGljdCA9IG5vQ29uZmxpY3Q7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGJsdWViaXJkO1xuICAgIH0sIHtcIi4vcHJvbWlzZS5qc1wiOiAyM31dLFxuICAgIDU6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgdmFyIGNyID0gT2JqZWN0LmNyZWF0ZTtcbiAgICAgIGlmIChjcikge1xuICAgICAgICB2YXIgY2FsbGVyQ2FjaGUgPSBjcihudWxsKTtcbiAgICAgICAgdmFyIGdldHRlckNhY2hlID0gY3IobnVsbCk7XG4gICAgICAgIGNhbGxlckNhY2hlW1wiIHNpemVcIl0gPSBnZXR0ZXJDYWNoZVtcIiBzaXplXCJdID0gMDtcbiAgICAgIH1cbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xuICAgICAgICB2YXIgdXRpbCA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIik7XG4gICAgICAgIHZhciBjYW5FdmFsdWF0ZSA9IHV0aWwuY2FuRXZhbHVhdGU7XG4gICAgICAgIHZhciBpc0lkZW50aWZpZXIgPSB1dGlsLmlzSWRlbnRpZmllcjtcbiAgICAgICAgdmFyIGdldE1ldGhvZENhbGxlcjtcbiAgICAgICAgdmFyIGdldEdldHRlcjtcbiAgICAgICAgaWYgKCF0cnVlKSB7XG4gICAgICAgICAgdmFyIG1ha2VNZXRob2RDYWxsZXIgPSBmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwiZW5zdXJlTWV0aG9kXCIsIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBsZW4gPSB0aGlzLmxlbmd0aDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGVuc3VyZU1ldGhvZChvYmosICdtZXRob2ROYW1lJyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHN3aXRjaChsZW4pIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBvYmoubWV0aG9kTmFtZSh0aGlzWzBdKTsgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBvYmoubWV0aG9kTmFtZSh0aGlzWzBdLCB0aGlzWzFdKTsgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBvYmoubWV0aG9kTmFtZSh0aGlzWzBdLCB0aGlzWzFdLCB0aGlzWzJdKTsgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBvYmoubWV0aG9kTmFtZSgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5tZXRob2ROYW1lLmFwcGx5KG9iaiwgdGhpcyk7ICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgfTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgXCIucmVwbGFjZSgvbWV0aG9kTmFtZS9nLCBtZXRob2ROYW1lKSkoZW5zdXJlTWV0aG9kKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciBtYWtlR2V0dGVyID0gZnVuY3Rpb24ocHJvcGVydHlOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwib2JqXCIsIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgJ3VzZSBzdHJpY3QnOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgcmV0dXJuIG9iai5wcm9wZXJ0eU5hbWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgXCIucmVwbGFjZShcInByb3BlcnR5TmFtZVwiLCBwcm9wZXJ0eU5hbWUpKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciBnZXRDb21waWxlZCA9IGZ1bmN0aW9uKG5hbWUsIGNvbXBpbGVyLCBjYWNoZSkge1xuICAgICAgICAgICAgdmFyIHJldCA9IGNhY2hlW25hbWVdO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiByZXQgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICBpZiAoIWlzSWRlbnRpZmllcihuYW1lKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldCA9IGNvbXBpbGVyKG5hbWUpO1xuICAgICAgICAgICAgICBjYWNoZVtuYW1lXSA9IHJldDtcbiAgICAgICAgICAgICAgY2FjaGVbXCIgc2l6ZVwiXSsrO1xuICAgICAgICAgICAgICBpZiAoY2FjaGVbXCIgc2l6ZVwiXSA+IDUxMikge1xuICAgICAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoY2FjaGUpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyArK2kpXG4gICAgICAgICAgICAgICAgICBkZWxldGUgY2FjaGVba2V5c1tpXV07XG4gICAgICAgICAgICAgICAgY2FjaGVbXCIgc2l6ZVwiXSA9IGtleXMubGVuZ3RoIC0gMjU2O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgIH07XG4gICAgICAgICAgZ2V0TWV0aG9kQ2FsbGVyID0gZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGdldENvbXBpbGVkKG5hbWUsIG1ha2VNZXRob2RDYWxsZXIsIGNhbGxlckNhY2hlKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIGdldEdldHRlciA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRDb21waWxlZChuYW1lLCBtYWtlR2V0dGVyLCBnZXR0ZXJDYWNoZSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBlbnN1cmVNZXRob2Qob2JqLCBtZXRob2ROYW1lKSB7XG4gICAgICAgICAgdmFyIGZuO1xuICAgICAgICAgIGlmIChvYmogIT0gbnVsbClcbiAgICAgICAgICAgIGZuID0gb2JqW21ldGhvZE5hbWVdO1xuICAgICAgICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIk9iamVjdCBcIiArIHV0aWwuY2xhc3NTdHJpbmcob2JqKSArIFwiIGhhcyBubyBtZXRob2QgJ1wiICsgdXRpbC50b1N0cmluZyhtZXRob2ROYW1lKSArIFwiJ1wiO1xuICAgICAgICAgICAgdGhyb3cgbmV3IFByb21pc2UuVHlwZUVycm9yKG1lc3NhZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZm47XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2FsbGVyKG9iaikge1xuICAgICAgICAgIHZhciBtZXRob2ROYW1lID0gdGhpcy5wb3AoKTtcbiAgICAgICAgICB2YXIgZm4gPSBlbnN1cmVNZXRob2Qob2JqLCBtZXRob2ROYW1lKTtcbiAgICAgICAgICByZXR1cm4gZm4uYXBwbHkob2JqLCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgICAgICAgIHZhciAkX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoJF9sZW4gLSAxKTtcbiAgICAgICAgICBmb3IgKHZhciAkX2kgPSAxOyAkX2kgPCAkX2xlbjsgKyskX2kpIHtcbiAgICAgICAgICAgIGFyZ3NbJF9pIC0gMV0gPSBhcmd1bWVudHNbJF9pXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCF0cnVlKSB7XG4gICAgICAgICAgICBpZiAoY2FuRXZhbHVhdGUpIHtcbiAgICAgICAgICAgICAgdmFyIG1heWJlQ2FsbGVyID0gZ2V0TWV0aG9kQ2FsbGVyKG1ldGhvZE5hbWUpO1xuICAgICAgICAgICAgICBpZiAobWF5YmVDYWxsZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdGhlbihtYXliZUNhbGxlciwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGFyZ3MsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYXJncy5wdXNoKG1ldGhvZE5hbWUpO1xuICAgICAgICAgIHJldHVybiB0aGlzLl90aGVuKGNhbGxlciwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGFyZ3MsIHVuZGVmaW5lZCk7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIG5hbWVkR2V0dGVyKG9iaikge1xuICAgICAgICAgIHJldHVybiBvYmpbdGhpc107XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaW5kZXhlZEdldHRlcihvYmopIHtcbiAgICAgICAgICB2YXIgaW5kZXggPSArdGhpcztcbiAgICAgICAgICBpZiAoaW5kZXggPCAwKVxuICAgICAgICAgICAgaW5kZXggPSBNYXRoLm1heCgwLCBpbmRleCArIG9iai5sZW5ndGgpO1xuICAgICAgICAgIHJldHVybiBvYmpbaW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKHByb3BlcnR5TmFtZSkge1xuICAgICAgICAgIHZhciBpc0luZGV4ID0gKHR5cGVvZiBwcm9wZXJ0eU5hbWUgPT09IFwibnVtYmVyXCIpO1xuICAgICAgICAgIHZhciBnZXR0ZXI7XG4gICAgICAgICAgaWYgKCFpc0luZGV4KSB7XG4gICAgICAgICAgICBpZiAoY2FuRXZhbHVhdGUpIHtcbiAgICAgICAgICAgICAgdmFyIG1heWJlR2V0dGVyID0gZ2V0R2V0dGVyKHByb3BlcnR5TmFtZSk7XG4gICAgICAgICAgICAgIGdldHRlciA9IG1heWJlR2V0dGVyICE9PSBudWxsID8gbWF5YmVHZXR0ZXIgOiBuYW1lZEdldHRlcjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGdldHRlciA9IG5hbWVkR2V0dGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZXR0ZXIgPSBpbmRleGVkR2V0dGVyO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcy5fdGhlbihnZXR0ZXIsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBwcm9wZXJ0eU5hbWUsIHVuZGVmaW5lZCk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0sIHtcIi4vdXRpbC5qc1wiOiAzOH1dLFxuICAgIDY6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlKSB7XG4gICAgICAgIHZhciBlcnJvcnMgPSBfZGVyZXFfKFwiLi9lcnJvcnMuanNcIik7XG4gICAgICAgIHZhciBhc3luYyA9IF9kZXJlcV8oXCIuL2FzeW5jLmpzXCIpO1xuICAgICAgICB2YXIgQ2FuY2VsbGF0aW9uRXJyb3IgPSBlcnJvcnMuQ2FuY2VsbGF0aW9uRXJyb3I7XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9jYW5jZWwgPSBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICBpZiAoIXRoaXMuaXNDYW5jZWxsYWJsZSgpKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgdmFyIHBhcmVudDtcbiAgICAgICAgICB2YXIgcHJvbWlzZVRvUmVqZWN0ID0gdGhpcztcbiAgICAgICAgICB3aGlsZSAoKHBhcmVudCA9IHByb21pc2VUb1JlamVjdC5fY2FuY2VsbGF0aW9uUGFyZW50KSAhPT0gdW5kZWZpbmVkICYmIHBhcmVudC5pc0NhbmNlbGxhYmxlKCkpIHtcbiAgICAgICAgICAgIHByb21pc2VUb1JlamVjdCA9IHBhcmVudDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5fdW5zZXRDYW5jZWxsYWJsZSgpO1xuICAgICAgICAgIHByb21pc2VUb1JlamVjdC5fdGFyZ2V0KCkuX3JlamVjdENhbGxiYWNrKHJlYXNvbiwgZmFsc2UsIHRydWUpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICBpZiAoIXRoaXMuaXNDYW5jZWxsYWJsZSgpKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgaWYgKHJlYXNvbiA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmVhc29uID0gbmV3IENhbmNlbGxhdGlvbkVycm9yKCk7XG4gICAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhpcy5fY2FuY2VsLCB0aGlzLCByZWFzb24pO1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5jYW5jZWxsYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh0aGlzLl9jYW5jZWxsYWJsZSgpKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgdGhpcy5fc2V0Q2FuY2VsbGFibGUoKTtcbiAgICAgICAgICB0aGlzLl9jYW5jZWxsYXRpb25QYXJlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLnVuY2FuY2VsbGFibGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgcmV0ID0gdGhpcy50aGVuKCk7XG4gICAgICAgICAgcmV0Ll91bnNldENhbmNlbGxhYmxlKCk7XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuZm9yayA9IGZ1bmN0aW9uKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MpIHtcbiAgICAgICAgICB2YXIgcmV0ID0gdGhpcy5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLCB1bmRlZmluZWQsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgcmV0Ll9zZXRDYW5jZWxsYWJsZSgpO1xuICAgICAgICAgIHJldC5fY2FuY2VsbGF0aW9uUGFyZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0sIHtcbiAgICAgIFwiLi9hc3luYy5qc1wiOiAyLFxuICAgICAgXCIuL2Vycm9ycy5qc1wiOiAxM1xuICAgIH1dLFxuICAgIDc6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFzeW5jID0gX2RlcmVxXyhcIi4vYXN5bmMuanNcIik7XG4gICAgICAgIHZhciB1dGlsID0gX2RlcmVxXyhcIi4vdXRpbC5qc1wiKTtcbiAgICAgICAgdmFyIGJsdWViaXJkRnJhbWVQYXR0ZXJuID0gL1tcXFxcXFwvXWJsdWViaXJkW1xcXFxcXC9danNbXFxcXFxcL10obWFpbnxkZWJ1Z3x6YWxnb3xpbnN0cnVtZW50ZWQpLztcbiAgICAgICAgdmFyIHN0YWNrRnJhbWVQYXR0ZXJuID0gbnVsbDtcbiAgICAgICAgdmFyIGZvcm1hdFN0YWNrID0gbnVsbDtcbiAgICAgICAgdmFyIGluZGVudFN0YWNrRnJhbWVzID0gZmFsc2U7XG4gICAgICAgIHZhciB3YXJuO1xuICAgICAgICBmdW5jdGlvbiBDYXB0dXJlZFRyYWNlKHBhcmVudCkge1xuICAgICAgICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcbiAgICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5fbGVuZ3RoID0gMSArIChwYXJlbnQgPT09IHVuZGVmaW5lZCA/IDAgOiBwYXJlbnQuX2xlbmd0aCk7XG4gICAgICAgICAgY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgQ2FwdHVyZWRUcmFjZSk7XG4gICAgICAgICAgaWYgKGxlbmd0aCA+IDMyKVxuICAgICAgICAgICAgdGhpcy51bmN5Y2xlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdXRpbC5pbmhlcml0cyhDYXB0dXJlZFRyYWNlLCBFcnJvcik7XG4gICAgICAgIENhcHR1cmVkVHJhY2UucHJvdG90eXBlLnVuY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5fbGVuZ3RoO1xuICAgICAgICAgIGlmIChsZW5ndGggPCAyKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIHZhciBub2RlcyA9IFtdO1xuICAgICAgICAgIHZhciBzdGFja1RvSW5kZXggPSB7fTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgICAgICAgbm9kZSA9IHRoaXM7IG5vZGUgIT09IHVuZGVmaW5lZDsgKytpKSB7XG4gICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgbm9kZSA9IG5vZGUuX3BhcmVudDtcbiAgICAgICAgICB9XG4gICAgICAgICAgbGVuZ3RoID0gdGhpcy5fbGVuZ3RoID0gaTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gbGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgICAgIHZhciBzdGFjayA9IG5vZGVzW2ldLnN0YWNrO1xuICAgICAgICAgICAgaWYgKHN0YWNrVG9JbmRleFtzdGFja10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICBzdGFja1RvSW5kZXhbc3RhY2tdID0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGFjayA9IG5vZGVzW2ldLnN0YWNrO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gc3RhY2tUb0luZGV4W2N1cnJlbnRTdGFja107XG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCAmJiBpbmRleCAhPT0gaSkge1xuICAgICAgICAgICAgICBpZiAoaW5kZXggPiAwKSB7XG4gICAgICAgICAgICAgICAgbm9kZXNbaW5kZXggLSAxXS5fcGFyZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIG5vZGVzW2luZGV4IC0gMV0uX2xlbmd0aCA9IDE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgbm9kZXNbaV0uX3BhcmVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgbm9kZXNbaV0uX2xlbmd0aCA9IDE7XG4gICAgICAgICAgICAgIHZhciBjeWNsZUVkZ2VOb2RlID0gaSA+IDAgPyBub2Rlc1tpIC0gMV0gOiB0aGlzO1xuICAgICAgICAgICAgICBpZiAoaW5kZXggPCBsZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgY3ljbGVFZGdlTm9kZS5fcGFyZW50ID0gbm9kZXNbaW5kZXggKyAxXTtcbiAgICAgICAgICAgICAgICBjeWNsZUVkZ2VOb2RlLl9wYXJlbnQudW5jeWNsZSgpO1xuICAgICAgICAgICAgICAgIGN5Y2xlRWRnZU5vZGUuX2xlbmd0aCA9IGN5Y2xlRWRnZU5vZGUuX3BhcmVudC5fbGVuZ3RoICsgMTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjeWNsZUVkZ2VOb2RlLl9wYXJlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgY3ljbGVFZGdlTm9kZS5fbGVuZ3RoID0gMTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgY3VycmVudENoaWxkTGVuZ3RoID0gY3ljbGVFZGdlTm9kZS5fbGVuZ3RoICsgMTtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IGkgLSAyOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgICAgIG5vZGVzW2pdLl9sZW5ndGggPSBjdXJyZW50Q2hpbGRMZW5ndGg7XG4gICAgICAgICAgICAgICAgY3VycmVudENoaWxkTGVuZ3RoKys7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ2FwdHVyZWRUcmFjZS5wcm90b3R5cGUucGFyZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3BhcmVudDtcbiAgICAgICAgfTtcbiAgICAgICAgQ2FwdHVyZWRUcmFjZS5wcm90b3R5cGUuaGFzUGFyZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3BhcmVudCAhPT0gdW5kZWZpbmVkO1xuICAgICAgICB9O1xuICAgICAgICBDYXB0dXJlZFRyYWNlLnByb3RvdHlwZS5hdHRhY2hFeHRyYVRyYWNlID0gZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IuX19zdGFja0NsZWFuZWRfXylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB0aGlzLnVuY3ljbGUoKTtcbiAgICAgICAgICB2YXIgcGFyc2VkID0gQ2FwdHVyZWRUcmFjZS5wYXJzZVN0YWNrQW5kTWVzc2FnZShlcnJvcik7XG4gICAgICAgICAgdmFyIG1lc3NhZ2UgPSBwYXJzZWQubWVzc2FnZTtcbiAgICAgICAgICB2YXIgc3RhY2tzID0gW3BhcnNlZC5zdGFja107XG4gICAgICAgICAgdmFyIHRyYWNlID0gdGhpcztcbiAgICAgICAgICB3aGlsZSAodHJhY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc3RhY2tzLnB1c2goY2xlYW5TdGFjayh0cmFjZS5zdGFjay5zcGxpdChcIlxcblwiKSkpO1xuICAgICAgICAgICAgdHJhY2UgPSB0cmFjZS5fcGFyZW50O1xuICAgICAgICAgIH1cbiAgICAgICAgICByZW1vdmVDb21tb25Sb290cyhzdGFja3MpO1xuICAgICAgICAgIHJlbW92ZUR1cGxpY2F0ZU9yRW1wdHlKdW1wcyhzdGFja3MpO1xuICAgICAgICAgIGVycm9yLnN0YWNrID0gcmVjb25zdHJ1Y3RTdGFjayhtZXNzYWdlLCBzdGFja3MpO1xuICAgICAgICAgIHV0aWwubm90RW51bWVyYWJsZVByb3AoZXJyb3IsIFwiX19zdGFja0NsZWFuZWRfX1wiLCB0cnVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgZnVuY3Rpb24gcmVjb25zdHJ1Y3RTdGFjayhtZXNzYWdlLCBzdGFja3MpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0YWNrcy5sZW5ndGggLSAxOyArK2kpIHtcbiAgICAgICAgICAgIHN0YWNrc1tpXS5wdXNoKFwiRnJvbSBwcmV2aW91cyBldmVudDpcIik7XG4gICAgICAgICAgICBzdGFja3NbaV0gPSBzdGFja3NbaV0uam9pbihcIlxcblwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGkgPCBzdGFja3MubGVuZ3RoKSB7XG4gICAgICAgICAgICBzdGFja3NbaV0gPSBzdGFja3NbaV0uam9pbihcIlxcblwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG1lc3NhZ2UgKyBcIlxcblwiICsgc3RhY2tzLmpvaW4oXCJcXG5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlRHVwbGljYXRlT3JFbXB0eUp1bXBzKHN0YWNrcykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RhY2tzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBpZiAoc3RhY2tzW2ldLmxlbmd0aCA9PT0gMCB8fCAoKGkgKyAxIDwgc3RhY2tzLmxlbmd0aCkgJiYgc3RhY2tzW2ldWzBdID09PSBzdGFja3NbaSArIDFdWzBdKSkge1xuICAgICAgICAgICAgICBzdGFja3Muc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICBpLS07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZUNvbW1vblJvb3RzKHN0YWNrcykge1xuICAgICAgICAgIHZhciBjdXJyZW50ID0gc3RhY2tzWzBdO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc3RhY2tzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgcHJldiA9IHN0YWNrc1tpXTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50TGFzdEluZGV4ID0gY3VycmVudC5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRMYXN0TGluZSA9IGN1cnJlbnRbY3VycmVudExhc3RJbmRleF07XG4gICAgICAgICAgICB2YXIgY29tbW9uUm9vdE1lZXRQb2ludCA9IC0xO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IHByZXYubGVuZ3RoIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgICAgaWYgKHByZXZbal0gPT09IGN1cnJlbnRMYXN0TGluZSkge1xuICAgICAgICAgICAgICAgIGNvbW1vblJvb3RNZWV0UG9pbnQgPSBqO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gY29tbW9uUm9vdE1lZXRQb2ludDsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgICAgdmFyIGxpbmUgPSBwcmV2W2pdO1xuICAgICAgICAgICAgICBpZiAoY3VycmVudFtjdXJyZW50TGFzdEluZGV4XSA9PT0gbGluZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnQucG9wKCk7XG4gICAgICAgICAgICAgICAgY3VycmVudExhc3RJbmRleC0tO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50ID0gcHJldjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2xlYW5TdGFjayhzdGFjaykge1xuICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0YWNrLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbGluZSA9IHN0YWNrW2ldO1xuICAgICAgICAgICAgdmFyIGlzVHJhY2VMaW5lID0gc3RhY2tGcmFtZVBhdHRlcm4udGVzdChsaW5lKSB8fCBcIiAgICAoTm8gc3RhY2sgdHJhY2UpXCIgPT09IGxpbmU7XG4gICAgICAgICAgICB2YXIgaXNJbnRlcm5hbEZyYW1lID0gaXNUcmFjZUxpbmUgJiYgc2hvdWxkSWdub3JlKGxpbmUpO1xuICAgICAgICAgICAgaWYgKGlzVHJhY2VMaW5lICYmICFpc0ludGVybmFsRnJhbWUpIHtcbiAgICAgICAgICAgICAgaWYgKGluZGVudFN0YWNrRnJhbWVzICYmIGxpbmUuY2hhckF0KDApICE9PSBcIiBcIikge1xuICAgICAgICAgICAgICAgIGxpbmUgPSBcIiAgICBcIiArIGxpbmU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0LnB1c2gobGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc3RhY2tGcmFtZXNBc0FycmF5KGVycm9yKSB7XG4gICAgICAgICAgdmFyIHN0YWNrID0gZXJyb3Iuc3RhY2sucmVwbGFjZSgvXFxzKyQvZywgXCJcIikuc3BsaXQoXCJcXG5cIik7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGFjay5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGxpbmUgPSBzdGFja1tpXTtcbiAgICAgICAgICAgIGlmIChcIiAgICAoTm8gc3RhY2sgdHJhY2UpXCIgPT09IGxpbmUgfHwgc3RhY2tGcmFtZVBhdHRlcm4udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGkgPiAwKSB7XG4gICAgICAgICAgICBzdGFjayA9IHN0YWNrLnNsaWNlKGkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gc3RhY2s7XG4gICAgICAgIH1cbiAgICAgICAgQ2FwdHVyZWRUcmFjZS5wYXJzZVN0YWNrQW5kTWVzc2FnZSA9IGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgdmFyIHN0YWNrID0gZXJyb3Iuc3RhY2s7XG4gICAgICAgICAgdmFyIG1lc3NhZ2UgPSBlcnJvci50b1N0cmluZygpO1xuICAgICAgICAgIHN0YWNrID0gdHlwZW9mIHN0YWNrID09PSBcInN0cmluZ1wiICYmIHN0YWNrLmxlbmd0aCA+IDAgPyBzdGFja0ZyYW1lc0FzQXJyYXkoZXJyb3IpIDogW1wiICAgIChObyBzdGFjayB0cmFjZSlcIl07XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgICAgICBzdGFjazogY2xlYW5TdGFjayhzdGFjaylcbiAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBDYXB0dXJlZFRyYWNlLmZvcm1hdEFuZExvZ0Vycm9yID0gZnVuY3Rpb24oZXJyb3IsIHRpdGxlKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGVycm9yID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgdmFyIHN0YWNrID0gZXJyb3Iuc3RhY2s7XG4gICAgICAgICAgICAgIG1lc3NhZ2UgPSB0aXRsZSArIGZvcm1hdFN0YWNrKHN0YWNrLCBlcnJvcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBtZXNzYWdlID0gdGl0bGUgKyBTdHJpbmcoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiB3YXJuID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgd2FybihtZXNzYWdlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbnNvbGUubG9nID09PSBcImZ1bmN0aW9uXCIgfHwgdHlwZW9mIGNvbnNvbGUubG9nID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ2FwdHVyZWRUcmFjZS51bmhhbmRsZWRSZWplY3Rpb24gPSBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICBDYXB0dXJlZFRyYWNlLmZvcm1hdEFuZExvZ0Vycm9yKHJlYXNvbiwgXCJeLS0tIFdpdGggYWRkaXRpb25hbCBzdGFjayB0cmFjZTogXCIpO1xuICAgICAgICB9O1xuICAgICAgICBDYXB0dXJlZFRyYWNlLmlzU3VwcG9ydGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiBjYXB0dXJlU3RhY2tUcmFjZSA9PT0gXCJmdW5jdGlvblwiO1xuICAgICAgICB9O1xuICAgICAgICBDYXB0dXJlZFRyYWNlLmZpcmVSZWplY3Rpb25FdmVudCA9IGZ1bmN0aW9uKG5hbWUsIGxvY2FsSGFuZGxlciwgcmVhc29uLCBwcm9taXNlKSB7XG4gICAgICAgICAgdmFyIGxvY2FsRXZlbnRGaXJlZCA9IGZhbHNlO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGxvY2FsSGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIGxvY2FsRXZlbnRGaXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgIGlmIChuYW1lID09PSBcInJlamVjdGlvbkhhbmRsZWRcIikge1xuICAgICAgICAgICAgICAgIGxvY2FsSGFuZGxlcihwcm9taXNlKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsb2NhbEhhbmRsZXIocmVhc29uLCBwcm9taXNlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGFzeW5jLnRocm93TGF0ZXIoZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBnbG9iYWxFdmVudEZpcmVkID0gZmFsc2U7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGdsb2JhbEV2ZW50RmlyZWQgPSBmaXJlR2xvYmFsRXZlbnQobmFtZSwgcmVhc29uLCBwcm9taXNlKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBnbG9iYWxFdmVudEZpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGFzeW5jLnRocm93TGF0ZXIoZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBkb21FdmVudEZpcmVkID0gZmFsc2U7XG4gICAgICAgICAgaWYgKGZpcmVEb21FdmVudCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgZG9tRXZlbnRGaXJlZCA9IGZpcmVEb21FdmVudChuYW1lLnRvTG93ZXJDYXNlKCksIHtcbiAgICAgICAgICAgICAgICByZWFzb246IHJlYXNvbixcbiAgICAgICAgICAgICAgICBwcm9taXNlOiBwcm9taXNlXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICBkb21FdmVudEZpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgYXN5bmMudGhyb3dMYXRlcihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFnbG9iYWxFdmVudEZpcmVkICYmICFsb2NhbEV2ZW50RmlyZWQgJiYgIWRvbUV2ZW50RmlyZWQgJiYgbmFtZSA9PT0gXCJ1bmhhbmRsZWRSZWplY3Rpb25cIikge1xuICAgICAgICAgICAgQ2FwdHVyZWRUcmFjZS5mb3JtYXRBbmRMb2dFcnJvcihyZWFzb24sIFwiVW5oYW5kbGVkIHJlamVjdGlvbiBcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmdW5jdGlvbiBmb3JtYXROb25FcnJvcihvYmopIHtcbiAgICAgICAgICB2YXIgc3RyO1xuICAgICAgICAgIGlmICh0eXBlb2Ygb2JqID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHN0ciA9IFwiW2Z1bmN0aW9uIFwiICsgKG9iai5uYW1lIHx8IFwiYW5vbnltb3VzXCIpICsgXCJdXCI7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0ciA9IG9iai50b1N0cmluZygpO1xuICAgICAgICAgICAgdmFyIHJ1c2VsZXNzVG9TdHJpbmcgPSAvXFxbb2JqZWN0IFthLXpBLVowLTkkX10rXFxdLztcbiAgICAgICAgICAgIGlmIChydXNlbGVzc1RvU3RyaW5nLnRlc3Qoc3RyKSkge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdTdHIgPSBKU09OLnN0cmluZ2lmeShvYmopO1xuICAgICAgICAgICAgICAgIHN0ciA9IG5ld1N0cjtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdHIubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgIHN0ciA9IFwiKGVtcHR5IGFycmF5KVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gKFwiKDxcIiArIHNuaXAoc3RyKSArIFwiPiwgbm8gc3RhY2sgdHJhY2UpXCIpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNuaXAoc3RyKSB7XG4gICAgICAgICAgdmFyIG1heENoYXJzID0gNDE7XG4gICAgICAgICAgaWYgKHN0ci5sZW5ndGggPCBtYXhDaGFycykge1xuICAgICAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHIoMCwgbWF4Q2hhcnMgLSAzKSArIFwiLi4uXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNob3VsZElnbm9yZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHBhcnNlTGluZUluZm9SZWdleCA9IC9bXFwvPFxcKF0oW146XFwvXSspOihcXGQrKTooPzpcXGQrKVxcKT9cXHMqJC87XG4gICAgICAgIGZ1bmN0aW9uIHBhcnNlTGluZUluZm8obGluZSkge1xuICAgICAgICAgIHZhciBtYXRjaGVzID0gbGluZS5tYXRjaChwYXJzZUxpbmVJbmZvUmVnZXgpO1xuICAgICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBmaWxlTmFtZTogbWF0Y2hlc1sxXSxcbiAgICAgICAgICAgICAgbGluZTogcGFyc2VJbnQobWF0Y2hlc1syXSwgMTApXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBDYXB0dXJlZFRyYWNlLnNldEJvdW5kcyA9IGZ1bmN0aW9uKGZpcnN0TGluZUVycm9yLCBsYXN0TGluZUVycm9yKSB7XG4gICAgICAgICAgaWYgKCFDYXB0dXJlZFRyYWNlLmlzU3VwcG9ydGVkKCkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgdmFyIGZpcnN0U3RhY2tMaW5lcyA9IGZpcnN0TGluZUVycm9yLnN0YWNrLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICAgIHZhciBsYXN0U3RhY2tMaW5lcyA9IGxhc3RMaW5lRXJyb3Iuc3RhY2suc3BsaXQoXCJcXG5cIik7XG4gICAgICAgICAgdmFyIGZpcnN0SW5kZXggPSAtMTtcbiAgICAgICAgICB2YXIgbGFzdEluZGV4ID0gLTE7XG4gICAgICAgICAgdmFyIGZpcnN0RmlsZU5hbWU7XG4gICAgICAgICAgdmFyIGxhc3RGaWxlTmFtZTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpcnN0U3RhY2tMaW5lcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHBhcnNlTGluZUluZm8oZmlyc3RTdGFja0xpbmVzW2ldKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgZmlyc3RGaWxlTmFtZSA9IHJlc3VsdC5maWxlTmFtZTtcbiAgICAgICAgICAgICAgZmlyc3RJbmRleCA9IHJlc3VsdC5saW5lO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsYXN0U3RhY2tMaW5lcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHBhcnNlTGluZUluZm8obGFzdFN0YWNrTGluZXNbaV0pO1xuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICBsYXN0RmlsZU5hbWUgPSByZXN1bHQuZmlsZU5hbWU7XG4gICAgICAgICAgICAgIGxhc3RJbmRleCA9IHJlc3VsdC5saW5lO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpcnN0SW5kZXggPCAwIHx8IGxhc3RJbmRleCA8IDAgfHwgIWZpcnN0RmlsZU5hbWUgfHwgIWxhc3RGaWxlTmFtZSB8fCBmaXJzdEZpbGVOYW1lICE9PSBsYXN0RmlsZU5hbWUgfHwgZmlyc3RJbmRleCA+PSBsYXN0SW5kZXgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2hvdWxkSWdub3JlID0gZnVuY3Rpb24obGluZSkge1xuICAgICAgICAgICAgaWYgKGJsdWViaXJkRnJhbWVQYXR0ZXJuLnRlc3QobGluZSkpXG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBwYXJzZUxpbmVJbmZvKGxpbmUpO1xuICAgICAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgICAgaWYgKGluZm8uZmlsZU5hbWUgPT09IGZpcnN0RmlsZU5hbWUgJiYgKGZpcnN0SW5kZXggPD0gaW5mby5saW5lICYmIGluZm8ubGluZSA8PSBsYXN0SW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSAoZnVuY3Rpb24gc3RhY2tEZXRlY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHY4c3RhY2tGcmFtZVBhdHRlcm4gPSAvXlxccyphdFxccyovO1xuICAgICAgICAgIHZhciB2OHN0YWNrRm9ybWF0dGVyID0gZnVuY3Rpb24oc3RhY2ssIGVycm9yKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YWNrID09PSBcInN0cmluZ1wiKVxuICAgICAgICAgICAgICByZXR1cm4gc3RhY2s7XG4gICAgICAgICAgICBpZiAoZXJyb3IubmFtZSAhPT0gdW5kZWZpbmVkICYmIGVycm9yLm1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICByZXR1cm4gZXJyb3IudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmb3JtYXROb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAodHlwZW9mIEVycm9yLnN0YWNrVHJhY2VMaW1pdCA9PT0gXCJudW1iZXJcIiAmJiB0eXBlb2YgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ID0gRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ICsgNjtcbiAgICAgICAgICAgIHN0YWNrRnJhbWVQYXR0ZXJuID0gdjhzdGFja0ZyYW1lUGF0dGVybjtcbiAgICAgICAgICAgIGZvcm1hdFN0YWNrID0gdjhzdGFja0Zvcm1hdHRlcjtcbiAgICAgICAgICAgIHZhciBjYXB0dXJlU3RhY2tUcmFjZSA9IEVycm9yLmNhcHR1cmVTdGFja1RyYWNlO1xuICAgICAgICAgICAgc2hvdWxkSWdub3JlID0gZnVuY3Rpb24obGluZSkge1xuICAgICAgICAgICAgICByZXR1cm4gYmx1ZWJpcmRGcmFtZVBhdHRlcm4udGVzdChsaW5lKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24ocmVjZWl2ZXIsIGlnbm9yZVVudGlsKSB7XG4gICAgICAgICAgICAgIEVycm9yLnN0YWNrVHJhY2VMaW1pdCA9IEVycm9yLnN0YWNrVHJhY2VMaW1pdCArIDY7XG4gICAgICAgICAgICAgIGNhcHR1cmVTdGFja1RyYWNlKHJlY2VpdmVyLCBpZ25vcmVVbnRpbCk7XG4gICAgICAgICAgICAgIEVycm9yLnN0YWNrVHJhY2VMaW1pdCA9IEVycm9yLnN0YWNrVHJhY2VMaW1pdCAtIDY7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZXJyID0gbmV3IEVycm9yKCk7XG4gICAgICAgICAgaWYgKHR5cGVvZiBlcnIuc3RhY2sgPT09IFwic3RyaW5nXCIgJiYgZXJyLnN0YWNrLnNwbGl0KFwiXFxuXCIpWzBdLmluZGV4T2YoXCJzdGFja0RldGVjdGlvbkBcIikgPj0gMCkge1xuICAgICAgICAgICAgc3RhY2tGcmFtZVBhdHRlcm4gPSAvQC87XG4gICAgICAgICAgICBmb3JtYXRTdGFjayA9IHY4c3RhY2tGb3JtYXR0ZXI7XG4gICAgICAgICAgICBpbmRlbnRTdGFja0ZyYW1lcyA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gY2FwdHVyZVN0YWNrVHJhY2Uobykge1xuICAgICAgICAgICAgICBvLnN0YWNrID0gbmV3IEVycm9yKCkuc3RhY2s7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgaGFzU3RhY2tBZnRlclRocm93O1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBoYXNTdGFja0FmdGVyVGhyb3cgPSAoXCJzdGFja1wiIGluIGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIShcInN0YWNrXCIgaW4gZXJyKSAmJiBoYXNTdGFja0FmdGVyVGhyb3cpIHtcbiAgICAgICAgICAgIHN0YWNrRnJhbWVQYXR0ZXJuID0gdjhzdGFja0ZyYW1lUGF0dGVybjtcbiAgICAgICAgICAgIGZvcm1hdFN0YWNrID0gdjhzdGFja0Zvcm1hdHRlcjtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBjYXB0dXJlU3RhY2tUcmFjZShvKSB7XG4gICAgICAgICAgICAgIEVycm9yLnN0YWNrVHJhY2VMaW1pdCA9IEVycm9yLnN0YWNrVHJhY2VMaW1pdCArIDY7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBvLnN0YWNrID0gZS5zdGFjaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBFcnJvci5zdGFja1RyYWNlTGltaXQgPSBFcnJvci5zdGFja1RyYWNlTGltaXQgLSA2O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9ybWF0U3RhY2sgPSBmdW5jdGlvbihzdGFjaywgZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIpXG4gICAgICAgICAgICAgIHJldHVybiBzdGFjaztcbiAgICAgICAgICAgIGlmICgodHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBlcnJvciA9PT0gXCJmdW5jdGlvblwiKSAmJiBlcnJvci5uYW1lICE9PSB1bmRlZmluZWQgJiYgZXJyb3IubWVzc2FnZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlcnJvci50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9KShbXSk7XG4gICAgICAgIHZhciBmaXJlRG9tRXZlbnQ7XG4gICAgICAgIHZhciBmaXJlR2xvYmFsRXZlbnQgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHV0aWwuaXNOb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24obmFtZSwgcmVhc29uLCBwcm9taXNlKSB7XG4gICAgICAgICAgICAgIGlmIChuYW1lID09PSBcInJlamVjdGlvbkhhbmRsZWRcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9jZXNzLmVtaXQobmFtZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3MuZW1pdChuYW1lLCByZWFzb24sIHByb21pc2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgY3VzdG9tRXZlbnRXb3JrcyA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGFueUV2ZW50V29ya3MgPSB0cnVlO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgdmFyIGV2ID0gbmV3IHNlbGYuQ3VzdG9tRXZlbnQoXCJ0ZXN0XCIpO1xuICAgICAgICAgICAgICBjdXN0b21FdmVudFdvcmtzID0gZXYgaW5zdGFuY2VvZiBDdXN0b21FdmVudDtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgICAgICBpZiAoIWN1c3RvbUV2ZW50V29ya3MpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcIkN1c3RvbUV2ZW50XCIpO1xuICAgICAgICAgICAgICAgIGV2ZW50LmluaXRDdXN0b21FdmVudChcInRlc3Rpbmd0aGVldmVudFwiLCBmYWxzZSwgdHJ1ZSwge30pO1xuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBhbnlFdmVudFdvcmtzID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhbnlFdmVudFdvcmtzKSB7XG4gICAgICAgICAgICAgIGZpcmVEb21FdmVudCA9IGZ1bmN0aW9uKHR5cGUsIGRldGFpbCkge1xuICAgICAgICAgICAgICAgIHZhciBldmVudDtcbiAgICAgICAgICAgICAgICBpZiAoY3VzdG9tRXZlbnRXb3Jrcykge1xuICAgICAgICAgICAgICAgICAgZXZlbnQgPSBuZXcgc2VsZi5DdXN0b21FdmVudCh0eXBlLCB7XG4gICAgICAgICAgICAgICAgICAgIGRldGFpbDogZGV0YWlsLFxuICAgICAgICAgICAgICAgICAgICBidWJibGVzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLmRpc3BhdGNoRXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJDdXN0b21FdmVudFwiKTtcbiAgICAgICAgICAgICAgICAgIGV2ZW50LmluaXRDdXN0b21FdmVudCh0eXBlLCBmYWxzZSwgdHJ1ZSwgZGV0YWlsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50ID8gIXNlbGYuZGlzcGF0Y2hFdmVudChldmVudCkgOiBmYWxzZTtcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0b1dpbmRvd01ldGhvZE5hbWVNYXAgPSB7fTtcbiAgICAgICAgICAgIHRvV2luZG93TWV0aG9kTmFtZU1hcFtcInVuaGFuZGxlZFJlamVjdGlvblwiXSA9IChcIm9uXCIgKyBcInVuaGFuZGxlZFJlamVjdGlvblwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdG9XaW5kb3dNZXRob2ROYW1lTWFwW1wicmVqZWN0aW9uSGFuZGxlZFwiXSA9IChcIm9uXCIgKyBcInJlamVjdGlvbkhhbmRsZWRcIikudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihuYW1lLCByZWFzb24sIHByb21pc2UpIHtcbiAgICAgICAgICAgICAgdmFyIG1ldGhvZE5hbWUgPSB0b1dpbmRvd01ldGhvZE5hbWVNYXBbbmFtZV07XG4gICAgICAgICAgICAgIHZhciBtZXRob2QgPSBzZWxmW21ldGhvZE5hbWVdO1xuICAgICAgICAgICAgICBpZiAoIW1ldGhvZClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgIGlmIChuYW1lID09PSBcInJlamVjdGlvbkhhbmRsZWRcIikge1xuICAgICAgICAgICAgICAgIG1ldGhvZC5jYWxsKHNlbGYsIHByb21pc2UpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1ldGhvZC5jYWxsKHNlbGYsIHJlYXNvbiwgcHJvbWlzZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBjb25zb2xlLndhcm4gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICB3YXJuID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKHV0aWwuaXNOb2RlICYmIHByb2Nlc3Muc3RkZXJyLmlzVFRZKSB7XG4gICAgICAgICAgICB3YXJuID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICAgICAgICBwcm9jZXNzLnN0ZGVyci53cml0ZShcIlxcdTAwMWJbMzFtXCIgKyBtZXNzYWdlICsgXCJcXHUwMDFiWzM5bVxcblwiKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSBlbHNlIGlmICghdXRpbC5pc05vZGUgJiYgdHlwZW9mKG5ldyBFcnJvcigpLnN0YWNrKSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgd2FybiA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiJWNcIiArIG1lc3NhZ2UsIFwiY29sb3I6IHJlZFwiKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBDYXB0dXJlZFRyYWNlO1xuICAgICAgfTtcbiAgICB9LCB7XG4gICAgICBcIi4vYXN5bmMuanNcIjogMixcbiAgICAgIFwiLi91dGlsLmpzXCI6IDM4XG4gICAgfV0sXG4gICAgODogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE5FWFRfRklMVEVSKSB7XG4gICAgICAgIHZhciB1dGlsID0gX2RlcmVxXyhcIi4vdXRpbC5qc1wiKTtcbiAgICAgICAgdmFyIGVycm9ycyA9IF9kZXJlcV8oXCIuL2Vycm9ycy5qc1wiKTtcbiAgICAgICAgdmFyIHRyeUNhdGNoID0gdXRpbC50cnlDYXRjaDtcbiAgICAgICAgdmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbiAgICAgICAgdmFyIGtleXMgPSBfZGVyZXFfKFwiLi9lczUuanNcIikua2V5cztcbiAgICAgICAgdmFyIFR5cGVFcnJvciA9IGVycm9ycy5UeXBlRXJyb3I7XG4gICAgICAgIGZ1bmN0aW9uIENhdGNoRmlsdGVyKGluc3RhbmNlcywgY2FsbGJhY2ssIHByb21pc2UpIHtcbiAgICAgICAgICB0aGlzLl9pbnN0YW5jZXMgPSBpbnN0YW5jZXM7XG4gICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgICB0aGlzLl9wcm9taXNlID0gcHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzYWZlUHJlZGljYXRlKHByZWRpY2F0ZSwgZSkge1xuICAgICAgICAgIHZhciBzYWZlT2JqZWN0ID0ge307XG4gICAgICAgICAgdmFyIHJldGZpbHRlciA9IHRyeUNhdGNoKHByZWRpY2F0ZSkuY2FsbChzYWZlT2JqZWN0LCBlKTtcbiAgICAgICAgICBpZiAocmV0ZmlsdGVyID09PSBlcnJvck9iailcbiAgICAgICAgICAgIHJldHVybiByZXRmaWx0ZXI7XG4gICAgICAgICAgdmFyIHNhZmVLZXlzID0ga2V5cyhzYWZlT2JqZWN0KTtcbiAgICAgICAgICBpZiAoc2FmZUtleXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBlcnJvck9iai5lID0gbmV3IFR5cGVFcnJvcihcIkNhdGNoIGZpbHRlciBtdXN0IGluaGVyaXQgZnJvbSBFcnJvciBvciBiZSBhIHNpbXBsZSBwcmVkaWNhdGUgZnVuY3Rpb25cXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC9vODRvNjhcXHUwMDBhXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmV0ZmlsdGVyO1xuICAgICAgICB9XG4gICAgICAgIENhdGNoRmlsdGVyLnByb3RvdHlwZS5kb0ZpbHRlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICB2YXIgY2IgPSB0aGlzLl9jYWxsYmFjaztcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2U7XG4gICAgICAgICAgdmFyIGJvdW5kVG8gPSBwcm9taXNlLl9ib3VuZFRvO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLFxuICAgICAgICAgICAgICBsZW4gPSB0aGlzLl9pbnN0YW5jZXMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5faW5zdGFuY2VzW2ldO1xuICAgICAgICAgICAgdmFyIGl0ZW1Jc0Vycm9yVHlwZSA9IGl0ZW0gPT09IEVycm9yIHx8IChpdGVtICE9IG51bGwgJiYgaXRlbS5wcm90b3R5cGUgaW5zdGFuY2VvZiBFcnJvcik7XG4gICAgICAgICAgICBpZiAoaXRlbUlzRXJyb3JUeXBlICYmIGUgaW5zdGFuY2VvZiBpdGVtKSB7XG4gICAgICAgICAgICAgIHZhciByZXQgPSB0cnlDYXRjaChjYikuY2FsbChib3VuZFRvLCBlKTtcbiAgICAgICAgICAgICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICBORVhUX0ZJTFRFUi5lID0gcmV0LmU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE5FWFRfRklMVEVSO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpdGVtID09PSBcImZ1bmN0aW9uXCIgJiYgIWl0ZW1Jc0Vycm9yVHlwZSkge1xuICAgICAgICAgICAgICB2YXIgc2hvdWxkSGFuZGxlID0gc2FmZVByZWRpY2F0ZShpdGVtLCBlKTtcbiAgICAgICAgICAgICAgaWYgKHNob3VsZEhhbmRsZSA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICBlID0gZXJyb3JPYmouZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChzaG91bGRIYW5kbGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2goY2IpLmNhbGwoYm91bmRUbywgZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICAgIE5FWFRfRklMVEVSLmUgPSByZXQuZTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBORVhUX0ZJTFRFUjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBORVhUX0ZJTFRFUi5lID0gZTtcbiAgICAgICAgICByZXR1cm4gTkVYVF9GSUxURVI7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBDYXRjaEZpbHRlcjtcbiAgICAgIH07XG4gICAgfSwge1xuICAgICAgXCIuL2Vycm9ycy5qc1wiOiAxMyxcbiAgICAgIFwiLi9lczUuanNcIjogMTQsXG4gICAgICBcIi4vdXRpbC5qc1wiOiAzOFxuICAgIH1dLFxuICAgIDk6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBDYXB0dXJlZFRyYWNlLCBpc0RlYnVnZ2luZykge1xuICAgICAgICB2YXIgY29udGV4dFN0YWNrID0gW107XG4gICAgICAgIGZ1bmN0aW9uIENvbnRleHQoKSB7XG4gICAgICAgICAgdGhpcy5fdHJhY2UgPSBuZXcgQ2FwdHVyZWRUcmFjZShwZWVrQ29udGV4dCgpKTtcbiAgICAgICAgfVxuICAgICAgICBDb250ZXh0LnByb3RvdHlwZS5fcHVzaENvbnRleHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoIWlzRGVidWdnaW5nKCkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgaWYgKHRoaXMuX3RyYWNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnRleHRTdGFjay5wdXNoKHRoaXMuX3RyYWNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbnRleHQucHJvdG90eXBlLl9wb3BDb250ZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKCFpc0RlYnVnZ2luZygpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIGlmICh0aGlzLl90cmFjZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb250ZXh0U3RhY2sucG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmdW5jdGlvbiBjcmVhdGVDb250ZXh0KCkge1xuICAgICAgICAgIGlmIChpc0RlYnVnZ2luZygpKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb250ZXh0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcGVla0NvbnRleHQoKSB7XG4gICAgICAgICAgdmFyIGxhc3RJbmRleCA9IGNvbnRleHRTdGFjay5sZW5ndGggLSAxO1xuICAgICAgICAgIGlmIChsYXN0SW5kZXggPj0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHRTdGFja1tsYXN0SW5kZXhdO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9wZWVrQ29udGV4dCA9IHBlZWtDb250ZXh0O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fcHVzaENvbnRleHQgPSBDb250ZXh0LnByb3RvdHlwZS5fcHVzaENvbnRleHQ7XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9wb3BDb250ZXh0ID0gQ29udGV4dC5wcm90b3R5cGUuX3BvcENvbnRleHQ7XG4gICAgICAgIHJldHVybiBjcmVhdGVDb250ZXh0O1xuICAgICAgfTtcbiAgICB9LCB7fV0sXG4gICAgMTA6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBDYXB0dXJlZFRyYWNlKSB7XG4gICAgICAgIHZhciBhc3luYyA9IF9kZXJlcV8oXCIuL2FzeW5jLmpzXCIpO1xuICAgICAgICB2YXIgV2FybmluZyA9IF9kZXJlcV8oXCIuL2Vycm9ycy5qc1wiKS5XYXJuaW5nO1xuICAgICAgICB2YXIgdXRpbCA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIik7XG4gICAgICAgIHZhciBjYW5BdHRhY2hUcmFjZSA9IHV0aWwuY2FuQXR0YWNoVHJhY2U7XG4gICAgICAgIHZhciB1bmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkO1xuICAgICAgICB2YXIgcG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb247XG4gICAgICAgIHZhciBkZWJ1Z2dpbmcgPSBmYWxzZSB8fCAodXRpbC5pc05vZGUgJiYgKCEhcHJvY2Vzcy5lbnZbXCJCTFVFQklSRF9ERUJVR1wiXSB8fCBwcm9jZXNzLmVudltcIk5PREVfRU5WXCJdID09PSBcImRldmVsb3BtZW50XCIpKTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX3NldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhpcy5fbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uLCB0aGlzLCB1bmRlZmluZWQpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uSXNIYW5kbGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgQ2FwdHVyZWRUcmFjZS5maXJlUmVqZWN0aW9uRXZlbnQoXCJyZWplY3Rpb25IYW5kbGVkXCIsIHVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQsIHVuZGVmaW5lZCwgdGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAodGhpcy5faXNSZWplY3Rpb25VbmhhbmRsZWQoKSkge1xuICAgICAgICAgICAgdmFyIHJlYXNvbiA9IHRoaXMuX2dldENhcnJpZWRTdGFja1RyYWNlKCkgfHwgdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCgpO1xuICAgICAgICAgICAgQ2FwdHVyZWRUcmFjZS5maXJlUmVqZWN0aW9uRXZlbnQoXCJ1bmhhbmRsZWRSZWplY3Rpb25cIiwgcG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24sIHJlYXNvbiwgdGhpcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCA1MjQyODg7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl91bnNldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH41MjQyODgpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5faXNVbmhhbmRsZWRSZWplY3Rpb25Ob3RpZmllZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA1MjQyODgpID4gMDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldFJlamVjdGlvbklzVW5oYW5kbGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDIwOTcxNTI7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+MjA5NzE1Mik7XG4gICAgICAgICAgaWYgKHRoaXMuX2lzVW5oYW5kbGVkUmVqZWN0aW9uTm90aWZpZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5fdW5zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkKCk7XG4gICAgICAgICAgICB0aGlzLl9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb25Jc0hhbmRsZWQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9pc1JlamVjdGlvblVuaGFuZGxlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAyMDk3MTUyKSA+IDA7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSA9IGZ1bmN0aW9uKGNhcHR1cmVkVHJhY2UpIHtcbiAgICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMTA0ODU3NjtcbiAgICAgICAgICB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwID0gY2FwdHVyZWRUcmFjZTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2lzQ2FycnlpbmdTdGFja1RyYWNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDEwNDg1NzYpID4gMDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2dldENhcnJpZWRTdGFja1RyYWNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2lzQ2FycnlpbmdTdGFja1RyYWNlKCkgPyB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwIDogdW5kZWZpbmVkO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fY2FwdHVyZVN0YWNrVHJhY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoZGVidWdnaW5nKSB7XG4gICAgICAgICAgICB0aGlzLl90cmFjZSA9IG5ldyBDYXB0dXJlZFRyYWNlKHRoaXMuX3BlZWtDb250ZXh0KCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2F0dGFjaEV4dHJhVHJhY2UgPSBmdW5jdGlvbihlcnJvciwgaWdub3JlU2VsZikge1xuICAgICAgICAgIGlmIChkZWJ1Z2dpbmcgJiYgY2FuQXR0YWNoVHJhY2UoZXJyb3IpKSB7XG4gICAgICAgICAgICB2YXIgdHJhY2UgPSB0aGlzLl90cmFjZTtcbiAgICAgICAgICAgIGlmICh0cmFjZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGlmIChpZ25vcmVTZWxmKVxuICAgICAgICAgICAgICAgIHRyYWNlID0gdHJhY2UuX3BhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0cmFjZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIHRyYWNlLmF0dGFjaEV4dHJhVHJhY2UoZXJyb3IpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghZXJyb3IuX19zdGFja0NsZWFuZWRfXykge1xuICAgICAgICAgICAgICB2YXIgcGFyc2VkID0gQ2FwdHVyZWRUcmFjZS5wYXJzZVN0YWNrQW5kTWVzc2FnZShlcnJvcik7XG4gICAgICAgICAgICAgIGVycm9yLnN0YWNrID0gcGFyc2VkLm1lc3NhZ2UgKyBcIlxcblwiICsgcGFyc2VkLnN0YWNrLmpvaW4oXCJcXG5cIik7XG4gICAgICAgICAgICAgIHV0aWwubm90RW51bWVyYWJsZVByb3AoZXJyb3IsIFwiX19zdGFja0NsZWFuZWRfX1wiLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl93YXJuID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICAgIHZhciB3YXJuaW5nID0gbmV3IFdhcm5pbmcobWVzc2FnZSk7XG4gICAgICAgICAgdmFyIGN0eCA9IHRoaXMuX3BlZWtDb250ZXh0KCk7XG4gICAgICAgICAgaWYgKGN0eCkge1xuICAgICAgICAgICAgY3R4LmF0dGFjaEV4dHJhVHJhY2Uod2FybmluZyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBwYXJzZWQgPSBDYXB0dXJlZFRyYWNlLnBhcnNlU3RhY2tBbmRNZXNzYWdlKHdhcm5pbmcpO1xuICAgICAgICAgICAgd2FybmluZy5zdGFjayA9IHBhcnNlZC5tZXNzYWdlICsgXCJcXG5cIiArIHBhcnNlZC5zdGFjay5qb2luKFwiXFxuXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBDYXB0dXJlZFRyYWNlLmZvcm1hdEFuZExvZ0Vycm9yKHdhcm5pbmcsIFwiXCIpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLm9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgIHBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uID0gdHlwZW9mIGZuID09PSBcImZ1bmN0aW9uXCIgPyBmbiA6IHVuZGVmaW5lZDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5vblVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgIHVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQgPSB0eXBlb2YgZm4gPT09IFwiZnVuY3Rpb25cIiA/IGZuIDogdW5kZWZpbmVkO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLmxvbmdTdGFja1RyYWNlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmIChhc3luYy5oYXZlSXRlbXNRdWV1ZWQoKSAmJiBkZWJ1Z2dpbmcgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYW5ub3QgZW5hYmxlIGxvbmcgc3RhY2sgdHJhY2VzIGFmdGVyIHByb21pc2VzIGhhdmUgYmVlbiBjcmVhdGVkXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvRFQxcXlHXFx1MDAwYVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGVidWdnaW5nID0gQ2FwdHVyZWRUcmFjZS5pc1N1cHBvcnRlZCgpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLmhhc0xvbmdTdGFja1RyYWNlcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBkZWJ1Z2dpbmcgJiYgQ2FwdHVyZWRUcmFjZS5pc1N1cHBvcnRlZCgpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoIUNhcHR1cmVkVHJhY2UuaXNTdXBwb3J0ZWQoKSkge1xuICAgICAgICAgIFByb21pc2UubG9uZ1N0YWNrVHJhY2VzID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgICAgICBkZWJ1Z2dpbmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGRlYnVnZ2luZztcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge1xuICAgICAgXCIuL2FzeW5jLmpzXCI6IDIsXG4gICAgICBcIi4vZXJyb3JzLmpzXCI6IDEzLFxuICAgICAgXCIuL3V0aWwuanNcIjogMzhcbiAgICB9XSxcbiAgICAxMTogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICB2YXIgdXRpbCA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIik7XG4gICAgICB2YXIgaXNQcmltaXRpdmUgPSB1dGlsLmlzUHJpbWl0aXZlO1xuICAgICAgdmFyIHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgPSB1dGlsLndyYXBzUHJpbWl0aXZlUmVjZWl2ZXI7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbiAgICAgICAgdmFyIHJldHVybmVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0aHJvd2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhyb3cgdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSBmdW5jdGlvbih2YWx1ZSwgYWN0aW9uKSB7XG4gICAgICAgICAgaWYgKGFjdGlvbiA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICB0aHJvdyB2YWx1ZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IDIpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlW1wicmV0dXJuXCJdID0gUHJvbWlzZS5wcm90b3R5cGUudGhlblJldHVybiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgJiYgaXNQcmltaXRpdmUodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGhlbih3cmFwcGVyKHZhbHVlLCAyKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4ocmV0dXJuZXIsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB2YWx1ZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGVbXCJ0aHJvd1wiXSA9IFByb21pc2UucHJvdG90eXBlLnRoZW5UaHJvdyA9IGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgIGlmICh3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyICYmIGlzUHJpbWl0aXZlKHJlYXNvbikpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aGVuKHdyYXBwZXIocmVhc29uLCAxKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4odGhyb3dlciwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHJlYXNvbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge1wiLi91dGlsLmpzXCI6IDM4fV0sXG4gICAgMTI6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCkge1xuICAgICAgICB2YXIgUHJvbWlzZVJlZHVjZSA9IFByb21pc2UucmVkdWNlO1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5lYWNoID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZVJlZHVjZSh0aGlzLCBmbiwgbnVsbCwgSU5URVJOQUwpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLmVhY2ggPSBmdW5jdGlvbihwcm9taXNlcywgZm4pIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZVJlZHVjZShwcm9taXNlcywgZm4sIG51bGwsIElOVEVSTkFMKTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge31dLFxuICAgIDEzOiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIHZhciBlczUgPSBfZGVyZXFfKFwiLi9lczUuanNcIik7XG4gICAgICB2YXIgT2JqZWN0ZnJlZXplID0gZXM1LmZyZWV6ZTtcbiAgICAgIHZhciB1dGlsID0gX2RlcmVxXyhcIi4vdXRpbC5qc1wiKTtcbiAgICAgIHZhciBpbmhlcml0cyA9IHV0aWwuaW5oZXJpdHM7XG4gICAgICB2YXIgbm90RW51bWVyYWJsZVByb3AgPSB1dGlsLm5vdEVudW1lcmFibGVQcm9wO1xuICAgICAgZnVuY3Rpb24gc3ViRXJyb3IobmFtZVByb3BlcnR5LCBkZWZhdWx0TWVzc2FnZSkge1xuICAgICAgICBmdW5jdGlvbiBTdWJFcnJvcihtZXNzYWdlKSB7XG4gICAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFN1YkVycm9yKSlcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3ViRXJyb3IobWVzc2FnZSk7XG4gICAgICAgICAgbm90RW51bWVyYWJsZVByb3AodGhpcywgXCJtZXNzYWdlXCIsIHR5cGVvZiBtZXNzYWdlID09PSBcInN0cmluZ1wiID8gbWVzc2FnZSA6IGRlZmF1bHRNZXNzYWdlKTtcbiAgICAgICAgICBub3RFbnVtZXJhYmxlUHJvcCh0aGlzLCBcIm5hbWVcIiwgbmFtZVByb3BlcnR5KTtcbiAgICAgICAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBFcnJvci5jYWxsKHRoaXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpbmhlcml0cyhTdWJFcnJvciwgRXJyb3IpO1xuICAgICAgICByZXR1cm4gU3ViRXJyb3I7XG4gICAgICB9XG4gICAgICB2YXIgX1R5cGVFcnJvcixcbiAgICAgICAgICBfUmFuZ2VFcnJvcjtcbiAgICAgIHZhciBXYXJuaW5nID0gc3ViRXJyb3IoXCJXYXJuaW5nXCIsIFwid2FybmluZ1wiKTtcbiAgICAgIHZhciBDYW5jZWxsYXRpb25FcnJvciA9IHN1YkVycm9yKFwiQ2FuY2VsbGF0aW9uRXJyb3JcIiwgXCJjYW5jZWxsYXRpb24gZXJyb3JcIik7XG4gICAgICB2YXIgVGltZW91dEVycm9yID0gc3ViRXJyb3IoXCJUaW1lb3V0RXJyb3JcIiwgXCJ0aW1lb3V0IGVycm9yXCIpO1xuICAgICAgdmFyIEFnZ3JlZ2F0ZUVycm9yID0gc3ViRXJyb3IoXCJBZ2dyZWdhdGVFcnJvclwiLCBcImFnZ3JlZ2F0ZSBlcnJvclwiKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIF9UeXBlRXJyb3IgPSBUeXBlRXJyb3I7XG4gICAgICAgIF9SYW5nZUVycm9yID0gUmFuZ2VFcnJvcjtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgX1R5cGVFcnJvciA9IHN1YkVycm9yKFwiVHlwZUVycm9yXCIsIFwidHlwZSBlcnJvclwiKTtcbiAgICAgICAgX1JhbmdlRXJyb3IgPSBzdWJFcnJvcihcIlJhbmdlRXJyb3JcIiwgXCJyYW5nZSBlcnJvclwiKTtcbiAgICAgIH1cbiAgICAgIHZhciBtZXRob2RzID0gKFwiam9pbiBwb3AgcHVzaCBzaGlmdCB1bnNoaWZ0IHNsaWNlIGZpbHRlciBmb3JFYWNoIHNvbWUgXCIgKyBcImV2ZXJ5IG1hcCBpbmRleE9mIGxhc3RJbmRleE9mIHJlZHVjZSByZWR1Y2VSaWdodCBzb3J0IHJldmVyc2VcIikuc3BsaXQoXCIgXCIpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZXRob2RzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGlmICh0eXBlb2YgQXJyYXkucHJvdG90eXBlW21ldGhvZHNbaV1dID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBBZ2dyZWdhdGVFcnJvci5wcm90b3R5cGVbbWV0aG9kc1tpXV0gPSBBcnJheS5wcm90b3R5cGVbbWV0aG9kc1tpXV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVzNS5kZWZpbmVQcm9wZXJ0eShBZ2dyZWdhdGVFcnJvci5wcm90b3R5cGUsIFwibGVuZ3RoXCIsIHtcbiAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIEFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZVtcImlzT3BlcmF0aW9uYWxcIl0gPSB0cnVlO1xuICAgICAgdmFyIGxldmVsID0gMDtcbiAgICAgIEFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaW5kZW50ID0gQXJyYXkobGV2ZWwgKiA0ICsgMSkuam9pbihcIiBcIik7XG4gICAgICAgIHZhciByZXQgPSBcIlxcblwiICsgaW5kZW50ICsgXCJBZ2dyZWdhdGVFcnJvciBvZjpcIiArIFwiXFxuXCI7XG4gICAgICAgIGxldmVsKys7XG4gICAgICAgIGluZGVudCA9IEFycmF5KGxldmVsICogNCArIDEpLmpvaW4oXCIgXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgc3RyID0gdGhpc1tpXSA9PT0gdGhpcyA/IFwiW0NpcmN1bGFyIEFnZ3JlZ2F0ZUVycm9yXVwiIDogdGhpc1tpXSArIFwiXCI7XG4gICAgICAgICAgdmFyIGxpbmVzID0gc3RyLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGluZXMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgIGxpbmVzW2pdID0gaW5kZW50ICsgbGluZXNbal07XG4gICAgICAgICAgfVxuICAgICAgICAgIHN0ciA9IGxpbmVzLmpvaW4oXCJcXG5cIik7XG4gICAgICAgICAgcmV0ICs9IHN0ciArIFwiXFxuXCI7XG4gICAgICAgIH1cbiAgICAgICAgbGV2ZWwtLTtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgIH07XG4gICAgICBmdW5jdGlvbiBPcGVyYXRpb25hbEVycm9yKG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIE9wZXJhdGlvbmFsRXJyb3IpKVxuICAgICAgICAgIHJldHVybiBuZXcgT3BlcmF0aW9uYWxFcnJvcihtZXNzYWdlKTtcbiAgICAgICAgbm90RW51bWVyYWJsZVByb3AodGhpcywgXCJuYW1lXCIsIFwiT3BlcmF0aW9uYWxFcnJvclwiKTtcbiAgICAgICAgbm90RW51bWVyYWJsZVByb3AodGhpcywgXCJtZXNzYWdlXCIsIG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLmNhdXNlID0gbWVzc2FnZTtcbiAgICAgICAgdGhpc1tcImlzT3BlcmF0aW9uYWxcIl0gPSB0cnVlO1xuICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgbm90RW51bWVyYWJsZVByb3AodGhpcywgXCJtZXNzYWdlXCIsIG1lc3NhZ2UubWVzc2FnZSk7XG4gICAgICAgICAgbm90RW51bWVyYWJsZVByb3AodGhpcywgXCJzdGFja1wiLCBtZXNzYWdlLnN0YWNrKTtcbiAgICAgICAgfSBlbHNlIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpbmhlcml0cyhPcGVyYXRpb25hbEVycm9yLCBFcnJvcik7XG4gICAgICB2YXIgZXJyb3JUeXBlcyA9IEVycm9yW1wiX19CbHVlYmlyZEVycm9yVHlwZXNfX1wiXTtcbiAgICAgIGlmICghZXJyb3JUeXBlcykge1xuICAgICAgICBlcnJvclR5cGVzID0gT2JqZWN0ZnJlZXplKHtcbiAgICAgICAgICBDYW5jZWxsYXRpb25FcnJvcjogQ2FuY2VsbGF0aW9uRXJyb3IsXG4gICAgICAgICAgVGltZW91dEVycm9yOiBUaW1lb3V0RXJyb3IsXG4gICAgICAgICAgT3BlcmF0aW9uYWxFcnJvcjogT3BlcmF0aW9uYWxFcnJvcixcbiAgICAgICAgICBSZWplY3Rpb25FcnJvcjogT3BlcmF0aW9uYWxFcnJvcixcbiAgICAgICAgICBBZ2dyZWdhdGVFcnJvcjogQWdncmVnYXRlRXJyb3JcbiAgICAgICAgfSk7XG4gICAgICAgIG5vdEVudW1lcmFibGVQcm9wKEVycm9yLCBcIl9fQmx1ZWJpcmRFcnJvclR5cGVzX19cIiwgZXJyb3JUeXBlcyk7XG4gICAgICB9XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICAgICAgRXJyb3I6IEVycm9yLFxuICAgICAgICBUeXBlRXJyb3I6IF9UeXBlRXJyb3IsXG4gICAgICAgIFJhbmdlRXJyb3I6IF9SYW5nZUVycm9yLFxuICAgICAgICBDYW5jZWxsYXRpb25FcnJvcjogZXJyb3JUeXBlcy5DYW5jZWxsYXRpb25FcnJvcixcbiAgICAgICAgT3BlcmF0aW9uYWxFcnJvcjogZXJyb3JUeXBlcy5PcGVyYXRpb25hbEVycm9yLFxuICAgICAgICBUaW1lb3V0RXJyb3I6IGVycm9yVHlwZXMuVGltZW91dEVycm9yLFxuICAgICAgICBBZ2dyZWdhdGVFcnJvcjogZXJyb3JUeXBlcy5BZ2dyZWdhdGVFcnJvcixcbiAgICAgICAgV2FybmluZzogV2FybmluZ1xuICAgICAgfTtcbiAgICB9LCB7XG4gICAgICBcIi4vZXM1LmpzXCI6IDE0LFxuICAgICAgXCIuL3V0aWwuanNcIjogMzhcbiAgICB9XSxcbiAgICAxNDogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgdmFyIGlzRVM1ID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHVuZGVmaW5lZDtcbiAgICAgIH0pKCk7XG4gICAgICBpZiAoaXNFUzUpIHtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgICAgICAgZnJlZXplOiBPYmplY3QuZnJlZXplLFxuICAgICAgICAgIGRlZmluZVByb3BlcnR5OiBPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gICAgICAgICAgZ2V0RGVzY3JpcHRvcjogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcixcbiAgICAgICAgICBrZXlzOiBPYmplY3Qua2V5cyxcbiAgICAgICAgICBuYW1lczogT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMsXG4gICAgICAgICAgZ2V0UHJvdG90eXBlT2Y6IE9iamVjdC5nZXRQcm90b3R5cGVPZixcbiAgICAgICAgICBpc0FycmF5OiBBcnJheS5pc0FycmF5LFxuICAgICAgICAgIGlzRVM1OiBpc0VTNSxcbiAgICAgICAgICBwcm9wZXJ0eUlzV3JpdGFibGU6IGZ1bmN0aW9uKG9iaiwgcHJvcCkge1xuICAgICAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwgcHJvcCk7XG4gICAgICAgICAgICByZXR1cm4gISEoIWRlc2NyaXB0b3IgfHwgZGVzY3JpcHRvci53cml0YWJsZSB8fCBkZXNjcmlwdG9yLnNldCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGhhcyA9IHt9Lmhhc093blByb3BlcnR5O1xuICAgICAgICB2YXIgc3RyID0ge30udG9TdHJpbmc7XG4gICAgICAgIHZhciBwcm90byA9IHt9LmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgICAgICAgdmFyIE9iamVjdEtleXMgPSBmdW5jdGlvbihvKSB7XG4gICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvKSB7XG4gICAgICAgICAgICBpZiAoaGFzLmNhbGwobywga2V5KSkge1xuICAgICAgICAgICAgICByZXQucHVzaChrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9O1xuICAgICAgICB2YXIgT2JqZWN0R2V0RGVzY3JpcHRvciA9IGZ1bmN0aW9uKG8sIGtleSkge1xuICAgICAgICAgIHJldHVybiB7dmFsdWU6IG9ba2V5XX07XG4gICAgICAgIH07XG4gICAgICAgIHZhciBPYmplY3REZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uKG8sIGtleSwgZGVzYykge1xuICAgICAgICAgIG9ba2V5XSA9IGRlc2MudmFsdWU7XG4gICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgIH07XG4gICAgICAgIHZhciBPYmplY3RGcmVlemUgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgT2JqZWN0R2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdChvYmopLmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvdG87XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgQXJyYXlJc0FycmF5ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBzdHIuY2FsbChvYmopID09PSBcIltvYmplY3QgQXJyYXldXCI7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgICAgICAgaXNBcnJheTogQXJyYXlJc0FycmF5LFxuICAgICAgICAgIGtleXM6IE9iamVjdEtleXMsXG4gICAgICAgICAgbmFtZXM6IE9iamVjdEtleXMsXG4gICAgICAgICAgZGVmaW5lUHJvcGVydHk6IE9iamVjdERlZmluZVByb3BlcnR5LFxuICAgICAgICAgIGdldERlc2NyaXB0b3I6IE9iamVjdEdldERlc2NyaXB0b3IsXG4gICAgICAgICAgZnJlZXplOiBPYmplY3RGcmVlemUsXG4gICAgICAgICAgZ2V0UHJvdG90eXBlT2Y6IE9iamVjdEdldFByb3RvdHlwZU9mLFxuICAgICAgICAgIGlzRVM1OiBpc0VTNSxcbiAgICAgICAgICBwcm9wZXJ0eUlzV3JpdGFibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sIHt9XSxcbiAgICAxNTogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG4gICAgICAgIHZhciBQcm9taXNlTWFwID0gUHJvbWlzZS5tYXA7XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uKGZuLCBvcHRpb25zKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2VNYXAodGhpcywgZm4sIG9wdGlvbnMsIElOVEVSTkFMKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5maWx0ZXIgPSBmdW5jdGlvbihwcm9taXNlcywgZm4sIG9wdGlvbnMpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZU1hcChwcm9taXNlcywgZm4sIG9wdGlvbnMsIElOVEVSTkFMKTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge31dLFxuICAgIDE2OiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgTkVYVF9GSUxURVIsIHRyeUNvbnZlcnRUb1Byb21pc2UpIHtcbiAgICAgICAgdmFyIHV0aWwgPSBfZGVyZXFfKFwiLi91dGlsLmpzXCIpO1xuICAgICAgICB2YXIgd3JhcHNQcmltaXRpdmVSZWNlaXZlciA9IHV0aWwud3JhcHNQcmltaXRpdmVSZWNlaXZlcjtcbiAgICAgICAgdmFyIGlzUHJpbWl0aXZlID0gdXRpbC5pc1ByaW1pdGl2ZTtcbiAgICAgICAgdmFyIHRocm93ZXIgPSB1dGlsLnRocm93ZXI7XG4gICAgICAgIGZ1bmN0aW9uIHJldHVyblRoaXMoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gdGhyb3dUaGlzKCkge1xuICAgICAgICAgIHRocm93IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gcmV0dXJuJChyKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiB0aHJvdyQocikge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRocm93IHI7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBwcm9taXNlZEZpbmFsbHkocmV0LCByZWFzb25PclZhbHVlLCBpc0Z1bGZpbGxlZCkge1xuICAgICAgICAgIHZhciB0aGVuO1xuICAgICAgICAgIGlmICh3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyICYmIGlzUHJpbWl0aXZlKHJlYXNvbk9yVmFsdWUpKSB7XG4gICAgICAgICAgICB0aGVuID0gaXNGdWxmaWxsZWQgPyByZXR1cm4kKHJlYXNvbk9yVmFsdWUpIDogdGhyb3ckKHJlYXNvbk9yVmFsdWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGVuID0gaXNGdWxmaWxsZWQgPyByZXR1cm5UaGlzIDogdGhyb3dUaGlzO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmV0Ll90aGVuKHRoZW4sIHRocm93ZXIsIHVuZGVmaW5lZCwgcmVhc29uT3JWYWx1ZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBmaW5hbGx5SGFuZGxlcihyZWFzb25PclZhbHVlKSB7XG4gICAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG4gICAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLmhhbmRsZXI7XG4gICAgICAgICAgdmFyIHJldCA9IHByb21pc2UuX2lzQm91bmQoKSA/IGhhbmRsZXIuY2FsbChwcm9taXNlLl9ib3VuZFRvKSA6IGhhbmRsZXIoKTtcbiAgICAgICAgICBpZiAocmV0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKHJldCwgcHJvbWlzZSk7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICBtYXliZVByb21pc2UgPSBtYXliZVByb21pc2UuX3RhcmdldCgpO1xuICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZWRGaW5hbGx5KG1heWJlUHJvbWlzZSwgcmVhc29uT3JWYWx1ZSwgcHJvbWlzZS5pc0Z1bGZpbGxlZCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHByb21pc2UuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgICAgICBORVhUX0ZJTFRFUi5lID0gcmVhc29uT3JWYWx1ZTtcbiAgICAgICAgICAgIHJldHVybiBORVhUX0ZJTFRFUjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJlYXNvbk9yVmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHRhcEhhbmRsZXIodmFsdWUpIHtcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcbiAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuaGFuZGxlcjtcbiAgICAgICAgICB2YXIgcmV0ID0gcHJvbWlzZS5faXNCb3VuZCgpID8gaGFuZGxlci5jYWxsKHByb21pc2UuX2JvdW5kVG8sIHZhbHVlKSA6IGhhbmRsZXIodmFsdWUpO1xuICAgICAgICAgIGlmIChyZXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IHRyeUNvbnZlcnRUb1Byb21pc2UocmV0LCBwcm9taXNlKTtcbiAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgIG1heWJlUHJvbWlzZSA9IG1heWJlUHJvbWlzZS5fdGFyZ2V0KCk7XG4gICAgICAgICAgICAgIHJldHVybiBwcm9taXNlZEZpbmFsbHkobWF5YmVQcm9taXNlLCB2YWx1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fcGFzc1Rocm91Z2hIYW5kbGVyID0gZnVuY3Rpb24oaGFuZGxlciwgaXNGaW5hbGx5KSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBoYW5kbGVyICE9PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKCk7XG4gICAgICAgICAgdmFyIHByb21pc2VBbmRIYW5kbGVyID0ge1xuICAgICAgICAgICAgcHJvbWlzZTogdGhpcyxcbiAgICAgICAgICAgIGhhbmRsZXI6IGhhbmRsZXJcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiB0aGlzLl90aGVuKGlzRmluYWxseSA/IGZpbmFsbHlIYW5kbGVyIDogdGFwSGFuZGxlciwgaXNGaW5hbGx5ID8gZmluYWxseUhhbmRsZXIgOiB1bmRlZmluZWQsIHVuZGVmaW5lZCwgcHJvbWlzZUFuZEhhbmRsZXIsIHVuZGVmaW5lZCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmxhc3RseSA9IFByb21pc2UucHJvdG90eXBlW1wiZmluYWxseVwiXSA9IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fcGFzc1Rocm91Z2hIYW5kbGVyKGhhbmRsZXIsIHRydWUpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS50YXAgPSBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3Bhc3NUaHJvdWdoSGFuZGxlcihoYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0sIHtcIi4vdXRpbC5qc1wiOiAzOH1dLFxuICAgIDE3OiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgYXBpUmVqZWN0aW9uLCBJTlRFUk5BTCwgdHJ5Q29udmVydFRvUHJvbWlzZSkge1xuICAgICAgICB2YXIgZXJyb3JzID0gX2RlcmVxXyhcIi4vZXJyb3JzLmpzXCIpO1xuICAgICAgICB2YXIgVHlwZUVycm9yID0gZXJyb3JzLlR5cGVFcnJvcjtcbiAgICAgICAgdmFyIHV0aWwgPSBfZGVyZXFfKFwiLi91dGlsLmpzXCIpO1xuICAgICAgICB2YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuICAgICAgICB2YXIgdHJ5Q2F0Y2ggPSB1dGlsLnRyeUNhdGNoO1xuICAgICAgICB2YXIgeWllbGRIYW5kbGVycyA9IFtdO1xuICAgICAgICBmdW5jdGlvbiBwcm9taXNlRnJvbVlpZWxkSGFuZGxlcih2YWx1ZSwgeWllbGRIYW5kbGVycywgdHJhY2VQYXJlbnQpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHlpZWxkSGFuZGxlcnMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHRyYWNlUGFyZW50Ll9wdXNoQ29udGV4dCgpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHlpZWxkSGFuZGxlcnNbaV0pKHZhbHVlKTtcbiAgICAgICAgICAgIHRyYWNlUGFyZW50Ll9wb3BDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgICB0cmFjZVBhcmVudC5fcHVzaENvbnRleHQoKTtcbiAgICAgICAgICAgICAgdmFyIHJldCA9IFByb21pc2UucmVqZWN0KGVycm9yT2JqLmUpO1xuICAgICAgICAgICAgICB0cmFjZVBhcmVudC5fcG9wQ29udGV4dCgpO1xuICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IHRyeUNvbnZlcnRUb1Byb21pc2UocmVzdWx0LCB0cmFjZVBhcmVudCk7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSlcbiAgICAgICAgICAgICAgcmV0dXJuIG1heWJlUHJvbWlzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gUHJvbWlzZVNwYXduKGdlbmVyYXRvckZ1bmN0aW9uLCByZWNlaXZlciwgeWllbGRIYW5kbGVyLCBzdGFjaykge1xuICAgICAgICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgICBwcm9taXNlLl9jYXB0dXJlU3RhY2tUcmFjZSgpO1xuICAgICAgICAgIHRoaXMuX3N0YWNrID0gc3RhY2s7XG4gICAgICAgICAgdGhpcy5fZ2VuZXJhdG9yRnVuY3Rpb24gPSBnZW5lcmF0b3JGdW5jdGlvbjtcbiAgICAgICAgICB0aGlzLl9yZWNlaXZlciA9IHJlY2VpdmVyO1xuICAgICAgICAgIHRoaXMuX2dlbmVyYXRvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB0aGlzLl95aWVsZEhhbmRsZXJzID0gdHlwZW9mIHlpZWxkSGFuZGxlciA9PT0gXCJmdW5jdGlvblwiID8gW3lpZWxkSGFuZGxlcl0uY29uY2F0KHlpZWxkSGFuZGxlcnMpIDogeWllbGRIYW5kbGVycztcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlU3Bhd24ucHJvdG90eXBlLnByb21pc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZVNwYXduLnByb3RvdHlwZS5fcnVuID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fZ2VuZXJhdG9yID0gdGhpcy5fZ2VuZXJhdG9yRnVuY3Rpb24uY2FsbCh0aGlzLl9yZWNlaXZlcik7XG4gICAgICAgICAgdGhpcy5fcmVjZWl2ZXIgPSB0aGlzLl9nZW5lcmF0b3JGdW5jdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB0aGlzLl9uZXh0KHVuZGVmaW5lZCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VTcGF3bi5wcm90b3R5cGUuX2NvbnRpbnVlID0gZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcm9taXNlLl9yZWplY3RDYWxsYmFjayhyZXN1bHQuZSwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgICAgICAgaWYgKHJlc3VsdC5kb25lID09PSB0cnVlKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9taXNlLl9yZXNvbHZlQ2FsbGJhY2sodmFsdWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gdHJ5Q29udmVydFRvUHJvbWlzZSh2YWx1ZSwgdGhpcy5fcHJvbWlzZSk7XG4gICAgICAgICAgICBpZiAoIShtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICAgICAgICBtYXliZVByb21pc2UgPSBwcm9taXNlRnJvbVlpZWxkSGFuZGxlcihtYXliZVByb21pc2UsIHRoaXMuX3lpZWxkSGFuZGxlcnMsIHRoaXMuX3Byb21pc2UpO1xuICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGhyb3cobmV3IFR5cGVFcnJvcihcIkEgdmFsdWUgJXMgd2FzIHlpZWxkZWQgdGhhdCBjb3VsZCBub3QgYmUgdHJlYXRlZCBhcyBhIHByb21pc2VcXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC80WTRwRGtcXHUwMDBhXFx1MDAwYVwiLnJlcGxhY2UoXCIlc1wiLCB2YWx1ZSkgKyBcIkZyb20gY29yb3V0aW5lOlxcdTAwMGFcIiArIHRoaXMuX3N0YWNrLnNwbGl0KFwiXFxuXCIpLnNsaWNlKDEsIC03KS5qb2luKFwiXFxuXCIpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXliZVByb21pc2UuX3RoZW4odGhpcy5fbmV4dCwgdGhpcy5fdGhyb3csIHVuZGVmaW5lZCwgdGhpcywgbnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlU3Bhd24ucHJvdG90eXBlLl90aHJvdyA9IGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgIHRoaXMuX3Byb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UocmVhc29uKTtcbiAgICAgICAgICB0aGlzLl9wcm9taXNlLl9wdXNoQ29udGV4dCgpO1xuICAgICAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLl9nZW5lcmF0b3JbXCJ0aHJvd1wiXSkuY2FsbCh0aGlzLl9nZW5lcmF0b3IsIHJlYXNvbik7XG4gICAgICAgICAgdGhpcy5fcHJvbWlzZS5fcG9wQ29udGV4dCgpO1xuICAgICAgICAgIHRoaXMuX2NvbnRpbnVlKHJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VTcGF3bi5wcm90b3R5cGUuX25leHQgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIHRoaXMuX3Byb21pc2UuX3B1c2hDb250ZXh0KCk7XG4gICAgICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuX2dlbmVyYXRvci5uZXh0KS5jYWxsKHRoaXMuX2dlbmVyYXRvciwgdmFsdWUpO1xuICAgICAgICAgIHRoaXMuX3Byb21pc2UuX3BvcENvbnRleHQoKTtcbiAgICAgICAgICB0aGlzLl9jb250aW51ZShyZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLmNvcm91dGluZSA9IGZ1bmN0aW9uKGdlbmVyYXRvckZ1bmN0aW9uLCBvcHRpb25zKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBnZW5lcmF0b3JGdW5jdGlvbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZ2VuZXJhdG9yRnVuY3Rpb24gbXVzdCBiZSBhIGZ1bmN0aW9uXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvNlZxaG0wXFx1MDAwYVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHlpZWxkSGFuZGxlciA9IE9iamVjdChvcHRpb25zKS55aWVsZEhhbmRsZXI7XG4gICAgICAgICAgdmFyIFByb21pc2VTcGF3biQgPSBQcm9taXNlU3Bhd247XG4gICAgICAgICAgdmFyIHN0YWNrID0gbmV3IEVycm9yKCkuc3RhY2s7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGdlbmVyYXRvciA9IGdlbmVyYXRvckZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB2YXIgc3Bhd24gPSBuZXcgUHJvbWlzZVNwYXduJCh1bmRlZmluZWQsIHVuZGVmaW5lZCwgeWllbGRIYW5kbGVyLCBzdGFjayk7XG4gICAgICAgICAgICBzcGF3bi5fZ2VuZXJhdG9yID0gZ2VuZXJhdG9yO1xuICAgICAgICAgICAgc3Bhd24uX25leHQodW5kZWZpbmVkKTtcbiAgICAgICAgICAgIHJldHVybiBzcGF3bi5wcm9taXNlKCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5jb3JvdXRpbmUuYWRkWWllbGRIYW5kbGVyID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvOTE2bEpKXFx1MDAwYVwiKTtcbiAgICAgICAgICB5aWVsZEhhbmRsZXJzLnB1c2goZm4pO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnNwYXduID0gZnVuY3Rpb24oZ2VuZXJhdG9yRnVuY3Rpb24pIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGdlbmVyYXRvckZ1bmN0aW9uICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJnZW5lcmF0b3JGdW5jdGlvbiBtdXN0IGJlIGEgZnVuY3Rpb25cXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC82VnFobTBcXHUwMDBhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgc3Bhd24gPSBuZXcgUHJvbWlzZVNwYXduKGdlbmVyYXRvckZ1bmN0aW9uLCB0aGlzKTtcbiAgICAgICAgICB2YXIgcmV0ID0gc3Bhd24ucHJvbWlzZSgpO1xuICAgICAgICAgIHNwYXduLl9ydW4oUHJvbWlzZS5zcGF3bik7XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge1xuICAgICAgXCIuL2Vycm9ycy5qc1wiOiAxMyxcbiAgICAgIFwiLi91dGlsLmpzXCI6IDM4XG4gICAgfV0sXG4gICAgMTg6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIHRyeUNvbnZlcnRUb1Byb21pc2UsIElOVEVSTkFMKSB7XG4gICAgICAgIHZhciB1dGlsID0gX2RlcmVxXyhcIi4vdXRpbC5qc1wiKTtcbiAgICAgICAgdmFyIGNhbkV2YWx1YXRlID0gdXRpbC5jYW5FdmFsdWF0ZTtcbiAgICAgICAgdmFyIHRyeUNhdGNoID0gdXRpbC50cnlDYXRjaDtcbiAgICAgICAgdmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbiAgICAgICAgdmFyIHJlamVjdDtcbiAgICAgICAgaWYgKCF0cnVlKSB7XG4gICAgICAgICAgaWYgKGNhbkV2YWx1YXRlKSB7XG4gICAgICAgICAgICB2YXIgdGhlbkNhbGxiYWNrID0gZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwidmFsdWVcIiwgXCJob2xkZXJcIiwgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBob2xkZXIucEluZGV4ID0gdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBob2xkZXIuY2hlY2tGdWxmaWxsbWVudCh0aGlzKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIi5yZXBsYWNlKC9JbmRleC9nLCBpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGNhbGxlciA9IGZ1bmN0aW9uKGNvdW50KSB7XG4gICAgICAgICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gY291bnQ7ICsraSlcbiAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChcImhvbGRlci5wXCIgKyBpKTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcImhvbGRlclwiLCBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IGhvbGRlci5mbjsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayh2YWx1ZXMpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiLnJlcGxhY2UoL3ZhbHVlcy9nLCB2YWx1ZXMuam9pbihcIiwgXCIpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHRoZW5DYWxsYmFja3MgPSBbXTtcbiAgICAgICAgICAgIHZhciBjYWxsZXJzID0gW3VuZGVmaW5lZF07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSA1OyArK2kpIHtcbiAgICAgICAgICAgICAgdGhlbkNhbGxiYWNrcy5wdXNoKHRoZW5DYWxsYmFjayhpKSk7XG4gICAgICAgICAgICAgIGNhbGxlcnMucHVzaChjYWxsZXIoaSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIEhvbGRlciA9IGZ1bmN0aW9uKHRvdGFsLCBmbikge1xuICAgICAgICAgICAgICB0aGlzLnAxID0gdGhpcy5wMiA9IHRoaXMucDMgPSB0aGlzLnA0ID0gdGhpcy5wNSA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMuZm4gPSBmbjtcbiAgICAgICAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICAgICAgICAgICAgICB0aGlzLm5vdyA9IDA7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgSG9sZGVyLnByb3RvdHlwZS5jYWxsZXJzID0gY2FsbGVycztcbiAgICAgICAgICAgIEhvbGRlci5wcm90b3R5cGUuY2hlY2tGdWxmaWxsbWVudCA9IGZ1bmN0aW9uKHByb21pc2UpIHtcbiAgICAgICAgICAgICAgdmFyIG5vdyA9IHRoaXMubm93O1xuICAgICAgICAgICAgICBub3crKztcbiAgICAgICAgICAgICAgdmFyIHRvdGFsID0gdGhpcy50b3RhbDtcbiAgICAgICAgICAgICAgaWYgKG5vdyA+PSB0b3RhbCkge1xuICAgICAgICAgICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5jYWxsZXJzW3RvdGFsXTtcbiAgICAgICAgICAgICAgICBwcm9taXNlLl9wdXNoQ29udGV4dCgpO1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0cnlDYXRjaChoYW5kbGVyKSh0aGlzKTtcbiAgICAgICAgICAgICAgICBwcm9taXNlLl9wb3BDb250ZXh0KCk7XG4gICAgICAgICAgICAgICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICAgIHByb21pc2UuX3JlamVjdENhbGxiYWNrKHJldC5lLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHByb21pc2UuX3Jlc29sdmVDYWxsYmFjayhyZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdyA9IG5vdztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciByZWplY3QgPSBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgdGhpcy5fcmVqZWN0KHJlYXNvbik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLmpvaW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgbGFzdCA9IGFyZ3VtZW50cy5sZW5ndGggLSAxO1xuICAgICAgICAgIHZhciBmbjtcbiAgICAgICAgICBpZiAobGFzdCA+IDAgJiYgdHlwZW9mIGFyZ3VtZW50c1tsYXN0XSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBmbiA9IGFyZ3VtZW50c1tsYXN0XTtcbiAgICAgICAgICAgIGlmICghdHJ1ZSkge1xuICAgICAgICAgICAgICBpZiAobGFzdCA8IDYgJiYgY2FuRXZhbHVhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgICAgICAgIHJldC5fY2FwdHVyZVN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgICAgICB2YXIgaG9sZGVyID0gbmV3IEhvbGRlcihsYXN0LCBmbik7XG4gICAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrcyA9IHRoZW5DYWxsYmFja3M7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsYXN0OyArK2kpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKGFyZ3VtZW50c1tpXSwgcmV0KTtcbiAgICAgICAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZSA9IG1heWJlUHJvbWlzZS5fdGFyZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UuX2lzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl90aGVuKGNhbGxiYWNrc1tpXSwgcmVqZWN0LCB1bmRlZmluZWQsIHJldCwgaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuX2lzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3NbaV0uY2FsbChyZXQsIG1heWJlUHJvbWlzZS5fdmFsdWUoKSwgaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXQuX3JlamVjdChtYXliZVByb21pc2UuX3JlYXNvbigpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzW2ldLmNhbGwocmV0LCBtYXliZVByb21pc2UsIGhvbGRlcik7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyICRfbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgICAgICB2YXIgYXJncyA9IG5ldyBBcnJheSgkX2xlbik7XG4gICAgICAgICAgZm9yICh2YXIgJF9pID0gMDsgJF9pIDwgJF9sZW47ICsrJF9pKSB7XG4gICAgICAgICAgICBhcmdzWyRfaV0gPSBhcmd1bWVudHNbJF9pXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZuKVxuICAgICAgICAgICAgYXJncy5wb3AoKTtcbiAgICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2VBcnJheShhcmdzKS5wcm9taXNlKCk7XG4gICAgICAgICAgcmV0dXJuIGZuICE9PSB1bmRlZmluZWQgPyByZXQuc3ByZWFkKGZuKSA6IHJldDtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge1wiLi91dGlsLmpzXCI6IDM4fV0sXG4gICAgMTk6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIGFwaVJlamVjdGlvbiwgdHJ5Q29udmVydFRvUHJvbWlzZSwgSU5URVJOQUwpIHtcbiAgICAgICAgdmFyIHV0aWwgPSBfZGVyZXFfKFwiLi91dGlsLmpzXCIpO1xuICAgICAgICB2YXIgdHJ5Q2F0Y2ggPSB1dGlsLnRyeUNhdGNoO1xuICAgICAgICB2YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuICAgICAgICB2YXIgUEVORElORyA9IHt9O1xuICAgICAgICB2YXIgRU1QVFlfQVJSQVkgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gTWFwcGluZ1Byb21pc2VBcnJheShwcm9taXNlcywgZm4sIGxpbWl0LCBfZmlsdGVyKSB7XG4gICAgICAgICAgdGhpcy5jb25zdHJ1Y3RvciQocHJvbWlzZXMpO1xuICAgICAgICAgIHRoaXMuX3Byb21pc2UuX2NhcHR1cmVTdGFja1RyYWNlKCk7XG4gICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBmbjtcbiAgICAgICAgICB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXMgPSBfZmlsdGVyID09PSBJTlRFUk5BTCA/IG5ldyBBcnJheSh0aGlzLmxlbmd0aCgpKSA6IG51bGw7XG4gICAgICAgICAgdGhpcy5fbGltaXQgPSBsaW1pdDtcbiAgICAgICAgICB0aGlzLl9pbkZsaWdodCA9IDA7XG4gICAgICAgICAgdGhpcy5fcXVldWUgPSBsaW1pdCA+PSAxID8gW10gOiBFTVBUWV9BUlJBWTtcbiAgICAgICAgICB0aGlzLl9pbml0JCh1bmRlZmluZWQsIC0yKTtcbiAgICAgICAgfVxuICAgICAgICB1dGlsLmluaGVyaXRzKE1hcHBpbmdQcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG4gICAgICAgIE1hcHBpbmdQcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgICAgTWFwcGluZ1Byb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPSBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy5fdmFsdWVzO1xuICAgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xuICAgICAgICAgIHZhciBwcmVzZXJ2ZWRWYWx1ZXMgPSB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXM7XG4gICAgICAgICAgdmFyIGxpbWl0ID0gdGhpcy5fbGltaXQ7XG4gICAgICAgICAgaWYgKHZhbHVlc1tpbmRleF0gPT09IFBFTkRJTkcpIHtcbiAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChsaW1pdCA+PSAxKSB7XG4gICAgICAgICAgICAgIHRoaXMuX2luRmxpZ2h0LS07XG4gICAgICAgICAgICAgIHRoaXMuX2RyYWluUXVldWUoKTtcbiAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChsaW1pdCA+PSAxICYmIHRoaXMuX2luRmxpZ2h0ID49IGxpbWl0KSB7XG4gICAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgdGhpcy5fcXVldWUucHVzaChpbmRleCk7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGwpXG4gICAgICAgICAgICAgIHByZXNlcnZlZFZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IHRoaXMuX2NhbGxiYWNrO1xuICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gdGhpcy5fcHJvbWlzZS5fYm91bmRUbztcbiAgICAgICAgICAgIHRoaXMuX3Byb21pc2UuX3B1c2hDb250ZXh0KCk7XG4gICAgICAgICAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2goY2FsbGJhY2spLmNhbGwocmVjZWl2ZXIsIHZhbHVlLCBpbmRleCwgbGVuZ3RoKTtcbiAgICAgICAgICAgIHRoaXMuX3Byb21pc2UuX3BvcENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKVxuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0KHJldC5lKTtcbiAgICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKHJldCwgdGhpcy5fcHJvbWlzZSk7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICBtYXliZVByb21pc2UgPSBtYXliZVByb21pc2UuX3RhcmdldCgpO1xuICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlLl9pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgIGlmIChsaW1pdCA+PSAxKVxuICAgICAgICAgICAgICAgICAgdGhpcy5faW5GbGlnaHQrKztcbiAgICAgICAgICAgICAgICB2YWx1ZXNbaW5kZXhdID0gUEVORElORztcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCBpbmRleCk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAobWF5YmVQcm9taXNlLl9pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gbWF5YmVQcm9taXNlLl92YWx1ZSgpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWplY3QobWF5YmVQcm9taXNlLl9yZWFzb24oKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSByZXQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciB0b3RhbFJlc29sdmVkID0gKyt0aGlzLl90b3RhbFJlc29sdmVkO1xuICAgICAgICAgIGlmICh0b3RhbFJlc29sdmVkID49IGxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHByZXNlcnZlZFZhbHVlcyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICB0aGlzLl9maWx0ZXIodmFsdWVzLCBwcmVzZXJ2ZWRWYWx1ZXMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh2YWx1ZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTWFwcGluZ1Byb21pc2VBcnJheS5wcm90b3R5cGUuX2RyYWluUXVldWUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgcXVldWUgPSB0aGlzLl9xdWV1ZTtcbiAgICAgICAgICB2YXIgbGltaXQgPSB0aGlzLl9saW1pdDtcbiAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy5fdmFsdWVzO1xuICAgICAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwICYmIHRoaXMuX2luRmxpZ2h0IDwgbGltaXQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpXG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHF1ZXVlLnBvcCgpO1xuICAgICAgICAgICAgdGhpcy5fcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZXNbaW5kZXhdLCBpbmRleCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZmlsdGVyID0gZnVuY3Rpb24oYm9vbGVhbnMsIHZhbHVlcykge1xuICAgICAgICAgIHZhciBsZW4gPSB2YWx1ZXMubGVuZ3RoO1xuICAgICAgICAgIHZhciByZXQgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICAgICAgaWYgKGJvb2xlYW5zW2ldKVxuICAgICAgICAgICAgICByZXRbaisrXSA9IHZhbHVlc1tpXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0Lmxlbmd0aCA9IGo7XG4gICAgICAgICAgdGhpcy5fcmVzb2x2ZShyZXQpO1xuICAgICAgICB9O1xuICAgICAgICBNYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5wcmVzZXJ2ZWRWYWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fcHJlc2VydmVkVmFsdWVzO1xuICAgICAgICB9O1xuICAgICAgICBmdW5jdGlvbiBtYXAocHJvbWlzZXMsIGZuLCBvcHRpb25zLCBfZmlsdGVyKSB7XG4gICAgICAgICAgdmFyIGxpbWl0ID0gdHlwZW9mIG9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgb3B0aW9ucyAhPT0gbnVsbCA/IG9wdGlvbnMuY29uY3VycmVuY3kgOiAwO1xuICAgICAgICAgIGxpbWl0ID0gdHlwZW9mIGxpbWl0ID09PSBcIm51bWJlclwiICYmIGlzRmluaXRlKGxpbWl0KSAmJiBsaW1pdCA+PSAxID8gbGltaXQgOiAwO1xuICAgICAgICAgIHJldHVybiBuZXcgTWFwcGluZ1Byb21pc2VBcnJheShwcm9taXNlcywgZm4sIGxpbWl0LCBfZmlsdGVyKTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbihmbiwgb3B0aW9ucykge1xuICAgICAgICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIilcbiAgICAgICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC85MTZsSkpcXHUwMDBhXCIpO1xuICAgICAgICAgIHJldHVybiBtYXAodGhpcywgZm4sIG9wdGlvbnMsIG51bGwpLnByb21pc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5tYXAgPSBmdW5jdGlvbihwcm9taXNlcywgZm4sIG9wdGlvbnMsIF9maWx0ZXIpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvOTE2bEpKXFx1MDAwYVwiKTtcbiAgICAgICAgICByZXR1cm4gbWFwKHByb21pc2VzLCBmbiwgb3B0aW9ucywgX2ZpbHRlcikucHJvbWlzZSgpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9LCB7XCIuL3V0aWwuanNcIjogMzh9XSxcbiAgICAyMDogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMLCB0cnlDb252ZXJ0VG9Qcm9taXNlLCBhcGlSZWplY3Rpb24pIHtcbiAgICAgICAgdmFyIHV0aWwgPSBfZGVyZXFfKFwiLi91dGlsLmpzXCIpO1xuICAgICAgICB2YXIgdHJ5Q2F0Y2ggPSB1dGlsLnRyeUNhdGNoO1xuICAgICAgICBQcm9taXNlLm1ldGhvZCA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUHJvbWlzZS5UeXBlRXJyb3IoXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC85MTZsSkpcXHUwMDBhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgICAgcmV0Ll9jYXB0dXJlU3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgcmV0Ll9wdXNoQ29udGV4dCgpO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdHJ5Q2F0Y2goZm4pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICByZXQuX3BvcENvbnRleHQoKTtcbiAgICAgICAgICAgIHJldC5fcmVzb2x2ZUZyb21TeW5jVmFsdWUodmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLmF0dGVtcHQgPSBQcm9taXNlW1widHJ5XCJdID0gZnVuY3Rpb24oZm4sIGFyZ3MsIGN0eCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsLzkxNmxKSlxcdTAwMGFcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgcmV0Ll9jYXB0dXJlU3RhY2tUcmFjZSgpO1xuICAgICAgICAgIHJldC5fcHVzaENvbnRleHQoKTtcbiAgICAgICAgICB2YXIgdmFsdWUgPSB1dGlsLmlzQXJyYXkoYXJncykgPyB0cnlDYXRjaChmbikuYXBwbHkoY3R4LCBhcmdzKSA6IHRyeUNhdGNoKGZuKS5jYWxsKGN0eCwgYXJncyk7XG4gICAgICAgICAgcmV0Ll9wb3BDb250ZXh0KCk7XG4gICAgICAgICAgcmV0Ll9yZXNvbHZlRnJvbVN5bmNWYWx1ZSh2YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Jlc29sdmVGcm9tU3luY1ZhbHVlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBpZiAodmFsdWUgPT09IHV0aWwuZXJyb3JPYmopIHtcbiAgICAgICAgICAgIHRoaXMuX3JlamVjdENhbGxiYWNrKHZhbHVlLmUsIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZUNhbGxiYWNrKHZhbHVlLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0sIHtcIi4vdXRpbC5qc1wiOiAzOH1dLFxuICAgIDIxOiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xuICAgICAgICB2YXIgdXRpbCA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIik7XG4gICAgICAgIHZhciBhc3luYyA9IF9kZXJlcV8oXCIuL2FzeW5jLmpzXCIpO1xuICAgICAgICB2YXIgdHJ5Q2F0Y2ggPSB1dGlsLnRyeUNhdGNoO1xuICAgICAgICB2YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuICAgICAgICBmdW5jdGlvbiBzcHJlYWRBZGFwdGVyKHZhbCwgbm9kZWJhY2spIHtcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gICAgICAgICAgaWYgKCF1dGlsLmlzQXJyYXkodmFsKSlcbiAgICAgICAgICAgIHJldHVybiBzdWNjZXNzQWRhcHRlci5jYWxsKHByb21pc2UsIHZhbCwgbm9kZWJhY2spO1xuICAgICAgICAgIHZhciByZXQgPSB0cnlDYXRjaChub2RlYmFjaykuYXBwbHkocHJvbWlzZS5fYm91bmRUbywgW251bGxdLmNvbmNhdCh2YWwpKTtcbiAgICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgYXN5bmMudGhyb3dMYXRlcihyZXQuZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3NBZGFwdGVyKHZhbCwgbm9kZWJhY2spIHtcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gICAgICAgICAgdmFyIHJlY2VpdmVyID0gcHJvbWlzZS5fYm91bmRUbztcbiAgICAgICAgICB2YXIgcmV0ID0gdmFsID09PSB1bmRlZmluZWQgPyB0cnlDYXRjaChub2RlYmFjaykuY2FsbChyZWNlaXZlciwgbnVsbCkgOiB0cnlDYXRjaChub2RlYmFjaykuY2FsbChyZWNlaXZlciwgbnVsbCwgdmFsKTtcbiAgICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgYXN5bmMudGhyb3dMYXRlcihyZXQuZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGVycm9yQWRhcHRlcihyZWFzb24sIG5vZGViYWNrKSB7XG4gICAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzO1xuICAgICAgICAgIGlmICghcmVhc29uKSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gcHJvbWlzZS5fdGFyZ2V0KCk7XG4gICAgICAgICAgICB2YXIgbmV3UmVhc29uID0gdGFyZ2V0Ll9nZXRDYXJyaWVkU3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgbmV3UmVhc29uLmNhdXNlID0gcmVhc29uO1xuICAgICAgICAgICAgcmVhc29uID0gbmV3UmVhc29uO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2gobm9kZWJhY2spLmNhbGwocHJvbWlzZS5fYm91bmRUbywgcmVhc29uKTtcbiAgICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgYXN5bmMudGhyb3dMYXRlcihyZXQuZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLm5vZGVpZnkgPSBmdW5jdGlvbihub2RlYmFjaywgb3B0aW9ucykge1xuICAgICAgICAgIGlmICh0eXBlb2Ygbm9kZWJhY2sgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB2YXIgYWRhcHRlciA9IHN1Y2Nlc3NBZGFwdGVyO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMgIT09IHVuZGVmaW5lZCAmJiBPYmplY3Qob3B0aW9ucykuc3ByZWFkKSB7XG4gICAgICAgICAgICAgIGFkYXB0ZXIgPSBzcHJlYWRBZGFwdGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fdGhlbihhZGFwdGVyLCBlcnJvckFkYXB0ZXIsIHVuZGVmaW5lZCwgdGhpcywgbm9kZWJhY2spO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge1xuICAgICAgXCIuL2FzeW5jLmpzXCI6IDIsXG4gICAgICBcIi4vdXRpbC5qc1wiOiAzOFxuICAgIH1dLFxuICAgIDIyOiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5KSB7XG4gICAgICAgIHZhciB1dGlsID0gX2RlcmVxXyhcIi4vdXRpbC5qc1wiKTtcbiAgICAgICAgdmFyIGFzeW5jID0gX2RlcmVxXyhcIi4vYXN5bmMuanNcIik7XG4gICAgICAgIHZhciB0cnlDYXRjaCA9IHV0aWwudHJ5Q2F0Y2g7XG4gICAgICAgIHZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLnByb2dyZXNzZWQgPSBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4odW5kZWZpbmVkLCB1bmRlZmluZWQsIGhhbmRsZXIsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Byb2dyZXNzID0gZnVuY3Rpb24ocHJvZ3Jlc3NWYWx1ZSkge1xuICAgICAgICAgIGlmICh0aGlzLl9pc0ZvbGxvd2luZ09yRnVsZmlsbGVkT3JSZWplY3RlZCgpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIHRoaXMuX3RhcmdldCgpLl9wcm9ncmVzc1VuY2hlY2tlZChwcm9ncmVzc1ZhbHVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Byb2dyZXNzSGFuZGxlckF0ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICByZXR1cm4gaW5kZXggPT09IDAgPyB0aGlzLl9wcm9ncmVzc0hhbmRsZXIwIDogdGhpc1soaW5kZXggPDwgMikgKyBpbmRleCAtIDUgKyAyXTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2RvUHJvZ3Jlc3NXaXRoID0gZnVuY3Rpb24ocHJvZ3Jlc3Npb24pIHtcbiAgICAgICAgICB2YXIgcHJvZ3Jlc3NWYWx1ZSA9IHByb2dyZXNzaW9uLnZhbHVlO1xuICAgICAgICAgIHZhciBoYW5kbGVyID0gcHJvZ3Jlc3Npb24uaGFuZGxlcjtcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHByb2dyZXNzaW9uLnByb21pc2U7XG4gICAgICAgICAgdmFyIHJlY2VpdmVyID0gcHJvZ3Jlc3Npb24ucmVjZWl2ZXI7XG4gICAgICAgICAgdmFyIHJldCA9IHRyeUNhdGNoKGhhbmRsZXIpLmNhbGwocmVjZWl2ZXIsIHByb2dyZXNzVmFsdWUpO1xuICAgICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICBpZiAocmV0LmUgIT0gbnVsbCAmJiByZXQuZS5uYW1lICE9PSBcIlN0b3BQcm9ncmVzc1Byb3BhZ2F0aW9uXCIpIHtcbiAgICAgICAgICAgICAgdmFyIHRyYWNlID0gdXRpbC5jYW5BdHRhY2hUcmFjZShyZXQuZSkgPyByZXQuZSA6IG5ldyBFcnJvcih1dGlsLnRvU3RyaW5nKHJldC5lKSk7XG4gICAgICAgICAgICAgIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICAgICAgICBwcm9taXNlLl9wcm9ncmVzcyhyZXQuZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChyZXQgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICByZXQuX3RoZW4ocHJvbWlzZS5fcHJvZ3Jlc3MsIG51bGwsIG51bGwsIHByb21pc2UsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb21pc2UuX3Byb2dyZXNzKHJldCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fcHJvZ3Jlc3NVbmNoZWNrZWQgPSBmdW5jdGlvbihwcm9ncmVzc1ZhbHVlKSB7XG4gICAgICAgICAgdmFyIGxlbiA9IHRoaXMuX2xlbmd0aCgpO1xuICAgICAgICAgIHZhciBwcm9ncmVzcyA9IHRoaXMuX3Byb2dyZXNzO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5fcHJvZ3Jlc3NIYW5kbGVyQXQoaSk7XG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2VBdChpKTtcbiAgICAgICAgICAgIGlmICghKHByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICAgICAgICB2YXIgcmVjZWl2ZXIgPSB0aGlzLl9yZWNlaXZlckF0KGkpO1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIGhhbmRsZXIuY2FsbChyZWNlaXZlciwgcHJvZ3Jlc3NWYWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgaW5zdGFuY2VvZiBQcm9taXNlQXJyYXkgJiYgIXJlY2VpdmVyLl9pc1Jlc29sdmVkKCkpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlci5fcHJvbWlzZVByb2dyZXNzZWQocHJvZ3Jlc3NWYWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fZG9Qcm9ncmVzc1dpdGgsIHRoaXMsIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVyOiBoYW5kbGVyLFxuICAgICAgICAgICAgICAgIHByb21pc2U6IHByb21pc2UsXG4gICAgICAgICAgICAgICAgcmVjZWl2ZXI6IHRoaXMuX3JlY2VpdmVyQXQoaSksXG4gICAgICAgICAgICAgICAgdmFsdWU6IHByb2dyZXNzVmFsdWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhc3luYy5pbnZva2UocHJvZ3Jlc3MsIHByb21pc2UsIHByb2dyZXNzVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge1xuICAgICAgXCIuL2FzeW5jLmpzXCI6IDIsXG4gICAgICBcIi4vdXRpbC5qc1wiOiAzOFxuICAgIH1dLFxuICAgIDIzOiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBtYWtlU2VsZlJlc29sdXRpb25FcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBuZXcgVHlwZUVycm9yKFwiY2lyY3VsYXIgcHJvbWlzZSByZXNvbHV0aW9uIGNoYWluXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvTGhGcG8wXFx1MDAwYVwiKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHJlZmxlY3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UuUHJvbWlzZUluc3BlY3Rpb24odGhpcy5fdGFyZ2V0KCkpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgYXBpUmVqZWN0aW9uID0gZnVuY3Rpb24obXNnKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBUeXBlRXJyb3IobXNnKSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB1dGlsID0gX2RlcmVxXyhcIi4vdXRpbC5qc1wiKTtcbiAgICAgICAgdmFyIGFzeW5jID0gX2RlcmVxXyhcIi4vYXN5bmMuanNcIik7XG4gICAgICAgIHZhciBlcnJvcnMgPSBfZGVyZXFfKFwiLi9lcnJvcnMuanNcIik7XG4gICAgICAgIHZhciBUeXBlRXJyb3IgPSBQcm9taXNlLlR5cGVFcnJvciA9IGVycm9ycy5UeXBlRXJyb3I7XG4gICAgICAgIFByb21pc2UuUmFuZ2VFcnJvciA9IGVycm9ycy5SYW5nZUVycm9yO1xuICAgICAgICBQcm9taXNlLkNhbmNlbGxhdGlvbkVycm9yID0gZXJyb3JzLkNhbmNlbGxhdGlvbkVycm9yO1xuICAgICAgICBQcm9taXNlLlRpbWVvdXRFcnJvciA9IGVycm9ycy5UaW1lb3V0RXJyb3I7XG4gICAgICAgIFByb21pc2UuT3BlcmF0aW9uYWxFcnJvciA9IGVycm9ycy5PcGVyYXRpb25hbEVycm9yO1xuICAgICAgICBQcm9taXNlLlJlamVjdGlvbkVycm9yID0gZXJyb3JzLk9wZXJhdGlvbmFsRXJyb3I7XG4gICAgICAgIFByb21pc2UuQWdncmVnYXRlRXJyb3IgPSBlcnJvcnMuQWdncmVnYXRlRXJyb3I7XG4gICAgICAgIHZhciBJTlRFUk5BTCA9IGZ1bmN0aW9uKCkge307XG4gICAgICAgIHZhciBBUFBMWSA9IHt9O1xuICAgICAgICB2YXIgTkVYVF9GSUxURVIgPSB7ZTogbnVsbH07XG4gICAgICAgIHZhciB0cnlDb252ZXJ0VG9Qcm9taXNlID0gX2RlcmVxXyhcIi4vdGhlbmFibGVzLmpzXCIpKFByb21pc2UsIElOVEVSTkFMKTtcbiAgICAgICAgdmFyIFByb21pc2VBcnJheSA9IF9kZXJlcV8oXCIuL3Byb21pc2VfYXJyYXkuanNcIikoUHJvbWlzZSwgSU5URVJOQUwsIHRyeUNvbnZlcnRUb1Byb21pc2UsIGFwaVJlamVjdGlvbik7XG4gICAgICAgIHZhciBDYXB0dXJlZFRyYWNlID0gX2RlcmVxXyhcIi4vY2FwdHVyZWRfdHJhY2UuanNcIikoKTtcbiAgICAgICAgdmFyIGlzRGVidWdnaW5nID0gX2RlcmVxXyhcIi4vZGVidWdnYWJpbGl0eS5qc1wiKShQcm9taXNlLCBDYXB0dXJlZFRyYWNlKTtcbiAgICAgICAgdmFyIGNyZWF0ZUNvbnRleHQgPSBfZGVyZXFfKFwiLi9jb250ZXh0LmpzXCIpKFByb21pc2UsIENhcHR1cmVkVHJhY2UsIGlzRGVidWdnaW5nKTtcbiAgICAgICAgdmFyIENhdGNoRmlsdGVyID0gX2RlcmVxXyhcIi4vY2F0Y2hfZmlsdGVyLmpzXCIpKE5FWFRfRklMVEVSKTtcbiAgICAgICAgdmFyIFByb21pc2VSZXNvbHZlciA9IF9kZXJlcV8oXCIuL3Byb21pc2VfcmVzb2x2ZXIuanNcIik7XG4gICAgICAgIHZhciBub2RlYmFja0ZvclByb21pc2UgPSBQcm9taXNlUmVzb2x2ZXIuX25vZGViYWNrRm9yUHJvbWlzZTtcbiAgICAgICAgdmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbiAgICAgICAgdmFyIHRyeUNhdGNoID0gdXRpbC50cnlDYXRjaDtcbiAgICAgICAgZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICAgICAgICAgIGlmICh0eXBlb2YgcmVzb2x2ZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcInRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIHJlcXVpcmVzIGEgcmVzb2x2ZXIgZnVuY3Rpb25cXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC9FQzIyWW5cXHUwMDBhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciAhPT0gUHJvbWlzZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcInRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBpbnZva2VkIGRpcmVjdGx5XFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvS3NJbGdlXFx1MDAwYVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5fYml0RmllbGQgPSAwO1xuICAgICAgICAgIHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjAgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgdGhpcy5fcmVqZWN0aW9uSGFuZGxlcjAgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgdGhpcy5fcHJvZ3Jlc3NIYW5kbGVyMCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB0aGlzLl9wcm9taXNlMCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB0aGlzLl9yZWNlaXZlcjAgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIGlmIChyZXNvbHZlciAhPT0gSU5URVJOQUwpXG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlRnJvbVJlc29sdmVyKHJlc29sdmVyKTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBcIltvYmplY3QgUHJvbWlzZV1cIjtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuY2F1Z2h0ID0gUHJvbWlzZS5wcm90b3R5cGVbXCJjYXRjaFwiXSA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgICAgaWYgKGxlbiA+IDEpIHtcbiAgICAgICAgICAgIHZhciBjYXRjaEluc3RhbmNlcyA9IG5ldyBBcnJheShsZW4gLSAxKSxcbiAgICAgICAgICAgICAgICBqID0gMCxcbiAgICAgICAgICAgICAgICBpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbiAtIDE7ICsraSkge1xuICAgICAgICAgICAgICB2YXIgaXRlbSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICBjYXRjaEluc3RhbmNlc1tqKytdID0gaXRlbTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcihcIkNhdGNoIGZpbHRlciBtdXN0IGluaGVyaXQgZnJvbSBFcnJvciBvciBiZSBhIHNpbXBsZSBwcmVkaWNhdGUgZnVuY3Rpb25cXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC9vODRvNjhcXHUwMDBhXCIpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2hJbnN0YW5jZXMubGVuZ3RoID0gajtcbiAgICAgICAgICAgIGZuID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgdmFyIGNhdGNoRmlsdGVyID0gbmV3IENhdGNoRmlsdGVyKGNhdGNoSW5zdGFuY2VzLCBmbiwgdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGhlbih1bmRlZmluZWQsIGNhdGNoRmlsdGVyLmRvRmlsdGVyLCB1bmRlZmluZWQsIGNhdGNoRmlsdGVyLCB1bmRlZmluZWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcy5fdGhlbih1bmRlZmluZWQsIGZuLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUucmVmbGVjdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl90aGVuKHJlZmxlY3QsIHJlZmxlY3QsIHVuZGVmaW5lZCwgdGhpcywgdW5kZWZpbmVkKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MpIHtcbiAgICAgICAgICBpZiAoaXNEZWJ1Z2dpbmcoKSAmJiBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiB0eXBlb2YgZGlkRnVsZmlsbCAhPT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBkaWRSZWplY3QgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdmFyIG1zZyA9IFwiLnRoZW4oKSBvbmx5IGFjY2VwdHMgZnVuY3Rpb25zIGJ1dCB3YXMgcGFzc2VkOiBcIiArIHV0aWwuY2xhc3NTdHJpbmcoZGlkRnVsZmlsbCk7XG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgbXNnICs9IFwiLCBcIiArIHV0aWwuY2xhc3NTdHJpbmcoZGlkUmVqZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3dhcm4obXNnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcywgdW5kZWZpbmVkLCB1bmRlZmluZWQpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5kb25lID0gZnVuY3Rpb24oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcykge1xuICAgICAgICAgIHZhciBwcm9taXNlID0gdGhpcy5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLCB1bmRlZmluZWQsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgcHJvbWlzZS5fc2V0SXNGaW5hbCgpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5zcHJlYWQgPSBmdW5jdGlvbihkaWRGdWxmaWxsLCBkaWRSZWplY3QpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5hbGwoKS5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIHVuZGVmaW5lZCwgQVBQTFksIHVuZGVmaW5lZCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmlzQ2FuY2VsbGFibGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gIXRoaXMuaXNSZXNvbHZlZCgpICYmIHRoaXMuX2NhbmNlbGxhYmxlKCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciByZXQgPSB7XG4gICAgICAgICAgICBpc0Z1bGZpbGxlZDogZmFsc2UsXG4gICAgICAgICAgICBpc1JlamVjdGVkOiBmYWxzZSxcbiAgICAgICAgICAgIGZ1bGZpbGxtZW50VmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHJlamVjdGlvblJlYXNvbjogdW5kZWZpbmVkXG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAodGhpcy5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICByZXQuZnVsZmlsbG1lbnRWYWx1ZSA9IHRoaXMudmFsdWUoKTtcbiAgICAgICAgICAgIHJldC5pc0Z1bGZpbGxlZCA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICAgICAgcmV0LnJlamVjdGlvblJlYXNvbiA9IHRoaXMucmVhc29uKCk7XG4gICAgICAgICAgICByZXQuaXNSZWplY3RlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmFsbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZUFycmF5KHRoaXMpLnByb21pc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgIHJldHVybiB0aGlzLmNhdWdodCh1dGlsLm9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uLCBmbik7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UuaXMgPSBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICByZXR1cm4gdmFsIGluc3RhbmNlb2YgUHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5mcm9tTm9kZSA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2goZm4pKG5vZGViYWNrRm9yUHJvbWlzZShyZXQpKTtcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgcmV0Ll9yZWplY3RDYWxsYmFjayhyZXN1bHQuZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UuYWxsID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2VBcnJheShwcm9taXNlcykucHJvbWlzZSgpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLmRlZmVyID0gUHJvbWlzZS5wZW5kaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlUmVzb2x2ZXIocHJvbWlzZSk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UuY2FzdCA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgIHZhciByZXQgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKG9iaik7XG4gICAgICAgICAgaWYgKCEocmV0IGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSByZXQ7XG4gICAgICAgICAgICByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgICByZXQuX2Z1bGZpbGxVbmNoZWNrZWQodmFsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlID0gUHJvbWlzZS5mdWxmaWxsZWQgPSBQcm9taXNlLmNhc3Q7XG4gICAgICAgIFByb21pc2UucmVqZWN0ID0gUHJvbWlzZS5yZWplY3RlZCA9IGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgcmV0Ll9jYXB0dXJlU3RhY2tUcmFjZSgpO1xuICAgICAgICAgIHJldC5fcmVqZWN0Q2FsbGJhY2socmVhc29uLCB0cnVlKTtcbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnNldFNjaGVkdWxlciA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsLzkxNmxKSlxcdTAwMGFcIik7XG4gICAgICAgICAgdmFyIHByZXYgPSBhc3luYy5fc2NoZWR1bGU7XG4gICAgICAgICAgYXN5bmMuX3NjaGVkdWxlID0gZm47XG4gICAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl90aGVuID0gZnVuY3Rpb24oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcywgcmVjZWl2ZXIsIGludGVybmFsRGF0YSkge1xuICAgICAgICAgIHZhciBoYXZlSW50ZXJuYWxEYXRhID0gaW50ZXJuYWxEYXRhICE9PSB1bmRlZmluZWQ7XG4gICAgICAgICAgdmFyIHJldCA9IGhhdmVJbnRlcm5hbERhdGEgPyBpbnRlcm5hbERhdGEgOiBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgaWYgKCFoYXZlSW50ZXJuYWxEYXRhKSB7XG4gICAgICAgICAgICByZXQuX3Byb3BhZ2F0ZUZyb20odGhpcywgNCB8IDEpO1xuICAgICAgICAgICAgcmV0Ll9jYXB0dXJlU3RhY2tUcmFjZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5fdGFyZ2V0KCk7XG4gICAgICAgICAgaWYgKHRhcmdldCAhPT0gdGhpcykge1xuICAgICAgICAgICAgaWYgKHJlY2VpdmVyID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgIHJlY2VpdmVyID0gdGhpcy5fYm91bmRUbztcbiAgICAgICAgICAgIGlmICghaGF2ZUludGVybmFsRGF0YSlcbiAgICAgICAgICAgICAgcmV0Ll9zZXRJc01pZ3JhdGVkKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjYWxsYmFja0luZGV4ID0gdGFyZ2V0Ll9hZGRDYWxsYmFja3MoZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcywgcmV0LCByZWNlaXZlcik7XG4gICAgICAgICAgaWYgKHRhcmdldC5faXNSZXNvbHZlZCgpICYmICF0YXJnZXQuX2lzU2V0dGxlUHJvbWlzZXNRdWV1ZWQoKSkge1xuICAgICAgICAgICAgYXN5bmMuaW52b2tlKHRhcmdldC5fc2V0dGxlUHJvbWlzZUF0UG9zdFJlc29sdXRpb24sIHRhcmdldCwgY2FsbGJhY2tJbmRleCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9zZXR0bGVQcm9taXNlQXRQb3N0UmVzb2x1dGlvbiA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2lzUmVqZWN0aW9uVW5oYW5kbGVkKCkpXG4gICAgICAgICAgICB0aGlzLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgdGhpcy5fc2V0dGxlUHJvbWlzZUF0KGluZGV4KTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2xlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iaXRGaWVsZCAmIDEzMTA3MTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDkzOTUyNDA5NikgPiAwO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5faXNGb2xsb3dpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNTM2ODcwOTEyKSA9PT0gNTM2ODcwOTEyO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fc2V0TGVuZ3RoID0gZnVuY3Rpb24obGVuKSB7XG4gICAgICAgICAgdGhpcy5fYml0RmllbGQgPSAodGhpcy5fYml0RmllbGQgJiAtMTMxMDcyKSB8IChsZW4gJiAxMzEwNzEpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fc2V0RnVsZmlsbGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDI2ODQzNTQ1NjtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldFJlamVjdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDEzNDIxNzcyODtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldEZvbGxvd2luZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCA1MzY4NzA5MTI7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9zZXRJc0ZpbmFsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDMzNTU0NDMyO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5faXNGaW5hbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAzMzU1NDQzMikgPiAwO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fY2FuY2VsbGFibGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNjcxMDg4NjQpID4gMDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldENhbmNlbGxhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDY3MTA4ODY0O1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fdW5zZXRDYW5jZWxsYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjY3MTA4ODY0KTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldElzTWlncmF0ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgNDE5NDMwNDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0SXNNaWdyYXRlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjQxOTQzMDQpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5faXNNaWdyYXRlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA0MTk0MzA0KSA+IDA7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9yZWNlaXZlckF0ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICB2YXIgcmV0ID0gaW5kZXggPT09IDAgPyB0aGlzLl9yZWNlaXZlcjAgOiB0aGlzW2luZGV4ICogNSAtIDUgKyA0XTtcbiAgICAgICAgICBpZiAocmV0ID09PSB1bmRlZmluZWQgJiYgdGhpcy5faXNCb3VuZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYm91bmRUbztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Byb21pc2VBdCA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgcmV0dXJuIGluZGV4ID09PSAwID8gdGhpcy5fcHJvbWlzZTAgOiB0aGlzW2luZGV4ICogNSAtIDUgKyAzXTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2Z1bGZpbGxtZW50SGFuZGxlckF0ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICByZXR1cm4gaW5kZXggPT09IDAgPyB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwIDogdGhpc1tpbmRleCAqIDUgLSA1ICsgMF07XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9yZWplY3Rpb25IYW5kbGVyQXQgPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgIHJldHVybiBpbmRleCA9PT0gMCA/IHRoaXMuX3JlamVjdGlvbkhhbmRsZXIwIDogdGhpc1tpbmRleCAqIDUgLSA1ICsgMV07XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9taWdyYXRlQ2FsbGJhY2tzID0gZnVuY3Rpb24oZm9sbG93ZXIsIGluZGV4KSB7XG4gICAgICAgICAgdmFyIGZ1bGZpbGwgPSBmb2xsb3dlci5fZnVsZmlsbG1lbnRIYW5kbGVyQXQoaW5kZXgpO1xuICAgICAgICAgIHZhciByZWplY3QgPSBmb2xsb3dlci5fcmVqZWN0aW9uSGFuZGxlckF0KGluZGV4KTtcbiAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSBmb2xsb3dlci5fcHJvZ3Jlc3NIYW5kbGVyQXQoaW5kZXgpO1xuICAgICAgICAgIHZhciBwcm9taXNlID0gZm9sbG93ZXIuX3Byb21pc2VBdChpbmRleCk7XG4gICAgICAgICAgdmFyIHJlY2VpdmVyID0gZm9sbG93ZXIuX3JlY2VpdmVyQXQoaW5kZXgpO1xuICAgICAgICAgIGlmIChwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSlcbiAgICAgICAgICAgIHByb21pc2UuX3NldElzTWlncmF0ZWQoKTtcbiAgICAgICAgICB0aGlzLl9hZGRDYWxsYmFja3MoZnVsZmlsbCwgcmVqZWN0LCBwcm9ncmVzcywgcHJvbWlzZSwgcmVjZWl2ZXIpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fYWRkQ2FsbGJhY2tzID0gZnVuY3Rpb24oZnVsZmlsbCwgcmVqZWN0LCBwcm9ncmVzcywgcHJvbWlzZSwgcmVjZWl2ZXIpIHtcbiAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9sZW5ndGgoKTtcbiAgICAgICAgICBpZiAoaW5kZXggPj0gMTMxMDcxIC0gNSkge1xuICAgICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICAgICAgdGhpcy5fc2V0TGVuZ3RoKDApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3Byb21pc2UwID0gcHJvbWlzZTtcbiAgICAgICAgICAgIGlmIChyZWNlaXZlciAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICB0aGlzLl9yZWNlaXZlcjAgPSByZWNlaXZlcjtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZnVsZmlsbCA9PT0gXCJmdW5jdGlvblwiICYmICF0aGlzLl9pc0NhcnJ5aW5nU3RhY2tUcmFjZSgpKVxuICAgICAgICAgICAgICB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwID0gZnVsZmlsbDtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVqZWN0ID09PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgICAgIHRoaXMuX3JlamVjdGlvbkhhbmRsZXIwID0gcmVqZWN0O1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9ncmVzcyA9PT0gXCJmdW5jdGlvblwiKVxuICAgICAgICAgICAgICB0aGlzLl9wcm9ncmVzc0hhbmRsZXIwID0gcHJvZ3Jlc3M7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBiYXNlID0gaW5kZXggKiA1IC0gNTtcbiAgICAgICAgICAgIHRoaXNbYmFzZSArIDNdID0gcHJvbWlzZTtcbiAgICAgICAgICAgIHRoaXNbYmFzZSArIDRdID0gcmVjZWl2ZXI7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGZ1bGZpbGwgPT09IFwiZnVuY3Rpb25cIilcbiAgICAgICAgICAgICAgdGhpc1tiYXNlICsgMF0gPSBmdWxmaWxsO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiByZWplY3QgPT09IFwiZnVuY3Rpb25cIilcbiAgICAgICAgICAgICAgdGhpc1tiYXNlICsgMV0gPSByZWplY3Q7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHByb2dyZXNzID09PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgICAgIHRoaXNbYmFzZSArIDJdID0gcHJvZ3Jlc3M7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX3NldExlbmd0aChpbmRleCArIDEpO1xuICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldFByb3h5SGFuZGxlcnMgPSBmdW5jdGlvbihyZWNlaXZlciwgcHJvbWlzZVNsb3RWYWx1ZSkge1xuICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuX2xlbmd0aCgpO1xuICAgICAgICAgIGlmIChpbmRleCA+PSAxMzEwNzEgLSA1KSB7XG4gICAgICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgICAgICB0aGlzLl9zZXRMZW5ndGgoMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5fcHJvbWlzZTAgPSBwcm9taXNlU2xvdFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fcmVjZWl2ZXIwID0gcmVjZWl2ZXI7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBiYXNlID0gaW5kZXggKiA1IC0gNTtcbiAgICAgICAgICAgIHRoaXNbYmFzZSArIDNdID0gcHJvbWlzZVNsb3RWYWx1ZTtcbiAgICAgICAgICAgIHRoaXNbYmFzZSArIDRdID0gcmVjZWl2ZXI7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX3NldExlbmd0aChpbmRleCArIDEpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fcHJveHlQcm9taXNlQXJyYXkgPSBmdW5jdGlvbihwcm9taXNlQXJyYXksIGluZGV4KSB7XG4gICAgICAgICAgdGhpcy5fc2V0UHJveHlIYW5kbGVycyhwcm9taXNlQXJyYXksIGluZGV4KTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Jlc29sdmVDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlLCBzaG91bGRCaW5kKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdENhbGxiYWNrKG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yKCksIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gdHJ5Q29udmVydFRvUHJvbWlzZSh2YWx1ZSwgdGhpcyk7XG4gICAgICAgICAgaWYgKCEobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZnVsZmlsbCh2YWx1ZSk7XG4gICAgICAgICAgdmFyIHByb3BhZ2F0aW9uRmxhZ3MgPSAxIHwgKHNob3VsZEJpbmQgPyA0IDogMCk7XG4gICAgICAgICAgdGhpcy5fcHJvcGFnYXRlRnJvbShtYXliZVByb21pc2UsIHByb3BhZ2F0aW9uRmxhZ3MpO1xuICAgICAgICAgIHZhciBwcm9taXNlID0gbWF5YmVQcm9taXNlLl90YXJnZXQoKTtcbiAgICAgICAgICBpZiAocHJvbWlzZS5faXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgICAgcHJvbWlzZS5fbWlncmF0ZUNhbGxiYWNrcyh0aGlzLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3NldEZvbGxvd2luZygpO1xuICAgICAgICAgICAgdGhpcy5fc2V0TGVuZ3RoKDApO1xuICAgICAgICAgICAgdGhpcy5fc2V0Rm9sbG93ZWUocHJvbWlzZSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChwcm9taXNlLl9pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICB0aGlzLl9mdWxmaWxsVW5jaGVja2VkKHByb21pc2UuX3ZhbHVlKCkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZWplY3RVbmNoZWNrZWQocHJvbWlzZS5fcmVhc29uKCksIHByb21pc2UuX2dldENhcnJpZWRTdGFja1RyYWNlKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3JlamVjdENhbGxiYWNrID0gZnVuY3Rpb24ocmVhc29uLCBzeW5jaHJvbm91cywgc2hvdWxkTm90TWFya09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbikge1xuICAgICAgICAgIGlmICghc2hvdWxkTm90TWFya09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbikge1xuICAgICAgICAgICAgdXRpbC5tYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24ocmVhc29uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHRyYWNlID0gdXRpbC5lbnN1cmVFcnJvck9iamVjdChyZWFzb24pO1xuICAgICAgICAgIHZhciBoYXNTdGFjayA9IHRyYWNlID09PSByZWFzb247XG4gICAgICAgICAgdGhpcy5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSwgc3luY2hyb25vdXMgPyBoYXNTdGFjayA6IGZhbHNlKTtcbiAgICAgICAgICB0aGlzLl9yZWplY3QocmVhc29uLCBoYXNTdGFjayA/IHVuZGVmaW5lZCA6IHRyYWNlKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Jlc29sdmVGcm9tUmVzb2x2ZXIgPSBmdW5jdGlvbihyZXNvbHZlcikge1xuICAgICAgICAgIHZhciBwcm9taXNlID0gdGhpcztcbiAgICAgICAgICB0aGlzLl9jYXB0dXJlU3RhY2tUcmFjZSgpO1xuICAgICAgICAgIHRoaXMuX3B1c2hDb250ZXh0KCk7XG4gICAgICAgICAgdmFyIHN5bmNocm9ub3VzID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgciA9IHRyeUNhdGNoKHJlc29sdmVyKShmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHByb21pc2UgPT09IG51bGwpXG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIHByb21pc2UuX3Jlc29sdmVDYWxsYmFjayh2YWx1ZSk7XG4gICAgICAgICAgICBwcm9taXNlID0gbnVsbDtcbiAgICAgICAgICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgIGlmIChwcm9taXNlID09PSBudWxsKVxuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBwcm9taXNlLl9yZWplY3RDYWxsYmFjayhyZWFzb24sIHN5bmNocm9ub3VzKTtcbiAgICAgICAgICAgIHByb21pc2UgPSBudWxsO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHN5bmNocm9ub3VzID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5fcG9wQ29udGV4dCgpO1xuICAgICAgICAgIGlmIChyICE9PSB1bmRlZmluZWQgJiYgciA9PT0gZXJyb3JPYmogJiYgcHJvbWlzZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0Q2FsbGJhY2soci5lLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgICAgIHByb21pc2UgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldHRsZVByb21pc2VGcm9tSGFuZGxlciA9IGZ1bmN0aW9uKGhhbmRsZXIsIHJlY2VpdmVyLCB2YWx1ZSwgcHJvbWlzZSkge1xuICAgICAgICAgIGlmIChwcm9taXNlLl9pc1JlamVjdGVkKCkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgcHJvbWlzZS5fcHVzaENvbnRleHQoKTtcbiAgICAgICAgICB2YXIgeDtcbiAgICAgICAgICBpZiAocmVjZWl2ZXIgPT09IEFQUExZICYmICF0aGlzLl9pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgICAgIHggPSB0cnlDYXRjaChoYW5kbGVyKS5hcHBseSh0aGlzLl9ib3VuZFRvLCB2YWx1ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHggPSB0cnlDYXRjaChoYW5kbGVyKS5jYWxsKHJlY2VpdmVyLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHByb21pc2UuX3BvcENvbnRleHQoKTtcbiAgICAgICAgICBpZiAoeCA9PT0gZXJyb3JPYmogfHwgeCA9PT0gcHJvbWlzZSB8fCB4ID09PSBORVhUX0ZJTFRFUikge1xuICAgICAgICAgICAgdmFyIGVyciA9IHggPT09IHByb21pc2UgPyBtYWtlU2VsZlJlc29sdXRpb25FcnJvcigpIDogeC5lO1xuICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0Q2FsbGJhY2soZXJyLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb21pc2UuX3Jlc29sdmVDYWxsYmFjayh4KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl90YXJnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgcmV0ID0gdGhpcztcbiAgICAgICAgICB3aGlsZSAocmV0Ll9pc0ZvbGxvd2luZygpKVxuICAgICAgICAgICAgcmV0ID0gcmV0Ll9mb2xsb3dlZSgpO1xuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9mb2xsb3dlZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9yZWplY3Rpb25IYW5kbGVyMDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldEZvbGxvd2VlID0gZnVuY3Rpb24ocHJvbWlzZSkge1xuICAgICAgICAgIHRoaXMuX3JlamVjdGlvbkhhbmRsZXIwID0gcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2NsZWFuVmFsdWVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2NhbmNlbGxhYmxlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2NhbmNlbGxhdGlvblBhcmVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9wcm9wYWdhdGVGcm9tID0gZnVuY3Rpb24ocGFyZW50LCBmbGFncykge1xuICAgICAgICAgIGlmICgoZmxhZ3MgJiAxKSA+IDAgJiYgcGFyZW50Ll9jYW5jZWxsYWJsZSgpKSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRDYW5jZWxsYWJsZSgpO1xuICAgICAgICAgICAgdGhpcy5fY2FuY2VsbGF0aW9uUGFyZW50ID0gcGFyZW50O1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoKGZsYWdzICYgNCkgPiAwICYmIHBhcmVudC5faXNCb3VuZCgpKSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRCb3VuZFRvKHBhcmVudC5fYm91bmRUbyk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fZnVsZmlsbCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgdGhpcy5fZnVsZmlsbFVuY2hlY2tlZCh2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9yZWplY3QgPSBmdW5jdGlvbihyZWFzb24sIGNhcnJpZWRTdGFja1RyYWNlKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgdGhpcy5fcmVqZWN0VW5jaGVja2VkKHJlYXNvbiwgY2FycmllZFN0YWNrVHJhY2UpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fc2V0dGxlUHJvbWlzZUF0ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2VBdChpbmRleCk7XG4gICAgICAgICAgdmFyIGlzUHJvbWlzZSA9IHByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlO1xuICAgICAgICAgIGlmIChpc1Byb21pc2UgJiYgcHJvbWlzZS5faXNNaWdyYXRlZCgpKSB7XG4gICAgICAgICAgICBwcm9taXNlLl91bnNldElzTWlncmF0ZWQoKTtcbiAgICAgICAgICAgIHJldHVybiBhc3luYy5pbnZva2UodGhpcy5fc2V0dGxlUHJvbWlzZUF0LCB0aGlzLCBpbmRleCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5faXNGdWxmaWxsZWQoKSA/IHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlckF0KGluZGV4KSA6IHRoaXMuX3JlamVjdGlvbkhhbmRsZXJBdChpbmRleCk7XG4gICAgICAgICAgdmFyIGNhcnJpZWRTdGFja1RyYWNlID0gdGhpcy5faXNDYXJyeWluZ1N0YWNrVHJhY2UoKSA/IHRoaXMuX2dldENhcnJpZWRTdGFja1RyYWNlKCkgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3JlY2VpdmVyQXQoaW5kZXgpO1xuICAgICAgICAgIHRoaXMuX2NsZWFyQ2FsbGJhY2tEYXRhQXRJbmRleChpbmRleCk7XG4gICAgICAgICAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGlmICghaXNQcm9taXNlKSB7XG4gICAgICAgICAgICAgIGhhbmRsZXIuY2FsbChyZWNlaXZlciwgdmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fc2V0dGxlUHJvbWlzZUZyb21IYW5kbGVyKGhhbmRsZXIsIHJlY2VpdmVyLCB2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlciBpbnN0YW5jZW9mIFByb21pc2VBcnJheSkge1xuICAgICAgICAgICAgaWYgKCFyZWNlaXZlci5faXNSZXNvbHZlZCgpKSB7XG4gICAgICAgICAgICAgIGlmICh0aGlzLl9pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIuX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlY2VpdmVyLl9wcm9taXNlUmVqZWN0ZWQodmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChpc1Byb21pc2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGwodmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHZhbHVlLCBjYXJyaWVkU3RhY2tUcmFjZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpbmRleCA+PSA0ICYmIChpbmRleCAmIDMxKSA9PT0gNClcbiAgICAgICAgICAgIGFzeW5jLmludm9rZUxhdGVyKHRoaXMuX3NldExlbmd0aCwgdGhpcywgMCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9jbGVhckNhbGxiYWNrRGF0YUF0SW5kZXggPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0NhcnJ5aW5nU3RhY2tUcmFjZSgpKSB7XG4gICAgICAgICAgICAgIHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjAgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9yZWplY3Rpb25IYW5kbGVyMCA9IHRoaXMuX3Byb2dyZXNzSGFuZGxlcjAgPSB0aGlzLl9yZWNlaXZlcjAgPSB0aGlzLl9wcm9taXNlMCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGJhc2UgPSBpbmRleCAqIDUgLSA1O1xuICAgICAgICAgICAgdGhpc1tiYXNlICsgM10gPSB0aGlzW2Jhc2UgKyA0XSA9IHRoaXNbYmFzZSArIDBdID0gdGhpc1tiYXNlICsgMV0gPSB0aGlzW2Jhc2UgKyAyXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9pc1NldHRsZVByb21pc2VzUXVldWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIC0xMDczNzQxODI0KSA9PT0gLTEwNzM3NDE4MjQ7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9zZXRTZXR0bGVQcm9taXNlc1F1ZXVlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAtMTA3Mzc0MTgyNDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0U2V0dGxlUHJvbWlzZXNRdWV1ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH4tMTA3Mzc0MTgyNCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9xdWV1ZVNldHRsZVByb21pc2VzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgYXN5bmMuc2V0dGxlUHJvbWlzZXModGhpcyk7XG4gICAgICAgICAgdGhpcy5fc2V0U2V0dGxlUHJvbWlzZXNRdWV1ZWQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX2Z1bGZpbGxVbmNoZWNrZWQgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcykge1xuICAgICAgICAgICAgdmFyIGVyciA9IG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yKCk7XG4gICAgICAgICAgICB0aGlzLl9hdHRhY2hFeHRyYVRyYWNlKGVycik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0VW5jaGVja2VkKGVyciwgdW5kZWZpbmVkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5fc2V0RnVsZmlsbGVkKCk7XG4gICAgICAgICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgdGhpcy5fY2xlYW5WYWx1ZXMoKTtcbiAgICAgICAgICBpZiAodGhpcy5fbGVuZ3RoKCkgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLl9xdWV1ZVNldHRsZVByb21pc2VzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0VW5jaGVja2VkQ2hlY2tFcnJvciA9IGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgIHZhciB0cmFjZSA9IHV0aWwuZW5zdXJlRXJyb3JPYmplY3QocmVhc29uKTtcbiAgICAgICAgICB0aGlzLl9yZWplY3RVbmNoZWNrZWQocmVhc29uLCB0cmFjZSA9PT0gcmVhc29uID8gdW5kZWZpbmVkIDogdHJhY2UpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0VW5jaGVja2VkID0gZnVuY3Rpb24ocmVhc29uLCB0cmFjZSkge1xuICAgICAgICAgIGlmIChyZWFzb24gPT09IHRoaXMpIHtcbiAgICAgICAgICAgIHZhciBlcnIgPSBtYWtlU2VsZlJlc29sdXRpb25FcnJvcigpO1xuICAgICAgICAgICAgdGhpcy5fYXR0YWNoRXh0cmFUcmFjZShlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdFVuY2hlY2tlZChlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLl9zZXRSZWplY3RlZCgpO1xuICAgICAgICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHJlYXNvbjtcbiAgICAgICAgICB0aGlzLl9jbGVhblZhbHVlcygpO1xuICAgICAgICAgIGlmICh0aGlzLl9pc0ZpbmFsKCkpIHtcbiAgICAgICAgICAgIGFzeW5jLnRocm93TGF0ZXIoZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICBpZiAoXCJzdGFja1wiIGluIGUpIHtcbiAgICAgICAgICAgICAgICBhc3luYy5pbnZva2VGaXJzdChDYXB0dXJlZFRyYWNlLnVuaGFuZGxlZFJlamVjdGlvbiwgdW5kZWZpbmVkLCBlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgfSwgdHJhY2UgPT09IHVuZGVmaW5lZCA/IHJlYXNvbiA6IHRyYWNlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRyYWNlICE9PSB1bmRlZmluZWQgJiYgdHJhY2UgIT09IHJlYXNvbikge1xuICAgICAgICAgICAgdGhpcy5fc2V0Q2FycmllZFN0YWNrVHJhY2UodHJhY2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5fbGVuZ3RoKCkgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLl9xdWV1ZVNldHRsZVByb21pc2VzKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldHRsZVByb21pc2VzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fdW5zZXRTZXR0bGVQcm9taXNlc1F1ZXVlZCgpO1xuICAgICAgICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLl9zZXR0bGVQcm9taXNlQXQoaSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLl9tYWtlU2VsZlJlc29sdXRpb25FcnJvciA9IG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yO1xuICAgICAgICBfZGVyZXFfKFwiLi9tZXRob2QuanNcIikoUHJvbWlzZSwgSU5URVJOQUwsIHRyeUNvbnZlcnRUb1Byb21pc2UsIGFwaVJlamVjdGlvbik7XG4gICAgICAgIF9kZXJlcV8oXCIuL2JpbmQuanNcIikoUHJvbWlzZSwgSU5URVJOQUwsIHRyeUNvbnZlcnRUb1Byb21pc2UpO1xuICAgICAgICBfZGVyZXFfKFwiLi9maW5hbGx5LmpzXCIpKFByb21pc2UsIE5FWFRfRklMVEVSLCB0cnlDb252ZXJ0VG9Qcm9taXNlKTtcbiAgICAgICAgX2RlcmVxXyhcIi4vZGlyZWN0X3Jlc29sdmUuanNcIikoUHJvbWlzZSk7XG4gICAgICAgIF9kZXJlcV8oXCIuL3N5bmNocm9ub3VzX2luc3BlY3Rpb24uanNcIikoUHJvbWlzZSk7XG4gICAgICAgIF9kZXJlcV8oXCIuL2pvaW4uanNcIikoUHJvbWlzZSwgUHJvbWlzZUFycmF5LCB0cnlDb252ZXJ0VG9Qcm9taXNlLCBJTlRFUk5BTCk7XG4gICAgICAgIFByb21pc2UuUHJvbWlzZSA9IFByb21pc2U7XG4gICAgICAgIF9kZXJlcV8oJy4vbWFwLmpzJykoUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBhcGlSZWplY3Rpb24sIHRyeUNvbnZlcnRUb1Byb21pc2UsIElOVEVSTkFMKTtcbiAgICAgICAgX2RlcmVxXygnLi91c2luZy5qcycpKFByb21pc2UsIGFwaVJlamVjdGlvbiwgdHJ5Q29udmVydFRvUHJvbWlzZSwgY3JlYXRlQ29udGV4dCk7XG4gICAgICAgIF9kZXJlcV8oJy4vZ2VuZXJhdG9ycy5qcycpKFByb21pc2UsIGFwaVJlamVjdGlvbiwgSU5URVJOQUwsIHRyeUNvbnZlcnRUb1Byb21pc2UpO1xuICAgICAgICBfZGVyZXFfKCcuL25vZGVpZnkuanMnKShQcm9taXNlKTtcbiAgICAgICAgX2RlcmVxXygnLi9jYW5jZWwuanMnKShQcm9taXNlKTtcbiAgICAgICAgX2RlcmVxXygnLi9wcm9taXNpZnkuanMnKShQcm9taXNlLCBJTlRFUk5BTCk7XG4gICAgICAgIF9kZXJlcV8oJy4vcHJvcHMuanMnKShQcm9taXNlLCBQcm9taXNlQXJyYXksIHRyeUNvbnZlcnRUb1Byb21pc2UsIGFwaVJlamVjdGlvbik7XG4gICAgICAgIF9kZXJlcV8oJy4vcmFjZS5qcycpKFByb21pc2UsIElOVEVSTkFMLCB0cnlDb252ZXJ0VG9Qcm9taXNlLCBhcGlSZWplY3Rpb24pO1xuICAgICAgICBfZGVyZXFfKCcuL3JlZHVjZS5qcycpKFByb21pc2UsIFByb21pc2VBcnJheSwgYXBpUmVqZWN0aW9uLCB0cnlDb252ZXJ0VG9Qcm9taXNlLCBJTlRFUk5BTCk7XG4gICAgICAgIF9kZXJlcV8oJy4vc2V0dGxlLmpzJykoUHJvbWlzZSwgUHJvbWlzZUFycmF5KTtcbiAgICAgICAgX2RlcmVxXygnLi9jYWxsX2dldC5qcycpKFByb21pc2UpO1xuICAgICAgICBfZGVyZXFfKCcuL3NvbWUuanMnKShQcm9taXNlLCBQcm9taXNlQXJyYXksIGFwaVJlamVjdGlvbik7XG4gICAgICAgIF9kZXJlcV8oJy4vcHJvZ3Jlc3MuanMnKShQcm9taXNlLCBQcm9taXNlQXJyYXkpO1xuICAgICAgICBfZGVyZXFfKCcuL2FueS5qcycpKFByb21pc2UpO1xuICAgICAgICBfZGVyZXFfKCcuL2VhY2guanMnKShQcm9taXNlLCBJTlRFUk5BTCk7XG4gICAgICAgIF9kZXJlcV8oJy4vdGltZXJzLmpzJykoUHJvbWlzZSwgSU5URVJOQUwpO1xuICAgICAgICBfZGVyZXFfKCcuL2ZpbHRlci5qcycpKFByb21pc2UsIElOVEVSTkFMKTtcbiAgICAgICAgdXRpbC50b0Zhc3RQcm9wZXJ0aWVzKFByb21pc2UpO1xuICAgICAgICB1dGlsLnRvRmFzdFByb3BlcnRpZXMoUHJvbWlzZS5wcm90b3R5cGUpO1xuICAgICAgICBmdW5jdGlvbiBmaWxsVHlwZXModmFsdWUpIHtcbiAgICAgICAgICB2YXIgcCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgICBwLl9mdWxmaWxsbWVudEhhbmRsZXIwID0gdmFsdWU7XG4gICAgICAgICAgcC5fcmVqZWN0aW9uSGFuZGxlcjAgPSB2YWx1ZTtcbiAgICAgICAgICBwLl9wcm9ncmVzc0hhbmRsZXIwID0gdmFsdWU7XG4gICAgICAgICAgcC5fcHJvbWlzZTAgPSB2YWx1ZTtcbiAgICAgICAgICBwLl9yZWNlaXZlcjAgPSB2YWx1ZTtcbiAgICAgICAgICBwLl9zZXR0bGVkVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBmaWxsVHlwZXMoe2E6IDF9KTtcbiAgICAgICAgZmlsbFR5cGVzKHtiOiAyfSk7XG4gICAgICAgIGZpbGxUeXBlcyh7YzogM30pO1xuICAgICAgICBmaWxsVHlwZXMoMSk7XG4gICAgICAgIGZpbGxUeXBlcyhmdW5jdGlvbigpIHt9KTtcbiAgICAgICAgZmlsbFR5cGVzKHVuZGVmaW5lZCk7XG4gICAgICAgIGZpbGxUeXBlcyhmYWxzZSk7XG4gICAgICAgIGZpbGxUeXBlcyhuZXcgUHJvbWlzZShJTlRFUk5BTCkpO1xuICAgICAgICBDYXB0dXJlZFRyYWNlLnNldEJvdW5kcyhhc3luYy5maXJzdExpbmVFcnJvciwgdXRpbC5sYXN0TGluZUVycm9yKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2U7XG4gICAgICB9O1xuICAgIH0sIHtcbiAgICAgIFwiLi9hbnkuanNcIjogMSxcbiAgICAgIFwiLi9hc3luYy5qc1wiOiAyLFxuICAgICAgXCIuL2JpbmQuanNcIjogMyxcbiAgICAgIFwiLi9jYWxsX2dldC5qc1wiOiA1LFxuICAgICAgXCIuL2NhbmNlbC5qc1wiOiA2LFxuICAgICAgXCIuL2NhcHR1cmVkX3RyYWNlLmpzXCI6IDcsXG4gICAgICBcIi4vY2F0Y2hfZmlsdGVyLmpzXCI6IDgsXG4gICAgICBcIi4vY29udGV4dC5qc1wiOiA5LFxuICAgICAgXCIuL2RlYnVnZ2FiaWxpdHkuanNcIjogMTAsXG4gICAgICBcIi4vZGlyZWN0X3Jlc29sdmUuanNcIjogMTEsXG4gICAgICBcIi4vZWFjaC5qc1wiOiAxMixcbiAgICAgIFwiLi9lcnJvcnMuanNcIjogMTMsXG4gICAgICBcIi4vZmlsdGVyLmpzXCI6IDE1LFxuICAgICAgXCIuL2ZpbmFsbHkuanNcIjogMTYsXG4gICAgICBcIi4vZ2VuZXJhdG9ycy5qc1wiOiAxNyxcbiAgICAgIFwiLi9qb2luLmpzXCI6IDE4LFxuICAgICAgXCIuL21hcC5qc1wiOiAxOSxcbiAgICAgIFwiLi9tZXRob2QuanNcIjogMjAsXG4gICAgICBcIi4vbm9kZWlmeS5qc1wiOiAyMSxcbiAgICAgIFwiLi9wcm9ncmVzcy5qc1wiOiAyMixcbiAgICAgIFwiLi9wcm9taXNlX2FycmF5LmpzXCI6IDI0LFxuICAgICAgXCIuL3Byb21pc2VfcmVzb2x2ZXIuanNcIjogMjUsXG4gICAgICBcIi4vcHJvbWlzaWZ5LmpzXCI6IDI2LFxuICAgICAgXCIuL3Byb3BzLmpzXCI6IDI3LFxuICAgICAgXCIuL3JhY2UuanNcIjogMjksXG4gICAgICBcIi4vcmVkdWNlLmpzXCI6IDMwLFxuICAgICAgXCIuL3NldHRsZS5qc1wiOiAzMixcbiAgICAgIFwiLi9zb21lLmpzXCI6IDMzLFxuICAgICAgXCIuL3N5bmNocm9ub3VzX2luc3BlY3Rpb24uanNcIjogMzQsXG4gICAgICBcIi4vdGhlbmFibGVzLmpzXCI6IDM1LFxuICAgICAgXCIuL3RpbWVycy5qc1wiOiAzNixcbiAgICAgIFwiLi91c2luZy5qc1wiOiAzNyxcbiAgICAgIFwiLi91dGlsLmpzXCI6IDM4XG4gICAgfV0sXG4gICAgMjQ6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCwgdHJ5Q29udmVydFRvUHJvbWlzZSwgYXBpUmVqZWN0aW9uKSB7XG4gICAgICAgIHZhciB1dGlsID0gX2RlcmVxXyhcIi4vdXRpbC5qc1wiKTtcbiAgICAgICAgdmFyIGlzQXJyYXkgPSB1dGlsLmlzQXJyYXk7XG4gICAgICAgIGZ1bmN0aW9uIHRvUmVzb2x1dGlvblZhbHVlKHZhbCkge1xuICAgICAgICAgIHN3aXRjaCAodmFsKSB7XG4gICAgICAgICAgICBjYXNlIC0yOlxuICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlIC0zOlxuICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIFByb21pc2VBcnJheSh2YWx1ZXMpIHtcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgdmFyIHBhcmVudDtcbiAgICAgICAgICBpZiAodmFsdWVzIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgcGFyZW50ID0gdmFsdWVzO1xuICAgICAgICAgICAgcHJvbWlzZS5fcHJvcGFnYXRlRnJvbShwYXJlbnQsIDEgfCA0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5fdmFsdWVzID0gdmFsdWVzO1xuICAgICAgICAgIHRoaXMuX2xlbmd0aCA9IDA7XG4gICAgICAgICAgdGhpcy5fdG90YWxSZXNvbHZlZCA9IDA7XG4gICAgICAgICAgdGhpcy5faW5pdCh1bmRlZmluZWQsIC0yKTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlQXJyYXkucHJvdG90eXBlLmxlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9sZW5ndGg7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VBcnJheS5wcm90b3R5cGUucHJvbWlzZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9wcm9taXNlO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24gaW5pdChfLCByZXNvbHZlVmFsdWVJZkVtcHR5KSB7XG4gICAgICAgICAgdmFyIHZhbHVlcyA9IHRyeUNvbnZlcnRUb1Byb21pc2UodGhpcy5fdmFsdWVzLCB0aGlzLl9wcm9taXNlKTtcbiAgICAgICAgICBpZiAodmFsdWVzIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgdmFsdWVzID0gdmFsdWVzLl90YXJnZXQoKTtcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlcyA9IHZhbHVlcztcbiAgICAgICAgICAgIGlmICh2YWx1ZXMuX2lzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgdmFsdWVzID0gdmFsdWVzLl92YWx1ZSgpO1xuICAgICAgICAgICAgICBpZiAoIWlzQXJyYXkodmFsdWVzKSkge1xuICAgICAgICAgICAgICAgIHZhciBlcnIgPSBuZXcgUHJvbWlzZS5UeXBlRXJyb3IoXCJleHBlY3RpbmcgYW4gYXJyYXksIGEgcHJvbWlzZSBvciBhIHRoZW5hYmxlXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvczhNTWhjXFx1MDAwYVwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9faGFyZFJlamVjdF9fKGVycik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlcy5faXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgICAgdmFsdWVzLl90aGVuKGluaXQsIHRoaXMuX3JlamVjdCwgdW5kZWZpbmVkLCB0aGlzLCByZXNvbHZlVmFsdWVJZkVtcHR5KTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fcmVqZWN0KHZhbHVlcy5fcmVhc29uKCkpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmICghaXNBcnJheSh2YWx1ZXMpKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9taXNlLl9yZWplY3QoYXBpUmVqZWN0aW9uKFwiZXhwZWN0aW5nIGFuIGFycmF5LCBhIHByb21pc2Ugb3IgYSB0aGVuYWJsZVxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsL3M4TU1oY1xcdTAwMGFcIikuX3JlYXNvbigpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGlmIChyZXNvbHZlVmFsdWVJZkVtcHR5ID09PSAtNSkge1xuICAgICAgICAgICAgICB0aGlzLl9yZXNvbHZlRW1wdHlBcnJheSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh0b1Jlc29sdXRpb25WYWx1ZShyZXNvbHZlVmFsdWVJZkVtcHR5KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBsZW4gPSB0aGlzLmdldEFjdHVhbExlbmd0aCh2YWx1ZXMubGVuZ3RoKTtcbiAgICAgICAgICB0aGlzLl9sZW5ndGggPSBsZW47XG4gICAgICAgICAgdGhpcy5fdmFsdWVzID0gdGhpcy5zaG91bGRDb3B5VmFsdWVzKCkgPyBuZXcgQXJyYXkobGVuKSA6IHRoaXMuX3ZhbHVlcztcbiAgICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2U7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICAgICAgdmFyIGlzUmVzb2x2ZWQgPSB0aGlzLl9pc1Jlc29sdmVkKCk7XG4gICAgICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gdHJ5Q29udmVydFRvUHJvbWlzZSh2YWx1ZXNbaV0sIHByb21pc2UpO1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgbWF5YmVQcm9taXNlID0gbWF5YmVQcm9taXNlLl90YXJnZXQoKTtcbiAgICAgICAgICAgICAgaWYgKGlzUmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuX2lzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCBpKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuX2lzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9taXNlRnVsZmlsbGVkKG1heWJlUHJvbWlzZS5fdmFsdWUoKSwgaSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvbWlzZVJlamVjdGVkKG1heWJlUHJvbWlzZS5fcmVhc29uKCksIGkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFpc1Jlc29sdmVkKSB7XG4gICAgICAgICAgICAgIHRoaXMuX3Byb21pc2VGdWxmaWxsZWQobWF5YmVQcm9taXNlLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VBcnJheS5wcm90b3R5cGUuX2lzUmVzb2x2ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWVzID09PSBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlQXJyYXkucHJvdG90eXBlLl9yZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICB0aGlzLl92YWx1ZXMgPSBudWxsO1xuICAgICAgICAgIHRoaXMuX3Byb21pc2UuX2Z1bGZpbGwodmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlQXJyYXkucHJvdG90eXBlLl9faGFyZFJlamVjdF9fID0gUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVqZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgdGhpcy5fdmFsdWVzID0gbnVsbDtcbiAgICAgICAgICB0aGlzLl9wcm9taXNlLl9yZWplY3RDYWxsYmFjayhyZWFzb24sIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVByb2dyZXNzZWQgPSBmdW5jdGlvbihwcm9ncmVzc1ZhbHVlLCBpbmRleCkge1xuICAgICAgICAgIHRoaXMuX3Byb21pc2UuX3Byb2dyZXNzKHtcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgICAgIHZhbHVlOiBwcm9ncmVzc1ZhbHVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPSBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgICB0aGlzLl92YWx1ZXNbaW5kZXhdID0gdmFsdWU7XG4gICAgICAgICAgdmFyIHRvdGFsUmVzb2x2ZWQgPSArK3RoaXMuX3RvdGFsUmVzb2x2ZWQ7XG4gICAgICAgICAgaWYgKHRvdGFsUmVzb2x2ZWQgPj0gdGhpcy5fbGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHRoaXMuX3ZhbHVlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUmVqZWN0ZWQgPSBmdW5jdGlvbihyZWFzb24sIGluZGV4KSB7XG4gICAgICAgICAgdGhpcy5fdG90YWxSZXNvbHZlZCsrO1xuICAgICAgICAgIHRoaXMuX3JlamVjdChyZWFzb24pO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlQXJyYXkucHJvdG90eXBlLnNob3VsZENvcHlWYWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZUFycmF5LnByb3RvdHlwZS5nZXRBY3R1YWxMZW5ndGggPSBmdW5jdGlvbihsZW4pIHtcbiAgICAgICAgICByZXR1cm4gbGVuO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gUHJvbWlzZUFycmF5O1xuICAgICAgfTtcbiAgICB9LCB7XCIuL3V0aWwuanNcIjogMzh9XSxcbiAgICAyNTogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICB2YXIgdXRpbCA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIik7XG4gICAgICB2YXIgbWF5YmVXcmFwQXNFcnJvciA9IHV0aWwubWF5YmVXcmFwQXNFcnJvcjtcbiAgICAgIHZhciBlcnJvcnMgPSBfZGVyZXFfKFwiLi9lcnJvcnMuanNcIik7XG4gICAgICB2YXIgVGltZW91dEVycm9yID0gZXJyb3JzLlRpbWVvdXRFcnJvcjtcbiAgICAgIHZhciBPcGVyYXRpb25hbEVycm9yID0gZXJyb3JzLk9wZXJhdGlvbmFsRXJyb3I7XG4gICAgICB2YXIgaGF2ZUdldHRlcnMgPSB1dGlsLmhhdmVHZXR0ZXJzO1xuICAgICAgdmFyIGVzNSA9IF9kZXJlcV8oXCIuL2VzNS5qc1wiKTtcbiAgICAgIGZ1bmN0aW9uIGlzVW50eXBlZEVycm9yKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqIGluc3RhbmNlb2YgRXJyb3IgJiYgZXM1LmdldFByb3RvdHlwZU9mKG9iaikgPT09IEVycm9yLnByb3RvdHlwZTtcbiAgICAgIH1cbiAgICAgIHZhciByRXJyb3JLZXkgPSAvXig/Om5hbWV8bWVzc2FnZXxzdGFja3xjYXVzZSkkLztcbiAgICAgIGZ1bmN0aW9uIHdyYXBBc09wZXJhdGlvbmFsRXJyb3Iob2JqKSB7XG4gICAgICAgIHZhciByZXQ7XG4gICAgICAgIGlmIChpc1VudHlwZWRFcnJvcihvYmopKSB7XG4gICAgICAgICAgcmV0ID0gbmV3IE9wZXJhdGlvbmFsRXJyb3Iob2JqKTtcbiAgICAgICAgICByZXQubmFtZSA9IG9iai5uYW1lO1xuICAgICAgICAgIHJldC5tZXNzYWdlID0gb2JqLm1lc3NhZ2U7XG4gICAgICAgICAgcmV0LnN0YWNrID0gb2JqLnN0YWNrO1xuICAgICAgICAgIHZhciBrZXlzID0gZXM1LmtleXMob2JqKTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgICAgaWYgKCFyRXJyb3JLZXkudGVzdChrZXkpKSB7XG4gICAgICAgICAgICAgIHJldFtrZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdXRpbC5tYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24ob2JqKTtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihlcnIsIHZhbHVlKSB7XG4gICAgICAgICAgaWYgKHByb21pc2UgPT09IG51bGwpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSB3cmFwQXNPcGVyYXRpb25hbEVycm9yKG1heWJlV3JhcEFzRXJyb3IoZXJyKSk7XG4gICAgICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHdyYXBwZWQpO1xuICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHdyYXBwZWQpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIHZhciAkX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgYXJncyA9IG5ldyBBcnJheSgkX2xlbiAtIDEpO1xuICAgICAgICAgICAgZm9yICh2YXIgJF9pID0gMTsgJF9pIDwgJF9sZW47ICsrJF9pKSB7XG4gICAgICAgICAgICAgIGFyZ3NbJF9pIC0gMV0gPSBhcmd1bWVudHNbJF9pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGwoYXJncyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGwodmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwcm9taXNlID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHZhciBQcm9taXNlUmVzb2x2ZXI7XG4gICAgICBpZiAoIWhhdmVHZXR0ZXJzKSB7XG4gICAgICAgIFByb21pc2VSZXNvbHZlciA9IGZ1bmN0aW9uKHByb21pc2UpIHtcbiAgICAgICAgICB0aGlzLnByb21pc2UgPSBwcm9taXNlO1xuICAgICAgICAgIHRoaXMuYXNDYWxsYmFjayA9IG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKTtcbiAgICAgICAgICB0aGlzLmNhbGxiYWNrID0gdGhpcy5hc0NhbGxiYWNrO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUHJvbWlzZVJlc29sdmVyID0gZnVuY3Rpb24ocHJvbWlzZSkge1xuICAgICAgICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAoaGF2ZUdldHRlcnMpIHtcbiAgICAgICAgdmFyIHByb3AgPSB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlYmFja0ZvclByb21pc2UodGhpcy5wcm9taXNlKTtcbiAgICAgICAgICB9fTtcbiAgICAgICAgZXM1LmRlZmluZVByb3BlcnR5KFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUsIFwiYXNDYWxsYmFja1wiLCBwcm9wKTtcbiAgICAgICAgZXM1LmRlZmluZVByb3BlcnR5KFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUsIFwiY2FsbGJhY2tcIiwgcHJvcCk7XG4gICAgICB9XG4gICAgICBQcm9taXNlUmVzb2x2ZXIuX25vZGViYWNrRm9yUHJvbWlzZSA9IG5vZGViYWNrRm9yUHJvbWlzZTtcbiAgICAgIFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFwiW29iamVjdCBQcm9taXNlUmVzb2x2ZXJdXCI7XG4gICAgICB9O1xuICAgICAgUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5yZXNvbHZlID0gUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5mdWxmaWxsID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFByb21pc2VSZXNvbHZlcikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSWxsZWdhbCBpbnZvY2F0aW9uLCByZXNvbHZlciByZXNvbHZlL3JlamVjdCBtdXN0IGJlIGNhbGxlZCB3aXRoaW4gYSByZXNvbHZlciBjb250ZXh0LiBDb25zaWRlciB1c2luZyB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvciBpbnN0ZWFkLlxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsL3Nka1hMOVxcdTAwMGFcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcm9taXNlLl9yZXNvbHZlQ2FsbGJhY2sodmFsdWUpO1xuICAgICAgfTtcbiAgICAgIFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUucmVqZWN0ID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlUmVzb2x2ZXIpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIklsbGVnYWwgaW52b2NhdGlvbiwgcmVzb2x2ZXIgcmVzb2x2ZS9yZWplY3QgbXVzdCBiZSBjYWxsZWQgd2l0aGluIGEgcmVzb2x2ZXIgY29udGV4dC4gQ29uc2lkZXIgdXNpbmcgdGhlIHByb21pc2UgY29uc3RydWN0b3IgaW5zdGVhZC5cXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC9zZGtYTDlcXHUwMDBhXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJvbWlzZS5fcmVqZWN0Q2FsbGJhY2socmVhc29uKTtcbiAgICAgIH07XG4gICAgICBQcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnByb2dyZXNzID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFByb21pc2VSZXNvbHZlcikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSWxsZWdhbCBpbnZvY2F0aW9uLCByZXNvbHZlciByZXNvbHZlL3JlamVjdCBtdXN0IGJlIGNhbGxlZCB3aXRoaW4gYSByZXNvbHZlciBjb250ZXh0LiBDb25zaWRlciB1c2luZyB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvciBpbnN0ZWFkLlxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsL3Nka1hMOVxcdTAwMGFcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcm9taXNlLl9wcm9ncmVzcyh2YWx1ZSk7XG4gICAgICB9O1xuICAgICAgUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlLmNhbmNlbChlcnIpO1xuICAgICAgfTtcbiAgICAgIFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUudGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnJlamVjdChuZXcgVGltZW91dEVycm9yKFwidGltZW91dFwiKSk7XG4gICAgICB9O1xuICAgICAgUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5pc1Jlc29sdmVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb21pc2UuaXNSZXNvbHZlZCgpO1xuICAgICAgfTtcbiAgICAgIFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb21pc2UudG9KU09OKCk7XG4gICAgICB9O1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlUmVzb2x2ZXI7XG4gICAgfSwge1xuICAgICAgXCIuL2Vycm9ycy5qc1wiOiAxMyxcbiAgICAgIFwiLi9lczUuanNcIjogMTQsXG4gICAgICBcIi4vdXRpbC5qc1wiOiAzOFxuICAgIH1dLFxuICAgIDI2OiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwpIHtcbiAgICAgICAgdmFyIFRISVMgPSB7fTtcbiAgICAgICAgdmFyIHV0aWwgPSBfZGVyZXFfKFwiLi91dGlsLmpzXCIpO1xuICAgICAgICB2YXIgbm9kZWJhY2tGb3JQcm9taXNlID0gX2RlcmVxXyhcIi4vcHJvbWlzZV9yZXNvbHZlci5qc1wiKS5fbm9kZWJhY2tGb3JQcm9taXNlO1xuICAgICAgICB2YXIgd2l0aEFwcGVuZGVkID0gdXRpbC53aXRoQXBwZW5kZWQ7XG4gICAgICAgIHZhciBtYXliZVdyYXBBc0Vycm9yID0gdXRpbC5tYXliZVdyYXBBc0Vycm9yO1xuICAgICAgICB2YXIgY2FuRXZhbHVhdGUgPSB1dGlsLmNhbkV2YWx1YXRlO1xuICAgICAgICB2YXIgVHlwZUVycm9yID0gX2RlcmVxXyhcIi4vZXJyb3JzXCIpLlR5cGVFcnJvcjtcbiAgICAgICAgdmFyIGRlZmF1bHRTdWZmaXggPSBcIkFzeW5jXCI7XG4gICAgICAgIHZhciBkZWZhdWx0UHJvbWlzaWZpZWQgPSB7X19pc1Byb21pc2lmaWVkX186IHRydWV9O1xuICAgICAgICB2YXIgbm9Db3B5UHJvcHNQYXR0ZXJuID0gL14oPzpsZW5ndGh8bmFtZXxhcmd1bWVudHN8Y2FsbGVyfHByb3RvdHlwZXxfX2lzUHJvbWlzaWZpZWRfXykkLztcbiAgICAgICAgdmFyIGRlZmF1bHRGaWx0ZXIgPSBmdW5jdGlvbihuYW1lLCBmdW5jKSB7XG4gICAgICAgICAgcmV0dXJuIHV0aWwuaXNJZGVudGlmaWVyKG5hbWUpICYmIG5hbWUuY2hhckF0KDApICE9PSBcIl9cIiAmJiAhdXRpbC5pc0NsYXNzKGZ1bmMpO1xuICAgICAgICB9O1xuICAgICAgICBmdW5jdGlvbiBwcm9wc0ZpbHRlcihrZXkpIHtcbiAgICAgICAgICByZXR1cm4gIW5vQ29weVByb3BzUGF0dGVybi50ZXN0KGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaXNQcm9taXNpZmllZChmbikge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gZm4uX19pc1Byb21pc2lmaWVkX18gPT09IHRydWU7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBoYXNQcm9taXNpZmllZChvYmosIGtleSwgc3VmZml4KSB7XG4gICAgICAgICAgdmFyIHZhbCA9IHV0aWwuZ2V0RGF0YVByb3BlcnR5T3JEZWZhdWx0KG9iaiwga2V5ICsgc3VmZml4LCBkZWZhdWx0UHJvbWlzaWZpZWQpO1xuICAgICAgICAgIHJldHVybiB2YWwgPyBpc1Byb21pc2lmaWVkKHZhbCkgOiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBjaGVja1ZhbGlkKHJldCwgc3VmZml4LCBzdWZmaXhSZWdleHApIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgICAgICAgdmFyIGtleSA9IHJldFtpXTtcbiAgICAgICAgICAgIGlmIChzdWZmaXhSZWdleHAudGVzdChrZXkpKSB7XG4gICAgICAgICAgICAgIHZhciBrZXlXaXRob3V0QXN5bmNTdWZmaXggPSBrZXkucmVwbGFjZShzdWZmaXhSZWdleHAsIFwiXCIpO1xuICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJldC5sZW5ndGg7IGogKz0gMikge1xuICAgICAgICAgICAgICAgIGlmIChyZXRbal0gPT09IGtleVdpdGhvdXRBc3luY1N1ZmZpeCkge1xuICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBwcm9taXNpZnkgYW4gQVBJIHRoYXQgaGFzIG5vcm1hbCBtZXRob2RzIHdpdGggJyVzJy1zdWZmaXhcXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC9pV3JaYndcXHUwMDBhXCIucmVwbGFjZShcIiVzXCIsIHN1ZmZpeCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBwcm9taXNpZmlhYmxlTWV0aG9kcyhvYmosIHN1ZmZpeCwgc3VmZml4UmVnZXhwLCBmaWx0ZXIpIHtcbiAgICAgICAgICB2YXIga2V5cyA9IHV0aWwuaW5oZXJpdGVkRGF0YUtleXMob2JqKTtcbiAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgICAgICAgdmFyIHBhc3Nlc0RlZmF1bHRGaWx0ZXIgPSBmaWx0ZXIgPT09IGRlZmF1bHRGaWx0ZXIgPyB0cnVlIDogZGVmYXVsdEZpbHRlcihrZXksIHZhbHVlLCBvYmopO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiICYmICFpc1Byb21pc2lmaWVkKHZhbHVlKSAmJiAhaGFzUHJvbWlzaWZpZWQob2JqLCBrZXksIHN1ZmZpeCkgJiYgZmlsdGVyKGtleSwgdmFsdWUsIG9iaiwgcGFzc2VzRGVmYXVsdEZpbHRlcikpIHtcbiAgICAgICAgICAgICAgcmV0LnB1c2goa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNoZWNrVmFsaWQocmV0LCBzdWZmaXgsIHN1ZmZpeFJlZ2V4cCk7XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXNjYXBlSWRlbnRSZWdleCA9IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvKFskXSkvLCBcIlxcXFwkXCIpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgbWFrZU5vZGVQcm9taXNpZmllZEV2YWw7XG4gICAgICAgIGlmICghdHJ1ZSkge1xuICAgICAgICAgIHZhciBzd2l0Y2hDYXNlQXJndW1lbnRPcmRlciA9IGZ1bmN0aW9uKGxpa2VseUFyZ3VtZW50Q291bnQpIHtcbiAgICAgICAgICAgIHZhciByZXQgPSBbbGlrZWx5QXJndW1lbnRDb3VudF07XG4gICAgICAgICAgICB2YXIgbWluID0gTWF0aC5tYXgoMCwgbGlrZWx5QXJndW1lbnRDb3VudCAtIDEgLSAzKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBsaWtlbHlBcmd1bWVudENvdW50IC0gMTsgaSA+PSBtaW47IC0taSkge1xuICAgICAgICAgICAgICByZXQucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBsaWtlbHlBcmd1bWVudENvdW50ICsgMTsgaSA8PSAzOyArK2kpIHtcbiAgICAgICAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIGFyZ3VtZW50U2VxdWVuY2UgPSBmdW5jdGlvbihhcmd1bWVudENvdW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdXRpbC5maWxsZWRSYW5nZShhcmd1bWVudENvdW50LCBcIl9hcmdcIiwgXCJcIik7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgcGFyYW1ldGVyRGVjbGFyYXRpb24gPSBmdW5jdGlvbihwYXJhbWV0ZXJDb3VudCkge1xuICAgICAgICAgICAgcmV0dXJuIHV0aWwuZmlsbGVkUmFuZ2UoTWF0aC5tYXgocGFyYW1ldGVyQ291bnQsIDMpLCBcIl9hcmdcIiwgXCJcIik7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgcGFyYW1ldGVyQ291bnQgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmbi5sZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KE1hdGgubWluKGZuLmxlbmd0aCwgMTAyMyArIDEpLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgIH07XG4gICAgICAgICAgbWFrZU5vZGVQcm9taXNpZmllZEV2YWwgPSBmdW5jdGlvbihjYWxsYmFjaywgcmVjZWl2ZXIsIG9yaWdpbmFsTmFtZSwgZm4pIHtcbiAgICAgICAgICAgIHZhciBuZXdQYXJhbWV0ZXJDb3VudCA9IE1hdGgubWF4KDAsIHBhcmFtZXRlckNvdW50KGZuKSAtIDEpO1xuICAgICAgICAgICAgdmFyIGFyZ3VtZW50T3JkZXIgPSBzd2l0Y2hDYXNlQXJndW1lbnRPcmRlcihuZXdQYXJhbWV0ZXJDb3VudCk7XG4gICAgICAgICAgICB2YXIgc2hvdWxkUHJveHlUaGlzID0gdHlwZW9mIGNhbGxiYWNrID09PSBcInN0cmluZ1wiIHx8IHJlY2VpdmVyID09PSBUSElTO1xuICAgICAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVDYWxsRm9yQXJndW1lbnRDb3VudChjb3VudCkge1xuICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50U2VxdWVuY2UoY291bnQpLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgICAgICAgdmFyIGNvbW1hID0gY291bnQgPiAwID8gXCIsIFwiIDogXCJcIjtcbiAgICAgICAgICAgICAgdmFyIHJldDtcbiAgICAgICAgICAgICAgaWYgKHNob3VsZFByb3h5VGhpcykge1xuICAgICAgICAgICAgICAgIHJldCA9IFwicmV0ID0gY2FsbGJhY2suY2FsbCh0aGlzLCB7e2FyZ3N9fSwgbm9kZWJhY2spOyBicmVhaztcXG5cIjtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXQgPSByZWNlaXZlciA9PT0gdW5kZWZpbmVkID8gXCJyZXQgPSBjYWxsYmFjayh7e2FyZ3N9fSwgbm9kZWJhY2spOyBicmVhaztcXG5cIiA6IFwicmV0ID0gY2FsbGJhY2suY2FsbChyZWNlaXZlciwge3thcmdzfX0sIG5vZGViYWNrKTsgYnJlYWs7XFxuXCI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHJldC5yZXBsYWNlKFwie3thcmdzfX1cIiwgYXJncykucmVwbGFjZShcIiwgXCIsIGNvbW1hKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdlbmVyYXRlQXJndW1lbnRTd2l0Y2hDYXNlKCkge1xuICAgICAgICAgICAgICB2YXIgcmV0ID0gXCJcIjtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudE9yZGVyLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgcmV0ICs9IFwiY2FzZSBcIiArIGFyZ3VtZW50T3JkZXJbaV0gKyBcIjpcIiArIGdlbmVyYXRlQ2FsbEZvckFyZ3VtZW50Q291bnQoYXJndW1lbnRPcmRlcltpXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0ICs9IFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIGRlZmF1bHQ6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgYXJncyA9IG5ldyBBcnJheShsZW4gKyAxKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgaSA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBhcmdzW2ldID0gbm9kZWJhY2s7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBbQ29kZUZvckNhbGxdICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIFwiLnJlcGxhY2UoXCJbQ29kZUZvckNhbGxdXCIsIChzaG91bGRQcm94eVRoaXMgPyBcInJldCA9IGNhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3MpO1xcblwiIDogXCJyZXQgPSBjYWxsYmFjay5hcHBseShyZWNlaXZlciwgYXJncyk7XFxuXCIpKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBnZXRGdW5jdGlvbkNvZGUgPSB0eXBlb2YgY2FsbGJhY2sgPT09IFwic3RyaW5nXCIgPyAoXCJ0aGlzICE9IG51bGwgPyB0aGlzWydcIiArIGNhbGxiYWNrICsgXCInXSA6IGZuXCIpIDogXCJmblwiO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcIlByb21pc2VcIiwgXCJmblwiLCBcInJlY2VpdmVyXCIsIFwid2l0aEFwcGVuZGVkXCIsIFwibWF5YmVXcmFwQXNFcnJvclwiLCBcIm5vZGViYWNrRm9yUHJvbWlzZVwiLCBcInRyeUNhdGNoXCIsIFwiZXJyb3JPYmpcIiwgXCJJTlRFUk5BTFwiLCBcIid1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgdmFyIHJldCA9IGZ1bmN0aW9uIChQYXJhbWV0ZXJzKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHByb21pc2UuX2NhcHR1cmVTdGFja1RyYWNlKCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBub2RlYmFjayA9IG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKTsgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciByZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IHRyeUNhdGNoKFtHZXRGdW5jdGlvbkNvZGVdKTsgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHN3aXRjaChsZW4pIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBbQ29kZUZvclN3aXRjaENhc2VdICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBwcm9taXNlLl9yZWplY3RDYWxsYmFjayhtYXliZVdyYXBBc0Vycm9yKHJldC5lKSwgdHJ1ZSwgdHJ1ZSk7XFxuXFxcbiAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgfTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgcmV0Ll9faXNQcm9taXNpZmllZF9fID0gdHJ1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgcmV0dXJuIHJldDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgXCIucmVwbGFjZShcIlBhcmFtZXRlcnNcIiwgcGFyYW1ldGVyRGVjbGFyYXRpb24obmV3UGFyYW1ldGVyQ291bnQpKS5yZXBsYWNlKFwiW0NvZGVGb3JTd2l0Y2hDYXNlXVwiLCBnZW5lcmF0ZUFyZ3VtZW50U3dpdGNoQ2FzZSgpKS5yZXBsYWNlKFwiW0dldEZ1bmN0aW9uQ29kZV1cIiwgZ2V0RnVuY3Rpb25Db2RlKSkoUHJvbWlzZSwgZm4sIHJlY2VpdmVyLCB3aXRoQXBwZW5kZWQsIG1heWJlV3JhcEFzRXJyb3IsIG5vZGViYWNrRm9yUHJvbWlzZSwgdXRpbC50cnlDYXRjaCwgdXRpbC5lcnJvck9iaiwgSU5URVJOQUwpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gbWFrZU5vZGVQcm9taXNpZmllZENsb3N1cmUoY2FsbGJhY2ssIHJlY2VpdmVyLCBfLCBmbikge1xuICAgICAgICAgIHZhciBkZWZhdWx0VGhpcyA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgIH0pKCk7XG4gICAgICAgICAgdmFyIG1ldGhvZCA9IGNhbGxiYWNrO1xuICAgICAgICAgIGlmICh0eXBlb2YgbWV0aG9kID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IGZuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmdW5jdGlvbiBwcm9taXNpZmllZCgpIHtcbiAgICAgICAgICAgIHZhciBfcmVjZWl2ZXIgPSByZWNlaXZlcjtcbiAgICAgICAgICAgIGlmIChyZWNlaXZlciA9PT0gVEhJUylcbiAgICAgICAgICAgICAgX3JlY2VpdmVyID0gdGhpcztcbiAgICAgICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgICAgcHJvbWlzZS5fY2FwdHVyZVN0YWNrVHJhY2UoKTtcbiAgICAgICAgICAgIHZhciBjYiA9IHR5cGVvZiBtZXRob2QgPT09IFwic3RyaW5nXCIgJiYgdGhpcyAhPT0gZGVmYXVsdFRoaXMgPyB0aGlzW21ldGhvZF0gOiBjYWxsYmFjaztcbiAgICAgICAgICAgIHZhciBmbiA9IG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNiLmFwcGx5KF9yZWNlaXZlciwgd2l0aEFwcGVuZGVkKGFyZ3VtZW50cywgZm4pKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0Q2FsbGJhY2sobWF5YmVXcmFwQXNFcnJvcihlKSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcHJvbWlzaWZpZWQuX19pc1Byb21pc2lmaWVkX18gPSB0cnVlO1xuICAgICAgICAgIHJldHVybiBwcm9taXNpZmllZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWFrZU5vZGVQcm9taXNpZmllZCA9IGNhbkV2YWx1YXRlID8gbWFrZU5vZGVQcm9taXNpZmllZEV2YWwgOiBtYWtlTm9kZVByb21pc2lmaWVkQ2xvc3VyZTtcbiAgICAgICAgZnVuY3Rpb24gcHJvbWlzaWZ5QWxsKG9iaiwgc3VmZml4LCBmaWx0ZXIsIHByb21pc2lmaWVyKSB7XG4gICAgICAgICAgdmFyIHN1ZmZpeFJlZ2V4cCA9IG5ldyBSZWdFeHAoZXNjYXBlSWRlbnRSZWdleChzdWZmaXgpICsgXCIkXCIpO1xuICAgICAgICAgIHZhciBtZXRob2RzID0gcHJvbWlzaWZpYWJsZU1ldGhvZHMob2JqLCBzdWZmaXgsIHN1ZmZpeFJlZ2V4cCwgZmlsdGVyKTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgICAgICAgbGVuID0gbWV0aG9kcy5sZW5ndGg7IGkgPCBsZW47IGkgKz0gMikge1xuICAgICAgICAgICAgdmFyIGtleSA9IG1ldGhvZHNbaV07XG4gICAgICAgICAgICB2YXIgZm4gPSBtZXRob2RzW2kgKyAxXTtcbiAgICAgICAgICAgIHZhciBwcm9taXNpZmllZEtleSA9IGtleSArIHN1ZmZpeDtcbiAgICAgICAgICAgIG9ialtwcm9taXNpZmllZEtleV0gPSBwcm9taXNpZmllciA9PT0gbWFrZU5vZGVQcm9taXNpZmllZCA/IG1ha2VOb2RlUHJvbWlzaWZpZWQoa2V5LCBUSElTLCBrZXksIGZuLCBzdWZmaXgpIDogcHJvbWlzaWZpZXIoZm4sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gbWFrZU5vZGVQcm9taXNpZmllZChrZXksIFRISVMsIGtleSwgZm4sIHN1ZmZpeCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdXRpbC50b0Zhc3RQcm9wZXJ0aWVzKG9iaik7XG4gICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBwcm9taXNpZnkoY2FsbGJhY2ssIHJlY2VpdmVyKSB7XG4gICAgICAgICAgcmV0dXJuIG1ha2VOb2RlUHJvbWlzaWZpZWQoY2FsbGJhY2ssIHJlY2VpdmVyLCB1bmRlZmluZWQsIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnByb21pc2lmeSA9IGZ1bmN0aW9uKGZuLCByZWNlaXZlcikge1xuICAgICAgICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsLzkxNmxKSlxcdTAwMGFcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpc1Byb21pc2lmaWVkKGZuKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcmV0ID0gcHJvbWlzaWZ5KGZuLCBhcmd1bWVudHMubGVuZ3RoIDwgMiA/IFRISVMgOiByZWNlaXZlcik7XG4gICAgICAgICAgdXRpbC5jb3B5RGVzY3JpcHRvcnMoZm4sIHJldCwgcHJvcHNGaWx0ZXIpO1xuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvbWlzaWZ5QWxsID0gZnVuY3Rpb24odGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgIT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgdGFyZ2V0ICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwidGhlIHRhcmdldCBvZiBwcm9taXNpZnlBbGwgbXVzdCBiZSBhbiBvYmplY3Qgb3IgYSBmdW5jdGlvblxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsLzlJVGxWMFxcdTAwMGFcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIG9wdGlvbnMgPSBPYmplY3Qob3B0aW9ucyk7XG4gICAgICAgICAgdmFyIHN1ZmZpeCA9IG9wdGlvbnMuc3VmZml4O1xuICAgICAgICAgIGlmICh0eXBlb2Ygc3VmZml4ICE9PSBcInN0cmluZ1wiKVxuICAgICAgICAgICAgc3VmZml4ID0gZGVmYXVsdFN1ZmZpeDtcbiAgICAgICAgICB2YXIgZmlsdGVyID0gb3B0aW9ucy5maWx0ZXI7XG4gICAgICAgICAgaWYgKHR5cGVvZiBmaWx0ZXIgIT09IFwiZnVuY3Rpb25cIilcbiAgICAgICAgICAgIGZpbHRlciA9IGRlZmF1bHRGaWx0ZXI7XG4gICAgICAgICAgdmFyIHByb21pc2lmaWVyID0gb3B0aW9ucy5wcm9taXNpZmllcjtcbiAgICAgICAgICBpZiAodHlwZW9mIHByb21pc2lmaWVyICE9PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgICBwcm9taXNpZmllciA9IG1ha2VOb2RlUHJvbWlzaWZpZWQ7XG4gICAgICAgICAgaWYgKCF1dGlsLmlzSWRlbnRpZmllcihzdWZmaXgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcInN1ZmZpeCBtdXN0IGJlIGEgdmFsaWQgaWRlbnRpZmllclxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsLzhGWm81VlxcdTAwMGFcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBrZXlzID0gdXRpbC5pbmhlcml0ZWREYXRhS2V5cyh0YXJnZXQpO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGFyZ2V0W2tleXNbaV1dO1xuICAgICAgICAgICAgaWYgKGtleXNbaV0gIT09IFwiY29uc3RydWN0b3JcIiAmJiB1dGlsLmlzQ2xhc3ModmFsdWUpKSB7XG4gICAgICAgICAgICAgIHByb21pc2lmeUFsbCh2YWx1ZS5wcm90b3R5cGUsIHN1ZmZpeCwgZmlsdGVyLCBwcm9taXNpZmllcik7XG4gICAgICAgICAgICAgIHByb21pc2lmeUFsbCh2YWx1ZSwgc3VmZml4LCBmaWx0ZXIsIHByb21pc2lmaWVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHByb21pc2lmeUFsbCh0YXJnZXQsIHN1ZmZpeCwgZmlsdGVyLCBwcm9taXNpZmllcik7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0sIHtcbiAgICAgIFwiLi9lcnJvcnNcIjogMTMsXG4gICAgICBcIi4vcHJvbWlzZV9yZXNvbHZlci5qc1wiOiAyNSxcbiAgICAgIFwiLi91dGlsLmpzXCI6IDM4XG4gICAgfV0sXG4gICAgMjc6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIHRyeUNvbnZlcnRUb1Byb21pc2UsIGFwaVJlamVjdGlvbikge1xuICAgICAgICB2YXIgdXRpbCA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIik7XG4gICAgICAgIHZhciBpc09iamVjdCA9IHV0aWwuaXNPYmplY3Q7XG4gICAgICAgIHZhciBlczUgPSBfZGVyZXFfKFwiLi9lczUuanNcIik7XG4gICAgICAgIGZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkob2JqKSB7XG4gICAgICAgICAgdmFyIGtleXMgPSBlczUua2V5cyhvYmopO1xuICAgICAgICAgIHZhciBsZW4gPSBrZXlzLmxlbmd0aDtcbiAgICAgICAgICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KGxlbiAqIDIpO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgICAgdmFsdWVzW2ldID0gb2JqW2tleV07XG4gICAgICAgICAgICB2YWx1ZXNbaSArIGxlbl0gPSBrZXk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuY29uc3RydWN0b3IkKHZhbHVlcyk7XG4gICAgICAgIH1cbiAgICAgICAgdXRpbC5pbmhlcml0cyhQcm9wZXJ0aWVzUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuICAgICAgICBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5faW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2luaXQkKHVuZGVmaW5lZCwgLTMpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9IGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkge1xuICAgICAgICAgIHRoaXMuX3ZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICB2YXIgdG90YWxSZXNvbHZlZCA9ICsrdGhpcy5fdG90YWxSZXNvbHZlZDtcbiAgICAgICAgICBpZiAodG90YWxSZXNvbHZlZCA+PSB0aGlzLl9sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSB7fTtcbiAgICAgICAgICAgIHZhciBrZXlPZmZzZXQgPSB0aGlzLmxlbmd0aCgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgICAgICAgICAgbGVuID0gdGhpcy5sZW5ndGgoKTsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICAgIHZhbFt0aGlzLl92YWx1ZXNbaSArIGtleU9mZnNldF1dID0gdGhpcy5fdmFsdWVzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh2YWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VQcm9ncmVzc2VkID0gZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7XG4gICAgICAgICAgdGhpcy5fcHJvbWlzZS5fcHJvZ3Jlc3Moe1xuICAgICAgICAgICAga2V5OiB0aGlzLl92YWx1ZXNbaW5kZXggKyB0aGlzLmxlbmd0aCgpXSxcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5zaG91bGRDb3B5VmFsdWVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5nZXRBY3R1YWxMZW5ndGggPSBmdW5jdGlvbihsZW4pIHtcbiAgICAgICAgICByZXR1cm4gbGVuID4+IDE7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIHByb3BzKHByb21pc2VzKSB7XG4gICAgICAgICAgdmFyIHJldDtcbiAgICAgICAgICB2YXIgY2FzdFZhbHVlID0gdHJ5Q29udmVydFRvUHJvbWlzZShwcm9taXNlcyk7XG4gICAgICAgICAgaWYgKCFpc09iamVjdChjYXN0VmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiY2Fubm90IGF3YWl0IHByb3BlcnRpZXMgb2YgYSBub24tb2JqZWN0XFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvT3NGS0M4XFx1MDAwYVwiKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGNhc3RWYWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHJldCA9IGNhc3RWYWx1ZS5fdGhlbihQcm9taXNlLnByb3BzLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXQgPSBuZXcgUHJvcGVydGllc1Byb21pc2VBcnJheShjYXN0VmFsdWUpLnByb21pc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNhc3RWYWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHJldC5fcHJvcGFnYXRlRnJvbShjYXN0VmFsdWUsIDQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLnByb3BzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHByb3BzKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3BzID0gZnVuY3Rpb24ocHJvbWlzZXMpIHtcbiAgICAgICAgICByZXR1cm4gcHJvcHMocHJvbWlzZXMpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9LCB7XG4gICAgICBcIi4vZXM1LmpzXCI6IDE0LFxuICAgICAgXCIuL3V0aWwuanNcIjogMzhcbiAgICB9XSxcbiAgICAyODogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICBmdW5jdGlvbiBhcnJheU1vdmUoc3JjLCBzcmNJbmRleCwgZHN0LCBkc3RJbmRleCwgbGVuKSB7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGVuOyArK2opIHtcbiAgICAgICAgICBkc3RbaiArIGRzdEluZGV4XSA9IHNyY1tqICsgc3JjSW5kZXhdO1xuICAgICAgICAgIHNyY1tqICsgc3JjSW5kZXhdID0gdm9pZCAwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBRdWV1ZShjYXBhY2l0eSkge1xuICAgICAgICB0aGlzLl9jYXBhY2l0eSA9IGNhcGFjaXR5O1xuICAgICAgICB0aGlzLl9sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLl9mcm9udCA9IDA7XG4gICAgICB9XG4gICAgICBRdWV1ZS5wcm90b3R5cGUuX3dpbGxCZU92ZXJDYXBhY2l0eSA9IGZ1bmN0aW9uKHNpemUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcGFjaXR5IDwgc2l6ZTtcbiAgICAgIH07XG4gICAgICBRdWV1ZS5wcm90b3R5cGUuX3B1c2hPbmUgPSBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7XG4gICAgICAgIHRoaXMuX2NoZWNrQ2FwYWNpdHkobGVuZ3RoICsgMSk7XG4gICAgICAgIHZhciBpID0gKHRoaXMuX2Zyb250ICsgbGVuZ3RoKSAmICh0aGlzLl9jYXBhY2l0eSAtIDEpO1xuICAgICAgICB0aGlzW2ldID0gYXJnO1xuICAgICAgICB0aGlzLl9sZW5ndGggPSBsZW5ndGggKyAxO1xuICAgICAgfTtcbiAgICAgIFF1ZXVlLnByb3RvdHlwZS5fdW5zaGlmdE9uZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciBjYXBhY2l0eSA9IHRoaXMuX2NhcGFjaXR5O1xuICAgICAgICB0aGlzLl9jaGVja0NhcGFjaXR5KHRoaXMubGVuZ3RoKCkgKyAxKTtcbiAgICAgICAgdmFyIGZyb250ID0gdGhpcy5fZnJvbnQ7XG4gICAgICAgIHZhciBpID0gKCgoKGZyb250IC0gMSkgJiAoY2FwYWNpdHkgLSAxKSkgXiBjYXBhY2l0eSkgLSBjYXBhY2l0eSk7XG4gICAgICAgIHRoaXNbaV0gPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fZnJvbnQgPSBpO1xuICAgICAgICB0aGlzLl9sZW5ndGggPSB0aGlzLmxlbmd0aCgpICsgMTtcbiAgICAgIH07XG4gICAgICBRdWV1ZS5wcm90b3R5cGUudW5zaGlmdCA9IGZ1bmN0aW9uKGZuLCByZWNlaXZlciwgYXJnKSB7XG4gICAgICAgIHRoaXMuX3Vuc2hpZnRPbmUoYXJnKTtcbiAgICAgICAgdGhpcy5fdW5zaGlmdE9uZShyZWNlaXZlcik7XG4gICAgICAgIHRoaXMuX3Vuc2hpZnRPbmUoZm4pO1xuICAgICAgfTtcbiAgICAgIFF1ZXVlLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24oZm4sIHJlY2VpdmVyLCBhcmcpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCkgKyAzO1xuICAgICAgICBpZiAodGhpcy5fd2lsbEJlT3ZlckNhcGFjaXR5KGxlbmd0aCkpIHtcbiAgICAgICAgICB0aGlzLl9wdXNoT25lKGZuKTtcbiAgICAgICAgICB0aGlzLl9wdXNoT25lKHJlY2VpdmVyKTtcbiAgICAgICAgICB0aGlzLl9wdXNoT25lKGFyZyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBqID0gdGhpcy5fZnJvbnQgKyBsZW5ndGggLSAzO1xuICAgICAgICB0aGlzLl9jaGVja0NhcGFjaXR5KGxlbmd0aCk7XG4gICAgICAgIHZhciB3cmFwTWFzayA9IHRoaXMuX2NhcGFjaXR5IC0gMTtcbiAgICAgICAgdGhpc1soaiArIDApICYgd3JhcE1hc2tdID0gZm47XG4gICAgICAgIHRoaXNbKGogKyAxKSAmIHdyYXBNYXNrXSA9IHJlY2VpdmVyO1xuICAgICAgICB0aGlzWyhqICsgMikgJiB3cmFwTWFza10gPSBhcmc7XG4gICAgICAgIHRoaXMuX2xlbmd0aCA9IGxlbmd0aDtcbiAgICAgIH07XG4gICAgICBRdWV1ZS5wcm90b3R5cGUuc2hpZnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGZyb250ID0gdGhpcy5fZnJvbnQsXG4gICAgICAgICAgICByZXQgPSB0aGlzW2Zyb250XTtcbiAgICAgICAgdGhpc1tmcm9udF0gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX2Zyb250ID0gKGZyb250ICsgMSkgJiAodGhpcy5fY2FwYWNpdHkgLSAxKTtcbiAgICAgICAgdGhpcy5fbGVuZ3RoLS07XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgICB9O1xuICAgICAgUXVldWUucHJvdG90eXBlLmxlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGVuZ3RoO1xuICAgICAgfTtcbiAgICAgIFF1ZXVlLnByb3RvdHlwZS5fY2hlY2tDYXBhY2l0eSA9IGZ1bmN0aW9uKHNpemUpIHtcbiAgICAgICAgaWYgKHRoaXMuX2NhcGFjaXR5IDwgc2l6ZSkge1xuICAgICAgICAgIHRoaXMuX3Jlc2l6ZVRvKHRoaXMuX2NhcGFjaXR5IDw8IDEpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgUXVldWUucHJvdG90eXBlLl9yZXNpemVUbyA9IGZ1bmN0aW9uKGNhcGFjaXR5KSB7XG4gICAgICAgIHZhciBvbGRDYXBhY2l0eSA9IHRoaXMuX2NhcGFjaXR5O1xuICAgICAgICB0aGlzLl9jYXBhY2l0eSA9IGNhcGFjaXR5O1xuICAgICAgICB2YXIgZnJvbnQgPSB0aGlzLl9mcm9udDtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMuX2xlbmd0aDtcbiAgICAgICAgdmFyIG1vdmVJdGVtc0NvdW50ID0gKGZyb250ICsgbGVuZ3RoKSAmIChvbGRDYXBhY2l0eSAtIDEpO1xuICAgICAgICBhcnJheU1vdmUodGhpcywgMCwgdGhpcywgb2xkQ2FwYWNpdHksIG1vdmVJdGVtc0NvdW50KTtcbiAgICAgIH07XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IFF1ZXVlO1xuICAgIH0sIHt9XSxcbiAgICAyOTogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMLCB0cnlDb252ZXJ0VG9Qcm9taXNlLCBhcGlSZWplY3Rpb24pIHtcbiAgICAgICAgdmFyIGlzQXJyYXkgPSBfZGVyZXFfKFwiLi91dGlsLmpzXCIpLmlzQXJyYXk7XG4gICAgICAgIHZhciByYWNlTGF0ZXIgPSBmdW5jdGlvbihwcm9taXNlKSB7XG4gICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgcmV0dXJuIHJhY2UoYXJyYXksIHByb21pc2UpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBmdW5jdGlvbiByYWNlKHByb21pc2VzLCBwYXJlbnQpIHtcbiAgICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gdHJ5Q29udmVydFRvUHJvbWlzZShwcm9taXNlcyk7XG4gICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHJldHVybiByYWNlTGF0ZXIobWF5YmVQcm9taXNlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKCFpc0FycmF5KHByb21pc2VzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImV4cGVjdGluZyBhbiBhcnJheSwgYSBwcm9taXNlIG9yIGEgdGhlbmFibGVcXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC9zOE1NaGNcXHUwMDBhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgIGlmIChwYXJlbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0Ll9wcm9wYWdhdGVGcm9tKHBhcmVudCwgNCB8IDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZnVsZmlsbCA9IHJldC5fZnVsZmlsbDtcbiAgICAgICAgICB2YXIgcmVqZWN0ID0gcmV0Ll9yZWplY3Q7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgICAgICAgIGxlbiA9IHByb21pc2VzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gcHJvbWlzZXNbaV07XG4gICAgICAgICAgICBpZiAodmFsID09PSB1bmRlZmluZWQgJiYgIShpIGluIHByb21pc2VzKSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFByb21pc2UuY2FzdCh2YWwpLl90aGVuKGZ1bGZpbGwsIHJlamVjdCwgdW5kZWZpbmVkLCByZXQsIG51bGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIFByb21pc2UucmFjZSA9IGZ1bmN0aW9uKHByb21pc2VzKSB7XG4gICAgICAgICAgcmV0dXJuIHJhY2UocHJvbWlzZXMsIHVuZGVmaW5lZCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLnJhY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gcmFjZSh0aGlzLCB1bmRlZmluZWQpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9LCB7XCIuL3V0aWwuanNcIjogMzh9XSxcbiAgICAzMDogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgYXBpUmVqZWN0aW9uLCB0cnlDb252ZXJ0VG9Qcm9taXNlLCBJTlRFUk5BTCkge1xuICAgICAgICB2YXIgdXRpbCA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIik7XG4gICAgICAgIHZhciB0cnlDYXRjaCA9IHV0aWwudHJ5Q2F0Y2g7XG4gICAgICAgIHZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG4gICAgICAgIGZ1bmN0aW9uIFJlZHVjdGlvblByb21pc2VBcnJheShwcm9taXNlcywgZm4sIGFjY3VtLCBfZWFjaCkge1xuICAgICAgICAgIHRoaXMuY29uc3RydWN0b3IkKHByb21pc2VzKTtcbiAgICAgICAgICB0aGlzLl9wcm9taXNlLl9jYXB0dXJlU3RhY2tUcmFjZSgpO1xuICAgICAgICAgIHRoaXMuX3ByZXNlcnZlZFZhbHVlcyA9IF9lYWNoID09PSBJTlRFUk5BTCA/IFtdIDogbnVsbDtcbiAgICAgICAgICB0aGlzLl96ZXJvdGhJc0FjY3VtID0gKGFjY3VtID09PSB1bmRlZmluZWQpO1xuICAgICAgICAgIHRoaXMuX2dvdEFjY3VtID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9ICh0aGlzLl96ZXJvdGhJc0FjY3VtID8gMSA6IDApO1xuICAgICAgICAgIHRoaXMuX3ZhbHVlc1BoYXNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKGFjY3VtLCB0aGlzLl9wcm9taXNlKTtcbiAgICAgICAgICB2YXIgcmVqZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICB2YXIgaXNQcm9taXNlID0gbWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZTtcbiAgICAgICAgICBpZiAoaXNQcm9taXNlKSB7XG4gICAgICAgICAgICBtYXliZVByb21pc2UgPSBtYXliZVByb21pc2UuX3RhcmdldCgpO1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZS5faXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCAtMSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1heWJlUHJvbWlzZS5faXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgICBhY2N1bSA9IG1heWJlUHJvbWlzZS5fdmFsdWUoKTtcbiAgICAgICAgICAgICAgdGhpcy5fZ290QWNjdW0gPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fcmVqZWN0KG1heWJlUHJvbWlzZS5fcmVhc29uKCkpO1xuICAgICAgICAgICAgICByZWplY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghKGlzUHJvbWlzZSB8fCB0aGlzLl96ZXJvdGhJc0FjY3VtKSlcbiAgICAgICAgICAgIHRoaXMuX2dvdEFjY3VtID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGZuO1xuICAgICAgICAgIHRoaXMuX2FjY3VtID0gYWNjdW07XG4gICAgICAgICAgaWYgKCFyZWplY3RlZClcbiAgICAgICAgICAgIHRoaXMuX2luaXQkKHVuZGVmaW5lZCwgLTUpO1xuICAgICAgICB9XG4gICAgICAgIHV0aWwuaW5oZXJpdHMoUmVkdWN0aW9uUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuICAgICAgICBSZWR1Y3Rpb25Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgICAgUmVkdWN0aW9uUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVzb2x2ZUVtcHR5QXJyYXkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAodGhpcy5fZ290QWNjdW0gfHwgdGhpcy5femVyb3RoSXNBY2N1bSkge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGwgPyBbXSA6IHRoaXMuX2FjY3VtKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFJlZHVjdGlvblByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPSBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy5fdmFsdWVzO1xuICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcbiAgICAgICAgICB2YXIgcHJlc2VydmVkVmFsdWVzID0gdGhpcy5fcHJlc2VydmVkVmFsdWVzO1xuICAgICAgICAgIHZhciBpc0VhY2ggPSBwcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGw7XG4gICAgICAgICAgdmFyIGdvdEFjY3VtID0gdGhpcy5fZ290QWNjdW07XG4gICAgICAgICAgdmFyIHZhbHVlc1BoYXNlID0gdGhpcy5fdmFsdWVzUGhhc2U7XG4gICAgICAgICAgdmFyIHZhbHVlc1BoYXNlSW5kZXg7XG4gICAgICAgICAgaWYgKCF2YWx1ZXNQaGFzZSkge1xuICAgICAgICAgICAgdmFsdWVzUGhhc2UgPSB0aGlzLl92YWx1ZXNQaGFzZSA9IG5ldyBBcnJheShsZW5ndGgpO1xuICAgICAgICAgICAgZm9yICh2YWx1ZXNQaGFzZUluZGV4ID0gMDsgdmFsdWVzUGhhc2VJbmRleCA8IGxlbmd0aDsgKyt2YWx1ZXNQaGFzZUluZGV4KSB7XG4gICAgICAgICAgICAgIHZhbHVlc1BoYXNlW3ZhbHVlc1BoYXNlSW5kZXhdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsdWVzUGhhc2VJbmRleCA9IHZhbHVlc1BoYXNlW2luZGV4XTtcbiAgICAgICAgICBpZiAoaW5kZXggPT09IDAgJiYgdGhpcy5femVyb3RoSXNBY2N1bSkge1xuICAgICAgICAgICAgdGhpcy5fYWNjdW0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX2dvdEFjY3VtID0gZ290QWNjdW0gPSB0cnVlO1xuICAgICAgICAgICAgdmFsdWVzUGhhc2VbaW5kZXhdID0gKCh2YWx1ZXNQaGFzZUluZGV4ID09PSAwKSA/IDEgOiAyKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5fYWNjdW0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX2dvdEFjY3VtID0gZ290QWNjdW0gPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodmFsdWVzUGhhc2VJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICB2YWx1ZXNQaGFzZVtpbmRleF0gPSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFsdWVzUGhhc2VbaW5kZXhdID0gMjtcbiAgICAgICAgICAgICAgdGhpcy5fYWNjdW0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFnb3RBY2N1bSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLl9jYWxsYmFjaztcbiAgICAgICAgICB2YXIgcmVjZWl2ZXIgPSB0aGlzLl9wcm9taXNlLl9ib3VuZFRvO1xuICAgICAgICAgIHZhciByZXQ7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX3JlZHVjaW5nSW5kZXg7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFsdWVzUGhhc2VJbmRleCA9IHZhbHVlc1BoYXNlW2ldO1xuICAgICAgICAgICAgaWYgKHZhbHVlc1BoYXNlSW5kZXggPT09IDIpIHtcbiAgICAgICAgICAgICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9IGkgKyAxO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZXNQaGFzZUluZGV4ICE9PSAxKVxuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlc1tpXTtcbiAgICAgICAgICAgIHRoaXMuX3Byb21pc2UuX3B1c2hDb250ZXh0KCk7XG4gICAgICAgICAgICBpZiAoaXNFYWNoKSB7XG4gICAgICAgICAgICAgIHByZXNlcnZlZFZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgcmV0ID0gdHJ5Q2F0Y2goY2FsbGJhY2spLmNhbGwocmVjZWl2ZXIsIHZhbHVlLCBpLCBsZW5ndGgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0ID0gdHJ5Q2F0Y2goY2FsbGJhY2spLmNhbGwocmVjZWl2ZXIsIHRoaXMuX2FjY3VtLCB2YWx1ZSwgaSwgbGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3Byb21pc2UuX3BvcENvbnRleHQoKTtcbiAgICAgICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKVxuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0KHJldC5lKTtcbiAgICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKHJldCwgdGhpcy5fcHJvbWlzZSk7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICBtYXliZVByb21pc2UgPSBtYXliZVByb21pc2UuX3RhcmdldCgpO1xuICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlLl9pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlc1BoYXNlW2ldID0gNDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCBpKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuX2lzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXQgPSBtYXliZVByb21pc2UuX3ZhbHVlKCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdChtYXliZVByb21pc2UuX3JlYXNvbigpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9IGkgKyAxO1xuICAgICAgICAgICAgdGhpcy5fYWNjdW0gPSByZXQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX3Jlc29sdmUoaXNFYWNoID8gcHJlc2VydmVkVmFsdWVzIDogdGhpcy5fYWNjdW0pO1xuICAgICAgICB9O1xuICAgICAgICBmdW5jdGlvbiByZWR1Y2UocHJvbWlzZXMsIGZuLCBpbml0aWFsVmFsdWUsIF9lYWNoKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKVxuICAgICAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsLzkxNmxKSlxcdTAwMGFcIik7XG4gICAgICAgICAgdmFyIGFycmF5ID0gbmV3IFJlZHVjdGlvblByb21pc2VBcnJheShwcm9taXNlcywgZm4sIGluaXRpYWxWYWx1ZSwgX2VhY2gpO1xuICAgICAgICAgIHJldHVybiBhcnJheS5wcm9taXNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUucmVkdWNlID0gZnVuY3Rpb24oZm4sIGluaXRpYWxWYWx1ZSkge1xuICAgICAgICAgIHJldHVybiByZWR1Y2UodGhpcywgZm4sIGluaXRpYWxWYWx1ZSwgbnVsbCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucmVkdWNlID0gZnVuY3Rpb24ocHJvbWlzZXMsIGZuLCBpbml0aWFsVmFsdWUsIF9lYWNoKSB7XG4gICAgICAgICAgcmV0dXJuIHJlZHVjZShwcm9taXNlcywgZm4sIGluaXRpYWxWYWx1ZSwgX2VhY2gpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9LCB7XCIuL3V0aWwuanNcIjogMzh9XSxcbiAgICAzMTogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICB2YXIgc2NoZWR1bGU7XG4gICAgICBpZiAoX2RlcmVxXyhcIi4vdXRpbC5qc1wiKS5pc05vZGUpIHtcbiAgICAgICAgdmFyIHZlcnNpb24gPSBwcm9jZXNzLnZlcnNpb25zLm5vZGUuc3BsaXQoXCIuXCIpLm1hcChOdW1iZXIpO1xuICAgICAgICBzY2hlZHVsZSA9ICh2ZXJzaW9uWzBdID09PSAwICYmIHZlcnNpb25bMV0gPiAxMCkgfHwgKHZlcnNpb25bMF0gPiAwKSA/IGdsb2JhbC5zZXRJbW1lZGlhdGUgOiBwcm9jZXNzLm5leHRUaWNrO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgTXV0YXRpb25PYnNlcnZlciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICBzY2hlZHVsZSA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZm4pO1xuICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoZGl2LCB7YXR0cmlidXRlczogdHJ1ZX0pO1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QudG9nZ2xlKFwiZm9vXCIpO1xuICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHNjaGVkdWxlLmlzU3RhdGljID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNldFRpbWVvdXQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgc2NoZWR1bGUgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgIHNldFRpbWVvdXQoZm4sIDApO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2NoZWR1bGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhc3luYyBzY2hlZHVsZXIgYXZhaWxhYmxlXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvbTNPVFhrXFx1MDAwYVwiKTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIG1vZHVsZS5leHBvcnRzID0gc2NoZWR1bGU7XG4gICAgfSwge1wiLi91dGlsLmpzXCI6IDM4fV0sXG4gICAgMzI6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXkpIHtcbiAgICAgICAgdmFyIFByb21pc2VJbnNwZWN0aW9uID0gUHJvbWlzZS5Qcm9taXNlSW5zcGVjdGlvbjtcbiAgICAgICAgdmFyIHV0aWwgPSBfZGVyZXFfKFwiLi91dGlsLmpzXCIpO1xuICAgICAgICBmdW5jdGlvbiBTZXR0bGVkUHJvbWlzZUFycmF5KHZhbHVlcykge1xuICAgICAgICAgIHRoaXMuY29uc3RydWN0b3IkKHZhbHVlcyk7XG4gICAgICAgIH1cbiAgICAgICAgdXRpbC5pbmhlcml0cyhTZXR0bGVkUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuICAgICAgICBTZXR0bGVkUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVJlc29sdmVkID0gZnVuY3Rpb24oaW5kZXgsIGluc3BlY3Rpb24pIHtcbiAgICAgICAgICB0aGlzLl92YWx1ZXNbaW5kZXhdID0gaW5zcGVjdGlvbjtcbiAgICAgICAgICB2YXIgdG90YWxSZXNvbHZlZCA9ICsrdGhpcy5fdG90YWxSZXNvbHZlZDtcbiAgICAgICAgICBpZiAodG90YWxSZXNvbHZlZCA+PSB0aGlzLl9sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcy5fdmFsdWVzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFNldHRsZWRQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID0gZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7XG4gICAgICAgICAgdmFyIHJldCA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgICAgICAgIHJldC5fYml0RmllbGQgPSAyNjg0MzU0NTY7XG4gICAgICAgICAgcmV0Ll9zZXR0bGVkVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICB0aGlzLl9wcm9taXNlUmVzb2x2ZWQoaW5kZXgsIHJldCk7XG4gICAgICAgIH07XG4gICAgICAgIFNldHRsZWRQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUmVqZWN0ZWQgPSBmdW5jdGlvbihyZWFzb24sIGluZGV4KSB7XG4gICAgICAgICAgdmFyIHJldCA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgICAgICAgIHJldC5fYml0RmllbGQgPSAxMzQyMTc3Mjg7XG4gICAgICAgICAgcmV0Ll9zZXR0bGVkVmFsdWUgPSByZWFzb247XG4gICAgICAgICAgdGhpcy5fcHJvbWlzZVJlc29sdmVkKGluZGV4LCByZXQpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnNldHRsZSA9IGZ1bmN0aW9uKHByb21pc2VzKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBTZXR0bGVkUHJvbWlzZUFycmF5KHByb21pc2VzKS5wcm9taXNlKCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLnNldHRsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBuZXcgU2V0dGxlZFByb21pc2VBcnJheSh0aGlzKS5wcm9taXNlKCk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0sIHtcIi4vdXRpbC5qc1wiOiAzOH1dLFxuICAgIDMzOiBbZnVuY3Rpb24oX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBhcGlSZWplY3Rpb24pIHtcbiAgICAgICAgdmFyIHV0aWwgPSBfZGVyZXFfKFwiLi91dGlsLmpzXCIpO1xuICAgICAgICB2YXIgUmFuZ2VFcnJvciA9IF9kZXJlcV8oXCIuL2Vycm9ycy5qc1wiKS5SYW5nZUVycm9yO1xuICAgICAgICB2YXIgQWdncmVnYXRlRXJyb3IgPSBfZGVyZXFfKFwiLi9lcnJvcnMuanNcIikuQWdncmVnYXRlRXJyb3I7XG4gICAgICAgIHZhciBpc0FycmF5ID0gdXRpbC5pc0FycmF5O1xuICAgICAgICBmdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5KHZhbHVlcykge1xuICAgICAgICAgIHRoaXMuY29uc3RydWN0b3IkKHZhbHVlcyk7XG4gICAgICAgICAgdGhpcy5faG93TWFueSA9IDA7XG4gICAgICAgICAgdGhpcy5fdW53cmFwID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5faW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB1dGlsLmluaGVyaXRzKFNvbWVQcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG4gICAgICAgIFNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKCF0aGlzLl9pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5faG93TWFueSA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZShbXSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2luaXQkKHVuZGVmaW5lZCwgLTUpO1xuICAgICAgICAgIHZhciBpc0FycmF5UmVzb2x2ZWQgPSBpc0FycmF5KHRoaXMuX3ZhbHVlcyk7XG4gICAgICAgICAgaWYgKCF0aGlzLl9pc1Jlc29sdmVkKCkgJiYgaXNBcnJheVJlc29sdmVkICYmIHRoaXMuX2hvd01hbnkgPiB0aGlzLl9jYW5Qb3NzaWJseUZ1bGZpbGwoKSkge1xuICAgICAgICAgICAgdGhpcy5fcmVqZWN0KHRoaXMuX2dldFJhbmdlRXJyb3IodGhpcy5sZW5ndGgoKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLl9pbml0KCk7XG4gICAgICAgIH07XG4gICAgICAgIFNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLnNldFVud3JhcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX3Vud3JhcCA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIFNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLmhvd01hbnkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5faG93TWFueTtcbiAgICAgICAgfTtcbiAgICAgICAgU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuc2V0SG93TWFueSA9IGZ1bmN0aW9uKGNvdW50KSB7XG4gICAgICAgICAgdGhpcy5faG93TWFueSA9IGNvdW50O1xuICAgICAgICB9O1xuICAgICAgICBTb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgdGhpcy5fYWRkRnVsZmlsbGVkKHZhbHVlKTtcbiAgICAgICAgICBpZiAodGhpcy5fZnVsZmlsbGVkKCkgPT09IHRoaXMuaG93TWFueSgpKSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZXMubGVuZ3RoID0gdGhpcy5ob3dNYW55KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5ob3dNYW55KCkgPT09IDEgJiYgdGhpcy5fdW53cmFwKSB7XG4gICAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcy5fdmFsdWVzWzBdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcy5fdmFsdWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUmVqZWN0ZWQgPSBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICB0aGlzLl9hZGRSZWplY3RlZChyZWFzb24pO1xuICAgICAgICAgIGlmICh0aGlzLmhvd01hbnkoKSA+IHRoaXMuX2NhblBvc3NpYmx5RnVsZmlsbCgpKSB7XG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBBZ2dyZWdhdGVFcnJvcigpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMubGVuZ3RoKCk7IGkgPCB0aGlzLl92YWx1ZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgZS5wdXNoKHRoaXMuX3ZhbHVlc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9yZWplY3QoZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBTb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZnVsZmlsbGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3RvdGFsUmVzb2x2ZWQ7XG4gICAgICAgIH07XG4gICAgICAgIFNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9yZWplY3RlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl92YWx1ZXMubGVuZ3RoIC0gdGhpcy5sZW5ndGgoKTtcbiAgICAgICAgfTtcbiAgICAgICAgU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2FkZFJlamVjdGVkID0gZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgdGhpcy5fdmFsdWVzLnB1c2gocmVhc29uKTtcbiAgICAgICAgfTtcbiAgICAgICAgU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2FkZEZ1bGZpbGxlZCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgdGhpcy5fdmFsdWVzW3RoaXMuX3RvdGFsUmVzb2x2ZWQrK10gPSB2YWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2NhblBvc3NpYmx5RnVsZmlsbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmxlbmd0aCgpIC0gdGhpcy5fcmVqZWN0ZWQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2dldFJhbmdlRXJyb3IgPSBmdW5jdGlvbihjb3VudCkge1xuICAgICAgICAgIHZhciBtZXNzYWdlID0gXCJJbnB1dCBhcnJheSBtdXN0IGNvbnRhaW4gYXQgbGVhc3QgXCIgKyB0aGlzLl9ob3dNYW55ICsgXCIgaXRlbXMgYnV0IGNvbnRhaW5zIG9ubHkgXCIgKyBjb3VudCArIFwiIGl0ZW1zXCI7XG4gICAgICAgICAgcmV0dXJuIG5ldyBSYW5nZUVycm9yKG1lc3NhZ2UpO1xuICAgICAgICB9O1xuICAgICAgICBTb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVzb2x2ZUVtcHR5QXJyYXkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9yZWplY3QodGhpcy5fZ2V0UmFuZ2VFcnJvcigwKSk7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIHNvbWUocHJvbWlzZXMsIGhvd01hbnkpIHtcbiAgICAgICAgICBpZiAoKGhvd01hbnkgfCAwKSAhPT0gaG93TWFueSB8fCBob3dNYW55IDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImV4cGVjdGluZyBhIHBvc2l0aXZlIGludGVnZXJcXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC8xd0FtSHhcXHUwMDBhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcmV0ID0gbmV3IFNvbWVQcm9taXNlQXJyYXkocHJvbWlzZXMpO1xuICAgICAgICAgIHZhciBwcm9taXNlID0gcmV0LnByb21pc2UoKTtcbiAgICAgICAgICByZXQuc2V0SG93TWFueShob3dNYW55KTtcbiAgICAgICAgICByZXQuaW5pdCgpO1xuICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICB9XG4gICAgICAgIFByb21pc2Uuc29tZSA9IGZ1bmN0aW9uKHByb21pc2VzLCBob3dNYW55KSB7XG4gICAgICAgICAgcmV0dXJuIHNvbWUocHJvbWlzZXMsIGhvd01hbnkpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS5zb21lID0gZnVuY3Rpb24oaG93TWFueSkge1xuICAgICAgICAgIHJldHVybiBzb21lKHRoaXMsIGhvd01hbnkpO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLl9Tb21lUHJvbWlzZUFycmF5ID0gU29tZVByb21pc2VBcnJheTtcbiAgICAgIH07XG4gICAgfSwge1xuICAgICAgXCIuL2Vycm9ycy5qc1wiOiAxMyxcbiAgICAgIFwiLi91dGlsLmpzXCI6IDM4XG4gICAgfV0sXG4gICAgMzQ6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlKSB7XG4gICAgICAgIGZ1bmN0aW9uIFByb21pc2VJbnNwZWN0aW9uKHByb21pc2UpIHtcbiAgICAgICAgICBpZiAocHJvbWlzZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9taXNlID0gcHJvbWlzZS5fdGFyZ2V0KCk7XG4gICAgICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHByb21pc2UuX2JpdEZpZWxkO1xuICAgICAgICAgICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gcHJvbWlzZS5fc2V0dGxlZFZhbHVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IDA7XG4gICAgICAgICAgICB0aGlzLl9zZXR0bGVkVmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICghdGhpcy5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2Fubm90IGdldCBmdWxmaWxsbWVudCB2YWx1ZSBvZiBhIG5vbi1mdWxmaWxsZWQgcHJvbWlzZVxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsL2hjMURMalxcdTAwMGFcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aGlzLl9zZXR0bGVkVmFsdWU7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5lcnJvciA9IFByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5yZWFzb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoIXRoaXMuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2Fubm90IGdldCByZWplY3Rpb24gcmVhc29uIG9mIGEgbm9uLXJlamVjdGVkIHByb21pc2VcXHUwMDBhXFx1MDAwYSAgICBTZWUgaHR0cDovL2dvby5nbC9oUHVpd0JcXHUwMDBhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUuaXNGdWxmaWxsZWQgPSBQcm9taXNlLnByb3RvdHlwZS5faXNGdWxmaWxsZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMjY4NDM1NDU2KSA+IDA7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5pc1JlamVjdGVkID0gUHJvbWlzZS5wcm90b3R5cGUuX2lzUmVqZWN0ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMTM0MjE3NzI4KSA+IDA7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5pc1BlbmRpbmcgPSBQcm9taXNlLnByb3RvdHlwZS5faXNQZW5kaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDQwMjY1MzE4NCkgPT09IDA7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5pc1Jlc29sdmVkID0gUHJvbWlzZS5wcm90b3R5cGUuX2lzUmVzb2x2ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNDAyNjUzMTg0KSA+IDA7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmlzUGVuZGluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl90YXJnZXQoKS5faXNQZW5kaW5nKCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmlzUmVqZWN0ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fdGFyZ2V0KCkuX2lzUmVqZWN0ZWQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuaXNGdWxmaWxsZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fdGFyZ2V0KCkuX2lzRnVsZmlsbGVkKCk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmlzUmVzb2x2ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fdGFyZ2V0KCkuX2lzUmVzb2x2ZWQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3ZhbHVlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3JlYXNvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLl90YXJnZXQoKTtcbiAgICAgICAgICBpZiAoIXRhcmdldC5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2Fubm90IGdldCBmdWxmaWxsbWVudCB2YWx1ZSBvZiBhIG5vbi1mdWxmaWxsZWQgcHJvbWlzZVxcdTAwMGFcXHUwMDBhICAgIFNlZSBodHRwOi8vZ29vLmdsL2hjMURMalxcdTAwMGFcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0YXJnZXQuX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUucmVhc29uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMuX3RhcmdldCgpO1xuICAgICAgICAgIGlmICghdGFyZ2V0LmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImNhbm5vdCBnZXQgcmVqZWN0aW9uIHJlYXNvbiBvZiBhIG5vbi1yZWplY3RlZCBwcm9taXNlXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvaFB1aXdCXFx1MDAwYVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGFyZ2V0Ll91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgcmV0dXJuIHRhcmdldC5fc2V0dGxlZFZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlLlByb21pc2VJbnNwZWN0aW9uID0gUHJvbWlzZUluc3BlY3Rpb247XG4gICAgICB9O1xuICAgIH0sIHt9XSxcbiAgICAzNTogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG4gICAgICAgIHZhciB1dGlsID0gX2RlcmVxXyhcIi4vdXRpbC5qc1wiKTtcbiAgICAgICAgdmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbiAgICAgICAgdmFyIGlzT2JqZWN0ID0gdXRpbC5pc09iamVjdDtcbiAgICAgICAgZnVuY3Rpb24gdHJ5Q29udmVydFRvUHJvbWlzZShvYmosIGNvbnRleHQpIHtcbiAgICAgICAgICBpZiAoaXNPYmplY3Qob2JqKSkge1xuICAgICAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNBbnlCbHVlYmlyZFByb21pc2Uob2JqKSkge1xuICAgICAgICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgICAgICBvYmouX3RoZW4ocmV0Ll9mdWxmaWxsVW5jaGVja2VkLCByZXQuX3JlamVjdFVuY2hlY2tlZENoZWNrRXJyb3IsIHJldC5fcHJvZ3Jlc3NVbmNoZWNrZWQsIHJldCwgbnVsbCk7XG4gICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGhlbiA9IHV0aWwudHJ5Q2F0Y2goZ2V0VGhlbikob2JqKTtcbiAgICAgICAgICAgIGlmICh0aGVuID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgICBpZiAoY29udGV4dClcbiAgICAgICAgICAgICAgICBjb250ZXh0Ll9wdXNoQ29udGV4dCgpO1xuICAgICAgICAgICAgICB2YXIgcmV0ID0gUHJvbWlzZS5yZWplY3QodGhlbi5lKTtcbiAgICAgICAgICAgICAgaWYgKGNvbnRleHQpXG4gICAgICAgICAgICAgICAgY29udGV4dC5fcG9wQ29udGV4dCgpO1xuICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhlbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBkb1RoZW5hYmxlKG9iaiwgdGhlbiwgY29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0VGhlbihvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqLnRoZW47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgICAgICAgZnVuY3Rpb24gaXNBbnlCbHVlYmlyZFByb21pc2Uob2JqKSB7XG4gICAgICAgICAgcmV0dXJuIGhhc1Byb3AuY2FsbChvYmosIFwiX3Byb21pc2UwXCIpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRvVGhlbmFibGUoeCwgdGhlbiwgY29udGV4dCkge1xuICAgICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgIHZhciByZXQgPSBwcm9taXNlO1xuICAgICAgICAgIGlmIChjb250ZXh0KVxuICAgICAgICAgICAgY29udGV4dC5fcHVzaENvbnRleHQoKTtcbiAgICAgICAgICBwcm9taXNlLl9jYXB0dXJlU3RhY2tUcmFjZSgpO1xuICAgICAgICAgIGlmIChjb250ZXh0KVxuICAgICAgICAgICAgY29udGV4dC5fcG9wQ29udGV4dCgpO1xuICAgICAgICAgIHZhciBzeW5jaHJvbm91cyA9IHRydWU7XG4gICAgICAgICAgdmFyIHJlc3VsdCA9IHV0aWwudHJ5Q2F0Y2godGhlbikuY2FsbCh4LCByZXNvbHZlRnJvbVRoZW5hYmxlLCByZWplY3RGcm9tVGhlbmFibGUsIHByb2dyZXNzRnJvbVRoZW5hYmxlKTtcbiAgICAgICAgICBzeW5jaHJvbm91cyA9IGZhbHNlO1xuICAgICAgICAgIGlmIChwcm9taXNlICYmIHJlc3VsdCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgIHByb21pc2UuX3JlamVjdENhbGxiYWNrKHJlc3VsdC5lLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgICAgIHByb21pc2UgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmdW5jdGlvbiByZXNvbHZlRnJvbVRoZW5hYmxlKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoIXByb21pc2UpXG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGlmICh4ID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICBwcm9taXNlLl9yZWplY3RDYWxsYmFjayhQcm9taXNlLl9tYWtlU2VsZlJlc29sdXRpb25FcnJvcigpLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBwcm9taXNlLl9yZXNvbHZlQ2FsbGJhY2sodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZ1bmN0aW9uIHJlamVjdEZyb21UaGVuYWJsZShyZWFzb24pIHtcbiAgICAgICAgICAgIGlmICghcHJvbWlzZSlcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0Q2FsbGJhY2socmVhc29uLCBzeW5jaHJvbm91cywgdHJ1ZSk7XG4gICAgICAgICAgICBwcm9taXNlID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVuY3Rpb24gcHJvZ3Jlc3NGcm9tVGhlbmFibGUodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICghcHJvbWlzZSlcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9taXNlLl9wcm9ncmVzcyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgIHByb21pc2UuX3Byb2dyZXNzKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ5Q29udmVydFRvUHJvbWlzZTtcbiAgICAgIH07XG4gICAgfSwge1wiLi91dGlsLmpzXCI6IDM4fV0sXG4gICAgMzY6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCkge1xuICAgICAgICB2YXIgdXRpbCA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIik7XG4gICAgICAgIHZhciBUaW1lb3V0RXJyb3IgPSBQcm9taXNlLlRpbWVvdXRFcnJvcjtcbiAgICAgICAgdmFyIGFmdGVyVGltZW91dCA9IGZ1bmN0aW9uKHByb21pc2UsIG1lc3NhZ2UpIHtcbiAgICAgICAgICBpZiAoIXByb21pc2UuaXNQZW5kaW5nKCkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBtZXNzYWdlID0gXCJvcGVyYXRpb24gdGltZWQgb3V0XCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBlcnIgPSBuZXcgVGltZW91dEVycm9yKG1lc3NhZ2UpO1xuICAgICAgICAgIHV0aWwubWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKGVycik7XG4gICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZShlcnIpO1xuICAgICAgICAgIHByb21pc2UuX2NhbmNlbChlcnIpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgYWZ0ZXJWYWx1ZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIGRlbGF5KCt0aGlzKS50aGVuUmV0dXJuKHZhbHVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGRlbGF5ID0gUHJvbWlzZS5kZWxheSA9IGZ1bmN0aW9uKHZhbHVlLCBtcykge1xuICAgICAgICAgIGlmIChtcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBtcyA9IHZhbHVlO1xuICAgICAgICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0Ll9mdWxmaWxsKCk7XG4gICAgICAgICAgICB9LCBtcyk7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgIH1cbiAgICAgICAgICBtcyA9ICttcztcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS5fdGhlbihhZnRlclZhbHVlLCBudWxsLCBudWxsLCBtcywgdW5kZWZpbmVkKTtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuZGVsYXkgPSBmdW5jdGlvbihtcykge1xuICAgICAgICAgIHJldHVybiBkZWxheSh0aGlzLCBtcyk7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3NDbGVhcih2YWx1ZSkge1xuICAgICAgICAgIHZhciBoYW5kbGUgPSB0aGlzO1xuICAgICAgICAgIGlmIChoYW5kbGUgaW5zdGFuY2VvZiBOdW1iZXIpXG4gICAgICAgICAgICBoYW5kbGUgPSAraGFuZGxlO1xuICAgICAgICAgIGNsZWFyVGltZW91dChoYW5kbGUpO1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBmYWlsdXJlQ2xlYXIocmVhc29uKSB7XG4gICAgICAgICAgdmFyIGhhbmRsZSA9IHRoaXM7XG4gICAgICAgICAgaWYgKGhhbmRsZSBpbnN0YW5jZW9mIE51bWJlcilcbiAgICAgICAgICAgIGhhbmRsZSA9ICtoYW5kbGU7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KGhhbmRsZSk7XG4gICAgICAgICAgdGhyb3cgcmVhc29uO1xuICAgICAgICB9XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLnRpbWVvdXQgPSBmdW5jdGlvbihtcywgbWVzc2FnZSkge1xuICAgICAgICAgIG1zID0gK21zO1xuICAgICAgICAgIHZhciByZXQgPSB0aGlzLnRoZW4oKS5jYW5jZWxsYWJsZSgpO1xuICAgICAgICAgIHJldC5fY2FuY2VsbGF0aW9uUGFyZW50ID0gdGhpcztcbiAgICAgICAgICB2YXIgaGFuZGxlID0gc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0VGltZW91dCgpIHtcbiAgICAgICAgICAgIGFmdGVyVGltZW91dChyZXQsIG1lc3NhZ2UpO1xuICAgICAgICAgIH0sIG1zKTtcbiAgICAgICAgICByZXR1cm4gcmV0Ll90aGVuKHN1Y2Nlc3NDbGVhciwgZmFpbHVyZUNsZWFyLCB1bmRlZmluZWQsIGhhbmRsZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSwge1wiLi91dGlsLmpzXCI6IDM4fV0sXG4gICAgMzc6IFtmdW5jdGlvbihfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgIFwidXNlIHN0cmljdFwiO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBhcGlSZWplY3Rpb24sIHRyeUNvbnZlcnRUb1Byb21pc2UsIGNyZWF0ZUNvbnRleHQpIHtcbiAgICAgICAgdmFyIFR5cGVFcnJvciA9IF9kZXJlcV8oXCIuL2Vycm9ycy5qc1wiKS5UeXBlRXJyb3I7XG4gICAgICAgIHZhciBpbmhlcml0cyA9IF9kZXJlcV8oXCIuL3V0aWwuanNcIikuaW5oZXJpdHM7XG4gICAgICAgIHZhciBQcm9taXNlSW5zcGVjdGlvbiA9IFByb21pc2UuUHJvbWlzZUluc3BlY3Rpb247XG4gICAgICAgIGZ1bmN0aW9uIGluc3BlY3Rpb25NYXBwZXIoaW5zcGVjdGlvbnMpIHtcbiAgICAgICAgICB2YXIgbGVuID0gaW5zcGVjdGlvbnMubGVuZ3RoO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBpbnNwZWN0aW9uID0gaW5zcGVjdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoaW5zcGVjdGlvbi5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGluc3BlY3Rpb24uZXJyb3IoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnNwZWN0aW9uc1tpXSA9IGluc3BlY3Rpb24uX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGluc3BlY3Rpb25zO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHRocm93ZXIoZSkge1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgIH0sIDApO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGNhc3RQcmVzZXJ2aW5nRGlzcG9zYWJsZSh0aGVuYWJsZSkge1xuICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKHRoZW5hYmxlKTtcbiAgICAgICAgICBpZiAobWF5YmVQcm9taXNlICE9PSB0aGVuYWJsZSAmJiB0eXBlb2YgdGhlbmFibGUuX2lzRGlzcG9zYWJsZSA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiB0aGVuYWJsZS5fZ2V0RGlzcG9zZXIgPT09IFwiZnVuY3Rpb25cIiAmJiB0aGVuYWJsZS5faXNEaXNwb3NhYmxlKCkpIHtcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fc2V0RGlzcG9zYWJsZSh0aGVuYWJsZS5fZ2V0RGlzcG9zZXIoKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBtYXliZVByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZGlzcG9zZShyZXNvdXJjZXMsIGluc3BlY3Rpb24pIHtcbiAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgdmFyIGxlbiA9IHJlc291cmNlcy5sZW5ndGg7XG4gICAgICAgICAgdmFyIHJldCA9IFByb21pc2UuZGVmZXIoKTtcbiAgICAgICAgICBmdW5jdGlvbiBpdGVyYXRvcigpIHtcbiAgICAgICAgICAgIGlmIChpID49IGxlbilcbiAgICAgICAgICAgICAgcmV0dXJuIHJldC5yZXNvbHZlKCk7XG4gICAgICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdFByZXNlcnZpbmdEaXNwb3NhYmxlKHJlc291cmNlc1tpKytdKTtcbiAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlICYmIG1heWJlUHJvbWlzZS5faXNEaXNwb3NhYmxlKCkpIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UgPSB0cnlDb252ZXJ0VG9Qcm9taXNlKG1heWJlUHJvbWlzZS5fZ2V0RGlzcG9zZXIoKS50cnlEaXNwb3NlKGluc3BlY3Rpb24pLCByZXNvdXJjZXMucHJvbWlzZSk7XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhyb3dlcihlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtYXliZVByb21pc2UuX3RoZW4oaXRlcmF0b3IsIHRocm93ZXIsIG51bGwsIG51bGwsIG51bGwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpdGVyYXRvcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpdGVyYXRvcigpO1xuICAgICAgICAgIHJldHVybiByZXQucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBkaXNwb3NlclN1Y2Nlc3ModmFsdWUpIHtcbiAgICAgICAgICB2YXIgaW5zcGVjdGlvbiA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgICAgICAgIGluc3BlY3Rpb24uX3NldHRsZWRWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgIGluc3BlY3Rpb24uX2JpdEZpZWxkID0gMjY4NDM1NDU2O1xuICAgICAgICAgIHJldHVybiBkaXNwb3NlKHRoaXMsIGluc3BlY3Rpb24pLnRoZW5SZXR1cm4odmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGRpc3Bvc2VyRmFpbChyZWFzb24pIHtcbiAgICAgICAgICB2YXIgaW5zcGVjdGlvbiA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgICAgICAgIGluc3BlY3Rpb24uX3NldHRsZWRWYWx1ZSA9IHJlYXNvbjtcbiAgICAgICAgICBpbnNwZWN0aW9uLl9iaXRGaWVsZCA9IDEzNDIxNzcyODtcbiAgICAgICAgICByZXR1cm4gZGlzcG9zZSh0aGlzLCBpbnNwZWN0aW9uKS50aGVuVGhyb3cocmVhc29uKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBEaXNwb3NlcihkYXRhLCBwcm9taXNlLCBjb250ZXh0KSB7XG4gICAgICAgICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgICAgICAgdGhpcy5fcHJvbWlzZSA9IHByb21pc2U7XG4gICAgICAgICAgdGhpcy5fY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIH1cbiAgICAgICAgRGlzcG9zZXIucHJvdG90eXBlLmRhdGEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICAgICAgfTtcbiAgICAgICAgRGlzcG9zZXIucHJvdG90eXBlLnByb21pc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZTtcbiAgICAgICAgfTtcbiAgICAgICAgRGlzcG9zZXIucHJvdG90eXBlLnJlc291cmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMucHJvbWlzZSgpLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb21pc2UoKS52YWx1ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgRGlzcG9zZXIucHJvdG90eXBlLnRyeURpc3Bvc2UgPSBmdW5jdGlvbihpbnNwZWN0aW9uKSB7XG4gICAgICAgICAgdmFyIHJlc291cmNlID0gdGhpcy5yZXNvdXJjZSgpO1xuICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fY29udGV4dDtcbiAgICAgICAgICBpZiAoY29udGV4dCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgY29udGV4dC5fcHVzaENvbnRleHQoKTtcbiAgICAgICAgICB2YXIgcmV0ID0gcmVzb3VyY2UgIT09IG51bGwgPyB0aGlzLmRvRGlzcG9zZShyZXNvdXJjZSwgaW5zcGVjdGlvbikgOiBudWxsO1xuICAgICAgICAgIGlmIChjb250ZXh0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBjb250ZXh0Ll9wb3BDb250ZXh0KCk7XG4gICAgICAgICAgdGhpcy5fcHJvbWlzZS5fdW5zZXREaXNwb3NhYmxlKCk7XG4gICAgICAgICAgdGhpcy5fZGF0YSA9IG51bGw7XG4gICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICAgICAgRGlzcG9zZXIuaXNEaXNwb3NlciA9IGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICByZXR1cm4gKGQgIT0gbnVsbCAmJiB0eXBlb2YgZC5yZXNvdXJjZSA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBkLnRyeURpc3Bvc2UgPT09IFwiZnVuY3Rpb25cIik7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIEZ1bmN0aW9uRGlzcG9zZXIoZm4sIHByb21pc2UsIGNvbnRleHQpIHtcbiAgICAgICAgICB0aGlzLmNvbnN0cnVjdG9yJChmbiwgcHJvbWlzZSwgY29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgaW5oZXJpdHMoRnVuY3Rpb25EaXNwb3NlciwgRGlzcG9zZXIpO1xuICAgICAgICBGdW5jdGlvbkRpc3Bvc2VyLnByb3RvdHlwZS5kb0Rpc3Bvc2UgPSBmdW5jdGlvbihyZXNvdXJjZSwgaW5zcGVjdGlvbikge1xuICAgICAgICAgIHZhciBmbiA9IHRoaXMuZGF0YSgpO1xuICAgICAgICAgIHJldHVybiBmbi5jYWxsKHJlc291cmNlLCByZXNvdXJjZSwgaW5zcGVjdGlvbik7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIG1heWJlVW53cmFwRGlzcG9zZXIodmFsdWUpIHtcbiAgICAgICAgICBpZiAoRGlzcG9zZXIuaXNEaXNwb3Nlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRoaXMucmVzb3VyY2VzW3RoaXMuaW5kZXhdLl9zZXREaXNwb3NhYmxlKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5wcm9taXNlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlLnVzaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgICAgaWYgKGxlbiA8IDIpXG4gICAgICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwieW91IG11c3QgcGFzcyBhdCBsZWFzdCAyIGFyZ3VtZW50cyB0byBQcm9taXNlLnVzaW5nXCIpO1xuICAgICAgICAgIHZhciBmbiA9IGFyZ3VtZW50c1tsZW4gLSAxXTtcbiAgICAgICAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXFx1MDAwYVxcdTAwMGEgICAgU2VlIGh0dHA6Ly9nb28uZ2wvOTE2bEpKXFx1MDAwYVwiKTtcbiAgICAgICAgICBsZW4tLTtcbiAgICAgICAgICB2YXIgcmVzb3VyY2VzID0gbmV3IEFycmF5KGxlbik7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICAgICAgdmFyIHJlc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgaWYgKERpc3Bvc2VyLmlzRGlzcG9zZXIocmVzb3VyY2UpKSB7XG4gICAgICAgICAgICAgIHZhciBkaXNwb3NlciA9IHJlc291cmNlO1xuICAgICAgICAgICAgICByZXNvdXJjZSA9IHJlc291cmNlLnByb21pc2UoKTtcbiAgICAgICAgICAgICAgcmVzb3VyY2UuX3NldERpc3Bvc2FibGUoZGlzcG9zZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IHRyeUNvbnZlcnRUb1Byb21pc2UocmVzb3VyY2UpO1xuICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIHJlc291cmNlID0gbWF5YmVQcm9taXNlLl90aGVuKG1heWJlVW53cmFwRGlzcG9zZXIsIG51bGwsIG51bGwsIHtcbiAgICAgICAgICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzLFxuICAgICAgICAgICAgICAgICAgaW5kZXg6IGlcbiAgICAgICAgICAgICAgICB9LCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvdXJjZXNbaV0gPSByZXNvdXJjZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHByb21pc2UgPSBQcm9taXNlLnNldHRsZShyZXNvdXJjZXMpLnRoZW4oaW5zcGVjdGlvbk1hcHBlcikudGhlbihmdW5jdGlvbih2YWxzKSB7XG4gICAgICAgICAgICBwcm9taXNlLl9wdXNoQ29udGV4dCgpO1xuICAgICAgICAgICAgdmFyIHJldDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHJldCA9IGZuLmFwcGx5KHVuZGVmaW5lZCwgdmFscyk7XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICBwcm9taXNlLl9wb3BDb250ZXh0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgIH0pLl90aGVuKGRpc3Bvc2VyU3VjY2VzcywgZGlzcG9zZXJGYWlsLCB1bmRlZmluZWQsIHJlc291cmNlcywgdW5kZWZpbmVkKTtcbiAgICAgICAgICByZXNvdXJjZXMucHJvbWlzZSA9IHByb21pc2U7XG4gICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24oZGlzcG9zZXIpIHtcbiAgICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMjYyMTQ0O1xuICAgICAgICAgIHRoaXMuX2Rpc3Bvc2VyID0gZGlzcG9zZXI7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9pc0Rpc3Bvc2FibGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMjYyMTQ0KSA+IDA7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLl9nZXREaXNwb3NlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9kaXNwb3NlcjtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjI2MjE0NCk7XG4gICAgICAgICAgdGhpcy5fZGlzcG9zZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2UucHJvdG90eXBlLmRpc3Bvc2VyID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb25EaXNwb3NlcihmbiwgdGhpcywgY3JlYXRlQ29udGV4dCgpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9LCB7XG4gICAgICBcIi4vZXJyb3JzLmpzXCI6IDEzLFxuICAgICAgXCIuL3V0aWwuanNcIjogMzhcbiAgICB9XSxcbiAgICAzODogW2Z1bmN0aW9uKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICB2YXIgZXM1ID0gX2RlcmVxXyhcIi4vZXM1LmpzXCIpO1xuICAgICAgdmFyIGNhbkV2YWx1YXRlID0gdHlwZW9mIG5hdmlnYXRvciA9PSBcInVuZGVmaW5lZFwiO1xuICAgICAgdmFyIGhhdmVHZXR0ZXJzID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhciBvID0ge307XG4gICAgICAgICAgZXM1LmRlZmluZVByb3BlcnR5KG8sIFwiZlwiLCB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIDM7XG4gICAgICAgICAgICB9fSk7XG4gICAgICAgICAgcmV0dXJuIG8uZiA9PT0gMztcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSkoKTtcbiAgICAgIHZhciBlcnJvck9iaiA9IHtlOiB7fX07XG4gICAgICB2YXIgdHJ5Q2F0Y2hUYXJnZXQ7XG4gICAgICBmdW5jdGlvbiB0cnlDYXRjaGVyKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJldHVybiB0cnlDYXRjaFRhcmdldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiB0cnlDYXRjaChmbikge1xuICAgICAgICB0cnlDYXRjaFRhcmdldCA9IGZuO1xuICAgICAgICByZXR1cm4gdHJ5Q2F0Y2hlcjtcbiAgICAgIH1cbiAgICAgIHZhciBpbmhlcml0cyA9IGZ1bmN0aW9uKENoaWxkLCBQYXJlbnQpIHtcbiAgICAgICAgdmFyIGhhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgICAgICAgZnVuY3Rpb24gVCgpIHtcbiAgICAgICAgICB0aGlzLmNvbnN0cnVjdG9yID0gQ2hpbGQ7XG4gICAgICAgICAgdGhpcy5jb25zdHJ1Y3RvciQgPSBQYXJlbnQ7XG4gICAgICAgICAgZm9yICh2YXIgcHJvcGVydHlOYW1lIGluIFBhcmVudC5wcm90b3R5cGUpIHtcbiAgICAgICAgICAgIGlmIChoYXNQcm9wLmNhbGwoUGFyZW50LnByb3RvdHlwZSwgcHJvcGVydHlOYW1lKSAmJiBwcm9wZXJ0eU5hbWUuY2hhckF0KHByb3BlcnR5TmFtZS5sZW5ndGggLSAxKSAhPT0gXCIkXCIpIHtcbiAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eU5hbWUgKyBcIiRcIl0gPSBQYXJlbnQucHJvdG90eXBlW3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFQucHJvdG90eXBlID0gUGFyZW50LnByb3RvdHlwZTtcbiAgICAgICAgQ2hpbGQucHJvdG90eXBlID0gbmV3IFQoKTtcbiAgICAgICAgcmV0dXJuIENoaWxkLnByb3RvdHlwZTtcbiAgICAgIH07XG4gICAgICBmdW5jdGlvbiBpc1ByaW1pdGl2ZSh2YWwpIHtcbiAgICAgICAgcmV0dXJuIHZhbCA9PSBudWxsIHx8IHZhbCA9PT0gdHJ1ZSB8fCB2YWwgPT09IGZhbHNlIHx8IHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHZhbCA9PT0gXCJudW1iZXJcIjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAhaXNQcmltaXRpdmUodmFsdWUpO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gbWF5YmVXcmFwQXNFcnJvcihtYXliZUVycm9yKSB7XG4gICAgICAgIGlmICghaXNQcmltaXRpdmUobWF5YmVFcnJvcikpXG4gICAgICAgICAgcmV0dXJuIG1heWJlRXJyb3I7XG4gICAgICAgIHJldHVybiBuZXcgRXJyb3Ioc2FmZVRvU3RyaW5nKG1heWJlRXJyb3IpKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHdpdGhBcHBlbmRlZCh0YXJnZXQsIGFwcGVuZGVlKSB7XG4gICAgICAgIHZhciBsZW4gPSB0YXJnZXQubGVuZ3RoO1xuICAgICAgICB2YXIgcmV0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgcmV0W2ldID0gdGFyZ2V0W2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldFtpXSA9IGFwcGVuZGVlO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gZ2V0RGF0YVByb3BlcnR5T3JEZWZhdWx0KG9iaiwga2V5LCBkZWZhdWx0VmFsdWUpIHtcbiAgICAgICAgaWYgKGVzNS5pc0VTNSkge1xuICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSk7XG4gICAgICAgICAgaWYgKGRlc2MgIT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIGRlc2MuZ2V0ID09IG51bGwgJiYgZGVzYy5zZXQgPT0gbnVsbCA/IGRlc2MudmFsdWUgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSA/IG9ialtrZXldIDogdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBub3RFbnVtZXJhYmxlUHJvcChvYmosIG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmIChpc1ByaW1pdGl2ZShvYmopKVxuICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0ge1xuICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgZXM1LmRlZmluZVByb3BlcnR5KG9iaiwgbmFtZSwgZGVzY3JpcHRvcik7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9XG4gICAgICB2YXIgd3JhcHNQcmltaXRpdmVSZWNlaXZlciA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMgIT09IFwic3RyaW5nXCI7XG4gICAgICB9KS5jYWxsKFwic3RyaW5nXCIpO1xuICAgICAgZnVuY3Rpb24gdGhyb3dlcihyKSB7XG4gICAgICAgIHRocm93IHI7XG4gICAgICB9XG4gICAgICB2YXIgaW5oZXJpdGVkRGF0YUtleXMgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChlczUuaXNFUzUpIHtcbiAgICAgICAgICB2YXIgb1Byb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcbiAgICAgICAgICB2YXIgZ2V0S2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzO1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICAgIHZhciB2aXNpdGVkS2V5cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgICAgICB3aGlsZSAob2JqICE9IG51bGwgJiYgb2JqICE9PSBvUHJvdG8pIHtcbiAgICAgICAgICAgICAgdmFyIGtleXM7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAga2V5cyA9IGdldEtleXMob2JqKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgICAgICAgICAgaWYgKHZpc2l0ZWRLZXlzW2tleV0pXG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB2aXNpdGVkS2V5c1trZXldID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpO1xuICAgICAgICAgICAgICAgIGlmIChkZXNjICE9IG51bGwgJiYgZGVzYy5nZXQgPT0gbnVsbCAmJiBkZXNjLnNldCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICByZXQucHVzaChrZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBvYmogPSBlczUuZ2V0UHJvdG90eXBlT2Yob2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgIHJldC5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0pKCk7XG4gICAgICBmdW5jdGlvbiBpc0NsYXNzKGZuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB2YXIga2V5cyA9IGVzNS5uYW1lcyhmbi5wcm90b3R5cGUpO1xuICAgICAgICAgICAgaWYgKGVzNS5pc0VTNSlcbiAgICAgICAgICAgICAgcmV0dXJuIGtleXMubGVuZ3RoID4gMTtcbiAgICAgICAgICAgIHJldHVybiBrZXlzLmxlbmd0aCA+IDAgJiYgIShrZXlzLmxlbmd0aCA9PT0gMSAmJiBrZXlzWzBdID09PSBcImNvbnN0cnVjdG9yXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHRvRmFzdFByb3BlcnRpZXMob2JqKSB7XG4gICAgICAgIGZ1bmN0aW9uIGYoKSB7fVxuICAgICAgICBmLnByb3RvdHlwZSA9IG9iajtcbiAgICAgICAgcmV0dXJuIGY7XG4gICAgICAgIGV2YWwob2JqKTtcbiAgICAgIH1cbiAgICAgIHZhciByaWRlbnQgPSAvXlthLXokX11bYS16JF8wLTldKiQvaTtcbiAgICAgIGZ1bmN0aW9uIGlzSWRlbnRpZmllcihzdHIpIHtcbiAgICAgICAgcmV0dXJuIHJpZGVudC50ZXN0KHN0cik7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBmaWxsZWRSYW5nZShjb3VudCwgcHJlZml4LCBzdWZmaXgpIHtcbiAgICAgICAgdmFyIHJldCA9IG5ldyBBcnJheShjb3VudCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkge1xuICAgICAgICAgIHJldFtpXSA9IHByZWZpeCArIGkgKyBzdWZmaXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHNhZmVUb1N0cmluZyhvYmopIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXR1cm4gb2JqICsgXCJcIjtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHJldHVybiBcIltubyBzdHJpbmcgcmVwcmVzZW50YXRpb25dXCI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbihlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgbm90RW51bWVyYWJsZVByb3AoZSwgXCJpc09wZXJhdGlvbmFsXCIsIHRydWUpO1xuICAgICAgICB9IGNhdGNoIChpZ25vcmUpIHt9XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBvcmlnaW5hdGVzRnJvbVJlamVjdGlvbihlKSB7XG4gICAgICAgIGlmIChlID09IG51bGwpXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gKChlIGluc3RhbmNlb2YgRXJyb3JbXCJfX0JsdWViaXJkRXJyb3JUeXBlc19fXCJdLk9wZXJhdGlvbmFsRXJyb3IpIHx8IGVbXCJpc09wZXJhdGlvbmFsXCJdID09PSB0cnVlKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGNhbkF0dGFjaFRyYWNlKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqIGluc3RhbmNlb2YgRXJyb3IgJiYgZXM1LnByb3BlcnR5SXNXcml0YWJsZShvYmosIFwic3RhY2tcIik7XG4gICAgICB9XG4gICAgICB2YXIgZW5zdXJlRXJyb3JPYmplY3QgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghKFwic3RhY2tcIiBpbiBuZXcgRXJyb3IoKSkpIHtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChjYW5BdHRhY2hUcmFjZSh2YWx1ZSkpXG4gICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihzYWZlVG9TdHJpbmcodmFsdWUpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICByZXR1cm4gZXJyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoY2FuQXR0YWNoVHJhY2UodmFsdWUpKVxuICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKHNhZmVUb1N0cmluZyh2YWx1ZSkpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0pKCk7XG4gICAgICBmdW5jdGlvbiBjbGFzc1N0cmluZyhvYmopIHtcbiAgICAgICAgcmV0dXJuIHt9LnRvU3RyaW5nLmNhbGwob2JqKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGNvcHlEZXNjcmlwdG9ycyhmcm9tLCB0bywgZmlsdGVyKSB7XG4gICAgICAgIHZhciBrZXlzID0gZXM1Lm5hbWVzKGZyb20pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgICBpZiAoZmlsdGVyKGtleSkpIHtcbiAgICAgICAgICAgIGVzNS5kZWZpbmVQcm9wZXJ0eSh0bywga2V5LCBlczUuZ2V0RGVzY3JpcHRvcihmcm9tLCBrZXkpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciByZXQgPSB7XG4gICAgICAgIGlzQ2xhc3M6IGlzQ2xhc3MsXG4gICAgICAgIGlzSWRlbnRpZmllcjogaXNJZGVudGlmaWVyLFxuICAgICAgICBpbmhlcml0ZWREYXRhS2V5czogaW5oZXJpdGVkRGF0YUtleXMsXG4gICAgICAgIGdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdDogZ2V0RGF0YVByb3BlcnR5T3JEZWZhdWx0LFxuICAgICAgICB0aHJvd2VyOiB0aHJvd2VyLFxuICAgICAgICBpc0FycmF5OiBlczUuaXNBcnJheSxcbiAgICAgICAgaGF2ZUdldHRlcnM6IGhhdmVHZXR0ZXJzLFxuICAgICAgICBub3RFbnVtZXJhYmxlUHJvcDogbm90RW51bWVyYWJsZVByb3AsXG4gICAgICAgIGlzUHJpbWl0aXZlOiBpc1ByaW1pdGl2ZSxcbiAgICAgICAgaXNPYmplY3Q6IGlzT2JqZWN0LFxuICAgICAgICBjYW5FdmFsdWF0ZTogY2FuRXZhbHVhdGUsXG4gICAgICAgIGVycm9yT2JqOiBlcnJvck9iaixcbiAgICAgICAgdHJ5Q2F0Y2g6IHRyeUNhdGNoLFxuICAgICAgICBpbmhlcml0czogaW5oZXJpdHMsXG4gICAgICAgIHdpdGhBcHBlbmRlZDogd2l0aEFwcGVuZGVkLFxuICAgICAgICBtYXliZVdyYXBBc0Vycm9yOiBtYXliZVdyYXBBc0Vycm9yLFxuICAgICAgICB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyOiB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyLFxuICAgICAgICB0b0Zhc3RQcm9wZXJ0aWVzOiB0b0Zhc3RQcm9wZXJ0aWVzLFxuICAgICAgICBmaWxsZWRSYW5nZTogZmlsbGVkUmFuZ2UsXG4gICAgICAgIHRvU3RyaW5nOiBzYWZlVG9TdHJpbmcsXG4gICAgICAgIGNhbkF0dGFjaFRyYWNlOiBjYW5BdHRhY2hUcmFjZSxcbiAgICAgICAgZW5zdXJlRXJyb3JPYmplY3Q6IGVuc3VyZUVycm9yT2JqZWN0LFxuICAgICAgICBvcmlnaW5hdGVzRnJvbVJlamVjdGlvbjogb3JpZ2luYXRlc0Zyb21SZWplY3Rpb24sXG4gICAgICAgIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbjogbWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uLFxuICAgICAgICBjbGFzc1N0cmluZzogY2xhc3NTdHJpbmcsXG4gICAgICAgIGNvcHlEZXNjcmlwdG9yczogY29weURlc2NyaXB0b3JzLFxuICAgICAgICBpc05vZGU6IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIGNsYXNzU3RyaW5nKHByb2Nlc3MpLnRvTG93ZXJDYXNlKCkgPT09IFwiW29iamVjdCBwcm9jZXNzXVwiXG4gICAgICB9O1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldC5sYXN0TGluZUVycm9yID0gZTtcbiAgICAgIH1cbiAgICAgIG1vZHVsZS5leHBvcnRzID0gcmV0O1xuICAgIH0sIHtcIi4vZXM1LmpzXCI6IDE0fV1cbiAgfSwge30sIFs0XSkoNCk7XG59KTtcbjtcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cgIT09IG51bGwpIHtcbiAgd2luZG93LlAgPSB3aW5kb3cuUHJvbWlzZTtcbn0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmIHNlbGYgIT09IG51bGwpIHtcbiAgc2VsZi5QID0gc2VsZi5Qcm9taXNlO1xufVxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYmx1ZWJpcmQvanMvYnJvd3Nlci9ibHVlYmlyZC5qc1xuICoqIG1vZHVsZSBpZCA9IDE2XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvbm9kZV9tb2R1bGVzL2F1dG9wcmVmaXhlci1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL3NyYy9leGFtcGxlMi9leGFtcGxlMi5zY3NzXCIpO1xuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4vLyBhZGQgdGhlIHN0eWxlcyB0byB0aGUgRE9NXG52YXIgdXBkYXRlID0gcmVxdWlyZShcIiEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1wiKShjb250ZW50LCB7fSk7XG4vLyBIb3QgTW9kdWxlIFJlcGxhY2VtZW50XG5pZihtb2R1bGUuaG90KSB7XG5cdC8vIFdoZW4gdGhlIHN0eWxlcyBjaGFuZ2UsIHVwZGF0ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuYWNjZXB0KFwiISEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvc3JjL2V4YW1wbGUyL2V4YW1wbGUyLnNjc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvc3JjL2V4YW1wbGUyL2V4YW1wbGUyLnNjc3NcIik7XG5cdFx0aWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG5cdFx0dXBkYXRlKG5ld0NvbnRlbnQpO1xuXHR9KTtcblx0Ly8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuXHRtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24oKSB7IHVwZGF0ZSgpOyB9KTtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2V4YW1wbGUyL2V4YW1wbGUyLnNjc3NcbiAqKiBtb2R1bGUgaWQgPSAxN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Nzc1RvU3RyaW5nLmpzXCIpKCk7XG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCJodG1sLGJvZHl7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTttYXJnaW46MDtwYWRkaW5nOjA7fWJvZHl7cG9zaXRpb246YWJzb2x1dGU7b3ZlcmZsb3c6aGlkZGVuO30jY2lyY3VpdGJvYXJke3Bvc2l0aW9uOmFic29sdXRlO3RvcDoyMHB4O2xlZnQ6MjBweDtyaWdodDoyMHB4O2JvdHRvbToyMHB4O3otaW5kZXg6MTt9I3RocmVlLWQtY2FudmFze3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDtyaWdodDowO2JvdHRvbTowO21hcmdpbjowO3BhZGRpbmc6MDt6LWluZGV4OjA7fS50aWxley13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTtjdXJzb3I6cG9pbnRlcjt0ZXh0LWFsaWduOmNlbnRlcjtvdmVyZmxvdzpoaWRkZW47Ym9yZGVyOnNvbGlkIDFweDt9LnRpbGU+aGVhZGVye2Rpc3BsYXk6LXdlYmtpdC1ib3g7ZGlzcGxheTotd2Via2l0LWZsZXg7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LXdlYmtpdC1ib3gtYWxpZ246Y2VudGVyOy13ZWJraXQtYWxpZ24taXRlbXM6Y2VudGVyOy1tcy1mbGV4LWFsaWduOmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7LXdlYmtpdC1ib3gtcGFjazpjZW50ZXI7LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOy1tcy1mbGV4LXBhY2s6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Zm9udC13ZWlnaHQ6Ym9sZDtib3JkZXItd2lkdGg6MXB4O30udGlsZS5vcGVuPmhlYWRlcntoZWlnaHQ6MjZweDtib3JkZXItc3R5bGU6bm9uZSBub25lIHNvbGlkIG5vbmU7bGluZS1oZWlnaHQ6MjZweDtmb250LXNpemU6MjAuOHB4O3doaXRlLXNwYWNlOm5vd3JhcDtvdmVyZmxvdzpoaWRkZW47fS50aWxlOm5vdCgub3Blbik+aGVhZGVye2JvcmRlci1zdHlsZTpub25lO30udGlsZTpub3QoLmFjdGl2ZSl7Ym9yZGVyLXN0eWxlOmRvdHRlZCAhaW1wb3J0YW50O30udGlsZT5zZWN0aW9uey13ZWJraXQtdXNlci1zZWxlY3Q6dGV4dDstbW96LXVzZXItc2VsZWN0OnRleHQ7LW1zLXVzZXItc2VsZWN0OnRleHQ7dXNlci1zZWxlY3Q6dGV4dDt9LnRpbGU6bm90KC5vcGVuKT5zZWN0aW9ue2Rpc3BsYXk6bm9uZTt9XCIsIFwiXCJdKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9jc3MtbG9hZGVyIS4vfi9hdXRvcHJlZml4ZXItbG9hZGVyIS4vfi9zYXNzLWxvYWRlciEuL3NyYy9leGFtcGxlMi9leGFtcGxlMi5zY3NzXG4gKiogbW9kdWxlIGlkID0gMThcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2pxdWVyeScsICdibHVlYmlyZCcsICcuL21pc2MuanMnLCAnLi4vQXJ0ZWZhY3QuanMnLCAnLi9rZWZpci1hbmQtZWdncy5qcyddLCBmdW5jdGlvbigkLCBQLCBVLCBBcnRlZmFjdFApIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBmdW5jdGlvbiBuZXdXaWRnZXRUeXBlKHR5cGVOYW1lKSB7XG4gICAgdmFyIG9wdGlvbkRlZmF1bHRzID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuICAgIHZhciBXaWRnZXRQID0gQXJ0ZWZhY3RQLnRoZW4oKGZ1bmN0aW9uKEFydGVmYWN0KSB7XG4gICAgICByZXR1cm4gQXJ0ZWZhY3QubmV3U3ViY2xhc3ModHlwZU5hbWUsIGZ1bmN0aW9uKCRfXzEpIHtcbiAgICAgICAgdmFyIGNzc0NsYXNzID0gJF9fMS5jc3NDbGFzcztcbiAgICAgICAgdmFyICRfXzAgPSB0aGlzO1xuICAgICAgICBpZiAoVS5pc0RlZmluZWQoY3NzQ2xhc3MpKSB7XG4gICAgICAgICAgdGhpcy5lbGVtZW50LmFkZENsYXNzKGNzc0NsYXNzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVsZW1lbnQuYXNLZWZpclN0cmVhbSgncmVtb3ZlJykub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJF9fMC5kZXN0cm95KCk7XG4gICAgICAgIH0pKTtcbiAgICAgIH0sIHtcbiAgICAgICAgZ2V0IG1vZGVsKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMubW9kZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGdldCBlbGVtZW50KCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuZWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgfSwgVS5leHRlbmQoe2JlZm9yZUNvbnN0cnVjdGlvbjogUC5yZXNvbHZlKCl9LCBvcHRpb25EZWZhdWx0cykpO1xuICAgIH0pKTtcbiAgICB2YXIgbG93ZXJjYXNlTmFtZSA9IHR5cGVOYW1lWzBdLnRvTG93ZXJDYXNlKCkgKyB0eXBlTmFtZS5zbGljZSgxKTtcbiAgICAkLmZuW2xvd2VyY2FzZU5hbWVdID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgdmFyICRfXzAgPSB0aGlzO1xuICAgICAgaWYgKG9wdGlvbnMgPT09ICdpbnN0YW5jZScpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YSgoXCItYW15LVwiICsgbG93ZXJjYXNlTmFtZSkpO1xuICAgICAgfVxuICAgICAgdGhpcy5kYXRhKChcIi1hbXktXCIgKyBsb3dlcmNhc2VOYW1lKSwgV2lkZ2V0UC50aGVuKChmdW5jdGlvbihXaWRnZXQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBXaWRnZXQoVS5leHRlbmQob3B0aW9ucywge2VsZW1lbnQ6ICRfXzB9KSkuY29uc3RydWN0ZWQ7XG4gICAgICB9KSkpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICByZXR1cm4gV2lkZ2V0UDtcbiAgfVxuICByZXR1cm4gbmV3V2lkZ2V0VHlwZTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy91dGlsL25ld1dpZGdldFR5cGUuanNcbiAqKiBtb2R1bGUgaWQgPSAxOVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZGVmaW5lKFsnanF1ZXJ5JywgJ2JsdWViaXJkJywgJy4vbWlzYy5qcycsICcuL2tlZmlyLXNpZ25hbC1oYW5kbGVyLmpzJywgJy4vZGVmZXIuanMnLCAnLi9tYWluLWRlbHRhLW1vZGVsLmpzJ10sIGZ1bmN0aW9uKCQsIFAsIFUsIFNpZ25hbEhhbmRsZXIsIGRlZmVyLCBkbSkge1xuICAndXNlIHN0cmljdCc7XG4gIGlmICghd2luZG93Ll9hbXlQbHVnaW4pIHtcbiAgICB3aW5kb3cuX2FteVBsdWdpbiA9IGZ1bmN0aW9uKHBsdWdpbk9yU2VsZWN0aW9uKSB7XG4gICAgICBpZiAoJC5pc1BsYWluT2JqZWN0KHBsdWdpbk9yU2VsZWN0aW9uKSkge1xuICAgICAgICByZXR1cm4gbmV3IGRtLkRlbHRhKHBsdWdpbk9yU2VsZWN0aW9uLm5hbWUsIHBsdWdpbk9yU2VsZWN0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFUuYXNzZXJ0KCFfc2VsZWN0ZWREZWZlcnJlZC5kb25lLCBcIkFwaU5BVE9NWSBwbHVnaW5zIGNhbiBvbmx5IGJlIHNlbGVjdGVkIG9uY2UsIGFmdGVyIHdoaWNoIHRoZXkgYXJlIGZpeGVkLlwiKTtcbiAgICAgICAgX3NlbGVjdGVkRGVmZXJyZWQuZG9uZSA9IHRydWU7XG4gICAgICAgIGRtLnNlbGVjdC5hcHBseShkbSwgcGx1Z2luT3JTZWxlY3Rpb24pO1xuICAgICAgICBfc2VsZWN0ZWREZWZlcnJlZC5yZXNvbHZlKHRoaXMpO1xuICAgICAgICByZXR1cm4gd2luZG93Ll9hbXlQbHVnaW4uc2VsZWN0ZWQ7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgX3NlbGVjdGVkRGVmZXJyZWQgPSBkZWZlcigpO1xuICAgIHdpbmRvdy5fYW15UGx1Z2luLnNlbGVjdGVkID0gX3NlbGVjdGVkRGVmZXJyZWQucHJvbWlzZTtcbiAgICB3aW5kb3cuX2FteVBsdWdpbi5ncmFwaCA9IChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBkbS5ncmFwaCgpO1xuICAgIH0pO1xuICAgIHdpbmRvdy5fYW15UGx1Z2luLmRtID0gZG07XG4gIH1cbiAgcmV0dXJuIHdpbmRvdy5fYW15UGx1Z2luO1xufSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3V0aWwvcGx1Z2luLmpzXG4gKiogbW9kdWxlIGlkID0gMjBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2JsdWViaXJkJ10sIChmdW5jdGlvbihQKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyIFUgPSB7XG4gICAgbmV3Q2xhc3M6IGZ1bmN0aW9uKGNvbnN0cnVjdG9yKSB7XG4gICAgICB2YXIgcHJvdG90eXBlID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlID0gcHJvdG90eXBlO1xuICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY29uc3RydWN0b3I7XG4gICAgICByZXR1cm4gY29uc3RydWN0b3I7XG4gICAgfSxcbiAgICBuZXdTdWJjbGFzczogZnVuY3Rpb24oc3VwZXJDbGFzcywgY29uc3RydWN0b3JNYWtlcikge1xuICAgICAgdmFyIHByb3RvdHlwZSA9IGFyZ3VtZW50c1syXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMl0gOiB7fTtcbiAgICAgIHZhciBjb25zdHJ1Y3RvciA9IGNvbnN0cnVjdG9yTWFrZXIoc3VwZXJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IpO1xuICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7XG4gICAgICBVLmV4dGVuZChjb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvdHlwZSk7XG4gICAgICBjb25zdHJ1Y3Rvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBjb25zdHJ1Y3RvcjtcbiAgICAgIHJldHVybiBjb25zdHJ1Y3RvcjtcbiAgICB9LFxuICAgIGV4dGVuZDogZnVuY3Rpb24ob2JqMSkge1xuICAgICAgZm9yICh2YXIgcmVzdCA9IFtdLFxuICAgICAgICAgICRfXzEgPSAxOyAkX18xIDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMSsrKVxuICAgICAgICByZXN0WyRfXzEgLSAxXSA9IGFyZ3VtZW50c1skX18xXTtcbiAgICAgIHJlc3QuZm9yRWFjaCgoZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmoxLCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICAgIHJldHVybiBvYmoxO1xuICAgIH0sXG4gICAgZmllbGQ6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiAoZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIHJldHVybiBvYmpbbmFtZV07XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGNhbGw6IGZ1bmN0aW9uKGZuKSB7XG4gICAgICBmb3IgKHZhciBhcmdzID0gW10sXG4gICAgICAgICAgJF9fMiA9IDE7ICRfXzIgPCBhcmd1bWVudHMubGVuZ3RoOyAkX18yKyspXG4gICAgICAgIGFyZ3NbJF9fMiAtIDFdID0gYXJndW1lbnRzWyRfXzJdO1xuICAgICAgcmV0dXJuIGZuLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7XG4gICAgfSxcbiAgICBpZDogZnVuY3Rpb24odikge1xuICAgICAgcmV0dXJuIHY7XG4gICAgfSxcbiAgICBnZXREZWY6IGZ1bmN0aW9uKG9iaiwgbmFtZSwgdmFsdWUpIHtcbiAgICAgIGlmIChVLmlzVW5kZWZpbmVkKG9ialtuYW1lXSkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHZhbHVlID0gdmFsdWUoKTtcbiAgICAgICAgfVxuICAgICAgICBvYmpbbmFtZV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvYmpbbmFtZV07XG4gICAgfSxcbiAgICBvYmplY3Q6IGZ1bmN0aW9uKG9iaiwgbmFtZSkge1xuICAgICAgcmV0dXJuIFUuZ2V0RGVmKG9iaiwgbmFtZSwge30pO1xuICAgIH0sXG4gICAgYXJyYXk6IGZ1bmN0aW9uKG9iaiwgbmFtZSkge1xuICAgICAgcmV0dXJuIFUuZ2V0RGVmKG9iaiwgbmFtZSwgW10pO1xuICAgIH0sXG4gICAgcHVsbDogZnVuY3Rpb24oYXJyLCB2YWwpIHtcbiAgICAgIHZhciBpID0gYXJyLmluZGV4T2YodmFsKTtcbiAgICAgIGlmIChpICE9PSAtMSkge1xuICAgICAgICBhcnIuc3BsaWNlKGkpO1xuICAgICAgfVxuICAgIH0sXG4gICAgbWFrZUVtcHR5OiBmdW5jdGlvbihhcnIpIHtcbiAgICAgIHdoaWxlIChhcnIubGVuZ3RoID4gMCkge1xuICAgICAgICBhcnIucG9wKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBiaW5kQTogZnVuY3Rpb24oZm4sIGN0eCwgYXJncykge1xuICAgICAgcmV0dXJuIGZuLmJpbmQuYXBwbHkoZm4sIFtjdHhdLmNvbmNhdChhcmdzKSk7XG4gICAgfSxcbiAgICBiaW5kOiBmdW5jdGlvbihvYmosIG0pIHtcbiAgICAgIGZvciAodmFyIGFyZ3MgPSBbXSxcbiAgICAgICAgICAkX18zID0gMjsgJF9fMyA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzMrKylcbiAgICAgICAgYXJnc1skX18zIC0gMl0gPSBhcmd1bWVudHNbJF9fM107XG4gICAgICByZXR1cm4gVS5iaW5kQShvYmpbbV0sIG9iaiwgYXJncyk7XG4gICAgfSxcbiAgICBhcHBseUNvbnN0cnVjdG9yOiBmdW5jdGlvbihDb25zdHJ1Y3RvckZuLCBhcmdzKSB7XG4gICAgICB2YXIgTmV3Q29uc3RydWN0b3JGbiA9IENvbnN0cnVjdG9yRm4uYmluZC5hcHBseShDb25zdHJ1Y3RvckZuLCBbbnVsbF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgIHJldHVybiBuZXcgTmV3Q29uc3RydWN0b3JGbigpO1xuICAgIH0sXG4gICAgYXNzZXJ0OiBmdW5jdGlvbihjb25kaXRpb24sIG1lc3NhZ2UpIHtcbiAgICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlIHx8IFwiQXNzZXJ0aW9uIGZhaWxlZFwiKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGlzVW5kZWZpbmVkOiBmdW5jdGlvbih2YWwpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJztcbiAgICB9LFxuICAgIGlzRGVmaW5lZDogZnVuY3Rpb24odmFsKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIHZhbCAhPT0gJ3VuZGVmaW5lZCc7XG4gICAgfSxcbiAgICBpc1BsYWluT2JqZWN0OiBmdW5jdGlvbih2YWwpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsID09PSAnb2JqZWN0JyAmJiB2YWwuY29uc3RydWN0b3IgPT09IE9iamVjdDtcbiAgICB9LFxuICAgIGlzRnVuY3Rpb246IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgcmV0dXJuIHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbic7XG4gICAgfSxcbiAgICBvYmpWYWx1ZXM6IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubWFwKChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgcmV0dXJuIG9ialtrZXldO1xuICAgICAgfSkpO1xuICAgIH0sXG4gICAgbWFrZVBvc2l0aW9uZWQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgIGlmIChlbGVtZW50LmNzcygncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycpIHtcbiAgICAgICAgZWxlbWVudC5jc3MoJ3Bvc2l0aW9uJywgJ3JlbGF0aXZlJyk7XG4gICAgICB9XG4gICAgfSxcbiAgICBkZWZPcjogZnVuY3Rpb24oKSB7XG4gICAgICBmb3IgKHZhciB2YWx1ZXMgPSBbXSxcbiAgICAgICAgICAkX180ID0gMDsgJF9fNCA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzQrKylcbiAgICAgICAgdmFsdWVzWyRfXzRdID0gYXJndW1lbnRzWyRfXzRdO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKFUuaXNEZWZpbmVkKHZhbHVlc1tpXSkpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWVzW2ldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBkZWJvdW5jZTogZnVuY3Rpb24oZnVuYywgd2FpdCwgY29udGV4dCkge1xuICAgICAgdmFyIHRpbWVvdXQ7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvciAodmFyIGFyZ3MgPSBbXSxcbiAgICAgICAgICAgICRfXzUgPSAwOyAkX181IDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fNSsrKVxuICAgICAgICAgIGFyZ3NbJF9fNV0gPSBhcmd1bWVudHNbJF9fNV07XG4gICAgICAgIHZhciAkX18wID0gdGhpcztcbiAgICAgICAgdmFyIGxhdGVyRm4gPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0IHx8ICRfXzAsIGFyZ3MpO1xuICAgICAgICB9KTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlckZuLCB3YWl0KTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBvbmNlUGVyU3RhY2s6IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQpIHtcbiAgICAgIHZhciBub3RSdW5ZZXQgPSB0cnVlO1xuICAgICAgdmFyIHJlc3VsdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmb3IgKHZhciBhcmdzID0gW10sXG4gICAgICAgICAgICAkX181ID0gMDsgJF9fNSA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzUrKylcbiAgICAgICAgICBhcmdzWyRfXzVdID0gYXJndW1lbnRzWyRfXzVdO1xuICAgICAgICBpZiAobm90UnVuWWV0KSB7XG4gICAgICAgICAgbm90UnVuWWV0ID0gZmFsc2U7XG4gICAgICAgICAgc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBub3RSdW5ZZXQgPSB0cnVlO1xuICAgICAgICAgIH0pLCAwKTtcbiAgICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQgfHwgdGhpcywgYXJncyk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICByZXN1bHQuYWxsb3dBZGRpdGlvbmFsQ2FsbCA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgbm90UnVuWWV0ID0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuICAgIGNhY2hlZDogZnVuY3Rpb24oJF9fNikge1xuICAgICAgdmFyICRfXzcgPSAkX182LFxuICAgICAgICAgIHJldHJpZXZlID0gJF9fNy5yZXRyaWV2ZSxcbiAgICAgICAgICBpc0VxdWFsID0gJF9fNy5pc0VxdWFsO1xuICAgICAgaXNFcXVhbCA9IGlzRXF1YWwgfHwgKChmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgIHJldHVybiAoYSA9PT0gYik7XG4gICAgICB9KSk7XG4gICAgICB2YXIgY2FjaGU7XG4gICAgICBmdW5jdGlvbiByZXRyaWV2ZVZhbHVlKCkge1xuICAgICAgICB2YXIgbmV3VmFsdWUgPSByZXRyaWV2ZSgpO1xuICAgICAgICB2YXIgb2xkVmFsdWUgPSBjYWNoZTtcbiAgICAgICAgaWYgKCFpc0VxdWFsKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpIHtcbiAgICAgICAgICBjYWNoZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgIG9uQ2hhbmdlLmZvckVhY2goKGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgICByZXR1cm4gZm4obmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBvbmNlUGVyU3RhY2tTZXRWYWx1ZSA9IFUub25jZVBlclN0YWNrKHJldHJpZXZlVmFsdWUpO1xuICAgICAgdmFyIHJlc3VsdEZuID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICBvbmNlUGVyU3RhY2tTZXRWYWx1ZSgpO1xuICAgICAgICByZXR1cm4gY2FjaGU7XG4gICAgICB9KTtcbiAgICAgIHZhciBvbkNoYW5nZSA9IFtdO1xuICAgICAgcmVzdWx0Rm4ub25DaGFuZ2UgPSAoZnVuY3Rpb24oY2IpIHtcbiAgICAgICAgb25DaGFuZ2UucHVzaChjYik7XG4gICAgICAgIHJldHVybiByZXN1bHRGbjtcbiAgICAgIH0pO1xuICAgICAgcmVzdWx0Rm4uYWxsb3dBZGRpdGlvbmFsQ2FsbCA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgb25jZVBlclN0YWNrU2V0VmFsdWUuYWxsb3dBZGRpdGlvbmFsQ2FsbCgpO1xuICAgICAgfSk7XG4gICAgICBvbmNlUGVyU3RhY2tTZXRWYWx1ZSgpO1xuICAgICAgcmV0dXJuIHJlc3VsdEZuO1xuICAgIH0sXG4gICAgcHJvbWlzaWZ5OiBmdW5jdGlvbihvYmosIG1ldGhvZCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICBmb3IgKHZhciBhcmdzID0gW10sXG4gICAgICAgICAgICAkX181ID0gMDsgJF9fNSA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzUrKylcbiAgICAgICAgICBhcmdzWyRfXzVdID0gYXJndW1lbnRzWyRfXzVdO1xuICAgICAgICByZXR1cm4gbmV3IFAoKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBvYmpbbWV0aG9kXS5hcHBseShvYmosIGFyZ3MuY29uY2F0KHJlc29sdmUpKTtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBmaW5kSW5kZXg6IGZ1bmN0aW9uKGFycmF5LCBwcmVkKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGlmIChwcmVkKGFycmF5W2ldLCBpLCBhcnJheSkpIHtcbiAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIC0xO1xuICAgIH0sXG4gICAgbWVtb2l6ZTogZnVuY3Rpb24oZm4pIHtcbiAgICAgIHZhciBrZXlzID0gW107XG4gICAgICB2YXIgY2FjaGUgPSBbXTtcbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgZm9yICh2YXIgYXJncyA9IFtdLFxuICAgICAgICAgICAgJF9fNSA9IDA7ICRfXzUgPCBhcmd1bWVudHMubGVuZ3RoOyAkX181KyspXG4gICAgICAgICAgYXJnc1skX181XSA9IGFyZ3VtZW50c1skX181XTtcbiAgICAgICAgdmFyIGluZGV4ID0gVS5maW5kSW5kZXgoa2V5cywgKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgIHJldHVybiBrZXkuZXZlcnkoKGZ1bmN0aW9uKHYsIGkpIHtcbiAgICAgICAgICAgIHJldHVybiB2ID09PSBhcmdzW2ldO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgIHJldHVybiBjYWNoZVtpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICBrZXlzLnB1c2goYXJncyk7XG4gICAgICAgIGNhY2hlLnB1c2gocmVzdWx0KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgfVxuICB9O1xuICB2YXIgRVBTID0gMC4wMDAwMDE7XG4gIHZhciBzb3J0T2ZFcXVhbCA9IChmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIChiIC0gRVBTIDwgYSAmJiBhIDwgYiArIEVQUyk7XG4gIH0pO1xuICBVLlBvc2l0aW9uID0gVS5uZXdDbGFzcyhmdW5jdGlvbih0b3AsIGxlZnQpIHtcbiAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB0aGlzLmxlZnQgPSBsZWZ0O1xuICB9KTtcbiAgVS5Qb3NpdGlvbi5zdWJ0cmFjdCA9IChmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIG5ldyBVLlBvc2l0aW9uKGEudG9wIC0gYi50b3AsIGEubGVmdCAtIGIubGVmdCk7XG4gIH0pO1xuICBVLlBvc2l0aW9uLmVxdWFscyA9IChmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIFUuaXNEZWZpbmVkKGEpICYmIFUuaXNEZWZpbmVkKGIpICYmIHNvcnRPZkVxdWFsKGEudG9wLCBiLnRvcCkgJiYgc29ydE9mRXF1YWwoYS5sZWZ0LCBiLmxlZnQpO1xuICB9KTtcbiAgVS5TaXplID0gVS5uZXdDbGFzcyhmdW5jdGlvbihoZWlnaHQsIHdpZHRoKSB7XG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICB9KTtcbiAgVS5TaXplLmVxdWFscyA9IChmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIFUuaXNEZWZpbmVkKGEpICYmIFUuaXNEZWZpbmVkKGIpICYmIHNvcnRPZkVxdWFsKGEuaGVpZ2h0LCBiLmhlaWdodCkgJiYgc29ydE9mRXF1YWwoYS53aWR0aCwgYi53aWR0aCk7XG4gIH0pO1xuICByZXR1cm4gVTtcbn0pKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvdXRpbC9taXNjLmpzXG4gKiogbW9kdWxlIGlkID0gMjFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2JsdWViaXJkJ10sIGZ1bmN0aW9uKFApIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICByZXR1cm4gZnVuY3Rpb24gZGVmZXIoKSB7XG4gICAgdmFyIHJlc29sdmUsXG4gICAgICAgIHJlamVjdDtcbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQKGZ1bmN0aW9uKCkge1xuICAgICAgcmVzb2x2ZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgIHJlamVjdCA9IGFyZ3VtZW50c1sxXTtcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzb2x2ZTogcmVzb2x2ZSxcbiAgICAgIHJlamVjdDogcmVqZWN0LFxuICAgICAgcHJvbWlzZTogcHJvbWlzZVxuICAgIH07XG4gIH07XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvdXRpbC9kZWZlci5qc1xuICoqIG1vZHVsZSBpZCA9IDIyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJkZWZpbmUoWydqcXVlcnknLCAnLi9rZWZpci1hbmQtZWdncy5qcyddLCBmdW5jdGlvbigkLCBLZWZpcikge1xuICAndXNlIHN0cmljdCc7XG4gIGZ1bmN0aW9uIHNldERpc3BsYXkoZWxlbWVudCwgbmV3R3Jvdykge1xuICAgIHZhciBvbGRHcm93ID0gZWxlbWVudC5kYXRhKCdhbXlGbGV4R3Jvd1RhcmdldCcpO1xuICAgIGVsZW1lbnQuZGF0YSgnYW15RmxleEdyb3dUYXJnZXQnLCBuZXdHcm93KTtcbiAgICBpZiAob2xkR3JvdyA+IDAgJiYgbmV3R3JvdyA9PT0gMCkge1xuICAgICAgZWxlbWVudC5kYXRhKCdhbXlGbGV4R3Jvd1ByZXZEaXNwbGF5JywgZWxlbWVudC5jc3MoJ2Rpc3BsYXknKSk7XG4gICAgICBlbGVtZW50LmNzcygnZmxleEdyb3cnLCAxZS01KTtcbiAgICAgIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkge1xuICAgICAgICBlbGVtZW50LmFzS2VmaXJTdHJlYW0oJ3RyYW5zaXRpb25lbmQgd2Via2l0VHJhbnNpdGlvbkVuZCcpLm1lcmdlKEtlZmlyLmxhdGVyKDMwMCkpLnRha2UoMSkuZmlsdGVyKChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZWxlbWVudC5kYXRhKCdhbXlGbGV4R3Jvd1RhcmdldCcpID09PSAwO1xuICAgICAgICB9KSkub25WYWx1ZSgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZWxlbWVudC5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICB9KSk7XG4gICAgICB9KSk7XG4gICAgfSBlbHNlIGlmIChvbGRHcm93ID09PSAwICYmIG5ld0dyb3cgPiAwKSB7XG4gICAgICBlbGVtZW50LmNzcygnZGlzcGxheScsIGVsZW1lbnQuZGF0YSgnYW15RmxleEdyb3dQcmV2RGlzcGxheScpKTtcbiAgICAgIGVsZW1lbnQuZGF0YSgnYW15RmxleEdyb3dDc3NTY2hlZHVsZWQnLCB0cnVlKTtcbiAgICAgIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkge1xuICAgICAgICBlbGVtZW50LnJlbW92ZURhdGEoJ2FteUZsZXhHcm93Q3NzU2NoZWR1bGVkJyk7XG4gICAgICAgIGVsZW1lbnQuY3NzKCdmbGV4R3JvdycsIGVsZW1lbnQuZGF0YSgnYW15RmxleEdyb3dUYXJnZXQnKSk7XG4gICAgICB9KSk7XG4gICAgfSBlbHNlIGlmICghZWxlbWVudC5kYXRhKCdhbXlGbGV4R3Jvd0Nzc1NjaGVkdWxlZCcpKSB7XG4gICAgICBlbGVtZW50LmNzcygnZmxleEdyb3cnLCBuZXdHcm93KTtcbiAgICB9XG4gIH1cbiAgJC5mbi5hbXlOZXN0ZWRGbGV4R3JvdyA9IGZ1bmN0aW9uKGdyb3cpIHtcbiAgICBzZXREaXNwbGF5KHRoaXMsIGdyb3cpO1xuICAgIHZhciBncm93U3VtID0gMDtcbiAgICB0aGlzLnBhcmVudCgpLmNoaWxkcmVuKCkuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgIGdyb3dTdW0gKz0gcGFyc2VGbG9hdCgkKHRoaXMpLmRhdGEoJ2FteUZsZXhHcm93VGFyZ2V0JykpO1xuICAgIH0pO1xuICAgIHNldERpc3BsYXkodGhpcy5wYXJlbnQoKSwgZ3Jvd1N1bSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvdXRpbC9uZXN0ZWQtZmxleC1ncm93LmpzXG4gKiogbW9kdWxlIGlkID0gMjNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvc3JjL3AtY29yZS5zY3NzXCIpO1xuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4vLyBhZGQgdGhlIHN0eWxlcyB0byB0aGUgRE9NXG52YXIgdXBkYXRlID0gcmVxdWlyZShcIiEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1wiKShjb250ZW50LCB7fSk7XG4vLyBIb3QgTW9kdWxlIFJlcGxhY2VtZW50XG5pZihtb2R1bGUuaG90KSB7XG5cdC8vIFdoZW4gdGhlIHN0eWxlcyBjaGFuZ2UsIHVwZGF0ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuYWNjZXB0KFwiISEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvc3JjL3AtY29yZS5zY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdHZhciBuZXdDb250ZW50ID0gcmVxdWlyZShcIiEhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvbm9kZV9tb2R1bGVzL2F1dG9wcmVmaXhlci1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL3NyYy9wLWNvcmUuc2Nzc1wiKTtcblx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdH0pO1xuXHQvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC1jb3JlLnNjc3NcbiAqKiBtb2R1bGUgaWQgPSAyNFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Nzc1RvU3RyaW5nLmpzXCIpKCk7XG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIuY2lyY3VpdGJvYXJke2Rpc3BsYXk6LXdlYmtpdC1ib3g7ZGlzcGxheTotd2Via2l0LWZsZXg7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LXdlYmtpdC1ib3gtYWxpZ246c3RyZXRjaDstd2Via2l0LWFsaWduLWl0ZW1zOnN0cmV0Y2g7LW1zLWZsZXgtYWxpZ246c3RyZXRjaDthbGlnbi1pdGVtczpzdHJldGNoO3BhZGRpbmc6MDt9LmNpcmN1aXRib2FyZCAudGlsZW1hcHtkaXNwbGF5Oi13ZWJraXQtYm94O2Rpc3BsYXk6LXdlYmtpdC1mbGV4O2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4Oy13ZWJraXQtYm94LW9yaWVudDp2ZXJ0aWNhbDstd2Via2l0LWJveC1kaXJlY3Rpb246bm9ybWFsOy13ZWJraXQtZmxleC1kaXJlY3Rpb246Y29sdW1uOy1tcy1mbGV4LWRpcmVjdGlvbjpjb2x1bW47ZmxleC1kaXJlY3Rpb246Y29sdW1uOy13ZWJraXQtYm94LXBhY2s6anVzdGlmeTstd2Via2l0LWp1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOy1tcy1mbGV4LXBhY2s6anVzdGlmeTtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2Vlbjt9LmNpcmN1aXRib2FyZCAudGlsZW1hcD4udGlsZXJvd3tkaXNwbGF5Oi13ZWJraXQtYm94O2Rpc3BsYXk6LXdlYmtpdC1mbGV4O2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4Oy13ZWJraXQtYm94LW9yaWVudDpob3Jpem9udGFsOy13ZWJraXQtYm94LWRpcmVjdGlvbjpub3JtYWw7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpyb3c7LW1zLWZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LWRpcmVjdGlvbjpyb3c7LXdlYmtpdC1ib3gtcGFjazpqdXN0aWZ5Oy13ZWJraXQtanVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47LW1zLWZsZXgtcGFjazpqdXN0aWZ5O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO21hcmdpbjowO3BhZGRpbmc6MDtoZWlnaHQ6MDt9LmNpcmN1aXRib2FyZCAudGlsZW1hcD4udGlsZXJvdz4udGlsZXt3aWR0aDowO21hcmdpbjowO3BhZGRpbmc6MDt9LmNpcmN1aXRib2FyZCAudGlsZW1hcD4udGlsZXJvdz4udGlsZTpsYXN0LWNoaWxke21hcmdpbi1yaWdodDowICFpbXBvcnRhbnQ7fS5jaXJjdWl0Ym9hcmQgLnRpbGVtYXA+LnRpbGVyb3c6bGFzdC1jaGlsZHttYXJnaW4tYm90dG9tOjAgIWltcG9ydGFudDt9XCIsIFwiXCJdKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9jc3MtbG9hZGVyIS4vfi9hdXRvcHJlZml4ZXItbG9hZGVyIS4vfi9zYXNzLWxvYWRlciEuL3NyYy9wLWNvcmUuc2Nzc1xuICoqIG1vZHVsZSBpZCA9IDI1XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5kZWZpbmUoWydqcXVlcnknLCAnLi9taXNjLmpzJywgJ2tlZmlyJywgJ3R3ZWVuanMnXSwgZnVuY3Rpb24oJCwgVSwgS2VmaXIsIFRXRUVOKSB7XG4gIHJlcXVpcmUoJ2tlZmlyLWpxdWVyeScpLmluaXQoS2VmaXIsICQpO1xuICBLZWZpci5mcm9tT25OdWxsID0gVS5tZW1vaXplKGZ1bmN0aW9uIGZyb21Pbk51bGwob2JqLCBldmVudE5hbWUpIHtcbiAgICByZXR1cm4gS2VmaXIuZnJvbUJpbmRlcigoZnVuY3Rpb24oZW1pdHRlcikge1xuICAgICAgb2JqLm9uKGV2ZW50TmFtZSwgZW1pdHRlci5lbWl0KTtcbiAgICAgIHJldHVybiAoZnVuY3Rpb24oKSB7XG4gICAgICAgIG9iai5vbihldmVudE5hbWUsIG51bGwpO1xuICAgICAgfSk7XG4gICAgfSkpO1xuICB9KTtcbiAgdmFyIHJlcXVlc3RBbmltYXRpb25GcmFtZUZuID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8ICgoZnVuY3Rpb24oZikge1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGYsIDEwMDAgLyA2MCk7XG4gIH0pKTtcbiAgS2VmaXIuYW5pbWF0aW9uRnJhbWVzID0gZnVuY3Rpb24gYW5pbWF0aW9uRnJhbWVzKCkge1xuICAgIHJldHVybiBLZWZpci5mcm9tQmluZGVyKChmdW5jdGlvbihlbWl0dGVyKSB7XG4gICAgICB2YXIgc3Vic2NyaWJlZCA9IHRydWU7XG4gICAgICAoZnVuY3Rpb24gaXRlcmF0aW9uRm4oKSB7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZUZuKChmdW5jdGlvbigpIHtcbiAgICAgICAgICBlbWl0dGVyLmVtaXQoKTtcbiAgICAgICAgICBpZiAoc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgaXRlcmF0aW9uRm4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgIH0pKCk7XG4gICAgICByZXR1cm4gKGZ1bmN0aW9uKCkge1xuICAgICAgICBzdWJzY3JpYmVkID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9KSk7XG4gIH07XG4gIEtlZmlyLnR3ZWVuID0gZnVuY3Rpb24gdHdlZW4ob2JqU3RhcnQsIG9iakVuZCwgJF9fMSkge1xuICAgIHZhciAkX18yID0gJF9fMSxcbiAgICAgICAgZHVyYXRpb24gPSAkX18yLmR1cmF0aW9uLFxuICAgICAgICBkZWxheSA9ICRfXzIuZGVsYXksXG4gICAgICAgIGVhc2luZyA9ICRfXzIuZWFzaW5nO1xuICAgIHZhciB0dyA9IG5ldyBUV0VFTi5Ud2VlbihvYmpTdGFydCkudG8ob2JqRW5kLCBkdXJhdGlvbik7XG4gICAgdmFyIGJ1cyA9IEtlZmlyLmJ1cygpO1xuICAgIHZhciBhZGRTdHJlYW0gPSAoKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGNoYWluZWRTdHJlYW1zID0gMDtcbiAgICAgIHJldHVybiAoZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIGNoYWluZWRTdHJlYW1zICs9IDE7XG4gICAgICAgIGJ1cy5wbHVnKHN0cmVhbSk7XG4gICAgICAgIHN0cmVhbS5vbkVuZCgoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2hhaW5lZFN0cmVhbXMgLT0gMTtcbiAgICAgICAgICBpZiAoY2hhaW5lZFN0cmVhbXMgPT09IDApIHtcbiAgICAgICAgICAgIGJ1cy5lbmQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgIH0pO1xuICAgIH0pKSgpO1xuICAgIGFkZFN0cmVhbShLZWZpci5mcm9tQmluZGVyKChmdW5jdGlvbihlbWl0dGVyKSB7XG4gICAgICBpZiAoZWFzaW5nKSB7XG4gICAgICAgIHR3LmVhc2luZyhlYXNpbmcpO1xuICAgICAgfVxuICAgICAgaWYgKGRlbGF5KSB7XG4gICAgICAgIHR3LmRlbGF5KGRlbGF5KTtcbiAgICAgIH1cbiAgICAgIHR3Lm9uVXBkYXRlKGZ1bmN0aW9uKCkge1xuICAgICAgICBlbWl0dGVyLmVtaXQodGhpcyk7XG4gICAgICB9KTtcbiAgICAgIHR3Lm9uQ29tcGxldGUoZW1pdHRlci5lbmQpO1xuICAgIH0pKSk7XG4gICAgYnVzLnR3ZWVuID0gdHc7XG4gICAgYnVzLnN0YXJ0ID0gKGZ1bmN0aW9uKCkge1xuICAgICAgdHcuc3RhcnQoKTtcbiAgICAgIHJldHVybiBidXM7XG4gICAgfSk7XG4gICAgYnVzLmNoYWluID0gKGZ1bmN0aW9uKG90aGVyKSB7XG4gICAgICBhZGRTdHJlYW0ob3RoZXIpO1xuICAgICAgdHcuY2hhaW4ob3RoZXIudHdlZW4pO1xuICAgICAgcmV0dXJuIGJ1cztcbiAgICB9KTtcbiAgICByZXR1cm4gYnVzO1xuICB9O1xuICBLZWZpci5rZXlQcmVzcyA9IGZ1bmN0aW9uIGtleVByZXNzKGtleUNvZGUpIHtcbiAgICByZXR1cm4gJCh3aW5kb3cpLmFzS2VmaXJTdHJlYW0oJ2tleXByZXNzJykuZmlsdGVyKChmdW5jdGlvbihlKSB7XG4gICAgICByZXR1cm4gZS5rZXlDb2RlID09PSBrZXlDb2RlO1xuICAgIH0pKTtcbiAgfTtcbiAgS2VmaXIub25jZSA9IGZ1bmN0aW9uIG9uY2UodmFsdWUpIHtcbiAgICByZXR1cm4gS2VmaXIuZnJvbUJpbmRlcigoZnVuY3Rpb24oZW1pdHRlcikge1xuICAgICAgZW1pdHRlci5lbWl0KHZhbHVlKTtcbiAgICAgIGVtaXR0ZXIuZW5kKCk7XG4gICAgfSkpO1xuICB9O1xuICBLZWZpci5mcm9tQXJyYXkgPSBmdW5jdGlvbiBmcm9tQXJyYXkoYXJyYXkpIHtcbiAgICByZXR1cm4gS2VmaXIuZnJvbUJpbmRlcigoZnVuY3Rpb24oZW1pdHRlcikge1xuICAgICAgYXJyYXkuZm9yRWFjaChlbWl0dGVyLmVtaXQpO1xuICAgICAgZW1pdHRlci5lbmQoKTtcbiAgICB9KSk7XG4gIH07XG4gIEtlZmlyLmxpbWl0ZXIgPSBmdW5jdGlvbiBsaW1pdGVyKHBhY2luZykge1xuICAgIHZhciBoYW5kbGVyID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IFUuY2FsbDtcbiAgICB2YXIgd2FudGVkQnVzID0gS2VmaXIuYnVzKCk7XG4gICAgdmFyIG9wZW4gPSBLZWZpci5idXMoKTtcbiAgICB2YXIgY2xvc2UgPSBLZWZpci5idXMoKTtcbiAgICBwYWNpbmcuZmlsdGVyQnkod2FudGVkQnVzLnRvUHJvcGVydHkoZmFsc2UpKS5vblZhbHVlKChmdW5jdGlvbigpIHtcbiAgICAgIGhhbmRsZXIoKGZ1bmN0aW9uKCkge1xuICAgICAgICBvcGVuLmVtaXQoKTtcbiAgICAgICAgd2FudGVkQnVzLmVtaXQoZmFsc2UpO1xuICAgICAgICBjbG9zZS5lbWl0KCk7XG4gICAgICB9KSk7XG4gICAgfSkpO1xuICAgIHJldHVybiBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgIHZhciBidWZmZXIgPSAoYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IHt9KS5idWZmZXI7XG4gICAgICB3YW50ZWRCdXMucGx1ZyhzdHJlYW0ubWFwVG8odHJ1ZSkpO1xuICAgICAgcmV0dXJuIEtlZmlyLmNvbnN0YW50KHRydWUpLnRha2UoMSkuY29uY2F0KGNsb3NlKS5mbGF0TWFwTGF0ZXN0KChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFjY3VtdWxhdG9yID0gKGZ1bmN0aW9uKGFyciwgdmFsKSB7XG4gICAgICAgICAgcmV0dXJuIChidWZmZXIgPyBhcnIuY29uY2F0KFt2YWxdKSA6IFt2YWxdKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdHJlYW0udGFrZVVudGlsQnkob3BlbikucmVkdWNlKGFjY3VtdWxhdG9yLCBbXSkuZmxhdE1hcChLZWZpci5mcm9tQXJyYXkpO1xuICAgICAgfSkpO1xuICAgIH07XG4gIH07XG4gIEtlZmlyLk9ic2VydmFibGUucHJvdG90eXBlLmxpbWl0ZWRCeSA9IGZ1bmN0aW9uIGxpbWl0ZWRCeSh3cmFwcGVyLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHdyYXBwZXIodGhpcywgb3B0aW9ucyk7XG4gIH07XG4gIEtlZmlyLlN0cmVhbS5wcm90b3R5cGUuaG9sZFVudGlsID0gZnVuY3Rpb24gaG9sZFVudGlsKHBhY2luZykge1xuICAgIHZhciAkX18wID0gdGhpcztcbiAgICByZXR1cm4gS2VmaXIuZnJvbUJpbmRlcigoZnVuY3Rpb24oZW1pdHRlcikge1xuICAgICAgdmFyIGJ1ZmZlciA9IFtdO1xuICAgICAgdmFyIHVuc3Vic2NyaWJlVG9UaGlzID0gJF9fMC5vblZhbHVlKChmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBidWZmZXIucHVzaCh2YWx1ZSk7XG4gICAgICB9KSk7XG4gICAgICB2YXIgdW5zdWJzY3JpYmVUb1BhY2luZyA9IHBhY2luZy5vblZhbHVlKChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGJ1ZmZlci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIG9sZEJ1ZmZlciA9IGJ1ZmZlcjtcbiAgICAgICAgICBidWZmZXIgPSBbXTtcbiAgICAgICAgICBvbGRCdWZmZXIuZm9yRWFjaChlbWl0dGVyLmVtaXQpO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgICByZXR1cm4gKGZ1bmN0aW9uKCkge1xuICAgICAgICB1bnN1YnNjcmliZVRvVGhpcygpO1xuICAgICAgICB1bnN1YnNjcmliZVRvUGFjaW5nKCk7XG4gICAgICAgIGJ1ZmZlciA9IG51bGw7XG4gICAgICB9KTtcbiAgICB9KSk7XG4gIH07XG4gIEtlZmlyLk9ic2VydmFibGUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24odmFsdWUsIGNvbXBhcmF0b3IpIHtcbiAgICBjb21wYXJhdG9yID0gY29tcGFyYXRvciB8fCAoKGZ1bmN0aW9uKGUpIHtcbiAgICAgIHJldHVybiBlID09PSB2YWx1ZTtcbiAgICB9KSk7XG4gICAgcmV0dXJuIHRoaXMuc2tpcER1cGxpY2F0ZXMoKS5maWx0ZXIoY29tcGFyYXRvcik7XG4gIH07XG4gIEtlZmlyLk9ic2VydmFibGUucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18wID0gdGhpcztcbiAgICB2YXIgZG9Ob3RoaW5nID0gKGZ1bmN0aW9uKCkge30pO1xuICAgIHRoaXMub25WYWx1ZShkb05vdGhpbmcpO1xuICAgIHJldHVybiAoZnVuY3Rpb24oKSB7XG4gICAgICAkX18wLm9mZlZhbHVlKGRvTm90aGluZyk7XG4gICAgfSk7XG4gIH07XG4gIEtlZmlyLlN0cmVhbS5wcm90b3R5cGUuc2tpcFByb3BhZ2F0aW9uID0gZnVuY3Rpb24obGFiZWwpIHtcbiAgICByZXR1cm4gdGhpcy5maWx0ZXIoKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gIVUuYXJyYXkoZXZlbnQub3JpZ2luYWxFdmVudCwgJ19vbmx5T25jZUZvcicpW2xhYmVsXTtcbiAgICB9KSkubWFwKChmdW5jdGlvbihldmVudCkge1xuICAgICAgVS5hcnJheShldmVudC5vcmlnaW5hbEV2ZW50LCAnX29ubHlPbmNlRm9yJylbbGFiZWxdID0gdHJ1ZTtcbiAgICB9KSk7XG4gIH07XG4gIEtlZmlyLlN0cmVhbS5wcm90b3R5cGUud2hpY2ggPSBmdW5jdGlvbihidXR0b25JZCkge1xuICAgIHZhciBwcmVkID0gKHR5cGVvZiBidXR0b25JZCA9PT0gJ2Z1bmN0aW9uJykgPyAoYnV0dG9uSWQpIDogKChmdW5jdGlvbihiKSB7XG4gICAgICByZXR1cm4gYiA9PT0gYnV0dG9uSWQ7XG4gICAgfSkpO1xuICAgIHJldHVybiB0aGlzLmZpbHRlcigoZnVuY3Rpb24oZSkge1xuICAgICAgcmV0dXJuIHByZWQoZS53aGljaCk7XG4gICAgfSkpO1xuICB9O1xuICAkLmZuLm1vdXNlRHJhZyA9IGZ1bmN0aW9uIG1vdXNlRHJhZygpIHtcbiAgICB2YXIgdGhyZXNob2xkID0gKGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiB7fSkudGhyZXNob2xkO1xuICAgIHJldHVybiAkKHRoaXMpLmFzS2VmaXJTdHJlYW0oJ21vdXNlZG93bicpLmZsYXRNYXAoKGZ1bmN0aW9uKG1vdXNlRG93bkV2ZW50KSB7XG4gICAgICB2YXIgc3RyZWFtID0gJChkb2N1bWVudCkuYXNLZWZpclN0cmVhbSgnbW91c2Vtb3ZlJyk7XG4gICAgICBpZiAodGhyZXNob2xkKSB7XG4gICAgICAgIHZhciBjcm9zc2VkID0gZmFsc2U7XG4gICAgICAgIHN0cmVhbSA9IHN0cmVhbS5maWx0ZXIoKGZ1bmN0aW9uKG1vdXNlTW92ZUV2ZW50KSB7XG4gICAgICAgICAgaWYgKGNyb3NzZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgZHggPSBtb3VzZURvd25FdmVudC5wYWdlWCAtIG1vdXNlTW92ZUV2ZW50LnBhZ2VYO1xuICAgICAgICAgIHZhciBkeSA9IG1vdXNlRG93bkV2ZW50LnBhZ2VZIC0gbW91c2VNb3ZlRXZlbnQucGFnZVk7XG4gICAgICAgICAgaWYgKGR4ICogZHggKyBkeSAqIGR5ID4gdGhyZXNob2xkICogdGhyZXNob2xkKSB7XG4gICAgICAgICAgICByZXR1cm4gY3Jvc3NlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN0cmVhbS50YWtlVW50aWxCeSgkKGRvY3VtZW50KS5hc0tlZmlyU3RyZWFtKCdtb3VzZXVwJykpLm1hcCgoZnVuY3Rpb24obW91c2VNb3ZlRXZlbnQpIHtcbiAgICAgICAgcmV0dXJuICh7XG4gICAgICAgICAgbW91c2VEb3duRXZlbnQ6IG1vdXNlRG93bkV2ZW50LFxuICAgICAgICAgIG1vdXNlTW92ZUV2ZW50OiBtb3VzZU1vdmVFdmVudFxuICAgICAgICB9KTtcbiAgICAgIH0pKTtcbiAgICB9KSk7XG4gIH07XG4gICQuZm4ubW91c2VDbGljayA9IGZ1bmN0aW9uIG1vdXNlQ2xpY2soKSB7XG4gICAgdmFyIHRocmVzaG9sZCA9IChhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDoge30pLnRocmVzaG9sZDtcbiAgICByZXR1cm4gJCh0aGlzKS5hc0tlZmlyU3RyZWFtKCdtb3VzZWRvd24nKS5mbGF0TWFwKChmdW5jdGlvbihtb3VzZURvd25FdmVudCkge1xuICAgICAgdmFyIHVudGlsU3RyZWFtID0gJChkb2N1bWVudCkuYXNLZWZpclN0cmVhbSgnbW91c2Vtb3ZlJyk7XG4gICAgICBpZiAodGhyZXNob2xkKSB7XG4gICAgICAgIHZhciBjcm9zc2VkID0gZmFsc2U7XG4gICAgICAgIHVudGlsU3RyZWFtID0gdW50aWxTdHJlYW0uZmlsdGVyKChmdW5jdGlvbihtb3VzZU1vdmVFdmVudCkge1xuICAgICAgICAgIGlmIChjcm9zc2VkKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGR4ID0gbW91c2VEb3duRXZlbnQucGFnZVggLSBtb3VzZU1vdmVFdmVudC5wYWdlWDtcbiAgICAgICAgICB2YXIgZHkgPSBtb3VzZURvd25FdmVudC5wYWdlWSAtIG1vdXNlTW92ZUV2ZW50LnBhZ2VZO1xuICAgICAgICAgIGlmIChkeCAqIGR4ICsgZHkgKiBkeSA+IHRocmVzaG9sZCAqIHRocmVzaG9sZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNyb3NzZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAkKGRvY3VtZW50KS5hc0tlZmlyU3RyZWFtKCdtb3VzZXVwJykudGFrZSgxKS50YWtlVW50aWxCeSh1bnRpbFN0cmVhbSk7XG4gICAgfSkpO1xuICB9O1xuICAkLmZuLm1vdXNlV2hlZWwgPSBmdW5jdGlvbiBtb3VzZVdoZWVsKCkge1xuICAgIHJldHVybiAkKHRoaXMpLmFzS2VmaXJTdHJlYW0oJ21vdXNld2hlZWwgRE9NTW91c2VTY3JvbGwnKTtcbiAgfTtcbiAgcmV0dXJuIEtlZmlyO1xufSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3V0aWwva2VmaXItYW5kLWVnZ3MuanNcbiAqKiBtb2R1bGUgaWQgPSAyNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZGVmaW5lKFsnanF1ZXJ5JywgJy4vbWlzYy5qcyddLCBmdW5jdGlvbigkLCBVKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgZnVuY3Rpb24gZGVlcFRyYW5zZm9ybSh2YWwsIGZuKSB7XG4gICAgaWYgKCQuaXNQbGFpbk9iamVjdCh2YWwpIHx8ICQuaXNBcnJheSh2YWwpKSB7XG4gICAgICAkLmVhY2godmFsLCAoZnVuY3Rpb24oa2V5LCBzdWJWYWwpIHtcbiAgICAgICAgdmFyIHJldHVybmVkID0gZm4oc3ViVmFsKTtcbiAgICAgICAgaWYgKFUuaXNVbmRlZmluZWQocmV0dXJuZWQpKSB7XG4gICAgICAgICAgZGVlcFRyYW5zZm9ybShzdWJWYWwsIGZuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YWxba2V5XSA9IHJldHVybmVkO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgfVxuICB9XG4gIHZhciBSRUZfUEFUVEVSTiA9IC9gKFtcXFtcXC5dLis/KWAvZztcbiAgcmV0dXJuIGZ1bmN0aW9uIGRlZmF1bHRzKHNwZWMsIGNvbnRleHQpIHtcbiAgICBkZWVwVHJhbnNmb3JtKHNwZWMsIChmdW5jdGlvbih2YWwpIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgICAgICB2YXIgcmVmcyA9ICh2YWwubWF0Y2goUkVGX1BBVFRFUk4pIHx8IFtdKS5tYXAoKGZ1bmN0aW9uKHJlZikge1xuICAgICAgICAgIHZhciBzdHJpcHBlZFJlZiA9IHJlZi5zdWJzdHJpbmcoMSwgcmVmLmxlbmd0aCAtIDEpO1xuICAgICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oJ3JlZnMnLCAoXCJyZXR1cm4gcmVmc1wiICsgc3RyaXBwZWRSZWYpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB2YXIgZXhwciA9IHZhbC5yZXBsYWNlKFJFRl9QQVRURVJOLCBcIihyZWZzJDEpXCIpO1xuICAgICAgICB2YXIgdGVtcGxhdGVGbiA9IChmdW5jdGlvbihmb3JtYWxQYXJhbXMpIHtcbiAgICAgICAgICB2YXIgbmV3Rm9ybWFsUGFyYW1zID0gZm9ybWFsUGFyYW1zLmNvbmNhdChbKFwicmV0dXJuIFwiICsgZXhwcildKTtcbiAgICAgICAgICByZXR1cm4gVS5hcHBseUNvbnN0cnVjdG9yKEZ1bmN0aW9uLCBuZXdGb3JtYWxQYXJhbXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGVtcGxhdGVGbi5yZWZzID0gcmVmcztcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlRm47XG4gICAgICB9XG4gICAgfSkpO1xuICAgIGZ1bmN0aW9uIHdpdGhEZWZhdWx0c0F1eChkZWZTcGVjLCBvYmosIHJlZnMsIHBhcmFtcykge1xuICAgICAgdmFyIGNoYW5nZSA9IGZhbHNlO1xuICAgICAgT2JqZWN0LmtleXMoZGVmU3BlYykuZm9yRWFjaCgoZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIGlmIChrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgaWYgKCQuaXNQbGFpbk9iamVjdChkZWZTcGVjW2tleV0pICYmICQuaXNQbGFpbk9iamVjdChvYmpba2V5XSkpIHtcbiAgICAgICAgICAgIGNoYW5nZSA9IHdpdGhEZWZhdWx0c0F1eChkZWZTcGVjW2tleV0sIG9ialtrZXldLCByZWZzLCBwYXJhbXMpIHx8IGNoYW5nZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoJC5pc1BsYWluT2JqZWN0KGRlZlNwZWNba2V5XSkpIHtcbiAgICAgICAgICBvYmpba2V5XSA9IHt9O1xuICAgICAgICAgIGNoYW5nZSA9IHdpdGhEZWZhdWx0c0F1eChkZWZTcGVjW2tleV0sIG9ialtrZXldLCByZWZzLCBwYXJhbXMpIHx8IGNoYW5nZTtcbiAgICAgICAgfSBlbHNlIGlmICgkLmlzRnVuY3Rpb24oZGVmU3BlY1trZXldKSkge1xuICAgICAgICAgIGlmIChkZWZTcGVjW2tleV0ucmVmcy5ldmVyeSgoZnVuY3Rpb24ocmVmKSB7XG4gICAgICAgICAgICByZXR1cm4gIVUuaXNVbmRlZmluZWQocmVmKHJlZnMpKTtcbiAgICAgICAgICB9KSkpIHtcbiAgICAgICAgICAgIHZhciBhbGxwYXJhbXMgPSAkLmV4dGVuZCh7cmVmczogcmVmc30sIGNvbnRleHQsIHBhcmFtcyk7XG4gICAgICAgICAgICB2YXIgZm9ybWFsUGFyYW1zID0gT2JqZWN0LmtleXMoYWxscGFyYW1zKTtcbiAgICAgICAgICAgIHZhciBhY3R1YWxQYXJhbXMgPSBmb3JtYWxQYXJhbXMubWFwKChmdW5jdGlvbihmcGFyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBhbGxwYXJhbXNbZnBhcl07XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB2YXIgZmluYWxGbiA9IGRlZlNwZWNba2V5XShmb3JtYWxQYXJhbXMpO1xuICAgICAgICAgICAgb2JqW2tleV0gPSBmaW5hbEZuLmFwcGx5KG51bGwsIGFjdHVhbFBhcmFtcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgICByZXR1cm4gY2hhbmdlO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gd2l0aERlZmF1bHRzKG9iaiwgcGFyYW1zKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gKFUuaXNVbmRlZmluZWQob2JqKSA/IHt9IDogJC5leHRlbmQodHJ1ZSwge30sIG9iaikpO1xuICAgICAgdmFyIGNoYW5nZSA9IHRydWU7XG4gICAgICB3aGlsZSAoY2hhbmdlKSB7XG4gICAgICAgIGNoYW5nZSA9IHdpdGhEZWZhdWx0c0F1eChzcGVjLCByZXN1bHQsIHJlc3VsdCwgcGFyYW1zIHx8IHt9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy91dGlsL2RlZmF1bHRzLmpzXG4gKiogbW9kdWxlIGlkID0gMjdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbJ2pxdWVyeSddLCBmdW5jdGlvbigkKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgJC5mbi5leHRlbmQoe2FteVB1dENzc1J1bGVzOiBmdW5jdGlvbihydWxlcykge1xuICAgICAgdmFyICRfXzAgPSB0aGlzO1xuICAgICAgJC5lYWNoKHJ1bGVzLCAoZnVuY3Rpb24oc2VsZWN0b3IsIGNzcykge1xuICAgICAgICB2YXIgY29udGV4dDtcbiAgICAgICAgaWYgKHNlbGVjdG9yLnRyaW0oKSA9PT0gJyYnKSB7XG4gICAgICAgICAgY29udGV4dCA9ICRfXzA7XG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0b3IudHJpbSgpLmNoYXJBdCgwKSA9PT0gJyYnKSB7XG4gICAgICAgICAgY29udGV4dCA9ICRfXzAuZmluZChzZWxlY3Rvci50cmltKCkuc3Vic3RyKDEpLnRyaW0oKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29udGV4dCA9ICRfXzAuZmluZChzZWxlY3Rvcik7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5jc3MoY3NzKTtcbiAgICAgIH0pKTtcbiAgICB9fSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvdXRpbC9wdXQtY3NzLXJ1bGVzLmpzXG4gKiogbW9kdWxlIGlkID0gMjhcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvc3JjL3AtdGlsZS1za2luLnNjc3NcIik7XG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbi8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cbnZhciB1cGRhdGUgPSByZXF1aXJlKFwiIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIHt9KTtcbi8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcbmlmKG1vZHVsZS5ob3QpIHtcblx0Ly8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9zcmMvcC10aWxlLXNraW4uc2Nzc1wiLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9zcmMvcC10aWxlLXNraW4uc2Nzc1wiKTtcblx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdH0pO1xuXHQvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC10aWxlLXNraW4uc2Nzc1xuICoqIG1vZHVsZSBpZCA9IDI5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvY3NzVG9TdHJpbmcuanNcIikoKTtcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcIi5za2lubmVkLXRpbGV7ZGlzcGxheTotd2Via2l0LWJveDtkaXNwbGF5Oi13ZWJraXQtZmxleDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7LW1vei11c2VyLXNlbGVjdDpub25lOy1tcy11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmU7LXdlYmtpdC1ib3gtb3JpZW50OnZlcnRpY2FsOy13ZWJraXQtYm94LWRpcmVjdGlvbjpub3JtYWw7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpjb2x1bW47LW1zLWZsZXgtZGlyZWN0aW9uOmNvbHVtbjtmbGV4LWRpcmVjdGlvbjpjb2x1bW47fS5za2lubmVkLXRpbGU+aGVhZGVye2Rpc3BsYXk6LXdlYmtpdC1ib3g7ZGlzcGxheTotd2Via2l0LWZsZXg7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LXdlYmtpdC1ib3gtYWxpZ246Y2VudGVyOy13ZWJraXQtYWxpZ24taXRlbXM6Y2VudGVyOy1tcy1mbGV4LWFsaWduOmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7LXdlYmtpdC1ib3gtcGFjazpjZW50ZXI7LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOy1tcy1mbGV4LXBhY2s6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Zm9udC13ZWlnaHQ6Ym9sZDtib3JkZXItd2lkdGg6MXB4O292ZXJmbG93OmhpZGRlbjt9LnNraW5uZWQtdGlsZS5vcGVuPmhlYWRlcntoZWlnaHQ6MjZweDtib3JkZXItc3R5bGU6bm9uZSBub25lIHNvbGlkIG5vbmU7bGluZS1oZWlnaHQ6MjZweDtmb250LXNpemU6MTkuNXB4ICFpbXBvcnRhbnQ7d2hpdGUtc3BhY2U6bm93cmFwO30uc2tpbm5lZC10aWxlOm5vdCgub3Blbik+aGVhZGVyey13ZWJraXQtYm94LWZsZXg6MTstd2Via2l0LWZsZXgtZ3JvdzoxOy1tcy1mbGV4LXBvc2l0aXZlOjE7ZmxleC1ncm93OjE7cGFkZGluZzowIDVweDt9LnNraW5uZWQtdGlsZT5zZWN0aW9uey13ZWJraXQtdXNlci1zZWxlY3Q6dGV4dDstbW96LXVzZXItc2VsZWN0OnRleHQ7LW1zLXVzZXItc2VsZWN0OnRleHQ7dXNlci1zZWxlY3Q6dGV4dDt9LnNraW5uZWQtdGlsZS5vcGVuPnNlY3Rpb257LXdlYmtpdC1ib3gtZmxleDoxOy13ZWJraXQtZmxleC1ncm93OjE7LW1zLWZsZXgtcG9zaXRpdmU6MTtmbGV4LWdyb3c6MTtvcGFjaXR5OjE7fS5za2lubmVkLXRpbGU6bm90KC5vcGVuKT5zZWN0aW9ue29wYWNpdHk6MDt9XCIsIFwiXCJdKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9jc3MtbG9hZGVyIS4vfi9hdXRvcHJlZml4ZXItbG9hZGVyIS4vfi9zYXNzLWxvYWRlciEuL3NyYy9wLXRpbGUtc2tpbi5zY3NzXG4gKiogbW9kdWxlIGlkID0gMzBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZSh7XG4gIGJ1dHRvbjoge1xuICAgIExFRlQ6IDEsXG4gICAgTUlERExFOiAyLFxuICAgIFJJR0hUOiAzXG4gIH0sXG4gIGtleToge1xuICAgIEJBQ0tTUEFDRTogOCxcbiAgICBUQUI6IDksXG4gICAgRU5URVI6IDEzLFxuICAgIFNISUZUOiAxNixcbiAgICBDVFJMOiAxNyxcbiAgICBBTFQ6IDE4LFxuICAgIFBBVVNFOiAxOSxcbiAgICBDQVBTX0xPQ0s6IDIwLFxuICAgIEVTQ0FQRTogMjcsXG4gICAgU1BBQ0U6IDMyLFxuICAgIFBBR0VfVVA6IDMzLFxuICAgIFBBR0VfRE9XTjogMzQsXG4gICAgRU5EOiAzNSxcbiAgICBIT01FOiAzNixcbiAgICBMRUZUX0FSUk9XOiAzNyxcbiAgICBVUF9BUlJPVzogMzgsXG4gICAgUklHSFRfQVJST1c6IDM5LFxuICAgIERPV05fQVJST1c6IDQwLFxuICAgIElOU0VSVDogNDUsXG4gICAgREVMRVRFOiA0NixcbiAgICAwOiA0OCxcbiAgICAxOiA0OSxcbiAgICAyOiA1MCxcbiAgICAzOiA1MSxcbiAgICA0OiA1MixcbiAgICA1OiA1MyxcbiAgICA2OiA1NCxcbiAgICA3OiA1NSxcbiAgICA4OiA1NixcbiAgICA5OiA1NyxcbiAgICBBOiA2NSxcbiAgICBCOiA2NixcbiAgICBDOiA2NyxcbiAgICBEOiA2OCxcbiAgICBFOiA2OSxcbiAgICBGOiA3MCxcbiAgICBHOiA3MSxcbiAgICBIOiA3MixcbiAgICBJOiA3MyxcbiAgICBKOiA3NCxcbiAgICBLOiA3NSxcbiAgICBMOiA3NixcbiAgICBNOiA3NyxcbiAgICBOOiA3OCxcbiAgICBPOiA3OSxcbiAgICBQOiA4MCxcbiAgICBROiA4MSxcbiAgICBSOiA4MixcbiAgICBTOiA4MyxcbiAgICBUOiA4NCxcbiAgICBVOiA4NSxcbiAgICBWOiA4NixcbiAgICBXOiA4NyxcbiAgICBYOiA4OCxcbiAgICBZOiA4OSxcbiAgICBaOiA5MCxcbiAgICBMRUZUX01FVEE6IDkxLFxuICAgIFJJR0hUX01FVEE6IDkyLFxuICAgIFNFTEVDVDogOTMsXG4gICAgTlVNUEFEXzA6IDk2LFxuICAgIE5VTVBBRF8xOiA5NyxcbiAgICBOVU1QQURfMjogOTgsXG4gICAgTlVNUEFEXzM6IDk5LFxuICAgIE5VTVBBRF80OiAxMDAsXG4gICAgTlVNUEFEXzU6IDEwMSxcbiAgICBOVU1QQURfNjogMTAyLFxuICAgIE5VTVBBRF83OiAxMDMsXG4gICAgTlVNUEFEXzg6IDEwNCxcbiAgICBOVU1QQURfOTogMTA1LFxuICAgIE1VTFRJUExZOiAxMDYsXG4gICAgQUREOiAxMDcsXG4gICAgU1VCVFJBQ1Q6IDEwOSxcbiAgICBERUNJTUFMOiAxMTAsXG4gICAgRElWSURFOiAxMTEsXG4gICAgRjE6IDExMixcbiAgICBGMjogMTEzLFxuICAgIEYzOiAxMTQsXG4gICAgRjQ6IDExNSxcbiAgICBGNTogMTE2LFxuICAgIEY2OiAxMTcsXG4gICAgRjc6IDExOCxcbiAgICBGODogMTE5LFxuICAgIEY5OiAxMjAsXG4gICAgRjEwOiAxMjEsXG4gICAgRjExOiAxMjIsXG4gICAgRjEyOiAxMjMsXG4gICAgTlVNX0xPQ0s6IDE0NCxcbiAgICBTQ1JPTExfTE9DSzogMTQ1LFxuICAgIFNFTUlDT0xPTjogMTg2LFxuICAgIEVRVUFMUzogMTg3LFxuICAgIENPTU1BOiAxODgsXG4gICAgREFTSDogMTg5LFxuICAgIFBFUklPRDogMTkwLFxuICAgIEZPUldBUkRfU0xBU0g6IDE5MSxcbiAgICBHUkFWRV9BQ0NFTlQ6IDE5MixcbiAgICBPUEVOX0JSQUNLRVQ6IDIxOSxcbiAgICBCQUNLX1NMQVNIOiAyMjAsXG4gICAgQ0xPU0VfQlJBQ0tFVDogMjIxLFxuICAgIFNJTkdMRV9RVU9URTogMjIyXG4gIH1cbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy91dGlsL2NvZGVzLmpzXG4gKiogbW9kdWxlIGlkID0gMzFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvc3JjL3AtdGlsZS1za2luLWdyb3ctd2hlbi1vcGVuLnNjc3NcIik7XG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbi8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cbnZhciB1cGRhdGUgPSByZXF1aXJlKFwiIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIHt9KTtcbi8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcbmlmKG1vZHVsZS5ob3QpIHtcblx0Ly8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9zcmMvcC10aWxlLXNraW4tZ3Jvdy13aGVuLW9wZW4uc2Nzc1wiLCBmdW5jdGlvbigpIHtcblx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzIS9ob21lL21oZWx2ZW5zL1Byb2plY3RzL2FwaW5hdG9teS1jb3JlL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9pbmRleC5qcyEvaG9tZS9taGVsdmVucy9Qcm9qZWN0cy9hcGluYXRvbXktY29yZS9zcmMvcC10aWxlLXNraW4tZ3Jvdy13aGVuLW9wZW4uc2Nzc1wiKTtcblx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdH0pO1xuXHQvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcC10aWxlLXNraW4tZ3Jvdy13aGVuLW9wZW4uc2Nzc1xuICoqIG1vZHVsZSBpZCA9IDMyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiL2hvbWUvbWhlbHZlbnMvUHJvamVjdHMvYXBpbmF0b215LWNvcmUvbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvY3NzVG9TdHJpbmcuanNcIikoKTtcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcIi50aWxlbWFwIC50aWxlPnNlY3Rpb257b3BhY2l0eTowO3Zpc2liaWxpdHk6aGlkZGVuO31cIiwgXCJcIl0pO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2Nzcy1sb2FkZXIhLi9+L2F1dG9wcmVmaXhlci1sb2FkZXIhLi9+L3Nhc3MtbG9hZGVyIS4vc3JjL3AtdGlsZS1za2luLWdyb3ctd2hlbi1vcGVuLnNjc3NcbiAqKiBtb2R1bGUgaWQgPSAzM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLypcclxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxyXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuKi9cclxudmFyIHN0eWxlc0luRG9tID0ge30sXHJcblx0bWVtb2l6ZSA9IGZ1bmN0aW9uKGZuKSB7XHJcblx0XHR2YXIgbWVtbztcclxuXHRcdHJldHVybiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGlmICh0eXBlb2YgbWVtbyA9PT0gXCJ1bmRlZmluZWRcIikgbWVtbyA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdHJldHVybiBtZW1vO1xyXG5cdFx0fTtcclxuXHR9LFxyXG5cdGlzSUU5ID0gbWVtb2l6ZShmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiAvbXNpZSA5XFxiLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpO1xyXG5cdH0pLFxyXG5cdGdldEhlYWRFbGVtZW50ID0gbWVtb2l6ZShmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF07XHJcblx0fSksXHJcblx0c2luZ2xldG9uRWxlbWVudCA9IG51bGwsXHJcblx0c2luZ2xldG9uQ291bnRlciA9IDA7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxpc3QsIG9wdGlvbnMpIHtcclxuXHRpZih0eXBlb2YgREVCVUcgIT09IFwidW5kZWZpbmVkXCIgJiYgREVCVUcpIHtcclxuXHRcdGlmKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50XCIpO1xyXG5cdH1cclxuXHJcblx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcblx0Ly8gRm9yY2Ugc2luZ2xlLXRhZyBzb2x1dGlvbiBvbiBJRTksIHdoaWNoIGhhcyBhIGhhcmQgbGltaXQgb24gdGhlICMgb2YgPHN0eWxlPlxyXG5cdC8vIHRhZ3MgaXQgd2lsbCBhbGxvdyBvbiBhIHBhZ2VcclxuXHRpZiAodHlwZW9mIG9wdGlvbnMuc2luZ2xldG9uID09PSBcInVuZGVmaW5lZFwiKSBvcHRpb25zLnNpbmdsZXRvbiA9IGlzSUU5KCk7XHJcblxyXG5cdHZhciBzdHlsZXMgPSBsaXN0VG9TdHlsZXMobGlzdCk7XHJcblx0YWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKTtcclxuXHJcblx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZShuZXdMaXN0KSB7XHJcblx0XHR2YXIgbWF5UmVtb3ZlID0gW107XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xyXG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcclxuXHRcdFx0ZG9tU3R5bGUucmVmcy0tO1xyXG5cdFx0XHRtYXlSZW1vdmUucHVzaChkb21TdHlsZSk7XHJcblx0XHR9XHJcblx0XHRpZihuZXdMaXN0KSB7XHJcblx0XHRcdHZhciBuZXdTdHlsZXMgPSBsaXN0VG9TdHlsZXMobmV3TGlzdCk7XHJcblx0XHRcdGFkZFN0eWxlc1RvRG9tKG5ld1N0eWxlcywgb3B0aW9ucyk7XHJcblx0XHR9XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbWF5UmVtb3ZlLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBkb21TdHlsZSA9IG1heVJlbW92ZVtpXTtcclxuXHRcdFx0aWYoZG9tU3R5bGUucmVmcyA9PT0gMCkge1xyXG5cdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKylcclxuXHRcdFx0XHRcdGRvbVN0eWxlLnBhcnRzW2pdKCk7XHJcblx0XHRcdFx0ZGVsZXRlIHN0eWxlc0luRG9tW2RvbVN0eWxlLmlkXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFN0eWxlc1RvRG9tKHN0eWxlcywgb3B0aW9ucykge1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xyXG5cdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XHJcblx0XHRpZihkb21TdHlsZSkge1xyXG5cdFx0XHRkb21TdHlsZS5yZWZzKys7XHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdGRvbVN0eWxlLnBhcnRzW2pdKGl0ZW0ucGFydHNbal0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZvcig7IGogPCBpdGVtLnBhcnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0ZG9tU3R5bGUucGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHZhciBwYXJ0cyA9IFtdO1xyXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdHBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSwgb3B0aW9ucykpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHN0eWxlc0luRG9tW2l0ZW0uaWRdID0ge2lkOiBpdGVtLmlkLCByZWZzOiAxLCBwYXJ0czogcGFydHN9O1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gbGlzdFRvU3R5bGVzKGxpc3QpIHtcclxuXHR2YXIgc3R5bGVzID0gW107XHJcblx0dmFyIG5ld1N0eWxlcyA9IHt9O1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHR2YXIgaXRlbSA9IGxpc3RbaV07XHJcblx0XHR2YXIgaWQgPSBpdGVtWzBdO1xyXG5cdFx0dmFyIGNzcyA9IGl0ZW1bMV07XHJcblx0XHR2YXIgbWVkaWEgPSBpdGVtWzJdO1xyXG5cdFx0dmFyIHNvdXJjZU1hcCA9IGl0ZW1bM107XHJcblx0XHR2YXIgcGFydCA9IHtjc3M6IGNzcywgbWVkaWE6IG1lZGlhLCBzb3VyY2VNYXA6IHNvdXJjZU1hcH07XHJcblx0XHRpZighbmV3U3R5bGVzW2lkXSlcclxuXHRcdFx0c3R5bGVzLnB1c2gobmV3U3R5bGVzW2lkXSA9IHtpZDogaWQsIHBhcnRzOiBbcGFydF19KTtcclxuXHRcdGVsc2VcclxuXHRcdFx0bmV3U3R5bGVzW2lkXS5wYXJ0cy5wdXNoKHBhcnQpO1xyXG5cdH1cclxuXHRyZXR1cm4gc3R5bGVzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVTdHlsZUVsZW1lbnQoKSB7XHJcblx0dmFyIHN0eWxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcclxuXHR2YXIgaGVhZCA9IGdldEhlYWRFbGVtZW50KCk7XHJcblx0c3R5bGVFbGVtZW50LnR5cGUgPSBcInRleHQvY3NzXCI7XHJcblx0aGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdHJldHVybiBzdHlsZUVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFN0eWxlKG9iaiwgb3B0aW9ucykge1xyXG5cdHZhciBzdHlsZUVsZW1lbnQsIHVwZGF0ZSwgcmVtb3ZlO1xyXG5cclxuXHRpZiAob3B0aW9ucy5zaW5nbGV0b24pIHtcclxuXHRcdHZhciBzdHlsZUluZGV4ID0gc2luZ2xldG9uQ291bnRlcisrO1xyXG5cdFx0c3R5bGVFbGVtZW50ID0gc2luZ2xldG9uRWxlbWVudCB8fCAoc2luZ2xldG9uRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudCgpKTtcclxuXHRcdHVwZGF0ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIGZhbHNlKTtcclxuXHRcdHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIHRydWUpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQoKTtcclxuXHRcdHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQpO1xyXG5cdFx0cmVtb3ZlID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdHVwZGF0ZShvYmopO1xyXG5cclxuXHRyZXR1cm4gZnVuY3Rpb24gdXBkYXRlU3R5bGUobmV3T2JqKSB7XHJcblx0XHRpZihuZXdPYmopIHtcclxuXHRcdFx0aWYobmV3T2JqLmNzcyA9PT0gb2JqLmNzcyAmJiBuZXdPYmoubWVkaWEgPT09IG9iai5tZWRpYSAmJiBuZXdPYmouc291cmNlTWFwID09PSBvYmouc291cmNlTWFwKVxyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0dXBkYXRlKG9iaiA9IG5ld09iaik7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRyZW1vdmUoKTtcclxuXHRcdH1cclxuXHR9O1xyXG59XHJcblxyXG5mdW5jdGlvbiByZXBsYWNlVGV4dChzb3VyY2UsIGlkLCByZXBsYWNlbWVudCkge1xyXG5cdHZhciBib3VuZGFyaWVzID0gW1wiLyoqID4+XCIgKyBpZCArIFwiICoqL1wiLCBcIi8qKiBcIiArIGlkICsgXCI8PCAqKi9cIl07XHJcblx0dmFyIHN0YXJ0ID0gc291cmNlLmxhc3RJbmRleE9mKGJvdW5kYXJpZXNbMF0pO1xyXG5cdHZhciB3cmFwcGVkUmVwbGFjZW1lbnQgPSByZXBsYWNlbWVudFxyXG5cdFx0PyAoYm91bmRhcmllc1swXSArIHJlcGxhY2VtZW50ICsgYm91bmRhcmllc1sxXSlcclxuXHRcdDogXCJcIjtcclxuXHRpZiAoc291cmNlLmxhc3RJbmRleE9mKGJvdW5kYXJpZXNbMF0pID49IDApIHtcclxuXHRcdHZhciBlbmQgPSBzb3VyY2UubGFzdEluZGV4T2YoYm91bmRhcmllc1sxXSkgKyBib3VuZGFyaWVzWzFdLmxlbmd0aDtcclxuXHRcdHJldHVybiBzb3VyY2Uuc2xpY2UoMCwgc3RhcnQpICsgd3JhcHBlZFJlcGxhY2VtZW50ICsgc291cmNlLnNsaWNlKGVuZCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHJldHVybiBzb3VyY2UgKyB3cmFwcGVkUmVwbGFjZW1lbnQ7XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBhcHBseVRvU2luZ2xldG9uVGFnKHN0eWxlRWxlbWVudCwgaW5kZXgsIHJlbW92ZSwgb2JqKSB7XHJcblx0dmFyIGNzcyA9IHJlbW92ZSA/IFwiXCIgOiBvYmouY3NzO1xyXG5cclxuXHRpZihzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xyXG5cdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0LmNzc1RleHQsIGluZGV4LCBjc3MpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XHJcblx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlRWxlbWVudC5jaGlsZE5vZGVzO1xyXG5cdFx0aWYgKGNoaWxkTm9kZXNbaW5kZXhdKSBzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0aWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudC5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGNzc05vZGUpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gYXBwbHlUb1RhZyhzdHlsZUVsZW1lbnQsIG9iaikge1xyXG5cdHZhciBjc3MgPSBvYmouY3NzO1xyXG5cdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcclxuXHR2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcclxuXHJcblx0aWYoc291cmNlTWFwICYmIHR5cGVvZiBidG9hID09PSBcImZ1bmN0aW9uXCIpIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNzcyArPSBcIlxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsXCIgKyBidG9hKEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpICsgXCIgKi9cIjtcclxuXHRcdFx0Y3NzID0gXCJAaW1wb3J0IHVybChcXFwiZGF0YTp0ZXh0L2NzcztiYXNlNjQsXCIgKyBidG9hKGNzcykgKyBcIlxcXCIpXCI7XHJcblx0XHR9IGNhdGNoKGUpIHt9XHJcblx0fVxyXG5cclxuXHRpZihtZWRpYSkge1xyXG5cdFx0c3R5bGVFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1lZGlhXCIsIG1lZGlhKVxyXG5cdH1cclxuXHJcblx0aWYoc3R5bGVFbGVtZW50LnN0eWxlU2hlZXQpIHtcclxuXHRcdHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0LmNzc1RleHQgPSBjc3M7XHJcblx0fSBlbHNlIHtcclxuXHRcdHdoaWxlKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudC5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQuZmlyc3RDaGlsZCk7XHJcblx0XHR9XHJcblx0XHRzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XHJcblx0fVxyXG59XHJcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3N0eWxlLWxvYWRlci9hZGRTdHlsZXMuanNcbiAqKiBtb2R1bGUgaWQgPSAzNFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiIWZ1bmN0aW9uKGUpIHtcbiAgZnVuY3Rpb24gdChlKSB7XG4gICAgdmFyIHQgPSBlLmxlbmd0aCxcbiAgICAgICAgciA9ICQudHlwZShlKTtcbiAgICByZXR1cm4gXCJmdW5jdGlvblwiID09PSByIHx8ICQuaXNXaW5kb3coZSkgPyAhMSA6IDEgPT09IGUubm9kZVR5cGUgJiYgdCA/ICEwIDogXCJhcnJheVwiID09PSByIHx8IDAgPT09IHQgfHwgXCJudW1iZXJcIiA9PSB0eXBlb2YgdCAmJiB0ID4gMCAmJiB0IC0gMSBpbiBlO1xuICB9XG4gIGlmICghZS5qUXVlcnkpIHtcbiAgICB2YXIgJCA9IGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgIHJldHVybiBuZXcgJC5mbi5pbml0KGUsIHQpO1xuICAgIH07XG4gICAgJC5pc1dpbmRvdyA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHJldHVybiBudWxsICE9IGUgJiYgZSA9PSBlLndpbmRvdztcbiAgICB9LCAkLnR5cGUgPSBmdW5jdGlvbihlKSB7XG4gICAgICByZXR1cm4gbnVsbCA9PSBlID8gZSArIFwiXCIgOiBcIm9iamVjdFwiID09IHR5cGVvZiBlIHx8IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZSA/IGFbby5jYWxsKGUpXSB8fCBcIm9iamVjdFwiIDogdHlwZW9mIGU7XG4gICAgfSwgJC5pc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbihlKSB7XG4gICAgICByZXR1cm4gXCJhcnJheVwiID09PSAkLnR5cGUoZSk7XG4gICAgfSwgJC5pc1BsYWluT2JqZWN0ID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIHQ7XG4gICAgICBpZiAoIWUgfHwgXCJvYmplY3RcIiAhPT0gJC50eXBlKGUpIHx8IGUubm9kZVR5cGUgfHwgJC5pc1dpbmRvdyhlKSlcbiAgICAgICAgcmV0dXJuICExO1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKGUuY29uc3RydWN0b3IgJiYgIW4uY2FsbChlLCBcImNvbnN0cnVjdG9yXCIpICYmICFuLmNhbGwoZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsIFwiaXNQcm90b3R5cGVPZlwiKSlcbiAgICAgICAgICByZXR1cm4gITE7XG4gICAgICB9IGNhdGNoIChyKSB7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICAgIH1cbiAgICAgIGZvciAodCBpbiBlKVxuICAgICAgICA7XG4gICAgICByZXR1cm4gdm9pZCAwID09PSB0IHx8IG4uY2FsbChlLCB0KTtcbiAgICB9LCAkLmVhY2ggPSBmdW5jdGlvbihlLCByLCBhKSB7XG4gICAgICB2YXIgbixcbiAgICAgICAgICBvID0gMCxcbiAgICAgICAgICBpID0gZS5sZW5ndGgsXG4gICAgICAgICAgcyA9IHQoZSk7XG4gICAgICBpZiAoYSkge1xuICAgICAgICBpZiAocylcbiAgICAgICAgICBmb3IgKDsgaSA+IG8gJiYgKG4gPSByLmFwcGx5KGVbb10sIGEpLCBuICE9PSAhMSk7IG8rKylcbiAgICAgICAgICAgIDtcbiAgICAgICAgZWxzZVxuICAgICAgICAgIGZvciAobyBpbiBlKVxuICAgICAgICAgICAgaWYgKG4gPSByLmFwcGx5KGVbb10sIGEpLCBuID09PSAhMSlcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2UgaWYgKHMpXG4gICAgICAgIGZvciAoOyBpID4gbyAmJiAobiA9IHIuY2FsbChlW29dLCBvLCBlW29dKSwgbiAhPT0gITEpOyBvKyspXG4gICAgICAgICAgO1xuICAgICAgZWxzZVxuICAgICAgICBmb3IgKG8gaW4gZSlcbiAgICAgICAgICBpZiAobiA9IHIuY2FsbChlW29dLCBvLCBlW29dKSwgbiA9PT0gITEpXG4gICAgICAgICAgICBicmVhaztcbiAgICAgIHJldHVybiBlO1xuICAgIH0sICQuZGF0YSA9IGZ1bmN0aW9uKGUsIHQsIGEpIHtcbiAgICAgIGlmICh2b2lkIDAgPT09IGEpIHtcbiAgICAgICAgdmFyIG4gPSBlWyQuZXhwYW5kb10sXG4gICAgICAgICAgICBvID0gbiAmJiByW25dO1xuICAgICAgICBpZiAodm9pZCAwID09PSB0KVxuICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICBpZiAobyAmJiB0IGluIG8pXG4gICAgICAgICAgcmV0dXJuIG9bdF07XG4gICAgICB9IGVsc2UgaWYgKHZvaWQgMCAhPT0gdCkge1xuICAgICAgICB2YXIgbiA9IGVbJC5leHBhbmRvXSB8fCAoZVskLmV4cGFuZG9dID0gKyskLnV1aWQpO1xuICAgICAgICByZXR1cm4gcltuXSA9IHJbbl0gfHwge30sIHJbbl1bdF0gPSBhLCBhO1xuICAgICAgfVxuICAgIH0sICQucmVtb3ZlRGF0YSA9IGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgIHZhciBhID0gZVskLmV4cGFuZG9dLFxuICAgICAgICAgIG4gPSBhICYmIHJbYV07XG4gICAgICBuICYmICQuZWFjaCh0LCBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgIGRlbGV0ZSBuW3RdO1xuICAgICAgfSk7XG4gICAgfSwgJC5leHRlbmQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBlLFxuICAgICAgICAgIHQsXG4gICAgICAgICAgcixcbiAgICAgICAgICBhLFxuICAgICAgICAgIG4sXG4gICAgICAgICAgbyxcbiAgICAgICAgICBpID0gYXJndW1lbnRzWzBdIHx8IHt9LFxuICAgICAgICAgIHMgPSAxLFxuICAgICAgICAgIGwgPSBhcmd1bWVudHMubGVuZ3RoLFxuICAgICAgICAgIHUgPSAhMTtcbiAgICAgIGZvciAoXCJib29sZWFuXCIgPT0gdHlwZW9mIGkgJiYgKHUgPSBpLCBpID0gYXJndW1lbnRzW3NdIHx8IHt9LCBzKyspLCBcIm9iamVjdFwiICE9IHR5cGVvZiBpICYmIFwiZnVuY3Rpb25cIiAhPT0gJC50eXBlKGkpICYmIChpID0ge30pLCBzID09PSBsICYmIChpID0gdGhpcywgcy0tKTsgbCA+IHM7IHMrKylcbiAgICAgICAgaWYgKG51bGwgIT0gKG4gPSBhcmd1bWVudHNbc10pKVxuICAgICAgICAgIGZvciAoYSBpbiBuKVxuICAgICAgICAgICAgZSA9IGlbYV0sIHIgPSBuW2FdLCBpICE9PSByICYmICh1ICYmIHIgJiYgKCQuaXNQbGFpbk9iamVjdChyKSB8fCAodCA9ICQuaXNBcnJheShyKSkpID8gKHQgPyAodCA9ICExLCBvID0gZSAmJiAkLmlzQXJyYXkoZSkgPyBlIDogW10pIDogbyA9IGUgJiYgJC5pc1BsYWluT2JqZWN0KGUpID8gZSA6IHt9LCBpW2FdID0gJC5leHRlbmQodSwgbywgcikpIDogdm9pZCAwICE9PSByICYmIChpW2FdID0gcikpO1xuICAgICAgcmV0dXJuIGk7XG4gICAgfSwgJC5xdWV1ZSA9IGZ1bmN0aW9uKGUsIHIsIGEpIHtcbiAgICAgIGZ1bmN0aW9uIG4oZSwgcikge1xuICAgICAgICB2YXIgYSA9IHIgfHwgW107XG4gICAgICAgIHJldHVybiBudWxsICE9IGUgJiYgKHQoT2JqZWN0KGUpKSA/ICFmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgZm9yICh2YXIgciA9ICt0Lmxlbmd0aCxcbiAgICAgICAgICAgICAgYSA9IDAsXG4gICAgICAgICAgICAgIG4gPSBlLmxlbmd0aDsgciA+IGE7IClcbiAgICAgICAgICAgIGVbbisrXSA9IHRbYSsrXTtcbiAgICAgICAgICBpZiAociAhPT0gcilcbiAgICAgICAgICAgIGZvciAoOyB2b2lkIDAgIT09IHRbYV07IClcbiAgICAgICAgICAgICAgZVtuKytdID0gdFthKytdO1xuICAgICAgICAgIHJldHVybiBlLmxlbmd0aCA9IG4sIGU7XG4gICAgICAgIH0oYSwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSA/IFtlXSA6IGUpIDogW10ucHVzaC5jYWxsKGEsIGUpKSwgYTtcbiAgICAgIH1cbiAgICAgIGlmIChlKSB7XG4gICAgICAgIHIgPSAociB8fCBcImZ4XCIpICsgXCJxdWV1ZVwiO1xuICAgICAgICB2YXIgbyA9ICQuZGF0YShlLCByKTtcbiAgICAgICAgcmV0dXJuIGEgPyAoIW8gfHwgJC5pc0FycmF5KGEpID8gbyA9ICQuZGF0YShlLCByLCBuKGEpKSA6IG8ucHVzaChhKSwgbykgOiBvIHx8IFtdO1xuICAgICAgfVxuICAgIH0sICQuZGVxdWV1ZSA9IGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgICQuZWFjaChlLm5vZGVUeXBlID8gW2VdIDogZSwgZnVuY3Rpb24oZSwgcikge1xuICAgICAgICB0ID0gdCB8fCBcImZ4XCI7XG4gICAgICAgIHZhciBhID0gJC5xdWV1ZShyLCB0KSxcbiAgICAgICAgICAgIG4gPSBhLnNoaWZ0KCk7XG4gICAgICAgIFwiaW5wcm9ncmVzc1wiID09PSBuICYmIChuID0gYS5zaGlmdCgpKSwgbiAmJiAoXCJmeFwiID09PSB0ICYmIGEudW5zaGlmdChcImlucHJvZ3Jlc3NcIiksIG4uY2FsbChyLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkLmRlcXVldWUociwgdCk7XG4gICAgICAgIH0pKTtcbiAgICAgIH0pO1xuICAgIH0sICQuZm4gPSAkLnByb3RvdHlwZSA9IHtcbiAgICAgIGluaXQ6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGUubm9kZVR5cGUpXG4gICAgICAgICAgcmV0dXJuIHRoaXNbMF0gPSBlLCB0aGlzO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgYSBET00gbm9kZS5cIik7XG4gICAgICB9LFxuICAgICAgb2Zmc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCA/IHRoaXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiB7XG4gICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgIGxlZnQ6IDBcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0b3A6IHQudG9wICsgKGUucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuc2Nyb2xsVG9wIHx8IDApIC0gKGRvY3VtZW50LmNsaWVudFRvcCB8fCAwKSxcbiAgICAgICAgICBsZWZ0OiB0LmxlZnQgKyAoZS5wYWdlWE9mZnNldCB8fCBkb2N1bWVudC5zY3JvbGxMZWZ0IHx8IDApIC0gKGRvY3VtZW50LmNsaWVudExlZnQgfHwgMClcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICBwb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIGZ1bmN0aW9uIGUoKSB7XG4gICAgICAgICAgZm9yICh2YXIgZSA9IHRoaXMub2Zmc2V0UGFyZW50IHx8IGRvY3VtZW50OyBlICYmIFwiaHRtbFwiID09PSAhZS5ub2RlVHlwZS50b0xvd2VyQ2FzZSAmJiBcInN0YXRpY1wiID09PSBlLnN0eWxlLnBvc2l0aW9uOyApXG4gICAgICAgICAgICBlID0gZS5vZmZzZXRQYXJlbnQ7XG4gICAgICAgICAgcmV0dXJuIGUgfHwgZG9jdW1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHQgPSB0aGlzWzBdLFxuICAgICAgICAgICAgZSA9IGUuYXBwbHkodCksXG4gICAgICAgICAgICByID0gdGhpcy5vZmZzZXQoKSxcbiAgICAgICAgICAgIGEgPSAvXig/OmJvZHl8aHRtbCkkL2kudGVzdChlLm5vZGVOYW1lKSA/IHtcbiAgICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgICBsZWZ0OiAwXG4gICAgICAgICAgICB9IDogJChlKS5vZmZzZXQoKTtcbiAgICAgICAgcmV0dXJuIHIudG9wIC09IHBhcnNlRmxvYXQodC5zdHlsZS5tYXJnaW5Ub3ApIHx8IDAsIHIubGVmdCAtPSBwYXJzZUZsb2F0KHQuc3R5bGUubWFyZ2luTGVmdCkgfHwgMCwgZS5zdHlsZSAmJiAoYS50b3AgKz0gcGFyc2VGbG9hdChlLnN0eWxlLmJvcmRlclRvcFdpZHRoKSB8fCAwLCBhLmxlZnQgKz0gcGFyc2VGbG9hdChlLnN0eWxlLmJvcmRlckxlZnRXaWR0aCkgfHwgMCksIHtcbiAgICAgICAgICB0b3A6IHIudG9wIC0gYS50b3AsXG4gICAgICAgICAgbGVmdDogci5sZWZ0IC0gYS5sZWZ0XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgciA9IHt9O1xuICAgICQuZXhwYW5kbyA9IFwidmVsb2NpdHlcIiArIChuZXcgRGF0ZSkuZ2V0VGltZSgpLCAkLnV1aWQgPSAwO1xuICAgIGZvciAodmFyIGEgPSB7fSxcbiAgICAgICAgbiA9IGEuaGFzT3duUHJvcGVydHksXG4gICAgICAgIG8gPSBhLnRvU3RyaW5nLFxuICAgICAgICBpID0gXCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yXCIuc3BsaXQoXCIgXCIpLFxuICAgICAgICBzID0gMDsgcyA8IGkubGVuZ3RoOyBzKyspXG4gICAgICBhW1wiW29iamVjdCBcIiArIGlbc10gKyBcIl1cIl0gPSBpW3NdLnRvTG93ZXJDYXNlKCk7XG4gICAgJC5mbi5pbml0LnByb3RvdHlwZSA9ICQuZm4sIGUuVmVsb2NpdHkgPSB7VXRpbGl0aWVzOiAkfTtcbiAgfVxufSh3aW5kb3cpLCBmdW5jdGlvbihlKSB7XG4gIFwib2JqZWN0XCIgPT0gdHlwZW9mIG1vZHVsZSAmJiBcIm9iamVjdFwiID09IHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA/IG1vZHVsZS5leHBvcnRzID0gZSgpIDogXCJmdW5jdGlvblwiID09IHR5cGVvZiBkZWZpbmUgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShlKSA6IGUoKTtcbn0oZnVuY3Rpb24oKSB7XG4gIHJldHVybiBmdW5jdGlvbihlLCB0LCByLCBhKSB7XG4gICAgZnVuY3Rpb24gbihlKSB7XG4gICAgICBmb3IgKHZhciB0ID0gLTEsXG4gICAgICAgICAgciA9IGUgPyBlLmxlbmd0aCA6IDAsXG4gICAgICAgICAgYSA9IFtdOyArK3QgPCByOyApIHtcbiAgICAgICAgdmFyIG4gPSBlW3RdO1xuICAgICAgICBuICYmIGEucHVzaChuKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvKGUpIHtcbiAgICAgIHJldHVybiBnLmlzV3JhcHBlZChlKSA/IGUgPSBbXS5zbGljZS5jYWxsKGUpIDogZy5pc05vZGUoZSkgJiYgKGUgPSBbZV0pLCBlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpKGUpIHtcbiAgICAgIHZhciB0ID0gJC5kYXRhKGUsIFwidmVsb2NpdHlcIik7XG4gICAgICByZXR1cm4gbnVsbCA9PT0gdCA/IGEgOiB0O1xuICAgIH1cbiAgICBmdW5jdGlvbiBzKGUpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHQgKiBlKSAqICgxIC8gZSk7XG4gICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBsKGUsIHIsIGEsIG4pIHtcbiAgICAgIGZ1bmN0aW9uIG8oZSwgdCkge1xuICAgICAgICByZXR1cm4gMSAtIDMgKiB0ICsgMyAqIGU7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBpKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIDMgKiB0IC0gNiAqIGU7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBzKGUpIHtcbiAgICAgICAgcmV0dXJuIDMgKiBlO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gbChlLCB0LCByKSB7XG4gICAgICAgIHJldHVybiAoKG8odCwgcikgKiBlICsgaSh0LCByKSkgKiBlICsgcyh0KSkgKiBlO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gdShlLCB0LCByKSB7XG4gICAgICAgIHJldHVybiAzICogbyh0LCByKSAqIGUgKiBlICsgMiAqIGkodCwgcikgKiBlICsgcyh0KTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGModCwgcikge1xuICAgICAgICBmb3IgKHZhciBuID0gMDsgbSA+IG47ICsrbikge1xuICAgICAgICAgIHZhciBvID0gdShyLCBlLCBhKTtcbiAgICAgICAgICBpZiAoMCA9PT0gbylcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICAgIHZhciBpID0gbChyLCBlLCBhKSAtIHQ7XG4gICAgICAgICAgciAtPSBpIC8gbztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHAoKSB7XG4gICAgICAgIGZvciAodmFyIHQgPSAwOyBiID4gdDsgKyt0KVxuICAgICAgICAgIHdbdF0gPSBsKHQgKiB4LCBlLCBhKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGYodCwgciwgbikge1xuICAgICAgICB2YXIgbyxcbiAgICAgICAgICAgIGksXG4gICAgICAgICAgICBzID0gMDtcbiAgICAgICAgZG9cbiAgICAgICAgICBpID0gciArIChuIC0gcikgLyAyLCBvID0gbChpLCBlLCBhKSAtIHQsIG8gPiAwID8gbiA9IGkgOiByID0gaTtcbiB3aGlsZSAoTWF0aC5hYnMobykgPiBoICYmICsrcyA8IHYpO1xuICAgICAgICByZXR1cm4gaTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGQodCkge1xuICAgICAgICBmb3IgKHZhciByID0gMCxcbiAgICAgICAgICAgIG4gPSAxLFxuICAgICAgICAgICAgbyA9IGIgLSAxOyBuICE9IG8gJiYgd1tuXSA8PSB0OyArK24pXG4gICAgICAgICAgciArPSB4O1xuICAgICAgICAtLW47XG4gICAgICAgIHZhciBpID0gKHQgLSB3W25dKSAvICh3W24gKyAxXSAtIHdbbl0pLFxuICAgICAgICAgICAgcyA9IHIgKyBpICogeCxcbiAgICAgICAgICAgIGwgPSB1KHMsIGUsIGEpO1xuICAgICAgICByZXR1cm4gbCA+PSB5ID8gYyh0LCBzKSA6IDAgPT0gbCA/IHMgOiBmKHQsIHIsIHIgKyB4KTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGcoKSB7XG4gICAgICAgIFYgPSAhMCwgKGUgIT0gciB8fCBhICE9IG4pICYmIHAoKTtcbiAgICAgIH1cbiAgICAgIHZhciBtID0gNCxcbiAgICAgICAgICB5ID0gLjAwMSxcbiAgICAgICAgICBoID0gMWUtNyxcbiAgICAgICAgICB2ID0gMTAsXG4gICAgICAgICAgYiA9IDExLFxuICAgICAgICAgIHggPSAxIC8gKGIgLSAxKSxcbiAgICAgICAgICBTID0gXCJGbG9hdDMyQXJyYXlcIiBpbiB0O1xuICAgICAgaWYgKDQgIT09IGFyZ3VtZW50cy5sZW5ndGgpXG4gICAgICAgIHJldHVybiAhMTtcbiAgICAgIGZvciAodmFyIFAgPSAwOyA0ID4gUDsgKytQKVxuICAgICAgICBpZiAoXCJudW1iZXJcIiAhPSB0eXBlb2YgYXJndW1lbnRzW1BdIHx8IGlzTmFOKGFyZ3VtZW50c1tQXSkgfHwgIWlzRmluaXRlKGFyZ3VtZW50c1tQXSkpXG4gICAgICAgICAgcmV0dXJuICExO1xuICAgICAgZSA9IE1hdGgubWluKGUsIDEpLCBhID0gTWF0aC5taW4oYSwgMSksIGUgPSBNYXRoLm1heChlLCAwKSwgYSA9IE1hdGgubWF4KGEsIDApO1xuICAgICAgdmFyIHcgPSBTID8gbmV3IEZsb2F0MzJBcnJheShiKSA6IG5ldyBBcnJheShiKSxcbiAgICAgICAgICBWID0gITEsXG4gICAgICAgICAgQyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBWIHx8IGcoKSwgZSA9PT0gciAmJiBhID09PSBuID8gdCA6IDAgPT09IHQgPyAwIDogMSA9PT0gdCA/IDEgOiBsKGQodCksIHIsIG4pO1xuICAgICAgICAgIH07XG4gICAgICBDLmdldENvbnRyb2xQb2ludHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFt7XG4gICAgICAgICAgeDogZSxcbiAgICAgICAgICB5OiByXG4gICAgICAgIH0sIHtcbiAgICAgICAgICB4OiBhLFxuICAgICAgICAgIHk6IG5cbiAgICAgICAgfV07XG4gICAgICB9O1xuICAgICAgdmFyIFQgPSBcImdlbmVyYXRlQmV6aWVyKFwiICsgW2UsIHIsIGEsIG5dICsgXCIpXCI7XG4gICAgICByZXR1cm4gQy50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVDtcbiAgICAgIH0sIEM7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHUoZSwgdCkge1xuICAgICAgdmFyIHIgPSBlO1xuICAgICAgcmV0dXJuIGcuaXNTdHJpbmcoZSkgPyB2LkVhc2luZ3NbZV0gfHwgKHIgPSAhMSkgOiByID0gZy5pc0FycmF5KGUpICYmIDEgPT09IGUubGVuZ3RoID8gcy5hcHBseShudWxsLCBlKSA6IGcuaXNBcnJheShlKSAmJiAyID09PSBlLmxlbmd0aCA/IGIuYXBwbHkobnVsbCwgZS5jb25jYXQoW3RdKSkgOiBnLmlzQXJyYXkoZSkgJiYgNCA9PT0gZS5sZW5ndGggPyBsLmFwcGx5KG51bGwsIGUpIDogITEsIHIgPT09ICExICYmIChyID0gdi5FYXNpbmdzW3YuZGVmYXVsdHMuZWFzaW5nXSA/IHYuZGVmYXVsdHMuZWFzaW5nIDogaCksIHI7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGMoZSkge1xuICAgICAgaWYgKGUpIHtcbiAgICAgICAgdmFyIHQgPSAobmV3IERhdGUpLmdldFRpbWUoKSxcbiAgICAgICAgICAgIHIgPSB2LlN0YXRlLmNhbGxzLmxlbmd0aDtcbiAgICAgICAgciA+IDFlNCAmJiAodi5TdGF0ZS5jYWxscyA9IG4odi5TdGF0ZS5jYWxscykpO1xuICAgICAgICBmb3IgKHZhciBvID0gMDsgciA+IG87IG8rKylcbiAgICAgICAgICBpZiAodi5TdGF0ZS5jYWxsc1tvXSkge1xuICAgICAgICAgICAgdmFyIHMgPSB2LlN0YXRlLmNhbGxzW29dLFxuICAgICAgICAgICAgICAgIGwgPSBzWzBdLFxuICAgICAgICAgICAgICAgIHUgPSBzWzJdLFxuICAgICAgICAgICAgICAgIGYgPSBzWzNdLFxuICAgICAgICAgICAgICAgIGQgPSAhIWYsXG4gICAgICAgICAgICAgICAgbSA9IG51bGw7XG4gICAgICAgICAgICBmIHx8IChmID0gdi5TdGF0ZS5jYWxsc1tvXVszXSA9IHQgLSAxNik7XG4gICAgICAgICAgICBmb3IgKHZhciB5ID0gTWF0aC5taW4oKHQgLSBmKSAvIHUuZHVyYXRpb24sIDEpLFxuICAgICAgICAgICAgICAgIGggPSAwLFxuICAgICAgICAgICAgICAgIGIgPSBsLmxlbmd0aDsgYiA+IGg7IGgrKykge1xuICAgICAgICAgICAgICB2YXIgUyA9IGxbaF0sXG4gICAgICAgICAgICAgICAgICB3ID0gUy5lbGVtZW50O1xuICAgICAgICAgICAgICBpZiAoaSh3KSkge1xuICAgICAgICAgICAgICAgIHZhciBWID0gITE7XG4gICAgICAgICAgICAgICAgaWYgKHUuZGlzcGxheSAhPT0gYSAmJiBudWxsICE9PSB1LmRpc3BsYXkgJiYgXCJub25lXCIgIT09IHUuZGlzcGxheSkge1xuICAgICAgICAgICAgICAgICAgaWYgKFwiZmxleFwiID09PSB1LmRpc3BsYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIEMgPSBbXCItd2Via2l0LWJveFwiLCBcIi1tb3otYm94XCIsIFwiLW1zLWZsZXhib3hcIiwgXCItd2Via2l0LWZsZXhcIl07XG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChDLCBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgeC5zZXRQcm9wZXJ0eVZhbHVlKHcsIFwiZGlzcGxheVwiLCB0KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB4LnNldFByb3BlcnR5VmFsdWUodywgXCJkaXNwbGF5XCIsIHUuZGlzcGxheSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHUudmlzaWJpbGl0eSAhPT0gYSAmJiBcImhpZGRlblwiICE9PSB1LnZpc2liaWxpdHkgJiYgeC5zZXRQcm9wZXJ0eVZhbHVlKHcsIFwidmlzaWJpbGl0eVwiLCB1LnZpc2liaWxpdHkpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIFQgaW4gUylcbiAgICAgICAgICAgICAgICAgIGlmIChcImVsZW1lbnRcIiAhPT0gVCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgayA9IFNbVF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBBLFxuICAgICAgICAgICAgICAgICAgICAgICAgRiA9IGcuaXNTdHJpbmcoay5lYXNpbmcpID8gdi5FYXNpbmdzW2suZWFzaW5nXSA6IGsuZWFzaW5nO1xuICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PT0geSlcbiAgICAgICAgICAgICAgICAgICAgICBBID0gay5lbmRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIEUgPSBrLmVuZFZhbHVlIC0gay5zdGFydFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChBID0gay5zdGFydFZhbHVlICsgRSAqIEYoeSwgdSwgRSksICFkICYmIEEgPT09IGsuY3VycmVudFZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGsuY3VycmVudFZhbHVlID0gQSwgXCJ0d2VlblwiID09PSBUKVxuICAgICAgICAgICAgICAgICAgICAgIG0gPSBBO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoeC5Ib29rcy5yZWdpc3RlcmVkW1RdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IHguSG9va3MuZ2V0Um9vdChUKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIID0gaSh3KS5yb290UHJvcGVydHlWYWx1ZUNhY2hlW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgSCAmJiAoay5yb290UHJvcGVydHlWYWx1ZSA9IEgpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB2YXIgTiA9IHguc2V0UHJvcGVydHlWYWx1ZSh3LCBULCBrLmN1cnJlbnRWYWx1ZSArICgwID09PSBwYXJzZUZsb2F0KEEpID8gXCJcIiA6IGsudW5pdFR5cGUpLCBrLnJvb3RQcm9wZXJ0eVZhbHVlLCBrLnNjcm9sbERhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgIHguSG9va3MucmVnaXN0ZXJlZFtUXSAmJiAoaSh3KS5yb290UHJvcGVydHlWYWx1ZUNhY2hlW2pdID0geC5Ob3JtYWxpemF0aW9ucy5yZWdpc3RlcmVkW2pdID8geC5Ob3JtYWxpemF0aW9ucy5yZWdpc3RlcmVkW2pdKFwiZXh0cmFjdFwiLCBudWxsLCBOWzFdKSA6IE5bMV0pLCBcInRyYW5zZm9ybVwiID09PSBOWzBdICYmIChWID0gITApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdS5tb2JpbGVIQSAmJiBpKHcpLnRyYW5zZm9ybUNhY2hlLnRyYW5zbGF0ZTNkID09PSBhICYmIChpKHcpLnRyYW5zZm9ybUNhY2hlLnRyYW5zbGF0ZTNkID0gXCIoMHB4LCAwcHgsIDBweClcIiwgViA9ICEwKSwgViAmJiB4LmZsdXNoVHJhbnNmb3JtQ2FjaGUodyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHUuZGlzcGxheSAhPT0gYSAmJiBcIm5vbmVcIiAhPT0gdS5kaXNwbGF5ICYmICh2LlN0YXRlLmNhbGxzW29dWzJdLmRpc3BsYXkgPSAhMSksIHUudmlzaWJpbGl0eSAhPT0gYSAmJiBcImhpZGRlblwiICE9PSB1LnZpc2liaWxpdHkgJiYgKHYuU3RhdGUuY2FsbHNbb11bMl0udmlzaWJpbGl0eSA9ICExKSwgdS5wcm9ncmVzcyAmJiB1LnByb2dyZXNzLmNhbGwoc1sxXSwgc1sxXSwgeSwgTWF0aC5tYXgoMCwgZiArIHUuZHVyYXRpb24gLSB0KSwgZiwgbSksIDEgPT09IHkgJiYgcChvKTtcbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgICB2LlN0YXRlLmlzVGlja2luZyAmJiBQKGMpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBwKGUsIHQpIHtcbiAgICAgIGlmICghdi5TdGF0ZS5jYWxsc1tlXSlcbiAgICAgICAgcmV0dXJuICExO1xuICAgICAgdmFyIHAsXG4gICAgICAgICAgZixcbiAgICAgICAgICAkX18wID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBwID0gclt1XS5lbGVtZW50O1xuICAgICAgICAgICAgaWYgKHQgfHwgby5sb29wIHx8IChcIm5vbmVcIiA9PT0gby5kaXNwbGF5ICYmIHguc2V0UHJvcGVydHlWYWx1ZShwLCBcImRpc3BsYXlcIiwgby5kaXNwbGF5KSwgXCJoaWRkZW5cIiA9PT0gby52aXNpYmlsaXR5ICYmIHguc2V0UHJvcGVydHlWYWx1ZShwLCBcInZpc2liaWxpdHlcIiwgby52aXNpYmlsaXR5KSksIG8ubG9vcCAhPT0gITAgJiYgKCQucXVldWUocClbMV0gPT09IGEgfHwgIS9cXC52ZWxvY2l0eVF1ZXVlRW50cnlGbGFnL2kudGVzdCgkLnF1ZXVlKHApWzFdKSkgJiYgaShwKSkge1xuICAgICAgICAgICAgICBpKHApLmlzQW5pbWF0aW5nID0gITEsIGkocCkucm9vdFByb3BlcnR5VmFsdWVDYWNoZSA9IHt9O1xuICAgICAgICAgICAgICBmID0gITE7XG4gICAgICAgICAgICAgICQuZWFjaCh4Lkxpc3RzLnRyYW5zZm9ybXMzRCwgZnVuY3Rpb24oZSwgdCkge1xuICAgICAgICAgICAgICAgIHZhciByID0gL15zY2FsZS8udGVzdCh0KSA/IDEgOiAwLFxuICAgICAgICAgICAgICAgICAgICBuID0gaShwKS50cmFuc2Zvcm1DYWNoZVt0XTtcbiAgICAgICAgICAgICAgICBpKHApLnRyYW5zZm9ybUNhY2hlW3RdICE9PSBhICYmIG5ldyBSZWdFeHAoXCJeXFxcXChcIiArIHIgKyBcIlteLl1cIikudGVzdChuKSAmJiAoZiA9ICEwLCBkZWxldGUgaShwKS50cmFuc2Zvcm1DYWNoZVt0XSk7XG4gICAgICAgICAgICAgIH0pLCBvLm1vYmlsZUhBICYmIChmID0gITAsIGRlbGV0ZSBpKHApLnRyYW5zZm9ybUNhY2hlLnRyYW5zbGF0ZTNkKSwgZiAmJiB4LmZsdXNoVHJhbnNmb3JtQ2FjaGUocCksIHguVmFsdWVzLnJlbW92ZUNsYXNzKHAsIFwidmVsb2NpdHktYW5pbWF0aW5nXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0ICYmIG8uY29tcGxldGUgJiYgIW8ubG9vcCAmJiB1ID09PSBjIC0gMSlcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBvLmNvbXBsZXRlLmNhbGwobiwgbik7XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGQpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgdGhyb3cgZDtcbiAgICAgICAgICAgICAgICB9LCAxKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgcyAmJiBvLmxvb3AgIT09ICEwICYmIHMobiksIGkocCkgJiYgby5sb29wID09PSAhMCAmJiAhdCAmJiAoJC5lYWNoKGkocCkudHdlZW5zQ29udGFpbmVyLCBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgICAgIC9ecm90YXRlLy50ZXN0KGUpICYmIDM2MCA9PT0gcGFyc2VGbG9hdCh0LmVuZFZhbHVlKSAmJiAodC5lbmRWYWx1ZSA9IDAsIHQuc3RhcnRWYWx1ZSA9IDM2MCksIC9eYmFja2dyb3VuZFBvc2l0aW9uLy50ZXN0KGUpICYmIDEwMCA9PT0gcGFyc2VGbG9hdCh0LmVuZFZhbHVlKSAmJiBcIiVcIiA9PT0gdC51bml0VHlwZSAmJiAodC5lbmRWYWx1ZSA9IDAsIHQuc3RhcnRWYWx1ZSA9IDEwMCk7XG4gICAgICAgICAgICB9KSwgdihwLCBcInJldmVyc2VcIiwge1xuICAgICAgICAgICAgICBsb29wOiAhMCxcbiAgICAgICAgICAgICAgZGVsYXk6IG8uZGVsYXlcbiAgICAgICAgICAgIH0pKSwgby5xdWV1ZSAhPT0gITEgJiYgJC5kZXF1ZXVlKHAsIG8ucXVldWUpO1xuICAgICAgICAgIH07XG4gICAgICBmb3IgKHZhciByID0gdi5TdGF0ZS5jYWxsc1tlXVswXSxcbiAgICAgICAgICBuID0gdi5TdGF0ZS5jYWxsc1tlXVsxXSxcbiAgICAgICAgICBvID0gdi5TdGF0ZS5jYWxsc1tlXVsyXSxcbiAgICAgICAgICBzID0gdi5TdGF0ZS5jYWxsc1tlXVs0XSxcbiAgICAgICAgICBsID0gITEsXG4gICAgICAgICAgdSA9IDAsXG4gICAgICAgICAgYyA9IHIubGVuZ3RoOyBjID4gdTsgdSsrKSB7XG4gICAgICAgICRfXzAoKTtcbiAgICAgIH1cbiAgICAgIHYuU3RhdGUuY2FsbHNbZV0gPSAhMTtcbiAgICAgIGZvciAodmFyIGcgPSAwLFxuICAgICAgICAgIG0gPSB2LlN0YXRlLmNhbGxzLmxlbmd0aDsgbSA+IGc7IGcrKylcbiAgICAgICAgaWYgKHYuU3RhdGUuY2FsbHNbZ10gIT09ICExKSB7XG4gICAgICAgICAgbCA9ICEwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICBsID09PSAhMSAmJiAodi5TdGF0ZS5pc1RpY2tpbmcgPSAhMSwgZGVsZXRlIHYuU3RhdGUuY2FsbHMsIHYuU3RhdGUuY2FsbHMgPSBbXSk7XG4gICAgfVxuICAgIHZhciBmID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoci5kb2N1bWVudE1vZGUpXG4gICAgICAgIHJldHVybiByLmRvY3VtZW50TW9kZTtcbiAgICAgIGZvciAodmFyIGUgPSA3OyBlID4gNDsgZS0tKSB7XG4gICAgICAgIHZhciB0ID0gci5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBpZiAodC5pbm5lckhUTUwgPSBcIjwhLS1baWYgSUUgXCIgKyBlICsgXCJdPjxzcGFuPjwvc3Bhbj48IVtlbmRpZl0tLT5cIiwgdC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNwYW5cIikubGVuZ3RoKVxuICAgICAgICAgIHJldHVybiB0ID0gbnVsbCwgZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhO1xuICAgIH0oKSxcbiAgICAgICAgZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBlID0gMDtcbiAgICAgICAgICByZXR1cm4gdC53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgdC5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdmFyIHIgPSAobmV3IERhdGUpLmdldFRpbWUoKSxcbiAgICAgICAgICAgICAgICBhO1xuICAgICAgICAgICAgcmV0dXJuIGEgPSBNYXRoLm1heCgwLCAxNiAtIChyIC0gZSkpLCBlID0gciArIGEsIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHQociArIGEpO1xuICAgICAgICAgICAgfSwgYSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSgpLFxuICAgICAgICBnID0ge1xuICAgICAgICAgIGlzU3RyaW5nOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgZTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGlzQXJyYXk6IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgcmV0dXJuIFwiW29iamVjdCBBcnJheV1cIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaXNGdW5jdGlvbjogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgcmV0dXJuIFwiW29iamVjdCBGdW5jdGlvbl1cIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaXNOb2RlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICByZXR1cm4gZSAmJiBlLm5vZGVUeXBlO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaXNOb2RlTGlzdDogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgcmV0dXJuIFwib2JqZWN0XCIgPT0gdHlwZW9mIGUgJiYgL15cXFtvYmplY3QgKEhUTUxDb2xsZWN0aW9ufE5vZGVMaXN0fE9iamVjdClcXF0kLy50ZXN0KE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKSkgJiYgZS5sZW5ndGggIT09IGEgJiYgKDAgPT09IGUubGVuZ3RoIHx8IFwib2JqZWN0XCIgPT0gdHlwZW9mIGVbMF0gJiYgZVswXS5ub2RlVHlwZSA+IDApO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaXNXcmFwcGVkOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICByZXR1cm4gZSAmJiAoZS5qcXVlcnkgfHwgdC5aZXB0byAmJiB0LlplcHRvLnplcHRvLmlzWihlKSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBpc1NWRzogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgcmV0dXJuIHQuU1ZHRWxlbWVudCAmJiBlIGluc3RhbmNlb2YgdC5TVkdFbGVtZW50O1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaXNFbXB0eU9iamVjdDogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgZm9yICh2YXIgdCBpbiBlKVxuICAgICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgICAgICByZXR1cm4gITA7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAkLFxuICAgICAgICBtID0gITE7XG4gICAgaWYgKGUuZm4gJiYgZS5mbi5qcXVlcnkgPyAoJCA9IGUsIG0gPSAhMCkgOiAkID0gdC5WZWxvY2l0eS5VdGlsaXRpZXMsIDggPj0gZiAmJiAhbSlcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlZlbG9jaXR5OiBJRTggYW5kIGJlbG93IHJlcXVpcmUgalF1ZXJ5IHRvIGJlIGxvYWRlZCBiZWZvcmUgVmVsb2NpdHkuXCIpO1xuICAgIGlmICg3ID49IGYpXG4gICAgICByZXR1cm4gdm9pZChqUXVlcnkuZm4udmVsb2NpdHkgPSBqUXVlcnkuZm4uYW5pbWF0ZSk7XG4gICAgdmFyIHkgPSA0MDAsXG4gICAgICAgIGggPSBcInN3aW5nXCIsXG4gICAgICAgIHYgPSB7XG4gICAgICAgICAgU3RhdGU6IHtcbiAgICAgICAgICAgIGlzTW9iaWxlOiAvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksXG4gICAgICAgICAgICBpc0FuZHJvaWQ6IC9BbmRyb2lkL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSxcbiAgICAgICAgICAgIGlzR2luZ2VyYnJlYWQ6IC9BbmRyb2lkIDJcXC4zXFwuWzMtN10vaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLFxuICAgICAgICAgICAgaXNDaHJvbWU6IHQuY2hyb21lLFxuICAgICAgICAgICAgaXNGaXJlZm94OiAvRmlyZWZveC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksXG4gICAgICAgICAgICBwcmVmaXhFbGVtZW50OiByLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG4gICAgICAgICAgICBwcmVmaXhNYXRjaGVzOiB7fSxcbiAgICAgICAgICAgIHNjcm9sbEFuY2hvcjogbnVsbCxcbiAgICAgICAgICAgIHNjcm9sbFByb3BlcnR5TGVmdDogbnVsbCxcbiAgICAgICAgICAgIHNjcm9sbFByb3BlcnR5VG9wOiBudWxsLFxuICAgICAgICAgICAgaXNUaWNraW5nOiAhMSxcbiAgICAgICAgICAgIGNhbGxzOiBbXVxuICAgICAgICAgIH0sXG4gICAgICAgICAgQ1NTOiB7fSxcbiAgICAgICAgICBVdGlsaXRpZXM6ICQsXG4gICAgICAgICAgUmVkaXJlY3RzOiB7fSxcbiAgICAgICAgICBFYXNpbmdzOiB7fSxcbiAgICAgICAgICBQcm9taXNlOiB0LlByb21pc2UsXG4gICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIHF1ZXVlOiBcIlwiLFxuICAgICAgICAgICAgZHVyYXRpb246IHksXG4gICAgICAgICAgICBlYXNpbmc6IGgsXG4gICAgICAgICAgICBiZWdpbjogYSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBhLFxuICAgICAgICAgICAgcHJvZ3Jlc3M6IGEsXG4gICAgICAgICAgICBkaXNwbGF5OiBhLFxuICAgICAgICAgICAgdmlzaWJpbGl0eTogYSxcbiAgICAgICAgICAgIGxvb3A6ICExLFxuICAgICAgICAgICAgZGVsYXk6ICExLFxuICAgICAgICAgICAgbW9iaWxlSEE6ICEwLFxuICAgICAgICAgICAgX2NhY2hlVmFsdWVzOiAhMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgaW5pdDogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgJC5kYXRhKGUsIFwidmVsb2NpdHlcIiwge1xuICAgICAgICAgICAgICBpc1NWRzogZy5pc1NWRyhlKSxcbiAgICAgICAgICAgICAgaXNBbmltYXRpbmc6ICExLFxuICAgICAgICAgICAgICBjb21wdXRlZFN0eWxlOiBudWxsLFxuICAgICAgICAgICAgICB0d2VlbnNDb250YWluZXI6IG51bGwsXG4gICAgICAgICAgICAgIHJvb3RQcm9wZXJ0eVZhbHVlQ2FjaGU6IHt9LFxuICAgICAgICAgICAgICB0cmFuc2Zvcm1DYWNoZToge31cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaG9vazogbnVsbCxcbiAgICAgICAgICBtb2NrOiAhMSxcbiAgICAgICAgICB2ZXJzaW9uOiB7XG4gICAgICAgICAgICBtYWpvcjogMSxcbiAgICAgICAgICAgIG1pbm9yOiAyLFxuICAgICAgICAgICAgcGF0Y2g6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRlYnVnOiAhMVxuICAgICAgICB9O1xuICAgIHQucGFnZVlPZmZzZXQgIT09IGEgPyAodi5TdGF0ZS5zY3JvbGxBbmNob3IgPSB0LCB2LlN0YXRlLnNjcm9sbFByb3BlcnR5TGVmdCA9IFwicGFnZVhPZmZzZXRcIiwgdi5TdGF0ZS5zY3JvbGxQcm9wZXJ0eVRvcCA9IFwicGFnZVlPZmZzZXRcIikgOiAodi5TdGF0ZS5zY3JvbGxBbmNob3IgPSByLmRvY3VtZW50RWxlbWVudCB8fCByLmJvZHkucGFyZW50Tm9kZSB8fCByLmJvZHksIHYuU3RhdGUuc2Nyb2xsUHJvcGVydHlMZWZ0ID0gXCJzY3JvbGxMZWZ0XCIsIHYuU3RhdGUuc2Nyb2xsUHJvcGVydHlUb3AgPSBcInNjcm9sbFRvcFwiKTtcbiAgICB2YXIgYiA9IGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gZShlKSB7XG4gICAgICAgIHJldHVybiAtZS50ZW5zaW9uICogZS54IC0gZS5mcmljdGlvbiAqIGUudjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHQodCwgciwgYSkge1xuICAgICAgICB2YXIgbiA9IHtcbiAgICAgICAgICB4OiB0LnggKyBhLmR4ICogcixcbiAgICAgICAgICB2OiB0LnYgKyBhLmR2ICogcixcbiAgICAgICAgICB0ZW5zaW9uOiB0LnRlbnNpb24sXG4gICAgICAgICAgZnJpY3Rpb246IHQuZnJpY3Rpb25cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkeDogbi52LFxuICAgICAgICAgIGR2OiBlKG4pXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiByKHIsIGEpIHtcbiAgICAgICAgdmFyIG4gPSB7XG4gICAgICAgICAgZHg6IHIudixcbiAgICAgICAgICBkdjogZShyKVxuICAgICAgICB9LFxuICAgICAgICAgICAgbyA9IHQociwgLjUgKiBhLCBuKSxcbiAgICAgICAgICAgIGkgPSB0KHIsIC41ICogYSwgbyksXG4gICAgICAgICAgICBzID0gdChyLCBhLCBpKSxcbiAgICAgICAgICAgIGwgPSAxIC8gNiAqIChuLmR4ICsgMiAqIChvLmR4ICsgaS5keCkgKyBzLmR4KSxcbiAgICAgICAgICAgIHUgPSAxIC8gNiAqIChuLmR2ICsgMiAqIChvLmR2ICsgaS5kdikgKyBzLmR2KTtcbiAgICAgICAgcmV0dXJuIHIueCA9IHIueCArIGwgKiBhLCByLnYgPSByLnYgKyB1ICogYSwgcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jdGlvbiBhKGUsIHQsIG4pIHtcbiAgICAgICAgdmFyIG8gPSB7XG4gICAgICAgICAgeDogLTEsXG4gICAgICAgICAgdjogMCxcbiAgICAgICAgICB0ZW5zaW9uOiBudWxsLFxuICAgICAgICAgIGZyaWN0aW9uOiBudWxsXG4gICAgICAgIH0sXG4gICAgICAgICAgICBpID0gWzBdLFxuICAgICAgICAgICAgcyA9IDAsXG4gICAgICAgICAgICBsID0gMWUtNCxcbiAgICAgICAgICAgIHUgPSAuMDE2LFxuICAgICAgICAgICAgYyxcbiAgICAgICAgICAgIHAsXG4gICAgICAgICAgICBmO1xuICAgICAgICBmb3IgKGUgPSBwYXJzZUZsb2F0KGUpIHx8IDUwMCwgdCA9IHBhcnNlRmxvYXQodCkgfHwgMjAsIG4gPSBuIHx8IG51bGwsIG8udGVuc2lvbiA9IGUsIG8uZnJpY3Rpb24gPSB0LCBjID0gbnVsbCAhPT0gbiwgYyA/IChzID0gYShlLCB0KSwgcCA9IHMgLyBuICogdSkgOiBwID0gdTsgOyApXG4gICAgICAgICAgaWYgKGYgPSByKGYgfHwgbywgcCksIGkucHVzaCgxICsgZi54KSwgcyArPSAxNiwgIShNYXRoLmFicyhmLngpID4gbCAmJiBNYXRoLmFicyhmLnYpID4gbCkpXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgcmV0dXJuIGMgPyBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgcmV0dXJuIGlbZSAqIChpLmxlbmd0aCAtIDEpIHwgMF07XG4gICAgICAgIH0gOiBzO1xuICAgICAgfTtcbiAgICB9KCk7XG4gICAgdi5FYXNpbmdzID0ge1xuICAgICAgbGluZWFyOiBmdW5jdGlvbihlKSB7XG4gICAgICAgIHJldHVybiBlO1xuICAgICAgfSxcbiAgICAgIHN3aW5nOiBmdW5jdGlvbihlKSB7XG4gICAgICAgIHJldHVybiAuNSAtIE1hdGguY29zKGUgKiBNYXRoLlBJKSAvIDI7XG4gICAgICB9LFxuICAgICAgc3ByaW5nOiBmdW5jdGlvbihlKSB7XG4gICAgICAgIHJldHVybiAxIC0gTWF0aC5jb3MoNC41ICogZSAqIE1hdGguUEkpICogTWF0aC5leHAoNiAqIC1lKTtcbiAgICAgIH1cbiAgICB9LCAkLmVhY2goW1tcImVhc2VcIiwgWy4yNSwgLjEsIC4yNSwgMV1dLCBbXCJlYXNlLWluXCIsIFsuNDIsIDAsIDEsIDFdXSwgW1wiZWFzZS1vdXRcIiwgWzAsIDAsIC41OCwgMV1dLCBbXCJlYXNlLWluLW91dFwiLCBbLjQyLCAwLCAuNTgsIDFdXSwgW1wiZWFzZUluU2luZVwiLCBbLjQ3LCAwLCAuNzQ1LCAuNzE1XV0sIFtcImVhc2VPdXRTaW5lXCIsIFsuMzksIC41NzUsIC41NjUsIDFdXSwgW1wiZWFzZUluT3V0U2luZVwiLCBbLjQ0NSwgLjA1LCAuNTUsIC45NV1dLCBbXCJlYXNlSW5RdWFkXCIsIFsuNTUsIC4wODUsIC42OCwgLjUzXV0sIFtcImVhc2VPdXRRdWFkXCIsIFsuMjUsIC40NiwgLjQ1LCAuOTRdXSwgW1wiZWFzZUluT3V0UXVhZFwiLCBbLjQ1NSwgLjAzLCAuNTE1LCAuOTU1XV0sIFtcImVhc2VJbkN1YmljXCIsIFsuNTUsIC4wNTUsIC42NzUsIC4xOV1dLCBbXCJlYXNlT3V0Q3ViaWNcIiwgWy4yMTUsIC42MSwgLjM1NSwgMV1dLCBbXCJlYXNlSW5PdXRDdWJpY1wiLCBbLjY0NSwgLjA0NSwgLjM1NSwgMV1dLCBbXCJlYXNlSW5RdWFydFwiLCBbLjg5NSwgLjAzLCAuNjg1LCAuMjJdXSwgW1wiZWFzZU91dFF1YXJ0XCIsIFsuMTY1LCAuODQsIC40NCwgMV1dLCBbXCJlYXNlSW5PdXRRdWFydFwiLCBbLjc3LCAwLCAuMTc1LCAxXV0sIFtcImVhc2VJblF1aW50XCIsIFsuNzU1LCAuMDUsIC44NTUsIC4wNl1dLCBbXCJlYXNlT3V0UXVpbnRcIiwgWy4yMywgMSwgLjMyLCAxXV0sIFtcImVhc2VJbk91dFF1aW50XCIsIFsuODYsIDAsIC4wNywgMV1dLCBbXCJlYXNlSW5FeHBvXCIsIFsuOTUsIC4wNSwgLjc5NSwgLjAzNV1dLCBbXCJlYXNlT3V0RXhwb1wiLCBbLjE5LCAxLCAuMjIsIDFdXSwgW1wiZWFzZUluT3V0RXhwb1wiLCBbMSwgMCwgMCwgMV1dLCBbXCJlYXNlSW5DaXJjXCIsIFsuNiwgLjA0LCAuOTgsIC4zMzVdXSwgW1wiZWFzZU91dENpcmNcIiwgWy4wNzUsIC44MiwgLjE2NSwgMV1dLCBbXCJlYXNlSW5PdXRDaXJjXCIsIFsuNzg1LCAuMTM1LCAuMTUsIC44Nl1dXSwgZnVuY3Rpb24oZSwgdCkge1xuICAgICAgdi5FYXNpbmdzW3RbMF1dID0gbC5hcHBseShudWxsLCB0WzFdKTtcbiAgICB9KTtcbiAgICB2YXIgeCA9IHYuQ1NTID0ge1xuICAgICAgUmVnRXg6IHtcbiAgICAgICAgaXNIZXg6IC9eIyhbQS1mXFxkXXszfSl7MSwyfSQvaSxcbiAgICAgICAgdmFsdWVVbndyYXA6IC9eW0Etel0rXFwoKC4qKVxcKSQvaSxcbiAgICAgICAgd3JhcHBlZFZhbHVlQWxyZWFkeUV4dHJhY3RlZDogL1swLTkuXSsgWzAtOS5dKyBbMC05Ll0rKCBbMC05Ll0rKT8vLFxuICAgICAgICB2YWx1ZVNwbGl0OiAvKFtBLXpdK1xcKC4rXFwpKXwoKFtBLXowLTkjLS5dKz8pKD89XFxzfCQpKS9naVxuICAgICAgfSxcbiAgICAgIExpc3RzOiB7XG4gICAgICAgIGNvbG9yczogW1wiZmlsbFwiLCBcInN0cm9rZVwiLCBcInN0b3BDb2xvclwiLCBcImNvbG9yXCIsIFwiYmFja2dyb3VuZENvbG9yXCIsIFwiYm9yZGVyQ29sb3JcIiwgXCJib3JkZXJUb3BDb2xvclwiLCBcImJvcmRlclJpZ2h0Q29sb3JcIiwgXCJib3JkZXJCb3R0b21Db2xvclwiLCBcImJvcmRlckxlZnRDb2xvclwiLCBcIm91dGxpbmVDb2xvclwiXSxcbiAgICAgICAgdHJhbnNmb3Jtc0Jhc2U6IFtcInRyYW5zbGF0ZVhcIiwgXCJ0cmFuc2xhdGVZXCIsIFwic2NhbGVcIiwgXCJzY2FsZVhcIiwgXCJzY2FsZVlcIiwgXCJza2V3WFwiLCBcInNrZXdZXCIsIFwicm90YXRlWlwiXSxcbiAgICAgICAgdHJhbnNmb3JtczNEOiBbXCJ0cmFuc2Zvcm1QZXJzcGVjdGl2ZVwiLCBcInRyYW5zbGF0ZVpcIiwgXCJzY2FsZVpcIiwgXCJyb3RhdGVYXCIsIFwicm90YXRlWVwiXVxuICAgICAgfSxcbiAgICAgIEhvb2tzOiB7XG4gICAgICAgIHRlbXBsYXRlczoge1xuICAgICAgICAgIHRleHRTaGFkb3c6IFtcIkNvbG9yIFggWSBCbHVyXCIsIFwiYmxhY2sgMHB4IDBweCAwcHhcIl0sXG4gICAgICAgICAgYm94U2hhZG93OiBbXCJDb2xvciBYIFkgQmx1ciBTcHJlYWRcIiwgXCJibGFjayAwcHggMHB4IDBweCAwcHhcIl0sXG4gICAgICAgICAgY2xpcDogW1wiVG9wIFJpZ2h0IEJvdHRvbSBMZWZ0XCIsIFwiMHB4IDBweCAwcHggMHB4XCJdLFxuICAgICAgICAgIGJhY2tncm91bmRQb3NpdGlvbjogW1wiWCBZXCIsIFwiMCUgMCVcIl0sXG4gICAgICAgICAgdHJhbnNmb3JtT3JpZ2luOiBbXCJYIFkgWlwiLCBcIjUwJSA1MCUgMHB4XCJdLFxuICAgICAgICAgIHBlcnNwZWN0aXZlT3JpZ2luOiBbXCJYIFlcIiwgXCI1MCUgNTAlXCJdXG4gICAgICAgIH0sXG4gICAgICAgIHJlZ2lzdGVyZWQ6IHt9LFxuICAgICAgICByZWdpc3RlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB4Lkxpc3RzLmNvbG9ycy5sZW5ndGg7IGUrKykge1xuICAgICAgICAgICAgdmFyIHQgPSBcImNvbG9yXCIgPT09IHguTGlzdHMuY29sb3JzW2VdID8gXCIwIDAgMCAxXCIgOiBcIjI1NSAyNTUgMjU1IDFcIjtcbiAgICAgICAgICAgIHguSG9va3MudGVtcGxhdGVzW3guTGlzdHMuY29sb3JzW2VdXSA9IFtcIlJlZCBHcmVlbiBCbHVlIEFscGhhXCIsIHRdO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcixcbiAgICAgICAgICAgICAgYSxcbiAgICAgICAgICAgICAgbjtcbiAgICAgICAgICBpZiAoZilcbiAgICAgICAgICAgIGZvciAociBpbiB4Lkhvb2tzLnRlbXBsYXRlcykge1xuICAgICAgICAgICAgICBhID0geC5Ib29rcy50ZW1wbGF0ZXNbcl0sIG4gPSBhWzBdLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgICAgICAgdmFyIG8gPSBhWzFdLm1hdGNoKHguUmVnRXgudmFsdWVTcGxpdCk7XG4gICAgICAgICAgICAgIFwiQ29sb3JcIiA9PT0gblswXSAmJiAobi5wdXNoKG4uc2hpZnQoKSksIG8ucHVzaChvLnNoaWZ0KCkpLCB4Lkhvb2tzLnRlbXBsYXRlc1tyXSA9IFtuLmpvaW4oXCIgXCIpLCBvLmpvaW4oXCIgXCIpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgZm9yIChyIGluIHguSG9va3MudGVtcGxhdGVzKSB7XG4gICAgICAgICAgICBhID0geC5Ib29rcy50ZW1wbGF0ZXNbcl0sIG4gPSBhWzBdLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgICAgIGZvciAodmFyIGUgaW4gbikge1xuICAgICAgICAgICAgICB2YXIgaSA9IHIgKyBuW2VdLFxuICAgICAgICAgICAgICAgICAgcyA9IGU7XG4gICAgICAgICAgICAgIHguSG9va3MucmVnaXN0ZXJlZFtpXSA9IFtyLCBzXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdldFJvb3Q6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICB2YXIgdCA9IHguSG9va3MucmVnaXN0ZXJlZFtlXTtcbiAgICAgICAgICByZXR1cm4gdCA/IHRbMF0gOiBlO1xuICAgICAgICB9LFxuICAgICAgICBjbGVhblJvb3RQcm9wZXJ0eVZhbHVlOiBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgcmV0dXJuIHguUmVnRXgudmFsdWVVbndyYXAudGVzdCh0KSAmJiAodCA9IHQubWF0Y2goeC5SZWdFeC52YWx1ZVVud3JhcClbMV0pLCB4LlZhbHVlcy5pc0NTU051bGxWYWx1ZSh0KSAmJiAodCA9IHguSG9va3MudGVtcGxhdGVzW2VdWzFdKSwgdDtcbiAgICAgICAgfSxcbiAgICAgICAgZXh0cmFjdFZhbHVlOiBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgdmFyIHIgPSB4Lkhvb2tzLnJlZ2lzdGVyZWRbZV07XG4gICAgICAgICAgaWYgKHIpIHtcbiAgICAgICAgICAgIHZhciBhID0gclswXSxcbiAgICAgICAgICAgICAgICBuID0gclsxXTtcbiAgICAgICAgICAgIHJldHVybiB0ID0geC5Ib29rcy5jbGVhblJvb3RQcm9wZXJ0eVZhbHVlKGEsIHQpLCB0LnRvU3RyaW5nKCkubWF0Y2goeC5SZWdFeC52YWx1ZVNwbGl0KVtuXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGluamVjdFZhbHVlOiBmdW5jdGlvbihlLCB0LCByKSB7XG4gICAgICAgICAgdmFyIGEgPSB4Lkhvb2tzLnJlZ2lzdGVyZWRbZV07XG4gICAgICAgICAgaWYgKGEpIHtcbiAgICAgICAgICAgIHZhciBuID0gYVswXSxcbiAgICAgICAgICAgICAgICBvID0gYVsxXSxcbiAgICAgICAgICAgICAgICBpLFxuICAgICAgICAgICAgICAgIHM7XG4gICAgICAgICAgICByZXR1cm4gciA9IHguSG9va3MuY2xlYW5Sb290UHJvcGVydHlWYWx1ZShuLCByKSwgaSA9IHIudG9TdHJpbmcoKS5tYXRjaCh4LlJlZ0V4LnZhbHVlU3BsaXQpLCBpW29dID0gdCwgcyA9IGkuam9pbihcIiBcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgTm9ybWFsaXphdGlvbnM6IHtcbiAgICAgICAgcmVnaXN0ZXJlZDoge1xuICAgICAgICAgIGNsaXA6IGZ1bmN0aW9uKGUsIHQsIHIpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgICAgICBjYXNlIFwibmFtZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImNsaXBcIjtcbiAgICAgICAgICAgICAgY2FzZSBcImV4dHJhY3RcIjpcbiAgICAgICAgICAgICAgICB2YXIgYTtcbiAgICAgICAgICAgICAgICByZXR1cm4geC5SZWdFeC53cmFwcGVkVmFsdWVBbHJlYWR5RXh0cmFjdGVkLnRlc3QocikgPyBhID0gciA6IChhID0gci50b1N0cmluZygpLm1hdGNoKHguUmVnRXgudmFsdWVVbndyYXApLCBhID0gYSA/IGFbMV0ucmVwbGFjZSgvLChcXHMrKT8vZywgXCIgXCIpIDogciksIGE7XG4gICAgICAgICAgICAgIGNhc2UgXCJpbmplY3RcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJyZWN0KFwiICsgciArIFwiKVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgYmx1cjogZnVuY3Rpb24oZSwgdCwgcikge1xuICAgICAgICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJuYW1lXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHYuU3RhdGUuaXNGaXJlZm94ID8gXCJmaWx0ZXJcIiA6IFwiLXdlYmtpdC1maWx0ZXJcIjtcbiAgICAgICAgICAgICAgY2FzZSBcImV4dHJhY3RcIjpcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHBhcnNlRmxvYXQocik7XG4gICAgICAgICAgICAgICAgaWYgKCFhICYmIDAgIT09IGEpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBuID0gci50b1N0cmluZygpLm1hdGNoKC9ibHVyXFwoKFswLTldK1tBLXpdKylcXCkvaSk7XG4gICAgICAgICAgICAgICAgICBhID0gbiA/IG5bMV0gOiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgICAgY2FzZSBcImluamVjdFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHIpID8gXCJibHVyKFwiICsgciArIFwiKVwiIDogXCJub25lXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcGFjaXR5OiBmdW5jdGlvbihlLCB0LCByKSB7XG4gICAgICAgICAgICBpZiAoOCA+PSBmKVxuICAgICAgICAgICAgICBzd2l0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwibmFtZVwiOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiZmlsdGVyXCI7XG4gICAgICAgICAgICAgICAgY2FzZSBcImV4dHJhY3RcIjpcbiAgICAgICAgICAgICAgICAgIHZhciBhID0gci50b1N0cmluZygpLm1hdGNoKC9hbHBoYVxcKG9wYWNpdHk9KC4qKVxcKS9pKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByID0gYSA/IGFbMV0gLyAxMDAgOiAxO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJpbmplY3RcIjpcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0LnN0eWxlLnpvb20gPSAxLCBwYXJzZUZsb2F0KHIpID49IDEgPyBcIlwiIDogXCJhbHBoYShvcGFjaXR5PVwiICsgcGFyc2VJbnQoMTAwICogcGFyc2VGbG9hdChyKSwgMTApICsgXCIpXCI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm5hbWVcIjpcbiAgICAgICAgICAgICAgICAgIHJldHVybiBcIm9wYWNpdHlcIjtcbiAgICAgICAgICAgICAgICBjYXNlIFwiZXh0cmFjdFwiOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICAgICAgY2FzZSBcImluamVjdFwiOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlZ2lzdGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICA5ID49IGYgfHwgdi5TdGF0ZS5pc0dpbmdlcmJyZWFkIHx8ICh4Lkxpc3RzLnRyYW5zZm9ybXNCYXNlID0geC5MaXN0cy50cmFuc2Zvcm1zQmFzZS5jb25jYXQoeC5MaXN0cy50cmFuc2Zvcm1zM0QpKTtcbiAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHguTGlzdHMudHJhbnNmb3Jtc0Jhc2UubGVuZ3RoOyBlKyspXG4gICAgICAgICAgICAhZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciB0ID0geC5MaXN0cy50cmFuc2Zvcm1zQmFzZVtlXTtcbiAgICAgICAgICAgICAgeC5Ob3JtYWxpemF0aW9ucy5yZWdpc3RlcmVkW3RdID0gZnVuY3Rpb24oZSwgciwgbikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgY2FzZSBcIm5hbWVcIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwidHJhbnNmb3JtXCI7XG4gICAgICAgICAgICAgICAgICBjYXNlIFwiZXh0cmFjdFwiOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaShyKSA9PT0gYSB8fCBpKHIpLnRyYW5zZm9ybUNhY2hlW3RdID09PSBhID8gL15zY2FsZS9pLnRlc3QodCkgPyAxIDogMCA6IGkocikudHJhbnNmb3JtQ2FjaGVbdF0ucmVwbGFjZSgvWygpXS9nLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbmplY3RcIjpcbiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSAhMTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0LnN1YnN0cigwLCB0Lmxlbmd0aCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInRyYW5zbGF0ZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9ICEvKCV8cHh8ZW18cmVtfHZ3fHZofFxcZCkkL2kudGVzdChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzY2FsXCI6XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNjYWxlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB2LlN0YXRlLmlzQW5kcm9pZCAmJiBpKHIpLnRyYW5zZm9ybUNhY2hlW3RdID09PSBhICYmIDEgPiBuICYmIChuID0gMSksIG8gPSAhLyhcXGQpJC9pLnRlc3Qobik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2tld1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9ICEvKGRlZ3xcXGQpJC9pLnRlc3Qobik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicm90YXRlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gIS8oZGVnfFxcZCkkL2kudGVzdChuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbyB8fCAoaShyKS50cmFuc2Zvcm1DYWNoZVt0XSA9IFwiKFwiICsgbiArIFwiKVwiKSwgaShyKS50cmFuc2Zvcm1DYWNoZVt0XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KCk7XG4gICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB4Lkxpc3RzLmNvbG9ycy5sZW5ndGg7IGUrKylcbiAgICAgICAgICAgICFmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdmFyIHQgPSB4Lkxpc3RzLmNvbG9yc1tlXTtcbiAgICAgICAgICAgICAgeC5Ob3JtYWxpemF0aW9ucy5yZWdpc3RlcmVkW3RdID0gZnVuY3Rpb24oZSwgciwgbikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgY2FzZSBcIm5hbWVcIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgICAgICAgICAgICBjYXNlIFwiZXh0cmFjdFwiOlxuICAgICAgICAgICAgICAgICAgICB2YXIgbztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHguUmVnRXgud3JhcHBlZFZhbHVlQWxyZWFkeUV4dHJhY3RlZC50ZXN0KG4pKVxuICAgICAgICAgICAgICAgICAgICAgIG8gPSBuO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGFjazogXCJyZ2IoMCwgMCwgMClcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibHVlOiBcInJnYigwLCAwLCAyNTUpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JheTogXCJyZ2IoMTI4LCAxMjgsIDEyOClcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmVlbjogXCJyZ2IoMCwgMTI4LCAwKVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZDogXCJyZ2IoMjU1LCAwLCAwKVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaXRlOiBcInJnYigyNTUsIDI1NSwgMjU1KVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgL15bQS16XSskL2kudGVzdChuKSA/IGkgPSBzW25dICE9PSBhID8gc1tuXSA6IHMuYmxhY2sgOiB4LlJlZ0V4LmlzSGV4LnRlc3QobikgPyBpID0gXCJyZ2IoXCIgKyB4LlZhbHVlcy5oZXhUb1JnYihuKS5qb2luKFwiIFwiKSArIFwiKVwiIDogL15yZ2JhP1xcKC9pLnRlc3QobikgfHwgKGkgPSBzLmJsYWNrKSwgbyA9IChpIHx8IG4pLnRvU3RyaW5nKCkubWF0Y2goeC5SZWdFeC52YWx1ZVVud3JhcClbMV0ucmVwbGFjZSgvLChcXHMrKT8vZywgXCIgXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA4ID49IGYgfHwgMyAhPT0gby5zcGxpdChcIiBcIikubGVuZ3RoIHx8IChvICs9IFwiIDFcIiksIG87XG4gICAgICAgICAgICAgICAgICBjYXNlIFwiaW5qZWN0XCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA4ID49IGYgPyA0ID09PSBuLnNwbGl0KFwiIFwiKS5sZW5ndGggJiYgKG4gPSBuLnNwbGl0KC9cXHMrLykuc2xpY2UoMCwgMykuam9pbihcIiBcIikpIDogMyA9PT0gbi5zcGxpdChcIiBcIikubGVuZ3RoICYmIChuICs9IFwiIDFcIiksICg4ID49IGYgPyBcInJnYlwiIDogXCJyZ2JhXCIpICsgXCIoXCIgKyBuLnJlcGxhY2UoL1xccysvZywgXCIsXCIpLnJlcGxhY2UoL1xcLihcXGQpKyg/PSwpL2csIFwiXCIpICsgXCIpXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgTmFtZXM6IHtcbiAgICAgICAgY2FtZWxDYXNlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgcmV0dXJuIGUucmVwbGFjZSgvLShcXHcpL2csIGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0LnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIFNWR0F0dHJpYnV0ZTogZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHZhciB0ID0gXCJ3aWR0aHxoZWlnaHR8eHx5fGN4fGN5fHJ8cnh8cnl8eDF8eDJ8eTF8eTJcIjtcbiAgICAgICAgICByZXR1cm4gKGYgfHwgdi5TdGF0ZS5pc0FuZHJvaWQgJiYgIXYuU3RhdGUuaXNDaHJvbWUpICYmICh0ICs9IFwifHRyYW5zZm9ybVwiKSwgbmV3IFJlZ0V4cChcIl4oXCIgKyB0ICsgXCIpJFwiLCBcImlcIikudGVzdChlKTtcbiAgICAgICAgfSxcbiAgICAgICAgcHJlZml4Q2hlY2s6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICBpZiAodi5TdGF0ZS5wcmVmaXhNYXRjaGVzW2VdKVxuICAgICAgICAgICAgcmV0dXJuIFt2LlN0YXRlLnByZWZpeE1hdGNoZXNbZV0sICEwXTtcbiAgICAgICAgICBmb3IgKHZhciB0ID0gW1wiXCIsIFwiV2Via2l0XCIsIFwiTW96XCIsIFwibXNcIiwgXCJPXCJdLFxuICAgICAgICAgICAgICByID0gMCxcbiAgICAgICAgICAgICAgYSA9IHQubGVuZ3RoOyBhID4gcjsgcisrKSB7XG4gICAgICAgICAgICB2YXIgbjtcbiAgICAgICAgICAgIGlmIChuID0gMCA9PT0gciA/IGUgOiB0W3JdICsgZS5yZXBsYWNlKC9eXFx3LywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICByZXR1cm4gZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgfSksIGcuaXNTdHJpbmcodi5TdGF0ZS5wcmVmaXhFbGVtZW50LnN0eWxlW25dKSlcbiAgICAgICAgICAgICAgcmV0dXJuIHYuU3RhdGUucHJlZml4TWF0Y2hlc1tlXSA9IG4sIFtuLCAhMF07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBbZSwgITFdO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgVmFsdWVzOiB7XG4gICAgICAgIGhleFRvUmdiOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgdmFyIHQgPSAvXiM/KFthLWZcXGRdKShbYS1mXFxkXSkoW2EtZlxcZF0pJC9pLFxuICAgICAgICAgICAgICByID0gL14jPyhbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pKFthLWZcXGRdezJ9KSQvaSxcbiAgICAgICAgICAgICAgYTtcbiAgICAgICAgICByZXR1cm4gZSA9IGUucmVwbGFjZSh0LCBmdW5jdGlvbihlLCB0LCByLCBhKSB7XG4gICAgICAgICAgICByZXR1cm4gdCArIHQgKyByICsgciArIGEgKyBhO1xuICAgICAgICAgIH0pLCBhID0gci5leGVjKGUpLCBhID8gW3BhcnNlSW50KGFbMV0sIDE2KSwgcGFyc2VJbnQoYVsyXSwgMTYpLCBwYXJzZUludChhWzNdLCAxNildIDogWzAsIDAsIDBdO1xuICAgICAgICB9LFxuICAgICAgICBpc0NTU051bGxWYWx1ZTogZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHJldHVybiAwID09IGUgfHwgL14obm9uZXxhdXRvfHRyYW5zcGFyZW50fChyZ2JhXFwoMCwgPzAsID8wLCA/MFxcKSkpJC9pLnRlc3QoZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFVuaXRUeXBlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgcmV0dXJuIC9eKHJvdGF0ZXxza2V3KS9pLnRlc3QoZSkgPyBcImRlZ1wiIDogLyheKHNjYWxlfHNjYWxlWHxzY2FsZVl8c2NhbGVafGFscGhhfGZsZXhHcm93fGZsZXhIZWlnaHR8ekluZGV4fGZvbnRXZWlnaHQpJCl8KChvcGFjaXR5fHJlZHxncmVlbnxibHVlfGFscGhhKSQpL2kudGVzdChlKSA/IFwiXCIgOiBcInB4XCI7XG4gICAgICAgIH0sXG4gICAgICAgIGdldERpc3BsYXlUeXBlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgdmFyIHQgPSBlICYmIGUudGFnTmFtZS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgcmV0dXJuIC9eKGJ8YmlnfGl8c21hbGx8dHR8YWJicnxhY3JvbnltfGNpdGV8Y29kZXxkZm58ZW18a2JkfHN0cm9uZ3xzYW1wfHZhcnxhfGJkb3xicnxpbWd8bWFwfG9iamVjdHxxfHNjcmlwdHxzcGFufHN1YnxzdXB8YnV0dG9ufGlucHV0fGxhYmVsfHNlbGVjdHx0ZXh0YXJlYSkkL2kudGVzdCh0KSA/IFwiaW5saW5lXCIgOiAvXihsaSkkL2kudGVzdCh0KSA/IFwibGlzdC1pdGVtXCIgOiAvXih0cikkL2kudGVzdCh0KSA/IFwidGFibGUtcm93XCIgOiAvXih0YWJsZSkkL2kudGVzdCh0KSA/IFwidGFibGVcIiA6IC9eKHRib2R5KSQvaS50ZXN0KHQpID8gXCJ0YWJsZS1yb3ctZ3JvdXBcIiA6IFwiYmxvY2tcIjtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgICAgICBlLmNsYXNzTGlzdCA/IGUuY2xhc3NMaXN0LmFkZCh0KSA6IGUuY2xhc3NOYW1lICs9IChlLmNsYXNzTmFtZS5sZW5ndGggPyBcIiBcIiA6IFwiXCIpICsgdDtcbiAgICAgICAgfSxcbiAgICAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgICAgICBlLmNsYXNzTGlzdCA/IGUuY2xhc3NMaXN0LnJlbW92ZSh0KSA6IGUuY2xhc3NOYW1lID0gZS5jbGFzc05hbWUudG9TdHJpbmcoKS5yZXBsYWNlKG5ldyBSZWdFeHAoXCIoXnxcXFxccylcIiArIHQuc3BsaXQoXCIgXCIpLmpvaW4oXCJ8XCIpICsgXCIoXFxcXHN8JClcIiwgXCJnaVwiKSwgXCIgXCIpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZ2V0UHJvcGVydHlWYWx1ZTogZnVuY3Rpb24oZSwgciwgbiwgbykge1xuICAgICAgICBmdW5jdGlvbiBzKGUsIHIpIHtcbiAgICAgICAgICBmdW5jdGlvbiBuKCkge1xuICAgICAgICAgICAgdSAmJiB4LnNldFByb3BlcnR5VmFsdWUoZSwgXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGwgPSAwO1xuICAgICAgICAgIGlmICg4ID49IGYpXG4gICAgICAgICAgICBsID0gJC5jc3MoZSwgcik7XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgdSA9ICExO1xuICAgICAgICAgICAgaWYgKC9eKHdpZHRofGhlaWdodCkkLy50ZXN0KHIpICYmIDAgPT09IHguZ2V0UHJvcGVydHlWYWx1ZShlLCBcImRpc3BsYXlcIikgJiYgKHUgPSAhMCwgeC5zZXRQcm9wZXJ0eVZhbHVlKGUsIFwiZGlzcGxheVwiLCB4LlZhbHVlcy5nZXREaXNwbGF5VHlwZShlKSkpLCAhbykge1xuICAgICAgICAgICAgICBpZiAoXCJoZWlnaHRcIiA9PT0gciAmJiBcImJvcmRlci1ib3hcIiAhPT0geC5nZXRQcm9wZXJ0eVZhbHVlKGUsIFwiYm94U2l6aW5nXCIpLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gZS5vZmZzZXRIZWlnaHQgLSAocGFyc2VGbG9hdCh4LmdldFByb3BlcnR5VmFsdWUoZSwgXCJib3JkZXJUb3BXaWR0aFwiKSkgfHwgMCkgLSAocGFyc2VGbG9hdCh4LmdldFByb3BlcnR5VmFsdWUoZSwgXCJib3JkZXJCb3R0b21XaWR0aFwiKSkgfHwgMCkgLSAocGFyc2VGbG9hdCh4LmdldFByb3BlcnR5VmFsdWUoZSwgXCJwYWRkaW5nVG9wXCIpKSB8fCAwKSAtIChwYXJzZUZsb2F0KHguZ2V0UHJvcGVydHlWYWx1ZShlLCBcInBhZGRpbmdCb3R0b21cIikpIHx8IDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBuKCksIGM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKFwid2lkdGhcIiA9PT0gciAmJiBcImJvcmRlci1ib3hcIiAhPT0geC5nZXRQcm9wZXJ0eVZhbHVlKGUsIFwiYm94U2l6aW5nXCIpLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIHZhciBwID0gZS5vZmZzZXRXaWR0aCAtIChwYXJzZUZsb2F0KHguZ2V0UHJvcGVydHlWYWx1ZShlLCBcImJvcmRlckxlZnRXaWR0aFwiKSkgfHwgMCkgLSAocGFyc2VGbG9hdCh4LmdldFByb3BlcnR5VmFsdWUoZSwgXCJib3JkZXJSaWdodFdpZHRoXCIpKSB8fCAwKSAtIChwYXJzZUZsb2F0KHguZ2V0UHJvcGVydHlWYWx1ZShlLCBcInBhZGRpbmdMZWZ0XCIpKSB8fCAwKSAtIChwYXJzZUZsb2F0KHguZ2V0UHJvcGVydHlWYWx1ZShlLCBcInBhZGRpbmdSaWdodFwiKSkgfHwgMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4oKSwgcDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGQ7XG4gICAgICAgICAgICBkID0gaShlKSA9PT0gYSA/IHQuZ2V0Q29tcHV0ZWRTdHlsZShlLCBudWxsKSA6IGkoZSkuY29tcHV0ZWRTdHlsZSA/IGkoZSkuY29tcHV0ZWRTdHlsZSA6IGkoZSkuY29tcHV0ZWRTdHlsZSA9IHQuZ2V0Q29tcHV0ZWRTdHlsZShlLCBudWxsKSwgXCJib3JkZXJDb2xvclwiID09PSByICYmIChyID0gXCJib3JkZXJUb3BDb2xvclwiKSwgbCA9IDkgPT09IGYgJiYgXCJmaWx0ZXJcIiA9PT0gciA/IGQuZ2V0UHJvcGVydHlWYWx1ZShyKSA6IGRbcl0sIChcIlwiID09PSBsIHx8IG51bGwgPT09IGwpICYmIChsID0gZS5zdHlsZVtyXSksIG4oKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKFwiYXV0b1wiID09PSBsICYmIC9eKHRvcHxyaWdodHxib3R0b218bGVmdCkkL2kudGVzdChyKSkge1xuICAgICAgICAgICAgdmFyIGcgPSBzKGUsIFwicG9zaXRpb25cIik7XG4gICAgICAgICAgICAoXCJmaXhlZFwiID09PSBnIHx8IFwiYWJzb2x1dGVcIiA9PT0gZyAmJiAvdG9wfGxlZnQvaS50ZXN0KHIpKSAmJiAobCA9ICQoZSkucG9zaXRpb24oKVtyXSArIFwicHhcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsO1xuICAgICAgICBpZiAoeC5Ib29rcy5yZWdpc3RlcmVkW3JdKSB7XG4gICAgICAgICAgdmFyIHUgPSByLFxuICAgICAgICAgICAgICBjID0geC5Ib29rcy5nZXRSb290KHUpO1xuICAgICAgICAgIG4gPT09IGEgJiYgKG4gPSB4LmdldFByb3BlcnR5VmFsdWUoZSwgeC5OYW1lcy5wcmVmaXhDaGVjayhjKVswXSkpLCB4Lk5vcm1hbGl6YXRpb25zLnJlZ2lzdGVyZWRbY10gJiYgKG4gPSB4Lk5vcm1hbGl6YXRpb25zLnJlZ2lzdGVyZWRbY10oXCJleHRyYWN0XCIsIGUsIG4pKSwgbCA9IHguSG9va3MuZXh0cmFjdFZhbHVlKHUsIG4pO1xuICAgICAgICB9IGVsc2UgaWYgKHguTm9ybWFsaXphdGlvbnMucmVnaXN0ZXJlZFtyXSkge1xuICAgICAgICAgIHZhciBwLFxuICAgICAgICAgICAgICBkO1xuICAgICAgICAgIHAgPSB4Lk5vcm1hbGl6YXRpb25zLnJlZ2lzdGVyZWRbcl0oXCJuYW1lXCIsIGUpLCBcInRyYW5zZm9ybVwiICE9PSBwICYmIChkID0gcyhlLCB4Lk5hbWVzLnByZWZpeENoZWNrKHApWzBdKSwgeC5WYWx1ZXMuaXNDU1NOdWxsVmFsdWUoZCkgJiYgeC5Ib29rcy50ZW1wbGF0ZXNbcl0gJiYgKGQgPSB4Lkhvb2tzLnRlbXBsYXRlc1tyXVsxXSkpLCBsID0geC5Ob3JtYWxpemF0aW9ucy5yZWdpc3RlcmVkW3JdKFwiZXh0cmFjdFwiLCBlLCBkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIS9eW1xcZC1dLy50ZXN0KGwpKVxuICAgICAgICAgIGlmIChpKGUpICYmIGkoZSkuaXNTVkcgJiYgeC5OYW1lcy5TVkdBdHRyaWJ1dGUocikpXG4gICAgICAgICAgICBpZiAoL14oaGVpZ2h0fHdpZHRoKSQvaS50ZXN0KHIpKVxuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGwgPSBlLmdldEJCb3goKVtyXTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZykge1xuICAgICAgICAgICAgICAgIGwgPSAwO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgIGwgPSBlLmdldEF0dHJpYnV0ZShyKTtcbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICBsID0gcyhlLCB4Lk5hbWVzLnByZWZpeENoZWNrKHIpWzBdKTtcbiAgICAgICAgcmV0dXJuIHguVmFsdWVzLmlzQ1NTTnVsbFZhbHVlKGwpICYmIChsID0gMCksIHYuZGVidWcgPj0gMiAmJiBjb25zb2xlLmxvZyhcIkdldCBcIiArIHIgKyBcIjogXCIgKyBsKSwgbDtcbiAgICAgIH0sXG4gICAgICBzZXRQcm9wZXJ0eVZhbHVlOiBmdW5jdGlvbihlLCByLCBhLCBuLCBvKSB7XG4gICAgICAgIHZhciBzID0gcjtcbiAgICAgICAgaWYgKFwic2Nyb2xsXCIgPT09IHIpXG4gICAgICAgICAgby5jb250YWluZXIgPyBvLmNvbnRhaW5lcltcInNjcm9sbFwiICsgby5kaXJlY3Rpb25dID0gYSA6IFwiTGVmdFwiID09PSBvLmRpcmVjdGlvbiA/IHQuc2Nyb2xsVG8oYSwgby5hbHRlcm5hdGVWYWx1ZSkgOiB0LnNjcm9sbFRvKG8uYWx0ZXJuYXRlVmFsdWUsIGEpO1xuICAgICAgICBlbHNlIGlmICh4Lk5vcm1hbGl6YXRpb25zLnJlZ2lzdGVyZWRbcl0gJiYgXCJ0cmFuc2Zvcm1cIiA9PT0geC5Ob3JtYWxpemF0aW9ucy5yZWdpc3RlcmVkW3JdKFwibmFtZVwiLCBlKSlcbiAgICAgICAgICB4Lk5vcm1hbGl6YXRpb25zLnJlZ2lzdGVyZWRbcl0oXCJpbmplY3RcIiwgZSwgYSksIHMgPSBcInRyYW5zZm9ybVwiLCBhID0gaShlKS50cmFuc2Zvcm1DYWNoZVtyXTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgaWYgKHguSG9va3MucmVnaXN0ZXJlZFtyXSkge1xuICAgICAgICAgICAgdmFyIGwgPSByLFxuICAgICAgICAgICAgICAgIHUgPSB4Lkhvb2tzLmdldFJvb3Qocik7XG4gICAgICAgICAgICBuID0gbiB8fCB4LmdldFByb3BlcnR5VmFsdWUoZSwgdSksIGEgPSB4Lkhvb2tzLmluamVjdFZhbHVlKGwsIGEsIG4pLCByID0gdTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHguTm9ybWFsaXphdGlvbnMucmVnaXN0ZXJlZFtyXSAmJiAoYSA9IHguTm9ybWFsaXphdGlvbnMucmVnaXN0ZXJlZFtyXShcImluamVjdFwiLCBlLCBhKSwgciA9IHguTm9ybWFsaXphdGlvbnMucmVnaXN0ZXJlZFtyXShcIm5hbWVcIiwgZSkpLCBzID0geC5OYW1lcy5wcmVmaXhDaGVjayhyKVswXSwgOCA+PSBmKVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgZS5zdHlsZVtzXSA9IGE7XG4gICAgICAgICAgICB9IGNhdGNoIChjKSB7XG4gICAgICAgICAgICAgIHYuZGVidWcgJiYgY29uc29sZS5sb2coXCJCcm93c2VyIGRvZXMgbm90IHN1cHBvcnQgW1wiICsgYSArIFwiXSBmb3IgW1wiICsgcyArIFwiXVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICBpKGUpICYmIGkoZSkuaXNTVkcgJiYgeC5OYW1lcy5TVkdBdHRyaWJ1dGUocikgPyBlLnNldEF0dHJpYnV0ZShyLCBhKSA6IGUuc3R5bGVbc10gPSBhO1xuICAgICAgICAgIHYuZGVidWcgPj0gMiAmJiBjb25zb2xlLmxvZyhcIlNldCBcIiArIHIgKyBcIiAoXCIgKyBzICsgXCIpOiBcIiArIGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbcywgYV07XG4gICAgICB9LFxuICAgICAgZmx1c2hUcmFuc2Zvcm1DYWNoZTogZnVuY3Rpb24oZSkge1xuICAgICAgICBmdW5jdGlvbiB0KHQpIHtcbiAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh4LmdldFByb3BlcnR5VmFsdWUoZSwgdCkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByID0gXCJcIjtcbiAgICAgICAgaWYgKChmIHx8IHYuU3RhdGUuaXNBbmRyb2lkICYmICF2LlN0YXRlLmlzQ2hyb21lKSAmJiBpKGUpLmlzU1ZHKSB7XG4gICAgICAgICAgdmFyIGEgPSB7XG4gICAgICAgICAgICB0cmFuc2xhdGU6IFt0KFwidHJhbnNsYXRlWFwiKSwgdChcInRyYW5zbGF0ZVlcIildLFxuICAgICAgICAgICAgc2tld1g6IFt0KFwic2tld1hcIildLFxuICAgICAgICAgICAgc2tld1k6IFt0KFwic2tld1lcIildLFxuICAgICAgICAgICAgc2NhbGU6IDEgIT09IHQoXCJzY2FsZVwiKSA/IFt0KFwic2NhbGVcIiksIHQoXCJzY2FsZVwiKV0gOiBbdChcInNjYWxlWFwiKSwgdChcInNjYWxlWVwiKV0sXG4gICAgICAgICAgICByb3RhdGU6IFt0KFwicm90YXRlWlwiKSwgMCwgMF1cbiAgICAgICAgICB9O1xuICAgICAgICAgICQuZWFjaChpKGUpLnRyYW5zZm9ybUNhY2hlLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAvXnRyYW5zbGF0ZS9pLnRlc3QoZSkgPyBlID0gXCJ0cmFuc2xhdGVcIiA6IC9ec2NhbGUvaS50ZXN0KGUpID8gZSA9IFwic2NhbGVcIiA6IC9ecm90YXRlL2kudGVzdChlKSAmJiAoZSA9IFwicm90YXRlXCIpLCBhW2VdICYmIChyICs9IGUgKyBcIihcIiArIGFbZV0uam9pbihcIiBcIikgKyBcIikgXCIsIGRlbGV0ZSBhW2VdKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgbixcbiAgICAgICAgICAgICAgbztcbiAgICAgICAgICAkLmVhY2goaShlKS50cmFuc2Zvcm1DYWNoZSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIG4gPSBpKGUpLnRyYW5zZm9ybUNhY2hlW3RdLCBcInRyYW5zZm9ybVBlcnNwZWN0aXZlXCIgPT09IHQgPyAobyA9IG4sICEwKSA6ICg5ID09PSBmICYmIFwicm90YXRlWlwiID09PSB0ICYmICh0ID0gXCJyb3RhdGVcIiksIHZvaWQociArPSB0ICsgbiArIFwiIFwiKSk7XG4gICAgICAgICAgfSksIG8gJiYgKHIgPSBcInBlcnNwZWN0aXZlXCIgKyBvICsgXCIgXCIgKyByKTtcbiAgICAgICAgfVxuICAgICAgICB4LnNldFByb3BlcnR5VmFsdWUoZSwgXCJ0cmFuc2Zvcm1cIiwgcik7XG4gICAgICB9XG4gICAgfTtcbiAgICB4Lkhvb2tzLnJlZ2lzdGVyKCksIHguTm9ybWFsaXphdGlvbnMucmVnaXN0ZXIoKSwgdi5ob29rID0gZnVuY3Rpb24oZSwgdCwgcikge1xuICAgICAgdmFyIG4gPSBhO1xuICAgICAgcmV0dXJuIGUgPSBvKGUpLCAkLmVhY2goZSwgZnVuY3Rpb24oZSwgbykge1xuICAgICAgICBpZiAoaShvKSA9PT0gYSAmJiB2LmluaXQobyksIHIgPT09IGEpXG4gICAgICAgICAgbiA9PT0gYSAmJiAobiA9IHYuQ1NTLmdldFByb3BlcnR5VmFsdWUobywgdCkpO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB2YXIgcyA9IHYuQ1NTLnNldFByb3BlcnR5VmFsdWUobywgdCwgcik7XG4gICAgICAgICAgXCJ0cmFuc2Zvcm1cIiA9PT0gc1swXSAmJiB2LkNTUy5mbHVzaFRyYW5zZm9ybUNhY2hlKG8pLCBuID0gcztcbiAgICAgICAgfVxuICAgICAgfSksIG47XG4gICAgfTtcbiAgICB2YXIgUyA9IGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gZSgpIHtcbiAgICAgICAgcmV0dXJuIGwgPyBULnByb21pc2UgfHwgbnVsbCA6IGY7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBuKCkge1xuICAgICAgICBmdW5jdGlvbiBlKGUpIHtcbiAgICAgICAgICBmdW5jdGlvbiBwKGUsIHQpIHtcbiAgICAgICAgICAgIHZhciByID0gYSxcbiAgICAgICAgICAgICAgICBpID0gYSxcbiAgICAgICAgICAgICAgICBzID0gYTtcbiAgICAgICAgICAgIHJldHVybiBnLmlzQXJyYXkoZSkgPyAociA9IGVbMF0sICFnLmlzQXJyYXkoZVsxXSkgJiYgL15bXFxkLV0vLnRlc3QoZVsxXSkgfHwgZy5pc0Z1bmN0aW9uKGVbMV0pIHx8IHguUmVnRXguaXNIZXgudGVzdChlWzFdKSA/IHMgPSBlWzFdIDogKGcuaXNTdHJpbmcoZVsxXSkgJiYgIXguUmVnRXguaXNIZXgudGVzdChlWzFdKSB8fCBnLmlzQXJyYXkoZVsxXSkpICYmIChpID0gdCA/IGVbMV0gOiB1KGVbMV0sIG8uZHVyYXRpb24pLCBlWzJdICE9PSBhICYmIChzID0gZVsyXSkpKSA6IHIgPSBlLCB0IHx8IChpID0gaSB8fCBvLmVhc2luZyksIGcuaXNGdW5jdGlvbihyKSAmJiAociA9IHIuY2FsbChuLCB3LCBQKSksIGcuaXNGdW5jdGlvbihzKSAmJiAocyA9IHMuY2FsbChuLCB3LCBQKSksIFtyIHx8IDAsIGksIHNdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmdW5jdGlvbiBmKGUsIHQpIHtcbiAgICAgICAgICAgIHZhciByLFxuICAgICAgICAgICAgICAgIGE7XG4gICAgICAgICAgICByZXR1cm4gYSA9ICh0IHx8IFwiMFwiKS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvWyVBLXpdKyQvLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgIHJldHVybiByID0gZSwgXCJcIjtcbiAgICAgICAgICAgIH0pLCByIHx8IChyID0geC5WYWx1ZXMuZ2V0VW5pdFR5cGUoZSkpLCBbYSwgcl07XG4gICAgICAgICAgfVxuICAgICAgICAgIGZ1bmN0aW9uIGQoKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHtcbiAgICAgICAgICAgICAgbXlQYXJlbnQ6IG4ucGFyZW50Tm9kZSB8fCByLmJvZHksXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiB4LmdldFByb3BlcnR5VmFsdWUobiwgXCJwb3NpdGlvblwiKSxcbiAgICAgICAgICAgICAgZm9udFNpemU6IHguZ2V0UHJvcGVydHlWYWx1ZShuLCBcImZvbnRTaXplXCIpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGEgPSBlLnBvc2l0aW9uID09PSBOLmxhc3RQb3NpdGlvbiAmJiBlLm15UGFyZW50ID09PSBOLmxhc3RQYXJlbnQsXG4gICAgICAgICAgICAgICAgbyA9IGUuZm9udFNpemUgPT09IE4ubGFzdEZvbnRTaXplO1xuICAgICAgICAgICAgTi5sYXN0UGFyZW50ID0gZS5teVBhcmVudCwgTi5sYXN0UG9zaXRpb24gPSBlLnBvc2l0aW9uLCBOLmxhc3RGb250U2l6ZSA9IGUuZm9udFNpemU7XG4gICAgICAgICAgICB2YXIgcyA9IDEwMCxcbiAgICAgICAgICAgICAgICBsID0ge307XG4gICAgICAgICAgICBpZiAobyAmJiBhKVxuICAgICAgICAgICAgICBsLmVtVG9QeCA9IE4ubGFzdEVtVG9QeCwgbC5wZXJjZW50VG9QeFdpZHRoID0gTi5sYXN0UGVyY2VudFRvUHhXaWR0aCwgbC5wZXJjZW50VG9QeEhlaWdodCA9IE4ubGFzdFBlcmNlbnRUb1B4SGVpZ2h0O1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIHZhciB1ID0gaShuKS5pc1NWRyA/IHIuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJyZWN0XCIpIDogci5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICB2LmluaXQodSksIGUubXlQYXJlbnQuYXBwZW5kQ2hpbGQodSksICQuZWFjaChbXCJvdmVyZmxvd1wiLCBcIm92ZXJmbG93WFwiLCBcIm92ZXJmbG93WVwiXSwgZnVuY3Rpb24oZSwgdCkge1xuICAgICAgICAgICAgICAgIHYuQ1NTLnNldFByb3BlcnR5VmFsdWUodSwgdCwgXCJoaWRkZW5cIik7XG4gICAgICAgICAgICAgIH0pLCB2LkNTUy5zZXRQcm9wZXJ0eVZhbHVlKHUsIFwicG9zaXRpb25cIiwgZS5wb3NpdGlvbiksIHYuQ1NTLnNldFByb3BlcnR5VmFsdWUodSwgXCJmb250U2l6ZVwiLCBlLmZvbnRTaXplKSwgdi5DU1Muc2V0UHJvcGVydHlWYWx1ZSh1LCBcImJveFNpemluZ1wiLCBcImNvbnRlbnQtYm94XCIpLCAkLmVhY2goW1wibWluV2lkdGhcIiwgXCJtYXhXaWR0aFwiLCBcIndpZHRoXCIsIFwibWluSGVpZ2h0XCIsIFwibWF4SGVpZ2h0XCIsIFwiaGVpZ2h0XCJdLCBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgICAgICAgdi5DU1Muc2V0UHJvcGVydHlWYWx1ZSh1LCB0LCBzICsgXCIlXCIpO1xuICAgICAgICAgICAgICB9KSwgdi5DU1Muc2V0UHJvcGVydHlWYWx1ZSh1LCBcInBhZGRpbmdMZWZ0XCIsIHMgKyBcImVtXCIpLCBsLnBlcmNlbnRUb1B4V2lkdGggPSBOLmxhc3RQZXJjZW50VG9QeFdpZHRoID0gKHBhcnNlRmxvYXQoeC5nZXRQcm9wZXJ0eVZhbHVlKHUsIFwid2lkdGhcIiwgbnVsbCwgITApKSB8fCAxKSAvIHMsIGwucGVyY2VudFRvUHhIZWlnaHQgPSBOLmxhc3RQZXJjZW50VG9QeEhlaWdodCA9IChwYXJzZUZsb2F0KHguZ2V0UHJvcGVydHlWYWx1ZSh1LCBcImhlaWdodFwiLCBudWxsLCAhMCkpIHx8IDEpIC8gcywgbC5lbVRvUHggPSBOLmxhc3RFbVRvUHggPSAocGFyc2VGbG9hdCh4LmdldFByb3BlcnR5VmFsdWUodSwgXCJwYWRkaW5nTGVmdFwiKSkgfHwgMSkgLyBzLCBlLm15UGFyZW50LnJlbW92ZUNoaWxkKHUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGwgPT09IE4ucmVtVG9QeCAmJiAoTi5yZW1Ub1B4ID0gcGFyc2VGbG9hdCh4LmdldFByb3BlcnR5VmFsdWUoci5ib2R5LCBcImZvbnRTaXplXCIpKSB8fCAxNiksIG51bGwgPT09IE4udndUb1B4ICYmIChOLnZ3VG9QeCA9IHBhcnNlRmxvYXQodC5pbm5lcldpZHRoKSAvIDEwMCwgTi52aFRvUHggPSBwYXJzZUZsb2F0KHQuaW5uZXJIZWlnaHQpIC8gMTAwKSwgbC5yZW1Ub1B4ID0gTi5yZW1Ub1B4LCBsLnZ3VG9QeCA9IE4udndUb1B4LCBsLnZoVG9QeCA9IE4udmhUb1B4LCB2LmRlYnVnID49IDEgJiYgY29uc29sZS5sb2coXCJVbml0IHJhdGlvczogXCIgKyBKU09OLnN0cmluZ2lmeShsKSwgbiksIGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvLmJlZ2luICYmIDAgPT09IHcpXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBvLmJlZ2luLmNhbGwobSwgbSk7XG4gICAgICAgICAgICB9IGNhdGNoICh5KSB7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgeTtcbiAgICAgICAgICAgICAgfSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgaWYgKFwic2Nyb2xsXCIgPT09IGspIHtcbiAgICAgICAgICAgIHZhciBTID0gL154JC9pLnRlc3Qoby5heGlzKSA/IFwiTGVmdFwiIDogXCJUb3BcIixcbiAgICAgICAgICAgICAgICBWID0gcGFyc2VGbG9hdChvLm9mZnNldCkgfHwgMCxcbiAgICAgICAgICAgICAgICBDLFxuICAgICAgICAgICAgICAgIEEsXG4gICAgICAgICAgICAgICAgRjtcbiAgICAgICAgICAgIG8uY29udGFpbmVyID8gZy5pc1dyYXBwZWQoby5jb250YWluZXIpIHx8IGcuaXNOb2RlKG8uY29udGFpbmVyKSA/IChvLmNvbnRhaW5lciA9IG8uY29udGFpbmVyWzBdIHx8IG8uY29udGFpbmVyLCBDID0gby5jb250YWluZXJbXCJzY3JvbGxcIiArIFNdLCBGID0gQyArICQobikucG9zaXRpb24oKVtTLnRvTG93ZXJDYXNlKCldICsgVikgOiBvLmNvbnRhaW5lciA9IG51bGwgOiAoQyA9IHYuU3RhdGUuc2Nyb2xsQW5jaG9yW3YuU3RhdGVbXCJzY3JvbGxQcm9wZXJ0eVwiICsgU11dLCBBID0gdi5TdGF0ZS5zY3JvbGxBbmNob3Jbdi5TdGF0ZVtcInNjcm9sbFByb3BlcnR5XCIgKyAoXCJMZWZ0XCIgPT09IFMgPyBcIlRvcFwiIDogXCJMZWZ0XCIpXV0sIEYgPSAkKG4pLm9mZnNldCgpW1MudG9Mb3dlckNhc2UoKV0gKyBWKSwgcyA9IHtcbiAgICAgICAgICAgICAgc2Nyb2xsOiB7XG4gICAgICAgICAgICAgICAgcm9vdFByb3BlcnR5VmFsdWU6ICExLFxuICAgICAgICAgICAgICAgIHN0YXJ0VmFsdWU6IEMsXG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlOiBDLFxuICAgICAgICAgICAgICAgIGVuZFZhbHVlOiBGLFxuICAgICAgICAgICAgICAgIHVuaXRUeXBlOiBcIlwiLFxuICAgICAgICAgICAgICAgIGVhc2luZzogby5lYXNpbmcsXG4gICAgICAgICAgICAgICAgc2Nyb2xsRGF0YToge1xuICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBvLmNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogUyxcbiAgICAgICAgICAgICAgICAgIGFsdGVybmF0ZVZhbHVlOiBBXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBlbGVtZW50OiBuXG4gICAgICAgICAgICB9LCB2LmRlYnVnICYmIGNvbnNvbGUubG9nKFwidHdlZW5zQ29udGFpbmVyIChzY3JvbGwpOiBcIiwgcy5zY3JvbGwsIG4pO1xuICAgICAgICAgIH0gZWxzZSBpZiAoXCJyZXZlcnNlXCIgPT09IGspIHtcbiAgICAgICAgICAgIGlmICghaShuKS50d2VlbnNDb250YWluZXIpXG4gICAgICAgICAgICAgIHJldHVybiB2b2lkICQuZGVxdWV1ZShuLCBvLnF1ZXVlKTtcbiAgICAgICAgICAgIFwibm9uZVwiID09PSBpKG4pLm9wdHMuZGlzcGxheSAmJiAoaShuKS5vcHRzLmRpc3BsYXkgPSBcImF1dG9cIiksIFwiaGlkZGVuXCIgPT09IGkobikub3B0cy52aXNpYmlsaXR5ICYmIChpKG4pLm9wdHMudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiKSwgaShuKS5vcHRzLmxvb3AgPSAhMSwgaShuKS5vcHRzLmJlZ2luID0gbnVsbCwgaShuKS5vcHRzLmNvbXBsZXRlID0gbnVsbCwgYi5lYXNpbmcgfHwgZGVsZXRlIG8uZWFzaW5nLCBiLmR1cmF0aW9uIHx8IGRlbGV0ZSBvLmR1cmF0aW9uLCBvID0gJC5leHRlbmQoe30sIGkobikub3B0cywgbyk7XG4gICAgICAgICAgICB2YXIgRSA9ICQuZXh0ZW5kKCEwLCB7fSwgaShuKS50d2VlbnNDb250YWluZXIpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiBpbiBFKVxuICAgICAgICAgICAgICBpZiAoXCJlbGVtZW50XCIgIT09IGopIHtcbiAgICAgICAgICAgICAgICB2YXIgSCA9IEVbal0uc3RhcnRWYWx1ZTtcbiAgICAgICAgICAgICAgICBFW2pdLnN0YXJ0VmFsdWUgPSBFW2pdLmN1cnJlbnRWYWx1ZSA9IEVbal0uZW5kVmFsdWUsIEVbal0uZW5kVmFsdWUgPSBILCBnLmlzRW1wdHlPYmplY3QoYikgfHwgKEVbal0uZWFzaW5nID0gby5lYXNpbmcpLCB2LmRlYnVnICYmIGNvbnNvbGUubG9nKFwicmV2ZXJzZSB0d2VlbnNDb250YWluZXIgKFwiICsgaiArIFwiKTogXCIgKyBKU09OLnN0cmluZ2lmeShFW2pdKSwgbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMgPSBFO1xuICAgICAgICAgIH0gZWxzZSBpZiAoXCJzdGFydFwiID09PSBrKSB7XG4gICAgICAgICAgICB2YXIgRTtcbiAgICAgICAgICAgIGkobikudHdlZW5zQ29udGFpbmVyICYmIGkobikuaXNBbmltYXRpbmcgPT09ICEwICYmIChFID0gaShuKS50d2VlbnNDb250YWluZXIpLCAkLmVhY2goaCwgZnVuY3Rpb24oZSwgdCkge1xuICAgICAgICAgICAgICBpZiAoUmVnRXhwKFwiXlwiICsgeC5MaXN0cy5jb2xvcnMuam9pbihcIiR8XlwiKSArIFwiJFwiKS50ZXN0KGUpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHIgPSBwKHQsICEwKSxcbiAgICAgICAgICAgICAgICAgICAgbiA9IHJbMF0sXG4gICAgICAgICAgICAgICAgICAgIG8gPSByWzFdLFxuICAgICAgICAgICAgICAgICAgICBpID0gclsyXTtcbiAgICAgICAgICAgICAgICBpZiAoeC5SZWdFeC5pc0hleC50ZXN0KG4pKSB7XG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBzID0gW1wiUmVkXCIsIFwiR3JlZW5cIiwgXCJCbHVlXCJdLFxuICAgICAgICAgICAgICAgICAgICAgIGwgPSB4LlZhbHVlcy5oZXhUb1JnYihuKSxcbiAgICAgICAgICAgICAgICAgICAgICB1ID0gaSA/IHguVmFsdWVzLmhleFRvUmdiKGkpIDogYSxcbiAgICAgICAgICAgICAgICAgICAgICBjID0gMDsgYyA8IHMubGVuZ3RoOyBjKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBbbFtjXV07XG4gICAgICAgICAgICAgICAgICAgIG8gJiYgZi5wdXNoKG8pLCB1ICE9PSBhICYmIGYucHVzaCh1W2NdKSwgaFtlICsgc1tjXV0gPSBmO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZGVsZXRlIGhbZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvciAodmFyIFIgaW4gaCkge1xuICAgICAgICAgICAgICB2YXIgTyA9IHAoaFtSXSksXG4gICAgICAgICAgICAgICAgICB6ID0gT1swXSxcbiAgICAgICAgICAgICAgICAgIHEgPSBPWzFdLFxuICAgICAgICAgICAgICAgICAgTSA9IE9bMl07XG4gICAgICAgICAgICAgIFIgPSB4Lk5hbWVzLmNhbWVsQ2FzZShSKTtcbiAgICAgICAgICAgICAgdmFyIEkgPSB4Lkhvb2tzLmdldFJvb3QoUiksXG4gICAgICAgICAgICAgICAgICBCID0gITE7XG4gICAgICAgICAgICAgIGlmIChpKG4pLmlzU1ZHIHx8IFwidHdlZW5cIiA9PT0gSSB8fCB4Lk5hbWVzLnByZWZpeENoZWNrKEkpWzFdICE9PSAhMSB8fCB4Lk5vcm1hbGl6YXRpb25zLnJlZ2lzdGVyZWRbSV0gIT09IGEpIHtcbiAgICAgICAgICAgICAgICAoby5kaXNwbGF5ICE9PSBhICYmIG51bGwgIT09IG8uZGlzcGxheSAmJiBcIm5vbmVcIiAhPT0gby5kaXNwbGF5IHx8IG8udmlzaWJpbGl0eSAhPT0gYSAmJiBcImhpZGRlblwiICE9PSBvLnZpc2liaWxpdHkpICYmIC9vcGFjaXR5fGZpbHRlci8udGVzdChSKSAmJiAhTSAmJiAwICE9PSB6ICYmIChNID0gMCksIG8uX2NhY2hlVmFsdWVzICYmIEUgJiYgRVtSXSA/IChNID09PSBhICYmIChNID0gRVtSXS5lbmRWYWx1ZSArIEVbUl0udW5pdFR5cGUpLCBCID0gaShuKS5yb290UHJvcGVydHlWYWx1ZUNhY2hlW0ldKSA6IHguSG9va3MucmVnaXN0ZXJlZFtSXSA/IE0gPT09IGEgPyAoQiA9IHguZ2V0UHJvcGVydHlWYWx1ZShuLCBJKSwgTSA9IHguZ2V0UHJvcGVydHlWYWx1ZShuLCBSLCBCKSkgOiBCID0geC5Ib29rcy50ZW1wbGF0ZXNbSV1bMV0gOiBNID09PSBhICYmIChNID0geC5nZXRQcm9wZXJ0eVZhbHVlKG4sIFIpKTtcbiAgICAgICAgICAgICAgICB2YXIgVyxcbiAgICAgICAgICAgICAgICAgICAgRyxcbiAgICAgICAgICAgICAgICAgICAgRCxcbiAgICAgICAgICAgICAgICAgICAgWCA9ICExO1xuICAgICAgICAgICAgICAgIGlmIChXID0gZihSLCBNKSwgTSA9IFdbMF0sIEQgPSBXWzFdLCBXID0gZihSLCB6KSwgeiA9IFdbMF0ucmVwbGFjZSgvXihbKy1cXC8qXSk9LywgZnVuY3Rpb24oZSwgdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFggPSB0LCBcIlwiO1xuICAgICAgICAgICAgICAgIH0pLCBHID0gV1sxXSwgTSA9IHBhcnNlRmxvYXQoTSkgfHwgMCwgeiA9IHBhcnNlRmxvYXQoeikgfHwgMCwgXCIlXCIgPT09IEcgJiYgKC9eKGZvbnRTaXplfGxpbmVIZWlnaHQpJC8udGVzdChSKSA/ICh6IC89IDEwMCwgRyA9IFwiZW1cIikgOiAvXnNjYWxlLy50ZXN0KFIpID8gKHogLz0gMTAwLCBHID0gXCJcIikgOiAvKFJlZHxHcmVlbnxCbHVlKSQvaS50ZXN0KFIpICYmICh6ID0geiAvIDEwMCAqIDI1NSwgRyA9IFwiXCIpKSwgL1tcXC8qXS8udGVzdChYKSlcbiAgICAgICAgICAgICAgICAgIEcgPSBEO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKEQgIT09IEcgJiYgMCAhPT0gTSlcbiAgICAgICAgICAgICAgICAgIGlmICgwID09PSB6KVxuICAgICAgICAgICAgICAgICAgICBHID0gRDtcbiAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsID0gbCB8fCBkKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBZID0gL21hcmdpbnxwYWRkaW5nfGxlZnR8cmlnaHR8d2lkdGh8dGV4dHx3b3JkfGxldHRlci9pLnRlc3QoUikgfHwgL1gkLy50ZXN0KFIpIHx8IFwieFwiID09PSBSID8gXCJ4XCIgOiBcInlcIjtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChEKSB7XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIE0gKj0gXCJ4XCIgPT09IFkgPyBsLnBlcmNlbnRUb1B4V2lkdGggOiBsLnBlcmNlbnRUb1B4SGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInB4XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgTSAqPSBsW0QgKyBcIlRvUHhcIl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChHKSB7XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIE0gKj0gMSAvIChcInhcIiA9PT0gWSA/IGwucGVyY2VudFRvUHhXaWR0aCA6IGwucGVyY2VudFRvUHhIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInB4XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgTSAqPSAxIC8gbFtHICsgXCJUb1B4XCJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3dpdGNoIChYKSB7XG4gICAgICAgICAgICAgICAgICBjYXNlIFwiK1wiOlxuICAgICAgICAgICAgICAgICAgICB6ID0gTSArIHo7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgY2FzZSBcIi1cIjpcbiAgICAgICAgICAgICAgICAgICAgeiA9IE0gLSB6O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIGNhc2UgXCIqXCI6XG4gICAgICAgICAgICAgICAgICAgIHogPSBNICogejtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICBjYXNlIFwiL1wiOlxuICAgICAgICAgICAgICAgICAgICB6ID0gTSAvIHo7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNbUl0gPSB7XG4gICAgICAgICAgICAgICAgICByb290UHJvcGVydHlWYWx1ZTogQixcbiAgICAgICAgICAgICAgICAgIHN0YXJ0VmFsdWU6IE0sXG4gICAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWU6IE0sXG4gICAgICAgICAgICAgICAgICBlbmRWYWx1ZTogeixcbiAgICAgICAgICAgICAgICAgIHVuaXRUeXBlOiBHLFxuICAgICAgICAgICAgICAgICAgZWFzaW5nOiBxXG4gICAgICAgICAgICAgICAgfSwgdi5kZWJ1ZyAmJiBjb25zb2xlLmxvZyhcInR3ZWVuc0NvbnRhaW5lciAoXCIgKyBSICsgXCIpOiBcIiArIEpTT04uc3RyaW5naWZ5KHNbUl0pLCBuKTtcbiAgICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgdi5kZWJ1ZyAmJiBjb25zb2xlLmxvZyhcIlNraXBwaW5nIFtcIiArIEkgKyBcIl0gZHVlIHRvIGEgbGFjayBvZiBicm93c2VyIHN1cHBvcnQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcy5lbGVtZW50ID0gbjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcy5lbGVtZW50ICYmICh4LlZhbHVlcy5hZGRDbGFzcyhuLCBcInZlbG9jaXR5LWFuaW1hdGluZ1wiKSwgTC5wdXNoKHMpLCBcIlwiID09PSBvLnF1ZXVlICYmIChpKG4pLnR3ZWVuc0NvbnRhaW5lciA9IHMsIGkobikub3B0cyA9IG8pLCBpKG4pLmlzQW5pbWF0aW5nID0gITAsIHcgPT09IFAgLSAxID8gKHYuU3RhdGUuY2FsbHMucHVzaChbTCwgbSwgbywgbnVsbCwgVC5yZXNvbHZlcl0pLCB2LlN0YXRlLmlzVGlja2luZyA9PT0gITEgJiYgKHYuU3RhdGUuaXNUaWNraW5nID0gITAsIGMoKSkpIDogdysrKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbiA9IHRoaXMsXG4gICAgICAgICAgICBvID0gJC5leHRlbmQoe30sIHYuZGVmYXVsdHMsIGIpLFxuICAgICAgICAgICAgcyA9IHt9LFxuICAgICAgICAgICAgbDtcbiAgICAgICAgc3dpdGNoIChpKG4pID09PSBhICYmIHYuaW5pdChuKSwgcGFyc2VGbG9hdChvLmRlbGF5KSAmJiBvLnF1ZXVlICE9PSAhMSAmJiAkLnF1ZXVlKG4sIG8ucXVldWUsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICB2LnZlbG9jaXR5UXVldWVFbnRyeUZsYWcgPSAhMCwgaShuKS5kZWxheVRpbWVyID0ge1xuICAgICAgICAgICAgc2V0VGltZW91dDogc2V0VGltZW91dChlLCBwYXJzZUZsb2F0KG8uZGVsYXkpKSxcbiAgICAgICAgICAgIG5leHQ6IGVcbiAgICAgICAgICB9O1xuICAgICAgICB9KSwgby5kdXJhdGlvbi50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICBjYXNlIFwiZmFzdFwiOlxuICAgICAgICAgICAgby5kdXJhdGlvbiA9IDIwMDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgXCJub3JtYWxcIjpcbiAgICAgICAgICAgIG8uZHVyYXRpb24gPSB5O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBcInNsb3dcIjpcbiAgICAgICAgICAgIG8uZHVyYXRpb24gPSA2MDA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgby5kdXJhdGlvbiA9IHBhcnNlRmxvYXQoby5kdXJhdGlvbikgfHwgMTtcbiAgICAgICAgfVxuICAgICAgICB2Lm1vY2sgIT09ICExICYmICh2Lm1vY2sgPT09ICEwID8gby5kdXJhdGlvbiA9IG8uZGVsYXkgPSAxIDogKG8uZHVyYXRpb24gKj0gcGFyc2VGbG9hdCh2Lm1vY2spIHx8IDEsIG8uZGVsYXkgKj0gcGFyc2VGbG9hdCh2Lm1vY2spIHx8IDEpKSwgby5lYXNpbmcgPSB1KG8uZWFzaW5nLCBvLmR1cmF0aW9uKSwgby5iZWdpbiAmJiAhZy5pc0Z1bmN0aW9uKG8uYmVnaW4pICYmIChvLmJlZ2luID0gbnVsbCksIG8ucHJvZ3Jlc3MgJiYgIWcuaXNGdW5jdGlvbihvLnByb2dyZXNzKSAmJiAoby5wcm9ncmVzcyA9IG51bGwpLCBvLmNvbXBsZXRlICYmICFnLmlzRnVuY3Rpb24oby5jb21wbGV0ZSkgJiYgKG8uY29tcGxldGUgPSBudWxsKSwgby5kaXNwbGF5ICE9PSBhICYmIG51bGwgIT09IG8uZGlzcGxheSAmJiAoby5kaXNwbGF5ID0gby5kaXNwbGF5LnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKSwgXCJhdXRvXCIgPT09IG8uZGlzcGxheSAmJiAoby5kaXNwbGF5ID0gdi5DU1MuVmFsdWVzLmdldERpc3BsYXlUeXBlKG4pKSksIG8udmlzaWJpbGl0eSAhPT0gYSAmJiBudWxsICE9PSBvLnZpc2liaWxpdHkgJiYgKG8udmlzaWJpbGl0eSA9IG8udmlzaWJpbGl0eS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpLCBvLm1vYmlsZUhBID0gby5tb2JpbGVIQSAmJiB2LlN0YXRlLmlzTW9iaWxlICYmICF2LlN0YXRlLmlzR2luZ2VyYnJlYWQsIG8ucXVldWUgPT09ICExID8gby5kZWxheSA/IHNldFRpbWVvdXQoZSwgby5kZWxheSkgOiBlKCkgOiAkLnF1ZXVlKG4sIG8ucXVldWUsIGZ1bmN0aW9uKHQsIHIpIHtcbiAgICAgICAgICByZXR1cm4gciA9PT0gITAgPyAoVC5wcm9taXNlICYmIFQucmVzb2x2ZXIobSksICEwKSA6ICh2LnZlbG9jaXR5UXVldWVFbnRyeUZsYWcgPSAhMCwgdm9pZCBlKHQpKTtcbiAgICAgICAgfSksIFwiXCIgIT09IG8ucXVldWUgJiYgXCJmeFwiICE9PSBvLnF1ZXVlIHx8IFwiaW5wcm9ncmVzc1wiID09PSAkLnF1ZXVlKG4pWzBdIHx8ICQuZGVxdWV1ZShuKTtcbiAgICAgIH1cbiAgICAgIHZhciBzID0gYXJndW1lbnRzWzBdICYmIChhcmd1bWVudHNbMF0ucCB8fCAkLmlzUGxhaW5PYmplY3QoYXJndW1lbnRzWzBdLnByb3BlcnRpZXMpICYmICFhcmd1bWVudHNbMF0ucHJvcGVydGllcy5uYW1lcyB8fCBnLmlzU3RyaW5nKGFyZ3VtZW50c1swXS5wcm9wZXJ0aWVzKSksXG4gICAgICAgICAgbCxcbiAgICAgICAgICBmLFxuICAgICAgICAgIGQsXG4gICAgICAgICAgbSxcbiAgICAgICAgICBoLFxuICAgICAgICAgIGI7XG4gICAgICBpZiAoZy5pc1dyYXBwZWQodGhpcykgPyAobCA9ICExLCBkID0gMCwgbSA9IHRoaXMsIGYgPSB0aGlzKSA6IChsID0gITAsIGQgPSAxLCBtID0gcyA/IGFyZ3VtZW50c1swXS5lbGVtZW50cyB8fCBhcmd1bWVudHNbMF0uZSA6IGFyZ3VtZW50c1swXSksIG0gPSBvKG0pKSB7XG4gICAgICAgIHMgPyAoaCA9IGFyZ3VtZW50c1swXS5wcm9wZXJ0aWVzIHx8IGFyZ3VtZW50c1swXS5wLCBiID0gYXJndW1lbnRzWzBdLm9wdGlvbnMgfHwgYXJndW1lbnRzWzBdLm8pIDogKGggPSBhcmd1bWVudHNbZF0sIGIgPSBhcmd1bWVudHNbZCArIDFdKTtcbiAgICAgICAgdmFyIFAgPSBtLmxlbmd0aCxcbiAgICAgICAgICAgIHcgPSAwO1xuICAgICAgICBpZiAoIS9eKHN0b3B8ZmluaXNoKSQvaS50ZXN0KGgpICYmICEkLmlzUGxhaW5PYmplY3QoYikpIHtcbiAgICAgICAgICB2YXIgViA9IGQgKyAxO1xuICAgICAgICAgIGIgPSB7fTtcbiAgICAgICAgICBmb3IgKHZhciBDID0gVjsgQyA8IGFyZ3VtZW50cy5sZW5ndGg7IEMrKylcbiAgICAgICAgICAgIGcuaXNBcnJheShhcmd1bWVudHNbQ10pIHx8ICEvXihmYXN0fG5vcm1hbHxzbG93KSQvaS50ZXN0KGFyZ3VtZW50c1tDXSkgJiYgIS9eXFxkLy50ZXN0KGFyZ3VtZW50c1tDXSkgPyBnLmlzU3RyaW5nKGFyZ3VtZW50c1tDXSkgfHwgZy5pc0FycmF5KGFyZ3VtZW50c1tDXSkgPyBiLmVhc2luZyA9IGFyZ3VtZW50c1tDXSA6IGcuaXNGdW5jdGlvbihhcmd1bWVudHNbQ10pICYmIChiLmNvbXBsZXRlID0gYXJndW1lbnRzW0NdKSA6IGIuZHVyYXRpb24gPSBhcmd1bWVudHNbQ107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIFQgPSB7XG4gICAgICAgICAgcHJvbWlzZTogbnVsbCxcbiAgICAgICAgICByZXNvbHZlcjogbnVsbCxcbiAgICAgICAgICByZWplY3RlcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgICBsICYmIHYuUHJvbWlzZSAmJiAoVC5wcm9taXNlID0gbmV3IHYuUHJvbWlzZShmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgVC5yZXNvbHZlciA9IGUsIFQucmVqZWN0ZXIgPSB0O1xuICAgICAgICB9KSk7XG4gICAgICAgIHZhciBrO1xuICAgICAgICBzd2l0Y2ggKGgpIHtcbiAgICAgICAgICBjYXNlIFwic2Nyb2xsXCI6XG4gICAgICAgICAgICBrID0gXCJzY3JvbGxcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgXCJyZXZlcnNlXCI6XG4gICAgICAgICAgICBrID0gXCJyZXZlcnNlXCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIFwiZmluaXNoXCI6XG4gICAgICAgICAgY2FzZSBcInN0b3BcIjpcbiAgICAgICAgICAgICQuZWFjaChtLCBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgICAgIGkodCkgJiYgaSh0KS5kZWxheVRpbWVyICYmIChjbGVhclRpbWVvdXQoaSh0KS5kZWxheVRpbWVyLnNldFRpbWVvdXQpLCBpKHQpLmRlbGF5VGltZXIubmV4dCAmJiBpKHQpLmRlbGF5VGltZXIubmV4dCgpLCBkZWxldGUgaSh0KS5kZWxheVRpbWVyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIEEgPSBbXTtcbiAgICAgICAgICAgIHJldHVybiAkLmVhY2godi5TdGF0ZS5jYWxscywgZnVuY3Rpb24oZSwgdCkge1xuICAgICAgICAgICAgICB0ICYmICQuZWFjaCh0WzFdLCBmdW5jdGlvbihyLCBuKSB7XG4gICAgICAgICAgICAgICAgdmFyIG8gPSBiID09PSBhID8gXCJcIiA6IGI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG8gPT09ICEwIHx8IHRbMl0ucXVldWUgPT09IG8gfHwgYiA9PT0gYSAmJiB0WzJdLnF1ZXVlID09PSAhMSA/IHZvaWQgJC5lYWNoKG0sIGZ1bmN0aW9uKHIsIGEpIHtcbiAgICAgICAgICAgICAgICAgIGEgPT09IG4gJiYgKChiID09PSAhMCB8fCBnLmlzU3RyaW5nKGIpKSAmJiAoJC5lYWNoKCQucXVldWUoYSwgZy5pc1N0cmluZyhiKSA/IGIgOiBcIlwiKSwgZnVuY3Rpb24oZSwgdCkge1xuICAgICAgICAgICAgICAgICAgICBnLmlzRnVuY3Rpb24odCkgJiYgdChudWxsLCAhMCk7XG4gICAgICAgICAgICAgICAgICB9KSwgJC5xdWV1ZShhLCBnLmlzU3RyaW5nKGIpID8gYiA6IFwiXCIsIFtdKSksIFwic3RvcFwiID09PSBoID8gKGkoYSkgJiYgaShhKS50d2VlbnNDb250YWluZXIgJiYgbyAhPT0gITEgJiYgJC5lYWNoKGkoYSkudHdlZW5zQ29udGFpbmVyLCBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgICAgICAgICAgIHQuZW5kVmFsdWUgPSB0LmN1cnJlbnRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgIH0pLCBBLnB1c2goZSkpIDogXCJmaW5pc2hcIiA9PT0gaCAmJiAodFsyXS5kdXJhdGlvbiA9IDEpKTtcbiAgICAgICAgICAgICAgICB9KSA6ICEwO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pLCBcInN0b3BcIiA9PT0gaCAmJiAoJC5lYWNoKEEsIGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgICAgICAgICAgcCh0LCAhMCk7XG4gICAgICAgICAgICB9KSwgVC5wcm9taXNlICYmIFQucmVzb2x2ZXIobSkpLCBlKCk7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGlmICghJC5pc1BsYWluT2JqZWN0KGgpIHx8IGcuaXNFbXB0eU9iamVjdChoKSkge1xuICAgICAgICAgICAgICBpZiAoZy5pc1N0cmluZyhoKSAmJiB2LlJlZGlyZWN0c1toXSkge1xuICAgICAgICAgICAgICAgIHZhciBGID0gJC5leHRlbmQoe30sIGIpLFxuICAgICAgICAgICAgICAgICAgICBFID0gRi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaiA9IEYuZGVsYXkgfHwgMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gRi5iYWNrd2FyZHMgPT09ICEwICYmIChtID0gJC5leHRlbmQoITAsIFtdLCBtKS5yZXZlcnNlKCkpLCAkLmVhY2gobSwgZnVuY3Rpb24oZSwgdCkge1xuICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChGLnN0YWdnZXIpID8gRi5kZWxheSA9IGogKyBwYXJzZUZsb2F0KEYuc3RhZ2dlcikgKiBlIDogZy5pc0Z1bmN0aW9uKEYuc3RhZ2dlcikgJiYgKEYuZGVsYXkgPSBqICsgRi5zdGFnZ2VyLmNhbGwodCwgZSwgUCkpLCBGLmRyYWcgJiYgKEYuZHVyYXRpb24gPSBwYXJzZUZsb2F0KEUpIHx8ICgvXihjYWxsb3V0fHRyYW5zaXRpb24pLy50ZXN0KGgpID8gMWUzIDogeSksIEYuZHVyYXRpb24gPSBNYXRoLm1heChGLmR1cmF0aW9uICogKEYuYmFja3dhcmRzID8gMSAtIGUgLyBQIDogKGUgKyAxKSAvIFApLCAuNzUgKiBGLmR1cmF0aW9uLCAyMDApKSwgdi5SZWRpcmVjdHNbaF0uY2FsbCh0LCB0LCBGIHx8IHt9LCBlLCBQLCBtLCBULnByb21pc2UgPyBUIDogYSk7XG4gICAgICAgICAgICAgICAgfSksIGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgSCA9IFwiVmVsb2NpdHk6IEZpcnN0IGFyZ3VtZW50IChcIiArIGggKyBcIikgd2FzIG5vdCBhIHByb3BlcnR5IG1hcCwgYSBrbm93biBhY3Rpb24sIG9yIGEgcmVnaXN0ZXJlZCByZWRpcmVjdC4gQWJvcnRpbmcuXCI7XG4gICAgICAgICAgICAgIHJldHVybiBULnByb21pc2UgPyBULnJlamVjdGVyKG5ldyBFcnJvcihIKSkgOiBjb25zb2xlLmxvZyhIKSwgZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgayA9IFwic3RhcnRcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgTiA9IHtcbiAgICAgICAgICBsYXN0UGFyZW50OiBudWxsLFxuICAgICAgICAgIGxhc3RQb3NpdGlvbjogbnVsbCxcbiAgICAgICAgICBsYXN0Rm9udFNpemU6IG51bGwsXG4gICAgICAgICAgbGFzdFBlcmNlbnRUb1B4V2lkdGg6IG51bGwsXG4gICAgICAgICAgbGFzdFBlcmNlbnRUb1B4SGVpZ2h0OiBudWxsLFxuICAgICAgICAgIGxhc3RFbVRvUHg6IG51bGwsXG4gICAgICAgICAgcmVtVG9QeDogbnVsbCxcbiAgICAgICAgICB2d1RvUHg6IG51bGwsXG4gICAgICAgICAgdmhUb1B4OiBudWxsXG4gICAgICAgIH0sXG4gICAgICAgICAgICBMID0gW107XG4gICAgICAgICQuZWFjaChtLCBmdW5jdGlvbihlLCB0KSB7XG4gICAgICAgICAgZy5pc05vZGUodCkgJiYgbi5jYWxsKHQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIEYgPSAkLmV4dGVuZCh7fSwgdi5kZWZhdWx0cywgYiksXG4gICAgICAgICAgICBSO1xuICAgICAgICBpZiAoRi5sb29wID0gcGFyc2VJbnQoRi5sb29wKSwgUiA9IDIgKiBGLmxvb3AgLSAxLCBGLmxvb3ApXG4gICAgICAgICAgZm9yICh2YXIgTyA9IDA7IFIgPiBPOyBPKyspIHtcbiAgICAgICAgICAgIHZhciB6ID0ge1xuICAgICAgICAgICAgICBkZWxheTogRi5kZWxheSxcbiAgICAgICAgICAgICAgcHJvZ3Jlc3M6IEYucHJvZ3Jlc3NcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBPID09PSBSIC0gMSAmJiAoei5kaXNwbGF5ID0gRi5kaXNwbGF5LCB6LnZpc2liaWxpdHkgPSBGLnZpc2liaWxpdHksIHouY29tcGxldGUgPSBGLmNvbXBsZXRlKSwgUyhtLCBcInJldmVyc2VcIiwgeik7XG4gICAgICAgICAgfVxuICAgICAgICByZXR1cm4gZSgpO1xuICAgICAgfVxuICAgIH07XG4gICAgdiA9ICQuZXh0ZW5kKFMsIHYpLCB2LmFuaW1hdGUgPSBTO1xuICAgIHZhciBQID0gdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgZDtcbiAgICByZXR1cm4gdi5TdGF0ZS5pc01vYmlsZSB8fCByLmhpZGRlbiA9PT0gYSB8fCByLmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgci5oaWRkZW4gPyAoUCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgZSghMCk7XG4gICAgICAgIH0sIDE2KTtcbiAgICAgIH0sIGMoKSkgOiBQID0gdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgZDtcbiAgICB9KSwgZS5WZWxvY2l0eSA9IHYsIGUgIT09IHQgJiYgKGUuZm4udmVsb2NpdHkgPSBTLCBlLmZuLnZlbG9jaXR5LmRlZmF1bHRzID0gdi5kZWZhdWx0cyksICQuZWFjaChbXCJEb3duXCIsIFwiVXBcIl0sIGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgIHYuUmVkaXJlY3RzW1wic2xpZGVcIiArIHRdID0gZnVuY3Rpb24oZSwgciwgbiwgbywgaSwgcykge1xuICAgICAgICB2YXIgbCA9ICQuZXh0ZW5kKHt9LCByKSxcbiAgICAgICAgICAgIHUgPSBsLmJlZ2luLFxuICAgICAgICAgICAgYyA9IGwuY29tcGxldGUsXG4gICAgICAgICAgICBwID0ge1xuICAgICAgICAgICAgICBoZWlnaHQ6IFwiXCIsXG4gICAgICAgICAgICAgIG1hcmdpblRvcDogXCJcIixcbiAgICAgICAgICAgICAgbWFyZ2luQm90dG9tOiBcIlwiLFxuICAgICAgICAgICAgICBwYWRkaW5nVG9wOiBcIlwiLFxuICAgICAgICAgICAgICBwYWRkaW5nQm90dG9tOiBcIlwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZiA9IHt9O1xuICAgICAgICBsLmRpc3BsYXkgPT09IGEgJiYgKGwuZGlzcGxheSA9IFwiRG93blwiID09PSB0ID8gXCJpbmxpbmVcIiA9PT0gdi5DU1MuVmFsdWVzLmdldERpc3BsYXlUeXBlKGUpID8gXCJpbmxpbmUtYmxvY2tcIiA6IFwiYmxvY2tcIiA6IFwibm9uZVwiKSwgbC5iZWdpbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHUgJiYgdS5jYWxsKGksIGkpO1xuICAgICAgICAgIGZvciAodmFyIHIgaW4gcCkge1xuICAgICAgICAgICAgZltyXSA9IGUuc3R5bGVbcl07XG4gICAgICAgICAgICB2YXIgYSA9IHYuQ1NTLmdldFByb3BlcnR5VmFsdWUoZSwgcik7XG4gICAgICAgICAgICBwW3JdID0gXCJEb3duXCIgPT09IHQgPyBbYSwgMF0gOiBbMCwgYV07XG4gICAgICAgICAgfVxuICAgICAgICAgIGYub3ZlcmZsb3cgPSBlLnN0eWxlLm92ZXJmbG93LCBlLnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcbiAgICAgICAgfSwgbC5jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGZvciAodmFyIHQgaW4gZilcbiAgICAgICAgICAgIGUuc3R5bGVbdF0gPSBmW3RdO1xuICAgICAgICAgIGMgJiYgYy5jYWxsKGksIGkpLCBzICYmIHMucmVzb2x2ZXIoaSk7XG4gICAgICAgIH0sIHYoZSwgcCwgbCk7XG4gICAgICB9O1xuICAgIH0pLCAkLmVhY2goW1wiSW5cIiwgXCJPdXRcIl0sIGZ1bmN0aW9uKGUsIHQpIHtcbiAgICAgIHYuUmVkaXJlY3RzW1wiZmFkZVwiICsgdF0gPSBmdW5jdGlvbihlLCByLCBuLCBvLCBpLCBzKSB7XG4gICAgICAgIHZhciBsID0gJC5leHRlbmQoe30sIHIpLFxuICAgICAgICAgICAgdSA9IHtvcGFjaXR5OiBcIkluXCIgPT09IHQgPyAxIDogMH0sXG4gICAgICAgICAgICBjID0gbC5jb21wbGV0ZTtcbiAgICAgICAgbC5jb21wbGV0ZSA9IG4gIT09IG8gLSAxID8gbC5iZWdpbiA9IG51bGwgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjICYmIGMuY2FsbChpLCBpKSwgcyAmJiBzLnJlc29sdmVyKGkpO1xuICAgICAgICB9LCBsLmRpc3BsYXkgPT09IGEgJiYgKGwuZGlzcGxheSA9IFwiSW5cIiA9PT0gdCA/IFwiYXV0b1wiIDogXCJub25lXCIpLCB2KHRoaXMsIHUsIGwpO1xuICAgICAgfTtcbiAgICB9KSwgdjtcbiAgfSh3aW5kb3cualF1ZXJ5IHx8IHdpbmRvdy5aZXB0byB8fCB3aW5kb3csIHdpbmRvdywgZG9jdW1lbnQpO1xufSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vYm93ZXJfY29tcG9uZW50cy92ZWxvY2l0eS92ZWxvY2l0eS5taW4uanNcbiAqKiBtb2R1bGUgaWQgPSAzNVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiKGZ1bmN0aW9uKCkge1xuICB2YXIgQ29sb3IsXG4gICAgICBLLFxuICAgICAgUElUSElSRCxcbiAgICAgIFRXT1BJLFxuICAgICAgWCxcbiAgICAgIFksXG4gICAgICBaLFxuICAgICAgYmV6aWVyLFxuICAgICAgYnJld2VyLFxuICAgICAgY2hyb21hLFxuICAgICAgY2xpcF9yZ2IsXG4gICAgICBjb2xvcnMsXG4gICAgICBjb3MsXG4gICAgICBjc3MycmdiLFxuICAgICAgaGV4MnJnYixcbiAgICAgIGhzaTJyZ2IsXG4gICAgICBoc2wycmdiLFxuICAgICAgaHN2MnJnYixcbiAgICAgIGxhYjJsY2gsXG4gICAgICBsYWIycmdiLFxuICAgICAgbGFiX3h5eixcbiAgICAgIGxjaDJsYWIsXG4gICAgICBsY2gycmdiLFxuICAgICAgbGltaXQsXG4gICAgICBsdW1pbmFuY2UsXG4gICAgICBsdW1pbmFuY2VfeCxcbiAgICAgIHJnYjJoZXgsXG4gICAgICByZ2IyaHNpLFxuICAgICAgcmdiMmhzbCxcbiAgICAgIHJnYjJoc3YsXG4gICAgICByZ2IybGFiLFxuICAgICAgcmdiMmxjaCxcbiAgICAgIHJnYl94eXosXG4gICAgICByb290LFxuICAgICAgdHlwZSxcbiAgICAgIHVucGFjayxcbiAgICAgIHh5el9sYWIsXG4gICAgICB4eXpfcmdiLFxuICAgICAgX3JlZjtcbiAgY2hyb21hID0gZnVuY3Rpb24oeCwgeSwgeiwgbSkge1xuICAgIHJldHVybiBuZXcgQ29sb3IoeCwgeSwgeiwgbSk7XG4gIH07XG4gIGlmICgodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBtb2R1bGUgIT09IG51bGwpICYmIChtb2R1bGUuZXhwb3J0cyAhPSBudWxsKSkge1xuICAgIG1vZHVsZS5leHBvcnRzID0gY2hyb21hO1xuICB9XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW10sIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNocm9tYTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICByb290ID0gdHlwZW9mIGV4cG9ydHMgIT09IFwidW5kZWZpbmVkXCIgJiYgZXhwb3J0cyAhPT0gbnVsbCA/IGV4cG9ydHMgOiB0aGlzO1xuICAgIHJvb3QuY2hyb21hID0gY2hyb21hO1xuICB9XG4gIGNocm9tYS5jb2xvciA9IGZ1bmN0aW9uKHgsIHksIHosIG0pIHtcbiAgICByZXR1cm4gbmV3IENvbG9yKHgsIHksIHosIG0pO1xuICB9O1xuICBjaHJvbWEuaHNsID0gZnVuY3Rpb24oaCwgcywgbCwgYSkge1xuICAgIHJldHVybiBuZXcgQ29sb3IoaCwgcywgbCwgYSwgJ2hzbCcpO1xuICB9O1xuICBjaHJvbWEuaHN2ID0gZnVuY3Rpb24oaCwgcywgdiwgYSkge1xuICAgIHJldHVybiBuZXcgQ29sb3IoaCwgcywgdiwgYSwgJ2hzdicpO1xuICB9O1xuICBjaHJvbWEucmdiID0gZnVuY3Rpb24ociwgZywgYiwgYSkge1xuICAgIHJldHVybiBuZXcgQ29sb3IociwgZywgYiwgYSwgJ3JnYicpO1xuICB9O1xuICBjaHJvbWEuaGV4ID0gZnVuY3Rpb24oeCkge1xuICAgIHJldHVybiBuZXcgQ29sb3IoeCk7XG4gIH07XG4gIGNocm9tYS5jc3MgPSBmdW5jdGlvbih4KSB7XG4gICAgcmV0dXJuIG5ldyBDb2xvcih4KTtcbiAgfTtcbiAgY2hyb21hLmxhYiA9IGZ1bmN0aW9uKGwsIGEsIGIpIHtcbiAgICByZXR1cm4gbmV3IENvbG9yKGwsIGEsIGIsICdsYWInKTtcbiAgfTtcbiAgY2hyb21hLmxjaCA9IGZ1bmN0aW9uKGwsIGMsIGgpIHtcbiAgICByZXR1cm4gbmV3IENvbG9yKGwsIGMsIGgsICdsY2gnKTtcbiAgfTtcbiAgY2hyb21hLmhzaSA9IGZ1bmN0aW9uKGgsIHMsIGkpIHtcbiAgICByZXR1cm4gbmV3IENvbG9yKGgsIHMsIGksICdoc2knKTtcbiAgfTtcbiAgY2hyb21hLmdsID0gZnVuY3Rpb24ociwgZywgYiwgYSkge1xuICAgIHJldHVybiBuZXcgQ29sb3IociAqIDI1NSwgZyAqIDI1NSwgYiAqIDI1NSwgYSwgJ2dsJyk7XG4gIH07XG4gIGNocm9tYS5pbnRlcnBvbGF0ZSA9IGZ1bmN0aW9uKGEsIGIsIGYsIG0pIHtcbiAgICBpZiAoKGEgPT0gbnVsbCkgfHwgKGIgPT0gbnVsbCkpIHtcbiAgICAgIHJldHVybiAnIzAwMCc7XG4gICAgfVxuICAgIGlmICh0eXBlKGEpID09PSAnc3RyaW5nJykge1xuICAgICAgYSA9IG5ldyBDb2xvcihhKTtcbiAgICB9XG4gICAgaWYgKHR5cGUoYikgPT09ICdzdHJpbmcnKSB7XG4gICAgICBiID0gbmV3IENvbG9yKGIpO1xuICAgIH1cbiAgICByZXR1cm4gYS5pbnRlcnBvbGF0ZShmLCBiLCBtKTtcbiAgfTtcbiAgY2hyb21hLm1peCA9IGNocm9tYS5pbnRlcnBvbGF0ZTtcbiAgY2hyb21hLmNvbnRyYXN0ID0gZnVuY3Rpb24oYSwgYikge1xuICAgIHZhciBsMSxcbiAgICAgICAgbDI7XG4gICAgaWYgKHR5cGUoYSkgPT09ICdzdHJpbmcnKSB7XG4gICAgICBhID0gbmV3IENvbG9yKGEpO1xuICAgIH1cbiAgICBpZiAodHlwZShiKSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGIgPSBuZXcgQ29sb3IoYik7XG4gICAgfVxuICAgIGwxID0gYS5sdW1pbmFuY2UoKTtcbiAgICBsMiA9IGIubHVtaW5hbmNlKCk7XG4gICAgaWYgKGwxID4gbDIpIHtcbiAgICAgIHJldHVybiAobDEgKyAwLjA1KSAvIChsMiArIDAuMDUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gKGwyICsgMC4wNSkgLyAobDEgKyAwLjA1KTtcbiAgICB9XG4gIH07XG4gIGNocm9tYS5sdW1pbmFuY2UgPSBmdW5jdGlvbihjb2xvcikge1xuICAgIHJldHVybiBjaHJvbWEoY29sb3IpLmx1bWluYW5jZSgpO1xuICB9O1xuICBjaHJvbWEuX0NvbG9yID0gQ29sb3I7XG4gIENvbG9yID0gKGZ1bmN0aW9uKCkge1xuICAgIGZ1bmN0aW9uIENvbG9yKCkge1xuICAgICAgdmFyIGEsXG4gICAgICAgICAgYXJnLFxuICAgICAgICAgIGFyZ3MsXG4gICAgICAgICAgbSxcbiAgICAgICAgICBtZSxcbiAgICAgICAgICBtZV9yZ2IsXG4gICAgICAgICAgeCxcbiAgICAgICAgICB5LFxuICAgICAgICAgIHosXG4gICAgICAgICAgX2ksXG4gICAgICAgICAgX2xlbixcbiAgICAgICAgICBfcmVmLFxuICAgICAgICAgIF9yZWYxLFxuICAgICAgICAgIF9yZWYyLFxuICAgICAgICAgIF9yZWYzO1xuICAgICAgbWUgPSB0aGlzO1xuICAgICAgYXJncyA9IFtdO1xuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcbiAgICAgICAgYXJnID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgaWYgKGFyZyAhPSBudWxsKSB7XG4gICAgICAgICAgYXJncy5wdXNoKGFyZyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBfcmVmID0gWzI1NSwgMCwgMjU1LCAxLCAncmdiJ10sIHggPSBfcmVmWzBdLCB5ID0gX3JlZlsxXSwgeiA9IF9yZWZbMl0sIGEgPSBfcmVmWzNdLCBtID0gX3JlZls0XTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZShhcmdzWzBdKSA9PT0gXCJhcnJheVwiKSB7XG4gICAgICAgIGlmIChhcmdzWzBdLmxlbmd0aCA9PT0gMykge1xuICAgICAgICAgIF9yZWYxID0gYXJnc1swXSwgeCA9IF9yZWYxWzBdLCB5ID0gX3JlZjFbMV0sIHogPSBfcmVmMVsyXTtcbiAgICAgICAgICBhID0gMTtcbiAgICAgICAgfSBlbHNlIGlmIChhcmdzWzBdLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgIF9yZWYyID0gYXJnc1swXSwgeCA9IF9yZWYyWzBdLCB5ID0gX3JlZjJbMV0sIHogPSBfcmVmMlsyXSwgYSA9IF9yZWYyWzNdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93ICd1bmtub3duIGlucHV0IGFyZ3VtZW50JztcbiAgICAgICAgfVxuICAgICAgICBtID0gYXJnc1sxXTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZShhcmdzWzBdKSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB4ID0gYXJnc1swXTtcbiAgICAgICAgbSA9ICdoZXgnO1xuICAgICAgfSBlbHNlIGlmICh0eXBlKGFyZ3NbMF0pID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIF9yZWYzID0gYXJnc1swXS5fcmdiLCB4ID0gX3JlZjNbMF0sIHkgPSBfcmVmM1sxXSwgeiA9IF9yZWYzWzJdLCBhID0gX3JlZjNbM107XG4gICAgICAgIG0gPSAncmdiJztcbiAgICAgIH0gZWxzZSBpZiAoYXJncy5sZW5ndGggPj0gMykge1xuICAgICAgICB4ID0gYXJnc1swXTtcbiAgICAgICAgeSA9IGFyZ3NbMV07XG4gICAgICAgIHogPSBhcmdzWzJdO1xuICAgICAgfVxuICAgICAgaWYgKGFyZ3MubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIG0gPSAncmdiJztcbiAgICAgICAgYSA9IDE7XG4gICAgICB9IGVsc2UgaWYgKGFyZ3MubGVuZ3RoID09PSA0KSB7XG4gICAgICAgIGlmICh0eXBlKGFyZ3NbM10pID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgbSA9IGFyZ3NbM107XG4gICAgICAgICAgYSA9IDE7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZShhcmdzWzNdKSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgIG0gPSAncmdiJztcbiAgICAgICAgICBhID0gYXJnc1szXTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChhcmdzLmxlbmd0aCA9PT0gNSkge1xuICAgICAgICBhID0gYXJnc1szXTtcbiAgICAgICAgbSA9IGFyZ3NbNF07XG4gICAgICB9XG4gICAgICBpZiAoYSA9PSBudWxsKSB7XG4gICAgICAgIGEgPSAxO1xuICAgICAgfVxuICAgICAgaWYgKG0gPT09ICdyZ2InKSB7XG4gICAgICAgIG1lLl9yZ2IgPSBbeCwgeSwgeiwgYV07XG4gICAgICB9IGVsc2UgaWYgKG0gPT09ICdnbCcpIHtcbiAgICAgICAgbWUuX3JnYiA9IFt4ICogMjU1LCB5ICogMjU1LCB6ICogMjU1LCBhXTtcbiAgICAgIH0gZWxzZSBpZiAobSA9PT0gJ2hzbCcpIHtcbiAgICAgICAgbWUuX3JnYiA9IGhzbDJyZ2IoeCwgeSwgeik7XG4gICAgICAgIG1lLl9yZ2JbM10gPSBhO1xuICAgICAgfSBlbHNlIGlmIChtID09PSAnaHN2Jykge1xuICAgICAgICBtZS5fcmdiID0gaHN2MnJnYih4LCB5LCB6KTtcbiAgICAgICAgbWUuX3JnYlszXSA9IGE7XG4gICAgICB9IGVsc2UgaWYgKG0gPT09ICdoZXgnKSB7XG4gICAgICAgIG1lLl9yZ2IgPSBoZXgycmdiKHgpO1xuICAgICAgfSBlbHNlIGlmIChtID09PSAnbGFiJykge1xuICAgICAgICBtZS5fcmdiID0gbGFiMnJnYih4LCB5LCB6KTtcbiAgICAgICAgbWUuX3JnYlszXSA9IGE7XG4gICAgICB9IGVsc2UgaWYgKG0gPT09ICdsY2gnKSB7XG4gICAgICAgIG1lLl9yZ2IgPSBsY2gycmdiKHgsIHksIHopO1xuICAgICAgICBtZS5fcmdiWzNdID0gYTtcbiAgICAgIH0gZWxzZSBpZiAobSA9PT0gJ2hzaScpIHtcbiAgICAgICAgbWUuX3JnYiA9IGhzaTJyZ2IoeCwgeSwgeik7XG4gICAgICAgIG1lLl9yZ2JbM10gPSBhO1xuICAgICAgfVxuICAgICAgbWVfcmdiID0gY2xpcF9yZ2IobWUuX3JnYik7XG4gICAgfVxuICAgIENvbG9yLnByb3RvdHlwZS5yZ2IgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZ2Iuc2xpY2UoMCwgMyk7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUucmdiYSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3JnYjtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5oZXggPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiByZ2IyaGV4KHRoaXMuX3JnYik7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLm5hbWUoKTtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5oc2wgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiByZ2IyaHNsKHRoaXMuX3JnYik7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUuaHN2ID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcmdiMmhzdih0aGlzLl9yZ2IpO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLmxhYiA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJnYjJsYWIodGhpcy5fcmdiKTtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5sY2ggPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiByZ2IybGNoKHRoaXMuX3JnYik7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUuaHNpID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcmdiMmhzaSh0aGlzLl9yZ2IpO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLmdsID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gW3RoaXMuX3JnYlswXSAvIDI1NSwgdGhpcy5fcmdiWzFdIC8gMjU1LCB0aGlzLl9yZ2JbMl0gLyAyNTUsIHRoaXMuX3JnYlszXV07XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUubHVtaW5hbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbHVtaW5hbmNlKHRoaXMuX3JnYik7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUubmFtZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGgsXG4gICAgICAgICAgaztcbiAgICAgIGggPSB0aGlzLmhleCgpO1xuICAgICAgZm9yIChrIGluIGNocm9tYS5jb2xvcnMpIHtcbiAgICAgICAgaWYgKGggPT09IGNocm9tYS5jb2xvcnNba10pIHtcbiAgICAgICAgICByZXR1cm4gaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGg7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUuYWxwaGEgPSBmdW5jdGlvbihhbHBoYSkge1xuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5fcmdiWzNdID0gYWxwaGE7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX3JnYlszXTtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5jc3MgPSBmdW5jdGlvbihtb2RlKSB7XG4gICAgICB2YXIgaHNsLFxuICAgICAgICAgIG1lLFxuICAgICAgICAgIHJnYixcbiAgICAgICAgICBybmQ7XG4gICAgICBpZiAobW9kZSA9PSBudWxsKSB7XG4gICAgICAgIG1vZGUgPSAncmdiJztcbiAgICAgIH1cbiAgICAgIG1lID0gdGhpcztcbiAgICAgIHJnYiA9IG1lLl9yZ2I7XG4gICAgICBpZiAobW9kZS5sZW5ndGggPT09IDMgJiYgcmdiWzNdIDwgMSkge1xuICAgICAgICBtb2RlICs9ICdhJztcbiAgICAgIH1cbiAgICAgIGlmIChtb2RlID09PSAncmdiJykge1xuICAgICAgICByZXR1cm4gbW9kZSArICcoJyArIHJnYi5zbGljZSgwLCAzKS5qb2luKCcsJykgKyAnKSc7XG4gICAgICB9IGVsc2UgaWYgKG1vZGUgPT09ICdyZ2JhJykge1xuICAgICAgICByZXR1cm4gbW9kZSArICcoJyArIHJnYi5qb2luKCcsJykgKyAnKSc7XG4gICAgICB9IGVsc2UgaWYgKG1vZGUgPT09ICdoc2wnIHx8IG1vZGUgPT09ICdoc2xhJykge1xuICAgICAgICBoc2wgPSBtZS5oc2woKTtcbiAgICAgICAgcm5kID0gZnVuY3Rpb24oYSkge1xuICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKGEgKiAxMDApIC8gMTAwO1xuICAgICAgICB9O1xuICAgICAgICBoc2xbMF0gPSBybmQoaHNsWzBdKTtcbiAgICAgICAgaHNsWzFdID0gcm5kKGhzbFsxXSAqIDEwMCkgKyAnJSc7XG4gICAgICAgIGhzbFsyXSA9IHJuZChoc2xbMl0gKiAxMDApICsgJyUnO1xuICAgICAgICBpZiAobW9kZS5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgICBoc2xbM10gPSByZ2JbM107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1vZGUgKyAnKCcgKyBoc2wuam9pbignLCcpICsgJyknO1xuICAgICAgfVxuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLmludGVycG9sYXRlID0gZnVuY3Rpb24oZiwgY29sLCBtKSB7XG4gICAgICB2YXIgZGgsXG4gICAgICAgICAgaHVlLFxuICAgICAgICAgIGh1ZTAsXG4gICAgICAgICAgaHVlMSxcbiAgICAgICAgICBsYnYsXG4gICAgICAgICAgbGJ2MCxcbiAgICAgICAgICBsYnYxLFxuICAgICAgICAgIG1lLFxuICAgICAgICAgIHJlcyxcbiAgICAgICAgICBzYXQsXG4gICAgICAgICAgc2F0MCxcbiAgICAgICAgICBzYXQxLFxuICAgICAgICAgIHh5ejAsXG4gICAgICAgICAgeHl6MTtcbiAgICAgIG1lID0gdGhpcztcbiAgICAgIGlmIChtID09IG51bGwpIHtcbiAgICAgICAgbSA9ICdyZ2InO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGUoY29sKSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBjb2wgPSBuZXcgQ29sb3IoY29sKTtcbiAgICAgIH1cbiAgICAgIGlmIChtID09PSAnaHNsJyB8fCBtID09PSAnaHN2JyB8fCBtID09PSAnbGNoJyB8fCBtID09PSAnaHNpJykge1xuICAgICAgICBpZiAobSA9PT0gJ2hzbCcpIHtcbiAgICAgICAgICB4eXowID0gbWUuaHNsKCk7XG4gICAgICAgICAgeHl6MSA9IGNvbC5oc2woKTtcbiAgICAgICAgfSBlbHNlIGlmIChtID09PSAnaHN2Jykge1xuICAgICAgICAgIHh5ejAgPSBtZS5oc3YoKTtcbiAgICAgICAgICB4eXoxID0gY29sLmhzdigpO1xuICAgICAgICB9IGVsc2UgaWYgKG0gPT09ICdoc2knKSB7XG4gICAgICAgICAgeHl6MCA9IG1lLmhzaSgpO1xuICAgICAgICAgIHh5ejEgPSBjb2wuaHNpKCk7XG4gICAgICAgIH0gZWxzZSBpZiAobSA9PT0gJ2xjaCcpIHtcbiAgICAgICAgICB4eXowID0gbWUubGNoKCk7XG4gICAgICAgICAgeHl6MSA9IGNvbC5sY2goKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobS5zdWJzdHIoMCwgMSkgPT09ICdoJykge1xuICAgICAgICAgIGh1ZTAgPSB4eXowWzBdLCBzYXQwID0geHl6MFsxXSwgbGJ2MCA9IHh5ejBbMl07XG4gICAgICAgICAgaHVlMSA9IHh5ejFbMF0sIHNhdDEgPSB4eXoxWzFdLCBsYnYxID0geHl6MVsyXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsYnYwID0geHl6MFswXSwgc2F0MCA9IHh5ejBbMV0sIGh1ZTAgPSB4eXowWzJdO1xuICAgICAgICAgIGxidjEgPSB4eXoxWzBdLCBzYXQxID0geHl6MVsxXSwgaHVlMSA9IHh5ejFbMl07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc05hTihodWUwKSAmJiAhaXNOYU4oaHVlMSkpIHtcbiAgICAgICAgICBpZiAoaHVlMSA+IGh1ZTAgJiYgaHVlMSAtIGh1ZTAgPiAxODApIHtcbiAgICAgICAgICAgIGRoID0gaHVlMSAtIChodWUwICsgMzYwKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGh1ZTEgPCBodWUwICYmIGh1ZTAgLSBodWUxID4gMTgwKSB7XG4gICAgICAgICAgICBkaCA9IGh1ZTEgKyAzNjAgLSBodWUwO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkaCA9IGh1ZTEgLSBodWUwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBodWUgPSBodWUwICsgZiAqIGRoO1xuICAgICAgICB9IGVsc2UgaWYgKCFpc05hTihodWUwKSkge1xuICAgICAgICAgIGh1ZSA9IGh1ZTA7XG4gICAgICAgICAgaWYgKChsYnYxID09PSAxIHx8IGxidjEgPT09IDApICYmIG0gIT09ICdoc3YnKSB7XG4gICAgICAgICAgICBzYXQgPSBzYXQwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghaXNOYU4oaHVlMSkpIHtcbiAgICAgICAgICBodWUgPSBodWUxO1xuICAgICAgICAgIGlmICgobGJ2MCA9PT0gMSB8fCBsYnYwID09PSAwKSAmJiBtICE9PSAnaHN2Jykge1xuICAgICAgICAgICAgc2F0ID0gc2F0MTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaHVlID0gTnVtYmVyLk5hTjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2F0ID09IG51bGwpIHtcbiAgICAgICAgICBzYXQgPSBzYXQwICsgZiAqIChzYXQxIC0gc2F0MCk7XG4gICAgICAgIH1cbiAgICAgICAgbGJ2ID0gbGJ2MCArIGYgKiAobGJ2MSAtIGxidjApO1xuICAgICAgICBpZiAobS5zdWJzdHIoMCwgMSkgPT09ICdoJykge1xuICAgICAgICAgIHJlcyA9IG5ldyBDb2xvcihodWUsIHNhdCwgbGJ2LCBtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXMgPSBuZXcgQ29sb3IobGJ2LCBzYXQsIGh1ZSwgbSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAobSA9PT0gJ3JnYicpIHtcbiAgICAgICAgeHl6MCA9IG1lLl9yZ2I7XG4gICAgICAgIHh5ejEgPSBjb2wuX3JnYjtcbiAgICAgICAgcmVzID0gbmV3IENvbG9yKHh5ejBbMF0gKyBmICogKHh5ejFbMF0gLSB4eXowWzBdKSwgeHl6MFsxXSArIGYgKiAoeHl6MVsxXSAtIHh5ejBbMV0pLCB4eXowWzJdICsgZiAqICh4eXoxWzJdIC0geHl6MFsyXSksIG0pO1xuICAgICAgfSBlbHNlIGlmIChtID09PSAnbGFiJykge1xuICAgICAgICB4eXowID0gbWUubGFiKCk7XG4gICAgICAgIHh5ejEgPSBjb2wubGFiKCk7XG4gICAgICAgIHJlcyA9IG5ldyBDb2xvcih4eXowWzBdICsgZiAqICh4eXoxWzBdIC0geHl6MFswXSksIHh5ejBbMV0gKyBmICogKHh5ejFbMV0gLSB4eXowWzFdKSwgeHl6MFsyXSArIGYgKiAoeHl6MVsyXSAtIHh5ejBbMl0pLCBtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IFwiY29sb3IgbW9kZSBcIiArIG0gKyBcIiBpcyBub3Qgc3VwcG9ydGVkXCI7XG4gICAgICB9XG4gICAgICByZXMuYWxwaGEobWUuYWxwaGEoKSArIGYgKiAoY29sLmFscGhhKCkgLSBtZS5hbHBoYSgpKSk7XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLnByZW11bHRpcGx5ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYSxcbiAgICAgICAgICByZ2I7XG4gICAgICByZ2IgPSB0aGlzLnJnYigpO1xuICAgICAgYSA9IHRoaXMuYWxwaGEoKTtcbiAgICAgIHJldHVybiBjaHJvbWEocmdiWzBdICogYSwgcmdiWzFdICogYSwgcmdiWzJdICogYSwgYSk7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUuZGFya2VuID0gZnVuY3Rpb24oYW1vdW50KSB7XG4gICAgICB2YXIgbGNoLFxuICAgICAgICAgIG1lO1xuICAgICAgaWYgKGFtb3VudCA9PSBudWxsKSB7XG4gICAgICAgIGFtb3VudCA9IDIwO1xuICAgICAgfVxuICAgICAgbWUgPSB0aGlzO1xuICAgICAgbGNoID0gbWUubGNoKCk7XG4gICAgICBsY2hbMF0gLT0gYW1vdW50O1xuICAgICAgcmV0dXJuIGNocm9tYS5sY2gobGNoKS5hbHBoYShtZS5hbHBoYSgpKTtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5kYXJrZXIgPSBmdW5jdGlvbihhbW91bnQpIHtcbiAgICAgIHJldHVybiB0aGlzLmRhcmtlbihhbW91bnQpO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLmJyaWdodGVuID0gZnVuY3Rpb24oYW1vdW50KSB7XG4gICAgICBpZiAoYW1vdW50ID09IG51bGwpIHtcbiAgICAgICAgYW1vdW50ID0gMjA7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5kYXJrZW4oLWFtb3VudCk7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUuYnJpZ2h0ZXIgPSBmdW5jdGlvbihhbW91bnQpIHtcbiAgICAgIHJldHVybiB0aGlzLmJyaWdodGVuKGFtb3VudCk7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUuc2F0dXJhdGUgPSBmdW5jdGlvbihhbW91bnQpIHtcbiAgICAgIHZhciBsY2gsXG4gICAgICAgICAgbWU7XG4gICAgICBpZiAoYW1vdW50ID09IG51bGwpIHtcbiAgICAgICAgYW1vdW50ID0gMjA7XG4gICAgICB9XG4gICAgICBtZSA9IHRoaXM7XG4gICAgICBsY2ggPSBtZS5sY2goKTtcbiAgICAgIGxjaFsxXSArPSBhbW91bnQ7XG4gICAgICByZXR1cm4gY2hyb21hLmxjaChsY2gpLmFscGhhKG1lLmFscGhhKCkpO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLmRlc2F0dXJhdGUgPSBmdW5jdGlvbihhbW91bnQpIHtcbiAgICAgIGlmIChhbW91bnQgPT0gbnVsbCkge1xuICAgICAgICBhbW91bnQgPSAyMDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnNhdHVyYXRlKC1hbW91bnQpO1xuICAgIH07XG4gICAgcmV0dXJuIENvbG9yO1xuICB9KSgpO1xuICBjbGlwX3JnYiA9IGZ1bmN0aW9uKHJnYikge1xuICAgIHZhciBpO1xuICAgIGZvciAoaSBpbiByZ2IpIHtcbiAgICAgIGlmIChpIDwgMykge1xuICAgICAgICBpZiAocmdiW2ldIDwgMCkge1xuICAgICAgICAgIHJnYltpXSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJnYltpXSA+IDI1NSkge1xuICAgICAgICAgIHJnYltpXSA9IDI1NTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChpID09PSAzKSB7XG4gICAgICAgIGlmIChyZ2JbaV0gPCAwKSB7XG4gICAgICAgICAgcmdiW2ldID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmdiW2ldID4gMSkge1xuICAgICAgICAgIHJnYltpXSA9IDE7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJnYjtcbiAgfTtcbiAgY3NzMnJnYiA9IGZ1bmN0aW9uKGNzcykge1xuICAgIHZhciBoc2wsXG4gICAgICAgIGksXG4gICAgICAgIG0sXG4gICAgICAgIHJnYixcbiAgICAgICAgX2ksXG4gICAgICAgIF9qLFxuICAgICAgICBfayxcbiAgICAgICAgX2w7XG4gICAgY3NzID0gY3NzLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKChjaHJvbWEuY29sb3JzICE9IG51bGwpICYmIGNocm9tYS5jb2xvcnNbY3NzXSkge1xuICAgICAgcmV0dXJuIGhleDJyZ2IoY2hyb21hLmNvbG9yc1tjc3NdKTtcbiAgICB9XG4gICAgaWYgKG0gPSBjc3MubWF0Y2goL3JnYlxcKFxccyooXFwtP1xcZCspLFxccyooXFwtP1xcZCspXFxzKixcXHMqKFxcLT9cXGQrKVxccypcXCkvKSkge1xuICAgICAgcmdiID0gbS5zbGljZSgxLCA0KTtcbiAgICAgIGZvciAoaSA9IF9pID0gMDsgX2kgPD0gMjsgaSA9ICsrX2kpIHtcbiAgICAgICAgcmdiW2ldID0gK3JnYltpXTtcbiAgICAgIH1cbiAgICAgIHJnYlszXSA9IDE7XG4gICAgfSBlbHNlIGlmIChtID0gY3NzLm1hdGNoKC9yZ2JhXFwoXFxzKihcXC0/XFxkKyksXFxzKihcXC0/XFxkKylcXHMqLFxccyooXFwtP1xcZCspXFxzKixcXHMqKFswMV18WzAxXT9cXC5cXGQrKVxcKS8pKSB7XG4gICAgICByZ2IgPSBtLnNsaWNlKDEsIDUpO1xuICAgICAgZm9yIChpID0gX2ogPSAwOyBfaiA8PSAzOyBpID0gKytfaikge1xuICAgICAgICByZ2JbaV0gPSArcmdiW2ldO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAobSA9IGNzcy5tYXRjaCgvcmdiXFwoXFxzKihcXC0/XFxkKyg/OlxcLlxcZCspPyklLFxccyooXFwtP1xcZCsoPzpcXC5cXGQrKT8pJVxccyosXFxzKihcXC0/XFxkKyg/OlxcLlxcZCspPyklXFxzKlxcKS8pKSB7XG4gICAgICByZ2IgPSBtLnNsaWNlKDEsIDQpO1xuICAgICAgZm9yIChpID0gX2sgPSAwOyBfayA8PSAyOyBpID0gKytfaykge1xuICAgICAgICByZ2JbaV0gPSBNYXRoLnJvdW5kKHJnYltpXSAqIDIuNTUpO1xuICAgICAgfVxuICAgICAgcmdiWzNdID0gMTtcbiAgICB9IGVsc2UgaWYgKG0gPSBjc3MubWF0Y2goL3JnYmFcXChcXHMqKFxcLT9cXGQrKD86XFwuXFxkKyk/KSUsXFxzKihcXC0/XFxkKyg/OlxcLlxcZCspPyklXFxzKixcXHMqKFxcLT9cXGQrKD86XFwuXFxkKyk/KSVcXHMqLFxccyooWzAxXXxbMDFdP1xcLlxcZCspXFwpLykpIHtcbiAgICAgIHJnYiA9IG0uc2xpY2UoMSwgNSk7XG4gICAgICBmb3IgKGkgPSBfbCA9IDA7IF9sIDw9IDI7IGkgPSArK19sKSB7XG4gICAgICAgIHJnYltpXSA9IE1hdGgucm91bmQocmdiW2ldICogMi41NSk7XG4gICAgICB9XG4gICAgICByZ2JbM10gPSArcmdiWzNdO1xuICAgIH0gZWxzZSBpZiAobSA9IGNzcy5tYXRjaCgvaHNsXFwoXFxzKihcXC0/XFxkKyg/OlxcLlxcZCspPyksXFxzKihcXC0/XFxkKyg/OlxcLlxcZCspPyklXFxzKixcXHMqKFxcLT9cXGQrKD86XFwuXFxkKyk/KSVcXHMqXFwpLykpIHtcbiAgICAgIGhzbCA9IG0uc2xpY2UoMSwgNCk7XG4gICAgICBoc2xbMV0gKj0gMC4wMTtcbiAgICAgIGhzbFsyXSAqPSAwLjAxO1xuICAgICAgcmdiID0gaHNsMnJnYihoc2wpO1xuICAgICAgcmdiWzNdID0gMTtcbiAgICB9IGVsc2UgaWYgKG0gPSBjc3MubWF0Y2goL2hzbGFcXChcXHMqKFxcLT9cXGQrKD86XFwuXFxkKyk/KSxcXHMqKFxcLT9cXGQrKD86XFwuXFxkKyk/KSVcXHMqLFxccyooXFwtP1xcZCsoPzpcXC5cXGQrKT8pJVxccyosXFxzKihbMDFdfFswMV0/XFwuXFxkKylcXCkvKSkge1xuICAgICAgaHNsID0gbS5zbGljZSgxLCA0KTtcbiAgICAgIGhzbFsxXSAqPSAwLjAxO1xuICAgICAgaHNsWzJdICo9IDAuMDE7XG4gICAgICByZ2IgPSBoc2wycmdiKGhzbCk7XG4gICAgICByZ2JbM10gPSArbVs0XTtcbiAgICB9XG4gICAgcmV0dXJuIHJnYjtcbiAgfTtcbiAgaGV4MnJnYiA9IGZ1bmN0aW9uKGhleCkge1xuICAgIHZhciBhLFxuICAgICAgICBiLFxuICAgICAgICBnLFxuICAgICAgICByLFxuICAgICAgICByZ2IsXG4gICAgICAgIHU7XG4gICAgaWYgKGhleC5tYXRjaCgvXiM/KFtBLUZhLWYwLTldezZ9fFtBLUZhLWYwLTldezN9KSQvKSkge1xuICAgICAgaWYgKGhleC5sZW5ndGggPT09IDQgfHwgaGV4Lmxlbmd0aCA9PT0gNykge1xuICAgICAgICBoZXggPSBoZXguc3Vic3RyKDEpO1xuICAgICAgfVxuICAgICAgaWYgKGhleC5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgaGV4ID0gaGV4LnNwbGl0KFwiXCIpO1xuICAgICAgICBoZXggPSBoZXhbMF0gKyBoZXhbMF0gKyBoZXhbMV0gKyBoZXhbMV0gKyBoZXhbMl0gKyBoZXhbMl07XG4gICAgICB9XG4gICAgICB1ID0gcGFyc2VJbnQoaGV4LCAxNik7XG4gICAgICByID0gdSA+PiAxNjtcbiAgICAgIGcgPSB1ID4+IDggJiAweEZGO1xuICAgICAgYiA9IHUgJiAweEZGO1xuICAgICAgcmV0dXJuIFtyLCBnLCBiLCAxXTtcbiAgICB9XG4gICAgaWYgKGhleC5tYXRjaCgvXiM/KFtBLUZhLWYwLTldezh9KSQvKSkge1xuICAgICAgaWYgKGhleC5sZW5ndGggPT09IDkpIHtcbiAgICAgICAgaGV4ID0gaGV4LnN1YnN0cigxKTtcbiAgICAgIH1cbiAgICAgIHUgPSBwYXJzZUludChoZXgsIDE2KTtcbiAgICAgIHIgPSB1ID4+IDI0ICYgMHhGRjtcbiAgICAgIGcgPSB1ID4+IDE2ICYgMHhGRjtcbiAgICAgIGIgPSB1ID4+IDggJiAweEZGO1xuICAgICAgYSA9IHUgJiAweEZGO1xuICAgICAgcmV0dXJuIFtyLCBnLCBiLCBhXTtcbiAgICB9XG4gICAgaWYgKHJnYiA9IGNzczJyZ2IoaGV4KSkge1xuICAgICAgcmV0dXJuIHJnYjtcbiAgICB9XG4gICAgdGhyb3cgXCJ1bmtub3duIGNvbG9yOiBcIiArIGhleDtcbiAgfTtcbiAgaHNpMnJnYiA9IGZ1bmN0aW9uKGgsIHMsIGkpIHtcbiAgICB2YXIgYixcbiAgICAgICAgZyxcbiAgICAgICAgcixcbiAgICAgICAgX3JlZjtcbiAgICBfcmVmID0gdW5wYWNrKGFyZ3VtZW50cyksIGggPSBfcmVmWzBdLCBzID0gX3JlZlsxXSwgaSA9IF9yZWZbMl07XG4gICAgaCAvPSAzNjA7XG4gICAgaWYgKGggPCAxIC8gMykge1xuICAgICAgYiA9ICgxIC0gcykgLyAzO1xuICAgICAgciA9ICgxICsgcyAqIGNvcyhUV09QSSAqIGgpIC8gY29zKFBJVEhJUkQgLSBUV09QSSAqIGgpKSAvIDM7XG4gICAgICBnID0gMSAtIChiICsgcik7XG4gICAgfSBlbHNlIGlmIChoIDwgMiAvIDMpIHtcbiAgICAgIGggLT0gMSAvIDM7XG4gICAgICByID0gKDEgLSBzKSAvIDM7XG4gICAgICBnID0gKDEgKyBzICogY29zKFRXT1BJICogaCkgLyBjb3MoUElUSElSRCAtIFRXT1BJICogaCkpIC8gMztcbiAgICAgIGIgPSAxIC0gKHIgKyBnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaCAtPSAyIC8gMztcbiAgICAgIGcgPSAoMSAtIHMpIC8gMztcbiAgICAgIGIgPSAoMSArIHMgKiBjb3MoVFdPUEkgKiBoKSAvIGNvcyhQSVRISVJEIC0gVFdPUEkgKiBoKSkgLyAzO1xuICAgICAgciA9IDEgLSAoZyArIGIpO1xuICAgIH1cbiAgICByID0gbGltaXQoaSAqIHIgKiAzKTtcbiAgICBnID0gbGltaXQoaSAqIGcgKiAzKTtcbiAgICBiID0gbGltaXQoaSAqIGIgKiAzKTtcbiAgICByZXR1cm4gW3IgKiAyNTUsIGcgKiAyNTUsIGIgKiAyNTVdO1xuICB9O1xuICBoc2wycmdiID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGIsXG4gICAgICAgIGMsXG4gICAgICAgIGcsXG4gICAgICAgIGgsXG4gICAgICAgIGksXG4gICAgICAgIGwsXG4gICAgICAgIHIsXG4gICAgICAgIHMsXG4gICAgICAgIHQxLFxuICAgICAgICB0MixcbiAgICAgICAgdDMsXG4gICAgICAgIF9pLFxuICAgICAgICBfcmVmLFxuICAgICAgICBfcmVmMTtcbiAgICBfcmVmID0gdW5wYWNrKGFyZ3VtZW50cyksIGggPSBfcmVmWzBdLCBzID0gX3JlZlsxXSwgbCA9IF9yZWZbMl07XG4gICAgaWYgKHMgPT09IDApIHtcbiAgICAgIHIgPSBnID0gYiA9IGwgKiAyNTU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHQzID0gWzAsIDAsIDBdO1xuICAgICAgYyA9IFswLCAwLCAwXTtcbiAgICAgIHQyID0gbCA8IDAuNSA/IGwgKiAoMSArIHMpIDogbCArIHMgLSBsICogcztcbiAgICAgIHQxID0gMiAqIGwgLSB0MjtcbiAgICAgIGggLz0gMzYwO1xuICAgICAgdDNbMF0gPSBoICsgMSAvIDM7XG4gICAgICB0M1sxXSA9IGg7XG4gICAgICB0M1syXSA9IGggLSAxIC8gMztcbiAgICAgIGZvciAoaSA9IF9pID0gMDsgX2kgPD0gMjsgaSA9ICsrX2kpIHtcbiAgICAgICAgaWYgKHQzW2ldIDwgMCkge1xuICAgICAgICAgIHQzW2ldICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHQzW2ldID4gMSkge1xuICAgICAgICAgIHQzW2ldIC09IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKDYgKiB0M1tpXSA8IDEpIHtcbiAgICAgICAgICBjW2ldID0gdDEgKyAodDIgLSB0MSkgKiA2ICogdDNbaV07XG4gICAgICAgIH0gZWxzZSBpZiAoMiAqIHQzW2ldIDwgMSkge1xuICAgICAgICAgIGNbaV0gPSB0MjtcbiAgICAgICAgfSBlbHNlIGlmICgzICogdDNbaV0gPCAyKSB7XG4gICAgICAgICAgY1tpXSA9IHQxICsgKHQyIC0gdDEpICogKCgyIC8gMykgLSB0M1tpXSkgKiA2O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNbaV0gPSB0MTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgX3JlZjEgPSBbTWF0aC5yb3VuZChjWzBdICogMjU1KSwgTWF0aC5yb3VuZChjWzFdICogMjU1KSwgTWF0aC5yb3VuZChjWzJdICogMjU1KV0sIHIgPSBfcmVmMVswXSwgZyA9IF9yZWYxWzFdLCBiID0gX3JlZjFbMl07XG4gICAgfVxuICAgIHJldHVybiBbciwgZywgYl07XG4gIH07XG4gIGhzdjJyZ2IgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYixcbiAgICAgICAgZixcbiAgICAgICAgZyxcbiAgICAgICAgaCxcbiAgICAgICAgaSxcbiAgICAgICAgcCxcbiAgICAgICAgcSxcbiAgICAgICAgcixcbiAgICAgICAgcyxcbiAgICAgICAgdCxcbiAgICAgICAgdixcbiAgICAgICAgX3JlZixcbiAgICAgICAgX3JlZjEsXG4gICAgICAgIF9yZWYyLFxuICAgICAgICBfcmVmMyxcbiAgICAgICAgX3JlZjQsXG4gICAgICAgIF9yZWY1LFxuICAgICAgICBfcmVmNjtcbiAgICBfcmVmID0gdW5wYWNrKGFyZ3VtZW50cyksIGggPSBfcmVmWzBdLCBzID0gX3JlZlsxXSwgdiA9IF9yZWZbMl07XG4gICAgdiAqPSAyNTU7XG4gICAgaWYgKHMgPT09IDApIHtcbiAgICAgIHIgPSBnID0gYiA9IHY7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChoID09PSAzNjApIHtcbiAgICAgICAgaCA9IDA7XG4gICAgICB9XG4gICAgICBpZiAoaCA+IDM2MCkge1xuICAgICAgICBoIC09IDM2MDtcbiAgICAgIH1cbiAgICAgIGlmIChoIDwgMCkge1xuICAgICAgICBoICs9IDM2MDtcbiAgICAgIH1cbiAgICAgIGggLz0gNjA7XG4gICAgICBpID0gTWF0aC5mbG9vcihoKTtcbiAgICAgIGYgPSBoIC0gaTtcbiAgICAgIHAgPSB2ICogKDEgLSBzKTtcbiAgICAgIHEgPSB2ICogKDEgLSBzICogZik7XG4gICAgICB0ID0gdiAqICgxIC0gcyAqICgxIC0gZikpO1xuICAgICAgc3dpdGNoIChpKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICBfcmVmMSA9IFt2LCB0LCBwXSwgciA9IF9yZWYxWzBdLCBnID0gX3JlZjFbMV0sIGIgPSBfcmVmMVsyXTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIF9yZWYyID0gW3EsIHYsIHBdLCByID0gX3JlZjJbMF0sIGcgPSBfcmVmMlsxXSwgYiA9IF9yZWYyWzJdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgX3JlZjMgPSBbcCwgdiwgdF0sIHIgPSBfcmVmM1swXSwgZyA9IF9yZWYzWzFdLCBiID0gX3JlZjNbMl07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBfcmVmNCA9IFtwLCBxLCB2XSwgciA9IF9yZWY0WzBdLCBnID0gX3JlZjRbMV0sIGIgPSBfcmVmNFsyXTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIF9yZWY1ID0gW3QsIHAsIHZdLCByID0gX3JlZjVbMF0sIGcgPSBfcmVmNVsxXSwgYiA9IF9yZWY1WzJdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgX3JlZjYgPSBbdiwgcCwgcV0sIHIgPSBfcmVmNlswXSwgZyA9IF9yZWY2WzFdLCBiID0gX3JlZjZbMl07XG4gICAgICB9XG4gICAgfVxuICAgIHIgPSBNYXRoLnJvdW5kKHIpO1xuICAgIGcgPSBNYXRoLnJvdW5kKGcpO1xuICAgIGIgPSBNYXRoLnJvdW5kKGIpO1xuICAgIHJldHVybiBbciwgZywgYl07XG4gIH07XG4gIEsgPSAxODtcbiAgWCA9IDAuOTUwNDcwO1xuICBZID0gMTtcbiAgWiA9IDEuMDg4ODMwO1xuICBsYWIybGNoID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGEsXG4gICAgICAgIGIsXG4gICAgICAgIGMsXG4gICAgICAgIGgsXG4gICAgICAgIGwsXG4gICAgICAgIF9yZWY7XG4gICAgX3JlZiA9IHVucGFjayhhcmd1bWVudHMpLCBsID0gX3JlZlswXSwgYSA9IF9yZWZbMV0sIGIgPSBfcmVmWzJdO1xuICAgIGMgPSBNYXRoLnNxcnQoYSAqIGEgKyBiICogYik7XG4gICAgaCA9IE1hdGguYXRhbjIoYiwgYSkgLyBNYXRoLlBJICogMTgwO1xuICAgIHJldHVybiBbbCwgYywgaF07XG4gIH07XG4gIGxhYjJyZ2IgPSBmdW5jdGlvbihsLCBhLCBiKSB7XG4gICAgdmFyIGcsXG4gICAgICAgIHIsXG4gICAgICAgIHgsXG4gICAgICAgIHksXG4gICAgICAgIHosXG4gICAgICAgIF9yZWYsXG4gICAgICAgIF9yZWYxO1xuICAgIGlmIChsICE9PSB2b2lkIDAgJiYgbC5sZW5ndGggPT09IDMpIHtcbiAgICAgIF9yZWYgPSBsLCBsID0gX3JlZlswXSwgYSA9IF9yZWZbMV0sIGIgPSBfcmVmWzJdO1xuICAgIH1cbiAgICBpZiAobCAhPT0gdm9pZCAwICYmIGwubGVuZ3RoID09PSAzKSB7XG4gICAgICBfcmVmMSA9IGwsIGwgPSBfcmVmMVswXSwgYSA9IF9yZWYxWzFdLCBiID0gX3JlZjFbMl07XG4gICAgfVxuICAgIHkgPSAobCArIDE2KSAvIDExNjtcbiAgICB4ID0geSArIGEgLyA1MDA7XG4gICAgeiA9IHkgLSBiIC8gMjAwO1xuICAgIHggPSBsYWJfeHl6KHgpICogWDtcbiAgICB5ID0gbGFiX3h5eih5KSAqIFk7XG4gICAgeiA9IGxhYl94eXooeikgKiBaO1xuICAgIHIgPSB4eXpfcmdiKDMuMjQwNDU0MiAqIHggLSAxLjUzNzEzODUgKiB5IC0gMC40OTg1MzE0ICogeik7XG4gICAgZyA9IHh5el9yZ2IoLTAuOTY5MjY2MCAqIHggKyAxLjg3NjAxMDggKiB5ICsgMC4wNDE1NTYwICogeik7XG4gICAgYiA9IHh5el9yZ2IoMC4wNTU2NDM0ICogeCAtIDAuMjA0MDI1OSAqIHkgKyAxLjA1NzIyNTIgKiB6KTtcbiAgICByZXR1cm4gW2xpbWl0KHIsIDAsIDI1NSksIGxpbWl0KGcsIDAsIDI1NSksIGxpbWl0KGIsIDAsIDI1NSksIDFdO1xuICB9O1xuICBsYWJfeHl6ID0gZnVuY3Rpb24oeCkge1xuICAgIGlmICh4ID4gMC4yMDY4OTMwMzQpIHtcbiAgICAgIHJldHVybiB4ICogeCAqIHg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAoeCAtIDQgLyAyOSkgLyA3Ljc4NzAzNztcbiAgICB9XG4gIH07XG4gIHh5el9yZ2IgPSBmdW5jdGlvbihyKSB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQoMjU1ICogKHIgPD0gMC4wMDMwNCA/IDEyLjkyICogciA6IDEuMDU1ICogTWF0aC5wb3cociwgMSAvIDIuNCkgLSAwLjA1NSkpO1xuICB9O1xuICBsY2gybGFiID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGMsXG4gICAgICAgIGgsXG4gICAgICAgIGwsXG4gICAgICAgIF9yZWY7XG4gICAgX3JlZiA9IHVucGFjayhhcmd1bWVudHMpLCBsID0gX3JlZlswXSwgYyA9IF9yZWZbMV0sIGggPSBfcmVmWzJdO1xuICAgIGggPSBoICogTWF0aC5QSSAvIDE4MDtcbiAgICByZXR1cm4gW2wsIE1hdGguY29zKGgpICogYywgTWF0aC5zaW4oaCkgKiBjXTtcbiAgfTtcbiAgbGNoMnJnYiA9IGZ1bmN0aW9uKGwsIGMsIGgpIHtcbiAgICB2YXIgTCxcbiAgICAgICAgYSxcbiAgICAgICAgYixcbiAgICAgICAgZyxcbiAgICAgICAgcixcbiAgICAgICAgX3JlZixcbiAgICAgICAgX3JlZjE7XG4gICAgX3JlZiA9IGxjaDJsYWIobCwgYywgaCksIEwgPSBfcmVmWzBdLCBhID0gX3JlZlsxXSwgYiA9IF9yZWZbMl07XG4gICAgX3JlZjEgPSBsYWIycmdiKEwsIGEsIGIpLCByID0gX3JlZjFbMF0sIGcgPSBfcmVmMVsxXSwgYiA9IF9yZWYxWzJdO1xuICAgIHJldHVybiBbbGltaXQociwgMCwgMjU1KSwgbGltaXQoZywgMCwgMjU1KSwgbGltaXQoYiwgMCwgMjU1KV07XG4gIH07XG4gIGx1bWluYW5jZSA9IGZ1bmN0aW9uKHIsIGcsIGIpIHtcbiAgICB2YXIgX3JlZjtcbiAgICBfcmVmID0gdW5wYWNrKGFyZ3VtZW50cyksIHIgPSBfcmVmWzBdLCBnID0gX3JlZlsxXSwgYiA9IF9yZWZbMl07XG4gICAgciA9IGx1bWluYW5jZV94KHIpO1xuICAgIGcgPSBsdW1pbmFuY2VfeChnKTtcbiAgICBiID0gbHVtaW5hbmNlX3goYik7XG4gICAgcmV0dXJuIDAuMjEyNiAqIHIgKyAwLjcxNTIgKiBnICsgMC4wNzIyICogYjtcbiAgfTtcbiAgbHVtaW5hbmNlX3ggPSBmdW5jdGlvbih4KSB7XG4gICAgeCAvPSAyNTU7XG4gICAgaWYgKHggPD0gMC4wMzkyOCkge1xuICAgICAgcmV0dXJuIHggLyAxMi45MjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIE1hdGgucG93KCh4ICsgMC4wNTUpIC8gMS4wNTUsIDIuNCk7XG4gICAgfVxuICB9O1xuICByZ2IyaGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGIsXG4gICAgICAgIGcsXG4gICAgICAgIHIsXG4gICAgICAgIHN0cixcbiAgICAgICAgdSxcbiAgICAgICAgX3JlZjtcbiAgICBfcmVmID0gdW5wYWNrKGFyZ3VtZW50cyksIHIgPSBfcmVmWzBdLCBnID0gX3JlZlsxXSwgYiA9IF9yZWZbMl07XG4gICAgdSA9IHIgPDwgMTYgfCBnIDw8IDggfCBiO1xuICAgIHN0ciA9IFwiMDAwMDAwXCIgKyB1LnRvU3RyaW5nKDE2KTtcbiAgICByZXR1cm4gXCIjXCIgKyBzdHIuc3Vic3RyKHN0ci5sZW5ndGggLSA2KTtcbiAgfTtcbiAgcmdiMmhzaSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBUV09QSSxcbiAgICAgICAgYixcbiAgICAgICAgZyxcbiAgICAgICAgaCxcbiAgICAgICAgaSxcbiAgICAgICAgbWluLFxuICAgICAgICByLFxuICAgICAgICBzLFxuICAgICAgICBfcmVmO1xuICAgIF9yZWYgPSB1bnBhY2soYXJndW1lbnRzKSwgciA9IF9yZWZbMF0sIGcgPSBfcmVmWzFdLCBiID0gX3JlZlsyXTtcbiAgICBUV09QSSA9IE1hdGguUEkgKiAyO1xuICAgIHIgLz0gMjU1O1xuICAgIGcgLz0gMjU1O1xuICAgIGIgLz0gMjU1O1xuICAgIG1pbiA9IE1hdGgubWluKHIsIGcsIGIpO1xuICAgIGkgPSAociArIGcgKyBiKSAvIDM7XG4gICAgcyA9IDEgLSBtaW4gLyBpO1xuICAgIGlmIChzID09PSAwKSB7XG4gICAgICBoID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgaCA9ICgociAtIGcpICsgKHIgLSBiKSkgLyAyO1xuICAgICAgaCAvPSBNYXRoLnNxcnQoKHIgLSBnKSAqIChyIC0gZykgKyAociAtIGIpICogKGcgLSBiKSk7XG4gICAgICBoID0gTWF0aC5hY29zKGgpO1xuICAgICAgaWYgKGIgPiBnKSB7XG4gICAgICAgIGggPSBUV09QSSAtIGg7XG4gICAgICB9XG4gICAgICBoIC89IFRXT1BJO1xuICAgIH1cbiAgICByZXR1cm4gW2ggKiAzNjAsIHMsIGldO1xuICB9O1xuICByZ2IyaHNsID0gZnVuY3Rpb24ociwgZywgYikge1xuICAgIHZhciBoLFxuICAgICAgICBsLFxuICAgICAgICBtYXgsXG4gICAgICAgIG1pbixcbiAgICAgICAgcyxcbiAgICAgICAgX3JlZjtcbiAgICBpZiAociAhPT0gdm9pZCAwICYmIHIubGVuZ3RoID49IDMpIHtcbiAgICAgIF9yZWYgPSByLCByID0gX3JlZlswXSwgZyA9IF9yZWZbMV0sIGIgPSBfcmVmWzJdO1xuICAgIH1cbiAgICByIC89IDI1NTtcbiAgICBnIC89IDI1NTtcbiAgICBiIC89IDI1NTtcbiAgICBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKTtcbiAgICBtYXggPSBNYXRoLm1heChyLCBnLCBiKTtcbiAgICBsID0gKG1heCArIG1pbikgLyAyO1xuICAgIGlmIChtYXggPT09IG1pbikge1xuICAgICAgcyA9IDA7XG4gICAgICBoID0gTnVtYmVyLk5hTjtcbiAgICB9IGVsc2Uge1xuICAgICAgcyA9IGwgPCAwLjUgPyAobWF4IC0gbWluKSAvIChtYXggKyBtaW4pIDogKG1heCAtIG1pbikgLyAoMiAtIG1heCAtIG1pbik7XG4gICAgfVxuICAgIGlmIChyID09PSBtYXgpIHtcbiAgICAgIGggPSAoZyAtIGIpIC8gKG1heCAtIG1pbik7XG4gICAgfSBlbHNlIGlmIChnID09PSBtYXgpIHtcbiAgICAgIGggPSAyICsgKGIgLSByKSAvIChtYXggLSBtaW4pO1xuICAgIH0gZWxzZSBpZiAoYiA9PT0gbWF4KSB7XG4gICAgICBoID0gNCArIChyIC0gZykgLyAobWF4IC0gbWluKTtcbiAgICB9XG4gICAgaCAqPSA2MDtcbiAgICBpZiAoaCA8IDApIHtcbiAgICAgIGggKz0gMzYwO1xuICAgIH1cbiAgICByZXR1cm4gW2gsIHMsIGxdO1xuICB9O1xuICByZ2IyaHN2ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGIsXG4gICAgICAgIGRlbHRhLFxuICAgICAgICBnLFxuICAgICAgICBoLFxuICAgICAgICBtYXgsXG4gICAgICAgIG1pbixcbiAgICAgICAgcixcbiAgICAgICAgcyxcbiAgICAgICAgdixcbiAgICAgICAgX3JlZjtcbiAgICBfcmVmID0gdW5wYWNrKGFyZ3VtZW50cyksIHIgPSBfcmVmWzBdLCBnID0gX3JlZlsxXSwgYiA9IF9yZWZbMl07XG4gICAgbWluID0gTWF0aC5taW4ociwgZywgYik7XG4gICAgbWF4ID0gTWF0aC5tYXgociwgZywgYik7XG4gICAgZGVsdGEgPSBtYXggLSBtaW47XG4gICAgdiA9IG1heCAvIDI1NS4wO1xuICAgIGlmIChtYXggPT09IDApIHtcbiAgICAgIGggPSBOdW1iZXIuTmFOO1xuICAgICAgcyA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHMgPSBkZWx0YSAvIG1heDtcbiAgICAgIGlmIChyID09PSBtYXgpIHtcbiAgICAgICAgaCA9IChnIC0gYikgLyBkZWx0YTtcbiAgICAgIH1cbiAgICAgIGlmIChnID09PSBtYXgpIHtcbiAgICAgICAgaCA9IDIgKyAoYiAtIHIpIC8gZGVsdGE7XG4gICAgICB9XG4gICAgICBpZiAoYiA9PT0gbWF4KSB7XG4gICAgICAgIGggPSA0ICsgKHIgLSBnKSAvIGRlbHRhO1xuICAgICAgfVxuICAgICAgaCAqPSA2MDtcbiAgICAgIGlmIChoIDwgMCkge1xuICAgICAgICBoICs9IDM2MDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFtoLCBzLCB2XTtcbiAgfTtcbiAgcmdiMmxhYiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBiLFxuICAgICAgICBnLFxuICAgICAgICByLFxuICAgICAgICB4LFxuICAgICAgICB5LFxuICAgICAgICB6LFxuICAgICAgICBfcmVmO1xuICAgIF9yZWYgPSB1bnBhY2soYXJndW1lbnRzKSwgciA9IF9yZWZbMF0sIGcgPSBfcmVmWzFdLCBiID0gX3JlZlsyXTtcbiAgICByID0gcmdiX3h5eihyKTtcbiAgICBnID0gcmdiX3h5eihnKTtcbiAgICBiID0gcmdiX3h5eihiKTtcbiAgICB4ID0geHl6X2xhYigoMC40MTI0NTY0ICogciArIDAuMzU3NTc2MSAqIGcgKyAwLjE4MDQzNzUgKiBiKSAvIFgpO1xuICAgIHkgPSB4eXpfbGFiKCgwLjIxMjY3MjkgKiByICsgMC43MTUxNTIyICogZyArIDAuMDcyMTc1MCAqIGIpIC8gWSk7XG4gICAgeiA9IHh5el9sYWIoKDAuMDE5MzMzOSAqIHIgKyAwLjExOTE5MjAgKiBnICsgMC45NTAzMDQxICogYikgLyBaKTtcbiAgICByZXR1cm4gWzExNiAqIHkgLSAxNiwgNTAwICogKHggLSB5KSwgMjAwICogKHkgLSB6KV07XG4gIH07XG4gIHJnYl94eXogPSBmdW5jdGlvbihyKSB7XG4gICAgaWYgKChyIC89IDI1NSkgPD0gMC4wNDA0NSkge1xuICAgICAgcmV0dXJuIHIgLyAxMi45MjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIE1hdGgucG93KChyICsgMC4wNTUpIC8gMS4wNTUsIDIuNCk7XG4gICAgfVxuICB9O1xuICB4eXpfbGFiID0gZnVuY3Rpb24oeCkge1xuICAgIGlmICh4ID4gMC4wMDg4NTYpIHtcbiAgICAgIHJldHVybiBNYXRoLnBvdyh4LCAxIC8gMyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiA3Ljc4NzAzNyAqIHggKyA0IC8gMjk7XG4gICAgfVxuICB9O1xuICByZ2IybGNoID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGEsXG4gICAgICAgIGIsXG4gICAgICAgIGcsXG4gICAgICAgIGwsXG4gICAgICAgIHIsXG4gICAgICAgIF9yZWYsXG4gICAgICAgIF9yZWYxO1xuICAgIF9yZWYgPSB1bnBhY2soYXJndW1lbnRzKSwgciA9IF9yZWZbMF0sIGcgPSBfcmVmWzFdLCBiID0gX3JlZlsyXTtcbiAgICBfcmVmMSA9IHJnYjJsYWIociwgZywgYiksIGwgPSBfcmVmMVswXSwgYSA9IF9yZWYxWzFdLCBiID0gX3JlZjFbMl07XG4gICAgcmV0dXJuIGxhYjJsY2gobCwgYSwgYik7XG4gIH07XG4gIGNocm9tYS5zY2FsZSA9IGZ1bmN0aW9uKGNvbG9ycywgcG9zaXRpb25zKSB7XG4gICAgdmFyIGNsYXNzaWZ5VmFsdWUsXG4gICAgICAgIGYsXG4gICAgICAgIGdldENsYXNzLFxuICAgICAgICBnZXRDb2xvcixcbiAgICAgICAgcmVzZXRDYWNoZSxcbiAgICAgICAgc2V0Q29sb3JzLFxuICAgICAgICBzZXREb21haW4sXG4gICAgICAgIHRtYXAsXG4gICAgICAgIF9jb2xvckNhY2hlLFxuICAgICAgICBfY29sb3JzLFxuICAgICAgICBfY29ycmVjdExpZ2h0bmVzcyxcbiAgICAgICAgX2RvbWFpbixcbiAgICAgICAgX2ZpeGVkLFxuICAgICAgICBfbWF4LFxuICAgICAgICBfbWluLFxuICAgICAgICBfbW9kZSxcbiAgICAgICAgX25hY29sLFxuICAgICAgICBfbnVtQ2xhc3NlcyxcbiAgICAgICAgX291dCxcbiAgICAgICAgX3BvcyxcbiAgICAgICAgX3NwcmVhZDtcbiAgICBfbW9kZSA9ICdyZ2InO1xuICAgIF9uYWNvbCA9IGNocm9tYSgnI2NjYycpO1xuICAgIF9zcHJlYWQgPSAwO1xuICAgIF9maXhlZCA9IGZhbHNlO1xuICAgIF9kb21haW4gPSBbMCwgMV07XG4gICAgX2NvbG9ycyA9IFtdO1xuICAgIF9vdXQgPSBmYWxzZTtcbiAgICBfcG9zID0gW107XG4gICAgX21pbiA9IDA7XG4gICAgX21heCA9IDE7XG4gICAgX2NvcnJlY3RMaWdodG5lc3MgPSBmYWxzZTtcbiAgICBfbnVtQ2xhc3NlcyA9IDA7XG4gICAgX2NvbG9yQ2FjaGUgPSB7fTtcbiAgICBzZXRDb2xvcnMgPSBmdW5jdGlvbihjb2xvcnMsIHBvc2l0aW9ucykge1xuICAgICAgdmFyIGMsXG4gICAgICAgICAgY29sLFxuICAgICAgICAgIF9pLFxuICAgICAgICAgIF9qLFxuICAgICAgICAgIF9yZWYsXG4gICAgICAgICAgX3JlZjEsXG4gICAgICAgICAgX3JlZjI7XG4gICAgICBpZiAoY29sb3JzID09IG51bGwpIHtcbiAgICAgICAgY29sb3JzID0gWycjZGRkJywgJyMyMjInXTtcbiAgICAgIH1cbiAgICAgIGlmICgoY29sb3JzICE9IG51bGwpICYmIHR5cGUoY29sb3JzKSA9PT0gJ3N0cmluZycgJiYgKCgoX3JlZiA9IGNocm9tYS5icmV3ZXIpICE9IG51bGwgPyBfcmVmW2NvbG9yc10gOiB2b2lkIDApICE9IG51bGwpKSB7XG4gICAgICAgIGNvbG9ycyA9IGNocm9tYS5icmV3ZXJbY29sb3JzXTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlKGNvbG9ycykgPT09ICdhcnJheScpIHtcbiAgICAgICAgY29sb3JzID0gY29sb3JzLnNsaWNlKDApO1xuICAgICAgICBmb3IgKGMgPSBfaSA9IDAsIF9yZWYxID0gY29sb3JzLmxlbmd0aCAtIDE7IDAgPD0gX3JlZjEgPyBfaSA8PSBfcmVmMSA6IF9pID49IF9yZWYxOyBjID0gMCA8PSBfcmVmMSA/ICsrX2kgOiAtLV9pKSB7XG4gICAgICAgICAgY29sID0gY29sb3JzW2NdO1xuICAgICAgICAgIGlmICh0eXBlKGNvbCkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGNvbG9yc1tjXSA9IGNocm9tYShjb2wpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocG9zaXRpb25zICE9IG51bGwpIHtcbiAgICAgICAgICBfcG9zID0gcG9zaXRpb25zO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9wb3MgPSBbXTtcbiAgICAgICAgICBmb3IgKGMgPSBfaiA9IDAsIF9yZWYyID0gY29sb3JzLmxlbmd0aCAtIDE7IDAgPD0gX3JlZjIgPyBfaiA8PSBfcmVmMiA6IF9qID49IF9yZWYyOyBjID0gMCA8PSBfcmVmMiA/ICsrX2ogOiAtLV9qKSB7XG4gICAgICAgICAgICBfcG9zLnB1c2goYyAvIChjb2xvcnMubGVuZ3RoIC0gMSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzZXRDYWNoZSgpO1xuICAgICAgcmV0dXJuIF9jb2xvcnMgPSBjb2xvcnM7XG4gICAgfTtcbiAgICBzZXREb21haW4gPSBmdW5jdGlvbihkb21haW4pIHtcbiAgICAgIGlmIChkb21haW4gPT0gbnVsbCkge1xuICAgICAgICBkb21haW4gPSBbXTtcbiAgICAgIH1cbiAgICAgIF9kb21haW4gPSBkb21haW47XG4gICAgICBfbWluID0gZG9tYWluWzBdO1xuICAgICAgX21heCA9IGRvbWFpbltkb21haW4ubGVuZ3RoIC0gMV07XG4gICAgICByZXNldENhY2hlKCk7XG4gICAgICBpZiAoZG9tYWluLmxlbmd0aCA9PT0gMikge1xuICAgICAgICByZXR1cm4gX251bUNsYXNzZXMgPSAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIF9udW1DbGFzc2VzID0gZG9tYWluLmxlbmd0aCAtIDE7XG4gICAgICB9XG4gICAgfTtcbiAgICBnZXRDbGFzcyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgaSxcbiAgICAgICAgICBuO1xuICAgICAgaWYgKF9kb21haW4gIT0gbnVsbCkge1xuICAgICAgICBuID0gX2RvbWFpbi5sZW5ndGggLSAxO1xuICAgICAgICBpID0gMDtcbiAgICAgICAgd2hpbGUgKGkgPCBuICYmIHZhbHVlID49IF9kb21haW5baV0pIHtcbiAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGkgLSAxO1xuICAgICAgfVxuICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICB0bWFwID0gZnVuY3Rpb24odCkge1xuICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcbiAgICBjbGFzc2lmeVZhbHVlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBpLFxuICAgICAgICAgIG1heGMsXG4gICAgICAgICAgbWluYyxcbiAgICAgICAgICBuLFxuICAgICAgICAgIHZhbDtcbiAgICAgIHZhbCA9IHZhbHVlO1xuICAgICAgaWYgKF9kb21haW4ubGVuZ3RoID4gMikge1xuICAgICAgICBuID0gX2RvbWFpbi5sZW5ndGggLSAxO1xuICAgICAgICBpID0gZ2V0Q2xhc3ModmFsdWUpO1xuICAgICAgICBtaW5jID0gX2RvbWFpblswXSArIChfZG9tYWluWzFdIC0gX2RvbWFpblswXSkgKiAoMCArIF9zcHJlYWQgKiAwLjUpO1xuICAgICAgICBtYXhjID0gX2RvbWFpbltuIC0gMV0gKyAoX2RvbWFpbltuXSAtIF9kb21haW5bbiAtIDFdKSAqICgxIC0gX3NwcmVhZCAqIDAuNSk7XG4gICAgICAgIHZhbCA9IF9taW4gKyAoKF9kb21haW5baV0gKyAoX2RvbWFpbltpICsgMV0gLSBfZG9tYWluW2ldKSAqIDAuNSAtIG1pbmMpIC8gKG1heGMgLSBtaW5jKSkgKiAoX21heCAtIF9taW4pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbDtcbiAgICB9O1xuICAgIGdldENvbG9yID0gZnVuY3Rpb24odmFsLCBieXBhc3NNYXApIHtcbiAgICAgIHZhciBjLFxuICAgICAgICAgIGNvbCxcbiAgICAgICAgICBmMCxcbiAgICAgICAgICBpLFxuICAgICAgICAgIGssXG4gICAgICAgICAgcCxcbiAgICAgICAgICB0LFxuICAgICAgICAgIF9pLFxuICAgICAgICAgIF9yZWY7XG4gICAgICBpZiAoYnlwYXNzTWFwID09IG51bGwpIHtcbiAgICAgICAgYnlwYXNzTWFwID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoaXNOYU4odmFsKSkge1xuICAgICAgICByZXR1cm4gX25hY29sO1xuICAgICAgfVxuICAgICAgaWYgKCFieXBhc3NNYXApIHtcbiAgICAgICAgaWYgKF9kb21haW4ubGVuZ3RoID4gMikge1xuICAgICAgICAgIGMgPSBnZXRDbGFzcyh2YWwpO1xuICAgICAgICAgIHQgPSBjIC8gKF9udW1DbGFzc2VzIC0gMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdCA9IGYwID0gKHZhbCAtIF9taW4pIC8gKF9tYXggLSBfbWluKTtcbiAgICAgICAgICB0ID0gTWF0aC5taW4oMSwgTWF0aC5tYXgoMCwgdCkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0ID0gdmFsO1xuICAgICAgfVxuICAgICAgaWYgKCFieXBhc3NNYXApIHtcbiAgICAgICAgdCA9IHRtYXAodCk7XG4gICAgICB9XG4gICAgICBrID0gTWF0aC5mbG9vcih0ICogMTAwMDApO1xuICAgICAgaWYgKF9jb2xvckNhY2hlW2tdKSB7XG4gICAgICAgIGNvbCA9IF9jb2xvckNhY2hlW2tdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHR5cGUoX2NvbG9ycykgPT09ICdhcnJheScpIHtcbiAgICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSBfcG9zLmxlbmd0aCAtIDE7IDAgPD0gX3JlZiA/IF9pIDw9IF9yZWYgOiBfaSA+PSBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHtcbiAgICAgICAgICAgIHAgPSBfcG9zW2ldO1xuICAgICAgICAgICAgaWYgKHQgPD0gcCkge1xuICAgICAgICAgICAgICBjb2wgPSBfY29sb3JzW2ldO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0ID49IHAgJiYgaSA9PT0gX3Bvcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgIGNvbCA9IF9jb2xvcnNbaV07XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHQgPiBwICYmIHQgPCBfcG9zW2kgKyAxXSkge1xuICAgICAgICAgICAgICB0ID0gKHQgLSBwKSAvIChfcG9zW2kgKyAxXSAtIHApO1xuICAgICAgICAgICAgICBjb2wgPSBjaHJvbWEuaW50ZXJwb2xhdGUoX2NvbG9yc1tpXSwgX2NvbG9yc1tpICsgMV0sIHQsIF9tb2RlKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUoX2NvbG9ycykgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBjb2wgPSBfY29sb3JzKHQpO1xuICAgICAgICB9XG4gICAgICAgIF9jb2xvckNhY2hlW2tdID0gY29sO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbDtcbiAgICB9O1xuICAgIHJlc2V0Q2FjaGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfY29sb3JDYWNoZSA9IHt9O1xuICAgIH07XG4gICAgc2V0Q29sb3JzKGNvbG9ycywgcG9zaXRpb25zKTtcbiAgICBmID0gZnVuY3Rpb24odikge1xuICAgICAgdmFyIGM7XG4gICAgICBjID0gZ2V0Q29sb3Iodik7XG4gICAgICBpZiAoX291dCAmJiBjW19vdXRdKSB7XG4gICAgICAgIHJldHVybiBjW19vdXRdKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYztcbiAgICAgIH1cbiAgICB9O1xuICAgIGYuZG9tYWluID0gZnVuY3Rpb24oZG9tYWluLCBjbGFzc2VzLCBtb2RlLCBrZXkpIHtcbiAgICAgIHZhciBkO1xuICAgICAgaWYgKG1vZGUgPT0gbnVsbCkge1xuICAgICAgICBtb2RlID0gJ2UnO1xuICAgICAgfVxuICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBfZG9tYWluO1xuICAgICAgfVxuICAgICAgaWYgKGNsYXNzZXMgIT0gbnVsbCkge1xuICAgICAgICBkID0gY2hyb21hLmFuYWx5emUoZG9tYWluLCBrZXkpO1xuICAgICAgICBpZiAoY2xhc3NlcyA9PT0gMCkge1xuICAgICAgICAgIGRvbWFpbiA9IFtkLm1pbiwgZC5tYXhdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRvbWFpbiA9IGNocm9tYS5saW1pdHMoZCwgbW9kZSwgY2xhc3Nlcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNldERvbWFpbihkb21haW4pO1xuICAgICAgcmV0dXJuIGY7XG4gICAgfTtcbiAgICBmLm1vZGUgPSBmdW5jdGlvbihfbSkge1xuICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBfbW9kZTtcbiAgICAgIH1cbiAgICAgIF9tb2RlID0gX207XG4gICAgICByZXNldENhY2hlKCk7XG4gICAgICByZXR1cm4gZjtcbiAgICB9O1xuICAgIGYucmFuZ2UgPSBmdW5jdGlvbihjb2xvcnMsIF9wb3MpIHtcbiAgICAgIHNldENvbG9ycyhjb2xvcnMsIF9wb3MpO1xuICAgICAgcmV0dXJuIGY7XG4gICAgfTtcbiAgICBmLm91dCA9IGZ1bmN0aW9uKF9vKSB7XG4gICAgICBfb3V0ID0gX287XG4gICAgICByZXR1cm4gZjtcbiAgICB9O1xuICAgIGYuc3ByZWFkID0gZnVuY3Rpb24odmFsKSB7XG4gICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIF9zcHJlYWQ7XG4gICAgICB9XG4gICAgICBfc3ByZWFkID0gdmFsO1xuICAgICAgcmV0dXJuIGY7XG4gICAgfTtcbiAgICBmLmNvcnJlY3RMaWdodG5lc3MgPSBmdW5jdGlvbih2KSB7XG4gICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIF9jb3JyZWN0TGlnaHRuZXNzO1xuICAgICAgfVxuICAgICAgX2NvcnJlY3RMaWdodG5lc3MgPSB2O1xuICAgICAgcmVzZXRDYWNoZSgpO1xuICAgICAgaWYgKF9jb3JyZWN0TGlnaHRuZXNzKSB7XG4gICAgICAgIHRtYXAgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgdmFyIEwwLFxuICAgICAgICAgICAgICBMMSxcbiAgICAgICAgICAgICAgTF9hY3R1YWwsXG4gICAgICAgICAgICAgIExfZGlmZixcbiAgICAgICAgICAgICAgTF9pZGVhbCxcbiAgICAgICAgICAgICAgbWF4X2l0ZXIsXG4gICAgICAgICAgICAgIHBvbCxcbiAgICAgICAgICAgICAgdDAsXG4gICAgICAgICAgICAgIHQxO1xuICAgICAgICAgIEwwID0gZ2V0Q29sb3IoMCwgdHJ1ZSkubGFiKClbMF07XG4gICAgICAgICAgTDEgPSBnZXRDb2xvcigxLCB0cnVlKS5sYWIoKVswXTtcbiAgICAgICAgICBwb2wgPSBMMCA+IEwxO1xuICAgICAgICAgIExfYWN0dWFsID0gZ2V0Q29sb3IodCwgdHJ1ZSkubGFiKClbMF07XG4gICAgICAgICAgTF9pZGVhbCA9IEwwICsgKEwxIC0gTDApICogdDtcbiAgICAgICAgICBMX2RpZmYgPSBMX2FjdHVhbCAtIExfaWRlYWw7XG4gICAgICAgICAgdDAgPSAwO1xuICAgICAgICAgIHQxID0gMTtcbiAgICAgICAgICBtYXhfaXRlciA9IDIwO1xuICAgICAgICAgIHdoaWxlIChNYXRoLmFicyhMX2RpZmYpID4gMWUtMiAmJiBtYXhfaXRlci0tID4gMCkge1xuICAgICAgICAgICAgKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBpZiAocG9sKSB7XG4gICAgICAgICAgICAgICAgTF9kaWZmICo9IC0xO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChMX2RpZmYgPCAwKSB7XG4gICAgICAgICAgICAgICAgdDAgPSB0O1xuICAgICAgICAgICAgICAgIHQgKz0gKHQxIC0gdCkgKiAwLjU7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdDEgPSB0O1xuICAgICAgICAgICAgICAgIHQgKz0gKHQwIC0gdCkgKiAwLjU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgTF9hY3R1YWwgPSBnZXRDb2xvcih0LCB0cnVlKS5sYWIoKVswXTtcbiAgICAgICAgICAgICAgcmV0dXJuIExfZGlmZiA9IExfYWN0dWFsIC0gTF9pZGVhbDtcbiAgICAgICAgICAgIH0pKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0O1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG1hcCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICByZXR1cm4gdDtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmO1xuICAgIH07XG4gICAgZi5jb2xvcnMgPSBmdW5jdGlvbihvdXQpIHtcbiAgICAgIHZhciBpLFxuICAgICAgICAgIHNhbXBsZXMsXG4gICAgICAgICAgX2ksXG4gICAgICAgICAgX2osXG4gICAgICAgICAgX2xlbixcbiAgICAgICAgICBfcmVmO1xuICAgICAgaWYgKG91dCA9PSBudWxsKSB7XG4gICAgICAgIG91dCA9ICdoZXgnO1xuICAgICAgfVxuICAgICAgY29sb3JzID0gW107XG4gICAgICBzYW1wbGVzID0gW107XG4gICAgICBpZiAoX2RvbWFpbi5sZW5ndGggPiAyKSB7XG4gICAgICAgIGZvciAoaSA9IF9pID0gMSwgX3JlZiA9IF9kb21haW4ubGVuZ3RoOyAxIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAxIDw9IF9yZWYgPyArK19pIDogLS1faSkge1xuICAgICAgICAgIHNhbXBsZXMucHVzaCgoX2RvbWFpbltpIC0gMV0gKyBfZG9tYWluW2ldKSAqIDAuNSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNhbXBsZXMgPSBfZG9tYWluO1xuICAgICAgfVxuICAgICAgZm9yIChfaiA9IDAsIF9sZW4gPSBzYW1wbGVzLmxlbmd0aDsgX2ogPCBfbGVuOyBfaisrKSB7XG4gICAgICAgIGkgPSBzYW1wbGVzW19qXTtcbiAgICAgICAgY29sb3JzLnB1c2goZihpKVtvdXRdKCkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbG9ycztcbiAgICB9O1xuICAgIHJldHVybiBmO1xuICB9O1xuICBpZiAoKF9yZWYgPSBjaHJvbWEuc2NhbGVzKSA9PSBudWxsKSB7XG4gICAgY2hyb21hLnNjYWxlcyA9IHt9O1xuICB9XG4gIGNocm9tYS5zY2FsZXMuY29vbCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjaHJvbWEuc2NhbGUoW2Nocm9tYS5oc2woMTgwLCAxLCAuOSksIGNocm9tYS5oc2woMjUwLCAuNywgLjQpXSk7XG4gIH07XG4gIGNocm9tYS5zY2FsZXMuaG90ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNocm9tYS5zY2FsZShbJyMwMDAnLCAnI2YwMCcsICcjZmYwJywgJyNmZmYnXSwgWzAsIC4yNSwgLjc1LCAxXSkubW9kZSgncmdiJyk7XG4gIH07XG4gIGNocm9tYS5hbmFseXplID0gZnVuY3Rpb24oZGF0YSwga2V5LCBmaWx0ZXIpIHtcbiAgICB2YXIgYWRkLFxuICAgICAgICBrLFxuICAgICAgICByLFxuICAgICAgICB2YWwsXG4gICAgICAgIHZpc2l0LFxuICAgICAgICBfaSxcbiAgICAgICAgX2xlbjtcbiAgICByID0ge1xuICAgICAgbWluOiBOdW1iZXIuTUFYX1ZBTFVFLFxuICAgICAgbWF4OiBOdW1iZXIuTUFYX1ZBTFVFICogLTEsXG4gICAgICBzdW06IDAsXG4gICAgICB2YWx1ZXM6IFtdLFxuICAgICAgY291bnQ6IDBcbiAgICB9O1xuICAgIGlmIChmaWx0ZXIgPT0gbnVsbCkge1xuICAgICAgZmlsdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICB9XG4gICAgYWRkID0gZnVuY3Rpb24odmFsKSB7XG4gICAgICBpZiAoKHZhbCAhPSBudWxsKSAmJiAhaXNOYU4odmFsKSkge1xuICAgICAgICByLnZhbHVlcy5wdXNoKHZhbCk7XG4gICAgICAgIHIuc3VtICs9IHZhbDtcbiAgICAgICAgaWYgKHZhbCA8IHIubWluKSB7XG4gICAgICAgICAgci5taW4gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbCA+IHIubWF4KSB7XG4gICAgICAgICAgci5tYXggPSB2YWw7XG4gICAgICAgIH1cbiAgICAgICAgci5jb3VudCArPSAxO1xuICAgICAgfVxuICAgIH07XG4gICAgdmlzaXQgPSBmdW5jdGlvbih2YWwsIGspIHtcbiAgICAgIGlmIChmaWx0ZXIodmFsLCBrKSkge1xuICAgICAgICBpZiAoKGtleSAhPSBudWxsKSAmJiB0eXBlKGtleSkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICByZXR1cm4gYWRkKGtleSh2YWwpKTtcbiAgICAgICAgfSBlbHNlIGlmICgoa2V5ICE9IG51bGwpICYmIHR5cGUoa2V5KSA9PT0gJ3N0cmluZycgfHwgdHlwZShrZXkpID09PSAnbnVtYmVyJykge1xuICAgICAgICAgIHJldHVybiBhZGQodmFsW2tleV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBhZGQodmFsKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgaWYgKHR5cGUoZGF0YSkgPT09ICdhcnJheScpIHtcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZGF0YS5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xuICAgICAgICB2YWwgPSBkYXRhW19pXTtcbiAgICAgICAgdmlzaXQodmFsKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChrIGluIGRhdGEpIHtcbiAgICAgICAgdmFsID0gZGF0YVtrXTtcbiAgICAgICAgdmlzaXQodmFsLCBrKTtcbiAgICAgIH1cbiAgICB9XG4gICAgci5kb21haW4gPSBbci5taW4sIHIubWF4XTtcbiAgICByLmxpbWl0cyA9IGZ1bmN0aW9uKG1vZGUsIG51bSkge1xuICAgICAgcmV0dXJuIGNocm9tYS5saW1pdHMociwgbW9kZSwgbnVtKTtcbiAgICB9O1xuICAgIHJldHVybiByO1xuICB9O1xuICBjaHJvbWEubGltaXRzID0gZnVuY3Rpb24oZGF0YSwgbW9kZSwgbnVtKSB7XG4gICAgdmFyIGFzc2lnbm1lbnRzLFxuICAgICAgICBiZXN0LFxuICAgICAgICBjZW50cm9pZHMsXG4gICAgICAgIGNsdXN0ZXIsXG4gICAgICAgIGNsdXN0ZXJTaXplcyxcbiAgICAgICAgZGlzdCxcbiAgICAgICAgaSxcbiAgICAgICAgaixcbiAgICAgICAga0NsdXN0ZXJzLFxuICAgICAgICBsaW1pdHMsXG4gICAgICAgIG1heCxcbiAgICAgICAgbWF4X2xvZyxcbiAgICAgICAgbWluLFxuICAgICAgICBtaW5fbG9nLFxuICAgICAgICBtaW5kaXN0LFxuICAgICAgICBuLFxuICAgICAgICBuYl9pdGVycyxcbiAgICAgICAgbmV3Q2VudHJvaWRzLFxuICAgICAgICBwLFxuICAgICAgICBwYixcbiAgICAgICAgcHIsXG4gICAgICAgIHJlcGVhdCxcbiAgICAgICAgc3VtLFxuICAgICAgICB0bXBLTWVhbnNCcmVha3MsXG4gICAgICAgIHZhbHVlLFxuICAgICAgICB2YWx1ZXMsXG4gICAgICAgIF9pLFxuICAgICAgICBfaixcbiAgICAgICAgX2ssXG4gICAgICAgIF9sLFxuICAgICAgICBfbSxcbiAgICAgICAgX24sXG4gICAgICAgIF9vLFxuICAgICAgICBfcCxcbiAgICAgICAgX3EsXG4gICAgICAgIF9yLFxuICAgICAgICBfcmVmMSxcbiAgICAgICAgX3JlZjEwLFxuICAgICAgICBfcmVmMTEsXG4gICAgICAgIF9yZWYxMixcbiAgICAgICAgX3JlZjEzLFxuICAgICAgICBfcmVmMTQsXG4gICAgICAgIF9yZWYxNSxcbiAgICAgICAgX3JlZjIsXG4gICAgICAgIF9yZWYzLFxuICAgICAgICBfcmVmNCxcbiAgICAgICAgX3JlZjUsXG4gICAgICAgIF9yZWY2LFxuICAgICAgICBfcmVmNyxcbiAgICAgICAgX3JlZjgsXG4gICAgICAgIF9yZWY5LFxuICAgICAgICBfcyxcbiAgICAgICAgX3QsXG4gICAgICAgIF91LFxuICAgICAgICBfdixcbiAgICAgICAgX3c7XG4gICAgaWYgKG1vZGUgPT0gbnVsbCkge1xuICAgICAgbW9kZSA9ICdlcXVhbCc7XG4gICAgfVxuICAgIGlmIChudW0gPT0gbnVsbCkge1xuICAgICAgbnVtID0gNztcbiAgICB9XG4gICAgaWYgKGRhdGEudmFsdWVzID09IG51bGwpIHtcbiAgICAgIGRhdGEgPSBjaHJvbWEuYW5hbHl6ZShkYXRhKTtcbiAgICB9XG4gICAgbWluID0gZGF0YS5taW47XG4gICAgbWF4ID0gZGF0YS5tYXg7XG4gICAgc3VtID0gZGF0YS5zdW07XG4gICAgdmFsdWVzID0gZGF0YS52YWx1ZXMuc29ydChmdW5jdGlvbihhLCBiKSB7XG4gICAgICByZXR1cm4gYSAtIGI7XG4gICAgfSk7XG4gICAgbGltaXRzID0gW107XG4gICAgaWYgKG1vZGUuc3Vic3RyKDAsIDEpID09PSAnYycpIHtcbiAgICAgIGxpbWl0cy5wdXNoKG1pbik7XG4gICAgICBsaW1pdHMucHVzaChtYXgpO1xuICAgIH1cbiAgICBpZiAobW9kZS5zdWJzdHIoMCwgMSkgPT09ICdlJykge1xuICAgICAgbGltaXRzLnB1c2gobWluKTtcbiAgICAgIGZvciAoaSA9IF9pID0gMSwgX3JlZjEgPSBudW0gLSAxOyAxIDw9IF9yZWYxID8gX2kgPD0gX3JlZjEgOiBfaSA+PSBfcmVmMTsgaSA9IDEgPD0gX3JlZjEgPyArK19pIDogLS1faSkge1xuICAgICAgICBsaW1pdHMucHVzaChtaW4gKyAoaSAvIG51bSkgKiAobWF4IC0gbWluKSk7XG4gICAgICB9XG4gICAgICBsaW1pdHMucHVzaChtYXgpO1xuICAgIH0gZWxzZSBpZiAobW9kZS5zdWJzdHIoMCwgMSkgPT09ICdsJykge1xuICAgICAgaWYgKG1pbiA8PSAwKSB7XG4gICAgICAgIHRocm93ICdMb2dhcml0aG1pYyBzY2FsZXMgYXJlIG9ubHkgcG9zc2libGUgZm9yIHZhbHVlcyA+IDAnO1xuICAgICAgfVxuICAgICAgbWluX2xvZyA9IE1hdGguTE9HMTBFICogTWF0aC5sb2cobWluKTtcbiAgICAgIG1heF9sb2cgPSBNYXRoLkxPRzEwRSAqIE1hdGgubG9nKG1heCk7XG4gICAgICBsaW1pdHMucHVzaChtaW4pO1xuICAgICAgZm9yIChpID0gX2ogPSAxLCBfcmVmMiA9IG51bSAtIDE7IDEgPD0gX3JlZjIgPyBfaiA8PSBfcmVmMiA6IF9qID49IF9yZWYyOyBpID0gMSA8PSBfcmVmMiA/ICsrX2ogOiAtLV9qKSB7XG4gICAgICAgIGxpbWl0cy5wdXNoKE1hdGgucG93KDEwLCBtaW5fbG9nICsgKGkgLyBudW0pICogKG1heF9sb2cgLSBtaW5fbG9nKSkpO1xuICAgICAgfVxuICAgICAgbGltaXRzLnB1c2gobWF4KTtcbiAgICB9IGVsc2UgaWYgKG1vZGUuc3Vic3RyKDAsIDEpID09PSAncScpIHtcbiAgICAgIGxpbWl0cy5wdXNoKG1pbik7XG4gICAgICBmb3IgKGkgPSBfayA9IDEsIF9yZWYzID0gbnVtIC0gMTsgMSA8PSBfcmVmMyA/IF9rIDw9IF9yZWYzIDogX2sgPj0gX3JlZjM7IGkgPSAxIDw9IF9yZWYzID8gKytfayA6IC0tX2spIHtcbiAgICAgICAgcCA9IHZhbHVlcy5sZW5ndGggKiBpIC8gbnVtO1xuICAgICAgICBwYiA9IE1hdGguZmxvb3IocCk7XG4gICAgICAgIGlmIChwYiA9PT0gcCkge1xuICAgICAgICAgIGxpbWl0cy5wdXNoKHZhbHVlc1twYl0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHByID0gcCAtIHBiO1xuICAgICAgICAgIGxpbWl0cy5wdXNoKHZhbHVlc1twYl0gKiBwciArIHZhbHVlc1twYiArIDFdICogKDEgLSBwcikpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsaW1pdHMucHVzaChtYXgpO1xuICAgIH0gZWxzZSBpZiAobW9kZS5zdWJzdHIoMCwgMSkgPT09ICdrJykge1xuICAgICAgbiA9IHZhbHVlcy5sZW5ndGg7XG4gICAgICBhc3NpZ25tZW50cyA9IG5ldyBBcnJheShuKTtcbiAgICAgIGNsdXN0ZXJTaXplcyA9IG5ldyBBcnJheShudW0pO1xuICAgICAgcmVwZWF0ID0gdHJ1ZTtcbiAgICAgIG5iX2l0ZXJzID0gMDtcbiAgICAgIGNlbnRyb2lkcyA9IG51bGw7XG4gICAgICBjZW50cm9pZHMgPSBbXTtcbiAgICAgIGNlbnRyb2lkcy5wdXNoKG1pbik7XG4gICAgICBmb3IgKGkgPSBfbCA9IDEsIF9yZWY0ID0gbnVtIC0gMTsgMSA8PSBfcmVmNCA/IF9sIDw9IF9yZWY0IDogX2wgPj0gX3JlZjQ7IGkgPSAxIDw9IF9yZWY0ID8gKytfbCA6IC0tX2wpIHtcbiAgICAgICAgY2VudHJvaWRzLnB1c2gobWluICsgKGkgLyBudW0pICogKG1heCAtIG1pbikpO1xuICAgICAgfVxuICAgICAgY2VudHJvaWRzLnB1c2gobWF4KTtcbiAgICAgIHdoaWxlIChyZXBlYXQpIHtcbiAgICAgICAgZm9yIChqID0gX20gPSAwLCBfcmVmNSA9IG51bSAtIDE7IDAgPD0gX3JlZjUgPyBfbSA8PSBfcmVmNSA6IF9tID49IF9yZWY1OyBqID0gMCA8PSBfcmVmNSA/ICsrX20gOiAtLV9tKSB7XG4gICAgICAgICAgY2x1c3RlclNpemVzW2pdID0gMDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSBfbiA9IDAsIF9yZWY2ID0gbiAtIDE7IDAgPD0gX3JlZjYgPyBfbiA8PSBfcmVmNiA6IF9uID49IF9yZWY2OyBpID0gMCA8PSBfcmVmNiA/ICsrX24gOiAtLV9uKSB7XG4gICAgICAgICAgdmFsdWUgPSB2YWx1ZXNbaV07XG4gICAgICAgICAgbWluZGlzdCA9IE51bWJlci5NQVhfVkFMVUU7XG4gICAgICAgICAgZm9yIChqID0gX28gPSAwLCBfcmVmNyA9IG51bSAtIDE7IDAgPD0gX3JlZjcgPyBfbyA8PSBfcmVmNyA6IF9vID49IF9yZWY3OyBqID0gMCA8PSBfcmVmNyA/ICsrX28gOiAtLV9vKSB7XG4gICAgICAgICAgICBkaXN0ID0gTWF0aC5hYnMoY2VudHJvaWRzW2pdIC0gdmFsdWUpO1xuICAgICAgICAgICAgaWYgKGRpc3QgPCBtaW5kaXN0KSB7XG4gICAgICAgICAgICAgIG1pbmRpc3QgPSBkaXN0O1xuICAgICAgICAgICAgICBiZXN0ID0gajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgY2x1c3RlclNpemVzW2Jlc3RdKys7XG4gICAgICAgICAgYXNzaWdubWVudHNbaV0gPSBiZXN0O1xuICAgICAgICB9XG4gICAgICAgIG5ld0NlbnRyb2lkcyA9IG5ldyBBcnJheShudW0pO1xuICAgICAgICBmb3IgKGogPSBfcCA9IDAsIF9yZWY4ID0gbnVtIC0gMTsgMCA8PSBfcmVmOCA/IF9wIDw9IF9yZWY4IDogX3AgPj0gX3JlZjg7IGogPSAwIDw9IF9yZWY4ID8gKytfcCA6IC0tX3ApIHtcbiAgICAgICAgICBuZXdDZW50cm9pZHNbal0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IF9xID0gMCwgX3JlZjkgPSBuIC0gMTsgMCA8PSBfcmVmOSA/IF9xIDw9IF9yZWY5IDogX3EgPj0gX3JlZjk7IGkgPSAwIDw9IF9yZWY5ID8gKytfcSA6IC0tX3EpIHtcbiAgICAgICAgICBjbHVzdGVyID0gYXNzaWdubWVudHNbaV07XG4gICAgICAgICAgaWYgKG5ld0NlbnRyb2lkc1tjbHVzdGVyXSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgbmV3Q2VudHJvaWRzW2NsdXN0ZXJdID0gdmFsdWVzW2ldO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXdDZW50cm9pZHNbY2x1c3Rlcl0gKz0gdmFsdWVzW2ldO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGogPSBfciA9IDAsIF9yZWYxMCA9IG51bSAtIDE7IDAgPD0gX3JlZjEwID8gX3IgPD0gX3JlZjEwIDogX3IgPj0gX3JlZjEwOyBqID0gMCA8PSBfcmVmMTAgPyArK19yIDogLS1fcikge1xuICAgICAgICAgIG5ld0NlbnRyb2lkc1tqXSAqPSAxIC8gY2x1c3RlclNpemVzW2pdO1xuICAgICAgICB9XG4gICAgICAgIHJlcGVhdCA9IGZhbHNlO1xuICAgICAgICBmb3IgKGogPSBfcyA9IDAsIF9yZWYxMSA9IG51bSAtIDE7IDAgPD0gX3JlZjExID8gX3MgPD0gX3JlZjExIDogX3MgPj0gX3JlZjExOyBqID0gMCA8PSBfcmVmMTEgPyArK19zIDogLS1fcykge1xuICAgICAgICAgIGlmIChuZXdDZW50cm9pZHNbal0gIT09IGNlbnRyb2lkc1tpXSkge1xuICAgICAgICAgICAgcmVwZWF0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjZW50cm9pZHMgPSBuZXdDZW50cm9pZHM7XG4gICAgICAgIG5iX2l0ZXJzKys7XG4gICAgICAgIGlmIChuYl9pdGVycyA+IDIwMCkge1xuICAgICAgICAgIHJlcGVhdCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBrQ2x1c3RlcnMgPSB7fTtcbiAgICAgIGZvciAoaiA9IF90ID0gMCwgX3JlZjEyID0gbnVtIC0gMTsgMCA8PSBfcmVmMTIgPyBfdCA8PSBfcmVmMTIgOiBfdCA+PSBfcmVmMTI7IGogPSAwIDw9IF9yZWYxMiA/ICsrX3QgOiAtLV90KSB7XG4gICAgICAgIGtDbHVzdGVyc1tqXSA9IFtdO1xuICAgICAgfVxuICAgICAgZm9yIChpID0gX3UgPSAwLCBfcmVmMTMgPSBuIC0gMTsgMCA8PSBfcmVmMTMgPyBfdSA8PSBfcmVmMTMgOiBfdSA+PSBfcmVmMTM7IGkgPSAwIDw9IF9yZWYxMyA/ICsrX3UgOiAtLV91KSB7XG4gICAgICAgIGNsdXN0ZXIgPSBhc3NpZ25tZW50c1tpXTtcbiAgICAgICAga0NsdXN0ZXJzW2NsdXN0ZXJdLnB1c2godmFsdWVzW2ldKTtcbiAgICAgIH1cbiAgICAgIHRtcEtNZWFuc0JyZWFrcyA9IFtdO1xuICAgICAgZm9yIChqID0gX3YgPSAwLCBfcmVmMTQgPSBudW0gLSAxOyAwIDw9IF9yZWYxNCA/IF92IDw9IF9yZWYxNCA6IF92ID49IF9yZWYxNDsgaiA9IDAgPD0gX3JlZjE0ID8gKytfdiA6IC0tX3YpIHtcbiAgICAgICAgdG1wS01lYW5zQnJlYWtzLnB1c2goa0NsdXN0ZXJzW2pdWzBdKTtcbiAgICAgICAgdG1wS01lYW5zQnJlYWtzLnB1c2goa0NsdXN0ZXJzW2pdW2tDbHVzdGVyc1tqXS5sZW5ndGggLSAxXSk7XG4gICAgICB9XG4gICAgICB0bXBLTWVhbnNCcmVha3MgPSB0bXBLTWVhbnNCcmVha3Muc29ydChmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgIHJldHVybiBhIC0gYjtcbiAgICAgIH0pO1xuICAgICAgbGltaXRzLnB1c2godG1wS01lYW5zQnJlYWtzWzBdKTtcbiAgICAgIGZvciAoaSA9IF93ID0gMSwgX3JlZjE1ID0gdG1wS01lYW5zQnJlYWtzLmxlbmd0aCAtIDE7IF93IDw9IF9yZWYxNTsgaSA9IF93ICs9IDIpIHtcbiAgICAgICAgaWYgKCFpc05hTih0bXBLTWVhbnNCcmVha3NbaV0pKSB7XG4gICAgICAgICAgbGltaXRzLnB1c2godG1wS01lYW5zQnJlYWtzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbGltaXRzO1xuICB9O1xuICBjaHJvbWEuYnJld2VyID0gYnJld2VyID0ge1xuICAgIE9yUmQ6IFsnI2ZmZjdlYycsICcjZmVlOGM4JywgJyNmZGQ0OWUnLCAnI2ZkYmI4NCcsICcjZmM4ZDU5JywgJyNlZjY1NDgnLCAnI2Q3MzAxZicsICcjYjMwMDAwJywgJyM3ZjAwMDAnXSxcbiAgICBQdUJ1OiBbJyNmZmY3ZmInLCAnI2VjZTdmMicsICcjZDBkMWU2JywgJyNhNmJkZGInLCAnIzc0YTljZicsICcjMzY5MGMwJywgJyMwNTcwYjAnLCAnIzA0NWE4ZCcsICcjMDIzODU4J10sXG4gICAgQnVQdTogWycjZjdmY2ZkJywgJyNlMGVjZjQnLCAnI2JmZDNlNicsICcjOWViY2RhJywgJyM4Yzk2YzYnLCAnIzhjNmJiMScsICcjODg0MTlkJywgJyM4MTBmN2MnLCAnIzRkMDA0YiddLFxuICAgIE9yYW5nZXM6IFsnI2ZmZjVlYicsICcjZmVlNmNlJywgJyNmZGQwYTInLCAnI2ZkYWU2YicsICcjZmQ4ZDNjJywgJyNmMTY5MTMnLCAnI2Q5NDgwMScsICcjYTYzNjAzJywgJyM3ZjI3MDQnXSxcbiAgICBCdUduOiBbJyNmN2ZjZmQnLCAnI2U1ZjVmOScsICcjY2NlY2U2JywgJyM5OWQ4YzknLCAnIzY2YzJhNCcsICcjNDFhZTc2JywgJyMyMzhiNDUnLCAnIzAwNmQyYycsICcjMDA0NDFiJ10sXG4gICAgWWxPckJyOiBbJyNmZmZmZTUnLCAnI2ZmZjdiYycsICcjZmVlMzkxJywgJyNmZWM0NGYnLCAnI2ZlOTkyOScsICcjZWM3MDE0JywgJyNjYzRjMDInLCAnIzk5MzQwNCcsICcjNjYyNTA2J10sXG4gICAgWWxHbjogWycjZmZmZmU1JywgJyNmN2ZjYjknLCAnI2Q5ZjBhMycsICcjYWRkZDhlJywgJyM3OGM2NzknLCAnIzQxYWI1ZCcsICcjMjM4NDQzJywgJyMwMDY4MzcnLCAnIzAwNDUyOSddLFxuICAgIFJlZHM6IFsnI2ZmZjVmMCcsICcjZmVlMGQyJywgJyNmY2JiYTEnLCAnI2ZjOTI3MicsICcjZmI2YTRhJywgJyNlZjNiMmMnLCAnI2NiMTgxZCcsICcjYTUwZjE1JywgJyM2NzAwMGQnXSxcbiAgICBSZFB1OiBbJyNmZmY3ZjMnLCAnI2ZkZTBkZCcsICcjZmNjNWMwJywgJyNmYTlmYjUnLCAnI2Y3NjhhMScsICcjZGQzNDk3JywgJyNhZTAxN2UnLCAnIzdhMDE3NycsICcjNDkwMDZhJ10sXG4gICAgR3JlZW5zOiBbJyNmN2ZjZjUnLCAnI2U1ZjVlMCcsICcjYzdlOWMwJywgJyNhMWQ5OWInLCAnIzc0YzQ3NicsICcjNDFhYjVkJywgJyMyMzhiNDUnLCAnIzAwNmQyYycsICcjMDA0NDFiJ10sXG4gICAgWWxHbkJ1OiBbJyNmZmZmZDknLCAnI2VkZjhiMScsICcjYzdlOWI0JywgJyM3ZmNkYmInLCAnIzQxYjZjNCcsICcjMWQ5MWMwJywgJyMyMjVlYTgnLCAnIzI1MzQ5NCcsICcjMDgxZDU4J10sXG4gICAgUHVycGxlczogWycjZmNmYmZkJywgJyNlZmVkZjUnLCAnI2RhZGFlYicsICcjYmNiZGRjJywgJyM5ZTlhYzgnLCAnIzgwN2RiYScsICcjNmE1MWEzJywgJyM1NDI3OGYnLCAnIzNmMDA3ZCddLFxuICAgIEduQnU6IFsnI2Y3ZmNmMCcsICcjZTBmM2RiJywgJyNjY2ViYzUnLCAnI2E4ZGRiNScsICcjN2JjY2M0JywgJyM0ZWIzZDMnLCAnIzJiOGNiZScsICcjMDg2OGFjJywgJyMwODQwODEnXSxcbiAgICBHcmV5czogWycjZmZmZmZmJywgJyNmMGYwZjAnLCAnI2Q5ZDlkOScsICcjYmRiZGJkJywgJyM5Njk2OTYnLCAnIzczNzM3MycsICcjNTI1MjUyJywgJyMyNTI1MjUnLCAnIzAwMDAwMCddLFxuICAgIFlsT3JSZDogWycjZmZmZmNjJywgJyNmZmVkYTAnLCAnI2ZlZDk3NicsICcjZmViMjRjJywgJyNmZDhkM2MnLCAnI2ZjNGUyYScsICcjZTMxYTFjJywgJyNiZDAwMjYnLCAnIzgwMDAyNiddLFxuICAgIFB1UmQ6IFsnI2Y3ZjRmOScsICcjZTdlMWVmJywgJyNkNGI5ZGEnLCAnI2M5OTRjNycsICcjZGY2NWIwJywgJyNlNzI5OGEnLCAnI2NlMTI1NicsICcjOTgwMDQzJywgJyM2NzAwMWYnXSxcbiAgICBCbHVlczogWycjZjdmYmZmJywgJyNkZWViZjcnLCAnI2M2ZGJlZicsICcjOWVjYWUxJywgJyM2YmFlZDYnLCAnIzQyOTJjNicsICcjMjE3MWI1JywgJyMwODUxOWMnLCAnIzA4MzA2YiddLFxuICAgIFB1QnVHbjogWycjZmZmN2ZiJywgJyNlY2UyZjAnLCAnI2QwZDFlNicsICcjYTZiZGRiJywgJyM2N2E5Y2YnLCAnIzM2OTBjMCcsICcjMDI4MThhJywgJyMwMTZjNTknLCAnIzAxNDYzNiddLFxuICAgIFNwZWN0cmFsOiBbJyM5ZTAxNDInLCAnI2Q1M2U0ZicsICcjZjQ2ZDQzJywgJyNmZGFlNjEnLCAnI2ZlZTA4YicsICcjZmZmZmJmJywgJyNlNmY1OTgnLCAnI2FiZGRhNCcsICcjNjZjMmE1JywgJyMzMjg4YmQnLCAnIzVlNGZhMiddLFxuICAgIFJkWWxHbjogWycjYTUwMDI2JywgJyNkNzMwMjcnLCAnI2Y0NmQ0MycsICcjZmRhZTYxJywgJyNmZWUwOGInLCAnI2ZmZmZiZicsICcjZDllZjhiJywgJyNhNmQ5NmEnLCAnIzY2YmQ2MycsICcjMWE5ODUwJywgJyMwMDY4MzcnXSxcbiAgICBSZEJ1OiBbJyM2NzAwMWYnLCAnI2IyMTgyYicsICcjZDY2MDRkJywgJyNmNGE1ODInLCAnI2ZkZGJjNycsICcjZjdmN2Y3JywgJyNkMWU1ZjAnLCAnIzkyYzVkZScsICcjNDM5M2MzJywgJyMyMTY2YWMnLCAnIzA1MzA2MSddLFxuICAgIFBpWUc6IFsnIzhlMDE1MicsICcjYzUxYjdkJywgJyNkZTc3YWUnLCAnI2YxYjZkYScsICcjZmRlMGVmJywgJyNmN2Y3ZjcnLCAnI2U2ZjVkMCcsICcjYjhlMTg2JywgJyM3ZmJjNDEnLCAnIzRkOTIyMScsICcjMjc2NDE5J10sXG4gICAgUFJHbjogWycjNDAwMDRiJywgJyM3NjJhODMnLCAnIzk5NzBhYicsICcjYzJhNWNmJywgJyNlN2Q0ZTgnLCAnI2Y3ZjdmNycsICcjZDlmMGQzJywgJyNhNmRiYTAnLCAnIzVhYWU2MScsICcjMWI3ODM3JywgJyMwMDQ0MWInXSxcbiAgICBSZFlsQnU6IFsnI2E1MDAyNicsICcjZDczMDI3JywgJyNmNDZkNDMnLCAnI2ZkYWU2MScsICcjZmVlMDkwJywgJyNmZmZmYmYnLCAnI2UwZjNmOCcsICcjYWJkOWU5JywgJyM3NGFkZDEnLCAnIzQ1NzViNCcsICcjMzEzNjk1J10sXG4gICAgQnJCRzogWycjNTQzMDA1JywgJyM4YzUxMGEnLCAnI2JmODEyZCcsICcjZGZjMjdkJywgJyNmNmU4YzMnLCAnI2Y1ZjVmNScsICcjYzdlYWU1JywgJyM4MGNkYzEnLCAnIzM1OTc4ZicsICcjMDE2NjVlJywgJyMwMDNjMzAnXSxcbiAgICBSZEd5OiBbJyM2NzAwMWYnLCAnI2IyMTgyYicsICcjZDY2MDRkJywgJyNmNGE1ODInLCAnI2ZkZGJjNycsICcjZmZmZmZmJywgJyNlMGUwZTAnLCAnI2JhYmFiYScsICcjODc4Nzg3JywgJyM0ZDRkNGQnLCAnIzFhMWExYSddLFxuICAgIFB1T3I6IFsnIzdmM2IwOCcsICcjYjM1ODA2JywgJyNlMDgyMTQnLCAnI2ZkYjg2MycsICcjZmVlMGI2JywgJyNmN2Y3ZjcnLCAnI2Q4ZGFlYicsICcjYjJhYmQyJywgJyM4MDczYWMnLCAnIzU0Mjc4OCcsICcjMmQwMDRiJ10sXG4gICAgU2V0MjogWycjNjZjMmE1JywgJyNmYzhkNjInLCAnIzhkYTBjYicsICcjZTc4YWMzJywgJyNhNmQ4NTQnLCAnI2ZmZDkyZicsICcjZTVjNDk0JywgJyNiM2IzYjMnXSxcbiAgICBBY2NlbnQ6IFsnIzdmYzk3ZicsICcjYmVhZWQ0JywgJyNmZGMwODYnLCAnI2ZmZmY5OScsICcjMzg2Y2IwJywgJyNmMDAyN2YnLCAnI2JmNWIxNycsICcjNjY2NjY2J10sXG4gICAgU2V0MTogWycjZTQxYTFjJywgJyMzNzdlYjgnLCAnIzRkYWY0YScsICcjOTg0ZWEzJywgJyNmZjdmMDAnLCAnI2ZmZmYzMycsICcjYTY1NjI4JywgJyNmNzgxYmYnLCAnIzk5OTk5OSddLFxuICAgIFNldDM6IFsnIzhkZDNjNycsICcjZmZmZmIzJywgJyNiZWJhZGEnLCAnI2ZiODA3MicsICcjODBiMWQzJywgJyNmZGI0NjInLCAnI2IzZGU2OScsICcjZmNjZGU1JywgJyNkOWQ5ZDknLCAnI2JjODBiZCcsICcjY2NlYmM1JywgJyNmZmVkNmYnXSxcbiAgICBEYXJrMjogWycjMWI5ZTc3JywgJyNkOTVmMDInLCAnIzc1NzBiMycsICcjZTcyOThhJywgJyM2NmE2MWUnLCAnI2U2YWIwMicsICcjYTY3NjFkJywgJyM2NjY2NjYnXSxcbiAgICBQYWlyZWQ6IFsnI2E2Y2VlMycsICcjMWY3OGI0JywgJyNiMmRmOGEnLCAnIzMzYTAyYycsICcjZmI5YTk5JywgJyNlMzFhMWMnLCAnI2ZkYmY2ZicsICcjZmY3ZjAwJywgJyNjYWIyZDYnLCAnIzZhM2Q5YScsICcjZmZmZjk5JywgJyNiMTU5MjgnXSxcbiAgICBQYXN0ZWwyOiBbJyNiM2UyY2QnLCAnI2ZkY2RhYycsICcjY2JkNWU4JywgJyNmNGNhZTQnLCAnI2U2ZjVjOScsICcjZmZmMmFlJywgJyNmMWUyY2MnLCAnI2NjY2NjYyddLFxuICAgIFBhc3RlbDE6IFsnI2ZiYjRhZScsICcjYjNjZGUzJywgJyNjY2ViYzUnLCAnI2RlY2JlNCcsICcjZmVkOWE2JywgJyNmZmZmY2MnLCAnI2U1ZDhiZCcsICcjZmRkYWVjJywgJyNmMmYyZjInXVxuICB9O1xuICBjaHJvbWEuY29sb3JzID0gY29sb3JzID0ge1xuICAgIGluZGlnbzogXCIjNGIwMDgyXCIsXG4gICAgZ29sZDogXCIjZmZkNzAwXCIsXG4gICAgaG90cGluazogXCIjZmY2OWI0XCIsXG4gICAgZmlyZWJyaWNrOiBcIiNiMjIyMjJcIixcbiAgICBpbmRpYW5yZWQ6IFwiI2NkNWM1Y1wiLFxuICAgIHllbGxvdzogXCIjZmZmZjAwXCIsXG4gICAgbWlzdHlyb3NlOiBcIiNmZmU0ZTFcIixcbiAgICBkYXJrb2xpdmVncmVlbjogXCIjNTU2YjJmXCIsXG4gICAgb2xpdmU6IFwiIzgwODAwMFwiLFxuICAgIGRhcmtzZWFncmVlbjogXCIjOGZiYzhmXCIsXG4gICAgcGluazogXCIjZmZjMGNiXCIsXG4gICAgdG9tYXRvOiBcIiNmZjYzNDdcIixcbiAgICBsaWdodGNvcmFsOiBcIiNmMDgwODBcIixcbiAgICBvcmFuZ2VyZWQ6IFwiI2ZmNDUwMFwiLFxuICAgIG5hdmFqb3doaXRlOiBcIiNmZmRlYWRcIixcbiAgICBsaW1lOiBcIiMwMGZmMDBcIixcbiAgICBwYWxlZ3JlZW46IFwiIzk4ZmI5OFwiLFxuICAgIGRhcmtzbGF0ZWdyZXk6IFwiIzJmNGY0ZlwiLFxuICAgIGdyZWVueWVsbG93OiBcIiNhZGZmMmZcIixcbiAgICBidXJseXdvb2Q6IFwiI2RlYjg4N1wiLFxuICAgIHNlYXNoZWxsOiBcIiNmZmY1ZWVcIixcbiAgICBtZWRpdW1zcHJpbmdncmVlbjogXCIjMDBmYTlhXCIsXG4gICAgZnVjaHNpYTogXCIjZmYwMGZmXCIsXG4gICAgcGFwYXlhd2hpcDogXCIjZmZlZmQ1XCIsXG4gICAgYmxhbmNoZWRhbG1vbmQ6IFwiI2ZmZWJjZFwiLFxuICAgIGNoYXJ0cmV1c2U6IFwiIzdmZmYwMFwiLFxuICAgIGRpbWdyYXk6IFwiIzY5Njk2OVwiLFxuICAgIGJsYWNrOiBcIiMwMDAwMDBcIixcbiAgICBwZWFjaHB1ZmY6IFwiI2ZmZGFiOVwiLFxuICAgIHNwcmluZ2dyZWVuOiBcIiMwMGZmN2ZcIixcbiAgICBhcXVhbWFyaW5lOiBcIiM3ZmZmZDRcIixcbiAgICB3aGl0ZTogXCIjZmZmZmZmXCIsXG4gICAgb3JhbmdlOiBcIiNmZmE1MDBcIixcbiAgICBsaWdodHNhbG1vbjogXCIjZmZhMDdhXCIsXG4gICAgZGFya3NsYXRlZ3JheTogXCIjMmY0ZjRmXCIsXG4gICAgYnJvd246IFwiI2E1MmEyYVwiLFxuICAgIGl2b3J5OiBcIiNmZmZmZjBcIixcbiAgICBkb2RnZXJibHVlOiBcIiMxZTkwZmZcIixcbiAgICBwZXJ1OiBcIiNjZDg1M2ZcIixcbiAgICBsYXduZ3JlZW46IFwiIzdjZmMwMFwiLFxuICAgIGNob2NvbGF0ZTogXCIjZDI2OTFlXCIsXG4gICAgY3JpbXNvbjogXCIjZGMxNDNjXCIsXG4gICAgZm9yZXN0Z3JlZW46IFwiIzIyOGIyMlwiLFxuICAgIGRhcmtncmV5OiBcIiNhOWE5YTlcIixcbiAgICBsaWdodHNlYWdyZWVuOiBcIiMyMGIyYWFcIixcbiAgICBjeWFuOiBcIiMwMGZmZmZcIixcbiAgICBtaW50Y3JlYW06IFwiI2Y1ZmZmYVwiLFxuICAgIHNpbHZlcjogXCIjYzBjMGMwXCIsXG4gICAgYW50aXF1ZXdoaXRlOiBcIiNmYWViZDdcIixcbiAgICBtZWRpdW1vcmNoaWQ6IFwiI2JhNTVkM1wiLFxuICAgIHNreWJsdWU6IFwiIzg3Y2VlYlwiLFxuICAgIGdyYXk6IFwiIzgwODA4MFwiLFxuICAgIGRhcmt0dXJxdW9pc2U6IFwiIzAwY2VkMVwiLFxuICAgIGdvbGRlbnJvZDogXCIjZGFhNTIwXCIsXG4gICAgZGFya2dyZWVuOiBcIiMwMDY0MDBcIixcbiAgICBmbG9yYWx3aGl0ZTogXCIjZmZmYWYwXCIsXG4gICAgZGFya3Zpb2xldDogXCIjOTQwMGQzXCIsXG4gICAgZGFya2dyYXk6IFwiI2E5YTlhOVwiLFxuICAgIG1vY2Nhc2luOiBcIiNmZmU0YjVcIixcbiAgICBzYWRkbGVicm93bjogXCIjOGI0NTEzXCIsXG4gICAgZ3JleTogXCIjODA4MDgwXCIsXG4gICAgZGFya3NsYXRlYmx1ZTogXCIjNDgzZDhiXCIsXG4gICAgbGlnaHRza3libHVlOiBcIiM4N2NlZmFcIixcbiAgICBsaWdodHBpbms6IFwiI2ZmYjZjMVwiLFxuICAgIG1lZGl1bXZpb2xldHJlZDogXCIjYzcxNTg1XCIsXG4gICAgc2xhdGVncmV5OiBcIiM3MDgwOTBcIixcbiAgICByZWQ6IFwiI2ZmMDAwMFwiLFxuICAgIGRlZXBwaW5rOiBcIiNmZjE0OTNcIixcbiAgICBsaW1lZ3JlZW46IFwiIzMyY2QzMlwiLFxuICAgIGRhcmttYWdlbnRhOiBcIiM4YjAwOGJcIixcbiAgICBwYWxlZ29sZGVucm9kOiBcIiNlZWU4YWFcIixcbiAgICBwbHVtOiBcIiNkZGEwZGRcIixcbiAgICB0dXJxdW9pc2U6IFwiIzQwZTBkMFwiLFxuICAgIGxpZ2h0Z3JleTogXCIjZDNkM2QzXCIsXG4gICAgbGlnaHRnb2xkZW5yb2R5ZWxsb3c6IFwiI2ZhZmFkMlwiLFxuICAgIGRhcmtnb2xkZW5yb2Q6IFwiI2I4ODYwYlwiLFxuICAgIGxhdmVuZGVyOiBcIiNlNmU2ZmFcIixcbiAgICBtYXJvb246IFwiIzgwMDAwMFwiLFxuICAgIHllbGxvd2dyZWVuOiBcIiM5YWNkMzJcIixcbiAgICBzYW5keWJyb3duOiBcIiNmNGE0NjBcIixcbiAgICB0aGlzdGxlOiBcIiNkOGJmZDhcIixcbiAgICB2aW9sZXQ6IFwiI2VlODJlZVwiLFxuICAgIG5hdnk6IFwiIzAwMDA4MFwiLFxuICAgIG1hZ2VudGE6IFwiI2ZmMDBmZlwiLFxuICAgIGRpbWdyZXk6IFwiIzY5Njk2OVwiLFxuICAgIHRhbjogXCIjZDJiNDhjXCIsXG4gICAgcm9zeWJyb3duOiBcIiNiYzhmOGZcIixcbiAgICBvbGl2ZWRyYWI6IFwiIzZiOGUyM1wiLFxuICAgIGJsdWU6IFwiIzAwMDBmZlwiLFxuICAgIGxpZ2h0Ymx1ZTogXCIjYWRkOGU2XCIsXG4gICAgZ2hvc3R3aGl0ZTogXCIjZjhmOGZmXCIsXG4gICAgaG9uZXlkZXc6IFwiI2YwZmZmMFwiLFxuICAgIGNvcm5mbG93ZXJibHVlOiBcIiM2NDk1ZWRcIixcbiAgICBzbGF0ZWJsdWU6IFwiIzZhNWFjZFwiLFxuICAgIGxpbmVuOiBcIiNmYWYwZTZcIixcbiAgICBkYXJrYmx1ZTogXCIjMDAwMDhiXCIsXG4gICAgcG93ZGVyYmx1ZTogXCIjYjBlMGU2XCIsXG4gICAgc2VhZ3JlZW46IFwiIzJlOGI1N1wiLFxuICAgIGRhcmtraGFraTogXCIjYmRiNzZiXCIsXG4gICAgc25vdzogXCIjZmZmYWZhXCIsXG4gICAgc2llbm5hOiBcIiNhMDUyMmRcIixcbiAgICBtZWRpdW1ibHVlOiBcIiMwMDAwY2RcIixcbiAgICByb3lhbGJsdWU6IFwiIzQxNjllMVwiLFxuICAgIGxpZ2h0Y3lhbjogXCIjZTBmZmZmXCIsXG4gICAgZ3JlZW46IFwiIzAwODAwMFwiLFxuICAgIG1lZGl1bXB1cnBsZTogXCIjOTM3MGRiXCIsXG4gICAgbWlkbmlnaHRibHVlOiBcIiMxOTE5NzBcIixcbiAgICBjb3Juc2lsazogXCIjZmZmOGRjXCIsXG4gICAgcGFsZXR1cnF1b2lzZTogXCIjYWZlZWVlXCIsXG4gICAgYmlzcXVlOiBcIiNmZmU0YzRcIixcbiAgICBzbGF0ZWdyYXk6IFwiIzcwODA5MFwiLFxuICAgIGRhcmtjeWFuOiBcIiMwMDhiOGJcIixcbiAgICBraGFraTogXCIjZjBlNjhjXCIsXG4gICAgd2hlYXQ6IFwiI2Y1ZGViM1wiLFxuICAgIHRlYWw6IFwiIzAwODA4MFwiLFxuICAgIGRhcmtvcmNoaWQ6IFwiIzk5MzJjY1wiLFxuICAgIGRlZXBza3libHVlOiBcIiMwMGJmZmZcIixcbiAgICBzYWxtb246IFwiI2ZhODA3MlwiLFxuICAgIGRhcmtyZWQ6IFwiIzhiMDAwMFwiLFxuICAgIHN0ZWVsYmx1ZTogXCIjNDY4MmI0XCIsXG4gICAgcGFsZXZpb2xldHJlZDogXCIjZGI3MDkzXCIsXG4gICAgbGlnaHRzbGF0ZWdyYXk6IFwiIzc3ODg5OVwiLFxuICAgIGFsaWNlYmx1ZTogXCIjZjBmOGZmXCIsXG4gICAgbGlnaHRzbGF0ZWdyZXk6IFwiIzc3ODg5OVwiLFxuICAgIGxpZ2h0Z3JlZW46IFwiIzkwZWU5MFwiLFxuICAgIG9yY2hpZDogXCIjZGE3MGQ2XCIsXG4gICAgZ2FpbnNib3JvOiBcIiNkY2RjZGNcIixcbiAgICBtZWRpdW1zZWFncmVlbjogXCIjM2NiMzcxXCIsXG4gICAgbGlnaHRncmF5OiBcIiNkM2QzZDNcIixcbiAgICBtZWRpdW10dXJxdW9pc2U6IFwiIzQ4ZDFjY1wiLFxuICAgIGxlbW9uY2hpZmZvbjogXCIjZmZmYWNkXCIsXG4gICAgY2FkZXRibHVlOiBcIiM1ZjllYTBcIixcbiAgICBsaWdodHllbGxvdzogXCIjZmZmZmUwXCIsXG4gICAgbGF2ZW5kZXJibHVzaDogXCIjZmZmMGY1XCIsXG4gICAgY29yYWw6IFwiI2ZmN2Y1MFwiLFxuICAgIHB1cnBsZTogXCIjODAwMDgwXCIsXG4gICAgYXF1YTogXCIjMDBmZmZmXCIsXG4gICAgd2hpdGVzbW9rZTogXCIjZjVmNWY1XCIsXG4gICAgbWVkaXVtc2xhdGVibHVlOiBcIiM3YjY4ZWVcIixcbiAgICBkYXJrb3JhbmdlOiBcIiNmZjhjMDBcIixcbiAgICBtZWRpdW1hcXVhbWFyaW5lOiBcIiM2NmNkYWFcIixcbiAgICBkYXJrc2FsbW9uOiBcIiNlOTk2N2FcIixcbiAgICBiZWlnZTogXCIjZjVmNWRjXCIsXG4gICAgYmx1ZXZpb2xldDogXCIjOGEyYmUyXCIsXG4gICAgYXp1cmU6IFwiI2YwZmZmZlwiLFxuICAgIGxpZ2h0c3RlZWxibHVlOiBcIiNiMGM0ZGVcIixcbiAgICBvbGRsYWNlOiBcIiNmZGY1ZTZcIlxuICB9O1xuICB0eXBlID0gKGZ1bmN0aW9uKCkge1xuICAgIHZhciBjbGFzc1RvVHlwZSxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgX2ksXG4gICAgICAgIF9sZW4sXG4gICAgICAgIF9yZWYxO1xuICAgIGNsYXNzVG9UeXBlID0ge307XG4gICAgX3JlZjEgPSBcIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBVbmRlZmluZWQgTnVsbFwiLnNwbGl0KFwiIFwiKTtcbiAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYxLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICBuYW1lID0gX3JlZjFbX2ldO1xuICAgICAgY2xhc3NUb1R5cGVbXCJbb2JqZWN0IFwiICsgbmFtZSArIFwiXVwiXSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikge1xuICAgICAgdmFyIHN0clR5cGU7XG4gICAgICBzdHJUeXBlID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaik7XG4gICAgICByZXR1cm4gY2xhc3NUb1R5cGVbc3RyVHlwZV0gfHwgXCJvYmplY3RcIjtcbiAgICB9O1xuICB9KSgpO1xuICBsaW1pdCA9IGZ1bmN0aW9uKHgsIG1pbiwgbWF4KSB7XG4gICAgaWYgKG1pbiA9PSBudWxsKSB7XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICBpZiAobWF4ID09IG51bGwpIHtcbiAgICAgIG1heCA9IDE7XG4gICAgfVxuICAgIGlmICh4IDwgbWluKSB7XG4gICAgICB4ID0gbWluO1xuICAgIH1cbiAgICBpZiAoeCA+IG1heCkge1xuICAgICAgeCA9IG1heDtcbiAgICB9XG4gICAgcmV0dXJuIHg7XG4gIH07XG4gIHVucGFjayA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPj0gMykge1xuICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBhcmdzWzBdO1xuICAgIH1cbiAgfTtcbiAgVFdPUEkgPSBNYXRoLlBJICogMjtcbiAgUElUSElSRCA9IE1hdGguUEkgLyAzO1xuICBjb3MgPSBNYXRoLmNvcztcbiAgYmV6aWVyID0gZnVuY3Rpb24oY29sb3JzKSB7XG4gICAgdmFyIEksXG4gICAgICAgIEkwLFxuICAgICAgICBJMSxcbiAgICAgICAgYyxcbiAgICAgICAgbGFiMCxcbiAgICAgICAgbGFiMSxcbiAgICAgICAgbGFiMixcbiAgICAgICAgbGFiMyxcbiAgICAgICAgX3JlZjEsXG4gICAgICAgIF9yZWYyLFxuICAgICAgICBfcmVmMztcbiAgICBjb2xvcnMgPSAoZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgX2ksXG4gICAgICAgICAgX2xlbixcbiAgICAgICAgICBfcmVzdWx0cztcbiAgICAgIF9yZXN1bHRzID0gW107XG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGNvbG9ycy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xuICAgICAgICBjID0gY29sb3JzW19pXTtcbiAgICAgICAgX3Jlc3VsdHMucHVzaChjaHJvbWEoYykpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIF9yZXN1bHRzO1xuICAgIH0pKCk7XG4gICAgaWYgKGNvbG9ycy5sZW5ndGggPT09IDIpIHtcbiAgICAgIF9yZWYxID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgX2ksXG4gICAgICAgICAgICBfbGVuLFxuICAgICAgICAgICAgX3Jlc3VsdHM7XG4gICAgICAgIF9yZXN1bHRzID0gW107XG4gICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gY29sb3JzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICAgICAgYyA9IGNvbG9yc1tfaV07XG4gICAgICAgICAgX3Jlc3VsdHMucHVzaChjLmxhYigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3Jlc3VsdHM7XG4gICAgICB9KSgpLCBsYWIwID0gX3JlZjFbMF0sIGxhYjEgPSBfcmVmMVsxXTtcbiAgICAgIEkgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHZhciBpLFxuICAgICAgICAgICAgbGFiO1xuICAgICAgICBsYWIgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIF9pLFxuICAgICAgICAgICAgICBfcmVzdWx0cztcbiAgICAgICAgICBfcmVzdWx0cyA9IFtdO1xuICAgICAgICAgIGZvciAoaSA9IF9pID0gMDsgX2kgPD0gMjsgaSA9ICsrX2kpIHtcbiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2gobGFiMFtpXSArIHQgKiAobGFiMVtpXSAtIGxhYjBbaV0pKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIF9yZXN1bHRzO1xuICAgICAgICB9KSgpO1xuICAgICAgICByZXR1cm4gY2hyb21hLmxhYi5hcHBseShjaHJvbWEsIGxhYik7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAoY29sb3JzLmxlbmd0aCA9PT0gMykge1xuICAgICAgX3JlZjIgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBfaSxcbiAgICAgICAgICAgIF9sZW4sXG4gICAgICAgICAgICBfcmVzdWx0cztcbiAgICAgICAgX3Jlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBjb2xvcnMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcbiAgICAgICAgICBjID0gY29sb3JzW19pXTtcbiAgICAgICAgICBfcmVzdWx0cy5wdXNoKGMubGFiKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfcmVzdWx0cztcbiAgICAgIH0pKCksIGxhYjAgPSBfcmVmMlswXSwgbGFiMSA9IF9yZWYyWzFdLCBsYWIyID0gX3JlZjJbMl07XG4gICAgICBJID0gZnVuY3Rpb24odCkge1xuICAgICAgICB2YXIgaSxcbiAgICAgICAgICAgIGxhYjtcbiAgICAgICAgbGFiID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBfaSxcbiAgICAgICAgICAgICAgX3Jlc3VsdHM7XG4gICAgICAgICAgX3Jlc3VsdHMgPSBbXTtcbiAgICAgICAgICBmb3IgKGkgPSBfaSA9IDA7IF9pIDw9IDI7IGkgPSArK19pKSB7XG4gICAgICAgICAgICBfcmVzdWx0cy5wdXNoKCgxIC0gdCkgKiAoMSAtIHQpICogbGFiMFtpXSArIDIgKiAoMSAtIHQpICogdCAqIGxhYjFbaV0gKyB0ICogdCAqIGxhYjJbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gX3Jlc3VsdHM7XG4gICAgICAgIH0pKCk7XG4gICAgICAgIHJldHVybiBjaHJvbWEubGFiLmFwcGx5KGNocm9tYSwgbGFiKTtcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmIChjb2xvcnMubGVuZ3RoID09PSA0KSB7XG4gICAgICBfcmVmMyA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIF9pLFxuICAgICAgICAgICAgX2xlbixcbiAgICAgICAgICAgIF9yZXN1bHRzO1xuICAgICAgICBfcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGNvbG9ycy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xuICAgICAgICAgIGMgPSBjb2xvcnNbX2ldO1xuICAgICAgICAgIF9yZXN1bHRzLnB1c2goYy5sYWIoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9yZXN1bHRzO1xuICAgICAgfSkoKSwgbGFiMCA9IF9yZWYzWzBdLCBsYWIxID0gX3JlZjNbMV0sIGxhYjIgPSBfcmVmM1syXSwgbGFiMyA9IF9yZWYzWzNdO1xuICAgICAgSSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdmFyIGksXG4gICAgICAgICAgICBsYWI7XG4gICAgICAgIGxhYiA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgX2ksXG4gICAgICAgICAgICAgIF9yZXN1bHRzO1xuICAgICAgICAgIF9yZXN1bHRzID0gW107XG4gICAgICAgICAgZm9yIChpID0gX2kgPSAwOyBfaSA8PSAyOyBpID0gKytfaSkge1xuICAgICAgICAgICAgX3Jlc3VsdHMucHVzaCgoMSAtIHQpICogKDEgLSB0KSAqICgxIC0gdCkgKiBsYWIwW2ldICsgMyAqICgxIC0gdCkgKiAoMSAtIHQpICogdCAqIGxhYjFbaV0gKyAzICogKDEgLSB0KSAqIHQgKiB0ICogbGFiMltpXSArIHQgKiB0ICogdCAqIGxhYjNbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gX3Jlc3VsdHM7XG4gICAgICAgIH0pKCk7XG4gICAgICAgIHJldHVybiBjaHJvbWEubGFiLmFwcGx5KGNocm9tYSwgbGFiKTtcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmIChjb2xvcnMubGVuZ3RoID09PSA1KSB7XG4gICAgICBJMCA9IGJlemllcihjb2xvcnMuc2xpY2UoMCwgMykpO1xuICAgICAgSTEgPSBiZXppZXIoY29sb3JzLnNsaWNlKDIsIDUpKTtcbiAgICAgIEkgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGlmICh0IDwgMC41KSB7XG4gICAgICAgICAgcmV0dXJuIEkwKHQgKiAyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gSTEoKHQgLSAwLjUpICogMik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBJO1xuICB9O1xuICBjaHJvbWEuaW50ZXJwb2xhdGUuYmV6aWVyID0gYmV6aWVyO1xufSkuY2FsbCh0aGlzKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9ib3dlcl9jb21wb25lbnRzL2Nocm9tYS1qcy9jaHJvbWEuanNcbiAqKiBtb2R1bGUgaWQgPSAzNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGxpc3QgPSBbXTtcbiAgbGlzdC50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBpdGVtID0gdGhpc1tpXTtcbiAgICAgIGlmIChpdGVtWzJdKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKFwiQG1lZGlhIFwiICsgaXRlbVsyXSArIFwie1wiICsgaXRlbVsxXSArIFwifVwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKGl0ZW1bMV0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0LmpvaW4oXCJcIik7XG4gIH07XG4gIHJldHVybiBsaXN0O1xufTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2Nzcy1sb2FkZXIvY3NzVG9TdHJpbmcuanNcbiAqKiBtb2R1bGUgaWQgPSAzN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiZGVmaW5lKFsnanF1ZXJ5JywgJ2JsdWViaXJkJywgJy4vdXRpbC9taXNjLmpzJywgJy4vdXRpbC9rZWZpci1zaWduYWwtaGFuZGxlci5qcycsICcuL3V0aWwvdW5pcXVlLWlkLmpzJywgJy4vdXRpbC9tYWluLWRlbHRhLW1vZGVsLmpzJywgJy4vdXRpbC9wbHVnaW4uanMnLCAnLi91dGlsL2RlZmVyLmpzJ10sIGZ1bmN0aW9uKCQsIFAsIFUsIEtlZmlyU2lnbmFsSGFuZGxlciwgdW5pcXVlSUQsIGRtLCBwbHVnaW4sIGRlZmVyKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgcmV0dXJuIHBsdWdpbi5zZWxlY3RlZC50aGVuKChmdW5jdGlvbigpIHtcbiAgICBpZiAoVS5pc0RlZmluZWQod2luZG93Ll9hbXlfQXJ0ZWZhY3QpKSB7XG4gICAgICByZXR1cm4gd2luZG93Ll9hbXlfQXJ0ZWZhY3Q7XG4gICAgfVxuICAgIHdpbmRvdy5fYW15X0FydGVmYWN0ID0gZG0udnAoJ0FydGVmYWN0JywgVS5uZXdTdWJjbGFzcyhLZWZpclNpZ25hbEhhbmRsZXIsIChmdW5jdGlvbihzdXBlckZuKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gQXJ0ZWZhY3Qob3B0aW9ucykge1xuICAgICAgICBzdXBlckZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB2YXIgJF9fMSA9IG9wdGlvbnMsXG4gICAgICAgICAgICBpZCA9ICRfXzEuaWQsXG4gICAgICAgICAgICB0eXBlID0gJF9fMS50eXBlLFxuICAgICAgICAgICAgcGFyZW50ID0gJF9fMS5wYXJlbnQsXG4gICAgICAgICAgICBiZWZvcmVDb25zdHJ1Y3Rpb24gPSAkX18xLmJlZm9yZUNvbnN0cnVjdGlvbjtcbiAgICAgICAgdGhpcy5faWQgPSBpZCB8fCB1bmlxdWVJRCh0eXBlKTtcbiAgICAgICAgdGhpcy5fdHlwZSA9IHR5cGU7XG4gICAgICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5fY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgIFUuYXJyYXkocGFyZW50LCAnX2NoaWxkcmVuJykucHVzaCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5ld0V2ZW50KCdkZXN0cm95Jyk7XG4gICAgICAgIHRoaXMuYmVmb3JlQ29uc3RydWN0aW9uKGJlZm9yZUNvbnN0cnVjdGlvbik7XG4gICAgICAgIGlmICh0aGlzLnJvb3QgPT09IHRoaXMpIHtcbiAgICAgICAgICB0aGlzLl9hcnRlZmFjdHNCeUlEID0ge307XG4gICAgICAgICAgdGhpcy5fcmVnaXN0ZXJBcnRlZmFjdCA9IGZ1bmN0aW9uKGFydGVmYWN0KSB7XG4gICAgICAgICAgICBVLmdldERlZih0aGlzLl9hcnRlZmFjdHNCeUlELCBhcnRlZmFjdC5pZCwgZGVmZXIpLnJlc29sdmUoYXJ0ZWZhY3QpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSksIHtcbiAgICAgIGJlZm9yZUNvbnN0cnVjdGlvbjogZnVuY3Rpb24ocG9zc2libGVQcm9taXNlKSB7XG4gICAgICAgIGlmICghcG9zc2libGVQcm9taXNlIHx8ICEkLmlzRnVuY3Rpb24ocG9zc2libGVQcm9taXNlLnRoZW4pKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5jb25zdHJ1Y3RlZCkge1xuICAgICAgICAgIHRoaXMuY29uc3RydWN0ZWQgPSBQLnJlc29sdmUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25zdHJ1Y3RlZCA9IHRoaXMuY29uc3RydWN0ZWQudGFwKChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gUC5yZXNvbHZlKHBvc3NpYmxlUHJvbWlzZSk7XG4gICAgICAgIH0pKTtcbiAgICAgIH0sXG4gICAgICBnZXQgb3B0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbnM7XG4gICAgICB9LFxuICAgICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgICB9LFxuICAgICAgZ2V0IHR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgfSxcbiAgICAgIGdldCBwYXJlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXJlbnQ7XG4gICAgICB9LFxuICAgICAgZ2V0IGNoaWxkcmVuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47XG4gICAgICB9LFxuICAgICAgZ2V0IHJvb3QoKSB7XG4gICAgICAgIGlmICghdGhpcy5fcm9vdCkge1xuICAgICAgICAgIHRoaXMuX3Jvb3QgPSB0aGlzLnBhcmVudCA/IHRoaXMucGFyZW50LnJvb3QgOiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9yb290O1xuICAgICAgfSxcbiAgICAgIGFydGVmYWN0QnlJZDogZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgcmV0dXJuIFUuZ2V0RGVmKHRoaXMucm9vdC5fYXJ0ZWZhY3RzQnlJRCwgaWQsIGRlZmVyKS5wcm9taXNlO1xuICAgICAgfSxcbiAgICAgIHRyYXZlcnNlQXJ0ZWZhY3RzOiBmdW5jdGlvbihmbikge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50c1sxXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgICAgICAgdmFyIG9yZGVyID0gb3B0aW9ucy5vcmRlcjtcbiAgICAgICAgaWYgKCFvcmRlcikge1xuICAgICAgICAgIG9yZGVyID0gJ3ByZWZpeCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yZGVyID09PSAncHJlZml4Jykge1xuICAgICAgICAgIGZuKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgICBjaGlsZC50cmF2ZXJzZUFydGVmYWN0cyhmbiwgb3B0aW9ucyk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgaWYgKG9yZGVyID09PSAncG9zdGZpeCcpIHtcbiAgICAgICAgICBmbih0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHRyYXZlcnNlQXJ0ZWZhY3RzQnlUeXBlOiBmdW5jdGlvbih0eXBlLCBmbikge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50c1syXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMl0gOiB7fTtcbiAgICAgICAgdmFyIG9yZGVyID0gb3B0aW9ucy5vcmRlcjtcbiAgICAgICAgaWYgKCFvcmRlcikge1xuICAgICAgICAgIG9yZGVyID0gJ3ByZWZpeCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yZGVyID09PSAncHJlZml4JyAmJiB0aGlzLnR5cGUgPT09IHR5cGUpIHtcbiAgICAgICAgICBmbih0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy5iZWZvcmVHb2luZ0luKSB7XG4gICAgICAgICAgb3B0aW9ucy5iZWZvcmVHb2luZ0luKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xvc2VzdERlc2NlbmRhbnRzQnlUeXBlKHR5cGUpLmZvckVhY2goKGZ1bmN0aW9uKGRlc2NlbmRlbnQpIHtcbiAgICAgICAgICBkZXNjZW5kZW50LnRyYXZlcnNlQXJ0ZWZhY3RzQnlUeXBlKHR5cGUsIGZuLCBvcHRpb25zKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBpZiAob3B0aW9ucy5iZWZvcmVHb2luZ091dCkge1xuICAgICAgICAgIG9wdGlvbnMuYmVmb3JlR29pbmdPdXQodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yZGVyID09PSAncG9zdGZpeCcgJiYgdGhpcy50eXBlID09PSB0eXBlKSB7XG4gICAgICAgICAgZm4odGhpcyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjbG9zZXN0QW5jZXN0b3JCeVR5cGU6IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXM7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICByZXN1bHQgPSByZXN1bHQucGFyZW50O1xuICAgICAgICB9IHdoaWxlIChyZXN1bHQgJiYgcmVzdWx0LnR5cGUgJiYgcmVzdWx0LnR5cGUgIT09IHR5cGUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSxcbiAgICAgIGNsb3Nlc3REZXNjZW5kYW50c0J5VHlwZTogZnVuY3Rpb24odHlwZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgICBpZiAoY2hpbGQudHlwZSA9PT0gdHlwZSkge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goY2hpbGQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KGNoaWxkLmNsb3Nlc3REZXNjZW5kYW50c0J5VHlwZSh0eXBlKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9LFxuICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudHJpZ2dlcignZGVzdHJveScpO1xuICAgICAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goKGZ1bmN0aW9uKGNoaWxkKSB7XG4gICAgICAgICAgY2hpbGQuZGVzdHJveSgpO1xuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfSkpO1xuICAgIHdpbmRvdy5fYW15X0FydGVmYWN0Lm5ld1N1YmNsYXNzID0gZnVuY3Rpb24gbmV3U3ViQ2xhc3MobmFtZSwgY29uc3RydWN0b3IpIHtcbiAgICAgIHZhciBwcm90b3R5cGUgPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDoge307XG4gICAgICB2YXIgb3B0aW9uRGVmYXVsdHMgPSBhcmd1bWVudHNbM10gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzNdIDoge307XG4gICAgICByZXR1cm4gZG0udnAobmFtZSwgVS5uZXdTdWJjbGFzcyh3aW5kb3cuX2FteV9BcnRlZmFjdCwgKGZ1bmN0aW9uKHN1cGVyRm4pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICAgICAgICAgIHZhciAkX18wID0gdGhpcztcbiAgICAgICAgICB2YXIgcHJvY2Vzc2VkT3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgT2JqZWN0LmtleXMob3B0aW9uRGVmYXVsdHMpLmZvckVhY2goKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgaWYgKFUuaXNVbmRlZmluZWQocHJvY2Vzc2VkT3B0aW9uc1trZXldKSkge1xuICAgICAgICAgICAgICBwcm9jZXNzZWRPcHRpb25zW2tleV0gPSBvcHRpb25EZWZhdWx0c1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgICBwcm9jZXNzZWRPcHRpb25zLnR5cGUgPSBuYW1lO1xuICAgICAgICAgIHN1cGVyRm4uY2FsbCh0aGlzLCBVLmV4dGVuZChvcHRpb25zLCBwcm9jZXNzZWRPcHRpb25zKSk7XG4gICAgICAgICAgY29uc3RydWN0b3IuY2FsbCh0aGlzLCBwcm9jZXNzZWRPcHRpb25zKTtcbiAgICAgICAgICBpZiAodGhpcy5jb25zdHJ1Y3RlZCkge1xuICAgICAgICAgICAgdGhpcy5jb25zdHJ1Y3RlZCA9IHRoaXMuY29uc3RydWN0ZWQudGhlbigoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGlmICgkLmlzRnVuY3Rpb24oJF9fMC5jb25zdHJ1Y3QpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFAucmVzb2x2ZSgkX18wLmNvbnN0cnVjdChvcHRpb25zKSkucmV0dXJuKCRfXzApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiAkX18wO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoJC5pc0Z1bmN0aW9uKHRoaXMuY29uc3RydWN0KSkge1xuICAgICAgICAgICAgdGhpcy5iZWZvcmVDb25zdHJ1Y3Rpb24odGhpcy5jb25zdHJ1Y3Qob3B0aW9ucykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAodGhpcy5jb25zdHJ1Y3RlZCB8fCBQLnJlc29sdmUoKSkudGhlbigoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkX18wLnJvb3QuX3JlZ2lzdGVyQXJ0ZWZhY3QoJF9fMCk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICB9O1xuICAgICAgfSksIFUuZXh0ZW5kKHt9LCBwcm90b3R5cGUsIHtnZXQgY2lyY3VpdGJvYXJkKCkge1xuICAgICAgICAgIGlmICghdGhpcy5fY2lyY3VpdGJvYXJkKSB7XG4gICAgICAgICAgICB0aGlzLl9jaXJjdWl0Ym9hcmQgPSB0aGlzLmNsb3Nlc3RBbmNlc3RvckJ5VHlwZSgnQ2lyY3VpdGJvYXJkJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aGlzLl9jaXJjdWl0Ym9hcmQ7XG4gICAgICAgIH19KSkpO1xuICAgIH07XG4gICAgcmV0dXJuIHdpbmRvdy5fYW15X0FydGVmYWN0O1xuICB9KSkudGFwKChmdW5jdGlvbihjKSB7XG4gICAgJC5jaXJjdWl0Ym9hcmQuQXJ0ZWZhY3QgPSBjO1xuICB9KSk7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvQXJ0ZWZhY3QuanNcbiAqKiBtb2R1bGUgaWQgPSAzOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuZGVmaW5lKFsnanF1ZXJ5JywgJy4vbWlzYy5qcycsICcuL2tlZmlyLWFuZC1lZ2dzLmpzJ10sIGZ1bmN0aW9uKCQsIFUsIEtlZmlyKSB7XG4gIHZhciBLZWZpclNpZ25hbEhhbmRsZXIgPSBVLm5ld0NsYXNzKGZ1bmN0aW9uIEtlZmlyU2lnbmFsSGFuZGxlcigpIHtcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICB0aGlzLl9wcm9wZXJ0aWVzID0ge307XG4gICAgdGhpcy5fcHJvcGVydHlCdXNzZXMgPSB7fTtcbiAgfSwge1xuICAgIG5ld0V2ZW50OiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICB2YXIgc291cmNlID0gKGFyZ3VtZW50c1sxXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMV0gOiB7fSkuc291cmNlO1xuICAgICAgVS5hc3NlcnQoIXRoaXMuX2V2ZW50c1tuYW1lXSwgKFwiVGhlcmUgaXMgYWxyZWFkeSBhbiBldmVudCAnXCIgKyBuYW1lICsgXCInIG9uIHRoaXMgb2JqZWN0LlwiKSk7XG4gICAgICBVLmFzc2VydCghdGhpcy5fcHJvcGVydGllc1tuYW1lXSwgKFwiVGhlcmUgaXMgYWxyZWFkeSBhIHByb3BlcnR5ICdcIiArIG5hbWUgKyBcIicgb24gdGhpcyBvYmplY3QuXCIpKTtcbiAgICAgIHZhciBidXMgPSBLZWZpci5idXMoKTtcbiAgICAgIGlmIChzb3VyY2UpIHtcbiAgICAgICAgYnVzLnBsdWcoc291cmNlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl9ldmVudHNbbmFtZV0gPSBidXM7XG4gICAgfSxcbiAgICBldmVudDogZnVuY3Rpb24obmFtZSkge1xuICAgICAgVS5hc3NlcnQodGhpcy5fZXZlbnRzW25hbWVdLCAoXCJUaGVyZSBpcyBubyBldmVudCAnXCIgKyBuYW1lICsgXCInIG9uIHRoaXMgb2JqZWN0LlwiKSk7XG4gICAgICByZXR1cm4gdGhpcy5fZXZlbnRzW25hbWVdO1xuICAgIH0sXG4gICAgcHJvcGVydHk6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wcm9wZXJ0aWVzW25hbWVdO1xuICAgIH0sXG4gICAgcDogZnVuY3Rpb24obmFtZSkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Byb3BlcnRpZXNbbmFtZV07XG4gICAgfSxcbiAgICBuZXdQcm9wZXJ0eTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgdmFyICRfXzEgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDoge30sXG4gICAgICAgICAgc2V0dGFibGUgPSAkX18xLnNldHRhYmxlLFxuICAgICAgICAgIGluaXRpYWwgPSAkX18xLmluaXRpYWwsXG4gICAgICAgICAgaXNFcXVhbCA9ICRfXzEuaXNFcXVhbDtcbiAgICAgIFUuYXNzZXJ0KCF0aGlzLl9ldmVudHNbbmFtZV0sIChcIlRoZXJlIGlzIGFscmVhZHkgYW4gZXZlbnQgJ1wiICsgbmFtZSArIFwiJyBvbiB0aGlzIG9iamVjdC5cIikpO1xuICAgICAgVS5hc3NlcnQoIXRoaXMuX3Byb3BlcnRpZXNbbmFtZV0sIChcIlRoZXJlIGlzIGFscmVhZHkgYSBwcm9wZXJ0eSAnXCIgKyBuYW1lICsgXCInIG9uIHRoaXMgb2JqZWN0LlwiKSk7XG4gICAgICBpZiAoVS5pc1VuZGVmaW5lZChzZXR0YWJsZSkpIHtcbiAgICAgICAgc2V0dGFibGUgPSB0cnVlO1xuICAgICAgfVxuICAgICAgdmFyIGJ1cyA9IEtlZmlyLmJ1cygpO1xuICAgICAgdmFyIHByb3BlcnR5ID0gdGhpcy5fcHJvcGVydGllc1tuYW1lXSA9IGJ1cy50b1Byb3BlcnR5KGluaXRpYWwpLnNraXBEdXBsaWNhdGVzKGlzRXF1YWwpO1xuICAgICAgcHJvcGVydHkucGx1ZyA9IChmdW5jdGlvbihvYnNlcnZhYmxlKSB7XG4gICAgICAgIGJ1cy5wbHVnKG9ic2VydmFibGUpO1xuICAgICAgICByZXR1cm4gcHJvcGVydHk7XG4gICAgICB9KTtcbiAgICAgIHByb3BlcnR5LnVucGx1ZyA9IChmdW5jdGlvbihvYnNlcnZhYmxlKSB7XG4gICAgICAgIGJ1cy51bnBsdWcob2JzZXJ2YWJsZSk7XG4gICAgICAgIHJldHVybiBwcm9wZXJ0eTtcbiAgICAgIH0pO1xuICAgICAgcHJvcGVydHkuZ2V0ID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvcGVydHkuX2N1cnJlbnQ7XG4gICAgICB9KTtcbiAgICAgIGlmIChzZXR0YWJsZSkge1xuICAgICAgICBwcm9wZXJ0eS5zZXQgPSAoZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBidXMuZW1pdCh2YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuIHByb3BlcnR5O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBuYW1lLCB7XG4gICAgICAgIGdldDogcHJvcGVydHkuZ2V0LFxuICAgICAgICBzZXQ6IHNldHRhYmxlID8gcHJvcGVydHkuc2V0IDogdW5kZWZpbmVkXG4gICAgICB9KTtcbiAgICAgIHByb3BlcnR5LnJ1bigpO1xuICAgICAgdGhpcy5ldmVudCgnZGVzdHJveScpLm9uVmFsdWUoKGZ1bmN0aW9uKCkge1xuICAgICAgICBidXMuZW5kKCk7XG4gICAgICB9KSk7XG4gICAgICByZXR1cm4gcHJvcGVydHk7XG4gICAgfSxcbiAgICB0cmlnZ2VyOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgICAgVS5hc3NlcnQodGhpcy5fZXZlbnRzW25hbWVdLCAoXCJUaGVyZSBpcyBubyBldmVudCAnXCIgKyBuYW1lICsgXCInIG9uIHRoaXMgb2JqZWN0LlwiKSk7XG4gICAgICB0aGlzLl9ldmVudHNbbmFtZV0uZW1pdCh2YWx1ZSk7XG4gICAgfSxcbiAgICBvbjogZnVuY3Rpb24obmFtZSwgZXhwZWN0ZWRWYWx1ZSwgb3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICAgIHZhciBhcmdzT2JqID0gdGhpcy5fZ2F0aGVyT25Bcmd1bWVudHMobmFtZSwgZXhwZWN0ZWRWYWx1ZSwgb3B0aW9ucywgY2FsbGJhY2spO1xuICAgICAgcmV0dXJuIHRoaXMuX29uKGFyZ3NPYmopO1xuICAgIH0sXG4gICAgX29uOiBmdW5jdGlvbigkX18xKSB7XG4gICAgICB2YXIgJF9fMiA9ICRfXzEsXG4gICAgICAgICAgbmFtZSA9ICRfXzIubmFtZSxcbiAgICAgICAgICBleHBlY3RlZFZhbHVlID0gJF9fMi5leHBlY3RlZFZhbHVlLFxuICAgICAgICAgIGNhbGxiYWNrID0gJF9fMi5jYWxsYmFjaztcbiAgICAgIFUuYXNzZXJ0KHRoaXMuX2V2ZW50c1tuYW1lXSB8fCB0aGlzLl9wcm9wZXJ0aWVzW25hbWVdLCAoXCJUaGVyZSBpcyBubyBldmVudCBvciBwcm9wZXJ0eSAnXCIgKyBuYW1lICsgXCInIG9uIHRoaXMgb2JqZWN0LlwiKSk7XG4gICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fZXZlbnRzW25hbWVdIHx8IHRoaXMuX3Byb3BlcnRpZXNbbmFtZV07XG4gICAgICBpZiAoVS5pc0RlZmluZWQoZXhwZWN0ZWRWYWx1ZSkpIHtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmZpbHRlcigoZnVuY3Rpb24odikge1xuICAgICAgICAgIHJldHVybiB2ID09PSBleHBlY3RlZFZhbHVlO1xuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0Lm9uVmFsdWUoY2FsbGJhY2spO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuICAgIF9nYXRoZXJPbkFyZ3VtZW50czogZnVuY3Rpb24oKSB7XG4gICAgICBmb3IgKHZhciBhcmdzID0gW10sXG4gICAgICAgICAgJF9fMCA9IDA7ICRfXzAgPCBhcmd1bWVudHMubGVuZ3RoOyAkX18wKyspXG4gICAgICAgIGFyZ3NbJF9fMF0gPSBhcmd1bWVudHNbJF9fMF07XG4gICAgICB2YXIgcmVzdWx0ID0ge25hbWU6IGFyZ3Muc2hpZnQoKX07XG4gICAgICBpZiAoVS5pc0RlZmluZWQoYXJnc1swXSkgJiYgIVUuaXNGdW5jdGlvbihhcmdzWzBdKSAmJiAhVS5pc1BsYWluT2JqZWN0KGFyZ3NbMF0pKSB7XG4gICAgICAgIHJlc3VsdC5leHBlY3RlZFZhbHVlID0gYXJncy5zaGlmdCgpO1xuICAgICAgfVxuICAgICAgaWYgKFUuaXNEZWZpbmVkKGFyZ3NbMF0pICYmIFUuaXNGdW5jdGlvbihhcmdzWzBdKSkge1xuICAgICAgICByZXN1bHQuY2FsbGJhY2sgPSBhcmdzLnNoaWZ0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBLZWZpclNpZ25hbEhhbmRsZXI7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvdXRpbC9rZWZpci1zaWduYWwtaGFuZGxlci5qc1xuICoqIG1vZHVsZSBpZCA9IDM5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJkZWZpbmUoWydibHVlYmlyZCcsICdkZWx0YS1qcyddLCBmdW5jdGlvbihQLCBETSkge1xuICAndXNlIHN0cmljdCc7XG4gIGlmICh3aW5kb3cuX19hcGluYXRvbXlfY29yZV9kZWx0YV9tb2RlbCkge1xuICAgIHJldHVybiB3aW5kb3cuX19hcGluYXRvbXlfY29yZV9kZWx0YV9tb2RlbDtcbiAgfVxuICBETS5yZWdpc3RlclByb21pc2VSZXNvbHZlcihQLnJlc29sdmUpO1xuICB3aW5kb3cuX19hcGluYXRvbXlfY29yZV9kZWx0YV9tb2RlbCA9IG5ldyBETSgpO1xuICByZXR1cm4gd2luZG93Ll9fYXBpbmF0b215X2NvcmVfZGVsdGFfbW9kZWw7XG59KTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvdXRpbC9tYWluLWRlbHRhLW1vZGVsLmpzXG4gKiogbW9kdWxlIGlkID0gNDBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcbnByb2Nlc3MubmV4dFRpY2sgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBjYW5TZXRJbW1lZGlhdGUgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuc2V0SW1tZWRpYXRlO1xuICB2YXIgY2FuTXV0YXRpb25PYnNlcnZlciA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyO1xuICB2YXIgY2FuUG9zdCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wb3N0TWVzc2FnZSAmJiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcjtcbiAgO1xuICBpZiAoY2FuU2V0SW1tZWRpYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGYpIHtcbiAgICAgIHJldHVybiB3aW5kb3cuc2V0SW1tZWRpYXRlKGYpO1xuICAgIH07XG4gIH1cbiAgdmFyIHF1ZXVlID0gW107XG4gIGlmIChjYW5NdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgdmFyIGhpZGRlbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcXVldWVMaXN0ID0gcXVldWUuc2xpY2UoKTtcbiAgICAgIHF1ZXVlLmxlbmd0aCA9IDA7XG4gICAgICBxdWV1ZUxpc3QuZm9yRWFjaChmdW5jdGlvbihmbikge1xuICAgICAgICBmbigpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShoaWRkZW5EaXYsIHthdHRyaWJ1dGVzOiB0cnVlfSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHRUaWNrKGZuKSB7XG4gICAgICBpZiAoIXF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBoaWRkZW5EaXYuc2V0QXR0cmlidXRlKCd5ZXMnLCAnbm8nKTtcbiAgICAgIH1cbiAgICAgIHF1ZXVlLnB1c2goZm4pO1xuICAgIH07XG4gIH1cbiAgaWYgKGNhblBvc3QpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uKGV2KSB7XG4gICAgICB2YXIgc291cmNlID0gZXYuc291cmNlO1xuICAgICAgaWYgKChzb3VyY2UgPT09IHdpbmRvdyB8fCBzb3VyY2UgPT09IG51bGwpICYmIGV2LmRhdGEgPT09ICdwcm9jZXNzLXRpY2snKSB7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBpZiAocXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHZhciBmbiA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgZm4oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHRydWUpO1xuICAgIHJldHVybiBmdW5jdGlvbiBuZXh0VGljayhmbikge1xuICAgICAgcXVldWUucHVzaChmbik7XG4gICAgICB3aW5kb3cucG9zdE1lc3NhZ2UoJ3Byb2Nlc3MtdGljaycsICcqJyk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcbiAgICBzZXRUaW1lb3V0KGZuLCAwKTtcbiAgfTtcbn0pKCk7XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbmZ1bmN0aW9uIG5vb3AoKSB7fVxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbihuYW1lKSB7XG4gIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gJy8nO1xufTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbihkaXIpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqICh3ZWJwYWNrKS9+L25vZGUtbGlicy1icm93c2VyL34vcHJvY2Vzcy9icm93c2VyLmpzXG4gKiogbW9kdWxlIGlkID0gNDFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIjtcbihmdW5jdGlvbihnbG9iYWwpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG4gIHZhciBLZWZpciA9IHt9O1xuICBmdW5jdGlvbiBhbmQoKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghYXJndW1lbnRzW2ldKSB7XG4gICAgICAgIHJldHVybiBhcmd1bWVudHNbaV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcmd1bWVudHNbaSAtIDFdO1xuICB9XG4gIGZ1bmN0aW9uIG9yKCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYXJndW1lbnRzW2ldKSB7XG4gICAgICAgIHJldHVybiBhcmd1bWVudHNbaV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcmd1bWVudHNbaSAtIDFdO1xuICB9XG4gIGZ1bmN0aW9uIG5vdCh4KSB7XG4gICAgcmV0dXJuICF4O1xuICB9XG4gIGZ1bmN0aW9uIGNvbmNhdChhLCBiKSB7XG4gICAgdmFyIHJlc3VsdCxcbiAgICAgICAgbGVuZ3RoLFxuICAgICAgICBpLFxuICAgICAgICBqO1xuICAgIGlmIChhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGI7XG4gICAgfVxuICAgIGlmIChiLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGE7XG4gICAgfVxuICAgIGogPSAwO1xuICAgIHJlc3VsdCA9IG5ldyBBcnJheShhLmxlbmd0aCArIGIubGVuZ3RoKTtcbiAgICBsZW5ndGggPSBhLmxlbmd0aDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyssIGorKykge1xuICAgICAgcmVzdWx0W2pdID0gYVtpXTtcbiAgICB9XG4gICAgbGVuZ3RoID0gYi5sZW5ndGg7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrLCBqKyspIHtcbiAgICAgIHJlc3VsdFtqXSA9IGJbaV07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgZnVuY3Rpb24gZmluZChhcnIsIHZhbHVlKSB7XG4gICAgdmFyIGxlbmd0aCA9IGFyci5sZW5ndGgsXG4gICAgICAgIGk7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYXJyW2ldID09PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9XG4gIGZ1bmN0aW9uIGZpbmRCeVByZWQoYXJyLCBwcmVkKSB7XG4gICAgdmFyIGxlbmd0aCA9IGFyci5sZW5ndGgsXG4gICAgICAgIGk7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAocHJlZChhcnJbaV0pKSB7XG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH1cbiAgZnVuY3Rpb24gY2xvbmVBcnJheShpbnB1dCkge1xuICAgIHZhciBsZW5ndGggPSBpbnB1dC5sZW5ndGgsXG4gICAgICAgIHJlc3VsdCA9IG5ldyBBcnJheShsZW5ndGgpLFxuICAgICAgICBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0W2ldID0gaW5wdXRbaV07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgZnVuY3Rpb24gcmVtb3ZlKGlucHV0LCBpbmRleCkge1xuICAgIHZhciBsZW5ndGggPSBpbnB1dC5sZW5ndGgsXG4gICAgICAgIHJlc3VsdCxcbiAgICAgICAgaSxcbiAgICAgICAgajtcbiAgICBpZiAoaW5kZXggPj0gMCAmJiBpbmRleCA8IGxlbmd0aCkge1xuICAgICAgaWYgKGxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBuZXcgQXJyYXkobGVuZ3RoIC0gMSk7XG4gICAgICAgIGZvciAoaSA9IDAsIGogPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoaSAhPT0gaW5kZXgpIHtcbiAgICAgICAgICAgIHJlc3VsdFtqXSA9IGlucHV0W2ldO1xuICAgICAgICAgICAgaisrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIHJlbW92ZUJ5UHJlZChpbnB1dCwgcHJlZCkge1xuICAgIHJldHVybiByZW1vdmUoaW5wdXQsIGZpbmRCeVByZWQoaW5wdXQsIHByZWQpKTtcbiAgfVxuICBmdW5jdGlvbiBtYXAoaW5wdXQsIGZuKSB7XG4gICAgdmFyIGxlbmd0aCA9IGlucHV0Lmxlbmd0aCxcbiAgICAgICAgcmVzdWx0ID0gbmV3IEFycmF5KGxlbmd0aCksXG4gICAgICAgIGk7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRbaV0gPSBmbihpbnB1dFtpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgZnVuY3Rpb24gZm9yRWFjaChhcnIsIGZuKSB7XG4gICAgdmFyIGxlbmd0aCA9IGFyci5sZW5ndGgsXG4gICAgICAgIGk7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBmbihhcnJbaV0pO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBmaWxsQXJyYXkoYXJyLCB2YWx1ZSkge1xuICAgIHZhciBsZW5ndGggPSBhcnIubGVuZ3RoLFxuICAgICAgICBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgYXJyW2ldID0gdmFsdWU7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGNvbnRhaW5zKGFyciwgdmFsdWUpIHtcbiAgICByZXR1cm4gZmluZChhcnIsIHZhbHVlKSAhPT0gLTE7XG4gIH1cbiAgZnVuY3Rpb24gcmVzdChhcnIsIHN0YXJ0LCBvbkVtcHR5KSB7XG4gICAgaWYgKGFyci5sZW5ndGggPiBzdGFydCkge1xuICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyciwgc3RhcnQpO1xuICAgIH1cbiAgICByZXR1cm4gb25FbXB0eTtcbiAgfVxuICBmdW5jdGlvbiBzbGlkZShjdXIsIG5leHQsIG1heCkge1xuICAgIHZhciBsZW5ndGggPSBNYXRoLm1pbihtYXgsIGN1ci5sZW5ndGggKyAxKSxcbiAgICAgICAgb2Zmc2V0ID0gY3VyLmxlbmd0aCAtIGxlbmd0aCArIDEsXG4gICAgICAgIHJlc3VsdCA9IG5ldyBBcnJheShsZW5ndGgpLFxuICAgICAgICBpO1xuICAgIGZvciAoaSA9IG9mZnNldDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRbaSAtIG9mZnNldF0gPSBjdXJbaV07XG4gICAgfVxuICAgIHJlc3VsdFtsZW5ndGggLSAxXSA9IG5leHQ7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICBmdW5jdGlvbiBpc0VxdWFsQXJyYXlzKGEsIGIpIHtcbiAgICB2YXIgbGVuZ3RoLFxuICAgICAgICBpO1xuICAgIGlmIChhID09IG51bGwgJiYgYiA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGEgPT0gbnVsbCB8fCBiID09IG51bGwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBhLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYVtpXSAhPT0gYltpXSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGZ1bmN0aW9uIHNwcmVhZChmbiwgbGVuZ3RoKSB7XG4gICAgc3dpdGNoIChsZW5ndGgpIHtcbiAgICAgIGNhc2UgMDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgICByZXR1cm4gZm4oKTtcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgICByZXR1cm4gZm4oYVswXSk7XG4gICAgICAgIH07XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihhKSB7XG4gICAgICAgICAgcmV0dXJuIGZuKGFbMF0sIGFbMV0pO1xuICAgICAgICB9O1xuICAgICAgY2FzZSAzOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oYSkge1xuICAgICAgICAgIHJldHVybiBmbihhWzBdLCBhWzFdLCBhWzJdKTtcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgNDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgICByZXR1cm4gZm4oYVswXSwgYVsxXSwgYVsyXSwgYVszXSk7XG4gICAgICAgIH07XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oYSkge1xuICAgICAgICAgIHJldHVybiBmbi5hcHBseShudWxsLCBhKTtcbiAgICAgICAgfTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gYXBwbHkoZm4sIGMsIGEpIHtcbiAgICB2YXIgYUxlbmd0aCA9IGEgPyBhLmxlbmd0aCA6IDA7XG4gICAgaWYgKGMgPT0gbnVsbCkge1xuICAgICAgc3dpdGNoIChhTGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICByZXR1cm4gZm4oKTtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIHJldHVybiBmbihhWzBdKTtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHJldHVybiBmbihhWzBdLCBhWzFdKTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHJldHVybiBmbihhWzBdLCBhWzFdLCBhWzJdKTtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHJldHVybiBmbihhWzBdLCBhWzFdLCBhWzJdLCBhWzNdKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXR1cm4gZm4uYXBwbHkobnVsbCwgYSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN3aXRjaCAoYUxlbmd0aCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgcmV0dXJuIGZuLmNhbGwoYyk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KGMsIGEpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBnZXQobWFwLCBrZXksIG5vdEZvdW5kKSB7XG4gICAgaWYgKG1hcCAmJiBrZXkgaW4gbWFwKSB7XG4gICAgICByZXR1cm4gbWFwW2tleV07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBub3RGb3VuZDtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gb3duKG9iaiwgcHJvcCkge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbiAgfVxuICBmdW5jdGlvbiBjcmVhdGVPYmoocHJvdG8pIHtcbiAgICB2YXIgRiA9IGZ1bmN0aW9uKCkge307XG4gICAgRi5wcm90b3R5cGUgPSBwcm90bztcbiAgICByZXR1cm4gbmV3IEYoKTtcbiAgfVxuICBmdW5jdGlvbiBleHRlbmQodGFyZ2V0KSB7XG4gICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgIGksXG4gICAgICAgIHByb3A7XG4gICAgZm9yIChpID0gMTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKHByb3AgaW4gYXJndW1lbnRzW2ldKSB7XG4gICAgICAgIHRhcmdldFtwcm9wXSA9IGFyZ3VtZW50c1tpXVtwcm9wXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfVxuICBmdW5jdGlvbiBpbmhlcml0KENoaWxkLCBQYXJlbnQpIHtcbiAgICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aCxcbiAgICAgICAgaTtcbiAgICBDaGlsZC5wcm90b3R5cGUgPSBjcmVhdGVPYmooUGFyZW50LnByb3RvdHlwZSk7XG4gICAgQ2hpbGQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2hpbGQ7XG4gICAgZm9yIChpID0gMjsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBleHRlbmQoQ2hpbGQucHJvdG90eXBlLCBhcmd1bWVudHNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gQ2hpbGQ7XG4gIH1cbiAgdmFyIE5PVEhJTkcgPSBbJzxub3RoaW5nPiddO1xuICB2YXIgRU5EID0gJ2VuZCc7XG4gIHZhciBWQUxVRSA9ICd2YWx1ZSc7XG4gIHZhciBFUlJPUiA9ICdlcnJvcic7XG4gIHZhciBBTlkgPSAnYW55JztcbiAgZnVuY3Rpb24gbm9vcCgpIHt9XG4gIGZ1bmN0aW9uIGlkKHgpIHtcbiAgICByZXR1cm4geDtcbiAgfVxuICBmdW5jdGlvbiBzdHJpY3RFcXVhbChhLCBiKSB7XG4gICAgcmV0dXJuIGEgPT09IGI7XG4gIH1cbiAgZnVuY3Rpb24gZGVmYXVsdERpZmYoYSwgYikge1xuICAgIHJldHVybiBbYSwgYl07XG4gIH1cbiAgdmFyIG5vdyA9IERhdGUubm93ID8gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIERhdGUubm93KCk7XG4gIH0gOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gIH07XG4gIGZ1bmN0aW9uIGlzRm4oZm4pIHtcbiAgICByZXR1cm4gdHlwZW9mIGZuID09PSAnZnVuY3Rpb24nO1xuICB9XG4gIGZ1bmN0aW9uIGlzVW5kZWZpbmVkKHgpIHtcbiAgICByZXR1cm4gdHlwZW9mIHggPT09ICd1bmRlZmluZWQnO1xuICB9XG4gIGZ1bmN0aW9uIGlzQXJyYXlMaWtlKHhzKSB7XG4gICAgcmV0dXJuIGlzQXJyYXkoeHMpIHx8IGlzQXJndW1lbnRzKHhzKTtcbiAgfVxuICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24oeHMpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHhzKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgfTtcbiAgdmFyIGlzQXJndW1lbnRzID0gZnVuY3Rpb24oeHMpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHhzKSA9PT0gJ1tvYmplY3QgQXJndW1lbnRzXSc7XG4gIH07XG4gIGlmICghaXNBcmd1bWVudHMoYXJndW1lbnRzKSkge1xuICAgIGlzQXJndW1lbnRzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gISEob2JqICYmIG93bihvYmosICdjYWxsZWUnKSk7XG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiB3aXRoSW50ZXJ2YWwobmFtZSwgbWl4aW4pIHtcbiAgICBmdW5jdGlvbiBBbm9ueW1vdXNTdHJlYW0od2FpdCwgYXJncykge1xuICAgICAgU3RyZWFtLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLl93YWl0ID0gd2FpdDtcbiAgICAgIHRoaXMuX2ludGVydmFsSWQgPSBudWxsO1xuICAgICAgdmFyICQgPSB0aGlzO1xuICAgICAgdGhpcy5fJG9uVGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkLl9vblRpY2soKTtcbiAgICAgIH07XG4gICAgICB0aGlzLl9pbml0KGFyZ3MpO1xuICAgIH1cbiAgICBpbmhlcml0KEFub255bW91c1N0cmVhbSwgU3RyZWFtLCB7XG4gICAgICBfbmFtZTogbmFtZSxcbiAgICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7fSxcbiAgICAgIF9mcmVlOiBmdW5jdGlvbigpIHt9LFxuICAgICAgX29uVGljazogZnVuY3Rpb24oKSB7fSxcbiAgICAgIF9vbkFjdGl2YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9pbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwodGhpcy5fJG9uVGljaywgdGhpcy5fd2FpdCk7XG4gICAgICB9LFxuICAgICAgX29uRGVhY3RpdmF0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2ludGVydmFsSWQgIT09IG51bGwpIHtcbiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuX2ludGVydmFsSWQpO1xuICAgICAgICAgIHRoaXMuX2ludGVydmFsSWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgX2NsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgU3RyZWFtLnByb3RvdHlwZS5fY2xlYXIuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fJG9uVGljayA9IG51bGw7XG4gICAgICAgIHRoaXMuX2ZyZWUoKTtcbiAgICAgIH1cbiAgICB9LCBtaXhpbik7XG4gICAgS2VmaXJbbmFtZV0gPSBmdW5jdGlvbih3YWl0KSB7XG4gICAgICByZXR1cm4gbmV3IEFub255bW91c1N0cmVhbSh3YWl0LCByZXN0KGFyZ3VtZW50cywgMSwgW10pKTtcbiAgICB9O1xuICB9XG4gIGZ1bmN0aW9uIHdpdGhPbmVTb3VyY2UobmFtZSwgbWl4aW4sIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gZXh0ZW5kKHtcbiAgICAgIHN0cmVhbU1ldGhvZDogZnVuY3Rpb24oU3RyZWFtQ2xhc3MsIFByb3BlcnR5Q2xhc3MpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBuZXcgU3RyZWFtQ2xhc3ModGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICBwcm9wZXJ0eU1ldGhvZDogZnVuY3Rpb24oU3RyZWFtQ2xhc3MsIFByb3BlcnR5Q2xhc3MpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBuZXcgUHJvcGVydHlDbGFzcyh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sIG9wdGlvbnMgfHwge30pO1xuICAgIG1peGluID0gZXh0ZW5kKHtcbiAgICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7fSxcbiAgICAgIF9mcmVlOiBmdW5jdGlvbigpIHt9LFxuICAgICAgX2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgeCwgaXNDdXJyZW50KTtcbiAgICAgIH0sXG4gICAgICBfaGFuZGxlRXJyb3I6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgICB0aGlzLl9zZW5kKEVSUk9SLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgfSxcbiAgICAgIF9oYW5kbGVFbmQ6IGZ1bmN0aW9uKF9fLCBpc0N1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGlzQ3VycmVudCk7XG4gICAgICB9LFxuICAgICAgX2hhbmRsZUFueTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICAgICAgY2FzZSBWQUxVRTpcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVZhbHVlKGV2ZW50LnZhbHVlLCBldmVudC5jdXJyZW50KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgRVJST1I6XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVFcnJvcihldmVudC52YWx1ZSwgZXZlbnQuY3VycmVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEVORDpcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUVuZChldmVudC52YWx1ZSwgZXZlbnQuY3VycmVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIF9vbkFjdGl2YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9zb3VyY2Uub25BbnkodGhpcy5fJGhhbmRsZUFueSk7XG4gICAgICB9LFxuICAgICAgX29uRGVhY3RpdmF0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fc291cmNlLm9mZkFueSh0aGlzLl8kaGFuZGxlQW55KTtcbiAgICAgIH1cbiAgICB9LCBtaXhpbiB8fCB7fSk7XG4gICAgZnVuY3Rpb24gYnVpbGRDbGFzcyhCYXNlQ2xhc3MpIHtcbiAgICAgIGZ1bmN0aW9uIEFub255bW91c09ic2VydmFibGUoc291cmNlLCBhcmdzKSB7XG4gICAgICAgIEJhc2VDbGFzcy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9zb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIHRoaXMuX25hbWUgPSBzb3VyY2UuX25hbWUgKyAnLicgKyBuYW1lO1xuICAgICAgICB0aGlzLl9pbml0KGFyZ3MpO1xuICAgICAgICB2YXIgJCA9IHRoaXM7XG4gICAgICAgIHRoaXMuXyRoYW5kbGVBbnkgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICQuX2hhbmRsZUFueShldmVudCk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpbmhlcml0KEFub255bW91c09ic2VydmFibGUsIEJhc2VDbGFzcywge19jbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgQmFzZUNsYXNzLnByb3RvdHlwZS5fY2xlYXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICB0aGlzLl9zb3VyY2UgPSBudWxsO1xuICAgICAgICAgIHRoaXMuXyRoYW5kbGVBbnkgPSBudWxsO1xuICAgICAgICAgIHRoaXMuX2ZyZWUoKTtcbiAgICAgICAgfX0sIG1peGluKTtcbiAgICAgIHJldHVybiBBbm9ueW1vdXNPYnNlcnZhYmxlO1xuICAgIH1cbiAgICB2YXIgQW5vbnltb3VzU3RyZWFtID0gYnVpbGRDbGFzcyhTdHJlYW0pO1xuICAgIHZhciBBbm9ueW1vdXNQcm9wZXJ0eSA9IGJ1aWxkQ2xhc3MoUHJvcGVydHkpO1xuICAgIGlmIChvcHRpb25zLnN0cmVhbU1ldGhvZCkge1xuICAgICAgU3RyZWFtLnByb3RvdHlwZVtuYW1lXSA9IG9wdGlvbnMuc3RyZWFtTWV0aG9kKEFub255bW91c1N0cmVhbSwgQW5vbnltb3VzUHJvcGVydHkpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5wcm9wZXJ0eU1ldGhvZCkge1xuICAgICAgUHJvcGVydHkucHJvdG90eXBlW25hbWVdID0gb3B0aW9ucy5wcm9wZXJ0eU1ldGhvZChBbm9ueW1vdXNTdHJlYW0sIEFub255bW91c1Byb3BlcnR5KTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gd2l0aFR3b1NvdXJjZXMobmFtZSwgbWl4aW4pIHtcbiAgICBtaXhpbiA9IGV4dGVuZCh7XG4gICAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge30sXG4gICAgICBfZnJlZTogZnVuY3Rpb24oKSB7fSxcbiAgICAgIF9oYW5kbGVQcmltYXJ5VmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgfSxcbiAgICAgIF9oYW5kbGVQcmltYXJ5RXJyb3I6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgICB0aGlzLl9zZW5kKEVSUk9SLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgfSxcbiAgICAgIF9oYW5kbGVQcmltYXJ5RW5kOiBmdW5jdGlvbihfXywgaXNDdXJyZW50KSB7XG4gICAgICAgIHRoaXMuX3NlbmQoRU5ELCBudWxsLCBpc0N1cnJlbnQpO1xuICAgICAgfSxcbiAgICAgIF9oYW5kbGVTZWNvbmRhcnlWYWx1ZTogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICAgIHRoaXMuX2xhc3RTZWNvbmRhcnkgPSB4O1xuICAgICAgfSxcbiAgICAgIF9oYW5kbGVTZWNvbmRhcnlFcnJvcjogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICAgIHRoaXMuX3NlbmQoRVJST1IsIHgsIGlzQ3VycmVudCk7XG4gICAgICB9LFxuICAgICAgX2hhbmRsZVNlY29uZGFyeUVuZDogZnVuY3Rpb24oX18sIGlzQ3VycmVudCkge30sXG4gICAgICBfaGFuZGxlUHJpbWFyeUFueTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICAgICAgY2FzZSBWQUxVRTpcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVByaW1hcnlWYWx1ZShldmVudC52YWx1ZSwgZXZlbnQuY3VycmVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEVSUk9SOlxuICAgICAgICAgICAgdGhpcy5faGFuZGxlUHJpbWFyeUVycm9yKGV2ZW50LnZhbHVlLCBldmVudC5jdXJyZW50KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgRU5EOlxuICAgICAgICAgICAgdGhpcy5faGFuZGxlUHJpbWFyeUVuZChldmVudC52YWx1ZSwgZXZlbnQuY3VycmVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIF9oYW5kbGVTZWNvbmRhcnlBbnk6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICAgICAgIGNhc2UgVkFMVUU6XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVTZWNvbmRhcnlWYWx1ZShldmVudC52YWx1ZSwgZXZlbnQuY3VycmVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEVSUk9SOlxuICAgICAgICAgICAgdGhpcy5faGFuZGxlU2Vjb25kYXJ5RXJyb3IoZXZlbnQudmFsdWUsIGV2ZW50LmN1cnJlbnQpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBFTkQ6XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVTZWNvbmRhcnlFbmQoZXZlbnQudmFsdWUsIGV2ZW50LmN1cnJlbnQpO1xuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlU2Vjb25kYXJ5KCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIF9yZW1vdmVTZWNvbmRhcnk6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5fc2Vjb25kYXJ5ICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5fc2Vjb25kYXJ5Lm9mZkFueSh0aGlzLl8kaGFuZGxlU2Vjb25kYXJ5QW55KTtcbiAgICAgICAgICB0aGlzLl8kaGFuZGxlU2Vjb25kYXJ5QW55ID0gbnVsbDtcbiAgICAgICAgICB0aGlzLl9zZWNvbmRhcnkgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgX29uQWN0aXZhdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9zZWNvbmRhcnkgIT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLl9zZWNvbmRhcnkub25BbnkodGhpcy5fJGhhbmRsZVNlY29uZGFyeUFueSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2FsaXZlKSB7XG4gICAgICAgICAgdGhpcy5fcHJpbWFyeS5vbkFueSh0aGlzLl8kaGFuZGxlUHJpbWFyeUFueSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBfb25EZWFjdGl2YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5fc2Vjb25kYXJ5ICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5fc2Vjb25kYXJ5Lm9mZkFueSh0aGlzLl8kaGFuZGxlU2Vjb25kYXJ5QW55KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wcmltYXJ5Lm9mZkFueSh0aGlzLl8kaGFuZGxlUHJpbWFyeUFueSk7XG4gICAgICB9XG4gICAgfSwgbWl4aW4gfHwge30pO1xuICAgIGZ1bmN0aW9uIGJ1aWxkQ2xhc3MoQmFzZUNsYXNzKSB7XG4gICAgICBmdW5jdGlvbiBBbm9ueW1vdXNPYnNlcnZhYmxlKHByaW1hcnksIHNlY29uZGFyeSwgYXJncykge1xuICAgICAgICBCYXNlQ2xhc3MuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fcHJpbWFyeSA9IHByaW1hcnk7XG4gICAgICAgIHRoaXMuX3NlY29uZGFyeSA9IHNlY29uZGFyeTtcbiAgICAgICAgdGhpcy5fbmFtZSA9IHByaW1hcnkuX25hbWUgKyAnLicgKyBuYW1lO1xuICAgICAgICB0aGlzLl9sYXN0U2Vjb25kYXJ5ID0gTk9USElORztcbiAgICAgICAgdmFyICQgPSB0aGlzO1xuICAgICAgICB0aGlzLl8kaGFuZGxlU2Vjb25kYXJ5QW55ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAkLl9oYW5kbGVTZWNvbmRhcnlBbnkoZXZlbnQpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLl8kaGFuZGxlUHJpbWFyeUFueSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgJC5faGFuZGxlUHJpbWFyeUFueShldmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2luaXQoYXJncyk7XG4gICAgICB9XG4gICAgICBpbmhlcml0KEFub255bW91c09ic2VydmFibGUsIEJhc2VDbGFzcywge19jbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgQmFzZUNsYXNzLnByb3RvdHlwZS5fY2xlYXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICB0aGlzLl9wcmltYXJ5ID0gbnVsbDtcbiAgICAgICAgICB0aGlzLl9zZWNvbmRhcnkgPSBudWxsO1xuICAgICAgICAgIHRoaXMuX2xhc3RTZWNvbmRhcnkgPSBudWxsO1xuICAgICAgICAgIHRoaXMuXyRoYW5kbGVTZWNvbmRhcnlBbnkgPSBudWxsO1xuICAgICAgICAgIHRoaXMuXyRoYW5kbGVQcmltYXJ5QW55ID0gbnVsbDtcbiAgICAgICAgICB0aGlzLl9mcmVlKCk7XG4gICAgICAgIH19LCBtaXhpbik7XG4gICAgICByZXR1cm4gQW5vbnltb3VzT2JzZXJ2YWJsZTtcbiAgICB9XG4gICAgdmFyIEFub255bW91c1N0cmVhbSA9IGJ1aWxkQ2xhc3MoU3RyZWFtKTtcbiAgICB2YXIgQW5vbnltb3VzUHJvcGVydHkgPSBidWlsZENsYXNzKFByb3BlcnR5KTtcbiAgICBTdHJlYW0ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oc2Vjb25kYXJ5KSB7XG4gICAgICByZXR1cm4gbmV3IEFub255bW91c1N0cmVhbSh0aGlzLCBzZWNvbmRhcnksIHJlc3QoYXJndW1lbnRzLCAxLCBbXSkpO1xuICAgIH07XG4gICAgUHJvcGVydHkucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oc2Vjb25kYXJ5KSB7XG4gICAgICByZXR1cm4gbmV3IEFub255bW91c1Byb3BlcnR5KHRoaXMsIHNlY29uZGFyeSwgcmVzdChhcmd1bWVudHMsIDEsIFtdKSk7XG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBTdWJzY3JpYmVycygpIHtcbiAgICB0aGlzLl9pdGVtcyA9IFtdO1xuICB9XG4gIGV4dGVuZChTdWJzY3JpYmVycywge1xuICAgIGNhbGxPbmU6IGZ1bmN0aW9uKGZuRGF0YSwgZXZlbnQpIHtcbiAgICAgIGlmIChmbkRhdGEudHlwZSA9PT0gQU5ZKSB7XG4gICAgICAgIGZuRGF0YS5mbihldmVudCk7XG4gICAgICB9IGVsc2UgaWYgKGZuRGF0YS50eXBlID09PSBldmVudC50eXBlKSB7XG4gICAgICAgIGlmIChmbkRhdGEudHlwZSA9PT0gVkFMVUUgfHwgZm5EYXRhLnR5cGUgPT09IEVSUk9SKSB7XG4gICAgICAgICAgZm5EYXRhLmZuKGV2ZW50LnZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmbkRhdGEuZm4oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgY2FsbE9uY2U6IGZ1bmN0aW9uKHR5cGUsIGZuLCBldmVudCkge1xuICAgICAgaWYgKHR5cGUgPT09IEFOWSkge1xuICAgICAgICBmbihldmVudCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IGV2ZW50LnR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFZBTFVFIHx8IHR5cGUgPT09IEVSUk9SKSB7XG4gICAgICAgICAgZm4oZXZlbnQudmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZuKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBleHRlbmQoU3Vic2NyaWJlcnMucHJvdG90eXBlLCB7XG4gICAgYWRkOiBmdW5jdGlvbih0eXBlLCBmbiwgX2tleSkge1xuICAgICAgdGhpcy5faXRlbXMgPSBjb25jYXQodGhpcy5faXRlbXMsIFt7XG4gICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgIGZuOiBmbixcbiAgICAgICAga2V5OiBfa2V5IHx8IG51bGxcbiAgICAgIH1dKTtcbiAgICB9LFxuICAgIHJlbW92ZTogZnVuY3Rpb24odHlwZSwgZm4sIF9rZXkpIHtcbiAgICAgIHZhciBwcmVkID0gaXNBcnJheShfa2V5KSA/IGZ1bmN0aW9uKGZuRGF0YSkge1xuICAgICAgICByZXR1cm4gZm5EYXRhLnR5cGUgPT09IHR5cGUgJiYgaXNFcXVhbEFycmF5cyhmbkRhdGEua2V5LCBfa2V5KTtcbiAgICAgIH0gOiBmdW5jdGlvbihmbkRhdGEpIHtcbiAgICAgICAgcmV0dXJuIGZuRGF0YS50eXBlID09PSB0eXBlICYmIGZuRGF0YS5mbiA9PT0gZm47XG4gICAgICB9O1xuICAgICAgdGhpcy5faXRlbXMgPSByZW1vdmVCeVByZWQodGhpcy5faXRlbXMsIHByZWQpO1xuICAgIH0sXG4gICAgY2FsbEFsbDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHZhciBpdGVtcyA9IHRoaXMuX2l0ZW1zO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBTdWJzY3JpYmVycy5jYWxsT25lKGl0ZW1zW2ldLCBldmVudCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBpc0VtcHR5OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pdGVtcy5sZW5ndGggPT09IDA7XG4gICAgfVxuICB9KTtcbiAgZnVuY3Rpb24gRXZlbnQodHlwZSwgdmFsdWUsIGN1cnJlbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogdHlwZSxcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGN1cnJlbnQ6ICEhY3VycmVudFxuICAgIH07XG4gIH1cbiAgdmFyIENVUlJFTlRfRU5EID0gRXZlbnQoRU5ELCB1bmRlZmluZWQsIHRydWUpO1xuICBmdW5jdGlvbiBPYnNlcnZhYmxlKCkge1xuICAgIHRoaXMuX3N1YnNjcmliZXJzID0gbmV3IFN1YnNjcmliZXJzKCk7XG4gICAgdGhpcy5fYWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5fYWxpdmUgPSB0cnVlO1xuICB9XG4gIEtlZmlyLk9ic2VydmFibGUgPSBPYnNlcnZhYmxlO1xuICBleHRlbmQoT2JzZXJ2YWJsZS5wcm90b3R5cGUsIHtcbiAgICBfbmFtZTogJ29ic2VydmFibGUnLFxuICAgIF9vbkFjdGl2YXRpb246IGZ1bmN0aW9uKCkge30sXG4gICAgX29uRGVhY3RpdmF0aW9uOiBmdW5jdGlvbigpIHt9LFxuICAgIF9zZXRBY3RpdmU6IGZ1bmN0aW9uKGFjdGl2ZSkge1xuICAgICAgaWYgKHRoaXMuX2FjdGl2ZSAhPT0gYWN0aXZlKSB7XG4gICAgICAgIHRoaXMuX2FjdGl2ZSA9IGFjdGl2ZTtcbiAgICAgICAgaWYgKGFjdGl2ZSkge1xuICAgICAgICAgIHRoaXMuX29uQWN0aXZhdGlvbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX29uRGVhY3RpdmF0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIF9jbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9zZXRBY3RpdmUoZmFsc2UpO1xuICAgICAgdGhpcy5fYWxpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuX3N1YnNjcmliZXJzID0gbnVsbDtcbiAgICB9LFxuICAgIF9zZW5kOiBmdW5jdGlvbih0eXBlLCB4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmICh0aGlzLl9hbGl2ZSkge1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmVycy5jYWxsQWxsKEV2ZW50KHR5cGUsIHgsIGlzQ3VycmVudCkpO1xuICAgICAgICBpZiAodHlwZSA9PT0gRU5EKSB7XG4gICAgICAgICAgdGhpcy5fY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgX29uOiBmdW5jdGlvbih0eXBlLCBmbiwgX2tleSkge1xuICAgICAgaWYgKHRoaXMuX2FsaXZlKSB7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZXJzLmFkZCh0eXBlLCBmbiwgX2tleSk7XG4gICAgICAgIHRoaXMuX3NldEFjdGl2ZSh0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFN1YnNjcmliZXJzLmNhbGxPbmNlKHR5cGUsIGZuLCBDVVJSRU5UX0VORCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIF9vZmY6IGZ1bmN0aW9uKHR5cGUsIGZuLCBfa2V5KSB7XG4gICAgICBpZiAodGhpcy5fYWxpdmUpIHtcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlcnMucmVtb3ZlKHR5cGUsIGZuLCBfa2V5KTtcbiAgICAgICAgaWYgKHRoaXMuX3N1YnNjcmliZXJzLmlzRW1wdHkoKSkge1xuICAgICAgICAgIHRoaXMuX3NldEFjdGl2ZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgb25WYWx1ZTogZnVuY3Rpb24oZm4sIF9rZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vbihWQUxVRSwgZm4sIF9rZXkpO1xuICAgIH0sXG4gICAgb25FcnJvcjogZnVuY3Rpb24oZm4sIF9rZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vbihFUlJPUiwgZm4sIF9rZXkpO1xuICAgIH0sXG4gICAgb25FbmQ6IGZ1bmN0aW9uKGZuLCBfa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fb24oRU5ELCBmbiwgX2tleSk7XG4gICAgfSxcbiAgICBvbkFueTogZnVuY3Rpb24oZm4sIF9rZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vbihBTlksIGZuLCBfa2V5KTtcbiAgICB9LFxuICAgIG9mZlZhbHVlOiBmdW5jdGlvbihmbiwgX2tleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX29mZihWQUxVRSwgZm4sIF9rZXkpO1xuICAgIH0sXG4gICAgb2ZmRXJyb3I6IGZ1bmN0aW9uKGZuLCBfa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fb2ZmKEVSUk9SLCBmbiwgX2tleSk7XG4gICAgfSxcbiAgICBvZmZFbmQ6IGZ1bmN0aW9uKGZuLCBfa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fb2ZmKEVORCwgZm4sIF9rZXkpO1xuICAgIH0sXG4gICAgb2ZmQW55OiBmdW5jdGlvbihmbiwgX2tleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX29mZihBTlksIGZuLCBfa2V5KTtcbiAgICB9XG4gIH0pO1xuICBPYnNlcnZhYmxlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAnWycgKyB0aGlzLl9uYW1lICsgJ10nO1xuICB9O1xuICBmdW5jdGlvbiBTdHJlYW0oKSB7XG4gICAgT2JzZXJ2YWJsZS5jYWxsKHRoaXMpO1xuICB9XG4gIEtlZmlyLlN0cmVhbSA9IFN0cmVhbTtcbiAgaW5oZXJpdChTdHJlYW0sIE9ic2VydmFibGUsIHtfbmFtZTogJ3N0cmVhbSd9KTtcbiAgZnVuY3Rpb24gUHJvcGVydHkoKSB7XG4gICAgT2JzZXJ2YWJsZS5jYWxsKHRoaXMpO1xuICAgIHRoaXMuX2N1cnJlbnQgPSBOT1RISU5HO1xuICAgIHRoaXMuX2N1cnJlbnRFcnJvciA9IE5PVEhJTkc7XG4gIH1cbiAgS2VmaXIuUHJvcGVydHkgPSBQcm9wZXJ0eTtcbiAgaW5oZXJpdChQcm9wZXJ0eSwgT2JzZXJ2YWJsZSwge1xuICAgIF9uYW1lOiAncHJvcGVydHknLFxuICAgIF9zZW5kOiBmdW5jdGlvbih0eXBlLCB4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmICh0aGlzLl9hbGl2ZSkge1xuICAgICAgICBpZiAoIWlzQ3VycmVudCkge1xuICAgICAgICAgIHRoaXMuX3N1YnNjcmliZXJzLmNhbGxBbGwoRXZlbnQodHlwZSwgeCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSBWQUxVRSkge1xuICAgICAgICAgIHRoaXMuX2N1cnJlbnQgPSB4O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSBFUlJPUikge1xuICAgICAgICAgIHRoaXMuX2N1cnJlbnRFcnJvciA9IHg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgPT09IEVORCkge1xuICAgICAgICAgIHRoaXMuX2NsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIF9vbjogZnVuY3Rpb24odHlwZSwgZm4sIF9rZXkpIHtcbiAgICAgIGlmICh0aGlzLl9hbGl2ZSkge1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmVycy5hZGQodHlwZSwgZm4sIF9rZXkpO1xuICAgICAgICB0aGlzLl9zZXRBY3RpdmUodHJ1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fY3VycmVudCAhPT0gTk9USElORykge1xuICAgICAgICBTdWJzY3JpYmVycy5jYWxsT25jZSh0eXBlLCBmbiwgRXZlbnQoVkFMVUUsIHRoaXMuX2N1cnJlbnQsIHRydWUpKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLl9jdXJyZW50RXJyb3IgIT09IE5PVEhJTkcpIHtcbiAgICAgICAgU3Vic2NyaWJlcnMuY2FsbE9uY2UodHlwZSwgZm4sIEV2ZW50KEVSUk9SLCB0aGlzLl9jdXJyZW50RXJyb3IsIHRydWUpKTtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5fYWxpdmUpIHtcbiAgICAgICAgU3Vic2NyaWJlcnMuY2FsbE9uY2UodHlwZSwgZm4sIENVUlJFTlRfRU5EKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSk7XG4gIE9ic2VydmFibGUucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBuYW1lID0gbmFtZSB8fCB0aGlzLnRvU3RyaW5nKCk7XG4gICAgdGhpcy5vbkFueShmdW5jdGlvbihldmVudCkge1xuICAgICAgdmFyIHR5cGVTdHIgPSAnPCcgKyBldmVudC50eXBlICsgKGV2ZW50LmN1cnJlbnQgPyAnOmN1cnJlbnQnIDogJycpICsgJz4nO1xuICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IFZBTFVFIHx8IGV2ZW50LnR5cGUgPT09IEVSUk9SKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKG5hbWUsIHR5cGVTdHIsIGV2ZW50LnZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKG5hbWUsIHR5cGVTdHIpO1xuICAgICAgfVxuICAgIH0sIFsnX19sb2dLZXlfXycsIHRoaXMsIG5hbWVdKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgT2JzZXJ2YWJsZS5wcm90b3R5cGUub2ZmTG9nID0gZnVuY3Rpb24obmFtZSkge1xuICAgIG5hbWUgPSBuYW1lIHx8IHRoaXMudG9TdHJpbmcoKTtcbiAgICB0aGlzLm9mZkFueShudWxsLCBbJ19fbG9nS2V5X18nLCB0aGlzLCBuYW1lXSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIHdpdGhJbnRlcnZhbCgnd2l0aEludGVydmFsJywge1xuICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICB0aGlzLl9mbiA9IGFyZ3NbMF07XG4gICAgICB2YXIgJCA9IHRoaXM7XG4gICAgICB0aGlzLl9lbWl0dGVyID0ge1xuICAgICAgICBlbWl0OiBmdW5jdGlvbih4KSB7XG4gICAgICAgICAgJC5fc2VuZChWQUxVRSwgeCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbih4KSB7XG4gICAgICAgICAgJC5fc2VuZChFUlJPUiwgeCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVuZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJC5fc2VuZChFTkQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZm4gPSBudWxsO1xuICAgICAgdGhpcy5fZW1pdHRlciA9IG51bGw7XG4gICAgfSxcbiAgICBfb25UaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2ZuKHRoaXMuX2VtaXR0ZXIpO1xuICAgIH1cbiAgfSk7XG4gIHdpdGhJbnRlcnZhbCgnZnJvbVBvbGwnLCB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX2ZuID0gYXJnc1swXTtcbiAgICB9LFxuICAgIF9mcmVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2ZuID0gbnVsbDtcbiAgICB9LFxuICAgIF9vblRpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc2VuZChWQUxVRSwgdGhpcy5fZm4oKSk7XG4gICAgfVxuICB9KTtcbiAgd2l0aEludGVydmFsKCdpbnRlcnZhbCcsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5feCA9IGFyZ3NbMF07XG4gICAgfSxcbiAgICBfZnJlZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl94ID0gbnVsbDtcbiAgICB9LFxuICAgIF9vblRpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc2VuZChWQUxVRSwgdGhpcy5feCk7XG4gICAgfVxuICB9KTtcbiAgd2l0aEludGVydmFsKCdzZXF1ZW50aWFsbHknLCB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX3hzID0gY2xvbmVBcnJheShhcmdzWzBdKTtcbiAgICAgIGlmICh0aGlzLl94cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhpcy5fc2VuZChFTkQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5feHMgPSBudWxsO1xuICAgIH0sXG4gICAgX29uVGljazogZnVuY3Rpb24oKSB7XG4gICAgICBzd2l0Y2ggKHRoaXMuX3hzLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgdGhpcy5feHNbMF0pO1xuICAgICAgICAgIHRoaXMuX3NlbmQoRU5EKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB0aGlzLl94cy5zaGlmdCgpKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICB3aXRoSW50ZXJ2YWwoJ3JlcGVhdGVkbHknLCB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX3hzID0gY2xvbmVBcnJheShhcmdzWzBdKTtcbiAgICAgIHRoaXMuX2kgPSAtMTtcbiAgICB9LFxuICAgIF9vblRpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3hzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5faSA9ICh0aGlzLl9pICsgMSkgJSB0aGlzLl94cy5sZW5ndGg7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHRoaXMuX3hzW3RoaXMuX2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICB3aXRoSW50ZXJ2YWwoJ2xhdGVyJywge1xuICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICB0aGlzLl94ID0gYXJnc1swXTtcbiAgICB9LFxuICAgIF9mcmVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3ggPSBudWxsO1xuICAgIH0sXG4gICAgX29uVGljazogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9zZW5kKFZBTFVFLCB0aGlzLl94KTtcbiAgICAgIHRoaXMuX3NlbmQoRU5EKTtcbiAgICB9XG4gIH0pO1xuICBmdW5jdGlvbiBfQWJzdHJhY3RQb29sKG9wdGlvbnMpIHtcbiAgICBTdHJlYW0uY2FsbCh0aGlzKTtcbiAgICB0aGlzLl9xdWV1ZUxpbSA9IGdldChvcHRpb25zLCAncXVldWVMaW0nLCAwKTtcbiAgICB0aGlzLl9jb25jdXJMaW0gPSBnZXQob3B0aW9ucywgJ2NvbmN1ckxpbScsIC0xKTtcbiAgICB0aGlzLl9kcm9wID0gZ2V0KG9wdGlvbnMsICdkcm9wJywgJ25ldycpO1xuICAgIGlmICh0aGlzLl9jb25jdXJMaW0gPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignb3B0aW9ucy5jb25jdXJMaW0gY2FuXFwndCBiZSAwJyk7XG4gICAgfVxuICAgIHZhciAkID0gdGhpcztcbiAgICB0aGlzLl8kaGFuZGxlU3ViQW55ID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICQuX2hhbmRsZVN1YkFueShldmVudCk7XG4gICAgfTtcbiAgICB0aGlzLl9xdWV1ZSA9IFtdO1xuICAgIHRoaXMuX2N1clNvdXJjZXMgPSBbXTtcbiAgICB0aGlzLl9hY3RpdmF0aW5nID0gZmFsc2U7XG4gIH1cbiAgaW5oZXJpdChfQWJzdHJhY3RQb29sLCBTdHJlYW0sIHtcbiAgICBfbmFtZTogJ2Fic3RyYWN0UG9vbCcsXG4gICAgX2FkZDogZnVuY3Rpb24ob2JqLCB0b09icykge1xuICAgICAgdG9PYnMgPSB0b09icyB8fCBpZDtcbiAgICAgIGlmICh0aGlzLl9jb25jdXJMaW0gPT09IC0xIHx8IHRoaXMuX2N1clNvdXJjZXMubGVuZ3RoIDwgdGhpcy5fY29uY3VyTGltKSB7XG4gICAgICAgIHRoaXMuX2FkZFRvQ3VyKHRvT2JzKG9iaikpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHRoaXMuX3F1ZXVlTGltID09PSAtMSB8fCB0aGlzLl9xdWV1ZS5sZW5ndGggPCB0aGlzLl9xdWV1ZUxpbSkge1xuICAgICAgICAgIHRoaXMuX2FkZFRvUXVldWUodG9PYnMob2JqKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZHJvcCA9PT0gJ29sZCcpIHtcbiAgICAgICAgICB0aGlzLl9yZW1vdmVPbGRlc3QoKTtcbiAgICAgICAgICB0aGlzLl9hZGQodG9PYnMob2JqKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIF9hZGRBbGw6IGZ1bmN0aW9uKG9ic3MpIHtcbiAgICAgIHZhciAkID0gdGhpcztcbiAgICAgIGZvckVhY2gob2JzcywgZnVuY3Rpb24ob2JzKSB7XG4gICAgICAgICQuX2FkZChvYnMpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBfcmVtb3ZlOiBmdW5jdGlvbihvYnMpIHtcbiAgICAgIGlmICh0aGlzLl9yZW1vdmVDdXIob2JzKSA9PT0gLTEpIHtcbiAgICAgICAgdGhpcy5fcmVtb3ZlUXVldWUob2JzKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9hZGRUb1F1ZXVlOiBmdW5jdGlvbihvYnMpIHtcbiAgICAgIHRoaXMuX3F1ZXVlID0gY29uY2F0KHRoaXMuX3F1ZXVlLCBbb2JzXSk7XG4gICAgfSxcbiAgICBfYWRkVG9DdXI6IGZ1bmN0aW9uKG9icykge1xuICAgICAgdGhpcy5fY3VyU291cmNlcyA9IGNvbmNhdCh0aGlzLl9jdXJTb3VyY2VzLCBbb2JzXSk7XG4gICAgICBpZiAodGhpcy5fYWN0aXZlKSB7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZShvYnMpO1xuICAgICAgfVxuICAgIH0sXG4gICAgX3N1YnNjcmliZTogZnVuY3Rpb24ob2JzKSB7XG4gICAgICB2YXIgJCA9IHRoaXM7XG4gICAgICBvYnMub25BbnkodGhpcy5fJGhhbmRsZVN1YkFueSk7XG4gICAgICBvYnMub25FbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICQuX3JlbW92ZUN1cihvYnMpO1xuICAgICAgfSwgW3RoaXMsIG9ic10pO1xuICAgIH0sXG4gICAgX3Vuc3Vic2NyaWJlOiBmdW5jdGlvbihvYnMpIHtcbiAgICAgIG9icy5vZmZBbnkodGhpcy5fJGhhbmRsZVN1YkFueSk7XG4gICAgICBvYnMub2ZmRW5kKG51bGwsIFt0aGlzLCBvYnNdKTtcbiAgICB9LFxuICAgIF9oYW5kbGVTdWJBbnk6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBpZiAoZXZlbnQudHlwZSA9PT0gVkFMVUUgfHwgZXZlbnQudHlwZSA9PT0gRVJST1IpIHtcbiAgICAgICAgdGhpcy5fc2VuZChldmVudC50eXBlLCBldmVudC52YWx1ZSwgZXZlbnQuY3VycmVudCAmJiB0aGlzLl9hY3RpdmF0aW5nKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9yZW1vdmVRdWV1ZTogZnVuY3Rpb24ob2JzKSB7XG4gICAgICB2YXIgaW5kZXggPSBmaW5kKHRoaXMuX3F1ZXVlLCBvYnMpO1xuICAgICAgdGhpcy5fcXVldWUgPSByZW1vdmUodGhpcy5fcXVldWUsIGluZGV4KTtcbiAgICAgIHJldHVybiBpbmRleDtcbiAgICB9LFxuICAgIF9yZW1vdmVDdXI6IGZ1bmN0aW9uKG9icykge1xuICAgICAgaWYgKHRoaXMuX2FjdGl2ZSkge1xuICAgICAgICB0aGlzLl91bnN1YnNjcmliZShvYnMpO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gZmluZCh0aGlzLl9jdXJTb3VyY2VzLCBvYnMpO1xuICAgICAgdGhpcy5fY3VyU291cmNlcyA9IHJlbW92ZSh0aGlzLl9jdXJTb3VyY2VzLCBpbmRleCk7XG4gICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIGlmICh0aGlzLl9xdWV1ZS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICB0aGlzLl9wdWxsUXVldWUoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9jdXJTb3VyY2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIHRoaXMuX29uRW1wdHkoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH0sXG4gICAgX3JlbW92ZU9sZGVzdDogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9yZW1vdmVDdXIodGhpcy5fY3VyU291cmNlc1swXSk7XG4gICAgfSxcbiAgICBfcHVsbFF1ZXVlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9xdWV1ZS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgdGhpcy5fcXVldWUgPSBjbG9uZUFycmF5KHRoaXMuX3F1ZXVlKTtcbiAgICAgICAgdGhpcy5fYWRkVG9DdXIodGhpcy5fcXVldWUuc2hpZnQoKSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfb25BY3RpdmF0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzb3VyY2VzID0gdGhpcy5fY3VyU291cmNlcyxcbiAgICAgICAgICBpO1xuICAgICAgdGhpcy5fYWN0aXZhdGluZyA9IHRydWU7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgc291cmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmUoc291cmNlc1tpXSk7XG4gICAgICB9XG4gICAgICB0aGlzLl9hY3RpdmF0aW5nID0gZmFsc2U7XG4gICAgfSxcbiAgICBfb25EZWFjdGl2YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNvdXJjZXMgPSB0aGlzLl9jdXJTb3VyY2VzLFxuICAgICAgICAgIGk7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgc291cmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl91bnN1YnNjcmliZShzb3VyY2VzW2ldKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9pc0VtcHR5OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jdXJTb3VyY2VzLmxlbmd0aCA9PT0gMDtcbiAgICB9LFxuICAgIF9vbkVtcHR5OiBmdW5jdGlvbigpIHt9LFxuICAgIF9jbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICBTdHJlYW0ucHJvdG90eXBlLl9jbGVhci5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5fcXVldWUgPSBudWxsO1xuICAgICAgdGhpcy5fY3VyU291cmNlcyA9IG51bGw7XG4gICAgICB0aGlzLl8kaGFuZGxlU3ViQW55ID0gbnVsbDtcbiAgICB9XG4gIH0pO1xuICB2YXIgTWVyZ2VMaWtlID0ge19vbkVtcHR5OiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9pbml0aWFsaXNlZCkge1xuICAgICAgICB0aGlzLl9zZW5kKEVORCwgbnVsbCwgdGhpcy5fYWN0aXZhdGluZyk7XG4gICAgICB9XG4gICAgfX07XG4gIGZ1bmN0aW9uIE1lcmdlKHNvdXJjZXMpIHtcbiAgICBfQWJzdHJhY3RQb29sLmNhbGwodGhpcyk7XG4gICAgaWYgKHNvdXJjZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aGlzLl9zZW5kKEVORCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2FkZEFsbChzb3VyY2VzKTtcbiAgICB9XG4gICAgdGhpcy5faW5pdGlhbGlzZWQgPSB0cnVlO1xuICB9XG4gIGluaGVyaXQoTWVyZ2UsIF9BYnN0cmFjdFBvb2wsIGV4dGVuZCh7X25hbWU6ICdtZXJnZSd9LCBNZXJnZUxpa2UpKTtcbiAgS2VmaXIubWVyZ2UgPSBmdW5jdGlvbihvYnNzKSB7XG4gICAgcmV0dXJuIG5ldyBNZXJnZShvYnNzKTtcbiAgfTtcbiAgT2JzZXJ2YWJsZS5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbihvdGhlcikge1xuICAgIHJldHVybiBLZWZpci5tZXJnZShbdGhpcywgb3RoZXJdKTtcbiAgfTtcbiAgZnVuY3Rpb24gQ29uY2F0KHNvdXJjZXMpIHtcbiAgICBfQWJzdHJhY3RQb29sLmNhbGwodGhpcywge1xuICAgICAgY29uY3VyTGltOiAxLFxuICAgICAgcXVldWVMaW06IC0xXG4gICAgfSk7XG4gICAgaWYgKHNvdXJjZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aGlzLl9zZW5kKEVORCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2FkZEFsbChzb3VyY2VzKTtcbiAgICB9XG4gICAgdGhpcy5faW5pdGlhbGlzZWQgPSB0cnVlO1xuICB9XG4gIGluaGVyaXQoQ29uY2F0LCBfQWJzdHJhY3RQb29sLCBleHRlbmQoe19uYW1lOiAnY29uY2F0J30sIE1lcmdlTGlrZSkpO1xuICBLZWZpci5jb25jYXQgPSBmdW5jdGlvbihvYnNzKSB7XG4gICAgcmV0dXJuIG5ldyBDb25jYXQob2Jzcyk7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uKG90aGVyKSB7XG4gICAgcmV0dXJuIEtlZmlyLmNvbmNhdChbdGhpcywgb3RoZXJdKTtcbiAgfTtcbiAgZnVuY3Rpb24gUG9vbCgpIHtcbiAgICBfQWJzdHJhY3RQb29sLmNhbGwodGhpcyk7XG4gIH1cbiAgaW5oZXJpdChQb29sLCBfQWJzdHJhY3RQb29sLCB7XG4gICAgX25hbWU6ICdwb29sJyxcbiAgICBwbHVnOiBmdW5jdGlvbihvYnMpIHtcbiAgICAgIHRoaXMuX2FkZChvYnMpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICB1bnBsdWc6IGZ1bmN0aW9uKG9icykge1xuICAgICAgdGhpcy5fcmVtb3ZlKG9icyk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0pO1xuICBLZWZpci5wb29sID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBQb29sKCk7XG4gIH07XG4gIGZ1bmN0aW9uIEJ1cygpIHtcbiAgICBfQWJzdHJhY3RQb29sLmNhbGwodGhpcyk7XG4gIH1cbiAgaW5oZXJpdChCdXMsIF9BYnN0cmFjdFBvb2wsIHtcbiAgICBfbmFtZTogJ2J1cycsXG4gICAgcGx1ZzogZnVuY3Rpb24ob2JzKSB7XG4gICAgICB0aGlzLl9hZGQob2JzKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgdW5wbHVnOiBmdW5jdGlvbihvYnMpIHtcbiAgICAgIHRoaXMuX3JlbW92ZShvYnMpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBlbWl0OiBmdW5jdGlvbih4KSB7XG4gICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4KTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgZXJyb3I6IGZ1bmN0aW9uKHgpIHtcbiAgICAgIHRoaXMuX3NlbmQoRVJST1IsIHgpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBlbmQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc2VuZChFTkQpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9KTtcbiAgS2VmaXIuYnVzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBCdXMoKTtcbiAgfTtcbiAgZnVuY3Rpb24gRmxhdE1hcChzb3VyY2UsIGZuLCBvcHRpb25zKSB7XG4gICAgX0Fic3RyYWN0UG9vbC5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgIHRoaXMuX3NvdXJjZSA9IHNvdXJjZTtcbiAgICB0aGlzLl9mbiA9IGZuIHx8IGlkO1xuICAgIHRoaXMuX21haW5FbmRlZCA9IGZhbHNlO1xuICAgIHRoaXMuX2xhc3RDdXJyZW50ID0gbnVsbDtcbiAgICB2YXIgJCA9IHRoaXM7XG4gICAgdGhpcy5fJGhhbmRsZU1haW5Tb3VyY2UgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgJC5faGFuZGxlTWFpblNvdXJjZShldmVudCk7XG4gICAgfTtcbiAgfVxuICBpbmhlcml0KEZsYXRNYXAsIF9BYnN0cmFjdFBvb2wsIHtcbiAgICBfb25BY3RpdmF0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgIF9BYnN0cmFjdFBvb2wucHJvdG90eXBlLl9vbkFjdGl2YXRpb24uY2FsbCh0aGlzKTtcbiAgICAgIGlmICh0aGlzLl9hY3RpdmUpIHtcbiAgICAgICAgdGhpcy5fYWN0aXZhdGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuX3NvdXJjZS5vbkFueSh0aGlzLl8kaGFuZGxlTWFpblNvdXJjZSk7XG4gICAgICAgIHRoaXMuX2FjdGl2YXRpbmcgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9vbkRlYWN0aXZhdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICBfQWJzdHJhY3RQb29sLnByb3RvdHlwZS5fb25EZWFjdGl2YXRpb24uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuX3NvdXJjZS5vZmZBbnkodGhpcy5fJGhhbmRsZU1haW5Tb3VyY2UpO1xuICAgIH0sXG4gICAgX2hhbmRsZU1haW5Tb3VyY2U6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBpZiAoZXZlbnQudHlwZSA9PT0gVkFMVUUpIHtcbiAgICAgICAgaWYgKCFldmVudC5jdXJyZW50IHx8IHRoaXMuX2xhc3RDdXJyZW50ICE9PSBldmVudC52YWx1ZSkge1xuICAgICAgICAgIHRoaXMuX2FkZChldmVudC52YWx1ZSwgdGhpcy5fZm4pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xhc3RDdXJyZW50ID0gZXZlbnQudmFsdWU7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQudHlwZSA9PT0gRVJST1IpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFUlJPUiwgZXZlbnQudmFsdWUsIGV2ZW50LmN1cnJlbnQpO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IEVORCkge1xuICAgICAgICBpZiAodGhpcy5faXNFbXB0eSgpKSB7XG4gICAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGV2ZW50LmN1cnJlbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX21haW5FbmRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIF9vbkVtcHR5OiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9tYWluRW5kZWQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFTkQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2NsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgIF9BYnN0cmFjdFBvb2wucHJvdG90eXBlLl9jbGVhci5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5fc291cmNlID0gbnVsbDtcbiAgICAgIHRoaXMuX2xhc3RDdXJyZW50ID0gbnVsbDtcbiAgICAgIHRoaXMuXyRoYW5kbGVNYWluU291cmNlID0gbnVsbDtcbiAgICB9XG4gIH0pO1xuICBPYnNlcnZhYmxlLnByb3RvdHlwZS5mbGF0TWFwID0gZnVuY3Rpb24oZm4pIHtcbiAgICByZXR1cm4gbmV3IEZsYXRNYXAodGhpcywgZm4pLnNldE5hbWUodGhpcywgJ2ZsYXRNYXAnKTtcbiAgfTtcbiAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcExhdGVzdCA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgcmV0dXJuIG5ldyBGbGF0TWFwKHRoaXMsIGZuLCB7XG4gICAgICBjb25jdXJMaW06IDEsXG4gICAgICBkcm9wOiAnb2xkJ1xuICAgIH0pLnNldE5hbWUodGhpcywgJ2ZsYXRNYXBMYXRlc3QnKTtcbiAgfTtcbiAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcEZpcnN0ID0gZnVuY3Rpb24oZm4pIHtcbiAgICByZXR1cm4gbmV3IEZsYXRNYXAodGhpcywgZm4sIHtjb25jdXJMaW06IDF9KS5zZXROYW1lKHRoaXMsICdmbGF0TWFwRmlyc3QnKTtcbiAgfTtcbiAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcENvbmNhdCA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgcmV0dXJuIG5ldyBGbGF0TWFwKHRoaXMsIGZuLCB7XG4gICAgICBxdWV1ZUxpbTogLTEsXG4gICAgICBjb25jdXJMaW06IDFcbiAgICB9KS5zZXROYW1lKHRoaXMsICdmbGF0TWFwQ29uY2F0Jyk7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLmZsYXRNYXBDb25jdXJMaW1pdCA9IGZ1bmN0aW9uKGZuLCBsaW1pdCkge1xuICAgIHZhciByZXN1bHQ7XG4gICAgaWYgKGxpbWl0ID09PSAwKSB7XG4gICAgICByZXN1bHQgPSBLZWZpci5uZXZlcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAobGltaXQgPCAwKSB7XG4gICAgICAgIGxpbWl0ID0gLTE7XG4gICAgICB9XG4gICAgICByZXN1bHQgPSBuZXcgRmxhdE1hcCh0aGlzLCBmbiwge1xuICAgICAgICBxdWV1ZUxpbTogLTEsXG4gICAgICAgIGNvbmN1ckxpbTogbGltaXRcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0LnNldE5hbWUodGhpcywgJ2ZsYXRNYXBDb25jdXJMaW1pdCcpO1xuICB9O1xuICBmdW5jdGlvbiBaaXAoc291cmNlcywgY29tYmluYXRvcikge1xuICAgIFN0cmVhbS5jYWxsKHRoaXMpO1xuICAgIGlmIChzb3VyY2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5fc2VuZChFTkQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idWZmZXJzID0gbWFwKHNvdXJjZXMsIGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgICAgICByZXR1cm4gaXNBcnJheShzb3VyY2UpID8gY2xvbmVBcnJheShzb3VyY2UpIDogW107XG4gICAgICB9KTtcbiAgICAgIHRoaXMuX3NvdXJjZXMgPSBtYXAoc291cmNlcywgZnVuY3Rpb24oc291cmNlKSB7XG4gICAgICAgIHJldHVybiBpc0FycmF5KHNvdXJjZSkgPyBLZWZpci5uZXZlcigpIDogc291cmNlO1xuICAgICAgfSk7XG4gICAgICB0aGlzLl9jb21iaW5hdG9yID0gY29tYmluYXRvciA/IHNwcmVhZChjb21iaW5hdG9yLCB0aGlzLl9zb3VyY2VzLmxlbmd0aCkgOiBpZDtcbiAgICAgIHRoaXMuX2FsaXZlQ291bnQgPSAwO1xuICAgIH1cbiAgfVxuICBpbmhlcml0KFppcCwgU3RyZWFtLCB7XG4gICAgX25hbWU6ICd6aXAnLFxuICAgIF9vbkFjdGl2YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGksXG4gICAgICAgICAgbGVuZ3RoID0gdGhpcy5fc291cmNlcy5sZW5ndGg7XG4gICAgICB0aGlzLl9kcmFpbkFycmF5cygpO1xuICAgICAgdGhpcy5fYWxpdmVDb3VudCA9IGxlbmd0aDtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9zb3VyY2VzW2ldLm9uQW55KHRoaXMuX2JpbmRIYW5kbGVBbnkoaSksIFt0aGlzLCBpXSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfb25EZWFjdGl2YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9zb3VyY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuX3NvdXJjZXNbaV0ub2ZmQW55KG51bGwsIFt0aGlzLCBpXSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfZW1pdDogZnVuY3Rpb24oaXNDdXJyZW50KSB7XG4gICAgICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KHRoaXMuX2J1ZmZlcnMubGVuZ3RoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fYnVmZmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YWx1ZXNbaV0gPSB0aGlzLl9idWZmZXJzW2ldLnNoaWZ0KCk7XG4gICAgICB9XG4gICAgICB0aGlzLl9zZW5kKFZBTFVFLCB0aGlzLl9jb21iaW5hdG9yKHZhbHVlcyksIGlzQ3VycmVudCk7XG4gICAgfSxcbiAgICBfaXNGdWxsOiBmdW5jdGlvbigpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fYnVmZmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodGhpcy5fYnVmZmVyc1tpXS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgX2VtaXRJZkZ1bGw6IGZ1bmN0aW9uKGlzQ3VycmVudCkge1xuICAgICAgaWYgKHRoaXMuX2lzRnVsbCgpKSB7XG4gICAgICAgIHRoaXMuX2VtaXQoaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9kcmFpbkFycmF5czogZnVuY3Rpb24oKSB7XG4gICAgICB3aGlsZSAodGhpcy5faXNGdWxsKCkpIHtcbiAgICAgICAgdGhpcy5fZW1pdCh0cnVlKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9iaW5kSGFuZGxlQW55OiBmdW5jdGlvbihpKSB7XG4gICAgICB2YXIgJCA9IHRoaXM7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgJC5faGFuZGxlQW55KGksIGV2ZW50KTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBfaGFuZGxlQW55OiBmdW5jdGlvbihpLCBldmVudCkge1xuICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IFZBTFVFKSB7XG4gICAgICAgIHRoaXMuX2J1ZmZlcnNbaV0ucHVzaChldmVudC52YWx1ZSk7XG4gICAgICAgIHRoaXMuX2VtaXRJZkZ1bGwoZXZlbnQuY3VycmVudCk7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQudHlwZSA9PT0gRVJST1IpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFUlJPUiwgZXZlbnQudmFsdWUsIGV2ZW50LmN1cnJlbnQpO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IEVORCkge1xuICAgICAgICB0aGlzLl9hbGl2ZUNvdW50LS07XG4gICAgICAgIGlmICh0aGlzLl9hbGl2ZUNvdW50ID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGV2ZW50LmN1cnJlbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBfY2xlYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgU3RyZWFtLnByb3RvdHlwZS5fY2xlYXIuY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuX3NvdXJjZXMgPSBudWxsO1xuICAgICAgdGhpcy5fYnVmZmVycyA9IG51bGw7XG4gICAgICB0aGlzLl9jb21iaW5hdG9yID0gbnVsbDtcbiAgICB9XG4gIH0pO1xuICBLZWZpci56aXAgPSBmdW5jdGlvbihzb3VyY2VzLCBjb21iaW5hdG9yKSB7XG4gICAgcmV0dXJuIG5ldyBaaXAoc291cmNlcywgY29tYmluYXRvcik7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLnppcCA9IGZ1bmN0aW9uKG90aGVyLCBjb21iaW5hdG9yKSB7XG4gICAgcmV0dXJuIG5ldyBaaXAoW3RoaXMsIG90aGVyXSwgY29tYmluYXRvcik7XG4gIH07XG4gIGZ1bmN0aW9uIFNhbXBsZWRCeShwYXNzaXZlLCBhY3RpdmUsIGNvbWJpbmF0b3IpIHtcbiAgICBTdHJlYW0uY2FsbCh0aGlzKTtcbiAgICBpZiAoYWN0aXZlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5fc2VuZChFTkQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9wYXNzaXZlQ291bnQgPSBwYXNzaXZlLmxlbmd0aDtcbiAgICAgIHRoaXMuX3NvdXJjZXMgPSBjb25jYXQocGFzc2l2ZSwgYWN0aXZlKTtcbiAgICAgIHRoaXMuX2NvbWJpbmF0b3IgPSBjb21iaW5hdG9yID8gc3ByZWFkKGNvbWJpbmF0b3IsIHRoaXMuX3NvdXJjZXMubGVuZ3RoKSA6IGlkO1xuICAgICAgdGhpcy5fYWxpdmVDb3VudCA9IDA7XG4gICAgICB0aGlzLl9jdXJyZW50cyA9IG5ldyBBcnJheSh0aGlzLl9zb3VyY2VzLmxlbmd0aCk7XG4gICAgICBmaWxsQXJyYXkodGhpcy5fY3VycmVudHMsIE5PVEhJTkcpO1xuICAgICAgdGhpcy5fYWN0aXZhdGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5fZW1pdEFmdGVyQWN0aXZhdGlvbiA9IGZhbHNlO1xuICAgICAgdGhpcy5fZW5kQWZ0ZXJBY3RpdmF0aW9uID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIGluaGVyaXQoU2FtcGxlZEJ5LCBTdHJlYW0sIHtcbiAgICBfbmFtZTogJ3NhbXBsZWRCeScsXG4gICAgX29uQWN0aXZhdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gdGhpcy5fc291cmNlcy5sZW5ndGgsXG4gICAgICAgICAgaTtcbiAgICAgIHRoaXMuX2FsaXZlQ291bnQgPSBsZW5ndGggLSB0aGlzLl9wYXNzaXZlQ291bnQ7XG4gICAgICB0aGlzLl9hY3RpdmF0aW5nID0gdHJ1ZTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9zb3VyY2VzW2ldLm9uQW55KHRoaXMuX2JpbmRIYW5kbGVBbnkoaSksIFt0aGlzLCBpXSk7XG4gICAgICB9XG4gICAgICB0aGlzLl9hY3RpdmF0aW5nID0gZmFsc2U7XG4gICAgICBpZiAodGhpcy5fZW1pdEFmdGVyQWN0aXZhdGlvbikge1xuICAgICAgICB0aGlzLl9lbWl0QWZ0ZXJBY3RpdmF0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2VtaXRJZkZ1bGwodHJ1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fZW5kQWZ0ZXJBY3RpdmF0aW9uKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoRU5ELCBudWxsLCB0cnVlKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9vbkRlYWN0aXZhdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gdGhpcy5fc291cmNlcy5sZW5ndGgsXG4gICAgICAgICAgaTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9zb3VyY2VzW2ldLm9mZkFueShudWxsLCBbdGhpcywgaV0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2VtaXRJZkZ1bGw6IGZ1bmN0aW9uKGlzQ3VycmVudCkge1xuICAgICAgaWYgKCFjb250YWlucyh0aGlzLl9jdXJyZW50cywgTk9USElORykpIHtcbiAgICAgICAgdmFyIGNvbWJpbmVkID0gY2xvbmVBcnJheSh0aGlzLl9jdXJyZW50cyk7XG4gICAgICAgIGNvbWJpbmVkID0gdGhpcy5fY29tYmluYXRvcihjb21iaW5lZCk7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIGNvbWJpbmVkLCBpc0N1cnJlbnQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2JpbmRIYW5kbGVBbnk6IGZ1bmN0aW9uKGkpIHtcbiAgICAgIHZhciAkID0gdGhpcztcbiAgICAgIHJldHVybiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAkLl9oYW5kbGVBbnkoaSwgZXZlbnQpO1xuICAgICAgfTtcbiAgICB9LFxuICAgIF9oYW5kbGVBbnk6IGZ1bmN0aW9uKGksIGV2ZW50KSB7XG4gICAgICBpZiAoZXZlbnQudHlwZSA9PT0gVkFMVUUpIHtcbiAgICAgICAgdGhpcy5fY3VycmVudHNbaV0gPSBldmVudC52YWx1ZTtcbiAgICAgICAgaWYgKGkgPj0gdGhpcy5fcGFzc2l2ZUNvdW50KSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2FjdGl2YXRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXRBZnRlckFjdGl2YXRpb24gPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0SWZGdWxsKGV2ZW50LmN1cnJlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IEVSUk9SKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoRVJST1IsIGV2ZW50LnZhbHVlLCBldmVudC5jdXJyZW50KTtcbiAgICAgIH1cbiAgICAgIGlmIChldmVudC50eXBlID09PSBFTkQpIHtcbiAgICAgICAgaWYgKGkgPj0gdGhpcy5fcGFzc2l2ZUNvdW50KSB7XG4gICAgICAgICAgdGhpcy5fYWxpdmVDb3VudC0tO1xuICAgICAgICAgIGlmICh0aGlzLl9hbGl2ZUNvdW50ID09PSAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fYWN0aXZhdGluZykge1xuICAgICAgICAgICAgICB0aGlzLl9lbmRBZnRlckFjdGl2YXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGV2ZW50LmN1cnJlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgX2NsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgIFN0cmVhbS5wcm90b3R5cGUuX2NsZWFyLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLl9zb3VyY2VzID0gbnVsbDtcbiAgICAgIHRoaXMuX2N1cnJlbnRzID0gbnVsbDtcbiAgICAgIHRoaXMuX2NvbWJpbmF0b3IgPSBudWxsO1xuICAgIH1cbiAgfSk7XG4gIEtlZmlyLnNhbXBsZWRCeSA9IGZ1bmN0aW9uKHBhc3NpdmUsIGFjdGl2ZSwgY29tYmluYXRvcikge1xuICAgIHJldHVybiBuZXcgU2FtcGxlZEJ5KHBhc3NpdmUsIGFjdGl2ZSwgY29tYmluYXRvcik7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLnNhbXBsZWRCeSA9IGZ1bmN0aW9uKG90aGVyLCBjb21iaW5hdG9yKSB7XG4gICAgcmV0dXJuIEtlZmlyLnNhbXBsZWRCeShbdGhpc10sIFtvdGhlcl0sIGNvbWJpbmF0b3IgfHwgaWQpO1xuICB9O1xuICBLZWZpci5jb21iaW5lID0gZnVuY3Rpb24oc291cmNlcywgY29tYmluYXRvcikge1xuICAgIHJldHVybiBuZXcgU2FtcGxlZEJ5KFtdLCBzb3VyY2VzLCBjb21iaW5hdG9yKS5zZXROYW1lKCdjb21iaW5lJyk7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLmNvbWJpbmUgPSBmdW5jdGlvbihvdGhlciwgY29tYmluYXRvcikge1xuICAgIHJldHVybiBLZWZpci5jb21iaW5lKFt0aGlzLCBvdGhlcl0sIGNvbWJpbmF0b3IpO1xuICB9O1xuICBmdW5jdGlvbiBwcm9kdWNlU3RyZWFtKFN0cmVhbUNsYXNzLCBQcm9wZXJ0eUNsYXNzKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBTdHJlYW1DbGFzcyh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gcHJvZHVjZVByb3BlcnR5KFN0cmVhbUNsYXNzLCBQcm9wZXJ0eUNsYXNzKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBQcm9wZXJ0eUNsYXNzKHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfVxuICB3aXRoT25lU291cmNlKCd0b1Byb3BlcnR5Jywge19pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICBpZiAoYXJncy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIGFyZ3NbMF0pO1xuICAgICAgfVxuICAgIH19LCB7XG4gICAgcHJvcGVydHlNZXRob2Q6IHByb2R1Y2VQcm9wZXJ0eSxcbiAgICBzdHJlYW1NZXRob2Q6IHByb2R1Y2VQcm9wZXJ0eVxuICB9KTtcbiAgd2l0aE9uZVNvdXJjZSgnY2hhbmdlcycsIHtcbiAgICBfaGFuZGxlVmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKCFpc0N1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgeCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfaGFuZGxlRXJyb3I6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKCFpc0N1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFUlJPUiwgeCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAgc3RyZWFtTWV0aG9kOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgIH0sXG4gICAgcHJvcGVydHlNZXRob2Q6IHByb2R1Y2VTdHJlYW1cbiAgfSk7XG4gIHdpdGhPbmVTb3VyY2UoJ3dpdGhIYW5kbGVyJywge1xuICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICB0aGlzLl9oYW5kbGVyID0gYXJnc1swXTtcbiAgICAgIHRoaXMuX2ZvcmNlZEN1cnJlbnQgPSBmYWxzZTtcbiAgICAgIHZhciAkID0gdGhpcztcbiAgICAgIHRoaXMuX2VtaXR0ZXIgPSB7XG4gICAgICAgIGVtaXQ6IGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAkLl9zZW5kKFZBTFVFLCB4LCAkLl9mb3JjZWRDdXJyZW50KTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAkLl9zZW5kKEVSUk9SLCB4LCAkLl9mb3JjZWRDdXJyZW50KTtcbiAgICAgICAgfSxcbiAgICAgICAgZW5kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkLl9zZW5kKEVORCwgbnVsbCwgJC5fZm9yY2VkQ3VycmVudCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBfZnJlZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9oYW5kbGVyID0gbnVsbDtcbiAgICAgIHRoaXMuX2VtaXR0ZXIgPSBudWxsO1xuICAgIH0sXG4gICAgX2hhbmRsZUFueTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHRoaXMuX2ZvcmNlZEN1cnJlbnQgPSBldmVudC5jdXJyZW50O1xuICAgICAgdGhpcy5faGFuZGxlcih0aGlzLl9lbWl0dGVyLCBldmVudCk7XG4gICAgICB0aGlzLl9mb3JjZWRDdXJyZW50ID0gZmFsc2U7XG4gICAgfVxuICB9KTtcbiAgd2l0aE9uZVNvdXJjZSgnZmxhdHRlbicsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5fZm4gPSBhcmdzWzBdID8gYXJnc1swXSA6IGlkO1xuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZm4gPSBudWxsO1xuICAgIH0sXG4gICAgX2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIHZhciB4cyA9IHRoaXMuX2ZuKHgpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4c1tpXSwgaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBmdW5jdGlvbiB4Zm9ybUZvck9icyhvYnMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3RlcDogZnVuY3Rpb24ocmVzLCBpbnB1dCkge1xuICAgICAgICBvYnMuX3NlbmQoVkFMVUUsIGlucHV0LCBvYnMuX2ZvcmNlZEN1cnJlbnQpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0sXG4gICAgICByZXN1bHQ6IGZ1bmN0aW9uKHJlcykge1xuICAgICAgICBvYnMuX3NlbmQoRU5ELCBudWxsLCBvYnMuX2ZvcmNlZEN1cnJlbnQpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIHdpdGhPbmVTb3VyY2UoJ3RyYW5zZHVjZScsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5feGZvcm0gPSBhcmdzWzBdKHhmb3JtRm9yT2JzKHRoaXMpKTtcbiAgICB9LFxuICAgIF9mcmVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3hmb3JtID0gbnVsbDtcbiAgICB9LFxuICAgIF9oYW5kbGVWYWx1ZTogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICB0aGlzLl9mb3JjZWRDdXJyZW50ID0gaXNDdXJyZW50O1xuICAgICAgaWYgKHRoaXMuX3hmb3JtLnN0ZXAobnVsbCwgeCkgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5feGZvcm0ucmVzdWx0KG51bGwpO1xuICAgICAgfVxuICAgICAgdGhpcy5fZm9yY2VkQ3VycmVudCA9IGZhbHNlO1xuICAgIH0sXG4gICAgX2hhbmRsZUVuZDogZnVuY3Rpb24oX18sIGlzQ3VycmVudCkge1xuICAgICAgdGhpcy5fZm9yY2VkQ3VycmVudCA9IGlzQ3VycmVudDtcbiAgICAgIHRoaXMuX3hmb3JtLnJlc3VsdChudWxsKTtcbiAgICAgIHRoaXMuX2ZvcmNlZEN1cnJlbnQgPSBmYWxzZTtcbiAgICB9XG4gIH0pO1xuICB2YXIgd2l0aEZuQXJnTWl4aW4gPSB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX2ZuID0gYXJnc1swXSB8fCBpZDtcbiAgICB9LFxuICAgIF9mcmVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2ZuID0gbnVsbDtcbiAgICB9XG4gIH07XG4gIHdpdGhPbmVTb3VyY2UoJ21hcCcsIGV4dGVuZCh7X2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHRoaXMuX2ZuKHgpLCBpc0N1cnJlbnQpO1xuICAgIH19LCB3aXRoRm5BcmdNaXhpbikpO1xuICB3aXRoT25lU291cmNlKCdtYXBFcnJvcnMnLCBleHRlbmQoe19oYW5kbGVFcnJvcjogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICB0aGlzLl9zZW5kKEVSUk9SLCB0aGlzLl9mbih4KSwgaXNDdXJyZW50KTtcbiAgICB9fSwgd2l0aEZuQXJnTWl4aW4pKTtcbiAgZnVuY3Rpb24gZGVmYXVsdEVycm9yc1RvVmFsdWVzSGFuZGxlcih4KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbnZlcnQ6IHRydWUsXG4gICAgICB2YWx1ZTogeFxuICAgIH07XG4gIH1cbiAgd2l0aE9uZVNvdXJjZSgnZXJyb3JzVG9WYWx1ZXMnLCBleHRlbmQoe1xuICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICB0aGlzLl9mbiA9IGFyZ3NbMF0gfHwgZGVmYXVsdEVycm9yc1RvVmFsdWVzSGFuZGxlcjtcbiAgICB9LFxuICAgIF9mcmVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2ZuID0gbnVsbDtcbiAgICB9LFxuICAgIF9oYW5kbGVFcnJvcjogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fZm4oeCk7XG4gICAgICB2YXIgdHlwZSA9IHJlc3VsdC5jb252ZXJ0ID8gVkFMVUUgOiBFUlJPUjtcbiAgICAgIHZhciBuZXdYID0gcmVzdWx0LmNvbnZlcnQgPyByZXN1bHQudmFsdWUgOiB4O1xuICAgICAgdGhpcy5fc2VuZCh0eXBlLCBuZXdYLCBpc0N1cnJlbnQpO1xuICAgIH1cbiAgfSkpO1xuICBmdW5jdGlvbiBkZWZhdWx0VmFsdWVzVG9FcnJvcnNIYW5kbGVyKHgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY29udmVydDogdHJ1ZSxcbiAgICAgIGVycm9yOiB4XG4gICAgfTtcbiAgfVxuICB3aXRoT25lU291cmNlKCd2YWx1ZXNUb0Vycm9ycycsIGV4dGVuZCh7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX2ZuID0gYXJnc1swXSB8fCBkZWZhdWx0VmFsdWVzVG9FcnJvcnNIYW5kbGVyO1xuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZm4gPSBudWxsO1xuICAgIH0sXG4gICAgX2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9mbih4KTtcbiAgICAgIHZhciB0eXBlID0gcmVzdWx0LmNvbnZlcnQgPyBFUlJPUiA6IFZBTFVFO1xuICAgICAgdmFyIG5ld1ggPSByZXN1bHQuY29udmVydCA/IHJlc3VsdC5lcnJvciA6IHg7XG4gICAgICB0aGlzLl9zZW5kKHR5cGUsIG5ld1gsIGlzQ3VycmVudCk7XG4gICAgfVxuICB9KSk7XG4gIHdpdGhPbmVTb3VyY2UoJ2ZpbHRlcicsIGV4dGVuZCh7X2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmICh0aGlzLl9mbih4KSkge1xuICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgfVxuICAgIH19LCB3aXRoRm5BcmdNaXhpbikpO1xuICB3aXRoT25lU291cmNlKCdmaWx0ZXJFcnJvcnMnLCBleHRlbmQoe19oYW5kbGVFcnJvcjogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICBpZiAodGhpcy5fZm4oeCkpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFUlJPUiwgeCwgaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9fSwgd2l0aEZuQXJnTWl4aW4pKTtcbiAgd2l0aE9uZVNvdXJjZSgndGFrZVdoaWxlJywgZXh0ZW5kKHtfaGFuZGxlVmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKHRoaXMuX2ZuKHgpKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHgsIGlzQ3VycmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9zZW5kKEVORCwgbnVsbCwgaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9fSwgd2l0aEZuQXJnTWl4aW4pKTtcbiAgd2l0aE9uZVNvdXJjZSgndGFrZScsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5fbiA9IGFyZ3NbMF07XG4gICAgICBpZiAodGhpcy5fbiA8PSAwKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoRU5EKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9oYW5kbGVWYWx1ZTogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICB0aGlzLl9uLS07XG4gICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgaWYgKHRoaXMuX24gPT09IDApIHtcbiAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGlzQ3VycmVudCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgd2l0aE9uZVNvdXJjZSgnc2tpcCcsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5fbiA9IE1hdGgubWF4KDAsIGFyZ3NbMF0pO1xuICAgIH0sXG4gICAgX2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmICh0aGlzLl9uID09PSAwKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHgsIGlzQ3VycmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9uLS07XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgd2l0aE9uZVNvdXJjZSgnc2tpcER1cGxpY2F0ZXMnLCB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX2ZuID0gYXJnc1swXSB8fCBzdHJpY3RFcXVhbDtcbiAgICAgIHRoaXMuX3ByZXYgPSBOT1RISU5HO1xuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZm4gPSBudWxsO1xuICAgICAgdGhpcy5fcHJldiA9IG51bGw7XG4gICAgfSxcbiAgICBfaGFuZGxlVmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKHRoaXMuX3ByZXYgPT09IE5PVEhJTkcgfHwgIXRoaXMuX2ZuKHRoaXMuX3ByZXYsIHgpKSB7XG4gICAgICAgIHRoaXMuX3ByZXYgPSB4O1xuICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHdpdGhPbmVTb3VyY2UoJ3NraXBXaGlsZScsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5fZm4gPSBhcmdzWzBdIHx8IGlkO1xuICAgICAgdGhpcy5fc2tpcCA9IHRydWU7XG4gICAgfSxcbiAgICBfZnJlZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9mbiA9IG51bGw7XG4gICAgfSxcbiAgICBfaGFuZGxlVmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKCF0aGlzLl9za2lwKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHgsIGlzQ3VycmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5fZm4oeCkpIHtcbiAgICAgICAgdGhpcy5fc2tpcCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9mbiA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHgsIGlzQ3VycmVudCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgd2l0aE9uZVNvdXJjZSgnZGlmZicsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5fZm4gPSBhcmdzWzBdIHx8IGRlZmF1bHREaWZmO1xuICAgICAgdGhpcy5fcHJldiA9IGFyZ3MubGVuZ3RoID4gMSA/IGFyZ3NbMV0gOiBOT1RISU5HO1xuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fcHJldiA9IG51bGw7XG4gICAgICB0aGlzLl9mbiA9IG51bGw7XG4gICAgfSxcbiAgICBfaGFuZGxlVmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKHRoaXMuX3ByZXYgIT09IE5PVEhJTkcpIHtcbiAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgdGhpcy5fZm4odGhpcy5fcHJldiwgeCksIGlzQ3VycmVudCk7XG4gICAgICB9XG4gICAgICB0aGlzLl9wcmV2ID0geDtcbiAgICB9XG4gIH0pO1xuICB3aXRoT25lU291cmNlKCdzY2FuJywge1xuICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICB0aGlzLl9mbiA9IGFyZ3NbMF07XG4gICAgICBpZiAoYXJncy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIGFyZ3NbMV0sIHRydWUpO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZm4gPSBudWxsO1xuICAgIH0sXG4gICAgX2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmICh0aGlzLl9jdXJyZW50ICE9PSBOT1RISU5HKSB7XG4gICAgICAgIHggPSB0aGlzLl9mbih0aGlzLl9jdXJyZW50LCB4KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHgsIGlzQ3VycmVudCk7XG4gICAgfVxuICB9LCB7c3RyZWFtTWV0aG9kOiBwcm9kdWNlUHJvcGVydHl9KTtcbiAgd2l0aE9uZVNvdXJjZSgncmVkdWNlJywge1xuICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICB0aGlzLl9mbiA9IGFyZ3NbMF07XG4gICAgICB0aGlzLl9yZXN1bHQgPSBhcmdzLmxlbmd0aCA+IDEgPyBhcmdzWzFdIDogTk9USElORztcbiAgICB9LFxuICAgIF9mcmVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2ZuID0gbnVsbDtcbiAgICAgIHRoaXMuX3Jlc3VsdCA9IG51bGw7XG4gICAgfSxcbiAgICBfaGFuZGxlVmFsdWU6IGZ1bmN0aW9uKHgpIHtcbiAgICAgIHRoaXMuX3Jlc3VsdCA9ICh0aGlzLl9yZXN1bHQgPT09IE5PVEhJTkcpID8geCA6IHRoaXMuX2ZuKHRoaXMuX3Jlc3VsdCwgeCk7XG4gICAgfSxcbiAgICBfaGFuZGxlRW5kOiBmdW5jdGlvbihfXywgaXNDdXJyZW50KSB7XG4gICAgICBpZiAodGhpcy5fcmVzdWx0ICE9PSBOT1RISU5HKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHRoaXMuX3Jlc3VsdCwgaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NlbmQoRU5ELCBudWxsLCBpc0N1cnJlbnQpO1xuICAgIH1cbiAgfSk7XG4gIHdpdGhPbmVTb3VyY2UoJ21hcEVuZCcsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5fZm4gPSBhcmdzWzBdO1xuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZm4gPSBudWxsO1xuICAgIH0sXG4gICAgX2hhbmRsZUVuZDogZnVuY3Rpb24oX18sIGlzQ3VycmVudCkge1xuICAgICAgdGhpcy5fc2VuZChWQUxVRSwgdGhpcy5fZm4oKSwgaXNDdXJyZW50KTtcbiAgICAgIHRoaXMuX3NlbmQoRU5ELCBudWxsLCBpc0N1cnJlbnQpO1xuICAgIH1cbiAgfSk7XG4gIHdpdGhPbmVTb3VyY2UoJ3NraXBWYWx1ZXMnLCB7X2hhbmRsZVZhbHVlOiBmdW5jdGlvbigpIHt9fSk7XG4gIHdpdGhPbmVTb3VyY2UoJ3NraXBFcnJvcnMnLCB7X2hhbmRsZUVycm9yOiBmdW5jdGlvbigpIHt9fSk7XG4gIHdpdGhPbmVTb3VyY2UoJ3NraXBFbmQnLCB7X2hhbmRsZUVuZDogZnVuY3Rpb24oKSB7fX0pO1xuICB3aXRoT25lU291cmNlKCdlbmRPbkVycm9yJywgZXh0ZW5kKHtfaGFuZGxlRXJyb3I6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgdGhpcy5fc2VuZChFUlJPUiwgeCwgaXNDdXJyZW50KTtcbiAgICAgIHRoaXMuX3NlbmQoRU5ELCBudWxsLCBpc0N1cnJlbnQpO1xuICAgIH19KSk7XG4gIHdpdGhPbmVTb3VyY2UoJ3NsaWRpbmdXaW5kb3cnLCB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX21heCA9IGFyZ3NbMF07XG4gICAgICB0aGlzLl9taW4gPSBhcmdzWzFdIHx8IDA7XG4gICAgICB0aGlzLl9idWZmID0gW107XG4gICAgfSxcbiAgICBfZnJlZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9idWZmID0gbnVsbDtcbiAgICB9LFxuICAgIF9oYW5kbGVWYWx1ZTogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICB0aGlzLl9idWZmID0gc2xpZGUodGhpcy5fYnVmZiwgeCwgdGhpcy5fbWF4KTtcbiAgICAgIGlmICh0aGlzLl9idWZmLmxlbmd0aCA+PSB0aGlzLl9taW4pIHtcbiAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgdGhpcy5fYnVmZiwgaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICB3aXRoT25lU291cmNlKCdidWZmZXJXaGlsZScsIHtcbiAgICBfaW5pdDogZnVuY3Rpb24oYXJncykge1xuICAgICAgdGhpcy5fZm4gPSBhcmdzWzBdIHx8IGlkO1xuICAgICAgdGhpcy5fZmx1c2hPbkVuZCA9IGdldChhcmdzWzFdLCAnZmx1c2hPbkVuZCcsIHRydWUpO1xuICAgICAgdGhpcy5fYnVmZiA9IFtdO1xuICAgIH0sXG4gICAgX2ZyZWU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fYnVmZiA9IG51bGw7XG4gICAgfSxcbiAgICBfZmx1c2g6IGZ1bmN0aW9uKGlzQ3VycmVudCkge1xuICAgICAgaWYgKHRoaXMuX2J1ZmYgIT09IG51bGwgJiYgdGhpcy5fYnVmZi5sZW5ndGggIT09IDApIHtcbiAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgdGhpcy5fYnVmZiwgaXNDdXJyZW50KTtcbiAgICAgICAgdGhpcy5fYnVmZiA9IFtdO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIHRoaXMuX2J1ZmYucHVzaCh4KTtcbiAgICAgIGlmICghdGhpcy5fZm4oeCkpIHtcbiAgICAgICAgdGhpcy5fZmx1c2goaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9oYW5kbGVFbmQ6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKHRoaXMuX2ZsdXNoT25FbmQpIHtcbiAgICAgICAgdGhpcy5fZmx1c2goaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NlbmQoRU5ELCBudWxsLCBpc0N1cnJlbnQpO1xuICAgIH1cbiAgfSk7XG4gIHdpdGhPbmVTb3VyY2UoJ2RlYm91bmNlJywge1xuICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICB0aGlzLl93YWl0ID0gTWF0aC5tYXgoMCwgYXJnc1swXSk7XG4gICAgICB0aGlzLl9pbW1lZGlhdGUgPSBnZXQoYXJnc1sxXSwgJ2ltbWVkaWF0ZScsIGZhbHNlKTtcbiAgICAgIHRoaXMuX2xhc3RBdHRlbXB0ID0gMDtcbiAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG4gICAgICB0aGlzLl9sYXRlclZhbHVlID0gbnVsbDtcbiAgICAgIHRoaXMuX2VuZExhdGVyID0gZmFsc2U7XG4gICAgICB2YXIgJCA9IHRoaXM7XG4gICAgICB0aGlzLl8kbGF0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJC5fbGF0ZXIoKTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBfZnJlZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9sYXRlclZhbHVlID0gbnVsbDtcbiAgICAgIHRoaXMuXyRsYXRlciA9IG51bGw7XG4gICAgfSxcbiAgICBfaGFuZGxlVmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKGlzQ3VycmVudCkge1xuICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fbGFzdEF0dGVtcHQgPSBub3coKTtcbiAgICAgICAgaWYgKHRoaXMuX2ltbWVkaWF0ZSAmJiAhdGhpcy5fdGltZW91dElkKSB7XG4gICAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgeCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl90aW1lb3V0SWQpIHtcbiAgICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBzZXRUaW1lb3V0KHRoaXMuXyRsYXRlciwgdGhpcy5fd2FpdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9pbW1lZGlhdGUpIHtcbiAgICAgICAgICB0aGlzLl9sYXRlclZhbHVlID0geDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgX2hhbmRsZUVuZDogZnVuY3Rpb24oX18sIGlzQ3VycmVudCkge1xuICAgICAgaWYgKGlzQ3VycmVudCkge1xuICAgICAgICB0aGlzLl9zZW5kKEVORCwgbnVsbCwgaXNDdXJyZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQgJiYgIXRoaXMuX2ltbWVkaWF0ZSkge1xuICAgICAgICAgIHRoaXMuX2VuZExhdGVyID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9zZW5kKEVORCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIF9sYXRlcjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbGFzdCA9IG5vdygpIC0gdGhpcy5fbGFzdEF0dGVtcHQ7XG4gICAgICBpZiAobGFzdCA8IHRoaXMuX3dhaXQgJiYgbGFzdCA+PSAwKSB7XG4gICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IHNldFRpbWVvdXQodGhpcy5fJGxhdGVyLCB0aGlzLl93YWl0IC0gbGFzdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBudWxsO1xuICAgICAgICBpZiAoIXRoaXMuX2ltbWVkaWF0ZSkge1xuICAgICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHRoaXMuX2xhdGVyVmFsdWUpO1xuICAgICAgICAgIHRoaXMuX2xhdGVyVmFsdWUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9lbmRMYXRlcikge1xuICAgICAgICAgIHRoaXMuX3NlbmQoRU5EKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHdpdGhPbmVTb3VyY2UoJ3Rocm90dGxlJywge1xuICAgIF9pbml0OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICB0aGlzLl93YWl0ID0gTWF0aC5tYXgoMCwgYXJnc1swXSk7XG4gICAgICB0aGlzLl9sZWFkaW5nID0gZ2V0KGFyZ3NbMV0sICdsZWFkaW5nJywgdHJ1ZSk7XG4gICAgICB0aGlzLl90cmFpbGluZyA9IGdldChhcmdzWzFdLCAndHJhaWxpbmcnLCB0cnVlKTtcbiAgICAgIHRoaXMuX3RyYWlsaW5nVmFsdWUgPSBudWxsO1xuICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgIHRoaXMuX2VuZExhdGVyID0gZmFsc2U7XG4gICAgICB0aGlzLl9sYXN0Q2FsbFRpbWUgPSAwO1xuICAgICAgdmFyICQgPSB0aGlzO1xuICAgICAgdGhpcy5fJHRyYWlsaW5nQ2FsbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkLl90cmFpbGluZ0NhbGwoKTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBfZnJlZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl90cmFpbGluZ1ZhbHVlID0gbnVsbDtcbiAgICAgIHRoaXMuXyR0cmFpbGluZ0NhbGwgPSBudWxsO1xuICAgIH0sXG4gICAgX2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmIChpc0N1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgeCwgaXNDdXJyZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBjdXJUaW1lID0gbm93KCk7XG4gICAgICAgIGlmICh0aGlzLl9sYXN0Q2FsbFRpbWUgPT09IDAgJiYgIXRoaXMuX2xlYWRpbmcpIHtcbiAgICAgICAgICB0aGlzLl9sYXN0Q2FsbFRpbWUgPSBjdXJUaW1lO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZW1haW5pbmcgPSB0aGlzLl93YWl0IC0gKGN1clRpbWUgLSB0aGlzLl9sYXN0Q2FsbFRpbWUpO1xuICAgICAgICBpZiAocmVtYWluaW5nIDw9IDApIHtcbiAgICAgICAgICB0aGlzLl9jYW5jZWxUcmFsaW5nKCk7XG4gICAgICAgICAgdGhpcy5fbGFzdENhbGxUaW1lID0gY3VyVGltZTtcbiAgICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4KTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl90cmFpbGluZykge1xuICAgICAgICAgIHRoaXMuX2NhbmNlbFRyYWxpbmcoKTtcbiAgICAgICAgICB0aGlzLl90cmFpbGluZ1ZhbHVlID0geDtcbiAgICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBzZXRUaW1lb3V0KHRoaXMuXyR0cmFpbGluZ0NhbGwsIHJlbWFpbmluZyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIF9oYW5kbGVFbmQ6IGZ1bmN0aW9uKF9fLCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmIChpc0N1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGlzQ3VycmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5fdGltZW91dElkKSB7XG4gICAgICAgICAgdGhpcy5fZW5kTGF0ZXIgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX3NlbmQoRU5EKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgX2NhbmNlbFRyYWxpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3RpbWVvdXRJZCAhPT0gbnVsbCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKTtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIF90cmFpbGluZ0NhbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc2VuZChWQUxVRSwgdGhpcy5fdHJhaWxpbmdWYWx1ZSk7XG4gICAgICB0aGlzLl90aW1lb3V0SWQgPSBudWxsO1xuICAgICAgdGhpcy5fdHJhaWxpbmdWYWx1ZSA9IG51bGw7XG4gICAgICB0aGlzLl9sYXN0Q2FsbFRpbWUgPSAhdGhpcy5fbGVhZGluZyA/IDAgOiBub3coKTtcbiAgICAgIGlmICh0aGlzLl9lbmRMYXRlcikge1xuICAgICAgICB0aGlzLl9zZW5kKEVORCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgd2l0aE9uZVNvdXJjZSgnZGVsYXknLCB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX3dhaXQgPSBNYXRoLm1heCgwLCBhcmdzWzBdKTtcbiAgICAgIHRoaXMuX2J1ZmYgPSBbXTtcbiAgICAgIHZhciAkID0gdGhpcztcbiAgICAgIHRoaXMuXyRzaGlmdEJ1ZmYgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJC5fc2VuZChWQUxVRSwgJC5fYnVmZi5zaGlmdCgpKTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBfZnJlZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9idWZmID0gbnVsbDtcbiAgICAgIHRoaXMuXyRzaGlmdEJ1ZmYgPSBudWxsO1xuICAgIH0sXG4gICAgX2hhbmRsZVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmIChpc0N1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChWQUxVRSwgeCwgaXNDdXJyZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2J1ZmYucHVzaCh4KTtcbiAgICAgICAgc2V0VGltZW91dCh0aGlzLl8kc2hpZnRCdWZmLCB0aGlzLl93YWl0KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9oYW5kbGVFbmQ6IGZ1bmN0aW9uKF9fLCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmIChpc0N1cnJlbnQpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGlzQ3VycmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgJCA9IHRoaXM7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJC5fc2VuZChFTkQpO1xuICAgICAgICB9LCB0aGlzLl93YWl0KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBmdW5jdGlvbiBGcm9tQmluZGVyKGZuKSB7XG4gICAgU3RyZWFtLmNhbGwodGhpcyk7XG4gICAgdGhpcy5fZm4gPSBmbjtcbiAgICB0aGlzLl91bnN1YnNjcmliZSA9IG51bGw7XG4gIH1cbiAgaW5oZXJpdChGcm9tQmluZGVyLCBTdHJlYW0sIHtcbiAgICBfbmFtZTogJ2Zyb21CaW5kZXInLFxuICAgIF9vbkFjdGl2YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyICQgPSB0aGlzLFxuICAgICAgICAgIGlzQ3VycmVudCA9IHRydWUsXG4gICAgICAgICAgZW1pdHRlciA9IHtcbiAgICAgICAgICAgIGVtaXQ6IGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAgICAgJC5fc2VuZChWQUxVRSwgeCwgaXNDdXJyZW50KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oeCkge1xuICAgICAgICAgICAgICAkLl9zZW5kKEVSUk9SLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVuZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICQuX3NlbmQoRU5ELCBudWxsLCBpc0N1cnJlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICB0aGlzLl91bnN1YnNjcmliZSA9IHRoaXMuX2ZuKGVtaXR0ZXIpIHx8IG51bGw7XG4gICAgICBpZiAoIXRoaXMuX2FjdGl2ZSAmJiB0aGlzLl91bnN1YnNjcmliZSAhPT0gbnVsbCkge1xuICAgICAgICB0aGlzLl91bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLl91bnN1YnNjcmliZSA9IG51bGw7XG4gICAgICB9XG4gICAgICBpc0N1cnJlbnQgPSBmYWxzZTtcbiAgICB9LFxuICAgIF9vbkRlYWN0aXZhdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fdW5zdWJzY3JpYmUgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5fdW5zdWJzY3JpYmUgPSBudWxsO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2NsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgIFN0cmVhbS5wcm90b3R5cGUuX2NsZWFyLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLl9mbiA9IG51bGw7XG4gICAgfVxuICB9KTtcbiAgS2VmaXIuZnJvbUJpbmRlciA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgcmV0dXJuIG5ldyBGcm9tQmluZGVyKGZuKTtcbiAgfTtcbiAgZnVuY3Rpb24gRW1pdHRlcigpIHtcbiAgICBTdHJlYW0uY2FsbCh0aGlzKTtcbiAgfVxuICBpbmhlcml0KEVtaXR0ZXIsIFN0cmVhbSwge1xuICAgIF9uYW1lOiAnZW1pdHRlcicsXG4gICAgZW1pdDogZnVuY3Rpb24oeCkge1xuICAgICAgdGhpcy5fc2VuZChWQUxVRSwgeCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIGVycm9yOiBmdW5jdGlvbih4KSB7XG4gICAgICB0aGlzLl9zZW5kKEVSUk9SLCB4KTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgZW5kOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3NlbmQoRU5EKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSk7XG4gIEtlZmlyLmVtaXR0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEVtaXR0ZXIoKTtcbiAgfTtcbiAgS2VmaXIuRW1pdHRlciA9IEVtaXR0ZXI7XG4gIHZhciBuZXZlck9iaiA9IG5ldyBTdHJlYW0oKTtcbiAgbmV2ZXJPYmouX3NlbmQoRU5EKTtcbiAgbmV2ZXJPYmouX25hbWUgPSAnbmV2ZXInO1xuICBLZWZpci5uZXZlciA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXZlck9iajtcbiAgfTtcbiAgZnVuY3Rpb24gQ29uc3RhbnQoeCkge1xuICAgIFByb3BlcnR5LmNhbGwodGhpcyk7XG4gICAgdGhpcy5fc2VuZChWQUxVRSwgeCk7XG4gICAgdGhpcy5fc2VuZChFTkQpO1xuICB9XG4gIGluaGVyaXQoQ29uc3RhbnQsIFByb3BlcnR5LCB7X25hbWU6ICdjb25zdGFudCd9KTtcbiAgS2VmaXIuY29uc3RhbnQgPSBmdW5jdGlvbih4KSB7XG4gICAgcmV0dXJuIG5ldyBDb25zdGFudCh4KTtcbiAgfTtcbiAgZnVuY3Rpb24gQ29uc3RhbnRFcnJvcih4KSB7XG4gICAgUHJvcGVydHkuY2FsbCh0aGlzKTtcbiAgICB0aGlzLl9zZW5kKEVSUk9SLCB4KTtcbiAgICB0aGlzLl9zZW5kKEVORCk7XG4gIH1cbiAgaW5oZXJpdChDb25zdGFudEVycm9yLCBQcm9wZXJ0eSwge19uYW1lOiAnY29uc3RhbnRFcnJvcid9KTtcbiAgS2VmaXIuY29uc3RhbnRFcnJvciA9IGZ1bmN0aW9uKHgpIHtcbiAgICByZXR1cm4gbmV3IENvbnN0YW50RXJyb3IoeCk7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLnNldE5hbWUgPSBmdW5jdGlvbihzb3VyY2VPYnMsIHNlbGZOYW1lKSB7XG4gICAgdGhpcy5fbmFtZSA9IHNlbGZOYW1lID8gc291cmNlT2JzLl9uYW1lICsgJy4nICsgc2VsZk5hbWUgOiBzb3VyY2VPYnM7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLm1hcFRvID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSkuc2V0TmFtZSh0aGlzLCAnbWFwVG8nKTtcbiAgfTtcbiAgT2JzZXJ2YWJsZS5wcm90b3R5cGUucGx1Y2sgPSBmdW5jdGlvbihwcm9wZXJ0eU5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oeCkge1xuICAgICAgcmV0dXJuIHhbcHJvcGVydHlOYW1lXTtcbiAgICB9KS5zZXROYW1lKHRoaXMsICdwbHVjaycpO1xuICB9O1xuICBPYnNlcnZhYmxlLnByb3RvdHlwZS5pbnZva2UgPSBmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgdmFyIGFyZ3MgPSByZXN0KGFyZ3VtZW50cywgMSk7XG4gICAgcmV0dXJuIHRoaXMubWFwKGFyZ3MgPyBmdW5jdGlvbih4KSB7XG4gICAgICByZXR1cm4gYXBwbHkoeFttZXRob2ROYW1lXSwgeCwgYXJncyk7XG4gICAgfSA6IGZ1bmN0aW9uKHgpIHtcbiAgICAgIHJldHVybiB4W21ldGhvZE5hbWVdKCk7XG4gICAgfSkuc2V0TmFtZSh0aGlzLCAnaW52b2tlJyk7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLnRpbWVzdGFtcCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbih4KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogeCxcbiAgICAgICAgdGltZTogbm93KClcbiAgICAgIH07XG4gICAgfSkuc2V0TmFtZSh0aGlzLCAndGltZXN0YW1wJyk7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLnRhcCA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKHgpIHtcbiAgICAgIGZuKHgpO1xuICAgICAgcmV0dXJuIHg7XG4gICAgfSkuc2V0TmFtZSh0aGlzLCAndGFwJyk7XG4gIH07XG4gIEtlZmlyLmFuZCA9IGZ1bmN0aW9uKG9ic2VydmFibGVzKSB7XG4gICAgcmV0dXJuIEtlZmlyLmNvbWJpbmUob2JzZXJ2YWJsZXMsIGFuZCkuc2V0TmFtZSgnYW5kJyk7XG4gIH07XG4gIE9ic2VydmFibGUucHJvdG90eXBlLmFuZCA9IGZ1bmN0aW9uKG90aGVyKSB7XG4gICAgcmV0dXJuIHRoaXMuY29tYmluZShvdGhlciwgYW5kKS5zZXROYW1lKCdhbmQnKTtcbiAgfTtcbiAgS2VmaXIub3IgPSBmdW5jdGlvbihvYnNlcnZhYmxlcykge1xuICAgIHJldHVybiBLZWZpci5jb21iaW5lKG9ic2VydmFibGVzLCBvcikuc2V0TmFtZSgnb3InKTtcbiAgfTtcbiAgT2JzZXJ2YWJsZS5wcm90b3R5cGUub3IgPSBmdW5jdGlvbihvdGhlcikge1xuICAgIHJldHVybiB0aGlzLmNvbWJpbmUob3RoZXIsIG9yKS5zZXROYW1lKCdvcicpO1xuICB9O1xuICBPYnNlcnZhYmxlLnByb3RvdHlwZS5ub3QgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAobm90KS5zZXROYW1lKHRoaXMsICdub3QnKTtcbiAgfTtcbiAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuYXdhaXRpbmcgPSBmdW5jdGlvbihvdGhlcikge1xuICAgIHJldHVybiBLZWZpci5tZXJnZShbdGhpcy5tYXBUbyh0cnVlKSwgb3RoZXIubWFwVG8oZmFsc2UpXSkuc2tpcER1cGxpY2F0ZXMoKS50b1Byb3BlcnR5KGZhbHNlKS5zZXROYW1lKHRoaXMsICdhd2FpdGluZycpO1xuICB9O1xuICBLZWZpci5mcm9tQ2FsbGJhY2sgPSBmdW5jdGlvbihjYWxsYmFja0NvbnN1bWVyKSB7XG4gICAgdmFyIGNhbGxlZCA9IGZhbHNlO1xuICAgIHJldHVybiBLZWZpci5mcm9tQmluZGVyKGZ1bmN0aW9uKGVtaXR0ZXIpIHtcbiAgICAgIGlmICghY2FsbGVkKSB7XG4gICAgICAgIGNhbGxiYWNrQ29uc3VtZXIoZnVuY3Rpb24oeCkge1xuICAgICAgICAgIGVtaXR0ZXIuZW1pdCh4KTtcbiAgICAgICAgICBlbWl0dGVyLmVuZCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgY2FsbGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KS5zZXROYW1lKCdmcm9tQ2FsbGJhY2snKTtcbiAgfTtcbiAgS2VmaXIuZnJvbU5vZGVDYWxsYmFjayA9IGZ1bmN0aW9uKGNhbGxiYWNrQ29uc3VtZXIpIHtcbiAgICB2YXIgY2FsbGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIEtlZmlyLmZyb21CaW5kZXIoZnVuY3Rpb24oZW1pdHRlcikge1xuICAgICAgaWYgKCFjYWxsZWQpIHtcbiAgICAgICAgY2FsbGJhY2tDb25zdW1lcihmdW5jdGlvbihlcnJvciwgeCkge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgZW1pdHRlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVtaXR0ZXIuZW1pdCh4KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZW1pdHRlci5lbmQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNhbGxlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSkuc2V0TmFtZSgnZnJvbU5vZGVDYWxsYmFjaycpO1xuICB9O1xuICBLZWZpci5mcm9tUHJvbWlzZSA9IGZ1bmN0aW9uKHByb21pc2UpIHtcbiAgICB2YXIgY2FsbGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIEtlZmlyLmZyb21CaW5kZXIoZnVuY3Rpb24oZW1pdHRlcikge1xuICAgICAgaWYgKCFjYWxsZWQpIHtcbiAgICAgICAgdmFyIG9uVmFsdWUgPSBmdW5jdGlvbih4KSB7XG4gICAgICAgICAgZW1pdHRlci5lbWl0KHgpO1xuICAgICAgICAgIGVtaXR0ZXIuZW5kKCk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24oeCkge1xuICAgICAgICAgIGVtaXR0ZXIuZXJyb3IoeCk7XG4gICAgICAgICAgZW1pdHRlci5lbmQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF9wcm9taXNlID0gcHJvbWlzZS50aGVuKG9uVmFsdWUsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoX3Byb21pc2UgJiYgaXNGbihfcHJvbWlzZS5kb25lKSkge1xuICAgICAgICAgIF9wcm9taXNlLmRvbmUoKTtcbiAgICAgICAgfVxuICAgICAgICBjYWxsZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pLnRvUHJvcGVydHkoKS5zZXROYW1lKCdmcm9tUHJvbWlzZScpO1xuICB9O1xuICBLZWZpci5mcm9tU3ViVW5zdWIgPSBmdW5jdGlvbihzdWIsIHVuc3ViLCB0cmFuc2Zvcm1lcikge1xuICAgIHJldHVybiBLZWZpci5mcm9tQmluZGVyKGZ1bmN0aW9uKGVtaXR0ZXIpIHtcbiAgICAgIHZhciBoYW5kbGVyID0gdHJhbnNmb3JtZXIgPyBmdW5jdGlvbigpIHtcbiAgICAgICAgZW1pdHRlci5lbWl0KGFwcGx5KHRyYW5zZm9ybWVyLCB0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgIH0gOiBlbWl0dGVyLmVtaXQ7XG4gICAgICBzdWIoaGFuZGxlcik7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHVuc3ViKGhhbmRsZXIpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfTtcbiAgdmFyIHN1YlVuc3ViUGFpcnMgPSBbWydhZGRFdmVudExpc3RlbmVyJywgJ3JlbW92ZUV2ZW50TGlzdGVuZXInXSwgWydhZGRMaXN0ZW5lcicsICdyZW1vdmVMaXN0ZW5lciddLCBbJ29uJywgJ29mZiddXTtcbiAgS2VmaXIuZnJvbUV2ZW50ID0gZnVuY3Rpb24odGFyZ2V0LCBldmVudE5hbWUsIHRyYW5zZm9ybWVyKSB7XG4gICAgdmFyIHBhaXIsXG4gICAgICAgIHN1YixcbiAgICAgICAgdW5zdWI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJVbnN1YlBhaXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBwYWlyID0gc3ViVW5zdWJQYWlyc1tpXTtcbiAgICAgIGlmIChpc0ZuKHRhcmdldFtwYWlyWzBdXSkgJiYgaXNGbih0YXJnZXRbcGFpclsxXV0pKSB7XG4gICAgICAgIHN1YiA9IHBhaXJbMF07XG4gICAgICAgIHVuc3ViID0gcGFpclsxXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChzdWIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCd0YXJnZXQgZG9uXFwndCBzdXBwb3J0IGFueSBvZiAnICsgJ2FkZEV2ZW50TGlzdGVuZXIvcmVtb3ZlRXZlbnRMaXN0ZW5lciwgYWRkTGlzdGVuZXIvcmVtb3ZlTGlzdGVuZXIsIG9uL29mZiBtZXRob2QgcGFpcicpO1xuICAgIH1cbiAgICByZXR1cm4gS2VmaXIuZnJvbVN1YlVuc3ViKGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgIHRhcmdldFtzdWJdKGV2ZW50TmFtZSwgaGFuZGxlcik7XG4gICAgfSwgZnVuY3Rpb24oaGFuZGxlcikge1xuICAgICAgdGFyZ2V0W3Vuc3ViXShldmVudE5hbWUsIGhhbmRsZXIpO1xuICAgIH0sIHRyYW5zZm9ybWVyKS5zZXROYW1lKCdmcm9tRXZlbnQnKTtcbiAgfTtcbiAgdmFyIHdpdGhUd29Tb3VyY2VzQW5kQnVmZmVyTWl4aW4gPSB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIHRoaXMuX2J1ZmYgPSBbXTtcbiAgICAgIHRoaXMuX2ZsdXNoT25FbmQgPSBnZXQoYXJnc1swXSwgJ2ZsdXNoT25FbmQnLCB0cnVlKTtcbiAgICB9LFxuICAgIF9mcmVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2J1ZmYgPSBudWxsO1xuICAgIH0sXG4gICAgX2ZsdXNoOiBmdW5jdGlvbihpc0N1cnJlbnQpIHtcbiAgICAgIGlmICh0aGlzLl9idWZmICE9PSBudWxsICYmIHRoaXMuX2J1ZmYubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHRoaXMuX2J1ZmYsIGlzQ3VycmVudCk7XG4gICAgICAgIHRoaXMuX2J1ZmYgPSBbXTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9oYW5kbGVQcmltYXJ5RW5kOiBmdW5jdGlvbihfXywgaXNDdXJyZW50KSB7XG4gICAgICBpZiAodGhpcy5fZmx1c2hPbkVuZCkge1xuICAgICAgICB0aGlzLl9mbHVzaChpc0N1cnJlbnQpO1xuICAgICAgfVxuICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGlzQ3VycmVudCk7XG4gICAgfVxuICB9O1xuICB3aXRoVHdvU291cmNlcygnYnVmZmVyQnknLCBleHRlbmQoe1xuICAgIF9vbkFjdGl2YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fcHJpbWFyeS5vbkFueSh0aGlzLl8kaGFuZGxlUHJpbWFyeUFueSk7XG4gICAgICBpZiAodGhpcy5fYWxpdmUgJiYgdGhpcy5fc2Vjb25kYXJ5ICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX3NlY29uZGFyeS5vbkFueSh0aGlzLl8kaGFuZGxlU2Vjb25kYXJ5QW55KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9oYW5kbGVQcmltYXJ5VmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgdGhpcy5fYnVmZi5wdXNoKHgpO1xuICAgIH0sXG4gICAgX2hhbmRsZVNlY29uZGFyeVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIHRoaXMuX2ZsdXNoKGlzQ3VycmVudCk7XG4gICAgfSxcbiAgICBfaGFuZGxlU2Vjb25kYXJ5RW5kOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmICghdGhpcy5fZmx1c2hPbkVuZCkge1xuICAgICAgICB0aGlzLl9zZW5kKEVORCwgbnVsbCwgaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHdpdGhUd29Tb3VyY2VzQW5kQnVmZmVyTWl4aW4pKTtcbiAgd2l0aFR3b1NvdXJjZXMoJ2J1ZmZlcldoaWxlQnknLCBleHRlbmQoe1xuICAgIF9oYW5kbGVQcmltYXJ5VmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgdGhpcy5fYnVmZi5wdXNoKHgpO1xuICAgICAgaWYgKHRoaXMuX2xhc3RTZWNvbmRhcnkgIT09IE5PVEhJTkcgJiYgIXRoaXMuX2xhc3RTZWNvbmRhcnkpIHtcbiAgICAgICAgdGhpcy5fZmx1c2goaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIF9oYW5kbGVTZWNvbmRhcnlFbmQ6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgaWYgKCF0aGlzLl9mbHVzaE9uRW5kICYmICh0aGlzLl9sYXN0U2Vjb25kYXJ5ID09PSBOT1RISU5HIHx8IHRoaXMuX2xhc3RTZWNvbmRhcnkpKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoRU5ELCBudWxsLCBpc0N1cnJlbnQpO1xuICAgICAgfVxuICAgIH1cbiAgfSwgd2l0aFR3b1NvdXJjZXNBbmRCdWZmZXJNaXhpbikpO1xuICB3aXRoVHdvU291cmNlcygnZmlsdGVyQnknLCB7XG4gICAgX2hhbmRsZVByaW1hcnlWYWx1ZTogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICBpZiAodGhpcy5fbGFzdFNlY29uZGFyeSAhPT0gTk9USElORyAmJiB0aGlzLl9sYXN0U2Vjb25kYXJ5KSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHgsIGlzQ3VycmVudCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfaGFuZGxlU2Vjb25kYXJ5RW5kOiBmdW5jdGlvbihfXywgaXNDdXJyZW50KSB7XG4gICAgICBpZiAodGhpcy5fbGFzdFNlY29uZGFyeSA9PT0gTk9USElORyB8fCAhdGhpcy5fbGFzdFNlY29uZGFyeSkge1xuICAgICAgICB0aGlzLl9zZW5kKEVORCwgbnVsbCwgaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICB3aXRoVHdvU291cmNlcygnc2tpcFVudGlsQnknLCB7XG4gICAgX2hhbmRsZVByaW1hcnlWYWx1ZTogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICBpZiAodGhpcy5fbGFzdFNlY29uZGFyeSAhPT0gTk9USElORykge1xuICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2hhbmRsZVNlY29uZGFyeUVuZDogZnVuY3Rpb24oX18sIGlzQ3VycmVudCkge1xuICAgICAgaWYgKHRoaXMuX2xhc3RTZWNvbmRhcnkgPT09IE5PVEhJTkcpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGlzQ3VycmVudCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgd2l0aFR3b1NvdXJjZXMoJ3Rha2VVbnRpbEJ5Jywge19oYW5kbGVTZWNvbmRhcnlWYWx1ZTogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICB0aGlzLl9zZW5kKEVORCwgbnVsbCwgaXNDdXJyZW50KTtcbiAgICB9fSk7XG4gIHdpdGhUd29Tb3VyY2VzKCd0YWtlV2hpbGVCeScsIHtcbiAgICBfaGFuZGxlUHJpbWFyeVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIGlmICh0aGlzLl9sYXN0U2Vjb25kYXJ5ICE9PSBOT1RISU5HKSB7XG4gICAgICAgIHRoaXMuX3NlbmQoVkFMVUUsIHgsIGlzQ3VycmVudCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfaGFuZGxlU2Vjb25kYXJ5VmFsdWU6IGZ1bmN0aW9uKHgsIGlzQ3VycmVudCkge1xuICAgICAgdGhpcy5fbGFzdFNlY29uZGFyeSA9IHg7XG4gICAgICBpZiAoIXRoaXMuX2xhc3RTZWNvbmRhcnkpIHtcbiAgICAgICAgdGhpcy5fc2VuZChFTkQsIG51bGwsIGlzQ3VycmVudCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBfaGFuZGxlU2Vjb25kYXJ5RW5kOiBmdW5jdGlvbihfXywgaXNDdXJyZW50KSB7XG4gICAgICBpZiAodGhpcy5fbGFzdFNlY29uZGFyeSA9PT0gTk9USElORykge1xuICAgICAgICB0aGlzLl9zZW5kKEVORCwgbnVsbCwgaXNDdXJyZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICB3aXRoVHdvU291cmNlcygnc2tpcFdoaWxlQnknLCB7XG4gICAgX2luaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5faGFzRmFsc2V5RnJvbVNlY29uZGFyeSA9IGZhbHNlO1xuICAgIH0sXG4gICAgX2hhbmRsZVByaW1hcnlWYWx1ZTogZnVuY3Rpb24oeCwgaXNDdXJyZW50KSB7XG4gICAgICBpZiAodGhpcy5faGFzRmFsc2V5RnJvbVNlY29uZGFyeSkge1xuICAgICAgICB0aGlzLl9zZW5kKFZBTFVFLCB4LCBpc0N1cnJlbnQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2hhbmRsZVNlY29uZGFyeVZhbHVlOiBmdW5jdGlvbih4LCBpc0N1cnJlbnQpIHtcbiAgICAgIHRoaXMuX2hhc0ZhbHNleUZyb21TZWNvbmRhcnkgPSB0aGlzLl9oYXNGYWxzZXlGcm9tU2Vjb25kYXJ5IHx8ICF4O1xuICAgIH0sXG4gICAgX2hhbmRsZVNlY29uZGFyeUVuZDogZnVuY3Rpb24oX18sIGlzQ3VycmVudCkge1xuICAgICAgaWYgKCF0aGlzLl9oYXNGYWxzZXlGcm9tU2Vjb25kYXJ5KSB7XG4gICAgICAgIHRoaXMuX3NlbmQoRU5ELCBudWxsLCBpc0N1cnJlbnQpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW10sIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEtlZmlyO1xuICAgIH0pO1xuICAgIGdsb2JhbC5LZWZpciA9IEtlZmlyO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IEtlZmlyO1xuICAgIEtlZmlyLktlZmlyID0gS2VmaXI7XG4gIH0gZWxzZSB7XG4gICAgZ2xvYmFsLktlZmlyID0gS2VmaXI7XG4gIH1cbn0odGhpcykpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL2Jvd2VyX2NvbXBvbmVudHMva2VmaXIvZGlzdC9rZWZpci5qc1xuICoqIG1vZHVsZSBpZCA9IDQyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJ2b2lkIDAgPT09IERhdGUubm93ICYmIChEYXRlLm5vdyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gKG5ldyBEYXRlKS52YWx1ZU9mKCk7XG59KTtcbnZhciBUV0VFTiA9IFRXRUVOIHx8IGZ1bmN0aW9uKCkge1xuICB2YXIgbiA9IFtdO1xuICByZXR1cm4ge1xuICAgIFJFVklTSU9OOiBcIjE0XCIsXG4gICAgZ2V0QWxsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuO1xuICAgIH0sXG4gICAgcmVtb3ZlQWxsOiBmdW5jdGlvbigpIHtcbiAgICAgIG4gPSBbXTtcbiAgICB9LFxuICAgIGFkZDogZnVuY3Rpb24odCkge1xuICAgICAgbi5wdXNoKHQpO1xuICAgIH0sXG4gICAgcmVtb3ZlOiBmdW5jdGlvbih0KSB7XG4gICAgICB2YXIgciA9IG4uaW5kZXhPZih0KTtcbiAgICAgIC0xICE9PSByICYmIG4uc3BsaWNlKHIsIDEpO1xuICAgIH0sXG4gICAgdXBkYXRlOiBmdW5jdGlvbih0KSB7XG4gICAgICBpZiAoMCA9PT0gbi5sZW5ndGgpXG4gICAgICAgIHJldHVybiAhMTtcbiAgICAgIHZhciByID0gMDtcbiAgICAgIGZvciAodCA9IHZvaWQgMCAhPT0gdCA/IHQgOiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB3aW5kb3cgJiYgdm9pZCAwICE9PSB3aW5kb3cucGVyZm9ybWFuY2UgJiYgdm9pZCAwICE9PSB3aW5kb3cucGVyZm9ybWFuY2Uubm93ID8gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpIDogRGF0ZS5ub3coKTsgciA8IG4ubGVuZ3RoOyApXG4gICAgICAgIG5bcl0udXBkYXRlKHQpID8gcisrIDogbi5zcGxpY2UociwgMSk7XG4gICAgICByZXR1cm4gITA7XG4gICAgfVxuICB9O1xufSgpO1xuVFdFRU4uVHdlZW4gPSBmdW5jdGlvbihuKSB7XG4gIHZhciB0ID0gbixcbiAgICAgIHIgPSB7fSxcbiAgICAgIGkgPSB7fSxcbiAgICAgIHUgPSB7fSxcbiAgICAgIG8gPSAxZTMsXG4gICAgICBlID0gMCxcbiAgICAgIGEgPSAhMSxcbiAgICAgIGYgPSAhMSxcbiAgICAgIGMgPSAhMSxcbiAgICAgIHMgPSAwLFxuICAgICAgaCA9IG51bGwsXG4gICAgICBsID0gVFdFRU4uRWFzaW5nLkxpbmVhci5Ob25lLFxuICAgICAgcCA9IFRXRUVOLkludGVycG9sYXRpb24uTGluZWFyLFxuICAgICAgRSA9IFtdLFxuICAgICAgZCA9IG51bGwsXG4gICAgICB2ID0gITEsXG4gICAgICBJID0gbnVsbCxcbiAgICAgIHcgPSBudWxsLFxuICAgICAgTSA9IG51bGw7XG4gIGZvciAodmFyIE8gaW4gbilcbiAgICByW09dID0gcGFyc2VGbG9hdChuW09dLCAxMCk7XG4gIHRoaXMudG8gPSBmdW5jdGlvbihuLCB0KSB7XG4gICAgcmV0dXJuIHZvaWQgMCAhPT0gdCAmJiAobyA9IHQpLCBpID0gbiwgdGhpcztcbiAgfSwgdGhpcy5zdGFydCA9IGZ1bmN0aW9uKG4pIHtcbiAgICBUV0VFTi5hZGQodGhpcyksIGYgPSAhMCwgdiA9ICExLCBoID0gdm9pZCAwICE9PSBuID8gbiA6IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB2b2lkIDAgIT09IHdpbmRvdy5wZXJmb3JtYW5jZSAmJiB2b2lkIDAgIT09IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cgPyB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgOiBEYXRlLm5vdygpLCBoICs9IHM7XG4gICAgZm9yICh2YXIgbyBpbiBpKSB7XG4gICAgICBpZiAoaVtvXSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIGlmICgwID09PSBpW29dLmxlbmd0aClcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgaVtvXSA9IFt0W29dXS5jb25jYXQoaVtvXSk7XG4gICAgICB9XG4gICAgICByW29dID0gdFtvXSwgcltvXSBpbnN0YW5jZW9mIEFycmF5ID09ICExICYmIChyW29dICo9IDEpLCB1W29dID0gcltvXSB8fCAwO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfSwgdGhpcy5zdG9wID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGYgPyAoVFdFRU4ucmVtb3ZlKHRoaXMpLCBmID0gITEsIG51bGwgIT09IE0gJiYgTS5jYWxsKHQpLCB0aGlzLnN0b3BDaGFpbmVkVHdlZW5zKCksIHRoaXMpIDogdGhpcztcbiAgfSwgdGhpcy5zdG9wQ2hhaW5lZFR3ZWVucyA9IGZ1bmN0aW9uKCkge1xuICAgIGZvciAodmFyIG4gPSAwLFxuICAgICAgICB0ID0gRS5sZW5ndGg7IHQgPiBuOyBuKyspXG4gICAgICBFW25dLnN0b3AoKTtcbiAgfSwgdGhpcy5kZWxheSA9IGZ1bmN0aW9uKG4pIHtcbiAgICByZXR1cm4gcyA9IG4sIHRoaXM7XG4gIH0sIHRoaXMucmVwZWF0ID0gZnVuY3Rpb24obikge1xuICAgIHJldHVybiBlID0gbiwgdGhpcztcbiAgfSwgdGhpcy55b3lvID0gZnVuY3Rpb24obikge1xuICAgIHJldHVybiBhID0gbiwgdGhpcztcbiAgfSwgdGhpcy5lYXNpbmcgPSBmdW5jdGlvbihuKSB7XG4gICAgcmV0dXJuIGwgPSBuLCB0aGlzO1xuICB9LCB0aGlzLmludGVycG9sYXRpb24gPSBmdW5jdGlvbihuKSB7XG4gICAgcmV0dXJuIHAgPSBuLCB0aGlzO1xuICB9LCB0aGlzLmNoYWluID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIEUgPSBhcmd1bWVudHMsIHRoaXM7XG4gIH0sIHRoaXMub25TdGFydCA9IGZ1bmN0aW9uKG4pIHtcbiAgICByZXR1cm4gZCA9IG4sIHRoaXM7XG4gIH0sIHRoaXMub25VcGRhdGUgPSBmdW5jdGlvbihuKSB7XG4gICAgcmV0dXJuIEkgPSBuLCB0aGlzO1xuICB9LCB0aGlzLm9uQ29tcGxldGUgPSBmdW5jdGlvbihuKSB7XG4gICAgcmV0dXJuIHcgPSBuLCB0aGlzO1xuICB9LCB0aGlzLm9uU3RvcCA9IGZ1bmN0aW9uKG4pIHtcbiAgICByZXR1cm4gTSA9IG4sIHRoaXM7XG4gIH0sIHRoaXMudXBkYXRlID0gZnVuY3Rpb24obikge1xuICAgIHZhciBmO1xuICAgIGlmIChoID4gbilcbiAgICAgIHJldHVybiAhMDtcbiAgICB2ID09PSAhMSAmJiAobnVsbCAhPT0gZCAmJiBkLmNhbGwodCksIHYgPSAhMCk7XG4gICAgdmFyIE0gPSAobiAtIGgpIC8gbztcbiAgICBNID0gTSA+IDEgPyAxIDogTTtcbiAgICB2YXIgTyA9IGwoTSk7XG4gICAgZm9yIChmIGluIGkpIHtcbiAgICAgIHZhciBtID0gcltmXSB8fCAwLFxuICAgICAgICAgIE4gPSBpW2ZdO1xuICAgICAgTiBpbnN0YW5jZW9mIEFycmF5ID8gdFtmXSA9IHAoTiwgTykgOiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgTiAmJiAoTiA9IG0gKyBwYXJzZUZsb2F0KE4sIDEwKSksIFwibnVtYmVyXCIgPT0gdHlwZW9mIE4gJiYgKHRbZl0gPSBtICsgKE4gLSBtKSAqIE8pKTtcbiAgICB9XG4gICAgaWYgKG51bGwgIT09IEkgJiYgSS5jYWxsKHQsIE8pLCAxID09IE0pIHtcbiAgICAgIGlmIChlID4gMCkge1xuICAgICAgICBpc0Zpbml0ZShlKSAmJiBlLS07XG4gICAgICAgIGZvciAoZiBpbiB1KSB7XG4gICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIGlbZl0gJiYgKHVbZl0gPSB1W2ZdICsgcGFyc2VGbG9hdChpW2ZdLCAxMCkpLCBhKSB7XG4gICAgICAgICAgICB2YXIgVCA9IHVbZl07XG4gICAgICAgICAgICB1W2ZdID0gaVtmXSwgaVtmXSA9IFQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJbZl0gPSB1W2ZdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhICYmIChjID0gIWMpLCBoID0gbiArIHMsICEwO1xuICAgICAgfVxuICAgICAgbnVsbCAhPT0gdyAmJiB3LmNhbGwodCk7XG4gICAgICBmb3IgKHZhciBnID0gMCxcbiAgICAgICAgICBXID0gRS5sZW5ndGg7IFcgPiBnOyBnKyspXG4gICAgICAgIEVbZ10uc3RhcnQobik7XG4gICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIHJldHVybiAhMDtcbiAgfTtcbn0sIFRXRUVOLkVhc2luZyA9IHtcbiAgTGluZWFyOiB7Tm9uZTogZnVuY3Rpb24obikge1xuICAgICAgcmV0dXJuIG47XG4gICAgfX0sXG4gIFF1YWRyYXRpYzoge1xuICAgIEluOiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gbiAqIG47XG4gICAgfSxcbiAgICBPdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHJldHVybiBuICogKDIgLSBuKTtcbiAgICB9LFxuICAgIEluT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gKG4gKj0gMikgPCAxID8gLjUgKiBuICogbiA6IC0uNSAqICgtLW4gKiAobiAtIDIpIC0gMSk7XG4gICAgfVxuICB9LFxuICBDdWJpYzoge1xuICAgIEluOiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gbiAqIG4gKiBuO1xuICAgIH0sXG4gICAgT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gLS1uICogbiAqIG4gKyAxO1xuICAgIH0sXG4gICAgSW5PdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHJldHVybiAobiAqPSAyKSA8IDEgPyAuNSAqIG4gKiBuICogbiA6IC41ICogKChuIC09IDIpICogbiAqIG4gKyAyKTtcbiAgICB9XG4gIH0sXG4gIFF1YXJ0aWM6IHtcbiAgICBJbjogZnVuY3Rpb24obikge1xuICAgICAgcmV0dXJuIG4gKiBuICogbiAqIG47XG4gICAgfSxcbiAgICBPdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHJldHVybiAxIC0gLS1uICogbiAqIG4gKiBuO1xuICAgIH0sXG4gICAgSW5PdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHJldHVybiAobiAqPSAyKSA8IDEgPyAuNSAqIG4gKiBuICogbiAqIG4gOiAtLjUgKiAoKG4gLT0gMikgKiBuICogbiAqIG4gLSAyKTtcbiAgICB9XG4gIH0sXG4gIFF1aW50aWM6IHtcbiAgICBJbjogZnVuY3Rpb24obikge1xuICAgICAgcmV0dXJuIG4gKiBuICogbiAqIG4gKiBuO1xuICAgIH0sXG4gICAgT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gLS1uICogbiAqIG4gKiBuICogbiArIDE7XG4gICAgfSxcbiAgICBJbk91dDogZnVuY3Rpb24obikge1xuICAgICAgcmV0dXJuIChuICo9IDIpIDwgMSA/IC41ICogbiAqIG4gKiBuICogbiAqIG4gOiAuNSAqICgobiAtPSAyKSAqIG4gKiBuICogbiAqIG4gKyAyKTtcbiAgICB9XG4gIH0sXG4gIFNpbnVzb2lkYWw6IHtcbiAgICBJbjogZnVuY3Rpb24obikge1xuICAgICAgcmV0dXJuIDEgLSBNYXRoLmNvcyhuICogTWF0aC5QSSAvIDIpO1xuICAgIH0sXG4gICAgT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gTWF0aC5zaW4obiAqIE1hdGguUEkgLyAyKTtcbiAgICB9LFxuICAgIEluT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gLjUgKiAoMSAtIE1hdGguY29zKE1hdGguUEkgKiBuKSk7XG4gICAgfVxuICB9LFxuICBFeHBvbmVudGlhbDoge1xuICAgIEluOiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gMCA9PT0gbiA/IDAgOiBNYXRoLnBvdygxMDI0LCBuIC0gMSk7XG4gICAgfSxcbiAgICBPdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHJldHVybiAxID09PSBuID8gMSA6IDEgLSBNYXRoLnBvdygyLCAtMTAgKiBuKTtcbiAgICB9LFxuICAgIEluT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gMCA9PT0gbiA/IDAgOiAxID09PSBuID8gMSA6IChuICo9IDIpIDwgMSA/IC41ICogTWF0aC5wb3coMTAyNCwgbiAtIDEpIDogLjUgKiAoLU1hdGgucG93KDIsIC0xMCAqIChuIC0gMSkpICsgMik7XG4gICAgfVxuICB9LFxuICBDaXJjdWxhcjoge1xuICAgIEluOiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gMSAtIE1hdGguc3FydCgxIC0gbiAqIG4pO1xuICAgIH0sXG4gICAgT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gTWF0aC5zcXJ0KDEgLSAtLW4gKiBuKTtcbiAgICB9LFxuICAgIEluT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICByZXR1cm4gKG4gKj0gMikgPCAxID8gLS41ICogKE1hdGguc3FydCgxIC0gbiAqIG4pIC0gMSkgOiAuNSAqIChNYXRoLnNxcnQoMSAtIChuIC09IDIpICogbikgKyAxKTtcbiAgICB9XG4gIH0sXG4gIEVsYXN0aWM6IHtcbiAgICBJbjogZnVuY3Rpb24obikge1xuICAgICAgdmFyIHQsXG4gICAgICAgICAgciA9IC4xLFxuICAgICAgICAgIGkgPSAuNDtcbiAgICAgIHJldHVybiAwID09PSBuID8gMCA6IDEgPT09IG4gPyAxIDogKCFyIHx8IDEgPiByID8gKHIgPSAxLCB0ID0gaSAvIDQpIDogdCA9IGkgKiBNYXRoLmFzaW4oMSAvIHIpIC8gKDIgKiBNYXRoLlBJKSwgLShyICogTWF0aC5wb3coMiwgMTAgKiAobiAtPSAxKSkgKiBNYXRoLnNpbigyICogKG4gLSB0KSAqIE1hdGguUEkgLyBpKSkpO1xuICAgIH0sXG4gICAgT3V0OiBmdW5jdGlvbihuKSB7XG4gICAgICB2YXIgdCxcbiAgICAgICAgICByID0gLjEsXG4gICAgICAgICAgaSA9IC40O1xuICAgICAgcmV0dXJuIDAgPT09IG4gPyAwIDogMSA9PT0gbiA/IDEgOiAoIXIgfHwgMSA+IHIgPyAociA9IDEsIHQgPSBpIC8gNCkgOiB0ID0gaSAqIE1hdGguYXNpbigxIC8gcikgLyAoMiAqIE1hdGguUEkpLCByICogTWF0aC5wb3coMiwgLTEwICogbikgKiBNYXRoLnNpbigyICogKG4gLSB0KSAqIE1hdGguUEkgLyBpKSArIDEpO1xuICAgIH0sXG4gICAgSW5PdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHZhciB0LFxuICAgICAgICAgIHIgPSAuMSxcbiAgICAgICAgICBpID0gLjQ7XG4gICAgICByZXR1cm4gMCA9PT0gbiA/IDAgOiAxID09PSBuID8gMSA6ICghciB8fCAxID4gciA/IChyID0gMSwgdCA9IGkgLyA0KSA6IHQgPSBpICogTWF0aC5hc2luKDEgLyByKSAvICgyICogTWF0aC5QSSksIChuICo9IDIpIDwgMSA/IC0uNSAqIHIgKiBNYXRoLnBvdygyLCAxMCAqIChuIC09IDEpKSAqIE1hdGguc2luKDIgKiAobiAtIHQpICogTWF0aC5QSSAvIGkpIDogciAqIE1hdGgucG93KDIsIC0xMCAqIChuIC09IDEpKSAqIE1hdGguc2luKDIgKiAobiAtIHQpICogTWF0aC5QSSAvIGkpICogLjUgKyAxKTtcbiAgICB9XG4gIH0sXG4gIEJhY2s6IHtcbiAgICBJbjogZnVuY3Rpb24obikge1xuICAgICAgdmFyIHQgPSAxLjcwMTU4O1xuICAgICAgcmV0dXJuIG4gKiBuICogKCh0ICsgMSkgKiBuIC0gdCk7XG4gICAgfSxcbiAgICBPdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHZhciB0ID0gMS43MDE1ODtcbiAgICAgIHJldHVybiAtLW4gKiBuICogKCh0ICsgMSkgKiBuICsgdCkgKyAxO1xuICAgIH0sXG4gICAgSW5PdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHZhciB0ID0gMi41OTQ5MDk1O1xuICAgICAgcmV0dXJuIChuICo9IDIpIDwgMSA/IC41ICogbiAqIG4gKiAoKHQgKyAxKSAqIG4gLSB0KSA6IC41ICogKChuIC09IDIpICogbiAqICgodCArIDEpICogbiArIHQpICsgMik7XG4gICAgfVxuICB9LFxuICBCb3VuY2U6IHtcbiAgICBJbjogZnVuY3Rpb24obikge1xuICAgICAgcmV0dXJuIDEgLSBUV0VFTi5FYXNpbmcuQm91bmNlLk91dCgxIC0gbik7XG4gICAgfSxcbiAgICBPdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHJldHVybiAxIC8gMi43NSA+IG4gPyA3LjU2MjUgKiBuICogbiA6IDIgLyAyLjc1ID4gbiA/IDcuNTYyNSAqIChuIC09IDEuNSAvIDIuNzUpICogbiArIC43NSA6IDIuNSAvIDIuNzUgPiBuID8gNy41NjI1ICogKG4gLT0gMi4yNSAvIDIuNzUpICogbiArIC45Mzc1IDogNy41NjI1ICogKG4gLT0gMi42MjUgLyAyLjc1KSAqIG4gKyAuOTg0Mzc1O1xuICAgIH0sXG4gICAgSW5PdXQ6IGZ1bmN0aW9uKG4pIHtcbiAgICAgIHJldHVybiAuNSA+IG4gPyAuNSAqIFRXRUVOLkVhc2luZy5Cb3VuY2UuSW4oMiAqIG4pIDogLjUgKiBUV0VFTi5FYXNpbmcuQm91bmNlLk91dCgyICogbiAtIDEpICsgLjU7XG4gICAgfVxuICB9XG59LCBUV0VFTi5JbnRlcnBvbGF0aW9uID0ge1xuICBMaW5lYXI6IGZ1bmN0aW9uKG4sIHQpIHtcbiAgICB2YXIgciA9IG4ubGVuZ3RoIC0gMSxcbiAgICAgICAgaSA9IHIgKiB0LFxuICAgICAgICB1ID0gTWF0aC5mbG9vcihpKSxcbiAgICAgICAgbyA9IFRXRUVOLkludGVycG9sYXRpb24uVXRpbHMuTGluZWFyO1xuICAgIHJldHVybiAwID4gdCA/IG8oblswXSwgblsxXSwgaSkgOiB0ID4gMSA/IG8obltyXSwgbltyIC0gMV0sIHIgLSBpKSA6IG8oblt1XSwgblt1ICsgMSA+IHIgPyByIDogdSArIDFdLCBpIC0gdSk7XG4gIH0sXG4gIEJlemllcjogZnVuY3Rpb24obiwgdCkge1xuICAgIHZhciByLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgdSA9IG4ubGVuZ3RoIC0gMSxcbiAgICAgICAgbyA9IE1hdGgucG93LFxuICAgICAgICBlID0gVFdFRU4uSW50ZXJwb2xhdGlvbi5VdGlscy5CZXJuc3RlaW47XG4gICAgZm9yIChyID0gMDsgdSA+PSByOyByKyspXG4gICAgICBpICs9IG8oMSAtIHQsIHUgLSByKSAqIG8odCwgcikgKiBuW3JdICogZSh1LCByKTtcbiAgICByZXR1cm4gaTtcbiAgfSxcbiAgQ2F0bXVsbFJvbTogZnVuY3Rpb24obiwgdCkge1xuICAgIHZhciByID0gbi5sZW5ndGggLSAxLFxuICAgICAgICBpID0gciAqIHQsXG4gICAgICAgIHUgPSBNYXRoLmZsb29yKGkpLFxuICAgICAgICBvID0gVFdFRU4uSW50ZXJwb2xhdGlvbi5VdGlscy5DYXRtdWxsUm9tO1xuICAgIHJldHVybiBuWzBdID09PSBuW3JdID8gKDAgPiB0ICYmICh1ID0gTWF0aC5mbG9vcihpID0gciAqICgxICsgdCkpKSwgbyhuWyh1IC0gMSArIHIpICUgcl0sIG5bdV0sIG5bKHUgKyAxKSAlIHJdLCBuWyh1ICsgMikgJSByXSwgaSAtIHUpKSA6IDAgPiB0ID8gblswXSAtIChvKG5bMF0sIG5bMF0sIG5bMV0sIG5bMV0sIC1pKSAtIG5bMF0pIDogdCA+IDEgPyBuW3JdIC0gKG8obltyXSwgbltyXSwgbltyIC0gMV0sIG5bciAtIDFdLCBpIC0gcikgLSBuW3JdKSA6IG8oblt1ID8gdSAtIDEgOiAwXSwgblt1XSwgblt1ICsgMSA+IHIgPyByIDogdSArIDFdLCBuW3UgKyAyID4gciA/IHIgOiB1ICsgMl0sIGkgLSB1KTtcbiAgfSxcbiAgVXRpbHM6IHtcbiAgICBMaW5lYXI6IGZ1bmN0aW9uKG4sIHQsIHIpIHtcbiAgICAgIHJldHVybiAodCAtIG4pICogciArIG47XG4gICAgfSxcbiAgICBCZXJuc3RlaW46IGZ1bmN0aW9uKG4sIHQpIHtcbiAgICAgIHZhciByID0gVFdFRU4uSW50ZXJwb2xhdGlvbi5VdGlscy5GYWN0b3JpYWw7XG4gICAgICByZXR1cm4gcihuKSAvIHIodCkgLyByKG4gLSB0KTtcbiAgICB9LFxuICAgIEZhY3RvcmlhbDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbiA9IFsxXTtcbiAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHZhciByLFxuICAgICAgICAgICAgaSA9IDE7XG4gICAgICAgIGlmIChuW3RdKVxuICAgICAgICAgIHJldHVybiBuW3RdO1xuICAgICAgICBmb3IgKHIgPSB0OyByID4gMTsgci0tKVxuICAgICAgICAgIGkgKj0gcjtcbiAgICAgICAgcmV0dXJuIG5bdF0gPSBpO1xuICAgICAgfTtcbiAgICB9KCksXG4gICAgQ2F0bXVsbFJvbTogZnVuY3Rpb24obiwgdCwgciwgaSwgdSkge1xuICAgICAgdmFyIG8gPSAuNSAqIChyIC0gbiksXG4gICAgICAgICAgZSA9IC41ICogKGkgLSB0KSxcbiAgICAgICAgICBhID0gdSAqIHUsXG4gICAgICAgICAgZiA9IHUgKiBhO1xuICAgICAgcmV0dXJuICgyICogdCAtIDIgKiByICsgbyArIGUpICogZiArICgtMyAqIHQgKyAzICogciAtIDIgKiBvIC0gZSkgKiBhICsgbyAqIHUgKyB0O1xuICAgIH1cbiAgfVxufSwgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgbW9kdWxlICYmIG1vZHVsZS5leHBvcnRzICYmIChtb2R1bGUuZXhwb3J0cyA9IFRXRUVOKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9ib3dlcl9jb21wb25lbnRzL3R3ZWVuanMvYnVpbGQvdHdlZW4ubWluLmpzXG4gKiogbW9kdWxlIGlkID0gNDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIjtcbihmdW5jdGlvbihnbG9iYWwpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG4gIGZ1bmN0aW9uIGluaXQoS2VmaXIsICQpIHtcbiAgICAkLmZuLmFzS2VmaXJTdHJlYW0gPSBmdW5jdGlvbihldmVudE5hbWUsIHNlbGVjdG9yLCB0cmFuc2Zvcm1lcikge1xuICAgICAgdmFyICRlbCA9IHRoaXM7XG4gICAgICBpZiAodHJhbnNmb3JtZXIgPT0gbnVsbCAmJiBzZWxlY3RvciAhPSBudWxsICYmICdzdHJpbmcnICE9PSB0eXBlb2Ygc2VsZWN0b3IpIHtcbiAgICAgICAgdHJhbnNmb3JtZXIgPSBzZWxlY3RvcjtcbiAgICAgICAgc2VsZWN0b3IgPSBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIEtlZmlyLmZyb21TdWJVbnN1YihmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgICRlbC5vbihldmVudE5hbWUsIHNlbGVjdG9yLCBoYW5kbGVyKTtcbiAgICAgIH0sIGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgICAgJGVsLm9mZihldmVudE5hbWUsIHNlbGVjdG9yLCBoYW5kbGVyKTtcbiAgICAgIH0sIHRyYW5zZm9ybWVyKS5zZXROYW1lKCdhc0tlZmlyU3RyZWFtJyk7XG4gICAgfTtcbiAgICAkLmZuLmFzS2VmaXJQcm9wZXJ0eSA9IGZ1bmN0aW9uKGV2ZW50TmFtZSwgc2VsZWN0b3IsIGdldHRlcikge1xuICAgICAgaWYgKGdldHRlciA9PSBudWxsKSB7XG4gICAgICAgIGdldHRlciA9IHNlbGVjdG9yO1xuICAgICAgICBzZWxlY3RvciA9IG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5hc0tlZmlyU3RyZWFtKGV2ZW50TmFtZSwgc2VsZWN0b3IsIGdldHRlcikudG9Qcm9wZXJ0eShnZXR0ZXIoKSkuc2V0TmFtZSgnYXNLZWZpclByb3BlcnR5Jyk7XG4gICAgfTtcbiAgfVxuICB2YXIgZXhwb3J0cyA9IHtpbml0OiBpbml0fTtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbXSwgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZXhwb3J0cztcbiAgICB9KTtcbiAgICBnbG9iYWwuS2VmaXJKUXVlcnkgPSBleHBvcnRzO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHM7XG4gIH0gZWxzZSB7XG4gICAgZ2xvYmFsLktlZmlySlF1ZXJ5ID0gZXhwb3J0cztcbiAgfVxufSh0aGlzKSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vYm93ZXJfY29tcG9uZW50cy9rZWZpci1qcXVlcnkva2VmaXItanF1ZXJ5LmpzXG4gKiogbW9kdWxlIGlkID0gNDRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImRlZmluZShbXSwgZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyIF9uZXh0SWQgPSAwO1xuICByZXR1cm4gZnVuY3Rpb24gdW5pcXVlSWQocHJlZml4KSB7XG4gICAgcmV0dXJuICgocHJlZml4IHx8IFwidW5pcXVlLWlkXCIpICsgXCItXCIgKyBfbmV4dElkKyspO1xuICB9O1xufSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3V0aWwvdW5pcXVlLWlkLmpzXG4gKiogbW9kdWxlIGlkID0gNDVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gIGlmICghbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xuICAgIG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xuICAgIG1vZHVsZS5wYXRocyA9IFtdO1xuICAgIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuICAgIG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuICB9XG4gIHJldHVybiBtb2R1bGU7XG59O1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAod2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanNcbiAqKiBtb2R1bGUgaWQgPSA0NlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JylcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcImpzLWdyYXBoXCIpKTtcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuICAgIGRlZmluZShbXCJqcy1ncmFwaFwiXSwgZmFjdG9yeSk7XG4gIGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JylcbiAgICBleHBvcnRzW1wiRGVsdGFNb2RlbFwiXSA9IGZhY3RvcnkocmVxdWlyZShcImpzLWdyYXBoXCIpKTtcbiAgZWxzZVxuICAgIHJvb3RbXCJEZWx0YU1vZGVsXCJdID0gZmFjdG9yeShyb290W1wiSnNHcmFwaFwiXSk7XG59KSh0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXykge1xuICByZXR1cm4gKGZ1bmN0aW9uKG1vZHVsZXMpIHtcbiAgICB2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuICAgIGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbiAgICAgIGlmIChpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiAgICAgICAgcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gICAgICB2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gICAgICAgIGV4cG9ydHM6IHt9LFxuICAgICAgICBpZDogbW9kdWxlSWQsXG4gICAgICAgIGxvYWRlZDogZmFsc2VcbiAgICAgIH07XG4gICAgICBtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbiAgICAgIG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuICAgICAgcmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuICAgIH1cbiAgICBfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuICAgIF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4gICAgX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbiAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbiAgfSkoW2Z1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgIHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLFxuICAgICAgICBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXztcbiAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbX193ZWJwYWNrX3JlcXVpcmVfXygxKSwgX193ZWJwYWNrX3JlcXVpcmVfXygyKV0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oSnNHcmFwaCwgVSkge1xuICAgICAgJ3VzZSBzdHJpY3QnO1xuICAgICAgdmFyIGtlZXBGaXJzdCA9IChmdW5jdGlvbigpIHt9KTtcbiAgICAgIHZhciBrZWVwU2Vjb25kID0gKGZ1bmN0aW9uKGQxLCBwLCBkMikge1xuICAgICAgICBkMS5vcGVyYXRpb25zW3BdID0gZDI7XG4gICAgICB9KTtcbiAgICAgIHZhciBhcHBseVNlY29uZFRvRmlyc3RWYWx1ZSA9IChmdW5jdGlvbihkMSwgcCwgZDIpIHtcbiAgICAgICAgZDIuYXBwbHlUbyhkMS5vcGVyYXRpb25zW3BdLCAndmFsdWUnKTtcbiAgICAgIH0pO1xuICAgICAgZnVuY3Rpb24gYXNzZXJ0RnVuY3Rpb24odmFsLCBvcFR5cGUpIHtcbiAgICAgICAgVS5hc3NlcnQodHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJywgKFwiVGhlIG9wZXJhdGlvbiAnXCIgKyBvcFR5cGUgKyBcIicgZXhwZWN0cyB0aGUgcHJvcGVydHkgaXQgYWN0cyBvbiB0byBiZSBhIGZ1bmN0aW9uLlwiKSk7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBhc3NlcnREZWZpbmVkKHZhbCwgb3BUeXBlKSB7XG4gICAgICAgIFUuYXNzZXJ0KFUuaXNEZWZpbmVkKHZhbCksIChcIlRoZSBvcGVyYXRpb24gJ1wiICsgb3BUeXBlICsgXCInIGV4cGVjdHMgdGhlIHByb3BlcnR5IHRvIGJlIGRlZmluZWQuXCIpKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGFzc2VydFVuZGVmaW5lZCh2YWwsIG9wVHlwZSkge1xuICAgICAgICBVLmFzc2VydChVLmlzVW5kZWZpbmVkKHZhbCksIChcIlRoZSBvcGVyYXRpb24gJ1wiICsgb3BUeXBlICsgXCInIGV4cGVjdHMgdGhlIHByb3BlcnR5IHRvIGJlIHVuZGVmaW5lZC5cIikpO1xuICAgICAgfVxuICAgICAgdmFyIERlbHRhTW9kZWwgPSBVLm5ld0NsYXNzKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJF9fMCA9IHRoaXM7XG4gICAgICAgIHZhciBfb3BUeXBlcyA9IHt9O1xuICAgICAgICB2YXIgX2NvbXBvc2VGbnMgPSBbXTtcbiAgICAgICAgVS5leHRlbmQodGhpcywge1xuICAgICAgICAgIF9hZGRPcGVyYXRpb25UeXBlOiBmdW5jdGlvbigkX180KSB7XG4gICAgICAgICAgICB2YXIgJF9fNSA9ICRfXzQsXG4gICAgICAgICAgICAgICAgbmFtZSA9ICRfXzUubmFtZSxcbiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvciA9ICRfXzUuY29uc3RydWN0b3IsXG4gICAgICAgICAgICAgICAgYXBwbHlUbyA9ICRfXzUuYXBwbHlUbyxcbiAgICAgICAgICAgICAgICBwcm90b3R5cGUgPSAkX181LnByb3RvdHlwZSxcbiAgICAgICAgICAgICAgICBtZXRob2QgPSAkX181Lm1ldGhvZDtcbiAgICAgICAgICAgIHZhciBvYmplY3RXaXRoTWV0aG9kID0ge307XG4gICAgICAgICAgICBfb3BUeXBlc1tuYW1lXSA9IHtcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgRGVsdGE6IGNvbnN0cnVjdG9yLFxuICAgICAgICAgICAgICBtZXRob2Q6IG9iamVjdFdpdGhNZXRob2RbbmFtZV1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBVLmV4dGVuZChfb3BUeXBlc1tuYW1lXS5EZWx0YS5wcm90b3R5cGUsIHByb3RvdHlwZSwge1xuICAgICAgICAgICAgICBjb25zdHJ1Y3RvcjogY29uc3RydWN0b3IsXG4gICAgICAgICAgICAgIHR5cGU6IG5hbWUsXG4gICAgICAgICAgICAgIGFwcGx5VG86IGFwcGx5VG9cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX29wVHlwZXNbJ21vZGlmeSddLkRlbHRhLnByb3RvdHlwZVtuYW1lXSA9IFUuaXNEZWZpbmVkKG1ldGhvZCkgPyBtZXRob2QgOiBmdW5jdGlvbihwcm9wZXJ0eSkge1xuICAgICAgICAgICAgICBmb3IgKHZhciB2YWx1ZXMgPSBbXSxcbiAgICAgICAgICAgICAgICAgICRfXzEgPSAxOyAkX18xIDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMSsrKVxuICAgICAgICAgICAgICAgIHZhbHVlc1skX18xIC0gMV0gPSBhcmd1bWVudHNbJF9fMV07XG4gICAgICAgICAgICAgIHRoaXMuX2FkZE9wZXJhdGlvbihfb3BUeXBlc1tuYW1lXSwgcHJvcGVydHksIHZhbHVlcyk7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIF9hZGRPcGVyYXRpb25BbGlhczogZnVuY3Rpb24oJF9fNCkge1xuICAgICAgICAgICAgdmFyICRfXzUgPSAkX180LFxuICAgICAgICAgICAgICAgIG5hbWUgPSAkX181Lm5hbWUsXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gJF9fNS50YXJnZXQsXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtID0gJF9fNS50cmFuc2Zvcm07XG4gICAgICAgICAgICB2YXIgb2JqZWN0V2l0aE1ldGhvZCA9IHt9O1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iamVjdFdpdGhNZXRob2QsIG5hbWUsIHt2YWx1ZTogZnVuY3Rpb24ocHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB2YWx1ZXMgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgJF9fMSA9IDE7ICRfXzEgPCBhcmd1bWVudHMubGVuZ3RoOyAkX18xKyspXG4gICAgICAgICAgICAgICAgICB2YWx1ZXNbJF9fMSAtIDFdID0gYXJndW1lbnRzWyRfXzFdO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZE9wZXJhdGlvbihfb3BUeXBlc1t0YXJnZXRdLCBwcm9wZXJ0eSwgdHJhbnNmb3JtKHZhbHVlcykpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICB9fSk7XG4gICAgICAgICAgICBfb3BUeXBlc1tuYW1lXSA9IHtcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgbWV0aG9kOiBvYmplY3RXaXRoTWV0aG9kW25hbWVdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgX29wVHlwZXNbJ21vZGlmeSddLkRlbHRhLnByb3RvdHlwZVtuYW1lXSA9IF9vcFR5cGVzW25hbWVdLm1ldGhvZDtcbiAgICAgICAgICB9LFxuICAgICAgICAgIF9hZGRDb21wb3NpdGlvblJ1bGU6IGZ1bmN0aW9uKG9wMVR5cGUsIG9wMlR5cGUsIGNvbXBvc2VGbikge1xuICAgICAgICAgICAgX2NvbXBvc2VGbnMucHVzaCh7XG4gICAgICAgICAgICAgIG9wMVR5cGU6IG9wMVR5cGUsXG4gICAgICAgICAgICAgIG9wMlR5cGU6IG9wMlR5cGUsXG4gICAgICAgICAgICAgIGNvbXBvc2VGbjogY29tcG9zZUZuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIF9uZXdEZWx0YTogZnVuY3Rpb24odHlwZSkge1xuICAgICAgICAgICAgZm9yICh2YXIgdmFsdWVzID0gW10sXG4gICAgICAgICAgICAgICAgJF9fMSA9IDE7ICRfXzEgPCBhcmd1bWVudHMubGVuZ3RoOyAkX18xKyspXG4gICAgICAgICAgICAgIHZhbHVlc1skX18xIC0gMV0gPSBhcmd1bWVudHNbJF9fMV07XG4gICAgICAgICAgICByZXR1cm4gVS5hcHBseUNvbnN0cnVjdG9yKF9vcFR5cGVzW3R5cGVdLkRlbHRhLCB2YWx1ZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB0aGlzRE0gPSB0aGlzO1xuICAgICAgICB0aGlzLl9hZGRPcGVyYXRpb25UeXBlKHtcbiAgICAgICAgICBuYW1lOiAnbW9kaWZ5JyxcbiAgICAgICAgICBjb25zdHJ1Y3RvcjogZnVuY3Rpb24gTW9kaWZ5KCkge1xuICAgICAgICAgICAgdmFyIGRlbHRhRGVzY3JpcHRpb24gPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgICAgICAgICB2YXIgb3BlcmF0aW9ucyA9IGFyZ3VtZW50c1sxXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgICAgICAgICAgIHZhciAkX18wID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMub3BlcmF0aW9ucyA9IG9wZXJhdGlvbnM7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhkZWx0YURlc2NyaXB0aW9uKS5mb3JFYWNoKChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgICAgdmFyIG1hdGNoID0ga2V5Lm1hdGNoKC9eKFxcdyspXFxzKyhbXFx3XFwuXSspJC8pO1xuICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3BlcmF0aW9uID0gbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gbWF0Y2hbMl07XG4gICAgICAgICAgICAgICAgVS5hc3NlcnQob3BlcmF0aW9uIGluIF9vcFR5cGVzLCAoXCJJIGRvbid0IGtub3cgdGhlICdcIiArIG9wZXJhdGlvbiArIFwiJyBvcGVyYXRpb24uXCIpKTtcbiAgICAgICAgICAgICAgICAkX18wW29wZXJhdGlvbl0ocHJvcGVydHksIGRlbHRhRGVzY3JpcHRpb25ba2V5XSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFwcGx5VG86IGZ1bmN0aW9uKG9iaiwgcHJvcGVydHkpIHtcbiAgICAgICAgICAgIHZhciAkX18wID0gdGhpcztcbiAgICAgICAgICAgIGlmIChVLmlzRGVmaW5lZChwcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgICAgVS5hc3NlcnQoVS5pc0RlZmluZWQob2JqW3Byb3BlcnR5XSksIFwiVGhlICdtb2RpZnknIG9wZXJhdGlvbiBleHBlY3RzIHRoZSBwcm9wZXJ0eSB0byBiZSBhbHJlYWR5IGRlZmluZWQuXCIpO1xuICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLm9wZXJhdGlvbnMpLmZvckVhY2goKGZ1bmN0aW9uKHN1YlByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgJF9fMC5vcGVyYXRpb25zW3N1YlByb3BlcnR5XS5hcHBseVRvKG9ialtwcm9wZXJ0eV0sIHN1YlByb3BlcnR5KTtcbiAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgVS5hc3NlcnQoVS5pc0RlZmluZWQob2JqKSwgXCJUaGUgJ21vZGlmeScgb3BlcmF0aW9uIGV4cGVjdHMgdGhlIHByb3BlcnR5IHRvIGJlIGFscmVhZHkgZGVmaW5lZC5cIik7XG4gICAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMub3BlcmF0aW9ucykuZm9yRWFjaCgoZnVuY3Rpb24oc3ViUHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAkX18wLm9wZXJhdGlvbnNbc3ViUHJvcGVydHldLmFwcGx5VG8ob2JqLCBzdWJQcm9wZXJ0eSk7XG4gICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHByb3RvdHlwZToge1xuICAgICAgICAgICAgc2VsZWN0aXZlbHlBcHBseVRvOiBmdW5jdGlvbihvYmosIHN1YlByb3BlcnR5KSB7XG4gICAgICAgICAgICAgIFUuYXNzZXJ0KFUuaXNEZWZpbmVkKG9iaiksIFwiVGhlICdtb2RpZnknIG9wZXJhdGlvbiBleHBlY3RzIHRoZSBwcm9wZXJ0eSB0byBiZSBhbHJlYWR5IGRlZmluZWQuXCIpO1xuICAgICAgICAgICAgICBpZiAoVS5pc0RlZmluZWQodGhpcy5vcGVyYXRpb25zW3N1YlByb3BlcnR5XSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZXJhdGlvbnNbc3ViUHJvcGVydHldLmFwcGx5VG8ob2JqLCBzdWJQcm9wZXJ0eSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21wb3NlOiBmdW5jdGlvbihwcm9wZXJ0eSwgb3AyKSB7XG4gICAgICAgICAgICAgIHZhciAkX18wID0gdGhpcztcbiAgICAgICAgICAgICAgaWYgKFUuaXNVbmRlZmluZWQob3AyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBmb3VuZENvbXBvc2VGbjtcbiAgICAgICAgICAgICAgX2NvbXBvc2VGbnMuc29tZSgoZnVuY3Rpb24oJF9fNCkge1xuICAgICAgICAgICAgICAgIHZhciAkX181ID0gJF9fNCxcbiAgICAgICAgICAgICAgICAgICAgb3AxVHlwZSA9ICRfXzUub3AxVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgb3AyVHlwZSA9ICRfXzUub3AyVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgY29tcG9zZUZuID0gJF9fNS5jb21wb3NlRm47XG4gICAgICAgICAgICAgICAgaWYgKCRfXzAub3BlcmF0aW9uc1twcm9wZXJ0eV0udHlwZSA9PT0gb3AxVHlwZSAmJiBvcDIudHlwZSA9PT0gb3AyVHlwZSkge1xuICAgICAgICAgICAgICAgICAgZm91bmRDb21wb3NlRm4gPSBjb21wb3NlRm47XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgaWYgKGZvdW5kQ29tcG9zZUZuKSB7XG4gICAgICAgICAgICAgICAgZm91bmRDb21wb3NlRm4odGhpcywgcHJvcGVydHksIG9wMik7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcigoXCJZb3UgY2Fubm90IGZvbGxvdyBhICdcIiArIHRoaXMub3BlcmF0aW9uc1twcm9wZXJ0eV0udHlwZSArIFwiJyBvcGVyYXRpb24gXCIpICsgKFwid2l0aCBhICdcIiArIG9wMi50eXBlICsgXCInIG9wZXJhdGlvbiBvbiB0aGUgc2FtZSBwcm9wZXJ0eS5cIikpO1xuICAgICAgICAgICAgICAgIGVyci5vcDEgPSB0aGlzLm9wZXJhdGlvbnNbcHJvcGVydHldLnR5cGU7XG4gICAgICAgICAgICAgICAgZXJyLm9wMiA9IG9wMi50eXBlO1xuICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9hZGRPcGVyYXRpb246IGZ1bmN0aW9uKG9wVHlwZSwgcHJvcGVydHksIHZhbHVlcykge1xuICAgICAgICAgICAgICB2YXIgZG90SW5kZXggPSBwcm9wZXJ0eS5pbmRleE9mKCcuJyk7XG4gICAgICAgICAgICAgIGlmIChkb3RJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0dWFsUHJvcGVydHkgPSBwcm9wZXJ0eS5zbGljZSgwLCBkb3RJbmRleCk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3RPZlByb3BlcnR5ID0gcHJvcGVydHkuc2xpY2UoZG90SW5kZXggKyAxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3TW9kaWZ5RGVsdGEgPSB0aGlzLl9hZGRPcGVyYXRpb24oX29wVHlwZXNbJ21vZGlmeSddLCBhY3R1YWxQcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld01vZGlmeURlbHRhW29wVHlwZS5uYW1lXS5hcHBseShuZXdNb2RpZnlEZWx0YSwgW3Jlc3RPZlByb3BlcnR5XS5jb25jYXQodmFsdWVzKSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIF9uZXdEZWx0YSA9IHRoaXNETS5fbmV3RGVsdGEuYXBwbHkodGhpc0RNLCBbb3BUeXBlLm5hbWVdLmNvbmNhdCh2YWx1ZXMpKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcGVyYXRpb25zLmhhc093blByb3BlcnR5KHByb3BlcnR5KSAmJiBVLmlzRGVmaW5lZCh0aGlzLm9wZXJhdGlvbnNbcHJvcGVydHldKSkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5jb21wb3NlKHByb3BlcnR5LCBfbmV3RGVsdGEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLm9wZXJhdGlvbnNbcHJvcGVydHldID0gX25ld0RlbHRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vcGVyYXRpb25zW3Byb3BlcnR5XTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWV0aG9kOiBmdW5jdGlvbihwcm9wZXJ0eSwgZGVsdGFEZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FkZE9wZXJhdGlvbihfb3BUeXBlc1snbW9kaWZ5J10sIHByb3BlcnR5LCBbZGVsdGFEZXNjcmlwdGlvbl0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2FkZE9wZXJhdGlvblR5cGUoe1xuICAgICAgICAgIG5hbWU6ICdhZGQnLFxuICAgICAgICAgIGNvbnN0cnVjdG9yOiBmdW5jdGlvbiBBZGQodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFwcGx5VG86IGZ1bmN0aW9uKG9iaiwgcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGFzc2VydFVuZGVmaW5lZChvYmpbcHJvcGVydHldLCAnYWRkJyk7XG4gICAgICAgICAgICBvYmpbcHJvcGVydHldID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hZGRPcGVyYXRpb25UeXBlKHtcbiAgICAgICAgICBuYW1lOiAncmVwbGFjZScsXG4gICAgICAgICAgY29uc3RydWN0b3I6IGZ1bmN0aW9uIFJlcGxhY2UodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFwcGx5VG86IGZ1bmN0aW9uKG9iaiwgcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGFzc2VydERlZmluZWQob2JqW3Byb3BlcnR5XSwgJ3JlcGxhY2UnKTtcbiAgICAgICAgICAgIG9ialtwcm9wZXJ0eV0gPSB0aGlzLnZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2FkZE9wZXJhdGlvblR5cGUoe1xuICAgICAgICAgIG5hbWU6ICdyZXBsYWNlQXJvdW5kJyxcbiAgICAgICAgICBjb25zdHJ1Y3RvcjogZnVuY3Rpb24gUmVwbGFjZUFyb3VuZCh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYXBwbHlUbzogZnVuY3Rpb24ob2JqLCBwcm9wZXJ0eSkge1xuICAgICAgICAgICAgYXNzZXJ0RGVmaW5lZChvYmpbcHJvcGVydHldLCAncmVwbGFjZUFyb3VuZCcpO1xuICAgICAgICAgICAgb2JqW3Byb3BlcnR5XSA9IHRoaXMudmFsdWUob2JqW3Byb3BlcnR5XSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYWRkT3BlcmF0aW9uVHlwZSh7XG4gICAgICAgICAgbmFtZTogJ3JlbW92ZScsXG4gICAgICAgICAgY29uc3RydWN0b3I6IGZ1bmN0aW9uIFJlbW92ZSgpIHt9LFxuICAgICAgICAgIGFwcGx5VG86IGZ1bmN0aW9uKG9iaiwgcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGFzc2VydERlZmluZWQob2JqW3Byb3BlcnR5XSwgJ3JlbW92ZScpO1xuICAgICAgICAgICAgZGVsZXRlIG9ialtwcm9wZXJ0eV07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYWRkT3BlcmF0aW9uVHlwZSh7XG4gICAgICAgICAgbmFtZTogJ2ZvcmJpZCcsXG4gICAgICAgICAgY29uc3RydWN0b3I6IGZ1bmN0aW9uIEZvcmJpZCgpIHt9LFxuICAgICAgICAgIGFwcGx5VG86IGZ1bmN0aW9uKG9iaiwgcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGFzc2VydFVuZGVmaW5lZChvYmpbcHJvcGVydHldLCAnZm9yYmlkJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdhZGQnLCAncmVwbGFjZScsIChmdW5jdGlvbihkMSwgcCwgZDIpIHtcbiAgICAgICAgICBkMS5vcGVyYXRpb25zW3BdID0gRGVsdGFNb2RlbC5fbmV3RGVsdGEoJ2FkZCcsIGQyLnZhbHVlKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ2FkZCcsICdtb2RpZnknLCBhcHBseVNlY29uZFRvRmlyc3RWYWx1ZSk7XG4gICAgICAgIHRoaXMuX2FkZENvbXBvc2l0aW9uUnVsZSgnYWRkJywgJ3JlbW92ZScsIChmdW5jdGlvbihkMSwgcCkge1xuICAgICAgICAgIGQxLm9wZXJhdGlvbnNbcF0gPSBEZWx0YU1vZGVsLl9uZXdEZWx0YSgnZm9yYmlkJyk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdyZXBsYWNlJywgJ3JlcGxhY2UnLCBrZWVwU2Vjb25kKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdyZXBsYWNlJywgJ21vZGlmeScsIGFwcGx5U2Vjb25kVG9GaXJzdFZhbHVlKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdyZXBsYWNlJywgJ3JlbW92ZScsIGtlZXBTZWNvbmQpO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ21vZGlmeScsICdyZXBsYWNlJywga2VlcFNlY29uZCk7XG4gICAgICAgIHRoaXMuX2FkZENvbXBvc2l0aW9uUnVsZSgnbW9kaWZ5JywgJ21vZGlmeScsIChmdW5jdGlvbihkMSwgcCwgZDIpIHtcbiAgICAgICAgICBPYmplY3Qua2V5cyhkMi5vcGVyYXRpb25zKS5mb3JFYWNoKChmdW5jdGlvbihwcm9wKSB7XG4gICAgICAgICAgICBkMS5jb21wb3NlKHByb3AsIGQyLm9wZXJhdGlvbnNbcHJvcF0pO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ21vZGlmeScsICdyZW1vdmUnLCBrZWVwU2Vjb25kKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdyZW1vdmUnLCAnYWRkJywgKGZ1bmN0aW9uKGQxLCBwLCBkMikge1xuICAgICAgICAgIGQxLm9wZXJhdGlvbnNbcF0gPSBEZWx0YU1vZGVsLl9uZXdEZWx0YSgncmVwbGFjZScsIGQyLnZhbHVlKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ3JlbW92ZScsICdmb3JiaWQnLCBrZWVwRmlyc3QpO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ2ZvcmJpZCcsICdhZGQnLCBrZWVwU2Vjb25kKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdmb3JiaWQnLCAnZm9yYmlkJywga2VlcEZpcnN0KTtcbiAgICAgICAgdGhpcy5fYWRkT3BlcmF0aW9uVHlwZSh7XG4gICAgICAgICAgbmFtZTogJ2FsdGVyJyxcbiAgICAgICAgICBjb25zdHJ1Y3RvcjogZnVuY3Rpb24gQWx0ZXIodmFsdWUsIGFsaWFzKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWUgfHwgW107XG4gICAgICAgICAgICB0aGlzLmFsaWFzID0gYWxpYXMgfHwgJ2FsdGVyJztcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFwcGx5VG86IGZ1bmN0aW9uKG9iaiwgcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGFzc2VydEZ1bmN0aW9uKG9ialtwcm9wZXJ0eV0sIHRoaXMuYWxpYXMpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5mb3JFYWNoKChmdW5jdGlvbihzdWJPcCkge1xuICAgICAgICAgICAgICB2YXIgcGFydE9uZSA9IG9ialtwcm9wZXJ0eV07XG4gICAgICAgICAgICAgIHZhciBwYXJ0VHdvID0gc3ViT3AudmFsdWU7XG4gICAgICAgICAgICAgIGlmIChzdWJPcC50eXBlID09PSAncHJlcGVuZCcpIHtcbiAgICAgICAgICAgICAgICBvYmpbcHJvcGVydHldID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBhcmdzID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgJF9fMiA9IDA7ICRfXzIgPCBhcmd1bWVudHMubGVuZ3RoOyAkX18yKyspXG4gICAgICAgICAgICAgICAgICAgIGFyZ3NbJF9fMl0gPSBhcmd1bWVudHNbJF9fMl07XG4gICAgICAgICAgICAgICAgICBwYXJ0VHdvLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgcGFydE9uZS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9ialtwcm9wZXJ0eV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFyZ3MgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAkX18zID0gMDsgJF9fMyA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzMrKylcbiAgICAgICAgICAgICAgICAgICAgYXJnc1skX18zXSA9IGFyZ3VtZW50c1skX18zXTtcbiAgICAgICAgICAgICAgICAgIHBhcnRPbmUuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgICAgICAgICAgICBwYXJ0VHdvLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ2FsdGVyJywgJ2FsdGVyJywgKGZ1bmN0aW9uKGQxLCBwLCBkMikge1xuICAgICAgICAgIFtdLnB1c2guYXBwbHkoZDEub3BlcmF0aW9uc1twXS52YWx1ZSwgZDIudmFsdWUpO1xuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuX2FkZENvbXBvc2l0aW9uUnVsZSgnYWx0ZXInLCAncmVwbGFjZScsIGtlZXBTZWNvbmQpO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ2FsdGVyJywgJ3JlbW92ZScsIChmdW5jdGlvbihkMSwgcCkge1xuICAgICAgICAgIGQxLm9wZXJhdGlvbnNbcF0gPSBEZWx0YU1vZGVsLl9uZXdEZWx0YSgnZm9yYmlkJyk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdhZGQnLCAnYWx0ZXInLCAoZnVuY3Rpb24oZDEsIHAsIGQyKSB7XG4gICAgICAgICAgYXNzZXJ0RnVuY3Rpb24oZDEub3BlcmF0aW9uc1twXS52YWx1ZSwgZDIuYWxpYXMpO1xuICAgICAgICAgIGFwcGx5U2Vjb25kVG9GaXJzdFZhbHVlKGQxLCBwLCBkMik7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdyZXBsYWNlJywgJ2FsdGVyJywgKGZ1bmN0aW9uKGQxLCBwLCBkMikge1xuICAgICAgICAgIGFzc2VydEZ1bmN0aW9uKGQxLm9wZXJhdGlvbnNbcF0udmFsdWUsIGQyLmFsaWFzKTtcbiAgICAgICAgICBhcHBseVNlY29uZFRvRmlyc3RWYWx1ZShkMSwgcCwgZDIpO1xuICAgICAgICB9KSk7XG4gICAgICAgIFsncHJlcGVuZCcsICdpbnNlcnQnLCAnYXBwZW5kJ10uZm9yRWFjaCgoZnVuY3Rpb24ob3BUeXBlKSB7XG4gICAgICAgICAgJF9fMC5fYWRkT3BlcmF0aW9uQWxpYXMoe1xuICAgICAgICAgICAgbmFtZTogb3BUeXBlLFxuICAgICAgICAgICAgdGFyZ2V0OiAnYWx0ZXInLFxuICAgICAgICAgICAgdHJhbnNmb3JtOiAoZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgICAgICByZXR1cm4gW1t7XG4gICAgICAgICAgICAgICAgdHlwZTogb3BUeXBlLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBhcmdzWzBdXG4gICAgICAgICAgICAgIH1dLCBvcFR5cGVdO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLl9hZGRPcGVyYXRpb25UeXBlKHtcbiAgICAgICAgICBuYW1lOiAnYWZ0ZXInLFxuICAgICAgICAgIGNvbnN0cnVjdG9yOiBmdW5jdGlvbiBBZnRlcih2YWx1ZSkge1xuICAgICAgICAgICAgVS5hc3NlcnQodHlwZW9mIHJlc29sdmVQcm9taXNlID09PSAnZnVuY3Rpb24nLCBcIkJlZm9yZSBjcmVhdGluZyBhbiAnYWZ0ZXInIG9wZXJhdGlvbiwgeW91IG11c3QgcmVnaXN0ZXIgYSBwcm9taXNlIHJlc29sdmVyIHdpdGggZGVsdGEuanMuXCIpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYXBwbHlUbzogZnVuY3Rpb24ob2JqLCBwcm9wZXJ0eSkge1xuICAgICAgICAgICAgYXNzZXJ0RnVuY3Rpb24ob2JqW3Byb3BlcnR5XSwgJ2FmdGVyJyk7XG4gICAgICAgICAgICB2YXIgcGFydE9uZSA9IG9ialtwcm9wZXJ0eV07XG4gICAgICAgICAgICB2YXIgcGFydFR3byA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICBvYmpbcHJvcGVydHldID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGFyZ3MgPSBbXSxcbiAgICAgICAgICAgICAgICAgICRfXzIgPSAwOyAkX18yIDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMisrKVxuICAgICAgICAgICAgICAgIGFyZ3NbJF9fMl0gPSBhcmd1bWVudHNbJF9fMl07XG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlUHJvbWlzZShwYXJ0T25lLmFwcGx5KHRoaXMsIGFyZ3MpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJ0VHdvLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ2FmdGVyJywgJ3JlcGxhY2UnLCBrZWVwU2Vjb25kKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdhZnRlcicsICdyZW1vdmUnLCBrZWVwU2Vjb25kKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdhZGQnLCAnYWZ0ZXInLCAoZnVuY3Rpb24oZDEsIHAsIGQyKSB7XG4gICAgICAgICAgYXNzZXJ0RnVuY3Rpb24oZDEub3BlcmF0aW9uc1twXS52YWx1ZSwgJ2FmdGVyJyk7XG4gICAgICAgICAgYXBwbHlTZWNvbmRUb0ZpcnN0VmFsdWUoZDEsIHAsIGQyKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ3JlcGxhY2UnLCAnYWZ0ZXInLCAoZnVuY3Rpb24oZDEsIHAsIGQyKSB7XG4gICAgICAgICAgYXNzZXJ0RnVuY3Rpb24oZDEub3BlcmF0aW9uc1twXS52YWx1ZSwgJ2FmdGVyJyk7XG4gICAgICAgICAgYXBwbHlTZWNvbmRUb0ZpcnN0VmFsdWUoZDEsIHAsIGQyKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLl9hZGRDb21wb3NpdGlvblJ1bGUoJ2luc2VydCcsICdhZnRlcicsIGFwcGx5U2Vjb25kVG9GaXJzdFZhbHVlKTtcbiAgICAgICAgdGhpcy5fYWRkQ29tcG9zaXRpb25SdWxlKCdhZnRlcicsICdpbnNlcnQnLCBhcHBseVNlY29uZFRvRmlyc3RWYWx1ZSk7XG4gICAgICAgIHZhciBfZ3JhcGggPSBuZXcgSnNHcmFwaCgpO1xuICAgICAgICBVLmV4dGVuZCh0aGlzLCB7Z3JhcGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9ncmFwaDtcbiAgICAgICAgICB9fSk7XG4gICAgICAgIHZhciBfZGVsdGFDb25kaXRpb25zID0ge307XG4gICAgICAgIHZhciBfc2V0dGxlZERlbHRhQ29uZGl0aW9ucyA9IHt9O1xuICAgICAgICB2YXIgX2NvbmRpdGlvbnNVbnNldHRsZWQgPSBmYWxzZTtcbiAgICAgICAgZnVuY3Rpb24gX3JlZ2lzdGVyRGlzanVuY3QoZGVsdGFOYW1lLCBkaXNqdW5jdCkge1xuICAgICAgICAgIF9jb25kaXRpb25zVW5zZXR0bGVkID0gdHJ1ZTtcbiAgICAgICAgICBpZiAoZGlzanVuY3QgPT09IHRydWUpIHtcbiAgICAgICAgICAgIF9zZXR0bGVkRGVsdGFDb25kaXRpb25zW2RlbHRhTmFtZV0gPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZGlzanVuY3QgPT09IGZhbHNlKSB7fSBlbHNlIGlmIChfZGVsdGFDb25kaXRpb25zW2RlbHRhTmFtZV0gIT09IHRydWUpIHtcbiAgICAgICAgICAgIFUuYXJyYXkoX2RlbHRhQ29uZGl0aW9ucywgZGVsdGFOYW1lKS5wdXNoKGRpc2p1bmN0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gX3NldHRsZUNvbmRpdGlvbnMoKSB7XG4gICAgICAgICAgaWYgKF9jb25kaXRpb25zVW5zZXR0bGVkKSB7XG4gICAgICAgICAgICBfY29uZGl0aW9uc1Vuc2V0dGxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIHNvbWV0aGluZ0NoYW5nZWQ7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgIHNvbWV0aGluZ0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgX2dyYXBoLmVhY2hWZXJ0ZXgoKGZ1bmN0aW9uKGRlbHRhTmFtZSkge1xuICAgICAgICAgICAgICAgIGlmIChfc2V0dGxlZERlbHRhQ29uZGl0aW9uc1tkZWx0YU5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChVLmlzVW5kZWZpbmVkKF9kZWx0YUNvbmRpdGlvbnNbZGVsdGFOYW1lXSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKF9kZWx0YUNvbmRpdGlvbnNbZGVsdGFOYW1lXS5zb21lKChmdW5jdGlvbihkaXNqdW5jdCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpc2p1bmN0LmV2ZXJ5KChmdW5jdGlvbihjb25qdW5jdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3NldHRsZWREZWx0YUNvbmRpdGlvbnNbY29uanVuY3RdO1xuICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH0pKSkge1xuICAgICAgICAgICAgICAgICAgX3NldHRsZWREZWx0YUNvbmRpdGlvbnNbZGVsdGFOYW1lXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICBzb21ldGhpbmdDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0gd2hpbGUgKHNvbWV0aGluZ0NoYW5nZWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLkRlbHRhID0gVS5uZXdTdWJjbGFzcyhfb3BUeXBlc1snbW9kaWZ5J10uRGVsdGEsIGZ1bmN0aW9uIERlbHRhKHN1cGVyRm4sIGRlbHRhTmFtZSkge1xuICAgICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzWzJdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1syXSA6IHt9O1xuICAgICAgICAgIHN1cGVyRm4uY2FsbCh0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgICBVLmFzc2VydChvcHRpb25zIGluc3RhbmNlb2YgT2JqZWN0LCBcIkEgZGVsdGEgc2hvdWxkIGJlIGdpdmVuIGFzIGFuIG9iamVjdC5cIik7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywge1xuICAgICAgICAgICAgbmFtZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlbHRhTmFtZTtcbiAgICAgICAgICAgICAgfX0sXG4gICAgICAgICAgICBtYW51YWxseVNlbGVjdGFibGU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChVLmlzRGVmaW5lZChvcHRpb25zWydtYW51YWxseVNlbGVjdGFibGUnXSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAhIW9wdGlvbnNbJ21hbnVhbGx5U2VsZWN0YWJsZSddO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoVS5pc0RlZmluZWQob3B0aW9uc1sncmVzb2x2ZXMnXSkgJiYgb3B0aW9uc1sncmVzb2x2ZXMnXS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfX0sXG4gICAgICAgICAgICBzZWxlY3RlZDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX3NldHRsZUNvbmRpdGlvbnMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFfc2V0dGxlZERlbHRhQ29uZGl0aW9uc1tkZWx0YU5hbWVdO1xuICAgICAgICAgICAgICB9fSxcbiAgICAgICAgICAgIGlmOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uc1snaWYnXSA9PT0gdHJ1ZSB8fCBvcHRpb25zWydpZiddID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnNbJ2lmJ107XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zWydpZiddIHx8IG9wdGlvbnNbJ2lmZiddIHx8IG9wdGlvbnNbJ3Jlc29sdmVzJ10pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQob3B0aW9uc1snaWYnXSB8fCBbXSwgb3B0aW9uc1snaWZmJ10gfHwgW10sIG9wdGlvbnNbJ3Jlc29sdmVzJ10gfHwgW10pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9fSxcbiAgICAgICAgICAgIG9ubHlJZjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnNbJ29ubHlJZiddID09PSB0cnVlIHx8IG9wdGlvbnNbJ29ubHlJZiddID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnNbJ29ubHlJZiddO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9uc1snb25seUlmJ10gfHwgb3B0aW9uc1snaWZmJ10gfHwgb3B0aW9uc1snZXhwZWN0cyddIHx8IG9wdGlvbnNbJ3Jlc29sdmVzJ10pIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQob3B0aW9uc1snb25seUlmJ10gfHwgW10sIG9wdGlvbnNbJ2lmZiddIHx8IFtdLCBvcHRpb25zWydleHBlY3RzJ10gfHwgW10sIG9wdGlvbnNbJ3Jlc29sdmVzJ10gfHwgW10pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH19LFxuICAgICAgICAgICAgYXBwbGllZEFmdGVyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW10uY29uY2F0KG9wdGlvbnNbJ2FwcGxpZWRBZnRlciddIHx8IFtdLCBvcHRpb25zWydleHBlY3RzJ10gfHwgW10sIG9wdGlvbnNbJ3Jlc29sdmVzJ10gfHwgW10sIG9wdGlvbnNbJ3JlcXVpcmVzJ10gfHwgW10pO1xuICAgICAgICAgICAgICB9fSxcbiAgICAgICAgICAgIHNlbGVjdHM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQob3B0aW9uc1snc2VsZWN0cyddIHx8IFtdLCBvcHRpb25zWydyZXF1aXJlcyddIHx8IFtdKTtcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBfY29uZGl0aW9uc1Vuc2V0dGxlZCA9IHRydWU7XG4gICAgICAgICAgaWYgKFUuaXNEZWZpbmVkKHRoaXMuaWYpKSB7XG4gICAgICAgICAgICBfcmVnaXN0ZXJEaXNqdW5jdChkZWx0YU5hbWUsIHRoaXMuaWYpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnNlbGVjdHMuZm9yRWFjaCgoZnVuY3Rpb24ob3RoZXJEZWx0YU5hbWUpIHtcbiAgICAgICAgICAgIF9yZWdpc3RlckRpc2p1bmN0KG90aGVyRGVsdGFOYW1lLCBbZGVsdGFOYW1lXSk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIF9ncmFwaC5hZGRWZXJ0ZXgoZGVsdGFOYW1lLCB0aGlzKTtcbiAgICAgICAgICB0aGlzLmFwcGxpZWRBZnRlci5mb3JFYWNoKChmdW5jdGlvbihvdGhlckRlbHRhTmFtZSkge1xuICAgICAgICAgICAgX2dyYXBoLmNyZWF0ZUVkZ2Uob3RoZXJEZWx0YU5hbWUsIGRlbHRhTmFtZSk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIFUuYXNzZXJ0KCFfZ3JhcGguaGFzQ3ljbGUoKSwgKFwiVGhlIGRlbHRhIFwiICsgZGVsdGFOYW1lICsgXCIgaW50cm9kdWNlZCBhIGN5Y2xlIGluIHRoZSBhcHBsaWNhdGlvbiBvcmRlci5cIikpO1xuICAgICAgICB9KTtcbiAgICAgICAgVS5leHRlbmQodGhpcywge1xuICAgICAgICAgIHNlbGVjdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBkZWx0YU5hbWVzID0gW10sXG4gICAgICAgICAgICAgICAgJF9fMiA9IDA7ICRfXzIgPCBhcmd1bWVudHMubGVuZ3RoOyAkX18yKyspXG4gICAgICAgICAgICAgIGRlbHRhTmFtZXNbJF9fMl0gPSBhcmd1bWVudHNbJF9fMl07XG4gICAgICAgICAgICBkZWx0YU5hbWVzLmZvckVhY2goKGZ1bmN0aW9uKGRlbHRhTmFtZSkge1xuICAgICAgICAgICAgICBfcmVnaXN0ZXJEaXNqdW5jdChkZWx0YU5hbWUsIHRydWUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdnA6IGZ1bmN0aW9uKHZwTmFtZSwgdmFsKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgICAgICBvYmpbdnBOYW1lXSA9IHZhbDtcbiAgICAgICAgICAgIF9zZXR0bGVDb25kaXRpb25zKCk7XG4gICAgICAgICAgICBfZ3JhcGguZWFjaFZlcnRleCgoZnVuY3Rpb24obmFtZSwgZGVsdGEpIHtcbiAgICAgICAgICAgICAgVS5hc3NlcnQoIWRlbHRhLnNlbGVjdGVkIHx8IGRlbHRhLm9ubHlJZiA9PT0gdHJ1ZSB8fCBkZWx0YS5vbmx5SWYuZXZlcnkoKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2dyYXBoLnZlcnRleFZhbHVlKGQpLnNlbGVjdGVkO1xuICAgICAgICAgICAgICB9KSksIChcIlRoZSAnb25seUlmJyBjb25kaXRpb24gb2YgZGVsdGEgJ1wiICsgZGVsdGEubmFtZSArIFwiJyB3YXMgdmlvbGF0ZWQuXCIpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIF9ncmFwaC50b3BvbG9naWNhbGx5KChmdW5jdGlvbihuYW1lLCBkZWx0YSkge1xuICAgICAgICAgICAgICBpZiAoZGVsdGEuc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBkZWx0YS5zZWxlY3RpdmVseUFwcGx5VG8ob2JqLCB2cE5hbWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gb2JqW3ZwTmFtZV07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgdmFyIHJlc29sdmVQcm9taXNlID0gbnVsbDtcbiAgICAgIFUuZXh0ZW5kKERlbHRhTW9kZWwsIHtyZWdpc3RlclByb21pc2VSZXNvbHZlcjogZnVuY3Rpb24ocHJvbWlzZVJlc29sdmVyRm4pIHtcbiAgICAgICAgICByZXNvbHZlUHJvbWlzZSA9IHByb21pc2VSZXNvbHZlckZuO1xuICAgICAgICB9fSk7XG4gICAgICByZXR1cm4gRGVsdGFNb2RlbDtcbiAgICB9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG4gIH0sIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xX187XG4gIH0sIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuICAgIHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXztcbiAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oKSB7XG4gICAgICAndXNlIHN0cmljdCc7XG4gICAgICB2YXIgVSA9IHtcbiAgICAgICAgbmV3Q2xhc3M6IGZ1bmN0aW9uKGNvbnN0cnVjdG9yLCBwcm90b3R5cGUpIHtcbiAgICAgICAgICBwcm90b3R5cGUgPSBwcm90b3R5cGUgfHwge307XG4gICAgICAgICAgdmFyIGNscyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgYXJncyA9IFtdLFxuICAgICAgICAgICAgICAgICRfXzAgPSAwOyAkX18wIDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMCsrKVxuICAgICAgICAgICAgICBhcmdzWyRfXzBdID0gYXJndW1lbnRzWyRfXzBdO1xuICAgICAgICAgICAgY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBjbHMucHJvdG90eXBlID0gcHJvdG90eXBlO1xuICAgICAgICAgIGNscy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBjbHM7XG4gICAgICAgICAgcmV0dXJuIGNscztcbiAgICAgICAgfSxcbiAgICAgICAgbmV3U3ViY2xhc3M6IGZ1bmN0aW9uKHN1cGVyQ2xhc3MsIGNvbnN0cnVjdG9yLCBwcm90b3R5cGUpIHtcbiAgICAgICAgICBwcm90b3R5cGUgPSBwcm90b3R5cGUgfHwge307XG4gICAgICAgICAgdmFyIGNscyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgYXJncyA9IFtdLFxuICAgICAgICAgICAgICAgICRfXzAgPSAwOyAkX18wIDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMCsrKVxuICAgICAgICAgICAgICBhcmdzWyRfXzBdID0gYXJndW1lbnRzWyRfXzBdO1xuICAgICAgICAgICAgY29uc3RydWN0b3IuYXBwbHkodGhpcywgW3N1cGVyQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yXS5jb25jYXQoYXJncykpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgY2xzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUsIHByb3RvdHlwZSk7XG4gICAgICAgICAgY2xzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGNscztcbiAgICAgICAgICByZXR1cm4gY2xzO1xuICAgICAgICB9LFxuICAgICAgICBleHRlbmQ6IGZ1bmN0aW9uKG9iajEpIHtcbiAgICAgICAgICBmb3IgKHZhciByZXN0ID0gW10sXG4gICAgICAgICAgICAgICRfXzAgPSAxOyAkX18wIDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMCsrKVxuICAgICAgICAgICAgcmVzdFskX18wIC0gMV0gPSBhcmd1bWVudHNbJF9fMF07XG4gICAgICAgICAgcmVzdC5mb3JFYWNoKChmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgb2JqMVtrZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgcmV0dXJuIG9iajE7XG4gICAgICAgIH0sXG4gICAgICAgIGFycmF5OiBmdW5jdGlvbihvYmosIG5hbWUpIHtcbiAgICAgICAgICBpZiAoVS5pc1VuZGVmaW5lZChvYmpbbmFtZV0pKSB7XG4gICAgICAgICAgICBvYmpbbmFtZV0gPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG9ialtuYW1lXTtcbiAgICAgICAgfSxcbiAgICAgICAgYmluZEE6IGZ1bmN0aW9uKGZuLCBjdHgsIGFyZ3MpIHtcbiAgICAgICAgICByZXR1cm4gZm4uYmluZC5hcHBseShmbiwgW2N0eF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgICAgfSxcbiAgICAgICAgYmluZDogZnVuY3Rpb24ob2JqLCBtKSB7XG4gICAgICAgICAgZm9yICh2YXIgYXJncyA9IFtdLFxuICAgICAgICAgICAgICAkX18xID0gMjsgJF9fMSA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzErKylcbiAgICAgICAgICAgIGFyZ3NbJF9fMSAtIDJdID0gYXJndW1lbnRzWyRfXzFdO1xuICAgICAgICAgIHJldHVybiBVLmJpbmRBKG9ialttXSwgb2JqLCBhcmdzKTtcbiAgICAgICAgfSxcbiAgICAgICAgYXBwbHlDb25zdHJ1Y3RvcjogZnVuY3Rpb24oQ29uc3RydWN0b3JGbiwgYXJncykge1xuICAgICAgICAgIHZhciBOZXdDb25zdHJ1Y3RvckZuID0gQ29uc3RydWN0b3JGbi5iaW5kLmFwcGx5KENvbnN0cnVjdG9yRm4sIFtudWxsXS5jb25jYXQoYXJncykpO1xuICAgICAgICAgIHJldHVybiBuZXcgTmV3Q29uc3RydWN0b3JGbigpO1xuICAgICAgICB9LFxuICAgICAgICBhc3NlcnQ6IGZ1bmN0aW9uKGNvbmRpdGlvbiwgbWVzc2FnZSkge1xuICAgICAgICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSB8fCBcIkFzc2VydGlvbiBmYWlsZWRcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpc1VuZGVmaW5lZDogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWwgPT09ICd1bmRlZmluZWQnO1xuICAgICAgICB9LFxuICAgICAgICBpc0RlZmluZWQ6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsICE9PSAndW5kZWZpbmVkJztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJldHVybiBVO1xuICAgIH0uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fLCBleHBvcnRzLCBtb2R1bGUpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG4gIH1dKTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL2Jvd2VyX2NvbXBvbmVudHMvZGVsdGEuanMvZGlzdC9kZWx0YS5qc1xuICoqIG1vZHVsZSBpZCA9IDQ3XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG4oZnVuY3Rpb24ocm9vdCwgbmFtZSwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFtdLCBmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgfSBlbHNlIHtcbiAgICByb290W25hbWVdID0gZmFjdG9yeSgpO1xuICB9XG59KHRoaXMsICdKc0dyYXBoJywgZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIEpzR3JhcGgoKSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHZhciBfdmVydGljZXMgPSB7fTtcbiAgICB2YXIgX2VkZ2VzID0ge307XG4gICAgdmFyIF9yZXZlcnNlRWRnZXMgPSB7fTtcbiAgICB2YXIgX3ZlcnRleENvdW50ID0gMDtcbiAgICB2YXIgX2VkZ2VDb3VudCA9IDA7XG4gICAgdmFyIF9hZGRWZXJ0ZXhDYWxsYmFja3MgPSBuZXcgQ2FsbGJhY2tzKCk7XG4gICAgdmFyIF9yZW1vdmVWZXJ0ZXhDYWxsYmFja3MgPSBuZXcgQ2FsbGJhY2tzKCk7XG4gICAgdGhhdC5vbkFkZFZlcnRleCA9IF9hZGRWZXJ0ZXhDYWxsYmFja3MuYWRkO1xuICAgIHRoYXQub25SZW1vdmVWZXJ0ZXggPSBfcmVtb3ZlVmVydGV4Q2FsbGJhY2tzLmFkZDtcbiAgICB0aGF0LmFkZE5ld1ZlcnRleCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgIGlmICh0aGF0Lmhhc1ZlcnRleChrZXkpKSB7XG4gICAgICAgIHRocm93IG5ldyBKc0dyYXBoLlZlcnRleEV4aXN0c0Vycm9yKGtleSwgX3ZlcnRpY2VzW2tleV0pO1xuICAgICAgfVxuICAgICAgX3ZlcnRpY2VzW2tleV0gPSB2YWx1ZTtcbiAgICAgIF9lZGdlc1trZXldID0ge307XG4gICAgICBfcmV2ZXJzZUVkZ2VzW2tleV0gPSB7fTtcbiAgICAgIF92ZXJ0ZXhDb3VudCArPSAxO1xuICAgICAgX2FkZFZlcnRleENhbGxiYWNrcy5maXJlKGtleSwgdmFsdWUpO1xuICAgIH07XG4gICAgdGhhdC5zZXRWZXJ0ZXggPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICBpZiAoIXRoYXQuaGFzVmVydGV4KGtleSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpzR3JhcGguVmVydGV4Tm90RXhpc3RzRXJyb3Ioa2V5KTtcbiAgICAgIH1cbiAgICAgIF92ZXJ0aWNlc1trZXldID0gdmFsdWU7XG4gICAgfTtcbiAgICB0aGF0LmVuc3VyZVZlcnRleCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgIGlmICghdGhhdC5oYXNWZXJ0ZXgoa2V5KSkge1xuICAgICAgICB0aGF0LmFkZE5ld1ZlcnRleChrZXksIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoYXQuYWRkVmVydGV4ID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgaWYgKHRoYXQuaGFzVmVydGV4KGtleSkpIHtcbiAgICAgICAgdGhhdC5zZXRWZXJ0ZXgoa2V5LCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGF0LmFkZE5ld1ZlcnRleChrZXksIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoYXQucmVtb3ZlRXhpc3RpbmdWZXJ0ZXggPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgIGlmICghdGhhdC5oYXNWZXJ0ZXgoa2V5KSkge1xuICAgICAgICB0aHJvdyBuZXcgSnNHcmFwaC5WZXJ0ZXhOb3RFeGlzdHNFcnJvcihrZXkpO1xuICAgICAgfVxuICAgICAgaWYgKE9iamVjdC5rZXlzKF9lZGdlc1trZXldKS5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpzR3JhcGguSGFzQ29ubmVjdGVkRWRnZXNFcnJvcihrZXkpO1xuICAgICAgfVxuICAgICAgaWYgKE9iamVjdC5rZXlzKF9yZXZlcnNlRWRnZXNba2V5XSkubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBKc0dyYXBoLkhhc0Nvbm5lY3RlZEVkZ2VzRXJyb3Ioa2V5KTtcbiAgICAgIH1cbiAgICAgIHZhciB2YWx1ZU9mUmVtb3ZlZFZlcnRleCA9IF92ZXJ0aWNlc1trZXldO1xuICAgICAgZGVsZXRlIF92ZXJ0aWNlc1trZXldO1xuICAgICAgX3ZlcnRleENvdW50IC09IDE7XG4gICAgICBfcmVtb3ZlVmVydGV4Q2FsbGJhY2tzLmZpcmUoa2V5LCB2YWx1ZU9mUmVtb3ZlZFZlcnRleCk7XG4gICAgfTtcbiAgICB0aGF0LmRlc3Ryb3lFeGlzdGluZ1ZlcnRleCA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgaWYgKCF0aGF0Lmhhc1ZlcnRleChrZXkpKSB7XG4gICAgICAgIHRocm93IG5ldyBKc0dyYXBoLlZlcnRleE5vdEV4aXN0c0Vycm9yKGtleSk7XG4gICAgICB9XG4gICAgICB0aGF0LmVhY2hWZXJ0ZXhGcm9tKGtleSwgZnVuY3Rpb24odG8pIHtcbiAgICAgICAgdGhhdC5yZW1vdmVFZGdlKGtleSwgdG8pO1xuICAgICAgfSk7XG4gICAgICB0aGF0LmVhY2hWZXJ0ZXhUbyhrZXksIGZ1bmN0aW9uKGZyb20pIHtcbiAgICAgICAgdGhhdC5yZW1vdmVFZGdlKGZyb20sIGtleSk7XG4gICAgICB9KTtcbiAgICAgIHRoYXQucmVtb3ZlRXhpc3RpbmdWZXJ0ZXgoa2V5KTtcbiAgICB9O1xuICAgIHRoYXQucmVtb3ZlVmVydGV4ID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgICBpZiAodGhhdC5oYXNWZXJ0ZXgoa2V5KSkge1xuICAgICAgICB0aGF0LnJlbW92ZUV4aXN0aW5nVmVydGV4KGtleSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGF0LmRlc3Ryb3lWZXJ0ZXggPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgIGlmICh0aGF0Lmhhc1ZlcnRleChrZXkpKSB7XG4gICAgICAgIHRoYXQuZGVzdHJveUV4aXN0aW5nVmVydGV4KGtleSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgX2FkZEVkZ2VDYWxsYmFja3MgPSBuZXcgQ2FsbGJhY2tzKCk7XG4gICAgdmFyIF9yZW1vdmVFZGdlQ2FsbGJhY2tzID0gbmV3IENhbGxiYWNrcygpO1xuICAgIHRoYXQub25BZGRFZGdlID0gX2FkZEVkZ2VDYWxsYmFja3MuYWRkO1xuICAgIHRoYXQub25SZW1vdmVFZGdlID0gX3JlbW92ZUVkZ2VDYWxsYmFja3MuYWRkO1xuICAgIHRoYXQuYWRkTmV3RWRnZSA9IGZ1bmN0aW9uKGZyb20sIHRvLCB2YWx1ZSkge1xuICAgICAgaWYgKHRoYXQuaGFzRWRnZShmcm9tLCB0bykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpzR3JhcGguRWRnZUV4aXN0c0Vycm9yKGZyb20sIHRvLCB0aGF0LmVkZ2VWYWx1ZShmcm9tLCB0bykpO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGF0Lmhhc1ZlcnRleChmcm9tKSkge1xuICAgICAgICBpZiAodGhhdC5oYXNWZXJ0ZXgodG8pKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEpzR3JhcGguVmVydGV4Tm90RXhpc3RzRXJyb3IoZnJvbSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEpzR3JhcGguVmVydGV4Tm90RXhpc3RzRXJyb3IoZnJvbSkudih0byk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIXRoYXQuaGFzVmVydGV4KHRvKSkge1xuICAgICAgICB0aHJvdyBuZXcgSnNHcmFwaC5WZXJ0ZXhOb3RFeGlzdHNFcnJvcih0byk7XG4gICAgICB9XG4gICAgICBfZWRnZXNbZnJvbV1bdG9dID0gdmFsdWU7XG4gICAgICBfcmV2ZXJzZUVkZ2VzW3RvXVtmcm9tXSA9IG51bGw7XG4gICAgICBfZWRnZUNvdW50ICs9IDE7XG4gICAgICBfYWRkRWRnZUNhbGxiYWNrcy5maXJlKGZyb20sIHRvLCB2YWx1ZSk7XG4gICAgfTtcbiAgICB0aGF0LmNyZWF0ZU5ld0VkZ2UgPSBmdW5jdGlvbihmcm9tLCB0bywgdmFsdWUpIHtcbiAgICAgIGlmICh0aGF0Lmhhc0VkZ2UoZnJvbSwgdG8pKSB7XG4gICAgICAgIHRocm93IG5ldyBKc0dyYXBoLkVkZ2VFeGlzdHNFcnJvcihmcm9tLCB0bywgdGhhdC5lZGdlVmFsdWUoZnJvbSwgdG8pKTtcbiAgICAgIH1cbiAgICAgIHRoYXQuZW5zdXJlVmVydGV4KGZyb20pO1xuICAgICAgdGhhdC5lbnN1cmVWZXJ0ZXgodG8pO1xuICAgICAgdGhhdC5hZGROZXdFZGdlKGZyb20sIHRvLCB2YWx1ZSk7XG4gICAgfTtcbiAgICB0aGF0LnNldEVkZ2UgPSBmdW5jdGlvbihmcm9tLCB0bywgdmFsdWUpIHtcbiAgICAgIGlmICghdGhhdC5oYXNFZGdlKGZyb20sIHRvKSkge1xuICAgICAgICB0aHJvdyBuZXcgSnNHcmFwaC5FZGdlTm90RXhpc3RzRXJyb3IoZnJvbSwgdG8pO1xuICAgICAgfVxuICAgICAgX2VkZ2VzW2Zyb21dW3RvXSA9IHZhbHVlO1xuICAgIH07XG4gICAgdGhhdC5zcGFuRWRnZSA9IGZ1bmN0aW9uKGZyb20sIHRvLCB2YWx1ZSkge1xuICAgICAgaWYgKCF0aGF0Lmhhc1ZlcnRleChmcm9tKSkge1xuICAgICAgICBpZiAodGhhdC5oYXNWZXJ0ZXgodG8pKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEpzR3JhcGguVmVydGV4Tm90RXhpc3RzRXJyb3IoZnJvbSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEpzR3JhcGguVmVydGV4Tm90RXhpc3RzRXJyb3IoZnJvbSkudih0byk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIXRoYXQuaGFzVmVydGV4KHRvKSkge1xuICAgICAgICB0aHJvdyBuZXcgSnNHcmFwaC5WZXJ0ZXhOb3RFeGlzdHNFcnJvcih0byk7XG4gICAgICB9XG4gICAgICBpZiAoIXRoYXQuaGFzRWRnZShmcm9tLCB0bykpIHtcbiAgICAgICAgdGhhdC5hZGROZXdFZGdlKGZyb20sIHRvLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGF0LmFkZEVkZ2UgPSBmdW5jdGlvbihmcm9tLCB0bywgdmFsdWUpIHtcbiAgICAgIGlmICh0aGF0Lmhhc0VkZ2UoZnJvbSwgdG8pKSB7XG4gICAgICAgIHRoYXQuc2V0RWRnZShmcm9tLCB0bywgdmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhhdC5hZGROZXdFZGdlKGZyb20sIHRvLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGF0LmVuc3VyZUVkZ2UgPSBmdW5jdGlvbihmcm9tLCB0bywgdmFsdWUpIHtcbiAgICAgIGlmICghdGhhdC5oYXNFZGdlKGZyb20sIHRvKSkge1xuICAgICAgICB0aGF0LmNyZWF0ZU5ld0VkZ2UoZnJvbSwgdG8sIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoYXQuY3JlYXRlRWRnZSA9IGZ1bmN0aW9uKGZyb20sIHRvLCB2YWx1ZSkge1xuICAgICAgaWYgKHRoYXQuaGFzRWRnZShmcm9tLCB0bykpIHtcbiAgICAgICAgdGhhdC5zZXRFZGdlKGZyb20sIHRvLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGF0LmNyZWF0ZU5ld0VkZ2UoZnJvbSwgdG8sIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoYXQucmVtb3ZlRXhpc3RpbmdFZGdlID0gZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgICAgIGlmICghdGhhdC5oYXNFZGdlKGZyb20sIHRvKSkge1xuICAgICAgICB0aHJvdyBuZXcgSnNHcmFwaC5FZGdlTm90RXhpc3RzRXJyb3IoZnJvbSwgdG8pO1xuICAgICAgfVxuICAgICAgdmFyIHZhbHVlT2ZSZW1vdmVkRWRnZSA9IF9lZGdlc1tmcm9tXVt0b107XG4gICAgICBkZWxldGUgX2VkZ2VzW2Zyb21dW3RvXTtcbiAgICAgIGRlbGV0ZSBfcmV2ZXJzZUVkZ2VzW3RvXVtmcm9tXTtcbiAgICAgIF9lZGdlQ291bnQgLT0gMTtcbiAgICAgIF9yZW1vdmVFZGdlQ2FsbGJhY2tzLmZpcmUoZnJvbSwgdG8sIHZhbHVlT2ZSZW1vdmVkRWRnZSk7XG4gICAgfTtcbiAgICB0aGF0LnJlbW92ZUVkZ2UgPSBmdW5jdGlvbihmcm9tLCB0bykge1xuICAgICAgaWYgKHRoYXQuaGFzRWRnZShmcm9tLCB0bykpIHtcbiAgICAgICAgdGhhdC5yZW1vdmVFeGlzdGluZ0VkZ2UoZnJvbSwgdG8pO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhhdC52ZXJ0ZXhDb3VudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIF92ZXJ0ZXhDb3VudDtcbiAgICB9O1xuICAgIHRoYXQuaGFzVmVydGV4ID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4ga2V5IGluIF92ZXJ0aWNlcztcbiAgICB9O1xuICAgIHRoYXQudmVydGV4VmFsdWUgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiBfdmVydGljZXNba2V5XTtcbiAgICB9O1xuICAgIHRoYXQuZWRnZUNvdW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gX2VkZ2VDb3VudDtcbiAgICB9O1xuICAgIHRoYXQuaGFzRWRnZSA9IGZ1bmN0aW9uKGZyb20sIHRvKSB7XG4gICAgICByZXR1cm4gdGhhdC5oYXNWZXJ0ZXgoZnJvbSkgJiYgdGhhdC5oYXNWZXJ0ZXgodG8pICYmIGZyb20gaW4gX2VkZ2VzICYmIHRvIGluIF9lZGdlc1tmcm9tXTtcbiAgICB9O1xuICAgIHRoYXQuZWRnZVZhbHVlID0gZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgICAgIHJldHVybiB0aGF0Lmhhc0VkZ2UoZnJvbSwgdG8pID8gX2VkZ2VzW2Zyb21dW3RvXSA6IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIHRoYXQuc3VjY2Vzc29ycyA9IGZ1bmN0aW9uKGZyb20pIHtcbiAgICAgIGlmICghdGhhdC5oYXNWZXJ0ZXgoZnJvbSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpzR3JhcGguVmVydGV4Tm90RXhpc3RzRXJyb3IoZnJvbSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXMoX2VkZ2VzW2Zyb21dKTtcbiAgICB9O1xuICAgIHRoYXQucHJlZGVjZXNzb3JzID0gZnVuY3Rpb24odG8pIHtcbiAgICAgIGlmICghdGhhdC5oYXNWZXJ0ZXgodG8pKSB7XG4gICAgICAgIHRocm93IG5ldyBKc0dyYXBoLlZlcnRleE5vdEV4aXN0c0Vycm9yKHRvKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhfcmV2ZXJzZUVkZ2VzW3RvXSk7XG4gICAgfTtcbiAgICB0aGF0LmVhY2hWZXJ0ZXggPSBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICBPYmplY3Qua2V5cyhfdmVydGljZXMpLmV2ZXJ5KGZ1bmN0aW9uKGtleSkge1xuICAgICAgICB2YXIgciA9IGhhbmRsZXIoa2V5LCBfdmVydGljZXNba2V5XSk7XG4gICAgICAgIHJldHVybiAociAhPT0gZmFsc2UpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICB0aGF0LmVhY2hWZXJ0ZXhGcm9tID0gZnVuY3Rpb24oZnJvbSwgaGFuZGxlcikge1xuICAgICAgaWYgKCF0aGF0Lmhhc1ZlcnRleChmcm9tKSkge1xuICAgICAgICB0aHJvdyBuZXcgSnNHcmFwaC5WZXJ0ZXhOb3RFeGlzdHNFcnJvcihmcm9tKTtcbiAgICAgIH1cbiAgICAgIE9iamVjdC5rZXlzKF9lZGdlc1tmcm9tXSkuZXZlcnkoZnVuY3Rpb24odG8pIHtcbiAgICAgICAgdmFyIHIgPSBoYW5kbGVyKHRvLCB0aGF0LnZlcnRleFZhbHVlKHRvKSwgdGhhdC5lZGdlVmFsdWUoZnJvbSwgdG8pKTtcbiAgICAgICAgcmV0dXJuIChyICE9PSBmYWxzZSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHRoYXQuZWFjaFZlcnRleFRvID0gZnVuY3Rpb24odG8sIGhhbmRsZXIpIHtcbiAgICAgIGlmICghdGhhdC5oYXNWZXJ0ZXgodG8pKSB7XG4gICAgICAgIHRocm93IG5ldyBKc0dyYXBoLlZlcnRleE5vdEV4aXN0c0Vycm9yKHRvKTtcbiAgICAgIH1cbiAgICAgIE9iamVjdC5rZXlzKF9yZXZlcnNlRWRnZXNbdG9dKS5ldmVyeShmdW5jdGlvbihmcm9tKSB7XG4gICAgICAgIHZhciByID0gaGFuZGxlcihmcm9tLCB0aGF0LnZlcnRleFZhbHVlKGZyb20pLCB0aGF0LmVkZ2VWYWx1ZShmcm9tLCB0bykpO1xuICAgICAgICByZXR1cm4gKHIgIT09IGZhbHNlKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdGhhdC5lYWNoRWRnZSA9IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgIE9iamVjdC5rZXlzKF9lZGdlcykuZXZlcnkoZnVuY3Rpb24oZnJvbSkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoX2VkZ2VzW2Zyb21dKS5ldmVyeShmdW5jdGlvbih0bykge1xuICAgICAgICAgIHZhciByID0gaGFuZGxlcihmcm9tLCB0bywgX2VkZ2VzW2Zyb21dW3RvXSk7XG4gICAgICAgICAgcmV0dXJuIChyICE9PSBmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICB0aGF0LmNsZWFyRWRnZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHRoYXQuZWFjaEVkZ2UodGhhdC5yZW1vdmVFZGdlKTtcbiAgICB9O1xuICAgIHRoYXQuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHRoYXQuZWFjaFZlcnRleCh0aGF0LmRlc3Ryb3lWZXJ0ZXgpO1xuICAgIH07XG4gICAgdGhhdC5oYXNDeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHZpc2l0ZWQgPSB7fTtcbiAgICAgIHZhciBoYW5kbGVkID0ge307XG4gICAgICB2YXIgY3ljbGVGb3VuZCA9IGZhbHNlO1xuICAgICAgZnVuY3Rpb24gdmlzaXQoYSkge1xuICAgICAgICBpZiAodmlzaXRlZFthXSkge1xuICAgICAgICAgIGN5Y2xlRm91bmQgPSB0cnVlO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFuZGxlZFthXSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBoYW5kbGVkW2FdID0gdHJ1ZTtcbiAgICAgICAgdmlzaXRlZFthXSA9IHRydWU7XG4gICAgICAgIHRoYXQuZWFjaFZlcnRleEZyb20oYSwgZnVuY3Rpb24oYikge1xuICAgICAgICAgIHZpc2l0KGIpO1xuICAgICAgICAgIGlmIChjeWNsZUZvdW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdmlzaXRlZFthXSA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgdGhhdC5lYWNoVmVydGV4KGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgdmlzaXQoYSk7XG4gICAgICAgIGlmIChjeWNsZUZvdW5kKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjeWNsZUZvdW5kO1xuICAgIH07XG4gICAgdGhhdC5oYXNQYXRoID0gZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgICAgIGlmICghdGhhdC5oYXNWZXJ0ZXgoZnJvbSkgfHwgIXRoYXQuaGFzVmVydGV4KHRvKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgdmlzaXRlZCA9IHt9O1xuICAgICAgZnVuY3Rpb24gaGFzUGF0aEF1eChjdXJyZW50KSB7XG4gICAgICAgIGlmICh0aGF0Lmhhc0VkZ2UoY3VycmVudCwgdG8pKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmlzaXRlZFtjdXJyZW50XSA9IHRydWU7XG4gICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgICB0aGF0LmVhY2hWZXJ0ZXhGcm9tKGN1cnJlbnQsIGZ1bmN0aW9uKG5leHQpIHtcbiAgICAgICAgICBpZiAoIWZvdW5kICYmICF2aXNpdGVkW25leHRdICYmIGhhc1BhdGhBdXgobmV4dCkpIHtcbiAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBkZWxldGUgdmlzaXRlZFtjdXJyZW50XTtcbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGhhc1BhdGhBdXgoZnJvbSk7XG4gICAgfTtcbiAgICB0aGF0LnRvcG9sb2dpY2FsbHkgPSBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICB2YXIgdmlzaXRlZCA9IFtdO1xuICAgICAgdmFyIGhhbmRsZWQgPSB7fTtcbiAgICAgIGZ1bmN0aW9uIHZpc2l0KGEpIHtcbiAgICAgICAgdmlzaXRlZC5wdXNoKGEpO1xuICAgICAgICB2YXIgaSA9IHZpc2l0ZWQuaW5kZXhPZihhKTtcbiAgICAgICAgaWYgKGkgIT09IHZpc2l0ZWQubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHZhciBjeWNsZSA9IHZpc2l0ZWQuc2xpY2UoaSArIDEpLnJldmVyc2UoKTtcbiAgICAgICAgICB0aHJvdyBuZXcgSnNHcmFwaC5DeWNsZUVycm9yKGN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWhhbmRsZWRbYV0pIHtcbiAgICAgICAgICB0aGF0LmVhY2hWZXJ0ZXhUbyhhLCB2aXNpdCk7XG4gICAgICAgICAgaGFuZGxlZFthXSA9IHtyZXR1cm5lZDogaGFuZGxlcihhLCB0aGF0LnZlcnRleFZhbHVlKGEpKX07XG4gICAgICAgIH1cbiAgICAgICAgdmlzaXRlZC5wb3AoKTtcbiAgICAgIH1cbiAgICAgIHRoYXQuZWFjaFZlcnRleChmdW5jdGlvbihhKSB7XG4gICAgICAgIGlmICghaGFuZGxlZFthXSkge1xuICAgICAgICAgIHZpc2l0KGEpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHRoYXQudHJhbnNpdGl2ZVJlZHVjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlc3VsdCA9IG5ldyBKc0dyYXBoKCk7XG4gICAgICB0aGF0LmVhY2hWZXJ0ZXgoZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgICAgcmVzdWx0LmFkZFZlcnRleChrZXksIHZhbCk7XG4gICAgICB9KTtcbiAgICAgIHRoYXQuZWFjaEVkZ2UoZnVuY3Rpb24oZnJvbSwgdG8sIHZhbCkge1xuICAgICAgICByZXN1bHQuYWRkRWRnZShmcm9tLCB0bywgdmFsKTtcbiAgICAgIH0pO1xuICAgICAgcmVzdWx0LmVhY2hWZXJ0ZXgoZnVuY3Rpb24oeCkge1xuICAgICAgICByZXN1bHQuZWFjaFZlcnRleChmdW5jdGlvbih5KSB7XG4gICAgICAgICAgaWYgKHJlc3VsdC5oYXNFZGdlKHgsIHkpKSB7XG4gICAgICAgICAgICByZXN1bHQuZWFjaFZlcnRleChmdW5jdGlvbih6KSB7XG4gICAgICAgICAgICAgIGlmIChyZXN1bHQuaGFzUGF0aCh5LCB6KSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5yZW1vdmVFZGdlKHgsIHopO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gc2V0MmRPYmooQSwgb25lLCB0d28sIHZhbCkge1xuICAgIGlmICh0eXBlb2YgQVtvbmVdID09PSAndW5kZWZpbmVkJykge1xuICAgICAgQVtvbmVdID0ge307XG4gICAgfVxuICAgIEFbb25lXVt0d29dID0gdmFsO1xuICB9XG4gIGZ1bmN0aW9uIENhbGxiYWNrcygpIHtcbiAgICB2YXIgY2FsbGJhY2tzID0gW107XG4gICAgdGhpcy5hZGQgPSBmdW5jdGlvbihmbikge1xuICAgICAgaWYgKGNhbGxiYWNrcy5pbmRleE9mKGZuKSA9PT0gLTEpIHtcbiAgICAgICAgY2FsbGJhY2tzLnB1c2goZm4pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlbW92ZUNhbGxiYWNrKCkge1xuICAgICAgICB2YXIgaW5kZXggPSBjYWxsYmFja3MuaW5kZXhPZihmbik7XG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9O1xuICAgIHRoaXMuZmlyZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICBjYWxsYmFja3MuZm9yRWFjaChmdW5jdGlvbihmbikge1xuICAgICAgICBmbi5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gbmV3RXJyb3IobmFtZSwgY29uc3RydWN0b3IpIHtcbiAgICBjb25zdHJ1Y3Rvci5wcm90b3R5cGUuX19wcm90b19fID0gRXJyb3IucHJvdG90eXBlO1xuICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGNvbnN0cnVjdG9yO1xuICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZS5uYW1lID0gbmFtZTtcbiAgICByZXR1cm4gY29uc3RydWN0b3I7XG4gIH1cbiAgSnNHcmFwaC5WZXJ0ZXhFeGlzdHNFcnJvciA9IG5ld0Vycm9yKFwiVmVydGV4RXhpc3RzRXJyb3JcIiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICBmdW5jdGlvbiByZWZyZXNoTWVzc2FnZSgpIHtcbiAgICAgIHRoYXQubWVzc2FnZSA9IFwiVGhpcyBncmFwaCBoYXMgXCIgKyAodGhhdC52ZXJ0aWNlcyA9PT0gMSA/IFwiYSB2ZXJ0ZXhcIiA6IFwidmVydGljZXNcIikgKyBcIiAnXCIgKyBPYmplY3Qua2V5cyh0aGF0LnZlcnRpY2VzKS5qb2luKFwiJywgJ1wiKSArIFwiJ1wiO1xuICAgIH1cbiAgICB0aGF0LnYgPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICB0aGF0LnZlcnRpY2VzW2tleV0gPSB2YWx1ZTtcbiAgICAgIHJlZnJlc2hNZXNzYWdlKCk7XG4gICAgICByZXR1cm4gdGhhdDtcbiAgICB9O1xuICAgIHRoYXQudmVydGljZXMgPSB7fTtcbiAgICB0aGF0LnYoa2V5LCB2YWx1ZSk7XG4gICAgcmVmcmVzaE1lc3NhZ2UoKTtcbiAgfSk7XG4gIEpzR3JhcGguVmVydGV4Tm90RXhpc3RzRXJyb3IgPSBuZXdFcnJvcihcIlZlcnRleE5vdEV4aXN0RXJyb3JcIiwgZnVuY3Rpb24oa2V5KSB7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIGZ1bmN0aW9uIHJlZnJlc2hNZXNzYWdlKCkge1xuICAgICAgdGhhdC5tZXNzYWdlID0gXCJUaGlzIGdyYXBoIGRvZXMgbm90IGhhdmUgXCIgKyAodGhhdC52ZXJ0aWNlcyA9PT0gMSA/IFwiYSB2ZXJ0ZXhcIiA6IFwidmVydGljZXNcIikgKyBcIiAnXCIgKyBPYmplY3Qua2V5cyh0aGF0LnZlcnRpY2VzKS5qb2luKFwiJywgJ1wiKSArIFwiJ1wiO1xuICAgIH1cbiAgICB0aGF0LnYgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHRoYXQudmVydGljZXNba2V5XSA9IHVuZGVmaW5lZDtcbiAgICAgIHJlZnJlc2hNZXNzYWdlKCk7XG4gICAgICByZXR1cm4gdGhhdDtcbiAgICB9O1xuICAgIHRoYXQudmVydGljZXMgPSB7fTtcbiAgICB0aGF0LnYoa2V5KTtcbiAgICByZWZyZXNoTWVzc2FnZSgpO1xuICB9KTtcbiAgSnNHcmFwaC5FZGdlRXhpc3RzRXJyb3IgPSBuZXdFcnJvcihcIkVkZ2VFeGlzdHNFcnJvclwiLCBmdW5jdGlvbihmcm9tLCB0bywgdmFsdWUpIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgZnVuY3Rpb24gcmVmcmVzaE1lc3NhZ2UoKSB7XG4gICAgICB2YXIgZWRnZXMgPSBbXTtcbiAgICAgIE9iamVjdC5rZXlzKHRoYXQuZWRnZXMpLmZvckVhY2goZnVuY3Rpb24oZnJvbSkge1xuICAgICAgICBPYmplY3Qua2V5cyh0aGF0LmVkZ2VzW2Zyb21dKS5mb3JFYWNoKGZ1bmN0aW9uKHRvKSB7XG4gICAgICAgICAgZWRnZXMucHVzaChcIignXCIgKyBmcm9tICsgXCInLCAnXCIgKyB0byArIFwiJylcIik7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICB0aGF0Lm1lc3NhZ2UgPSBcIlRoaXMgZ3JhcGggaGFzIFwiICsgKGVkZ2VzLmxlbmd0aCA9PT0gMSA/IFwiYW4gZWRnZSBcIiA6IFwiZWRnZXMgXCIpICsgZWRnZXMuam9pbihcIiwgXCIpO1xuICAgIH1cbiAgICB0aGF0LmUgPSBmdW5jdGlvbihmcm9tLCB0bywgdmFsdWUpIHtcbiAgICAgIHNldDJkT2JqKHRoYXQuZWRnZXMsIGZyb20sIHRvLCB2YWx1ZSk7XG4gICAgICByZWZyZXNoTWVzc2FnZSgpO1xuICAgICAgcmV0dXJuIHRoYXQ7XG4gICAgfTtcbiAgICB0aGF0LmVkZ2VzID0ge307XG4gICAgdGhhdC5lKGZyb20sIHRvLCB2YWx1ZSk7XG4gICAgcmVmcmVzaE1lc3NhZ2UoKTtcbiAgfSk7XG4gIEpzR3JhcGguRWRnZU5vdEV4aXN0c0Vycm9yID0gbmV3RXJyb3IoXCJFZGdlTm90RXhpc3RFcnJvclwiLCBmdW5jdGlvbihmcm9tLCB0bykge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICBmdW5jdGlvbiByZWZyZXNoTWVzc2FnZSgpIHtcbiAgICAgIHZhciBlZGdlcyA9IFtdO1xuICAgICAgT2JqZWN0LmtleXModGhhdC5lZGdlcykuZm9yRWFjaChmdW5jdGlvbihmcm9tKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoYXQuZWRnZXNbZnJvbV0pLmZvckVhY2goZnVuY3Rpb24odG8pIHtcbiAgICAgICAgICBlZGdlcy5wdXNoKFwiKCdcIiArIGZyb20gKyBcIicsICdcIiArIHRvICsgXCInKVwiKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHRoYXQubWVzc2FnZSA9IFwiVGhpcyBncmFwaCBkb2VzIG5vdCBoYXZlIFwiICsgKGVkZ2VzLmxlbmd0aCA9PT0gMSA/IFwiYW4gZWRnZSBcIiA6IFwiZWRnZXMgXCIpICsgZWRnZXMuam9pbihcIiwgXCIpO1xuICAgIH1cbiAgICB0aGF0LmUgPSBmdW5jdGlvbihmcm9tLCB0bykge1xuICAgICAgc2V0MmRPYmoodGhhdC5lZGdlcywgZnJvbSwgdG8sIHVuZGVmaW5lZCk7XG4gICAgICByZWZyZXNoTWVzc2FnZSgpO1xuICAgICAgcmV0dXJuIHRoYXQ7XG4gICAgfTtcbiAgICB0aGF0LmVkZ2VzID0ge307XG4gICAgdGhhdC5lKGZyb20sIHRvKTtcbiAgICByZWZyZXNoTWVzc2FnZSgpO1xuICB9KTtcbiAgSnNHcmFwaC5IYXNDb25uZWN0ZWRFZGdlc0Vycm9yID0gbmV3RXJyb3IoXCJIYXNDb25uZWN0ZWRFZGdlc0Vycm9yXCIsIGZ1bmN0aW9uKGtleSkge1xuICAgIHRoaXMubWVzc2FnZSA9IFwiVGhlICdcIiArIGtleSArIFwiJyB2ZXJ0ZXggaGFzIGNvbm5lY3RlZCBlZGdlc1wiO1xuICAgIHRoaXMua2V5ID0ga2V5O1xuICB9KTtcbiAgSnNHcmFwaC5DeWNsZUVycm9yID0gbmV3RXJyb3IoXCJDeWNsZUVycm9yXCIsIGZ1bmN0aW9uKGN5Y2xlKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gXCJUaGlzIGdyYXBoIGNvbnRhaW5zIGEgY3ljbGU6IFwiICsgY3ljbGU7XG4gICAgdGhpcy5jeWNsZSA9IGN5Y2xlO1xuICB9KTtcbiAgcmV0dXJuIEpzR3JhcGg7XG59KSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vYm93ZXJfY29tcG9uZW50cy9qcy1ncmFwaC9kaXN0L2pzLWdyYXBoLmpzXG4gKiogbW9kdWxlIGlkID0gNDhcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJzb3VyY2VSb290IjoiIiwiZmlsZSI6ImV4YW1wbGUyLmpzIn0=