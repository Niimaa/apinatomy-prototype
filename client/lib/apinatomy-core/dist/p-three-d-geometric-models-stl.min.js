!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("jquery"),require("three-js"));else if("function"==typeof define&&define.amd)define(["jquery","three-js"],e);else{var r="object"==typeof exports?e(require("jquery"),require("three-js")):e(t.jQuery,t.THREE);for(var o in r)("object"==typeof exports?exports:t)[o]=r[o]}}(this,function(t,e){return function(t){function e(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var o,n;o=[r(1),r(2),r(3)],n=function(t,e){"use strict";var r=t.circuitboard.plugin["do"]("three-d-geometric-models-stl",{requires:["three-d-geometric-models"]});r.add("Circuitboard.threeJsLoaders.stl",e.STLLoader)}.apply(e,o),!(void 0!==n&&(t.exports=n))},function(e){e.exports=t},function(t){t.exports=e},function(t,e,r){var o,n;o=[r(2)],n=function(t){t.STLLoader=function(){},t.STLLoader.prototype={constructor:t.STLLoader},t.STLLoader.prototype.load=function(t,e){function r(r){if(200===r.target.status||0===r.target.status){var n=o.parse(r.target.response||r.target.responseText);o.dispatchEvent({type:"load",content:n}),e&&e(n)}else o.dispatchEvent({type:"error",message:"Couldn't load URL ["+t+"]",response:r.target.statusText})}var o=this,n=new XMLHttpRequest;n.addEventListener("load",r,!1),n.addEventListener("progress",function(t){o.dispatchEvent({type:"progress",loaded:t.loaded,total:t.total})},!1),n.addEventListener("error",function(){o.dispatchEvent({type:"error",message:"Couldn't load URL ["+t+"]"})},!1),n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.open("GET",t,!0),n.responseType="arraybuffer",n.send(null)},t.STLLoader.prototype.parse=function(t){var e=function(){var t,e,o,n;return n=new DataView(r),e=50,o=n.getUint32(80,!0),t=84+o*e,t===n.byteLength},r=this.ensureBinary(t);return e()?this.parseBinary(r):this.parseASCII(this.ensureString(t))},t.STLLoader.prototype.parseBinary=function(e){for(var r,o,n,a,i,s,u,p,f=new DataView(e),d=f.getUint32(80,!0),h=!1,c=0;70>c;c++)1129270351==f.getUint32(c,!1)&&82==f.getUint8(c+4)&&61==f.getUint8(c+5)&&(h=!0,a=new Float32Array(3*d*3),i=f.getUint8(c+6)/255,s=f.getUint8(c+7)/255,u=f.getUint8(c+8)/255,p=f.getUint8(c+9)/255);for(var g=84,l=50,y=0,v=new t.BufferGeometry,w=new Float32Array(3*d*3),L=new Float32Array(3*d*3),b=0;d>b;b++){var x=g+b*l,m=f.getFloat32(x,!0),E=f.getFloat32(x+4,!0),S=f.getFloat32(x+8,!0);if(h){var T=f.getUint16(x+48,!0);0===(32768&T)?(r=(31&T)/31,o=(T>>5&31)/31,n=(T>>10&31)/31):(r=i,o=s,n=u)}for(var U=1;3>=U;U++){var F=x+12*U;w[y]=f.getFloat32(F,!0),w[y+1]=f.getFloat32(F+4,!0),w[y+2]=f.getFloat32(F+8,!0),L[y]=m,L[y+1]=E,L[y+2]=S,h&&(a[y]=r,a[y+1]=o,a[y+2]=n),y+=3}}return v.addAttribute("position",new t.BufferAttribute(w,3)),v.addAttribute("normal",new t.BufferAttribute(L,3)),h&&(v.addAttribute("color",new t.BufferAttribute(a,3)),v.hasColors=!0,v.alpha=p),v},t.STLLoader.prototype.parseASCII=function(e){var r,o,n,a,i,s,u,p;for(r=new t.Geometry,a=/facet([\s\S]*?)endfacet/g;null!==(u=a.exec(e));){for(p=u[0],i=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;null!==(u=i.exec(p));)n=new t.Vector3(parseFloat(u[1]),parseFloat(u[3]),parseFloat(u[5]));for(s=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;null!==(u=s.exec(p));)r.vertices.push(new t.Vector3(parseFloat(u[1]),parseFloat(u[3]),parseFloat(u[5])));o=r.vertices.length,r.faces.push(new t.Face3(o-3,o-2,o-1,n))}return r.computeBoundingBox(),r.computeBoundingSphere(),r},t.STLLoader.prototype.ensureString=function(t){if("string"!=typeof t){for(var e=new Uint8Array(t),r="",o=0;o<t.byteLength;o++)r+=String.fromCharCode(e[o]);return r}return t},t.STLLoader.prototype.ensureBinary=function(t){if("string"==typeof t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=255&t.charCodeAt(r);return e.buffer||e}return t},t.EventDispatcher.prototype.apply(t.STLLoader.prototype),"undefined"==typeof DataView&&(DataView=function(t,e,r){this.buffer=t,this.byteOffset=e||0,this.byteLength=r||t.byteLength||t.length,this._isString="string"==typeof t},DataView.prototype={_getCharCodes:function(t,e,r){e=e||0,r=r||t.length;for(var o=e+r,n=[],a=e;o>a;a++)n.push(255&t.charCodeAt(a));return n},_getBytes:function(t,e,r){var o;if(void 0===r&&(r=this._littleEndian),e=void 0===e?this.byteOffset:this.byteOffset+e,void 0===t&&(t=this.byteLength-e),"number"!=typeof e)throw new TypeError("DataView byteOffset is not a number");if(0>t||e+t>this.byteLength)throw new Error("DataView length or (byteOffset+length) value is out of bounds");return o=this.isString?this._getCharCodes(this.buffer,e,e+t):this.buffer.slice(e,e+t),!r&&t>1&&(o instanceof Array||(o=Array.prototype.slice.call(o)),o.reverse()),o},getFloat64:function(t,e){var r=this._getBytes(8,t,e),o=1-2*(r[7]>>7),n=((r[7]<<1&255)<<3|r[6]>>4)-1023,a=(15&r[6])*Math.pow(2,48)+r[5]*Math.pow(2,40)+r[4]*Math.pow(2,32)+r[3]*Math.pow(2,24)+r[2]*Math.pow(2,16)+r[1]*Math.pow(2,8)+r[0];return 1024===n?0!==a?0/0:1/0*o:-1023===n?o*a*Math.pow(2,-1074):o*(1+a*Math.pow(2,-52))*Math.pow(2,n)},getFloat32:function(t,e){var r=this._getBytes(4,t,e),o=1-2*(r[3]>>7),n=(r[3]<<1&255|r[2]>>7)-127,a=(127&r[2])<<16|r[1]<<8|r[0];return 128===n?0!==a?0/0:1/0*o:-127===n?o*a*Math.pow(2,-149):o*(1+a*Math.pow(2,-23))*Math.pow(2,n)},getInt32:function(t,e){var r=this._getBytes(4,t,e);return r[3]<<24|r[2]<<16|r[1]<<8|r[0]},getUint32:function(t,e){return this.getInt32(t,e)>>>0},getInt16:function(t,e){return this.getUint16(t,e)<<16>>16},getUint16:function(t,e){var r=this._getBytes(2,t,e);return r[1]<<8|r[0]},getInt8:function(t){return this.getUint8(t)<<24>>24},getUint8:function(t){return this._getBytes(1,t)[0]}})}.apply(e,o),!(void 0!==n&&(t.exports=n))}])});